<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /install/index.php source</title>
    <link rel="stylesheet" href="../sample.css" type="text/css">
    <link rel="stylesheet" href="../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Sat Nov 21 22:13:19 2015 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../';
subdir='install';
filename='index.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/install/</a> -> <a href="index.php.html">index.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="index.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="index.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">/**</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment"> * This is the main install menu</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment"> *</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment"> * ---------------------------------------------------------------------------------------------------------------</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment"> * IF YOU ARE READING THIS IN YOUR WEB BROWSER, IT MEANS THAT YOU DID NOT LOAD THIS FILE THROUGH A PHP WEB SERVER. </span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment"> * TO GET STARTED, GO TO THIS PAGE: http://b2evolution.net/man/getting-started</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment"> * ---------------------------------------------------------------------------------------------------------------</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment"> * </span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment"> * b2evolution - {@link http://b2evolution.net/}</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment"> * Released under GNU GPL License - {@link http://b2evolution.net/about/gnu-gpl-license}</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment"> * @copyright (c)2003-2015 by Francois Planque - {@link http://fplanque.com/}</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment"> *</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment"> * @package install</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment"> */</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">// Turn off the output buffering to do the correct work of the function flush()</span>
<a name="l18"><span class="linenum">  18</span></a>  @<a class="phpfunction" onClick="logFunction('ini_set')" href="../_functions/ini_set.html" onMouseOver="phpfuncPopup(event,'ini_set')">ini_set</a>( 'output_buffering', 'off' );
<a name="l19"><span class="linenum">  19</span></a>  
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment">/**</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * include config and default functions:</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> */</span>
<a name="l23"><span class="linenum">  23</span></a>  require_once <a class="phpfunction" onClick="logFunction('dirname')" href="../_functions/dirname.html" onMouseOver="phpfuncPopup(event,'dirname')">dirname</a>(__FILE__).'<a class="filename" href="../conf/_config.php.html">/../conf/_config.php</a>';
<a name="l24"><span class="linenum">  24</span></a>  
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment">// Make the includes believe they are being called in the right place...</span>
<a name="l26"><span class="linenum">  26</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>( '<a class="constant" onClick="logConstant('EVO_MAIN_INIT')" href="../_constants/EVO_MAIN_INIT.html" onMouseOver="constPopup(event,'EVO_MAIN_INIT')">EVO_MAIN_INIT</a>', true );
<a name="l27"><span class="linenum">  27</span></a>  
<a name="l28"><span class="linenum">  28</span></a>  <span class="comment">/**</span>
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment"> * Define that we're in the install process.</span>
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment"> */</span>
<a name="l31"><span class="linenum">  31</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>( '<a class="constant" onClick="logConstant('EVO_IS_INSTALLING')" href="../_constants/EVO_IS_INSTALLING.html" onMouseOver="constPopup(event,'EVO_IS_INSTALLING')">EVO_IS_INSTALLING</a>', true );
<a name="l32"><span class="linenum">  32</span></a>  
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment">/**</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> * @global boolean Is this an install page? Use {@link is_install_page()} to query it, because it may change.</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> */</span>
<a name="l36"><span class="linenum">  36</span></a>  <a class="var it6813" onMouseOver="hilite(6813)" onMouseOut="lolite()" onClick="logVariable('is_install_page')" href="../_variables/is_install_page.html">$is_install_page</a> = true;
<a name="l37"><span class="linenum">  37</span></a>  
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment">// Force to display errors during install/upgrade, even when not in debug mode</span>
<a name="l39"><span class="linenum">  39</span></a>  <a class="var it4315" onMouseOver="hilite(4315)" onMouseOut="lolite()" onClick="logVariable('display_errors_on_production')" href="../_variables/display_errors_on_production.html">$display_errors_on_production</a> = true;
<a name="l40"><span class="linenum">  40</span></a>  
<a name="l41"><span class="linenum">  41</span></a>  <a class="var it5395" onMouseOver="hilite(5395)" onMouseOut="lolite()" onClick="logVariable('script_start_time')" href="../_variables/script_start_time.html">$script_start_time</a> = <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l42"><span class="linenum">  42</span></a>  <a class="var it317" onMouseOver="hilite(317)" onMouseOut="lolite()" onClick="logVariable('localtimenow')" href="../_variables/localtimenow.html">$localtimenow</a> = <a class="var it5395" onMouseOver="hilite(5395)" onMouseOut="lolite()" onClick="logVariable('script_start_time')" href="../_variables/script_start_time.html">$script_start_time</a>; <span class="comment">// used e.g. for post_datemodified (sample posts)</span>
<a name="l43"><span class="linenum">  43</span></a>  <a class="var it1254" onMouseOver="hilite(1254)" onMouseOut="lolite()" onClick="logVariable('servertimenow')" href="../_variables/servertimenow.html">$servertimenow</a> = <a class="var it5395" onMouseOver="hilite(5395)" onMouseOut="lolite()" onClick="logVariable('script_start_time')" href="../_variables/script_start_time.html">$script_start_time</a>; <span class="comment">// used e.g. for itpr_datemodified, cmpr_datemodified, mspr_datemodified (sample data)</span>
<a name="l44"><span class="linenum">  44</span></a>  
<a name="l45"><span class="linenum">  45</span></a>  if( ! <a class="var it3710" onMouseOver="hilite(3710)" onMouseOut="lolite()" onClick="logVariable('config_is_done')" href="../_variables/config_is_done.html">$config_is_done</a> )
<a name="l46"><span class="linenum">  46</span></a>  {    // Base config is not done yet, try to guess some values needed for correct display:
<a name="l47"><span class="linenum">  47</span></a>      <a class="var it1303" onMouseOver="hilite(1303)" onMouseOut="lolite()" onClick="logVariable('rsc_url')" href="../_variables/rsc_url.html">$rsc_url</a> = '../rsc/';
<a name="l48"><span class="linenum">  48</span></a>  }
<a name="l49"><span class="linenum">  49</span></a>  
<a name="l50"><span class="linenum">  50</span></a>  require_once <a class="var it43" onMouseOver="hilite(43)" onMouseOut="lolite()" onClick="logVariable('inc_path')" href="../_variables/inc_path.html">$inc_path</a>.'_core/_class'.<a class="phpfunction" onClick="logFunction('floor')" href="../_functions/floor.html" onMouseOver="phpfuncPopup(event,'floor')">floor</a>(PHP_VERSION).'.funcs.php';
<a name="l51"><span class="linenum">  51</span></a>  require_once <a class="var it43" onMouseOver="hilite(43)" onMouseOut="lolite()" onClick="logVariable('inc_path')" href="../_variables/inc_path.html">$inc_path</a>.'_core/_misc.funcs.php';
<a name="l52"><span class="linenum">  52</span></a>  
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment">/**</span>
<a name="l54"><span class="linenum">  54</span></a>  <span class="comment"> * Load locale related functions</span>
<a name="l55"><span class="linenum">  55</span></a>  <span class="comment"> */</span>
<a name="l56"><span class="linenum">  56</span></a>  require_once <a class="var it43" onMouseOver="hilite(43)" onMouseOut="lolite()" onClick="logVariable('inc_path')" href="../_variables/inc_path.html">$inc_path</a>.'locales/_locale.funcs.php';
<a name="l57"><span class="linenum">  57</span></a>  
<a name="l58"><span class="linenum">  58</span></a>  <a class="function" onClick="logFunction('load_class')" href="../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( '_core/model/_log.class.php', 'Log');
<a name="l59"><span class="linenum">  59</span></a>  <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../_variables/Debuglog.html">$Debuglog</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Log')" href="../_classes/log.html" onMouseOver="classPopup(event,'log')">Log</a>();
<a name="l60"><span class="linenum">  60</span></a>  <a class="function" onClick="logFunction('load_class')" href="../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( '_core/model/_messages.class.php', 'Messages' );
<a name="l61"><span class="linenum">  61</span></a>  <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../_variables/Messages.html">$Messages</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Messages')" href="../_classes/messages.html" onMouseOver="classPopup(event,'messages')">Messages</a>();
<a name="l62"><span class="linenum">  62</span></a>  
<a name="l63"><span class="linenum">  63</span></a>  <span class="comment">// Set bootstrap css classes for messages</span>
<a name="l64"><span class="linenum">  64</span></a>  <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('set_params')" href="../_functions/set_params.html" onMouseOver="funcPopup(event,'set_params')">set_params</a>( array(
<a name="l65"><span class="linenum">  65</span></a>          'class_outerdiv' =&gt; 'action_messages',
<a name="l66"><span class="linenum">  66</span></a>          'class_success'  =&gt; 'alert alert-dismissible alert-success fade in',
<a name="l67"><span class="linenum">  67</span></a>          'class_warning'  =&gt; 'alert alert-dismissible alert-warning fade in',
<a name="l68"><span class="linenum">  68</span></a>          'class_error'    =&gt; 'alert alert-dismissible alert-danger fade in',
<a name="l69"><span class="linenum">  69</span></a>          'class_note'     =&gt; 'alert alert-dismissible alert-info fade in',
<a name="l70"><span class="linenum">  70</span></a>          'before_success' =&gt; '&lt;evo:success&gt;',
<a name="l71"><span class="linenum">  71</span></a>          'after_success'  =&gt; '&lt;/evo:success&gt;',
<a name="l72"><span class="linenum">  72</span></a>          'before_warning' =&gt; '&lt;evo:warning&gt;',
<a name="l73"><span class="linenum">  73</span></a>          'after_warning'  =&gt; '&lt;/evo:warning&gt;',
<a name="l74"><span class="linenum">  74</span></a>          'before_error'   =&gt; '&lt;evo:error&gt;',
<a name="l75"><span class="linenum">  75</span></a>          'after_error'    =&gt; '&lt;/evo:error&gt;',
<a name="l76"><span class="linenum">  76</span></a>          'before_note'    =&gt; '&lt;evo:note&gt;',
<a name="l77"><span class="linenum">  77</span></a>          'after_note'     =&gt; '&lt;/evo:note&gt;',
<a name="l78"><span class="linenum">  78</span></a>      ) );
<a name="l79"><span class="linenum">  79</span></a>  
<a name="l80"><span class="linenum">  80</span></a>  <span class="comment">/**</span>
<a name="l81"><span class="linenum">  81</span></a>  <span class="comment"> * System log</span>
<a name="l82"><span class="linenum">  82</span></a>  <span class="comment"> */</span>
<a name="l83"><span class="linenum">  83</span></a>  <a class="function" onClick="logFunction('load_class')" href="../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( 'tools/model/_syslog.class.php', 'Syslog' );
<a name="l84"><span class="linenum">  84</span></a>  
<a name="l85"><span class="linenum">  85</span></a>  <a class="function" onClick="logFunction('load_funcs')" href="../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>('_core/_param.funcs.php');
<a name="l86"><span class="linenum">  86</span></a>  
<a name="l87"><span class="linenum">  87</span></a>  <span class="comment">// Init action param:</span>
<a name="l88"><span class="linenum">  88</span></a>  <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'action', 'string', 'default' );
<a name="l89"><span class="linenum">  89</span></a>  
<a name="l90"><span class="linenum">  90</span></a>  if( <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a> == 'newdb' &amp;&amp; empty( <a class="var it3710" onMouseOver="hilite(3710)" onMouseOut="lolite()" onClick="logVariable('config_is_done')" href="../_variables/config_is_done.html">$config_is_done</a> ) )
<a name="l91"><span class="linenum">  91</span></a>  { // This is a request of quick installation
<a name="l92"><span class="linenum">  92</span></a>      <a class="var it6814" onMouseOver="hilite(6814)" onMouseOut="lolite()" onClick="logVariable('db_tableprefix')" href="../_variables/db_tableprefix.html">$db_tableprefix</a> = <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'db_tableprefix', 'string', '' );
<a name="l93"><span class="linenum">  93</span></a>      if( ! empty( <a class="var it6814" onMouseOver="hilite(6814)" onMouseOut="lolite()" onClick="logVariable('db_tableprefix')" href="../_variables/db_tableprefix.html">$db_tableprefix</a> ) )
<a name="l94"><span class="linenum">  94</span></a>      { // Update global config variable <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('tableprefix')" href="../_variables/tableprefix.html">$tableprefix</a> before loading of all modules:
<a name="l95"><span class="linenum">  95</span></a>          global <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('tableprefix')" href="../_variables/tableprefix.html">$tableprefix</a>;
<a name="l96"><span class="linenum">  96</span></a>          <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('tableprefix')" href="../_variables/tableprefix.html">$tableprefix</a> = <a class="var it6814" onMouseOver="hilite(6814)" onMouseOut="lolite()" onClick="logVariable('db_tableprefix')" href="../_variables/db_tableprefix.html">$db_tableprefix</a>;
<a name="l97"><span class="linenum">  97</span></a>      }
<a name="l98"><span class="linenum">  98</span></a>  }
<a name="l99"><span class="linenum">  99</span></a>  
<a name="l100"><span class="linenum"> 100</span></a>  <span class="comment">/**</span>
<a name="l101"><span class="linenum"> 101</span></a>  <span class="comment"> * Load modules.</span>
<a name="l102"><span class="linenum"> 102</span></a>  <span class="comment"> *</span>
<a name="l103"><span class="linenum"> 103</span></a>  <span class="comment"> * This initializes table name aliases and is required before trying to connect to the DB.</span>
<a name="l104"><span class="linenum"> 104</span></a>  <span class="comment"> */</span>
<a name="l105"><span class="linenum"> 105</span></a>  <a class="function" onClick="logFunction('load_class')" href="../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( '_core/model/_module.class.php', 'Module' );
<a name="l106"><span class="linenum"> 106</span></a>  foreach( <a class="var it2709" onMouseOver="hilite(2709)" onMouseOut="lolite()" onClick="logVariable('modules')" href="../_variables/modules.html">$modules</a> as <a class="var it1347" onMouseOver="hilite(1347)" onMouseOut="lolite()" onClick="logVariable('module')" href="../_variables/module.html">$module</a> )
<a name="l107"><span class="linenum"> 107</span></a>  {
<a name="l108"><span class="linenum"> 108</span></a>      require_once <a class="var it43" onMouseOver="hilite(43)" onMouseOut="lolite()" onClick="logVariable('inc_path')" href="../_variables/inc_path.html">$inc_path</a>.<a class="var it1347" onMouseOver="hilite(1347)" onMouseOut="lolite()" onClick="logVariable('module')" href="../_variables/module.html">$module</a>.'/_'.<a class="var it1347" onMouseOver="hilite(1347)" onMouseOut="lolite()" onClick="logVariable('module')" href="../_variables/module.html">$module</a>.'.init.php';
<a name="l109"><span class="linenum"> 109</span></a>  }
<a name="l110"><span class="linenum"> 110</span></a>  
<a name="l111"><span class="linenum"> 111</span></a>  <span class="comment">// fp&gt; TODO: we may want to try to get the base init into here somehow</span>
<a name="l112"><span class="linenum"> 112</span></a>  <span class="comment">// $require_base_config = false;</span>
<a name="l113"><span class="linenum"> 113</span></a>  
<a name="l114"><span class="linenum"> 114</span></a>  require_once <a class="var it1876" onMouseOver="hilite(1876)" onMouseOut="lolite()" onClick="logVariable('conf_path')" href="../_variables/conf_path.html">$conf_path</a>.'_upgrade.php';
<a name="l115"><span class="linenum"> 115</span></a>  <span class="comment">// no longer exists: require_once $inc_path.'_vars.inc.php';</span>
<a name="l116"><span class="linenum"> 116</span></a>  <a class="function" onClick="logFunction('load_class')" href="../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( '/_core/model/db/_db.class.php', 'DB' );
<a name="l117"><span class="linenum"> 117</span></a>  <span class="comment">//load_funcs('collections/model/_blog.funcs.php');</span>
<a name="l118"><span class="linenum"> 118</span></a>  <span class="comment">//load_funcs('collections/model/_category.funcs.php');</span>
<a name="l119"><span class="linenum"> 119</span></a>  <span class="comment">//load_class( 'items/model/_item.class.php', 'Item' );</span>
<a name="l120"><span class="linenum"> 120</span></a>  <span class="comment">//load_funcs('items/model/_item.funcs.php');</span>
<a name="l121"><span class="linenum"> 121</span></a>  <span class="comment">//load_funcs('users/model/_user.funcs.php');</span>
<a name="l122"><span class="linenum"> 122</span></a>  <span class="comment">//load_funcs( '_core/ui/forms/_form.funcs.php' );</span>
<a name="l123"><span class="linenum"> 123</span></a>  <a class="function" onClick="logFunction('load_class')" href="../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( '_core/model/_timer.class.php', 'Timer' );
<a name="l124"><span class="linenum"> 124</span></a>  <span class="comment">//load_class( 'plugins/model/_plugins.class.php', 'Plugins' );</span>
<a name="l125"><span class="linenum"> 125</span></a>  <a class="function" onClick="logFunction('load_funcs')" href="../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>( '_core/_url.funcs.php' );
<a name="l126"><span class="linenum"> 126</span></a>  <a class="function" onClick="logFunction('load_funcs')" href="../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>( 'tools/model/_system.funcs.php' );
<a name="l127"><span class="linenum"> 127</span></a>  
<a name="l128"><span class="linenum"> 128</span></a>  
<a name="l129"><span class="linenum"> 129</span></a>  require_once <a class="phpfunction" onClick="logFunction('dirname')" href="../_functions/dirname.html" onMouseOver="phpfuncPopup(event,'dirname')">dirname</a>(__FILE__).'/_functions_install.php';
<a name="l130"><span class="linenum"> 130</span></a>  
<a name="l131"><span class="linenum"> 131</span></a>  <a class="var it610" onMouseOver="hilite(610)" onMouseOut="lolite()" onClick="logVariable('Timer')" href="../_variables/Timer.html">$Timer</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Timer')" href="../_classes/timer.html" onMouseOver="classPopup(event,'timer')">Timer</a>('main');
<a name="l132"><span class="linenum"> 132</span></a>  
<a name="l133"><span class="linenum"> 133</span></a>  <span class="comment">// Let the modules load/register what they need:</span>
<a name="l134"><span class="linenum"> 134</span></a>  <a class="function" onClick="logFunction('modules_call_method')" href="../_functions/modules_call_method.html" onMouseOver="funcPopup(event,'modules_call_method')">modules_call_method</a>( 'init' );
<a name="l135"><span class="linenum"> 135</span></a>  
<a name="l136"><span class="linenum"> 136</span></a>  <span class="comment">// Init charset variables based on the $evo_charset value</span>
<a name="l137"><span class="linenum"> 137</span></a>  <a class="var it627" onMouseOver="hilite(627)" onMouseOut="lolite()" onClick="logVariable('current_charset')" href="../_variables/current_charset.html">$current_charset</a> = <a class="var it926" onMouseOver="hilite(926)" onMouseOut="lolite()" onClick="logVariable('evo_charset')" href="../_variables/evo_charset.html">$evo_charset</a>;
<a name="l138"><span class="linenum"> 138</span></a>  <a class="function" onClick="logFunction('init_charsets')" href="../_functions/init_charsets.html" onMouseOver="funcPopup(event,'init_charsets')">init_charsets</a>( <a class="var it627" onMouseOver="hilite(627)" onMouseOut="lolite()" onClick="logVariable('current_charset')" href="../_variables/current_charset.html">$current_charset</a> );
<a name="l139"><span class="linenum"> 139</span></a>  
<a name="l140"><span class="linenum"> 140</span></a>  <span class="comment">// Check minimum memory limit for successful using:</span>
<a name="l141"><span class="linenum"> 141</span></a>  if( <a class="function" onClick="logFunction('system_check_memory_limit')" href="../_functions/system_check_memory_limit.html" onMouseOver="funcPopup(event,'system_check_memory_limit')">system_check_memory_limit</a>() &lt; <a class="function" onClick="logFunction('get_php_bytes_size')" href="../_functions/get_php_bytes_size.html" onMouseOver="funcPopup(event,'get_php_bytes_size')">get_php_bytes_size</a>( '48M' ) )
<a name="l142"><span class="linenum"> 142</span></a>  { // Deny to use on server with small memory limit size:
<a name="l143"><span class="linenum"> 143</span></a>      <a class="var it6815" onMouseOver="hilite(6815)" onMouseOut="lolite()" onClick="logVariable('install_memory_limit_allow')" href="../_variables/install_memory_limit_allow.html">$install_memory_limit_allow</a> = false;
<a name="l144"><span class="linenum"> 144</span></a>      if( <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a> != 'localeinfo' )
<a name="l145"><span class="linenum"> 145</span></a>      { // Restrict all actions except of action to switch a language and view page of more languages:
<a name="l146"><span class="linenum"> 146</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a> = 'start';
<a name="l147"><span class="linenum"> 147</span></a>      }
<a name="l148"><span class="linenum"> 148</span></a>  }
<a name="l149"><span class="linenum"> 149</span></a>  else
<a name="l150"><span class="linenum"> 150</span></a>  { // Allow to use installer when memory limit is enough:
<a name="l151"><span class="linenum"> 151</span></a>      <a class="var it6815" onMouseOver="hilite(6815)" onMouseOut="lolite()" onClick="logVariable('install_memory_limit_allow')" href="../_variables/install_memory_limit_allow.html">$install_memory_limit_allow</a> = true;
<a name="l152"><span class="linenum"> 152</span></a>  }
<a name="l153"><span class="linenum"> 153</span></a>  
<a name="l154"><span class="linenum"> 154</span></a>  <span class="comment">// Display mode:</span>
<a name="l155"><span class="linenum"> 155</span></a>  <span class="comment">// - 'normal' - Normal mode; Used for normal installation.</span>
<a name="l156"><span class="linenum"> 156</span></a>  <span class="comment">// - 'compact' - Compact mode; Hide header, footer and progress bar; Used for automated installation.</span>
<a name="l157"><span class="linenum"> 157</span></a>  <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'display', 'string', 'normal' );
<a name="l158"><span class="linenum"> 158</span></a>  
<a name="l159"><span class="linenum"> 159</span></a>  <span class="comment">// check if we should try to connect to db if config is not done</span>
<a name="l160"><span class="linenum"> 160</span></a>  switch( <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a> )
<a name="l161"><span class="linenum"> 161</span></a>  {
<a name="l162"><span class="linenum"> 162</span></a>      case 'evoupgrade':
<a name="l163"><span class="linenum"> 163</span></a>      case 'auto_upgrade':
<a name="l164"><span class="linenum"> 164</span></a>      case 'svn_upgrade':
<a name="l165"><span class="linenum"> 165</span></a>      case 'newdb':
<a name="l166"><span class="linenum"> 166</span></a>      case 'cafelogupgrade':
<a name="l167"><span class="linenum"> 167</span></a>      case 'deletedb':
<a name="l168"><span class="linenum"> 168</span></a>      case 'menu':
<a name="l169"><span class="linenum"> 169</span></a>      case 'menu-install':
<a name="l170"><span class="linenum"> 170</span></a>      case 'menu-options':
<a name="l171"><span class="linenum"> 171</span></a>      case 'localeinfo':
<a name="l172"><span class="linenum"> 172</span></a>      case 'utf8check':
<a name="l173"><span class="linenum"> 173</span></a>      case 'utf8upgrade':
<a name="l174"><span class="linenum"> 174</span></a>          <a class="var it6816" onMouseOver="hilite(6816)" onMouseOut="lolite()" onClick="logVariable('try_db_connect')" href="../_variables/try_db_connect.html">$try_db_connect</a> = true;
<a name="l175"><span class="linenum"> 175</span></a>          break;
<a name="l176"><span class="linenum"> 176</span></a>      case 'start':
<a name="l177"><span class="linenum"> 177</span></a>      case 'conf':
<a name="l178"><span class="linenum"> 178</span></a>      case 'default':
<a name="l179"><span class="linenum"> 179</span></a>          <a class="var it6816" onMouseOver="hilite(6816)" onMouseOut="lolite()" onClick="logVariable('try_db_connect')" href="../_variables/try_db_connect.html">$try_db_connect</a> = false;
<a name="l180"><span class="linenum"> 180</span></a>          break;
<a name="l181"><span class="linenum"> 181</span></a>      default:
<a name="l182"><span class="linenum"> 182</span></a>  <span class="comment">        // set a valid action</span>
<a name="l183"><span class="linenum"> 183</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a> = 'default';
<a name="l184"><span class="linenum"> 184</span></a>          <a class="var it6816" onMouseOver="hilite(6816)" onMouseOut="lolite()" onClick="logVariable('try_db_connect')" href="../_variables/try_db_connect.html">$try_db_connect</a> = false;
<a name="l185"><span class="linenum"> 185</span></a>          break;
<a name="l186"><span class="linenum"> 186</span></a>  }
<a name="l187"><span class="linenum"> 187</span></a>  
<a name="l188"><span class="linenum"> 188</span></a>  <a class="var it1360" onMouseOver="hilite(1360)" onMouseOut="lolite()" onClick="logVariable('timestamp')" href="../_variables/timestamp.html">$timestamp</a> = <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() - 120; <span class="comment">// We start dates 2 minutes ago because their dates increase 1 second at a time and we want everything to be visible when the user watches the blogs right after install :P</span>
<a name="l189"><span class="linenum"> 189</span></a>  
<a name="l190"><span class="linenum"> 190</span></a>  <span class="comment">// Load all available locale defintions:</span>
<a name="l191"><span class="linenum"> 191</span></a>  <a class="function" onClick="logFunction('locales_load_available_defs')" href="../_functions/locales_load_available_defs.html" onMouseOver="funcPopup(event,'locales_load_available_defs')">locales_load_available_defs</a>();
<a name="l192"><span class="linenum"> 192</span></a>  <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'locale', 'string' );
<a name="l193"><span class="linenum"> 193</span></a>  <a class="var it6817" onMouseOver="hilite(6817)" onMouseOut="lolite()" onClick="logVariable('use_locale_from_request')" href="../_variables/use_locale_from_request.html">$use_locale_from_request</a> = false;
<a name="l194"><span class="linenum"> 194</span></a>  if( <a class="phpfunction" onClick="logFunction('preg_match')" href="../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>( '/[a-z]{2}-[A-Z]{2}(-.{1,14})?/', <a class="var it29" onMouseOver="hilite(29)" onMouseOut="lolite()" onClick="logVariable('locale')" href="../_variables/locale.html">$locale</a> ) )
<a name="l195"><span class="linenum"> 195</span></a>  {
<a name="l196"><span class="linenum"> 196</span></a>      <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a> = <a class="var it29" onMouseOver="hilite(29)" onMouseOut="lolite()" onClick="logVariable('locale')" href="../_variables/locale.html">$locale</a>;
<a name="l197"><span class="linenum"> 197</span></a>      <a class="var it6817" onMouseOver="hilite(6817)" onMouseOut="lolite()" onClick="logVariable('use_locale_from_request')" href="../_variables/use_locale_from_request.html">$use_locale_from_request</a> = true;
<a name="l198"><span class="linenum"> 198</span></a>  }
<a name="l199"><span class="linenum"> 199</span></a>  if( ! empty( <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a> ) &amp;&amp; ! empty( <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('locales')" href="../_variables/locales.html">$locales</a> ) &amp;&amp; isset( <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('locales')" href="../_variables/locales.html">$locales</a>[ <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a> ] ) )
<a name="l200"><span class="linenum"> 200</span></a>  { // Set correct charset, The main using is for DB connection
<a name="l201"><span class="linenum"> 201</span></a>      <a class="var it926" onMouseOver="hilite(926)" onMouseOut="lolite()" onClick="logVariable('evo_charset')" href="../_variables/evo_charset.html">$evo_charset</a> = <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('locales')" href="../_variables/locales.html">$locales</a>[ <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a> ]['charset'];
<a name="l202"><span class="linenum"> 202</span></a>  }
<a name="l203"><span class="linenum"> 203</span></a>  
<a name="l204"><span class="linenum"> 204</span></a>  if( <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a> == 'newdb' )
<a name="l205"><span class="linenum"> 205</span></a>  { // Check request for quick installation AND Update basic config file from url params:
<a name="l206"><span class="linenum"> 206</span></a>      <a class="var it6818" onMouseOver="hilite(6818)" onMouseOut="lolite()" onClick="logVariable('basic_config_file_result')" href="../_variables/basic_config_file_result.html">$basic_config_file_result</a> = <a class="function" onClick="logFunction('check_quick_install_request')" href="../_functions/check_quick_install_request.html" onMouseOver="funcPopup(event,'check_quick_install_request')">check_quick_install_request</a>();
<a name="l207"><span class="linenum"> 207</span></a>  }
<a name="l208"><span class="linenum"> 208</span></a>  
<a name="l209"><span class="linenum"> 209</span></a>  if( <a class="var it3710" onMouseOver="hilite(3710)" onMouseOut="lolite()" onClick="logVariable('config_is_done')" href="../_variables/config_is_done.html">$config_is_done</a> || <a class="var it6816" onMouseOver="hilite(6816)" onMouseOut="lolite()" onClick="logVariable('try_db_connect')" href="../_variables/try_db_connect.html">$try_db_connect</a> )
<a name="l210"><span class="linenum"> 210</span></a>  { // Connect to DB:
<a name="l211"><span class="linenum"> 211</span></a>  
<a name="l212"><span class="linenum"> 212</span></a>      <a class="var it6819" onMouseOver="hilite(6819)" onMouseOut="lolite()" onClick="logVariable('tmp_evoconf_db')" href="../_variables/tmp_evoconf_db.html">$tmp_evoconf_db</a> = <a class="var it129" onMouseOver="hilite(129)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../_variables/db_config.html">$db_config</a>;
<a name="l213"><span class="linenum"> 213</span></a>  
<a name="l214"><span class="linenum"> 214</span></a>  <span class="comment">    // We want a friendly message if we can't connect:</span>
<a name="l215"><span class="linenum"> 215</span></a>      <a class="var it6819" onMouseOver="hilite(6819)" onMouseOut="lolite()" onClick="logVariable('tmp_evoconf_db')" href="../_variables/tmp_evoconf_db.html">$tmp_evoconf_db</a>['halt_on_error'] = false;
<a name="l216"><span class="linenum"> 216</span></a>      <a class="var it6819" onMouseOver="hilite(6819)" onMouseOut="lolite()" onClick="logVariable('tmp_evoconf_db')" href="../_variables/tmp_evoconf_db.html">$tmp_evoconf_db</a>['show_errors'] = false;
<a name="l217"><span class="linenum"> 217</span></a>  
<a name="l218"><span class="linenum"> 218</span></a>  <span class="comment">    // Make sure we use the proper charset:</span>
<a name="l219"><span class="linenum"> 219</span></a>      <a class="var it6819" onMouseOver="hilite(6819)" onMouseOut="lolite()" onClick="logVariable('tmp_evoconf_db')" href="../_variables/tmp_evoconf_db.html">$tmp_evoconf_db</a>['connection_charset'] = <a class="var it926" onMouseOver="hilite(926)" onMouseOut="lolite()" onClick="logVariable('evo_charset')" href="../_variables/evo_charset.html">$evo_charset</a>;
<a name="l220"><span class="linenum"> 220</span></a>  
<a name="l221"><span class="linenum"> 221</span></a>  <span class="comment">    // CONNECT TO DB:</span>
<a name="l222"><span class="linenum"> 222</span></a>      <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a> = <span class="keyword">new </span><a class="class" onClick="logClass('DB')" href="../_classes/db.html" onMouseOver="classPopup(event,'db')">DB</a>( <a class="var it6819" onMouseOver="hilite(6819)" onMouseOut="lolite()" onClick="logVariable('tmp_evoconf_db')" href="../_variables/tmp_evoconf_db.html">$tmp_evoconf_db</a> );
<a name="l223"><span class="linenum"> 223</span></a>      unset(<a class="var it6819" onMouseOver="hilite(6819)" onMouseOut="lolite()" onClick="logVariable('tmp_evoconf_db')" href="../_variables/tmp_evoconf_db.html">$tmp_evoconf_db</a>);
<a name="l224"><span class="linenum"> 224</span></a>  
<a name="l225"><span class="linenum"> 225</span></a>      if( !<a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('error')" class="var it10754" onMouseOver="hilite(10754)" onMouseOut="lolite()" href="../_variables/error.html">error</a> )
<a name="l226"><span class="linenum"> 226</span></a>      { // restart conf
<a name="l227"><span class="linenum"> 227</span></a>          <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('halt_on_error')" class="var it10754" onMouseOver="hilite(10754)" onMouseOut="lolite()" href="../_variables/halt_on_error.html">halt_on_error</a> = true;  <span class="comment">// From now on, halt on errors.</span>
<a name="l228"><span class="linenum"> 228</span></a>          <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('show_errors')" class="var it10754" onMouseOver="hilite(10754)" onMouseOut="lolite()" href="../_variables/show_errors.html">show_errors</a> = true;    <span class="comment">// From now on, show errors (they're helpful in case of errors!).</span>
<a name="l229"><span class="linenum"> 229</span></a>  
<a name="l230"><span class="linenum"> 230</span></a>  <span class="comment">        // Check MySQL version</span>
<a name="l231"><span class="linenum"> 231</span></a>          <a class="var it6820" onMouseOver="hilite(6820)" onMouseOut="lolite()" onClick="logVariable('mysql_version')" href="../_variables/mysql_version.html">$mysql_version</a> = <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_version')" href="../_functions/get_version.html" onMouseOver="funcPopup(event,'get_version')">get_version</a>();
<a name="l232"><span class="linenum"> 232</span></a>          foreach( <a class="var it128" onMouseOver="hilite(128)" onMouseOut="lolite()" onClick="logVariable('required_mysql_version')" href="../_variables/required_mysql_version.html">$required_mysql_version</a> as <a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> =&gt; <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> )
<a name="l233"><span class="linenum"> 233</span></a>          { // check required MySQL version for the whole application and for each module
<a name="l234"><span class="linenum"> 234</span></a>              if( <a class="phpfunction" onClick="logFunction('version_compare')" href="../_functions/version_compare.html" onMouseOver="phpfuncPopup(event,'version_compare')">version_compare</a>( <a class="var it6820" onMouseOver="hilite(6820)" onMouseOut="lolite()" onClick="logVariable('mysql_version')" href="../_variables/mysql_version.html">$mysql_version</a>, <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>, '&lt;' ) )
<a name="l235"><span class="linenum"> 235</span></a>              {
<a name="l236"><span class="linenum"> 236</span></a>                  if( <a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a> == 'application' )
<a name="l237"><span class="linenum"> 237</span></a>                  {
<a name="l238"><span class="linenum"> 238</span></a>                      <a class="var it1349" onMouseOver="hilite(1349)" onMouseOut="lolite()" onClick="logVariable('error_message')" href="../_variables/error_message.html">$error_message</a> = sprintf( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The minimum requirement for this version of b2evolution is %s version %s but you are trying to use version %s!'), 'MySQL', <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>, <a class="var it6820" onMouseOver="hilite(6820)" onMouseOut="lolite()" onClick="logVariable('mysql_version')" href="../_variables/mysql_version.html">$mysql_version</a> );
<a name="l239"><span class="linenum"> 239</span></a>                  }
<a name="l240"><span class="linenum"> 240</span></a>                  else
<a name="l241"><span class="linenum"> 241</span></a>                  {
<a name="l242"><span class="linenum"> 242</span></a>                      <a class="var it1349" onMouseOver="hilite(1349)" onMouseOut="lolite()" onClick="logVariable('error_message')" href="../_variables/error_message.html">$error_message</a> = sprintf( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The minimum requirement for %s module is %s version %s but you are trying to use version %s!'), <a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../_variables/key.html">$key</a>, 'MySQL', <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>, <a class="var it6820" onMouseOver="hilite(6820)" onMouseOut="lolite()" onClick="logVariable('mysql_version')" href="../_variables/mysql_version.html">$mysql_version</a> );
<a name="l243"><span class="linenum"> 243</span></a>                  }
<a name="l244"><span class="linenum"> 244</span></a>                  die( '&lt;h1&gt;'.<a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Insufficient Requirements').'&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;'.<a class="var it1349" onMouseOver="hilite(1349)" onMouseOut="lolite()" onClick="logVariable('error_message')" href="../_variables/error_message.html">$error_message</a>.'&lt;/strong&gt;&lt;/p&gt;' );
<a name="l245"><span class="linenum"> 245</span></a>              }
<a name="l246"><span class="linenum"> 246</span></a>          }
<a name="l247"><span class="linenum"> 247</span></a>      }
<a name="l248"><span class="linenum"> 248</span></a>  }
<a name="l249"><span class="linenum"> 249</span></a>  
<a name="l250"><span class="linenum"> 250</span></a>  if( ! <a class="var it6817" onMouseOver="hilite(6817)" onMouseOut="lolite()" onClick="logVariable('use_locale_from_request')" href="../_variables/use_locale_from_request.html">$use_locale_from_request</a> )
<a name="l251"><span class="linenum"> 251</span></a>  { // detect language
<a name="l252"><span class="linenum"> 252</span></a>  <span class="comment">    // try to check if db already exists and default locale is set on it</span>
<a name="l253"><span class="linenum"> 253</span></a>      <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a> = <a class="function" onClick="logFunction('get_default_locale_from_db')" href="../_functions/get_default_locale_from_db.html" onMouseOver="funcPopup(event,'get_default_locale_from_db')">get_default_locale_from_db</a>();
<a name="l254"><span class="linenum"> 254</span></a>      if( empty( <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a> ) )
<a name="l255"><span class="linenum"> 255</span></a>      { // db doesn't exists yet
<a name="l256"><span class="linenum"> 256</span></a>          <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a> = <a class="function" onClick="logFunction('locale_from_httpaccept')" href="../_functions/locale_from_httpaccept.html" onMouseOver="funcPopup(event,'locale_from_httpaccept')">locale_from_httpaccept</a>();
<a name="l257"><span class="linenum"> 257</span></a>      }
<a name="l258"><span class="linenum"> 258</span></a>  <span class="comment">    // echo 'detected locale: ' . $default_locale. '&lt;br /&gt;';</span>
<a name="l259"><span class="linenum"> 259</span></a>      if( isset( <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('locales')" href="../_variables/locales.html">$locales</a>[ <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a> ] ) &amp;&amp; <a class="var it926" onMouseOver="hilite(926)" onMouseOut="lolite()" onClick="logVariable('evo_charset')" href="../_variables/evo_charset.html">$evo_charset</a> != <a class="var it36" onMouseOver="hilite(36)" onMouseOut="lolite()" onClick="logVariable('locales')" href="../_variables/locales.html">$locales</a>[ <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a> ]['charset'] )
<a name="l260"><span class="linenum"> 260</span></a>      { // Redirect to install page with correct defined locale in order to avoid broken chars, e.g. when db locale has utf8 encoding and default locale - latin1
<a name="l261"><span class="linenum"> 261</span></a>          <a class="function" onClick="logFunction('header_redirect')" href="../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( 'index.php?locale='.<a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a> );
<a name="l262"><span class="linenum"> 262</span></a>  <span class="comment">        // Exit here.</span>
<a name="l263"><span class="linenum"> 263</span></a>      }
<a name="l264"><span class="linenum"> 264</span></a>  }
<a name="l265"><span class="linenum"> 265</span></a>  <span class="comment">// Activate default locale:</span>
<a name="l266"><span class="linenum"> 266</span></a>  if( ! <a class="function" onClick="logFunction('locale_activate')" href="../_functions/locale_activate.html" onMouseOver="funcPopup(event,'locale_activate')">locale_activate</a>( <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a> ) )
<a name="l267"><span class="linenum"> 267</span></a>  {    // Could not activate <a class="function" onClick="logFunction('locale')" href="../_functions/locale.html" onMouseOver="funcPopup(event,'locale')">locale</a> (non-existent?), fallback to en-US:
<a name="l268"><span class="linenum"> 268</span></a>      <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a> = 'en-US';
<a name="l269"><span class="linenum"> 269</span></a>      <a class="function" onClick="logFunction('locale_activate')" href="../_functions/locale_activate.html" onMouseOver="funcPopup(event,'locale_activate')">locale_activate</a>( 'en-US' );
<a name="l270"><span class="linenum"> 270</span></a>  }
<a name="l271"><span class="linenum"> 271</span></a>  
<a name="l272"><span class="linenum"> 272</span></a>  <a class="function" onClick="logFunction('init_charsets')" href="../_functions/init_charsets.html" onMouseOver="funcPopup(event,'init_charsets')">init_charsets</a>( <a class="var it627" onMouseOver="hilite(627)" onMouseOut="lolite()" onClick="logVariable('current_charset')" href="../_variables/current_charset.html">$current_charset</a> );
<a name="l273"><span class="linenum"> 273</span></a>  
<a name="l274"><span class="linenum"> 274</span></a>  if( <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a> == 'menu-install' &amp;&amp; ! ( <a class="var it6821" onMouseOver="hilite(6821)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../_variables/old_db_version.html">$old_db_version</a> = <a class="function" onClick="logFunction('get_db_version')" href="../_functions/get_db_version.html" onMouseOver="funcPopup(event,'get_db_version')">get_db_version</a>() ) )
<a name="l275"><span class="linenum"> 275</span></a>  { // Force to step 3 (Select install options) if DB is not installed yet
<a name="l276"><span class="linenum"> 276</span></a>      <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a> = 'menu-options';
<a name="l277"><span class="linenum"> 277</span></a>  }
<a name="l278"><span class="linenum"> 278</span></a>  
<a name="l279"><span class="linenum"> 279</span></a>  switch( <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a> )
<a name="l280"><span class="linenum"> 280</span></a>  {
<a name="l281"><span class="linenum"> 281</span></a>      case 'evoupgrade':
<a name="l282"><span class="linenum"> 282</span></a>      case 'auto_upgrade':
<a name="l283"><span class="linenum"> 283</span></a>      case 'svn_upgrade':
<a name="l284"><span class="linenum"> 284</span></a>          <a class="var it112" onMouseOver="hilite(112)" onMouseOut="lolite()" onClick="logVariable('title')" href="../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Upgrade from a previous version');
<a name="l285"><span class="linenum"> 285</span></a>          break;
<a name="l286"><span class="linenum"> 286</span></a>  
<a name="l287"><span class="linenum"> 287</span></a>      case 'newdb':
<a name="l288"><span class="linenum"> 288</span></a>          <a class="var it112" onMouseOver="hilite(112)" onMouseOut="lolite()" onClick="logVariable('title')" href="../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('New Install');
<a name="l289"><span class="linenum"> 289</span></a>          break;
<a name="l290"><span class="linenum"> 290</span></a>  
<a name="l291"><span class="linenum"> 291</span></a>      case 'cafelogupgrade':
<a name="l292"><span class="linenum"> 292</span></a>          <a class="var it112" onMouseOver="hilite(112)" onMouseOut="lolite()" onClick="logVariable('title')" href="../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Upgrade from Cafelog/b2');
<a name="l293"><span class="linenum"> 293</span></a>          break;
<a name="l294"><span class="linenum"> 294</span></a>  
<a name="l295"><span class="linenum"> 295</span></a>      case 'deletedb':
<a name="l296"><span class="linenum"> 296</span></a>          <a class="var it112" onMouseOver="hilite(112)" onMouseOut="lolite()" onClick="logVariable('title')" href="../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Delete b2evolution tables');
<a name="l297"><span class="linenum"> 297</span></a>          break;
<a name="l298"><span class="linenum"> 298</span></a>  
<a name="l299"><span class="linenum"> 299</span></a>      case 'utf8check':
<a name="l300"><span class="linenum"> 300</span></a>      case 'utf8upgrade':
<a name="l301"><span class="linenum"> 301</span></a>          <a class="var it112" onMouseOver="hilite(112)" onMouseOut="lolite()" onClick="logVariable('title')" href="../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Convert/Normalize your DB to UTF-8/ASCII');
<a name="l302"><span class="linenum"> 302</span></a>          break;
<a name="l303"><span class="linenum"> 303</span></a>  
<a name="l304"><span class="linenum"> 304</span></a>      case 'start':
<a name="l305"><span class="linenum"> 305</span></a>          <a class="var it112" onMouseOver="hilite(112)" onMouseOut="lolite()" onClick="logVariable('title')" href="../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Base configuration');
<a name="l306"><span class="linenum"> 306</span></a>          break;
<a name="l307"><span class="linenum"> 307</span></a>  
<a name="l308"><span class="linenum"> 308</span></a>      case 'conf':
<a name="l309"><span class="linenum"> 309</span></a>          <a class="var it3710" onMouseOver="hilite(3710)" onMouseOut="lolite()" onClick="logVariable('config_is_done')" href="../_variables/config_is_done.html">$config_is_done</a> = 0;
<a name="l310"><span class="linenum"> 310</span></a>      case 'menu':
<a name="l311"><span class="linenum"> 311</span></a>      case 'menu-install':
<a name="l312"><span class="linenum"> 312</span></a>      case 'menu-options':
<a name="l313"><span class="linenum"> 313</span></a>      case 'localeinfo':
<a name="l314"><span class="linenum"> 314</span></a>      case 'default':
<a name="l315"><span class="linenum"> 315</span></a>          <a class="var it112" onMouseOver="hilite(112)" onMouseOut="lolite()" onClick="logVariable('title')" href="../_variables/title.html">$title</a> = '';
<a name="l316"><span class="linenum"> 316</span></a>          break;
<a name="l317"><span class="linenum"> 317</span></a>  }
<a name="l318"><span class="linenum"> 318</span></a>  
<a name="l319"><span class="linenum"> 319</span></a>  <span class="comment">// Form params</span>
<a name="l320"><span class="linenum"> 320</span></a>  <a class="var it6822" onMouseOver="hilite(6822)" onMouseOut="lolite()" onClick="logVariable('booststrap_install_form_params')" href="../_variables/booststrap_install_form_params.html">$booststrap_install_form_params</a> = array(
<a name="l321"><span class="linenum"> 321</span></a>          'formstart'      =&gt; '',
<a name="l322"><span class="linenum"> 322</span></a>          'formend'        =&gt; '',
<a name="l323"><span class="linenum"> 323</span></a>          'fieldstart'     =&gt; '&lt;div class=&quot;form-group&quot; <a class="var it139" onMouseOver="hilite(139)" onMouseOut="lolite()" onClick="logVariable('ID')" href="../_variables/ID.html">$ID</a>$&gt;'.&quot;\n&quot;,
<a name="l324"><span class="linenum"> 324</span></a>          'fieldend'       =&gt; &quot;&lt;/div&gt;\n\n&quot;,
<a name="l325"><span class="linenum"> 325</span></a>          'labelclass'     =&gt; 'control-label col-sm-4',
<a name="l326"><span class="linenum"> 326</span></a>          'labelstart'     =&gt; '',
<a name="l327"><span class="linenum"> 327</span></a>          'labelend'       =&gt; &quot;\n&quot;,
<a name="l328"><span class="linenum"> 328</span></a>          'labelempty'     =&gt; '&lt;label class=&quot;control-label col-sm-4&quot;&gt;&lt;/label&gt;',
<a name="l329"><span class="linenum"> 329</span></a>          'inputstart'     =&gt; '&lt;div class=&quot;col-sm-8&quot;&gt;',
<a name="l330"><span class="linenum"> 330</span></a>          'inputend'       =&gt; &quot;&lt;/div&gt;\n&quot;,
<a name="l331"><span class="linenum"> 331</span></a>          'buttonsstart'   =&gt; '&lt;div class=&quot;form-group&quot;&gt;&lt;div class=&quot;control-buttons col-sm-offset-4 col-sm-8&quot;&gt;',
<a name="l332"><span class="linenum"> 332</span></a>          'buttonsend'     =&gt; &quot;&lt;/div&gt;&lt;/div&gt;\n\n&quot;,
<a name="l333"><span class="linenum"> 333</span></a>          'note_format'    =&gt; ' &lt;span class=&quot;help-inline text-muted small&quot;&gt;%s&lt;/span&gt;',
<a name="l334"><span class="linenum"> 334</span></a>      );
<a name="l335"><span class="linenum"> 335</span></a>  
<a name="l336"><span class="linenum"> 336</span></a>  <a class="phpfunction" onClick="logFunction('header')" href="../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>('Content-Type: text/html; charset='.<a class="var it926" onMouseOver="hilite(926)" onMouseOut="lolite()" onClick="logVariable('evo_charset')" href="../_variables/evo_charset.html">$evo_charset</a>);
<a name="l337"><span class="linenum"> 337</span></a>  <a class="phpfunction" onClick="logFunction('header')" href="../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>('Cache-Control: no-cache'); <span class="comment">// no request to this page should get cached!</span>
<a name="l338"><span class="linenum"> 338</span></a>  ?&gt;
<a name="l339"><span class="linenum"> 339</span></a>  &lt;!DOCTYPE html&gt;
<a name="l340"><span class="linenum"> 340</span></a>  &lt;html lang=&quot;&lt;?php <a class="function" onClick="logFunction('locale_lang')" href="../_functions/locale_lang.html" onMouseOver="funcPopup(event,'locale_lang')">locale_lang</a>() ?&gt;&quot;&gt;
<a name="l341"><span class="linenum"> 341</span></a>      &lt;head&gt;
<a name="l342"><span class="linenum"> 342</span></a>          &lt;base href=&quot;&lt;?php echo <a class="function" onClick="logFunction('get_script_baseurl')" href="../_functions/get_script_baseurl.html" onMouseOver="funcPopup(event,'get_script_baseurl')">get_script_baseurl</a>(); ?&gt;&quot;&gt;
<a name="l343"><span class="linenum"> 343</span></a>          &lt;meta charset=&quot;utf-8&quot;&gt;
<a name="l344"><span class="linenum"> 344</span></a>          &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
<a name="l345"><span class="linenum"> 345</span></a>          &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;
<a name="l346"><span class="linenum"> 346</span></a>          &lt;meta name=&quot;robots&quot; content=&quot;noindex, follow&quot; /&gt;
<a name="l347"><span class="linenum"> 347</span></a>          &lt;title&gt;&lt;?php echo <a class="function" onClick="logFunction('format_to_output')" href="../_functions/format_to_output.html" onMouseOver="funcPopup(event,'format_to_output')">format_to_output</a>( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('b2evo installer').( <a class="var it112" onMouseOver="hilite(112)" onMouseOut="lolite()" onClick="logVariable('title')" href="../_variables/title.html">$title</a> ? ': '.<a class="var it112" onMouseOver="hilite(112)" onMouseOut="lolite()" onClick="logVariable('title')" href="../_variables/title.html">$title</a> : '' ), 'htmlhead' ); ?&gt;&lt;/title&gt;
<a name="l348"><span class="linenum"> 348</span></a>          &lt;script type=&quot;text/javascript&quot; src="<a class="filename" href="../rsc/js/jquery.min.js.html">../rsc/js/jquery.min.js</a>"&gt;&lt;/script&gt;
<a name="l349"><span class="linenum"> 349</span></a>          &lt;!-- Bootstrap --&gt;
<a name="l350"><span class="linenum"> 350</span></a>          &lt;script type=&quot;text/javascript&quot; src="<a class="filename" href="../rsc/js/bootstrap/bootstrap.min.js.html">../rsc/js/bootstrap/bootstrap.min.js</a>"&gt;&lt;/script&gt;
<a name="l351"><span class="linenum"> 351</span></a>          &lt;link href="<a class="filename" href="../rsc/css/bootstrap/bootstrap.min.css.html">../rsc/css/bootstrap/bootstrap.min.css</a>" rel=&quot;stylesheet&quot;&gt;
<a name="l352"><span class="linenum"> 352</span></a>          &lt;link href="<a class="filename" href="../rsc/build/b2evo_helper_screens.css.html">../rsc/build/b2evo_helper_screens.css</a>" rel=&quot;stylesheet&quot;&gt;
<a name="l353"><span class="linenum"> 353</span></a>      &lt;/head&gt;
<a name="l354"><span class="linenum"> 354</span></a>      &lt;body&gt;
<a name="l355"><span class="linenum"> 355</span></a>          &lt;div class=&quot;container&quot; id=&quot;content_wrapper&quot;&gt;
<a name="l356"><span class="linenum"> 356</span></a>              &lt;?php
<a name="l357"><span class="linenum"> 357</span></a>              if( <a class="var it378" onMouseOver="hilite(378)" onMouseOut="lolite()" onClick="logVariable('display')" href="../_variables/display.html">$display</a> == 'normal' )
<a name="l358"><span class="linenum"> 358</span></a>              { // Display header only on normal mode:
<a name="l359"><span class="linenum"> 359</span></a>              ?&gt;
<a name="l360"><span class="linenum"> 360</span></a>              &lt;div class=&quot;header&quot;&gt;
<a name="l361"><span class="linenum"> 361</span></a>                  &lt;nav&gt;
<a name="l362"><span class="linenum"> 362</span></a>                      &lt;ul class=&quot;nav nav-pills pull-right&quot;&gt;
<a name="l363"><span class="linenum"> 363</span></a>                          &lt;li role=&quot;presentation&quot;&gt;&lt;a href="<a class="filename" href="../readme.html.html">../readme.html</a>"&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Read me'); ?&gt;&lt;/a&gt;&lt;/li&gt;
<a name="l364"><span class="linenum"> 364</span></a>                          &lt;li role=&quot;presentation&quot; class=&quot;active&quot;&gt;&lt;a href="<a class="filename" href="../index.php.html">index.php</a>"&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Installer'); ?&gt;&lt;/a&gt;&lt;/li&gt;
<a name="l365"><span class="linenum"> 365</span></a>                          &lt;li role=&quot;presentation&quot;&gt;&lt;a href="<a class="filename" href="../index.php.html">../index.php</a>"&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Your site'); ?&gt;&lt;/a&gt;&lt;/li&gt;
<a name="l366"><span class="linenum"> 366</span></a>                      &lt;/ul&gt;
<a name="l367"><span class="linenum"> 367</span></a>                  &lt;/nav&gt;
<a name="l368"><span class="linenum"> 368</span></a>                  &lt;h3 class=&quot;text-muted&quot;&gt;&lt;a href=&quot;http://b2evolution.net/&quot;&gt;&lt;img class=&quot;b2evolution_plane_logo&quot; src="<a class="filename" href="../rsc/img/b2evolution_254x52.svg.html">../rsc/img/b2evolution_254x52.svg</a>" alt=&quot;b2evolution CCMS&quot;&gt;&lt;/a&gt;&lt;/h3&gt;
<a name="l369"><span class="linenum"> 369</span></a>              &lt;/div&gt;
<a name="l370"><span class="linenum"> 370</span></a>          &lt;?php } ?&gt;
<a name="l371"><span class="linenum"> 371</span></a>  
<a name="l372"><span class="linenum"> 372</span></a>          &lt;!-- InstanceBeginEditable name=&quot;Main&quot; --&gt;
<a name="l373"><span class="linenum"> 373</span></a>  
<a name="l374"><span class="linenum"> 374</span></a>  &lt;?php
<a name="l375"><span class="linenum"> 375</span></a>  
<a name="l376"><span class="linenum"> 376</span></a>  if( ! <a class="var it6815" onMouseOver="hilite(6815)" onMouseOut="lolite()" onClick="logVariable('install_memory_limit_allow')" href="../_variables/install_memory_limit_allow.html">$install_memory_limit_allow</a> )
<a name="l377"><span class="linenum"> 377</span></a>  { // Display error that current memory limit size is not enough for correct using:
<a name="l378"><span class="linenum"> 378</span></a>      <a class="function" onClick="logFunction('display_install_messages')" href="../_functions/display_install_messages.html" onMouseOver="funcPopup(event,'display_install_messages')">display_install_messages</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Your PHP configuration only allows us to use %s of RAM. The absolute minimum we need to install b2evolution is 48M. Please contact your web host or use a &lt;a %s&gt;compatible hosting provider&lt;/a&gt;.'),
<a name="l379"><span class="linenum"> 379</span></a>          <a class="phpfunction" onClick="logFunction('ini_get')" href="../_functions/ini_get.html" onMouseOver="phpfuncPopup(event,'ini_get')">ini_get</a>( 'memory_limit' ), 'href=&quot;http://b2evolution.net/web-hosting/&quot;' ) );
<a name="l380"><span class="linenum"> 380</span></a>  }
<a name="l381"><span class="linenum"> 381</span></a>  
<a name="l382"><span class="linenum"> 382</span></a>  <span class="comment">// echo $action;</span>
<a name="l383"><span class="linenum"> 383</span></a>  <a class="var it6517" onMouseOver="hilite(6517)" onMouseOut="lolite()" onClick="logVariable('date_timezone')" href="../_variables/date_timezone.html">$date_timezone</a> = <a class="phpfunction" onClick="logFunction('ini_get')" href="../_functions/ini_get.html" onMouseOver="phpfuncPopup(event,'ini_get')">ini_get</a>( &quot;date.timezone&quot; );
<a name="l384"><span class="linenum"> 384</span></a>  if( empty( <a class="var it6517" onMouseOver="hilite(6517)" onMouseOut="lolite()" onClick="logVariable('date_timezone')" href="../_variables/date_timezone.html">$date_timezone</a> ) &amp;&amp; empty( <a class="var it2767" onMouseOver="hilite(2767)" onMouseOut="lolite()" onClick="logVariable('date_default_timezone')" href="../_variables/date_default_timezone.html">$date_default_timezone</a> ) )
<a name="l385"><span class="linenum"> 385</span></a>  { // The default timezone is not set, display a warning
<a name="l386"><span class="linenum"> 386</span></a>      <a class="function" onClick="logFunction('display_install_messages')" href="../_functions/display_install_messages.html" onMouseOver="funcPopup(event,'display_install_messages')">display_install_messages</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>(&quot;No default time zone is set. Please open PHP.ini and set the value of 'date.timezone' (Example: date.timezone = Europe/Paris) or open /conf/_advanced.php and set the value of %s (Example: %s)&quot;), '<a class="var it2767" onMouseOver="hilite(2767)" onMouseOut="lolite()" onClick="logVariable('date_default_timezone')" href="../_variables/date_default_timezone.html">$date_default_timezone</a>', '<a class="var it2767" onMouseOver="hilite(2767)" onMouseOut="lolite()" onClick="logVariable('date_default_timezone')" href="../_variables/date_default_timezone.html">$date_default_timezone</a> = \'Europe/Paris\';' ) );
<a name="l387"><span class="linenum"> 387</span></a>  }
<a name="l388"><span class="linenum"> 388</span></a>  
<a name="l389"><span class="linenum"> 389</span></a>  if( ( <a class="var it3710" onMouseOver="hilite(3710)" onMouseOut="lolite()" onClick="logVariable('config_is_done')" href="../_variables/config_is_done.html">$config_is_done</a> || <a class="var it6816" onMouseOver="hilite(6816)" onMouseOut="lolite()" onClick="logVariable('try_db_connect')" href="../_variables/try_db_connect.html">$try_db_connect</a> ) &amp;&amp; ( <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('error')" class="var it10754" onMouseOver="hilite(10754)" onMouseOut="lolite()" href="../_variables/error.html">error</a> ) )
<a name="l390"><span class="linenum"> 390</span></a>  { // DB connect was unsuccessful, restart conf
<a name="l391"><span class="linenum"> 391</span></a>      <a class="function" onClick="logFunction('display_install_messages')" href="../_functions/display_install_messages.html" onMouseOver="funcPopup(event,'display_install_messages')">display_install_messages</a>( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('ERROR: Impossible to connect to Database.') );
<a name="l392"><span class="linenum"> 392</span></a>      <a class="function" onClick="logFunction('display_install_messages')" href="../_functions/display_install_messages.html" onMouseOver="funcPopup(event,'display_install_messages')">display_install_messages</a>( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Check your database config settings below and update them if necessary...') );
<a name="l393"><span class="linenum"> 393</span></a>      <a class="function" onClick="logFunction('display_base_config_recap')" href="../_functions/display_base_config_recap.html" onMouseOver="funcPopup(event,'display_base_config_recap')">display_base_config_recap</a>();
<a name="l394"><span class="linenum"> 394</span></a>      if( <a class="var it378" onMouseOver="hilite(378)" onMouseOut="lolite()" onClick="logVariable('display')" href="../_variables/display.html">$display</a> == 'normal' )
<a name="l395"><span class="linenum"> 395</span></a>      { // Set action to display a start form of installation:
<a name="l396"><span class="linenum"> 396</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a> = 'start';
<a name="l397"><span class="linenum"> 397</span></a>      }
<a name="l398"><span class="linenum"> 398</span></a>      else // 'compact'
<a name="l399"><span class="linenum"> 399</span></a>      { // Use fake action to don't provide a form to set db access data on compact mode:
<a name="l400"><span class="linenum"> 400</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a> = 'none';
<a name="l401"><span class="linenum"> 401</span></a>      }
<a name="l402"><span class="linenum"> 402</span></a>  }
<a name="l403"><span class="linenum"> 403</span></a>  
<a name="l404"><span class="linenum"> 404</span></a>  <span class="comment">// Check other dependencies:</span>
<a name="l405"><span class="linenum"> 405</span></a>  <span class="comment">// TODO: Non-install/upgrade-actions should be allowed (e.g. &quot;deletedb&quot;)</span>
<a name="l406"><span class="linenum"> 406</span></a>  if( <a class="var it6823" onMouseOver="hilite(6823)" onMouseOut="lolite()" onClick="logVariable('req_errors')" href="../_variables/req_errors.html">$req_errors</a> = <a class="function" onClick="logFunction('install_validate_requirements')" href="../_functions/install_validate_requirements.html" onMouseOver="funcPopup(event,'install_validate_requirements')">install_validate_requirements</a>() )
<a name="l407"><span class="linenum"> 407</span></a>  {
<a name="l408"><span class="linenum"> 408</span></a>      echo '&lt;p class=&quot;text-danger&quot;&gt;&lt;strong&gt;&lt;evo:error&gt;'.<a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('b2evolution cannot be installed, because of the following errors:').'&lt;/evo:error&gt;&lt;/strong&gt;&lt;/p&gt;';
<a name="l409"><span class="linenum"> 409</span></a>      <a class="function" onClick="logFunction('display_install_messages')" href="../_functions/display_install_messages.html" onMouseOver="funcPopup(event,'display_install_messages')">display_install_messages</a>( <a class="var it6823" onMouseOver="hilite(6823)" onMouseOut="lolite()" onClick="logVariable('req_errors')" href="../_variables/req_errors.html">$req_errors</a> );
<a name="l410"><span class="linenum"> 410</span></a>      die;
<a name="l411"><span class="linenum"> 411</span></a>  }
<a name="l412"><span class="linenum"> 412</span></a>  
<a name="l413"><span class="linenum"> 413</span></a>  switch( <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a> )
<a name="l414"><span class="linenum"> 414</span></a>  {
<a name="l415"><span class="linenum"> 415</span></a>      case 'conf':
<a name="l416"><span class="linenum"> 416</span></a>          <span class="comment">/*</span>
<a name="l417"><span class="linenum"> 417</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l418"><span class="linenum"> 418</span></a>  <span class="comment">         * Write conf file:</span>
<a name="l419"><span class="linenum"> 419</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l420"><span class="linenum"> 420</span></a>  <span class="comment">         */</span>
<a name="l421"><span class="linenum"> 421</span></a>          <a class="function" onClick="logFunction('display_locale_selector')" href="../_functions/display_locale_selector.html" onMouseOver="funcPopup(event,'display_locale_selector')">display_locale_selector</a>();
<a name="l422"><span class="linenum"> 422</span></a>  
<a name="l423"><span class="linenum"> 423</span></a>          <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_db_user', 'string', true );
<a name="l424"><span class="linenum"> 424</span></a>          <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_db_password', 'raw', true );
<a name="l425"><span class="linenum"> 425</span></a>          <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_db_name', 'string', true );
<a name="l426"><span class="linenum"> 426</span></a>          <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_db_host', 'string', true );
<a name="l427"><span class="linenum"> 427</span></a>          <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_db_tableprefix', 'string', <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('tableprefix')" href="../_variables/tableprefix.html">$tableprefix</a> );
<a name="l428"><span class="linenum"> 428</span></a>          <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_baseurl', 'string', true );
<a name="l429"><span class="linenum"> 429</span></a>          <a class="var it6824" onMouseOver="hilite(6824)" onMouseOut="lolite()" onClick="logVariable('conf_baseurl')" href="../_variables/conf_baseurl.html">$conf_baseurl</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>( '#(/)?$#', '', <a class="var it6824" onMouseOver="hilite(6824)" onMouseOut="lolite()" onClick="logVariable('conf_baseurl')" href="../_variables/conf_baseurl.html">$conf_baseurl</a> ).'/'; <span class="comment">// force trailing slash</span>
<a name="l430"><span class="linenum"> 430</span></a>          <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_admin_email', 'string', true );
<a name="l431"><span class="linenum"> 431</span></a>  
<a name="l432"><span class="linenum"> 432</span></a>  <span class="comment">        // Try to create/update basic config file:</span>
<a name="l433"><span class="linenum"> 433</span></a>          <a class="var it6825" onMouseOver="hilite(6825)" onMouseOut="lolite()" onClick="logVariable('basic_config_params')" href="../_variables/basic_config_params.html">$basic_config_params</a> = array(
<a name="l434"><span class="linenum"> 434</span></a>                  'db_user'        =&gt; <a class="var it6826" onMouseOver="hilite(6826)" onMouseOut="lolite()" onClick="logVariable('conf_db_user')" href="../_variables/conf_db_user.html">$conf_db_user</a>,
<a name="l435"><span class="linenum"> 435</span></a>                  'db_password'    =&gt; <a class="var it6827" onMouseOver="hilite(6827)" onMouseOut="lolite()" onClick="logVariable('conf_db_password')" href="../_variables/conf_db_password.html">$conf_db_password</a>,
<a name="l436"><span class="linenum"> 436</span></a>                  'db_name'        =&gt; <a class="var it6828" onMouseOver="hilite(6828)" onMouseOut="lolite()" onClick="logVariable('conf_db_name')" href="../_variables/conf_db_name.html">$conf_db_name</a>,
<a name="l437"><span class="linenum"> 437</span></a>                  'db_host'        =&gt; <a class="var it6829" onMouseOver="hilite(6829)" onMouseOut="lolite()" onClick="logVariable('conf_db_host')" href="../_variables/conf_db_host.html">$conf_db_host</a>,
<a name="l438"><span class="linenum"> 438</span></a>                  'db_tableprefix' =&gt; <a class="var it6830" onMouseOver="hilite(6830)" onMouseOut="lolite()" onClick="logVariable('conf_db_tableprefix')" href="../_variables/conf_db_tableprefix.html">$conf_db_tableprefix</a>,
<a name="l439"><span class="linenum"> 439</span></a>                  'baseurl'        =&gt; <a class="var it6824" onMouseOver="hilite(6824)" onMouseOut="lolite()" onClick="logVariable('conf_baseurl')" href="../_variables/conf_baseurl.html">$conf_baseurl</a>,
<a name="l440"><span class="linenum"> 440</span></a>                  'admin_email'    =&gt; <a class="var it6831" onMouseOver="hilite(6831)" onMouseOut="lolite()" onClick="logVariable('conf_admin_email')" href="../_variables/conf_admin_email.html">$conf_admin_email</a>,
<a name="l441"><span class="linenum"> 441</span></a>              );
<a name="l442"><span class="linenum"> 442</span></a>          if( ! <a class="function" onClick="logFunction('update_basic_config_file')" href="../_functions/update_basic_config_file.html" onMouseOver="funcPopup(event,'update_basic_config_file')">update_basic_config_file</a>( <a class="var it6825" onMouseOver="hilite(6825)" onMouseOut="lolite()" onClick="logVariable('basic_config_params')" href="../_variables/basic_config_params.html">$basic_config_params</a> ) )
<a name="l443"><span class="linenum"> 443</span></a>          { // Break here if some error on creating/updating basic config file
<a name="l444"><span class="linenum"> 444</span></a>              break;
<a name="l445"><span class="linenum"> 445</span></a>          }
<a name="l446"><span class="linenum"> 446</span></a>  <span class="comment">        // ATTENTION: we continue here...</span>
<a name="l447"><span class="linenum"> 447</span></a>  
<a name="l448"><span class="linenum"> 448</span></a>      case 'start':
<a name="l449"><span class="linenum"> 449</span></a>      case 'default':
<a name="l450"><span class="linenum"> 450</span></a>          <span class="comment">/*</span>
<a name="l451"><span class="linenum"> 451</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l452"><span class="linenum"> 452</span></a>  <span class="comment">         * Start of install procedure:</span>
<a name="l453"><span class="linenum"> 453</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l454"><span class="linenum"> 454</span></a>  <span class="comment">         */</span>
<a name="l455"><span class="linenum"> 455</span></a>          if( ! <a class="var it6815" onMouseOver="hilite(6815)" onMouseOut="lolite()" onClick="logVariable('install_memory_limit_allow')" href="../_variables/install_memory_limit_allow.html">$install_memory_limit_allow</a> )
<a name="l456"><span class="linenum"> 456</span></a>          { // Don't allow any action when minimum memory limit is not enough for using:
<a name="l457"><span class="linenum"> 457</span></a>  
<a name="l458"><span class="linenum"> 458</span></a>  <span class="comment">            // Display only a locale selector:</span>
<a name="l459"><span class="linenum"> 459</span></a>              <a class="function" onClick="logFunction('display_locale_selector')" href="../_functions/display_locale_selector.html" onMouseOver="funcPopup(event,'display_locale_selector')">display_locale_selector</a>();
<a name="l460"><span class="linenum"> 460</span></a>  
<a name="l461"><span class="linenum"> 461</span></a>              break;
<a name="l462"><span class="linenum"> 462</span></a>          }
<a name="l463"><span class="linenum"> 463</span></a>  
<a name="l464"><span class="linenum"> 464</span></a>          if( <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a> == 'start' || !<a class="var it3710" onMouseOver="hilite(3710)" onMouseOut="lolite()" onClick="logVariable('config_is_done')" href="../_variables/config_is_done.html">$config_is_done</a> )
<a name="l465"><span class="linenum"> 465</span></a>          {
<a name="l466"><span class="linenum"> 466</span></a>              <a class="function" onClick="logFunction('track_step')" href="../_functions/track_step.html" onMouseOver="funcPopup(event,'track_step')">track_step</a>( 'installer-startdb' );
<a name="l467"><span class="linenum"> 467</span></a>  
<a name="l468"><span class="linenum"> 468</span></a>              <a class="function" onClick="logFunction('display_locale_selector')" href="../_functions/display_locale_selector.html" onMouseOver="funcPopup(event,'display_locale_selector')">display_locale_selector</a>();
<a name="l469"><span class="linenum"> 469</span></a>  
<a name="l470"><span class="linenum"> 470</span></a>              echo '&lt;h1&gt;'.<a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Base configuration').'&lt;/h1&gt;';
<a name="l471"><span class="linenum"> 471</span></a>  
<a name="l472"><span class="linenum"> 472</span></a>              if( <a class="var it3710" onMouseOver="hilite(3710)" onMouseOut="lolite()" onClick="logVariable('config_is_done')" href="../_variables/config_is_done.html">$config_is_done</a> &amp;&amp; <a class="var it2921" onMouseOver="hilite(2921)" onMouseOut="lolite()" onClick="logVariable('allow_evodb_reset')" href="../_variables/allow_evodb_reset.html">$allow_evodb_reset</a> != 1 )
<a name="l473"><span class="linenum"> 473</span></a>              {
<a name="l474"><span class="linenum"> 474</span></a>                  echo '&lt;p&gt;&lt;strong&gt;'.<a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Resetting the base configuration is currently disabled for security reasons.').'&lt;/strong&gt;&lt;/p&gt;';
<a name="l475"><span class="linenum"> 475</span></a>                  echo '&lt;p&gt;'.sprintf( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('To enable it, please go to the %s file and change: %s to %s'), '/conf/_basic_config.php', '&lt;pre&gt;<a class="var it2921" onMouseOver="hilite(2921)" onMouseOut="lolite()" onClick="logVariable('allow_evodb_reset')" href="../_variables/allow_evodb_reset.html">$allow_evodb_reset</a> = 0;&lt;/pre&gt;', '&lt;pre&gt;<a class="var it2921" onMouseOver="hilite(2921)" onMouseOut="lolite()" onClick="logVariable('allow_evodb_reset')" href="../_variables/allow_evodb_reset.html">$allow_evodb_reset</a> = 1;&lt;/pre&gt;' ).'&lt;/p&gt;';
<a name="l476"><span class="linenum"> 476</span></a>                  echo '&lt;p&gt;'.<a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Then reload this page and a reset option will appear.').'&lt;/p&gt;';
<a name="l477"><span class="linenum"> 477</span></a>                  <a class="function" onClick="logFunction('block_close')" href="../_functions/block_close.html" onMouseOver="funcPopup(event,'block_close')">block_close</a>();
<a name="l478"><span class="linenum"> 478</span></a>                  break;
<a name="l479"><span class="linenum"> 479</span></a>              }
<a name="l480"><span class="linenum"> 480</span></a>              else
<a name="l481"><span class="linenum"> 481</span></a>              {
<a name="l482"><span class="linenum"> 482</span></a>  
<a name="l483"><span class="linenum"> 483</span></a>  <span class="comment">            // Set default params if not provided otherwise:</span>
<a name="l484"><span class="linenum"> 484</span></a>              <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_db_user', 'string', <a class="var it129" onMouseOver="hilite(129)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../_variables/db_config.html">$db_config</a>['user'] );
<a name="l485"><span class="linenum"> 485</span></a>              <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_db_password', 'raw', <a class="var it129" onMouseOver="hilite(129)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../_variables/db_config.html">$db_config</a>['password'] );
<a name="l486"><span class="linenum"> 486</span></a>              <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_db_name', 'string', <a class="var it129" onMouseOver="hilite(129)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../_variables/db_config.html">$db_config</a>['name'] );
<a name="l487"><span class="linenum"> 487</span></a>              <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_db_host', 'string', <a class="var it129" onMouseOver="hilite(129)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../_variables/db_config.html">$db_config</a>['host'] );
<a name="l488"><span class="linenum"> 488</span></a>              <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_db_tableprefix', 'string', <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('tableprefix')" href="../_variables/tableprefix.html">$tableprefix</a> );
<a name="l489"><span class="linenum"> 489</span></a>  <span class="comment">            // Guess baseurl:</span>
<a name="l490"><span class="linenum"> 490</span></a>  <span class="comment">            // TODO: dh&gt; IMHO HTTP_HOST would be a better default, because it's what the user accesses for install.</span>
<a name="l491"><span class="linenum"> 491</span></a>  <span class="comment">            //       fp, please change it, if it's ok. SERVER_NAME might get used if HTTP_HOST is not given, but that shouldn't be the case normally.</span>
<a name="l492"><span class="linenum"> 492</span></a>  <span class="comment">            // fp&gt; ok for change and test after first 3.x-stable release</span>
<a name="l493"><span class="linenum"> 493</span></a>              <a class="var it461" onMouseOver="hilite(461)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../_variables/baseurl.html">$baseurl</a> = 'http://'.( isset( <a class="var it142" onMouseOver="hilite(142)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['SERVER_NAME'] ) ? <a class="var it142" onMouseOver="hilite(142)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['SERVER_NAME'] : 'yourserver.com' );
<a name="l494"><span class="linenum"> 494</span></a>              if( isset( <a class="var it142" onMouseOver="hilite(142)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['SERVER_PORT'] ) &amp;&amp; ( <a class="var it142" onMouseOver="hilite(142)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['SERVER_PORT'] != '80' ) )
<a name="l495"><span class="linenum"> 495</span></a>                  <a class="var it461" onMouseOver="hilite(461)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../_variables/baseurl.html">$baseurl</a> .= ':'.<a class="var it142" onMouseOver="hilite(142)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['SERVER_PORT'];
<a name="l496"><span class="linenum"> 496</span></a>  
<a name="l497"><span class="linenum"> 497</span></a>  <span class="comment">            // ############ Get ReqPath &amp; ReqURI ##############</span>
<a name="l498"><span class="linenum"> 498</span></a>              <a class="function" onClick="logFunction('list')" href="../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it618" onMouseOver="hilite(618)" onMouseOut="lolite()" onClick="logVariable('ReqPath')" href="../_variables/ReqPath.html">$ReqPath</a>,<a class="var it477" onMouseOver="hilite(477)" onMouseOut="lolite()" onClick="logVariable('ReqURI')" href="../_variables/ReqURI.html">$ReqURI</a>) = <a class="function" onClick="logFunction('get_ReqURI')" href="../_functions/get_requri.html" onMouseOver="funcPopup(event,'get_requri')">get_ReqURI</a>();
<a name="l499"><span class="linenum"> 499</span></a>  
<a name="l500"><span class="linenum"> 500</span></a>              <a class="var it461" onMouseOver="hilite(461)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../_variables/baseurl.html">$baseurl</a> .= <a class="phpfunction" onClick="logFunction('preg_replace')" href="../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>( '#/<a class="function" onClick="logFunction('install')" href="../_functions/install.html" onMouseOver="funcPopup(event,'install')">install</a>(/(index.php)?)?$#', '', <a class="var it618" onMouseOver="hilite(618)" onMouseOut="lolite()" onClick="logVariable('ReqPath')" href="../_variables/ReqPath.html">$ReqPath</a> ).'/';
<a name="l501"><span class="linenum"> 501</span></a>  
<a name="l502"><span class="linenum"> 502</span></a>              <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_baseurl', 'string', <a class="var it461" onMouseOver="hilite(461)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../_variables/baseurl.html">$baseurl</a> );
<a name="l503"><span class="linenum"> 503</span></a>              <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_admin_email', 'string', <a class="var it3556" onMouseOver="hilite(3556)" onMouseOut="lolite()" onClick="logVariable('admin_email')" href="../_variables/admin_email.html">$admin_email</a> );
<a name="l504"><span class="linenum"> 504</span></a>  
<a name="l505"><span class="linenum"> 505</span></a>              ?&gt;
<a name="l506"><span class="linenum"> 506</span></a>  
<a name="l507"><span class="linenum"> 507</span></a>              &lt;p&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The basic configuration <a class="phpfunction" onClick="logFunction('file')" href="../_functions/file.html" onMouseOver="phpfuncPopup(event,'file')">file</a> (&lt;code&gt;/conf/_basic_config.php&lt;/code&gt;) has not been created yet. You can do automatically generate it by filling out the form below.') ?&gt;&lt;/p&gt;
<a name="l508"><span class="linenum"> 508</span></a>  
<a name="l509"><span class="linenum"> 509</span></a>              &lt;p&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('This is the minimum info we need to set up b2evolution on this server:') ?&gt;&lt;/p&gt;
<a name="l510"><span class="linenum"> 510</span></a>  
<a name="l511"><span class="linenum"> 511</span></a>              &lt;?php
<a name="l512"><span class="linenum"> 512</span></a>              <a class="var it158" onMouseOver="hilite(158)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../_variables/Form.html">$Form</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Form')" href="../_classes/form.html" onMouseOver="classPopup(event,'form')">Form</a>( '<a class="filename" href="../index.php.html">index.php</a>' );
<a name="l513"><span class="linenum"> 513</span></a>  
<a name="l514"><span class="linenum"> 514</span></a>              <a class="var it158" onMouseOver="hilite(158)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('switch_template_parts')" href="../_functions/switch_template_parts.html" onMouseOver="funcPopup(event,'switch_template_parts')">switch_template_parts</a>( <a class="var it6822" onMouseOver="hilite(6822)" onMouseOut="lolite()" onClick="logVariable('booststrap_install_form_params')" href="../_variables/booststrap_install_form_params.html">$booststrap_install_form_params</a> );
<a name="l515"><span class="linenum"> 515</span></a>  
<a name="l516"><span class="linenum"> 516</span></a>              <a class="var it158" onMouseOver="hilite(158)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('begin_form')" href="../_functions/begin_form.html" onMouseOver="funcPopup(event,'begin_form')">begin_form</a>( 'form-horizontal' );
<a name="l517"><span class="linenum"> 517</span></a>  
<a name="l518"><span class="linenum"> 518</span></a>              <a class="var it158" onMouseOver="hilite(158)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('hidden')" href="../_functions/hidden.html" onMouseOver="funcPopup(event,'hidden')">hidden</a>( 'action', 'conf' );
<a name="l519"><span class="linenum"> 519</span></a>              <a class="var it158" onMouseOver="hilite(158)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('hidden')" href="../_functions/hidden.html" onMouseOver="funcPopup(event,'hidden')">hidden</a>( 'locale', <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a> );
<a name="l520"><span class="linenum"> 520</span></a>  
<a name="l521"><span class="linenum"> 521</span></a>              <a class="function" onClick="logFunction('block_open')" href="../_functions/block_open.html" onMouseOver="funcPopup(event,'block_open')">block_open</a>( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Database you want to install into') );
<a name="l522"><span class="linenum"> 522</span></a>              ?&gt;
<a name="l523"><span class="linenum"> 523</span></a>                  &lt;p class=&quot;text-muted small&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('b2evolution stores blog posts, comments, user permissions, etc. in a MySQL database. You must create this database prior to installing b2evolution and provide the access parameters to this database below. If you are not familiar with this, you can ask your hosting provider to create the database for you.') ?&gt;&lt;/p&gt;
<a name="l524"><span class="linenum"> 524</span></a>                  &lt;?php
<a name="l525"><span class="linenum"> 525</span></a>                  <a class="var it158" onMouseOver="hilite(158)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('text')" href="../_functions/text.html" onMouseOver="funcPopup(event,'text')">text</a>( 'conf_db_host', <a class="var it6829" onMouseOver="hilite(6829)" onMouseOut="lolite()" onClick="logVariable('conf_db_host')" href="../_variables/conf_db_host.html">$conf_db_host</a>, 16, <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('MySQL Host/Server'), sprintf( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Typically looks like &quot;localhost&quot; or &quot;sql-6&quot; or &quot;sql-8.yourhost.net&quot;...' ) ), 120 );
<a name="l526"><span class="linenum"> 526</span></a>                  <a class="var it158" onMouseOver="hilite(158)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('text')" href="../_functions/text.html" onMouseOver="funcPopup(event,'text')">text</a>( 'conf_db_name', <a class="var it6828" onMouseOver="hilite(6828)" onMouseOut="lolite()" onClick="logVariable('conf_db_name')" href="../_variables/conf_db_name.html">$conf_db_name</a>, 16, <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('MySQL Database'), sprintf( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Name of the MySQL database you have created on the server' ) ), 100);
<a name="l527"><span class="linenum"> 527</span></a>                  <a class="var it158" onMouseOver="hilite(158)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('text')" href="../_functions/text.html" onMouseOver="funcPopup(event,'text')">text</a>( 'conf_db_user', <a class="var it6826" onMouseOver="hilite(6826)" onMouseOut="lolite()" onClick="logVariable('conf_db_user')" href="../_variables/conf_db_user.html">$conf_db_user</a>, 16, <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('MySQL Username'), sprintf( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Used by b2evolution to access the MySQL database' ) ), 100 );
<a name="l528"><span class="linenum"> 528</span></a>                  <a class="var it158" onMouseOver="hilite(158)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('text')" href="../_functions/text.html" onMouseOver="funcPopup(event,'text')">text</a>( 'conf_db_password', <a class="var it6827" onMouseOver="hilite(6827)" onMouseOut="lolite()" onClick="logVariable('conf_db_password')" href="../_variables/conf_db_password.html">$conf_db_password</a>, 16, <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('MySQL Password'), sprintf( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Used by b2evolution to access the MySQL database' ) ), 100 ); <span class="comment">// no need to hyde this. nobody installs b2evolution from a public place</span>
<a name="l529"><span class="linenum"> 529</span></a>  <span class="comment">                // Too confusing for (most) newbies.    form_text( 'conf_db_tableprefix', $conf_db_tableprefix, 16, T_('MySQL tables prefix'), sprintf( T_('All DB tables will be prefixed with this. You need to change this only if you want to have multiple b2evo installations in the same DB.' ) ), 30 );</span>
<a name="l530"><span class="linenum"> 530</span></a>              <a class="function" onClick="logFunction('block_close')" href="../_functions/block_close.html" onMouseOver="funcPopup(event,'block_close')">block_close</a>();
<a name="l531"><span class="linenum"> 531</span></a>  
<a name="l532"><span class="linenum"> 532</span></a>              <a class="function" onClick="logFunction('block_open')" href="../_functions/block_open.html" onMouseOver="funcPopup(event,'block_open')">block_open</a>( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Additional settings') );
<a name="l533"><span class="linenum"> 533</span></a>                  <a class="var it158" onMouseOver="hilite(158)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('text')" href="../_functions/text.html" onMouseOver="funcPopup(event,'text')">text</a>( 'conf_baseurl', <a class="var it6824" onMouseOver="hilite(6824)" onMouseOut="lolite()" onClick="logVariable('conf_baseurl')" href="../_variables/conf_baseurl.html">$conf_baseurl</a>, 50, <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Base URL'), sprintf( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('This is where b2evo and your blogs reside by default. CHECK THIS CAREFULLY or not much will work. If you want to test b2evolution on your local machine, in order for login cookies to work, you MUST use http://&lt;strong&gt;localhost&lt;/strong&gt;/path... Do NOT use your machine\'s name!' ) ), 120 );
<a name="l534"><span class="linenum"> 534</span></a>                  <a class="var it158" onMouseOver="hilite(158)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('text')" href="../_functions/text.html" onMouseOver="funcPopup(event,'text')">text</a>( 'conf_admin_email', <a class="var it6831" onMouseOver="hilite(6831)" onMouseOut="lolite()" onClick="logVariable('conf_admin_email')" href="../_variables/conf_admin_email.html">$conf_admin_email</a>, 50, <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Your email'), sprintf( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('This is used to create your admin account. You will receive notifications for comments on your blog, etc.' ) ), 80 );
<a name="l535"><span class="linenum"> 535</span></a>              <a class="function" onClick="logFunction('block_close')" href="../_functions/block_close.html" onMouseOver="funcPopup(event,'block_close')">block_close</a>();
<a name="l536"><span class="linenum"> 536</span></a>  
<a name="l537"><span class="linenum"> 537</span></a>              <a class="var it158" onMouseOver="hilite(158)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('end_form')" href="../_functions/end_form.html" onMouseOver="funcPopup(event,'end_form')">end_form</a>( array( array( 'name' =&gt; 'submit', 'value' =&gt; <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Update config file'), 'class' =&gt; 'btn-primary btn-lg' ),
<a name="l538"><span class="linenum"> 538</span></a>                      array( 'type' =&gt; 'reset', 'value' =&gt; <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Reset'), 'class' =&gt; 'btn-default btn-lg' )
<a name="l539"><span class="linenum"> 539</span></a>                  ) );
<a name="l540"><span class="linenum"> 540</span></a>  
<a name="l541"><span class="linenum"> 541</span></a>              break;
<a name="l542"><span class="linenum"> 542</span></a>              }
<a name="l543"><span class="linenum"> 543</span></a>          }
<a name="l544"><span class="linenum"> 544</span></a>  <span class="comment">        // if config was already done, move on to main menu:</span>
<a name="l545"><span class="linenum"> 545</span></a>  
<a name="l546"><span class="linenum"> 546</span></a>      case 'menu':
<a name="l547"><span class="linenum"> 547</span></a>          <span class="comment">/*</span>
<a name="l548"><span class="linenum"> 548</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l549"><span class="linenum"> 549</span></a>  <span class="comment">         * Menu (STEP 1)</span>
<a name="l550"><span class="linenum"> 550</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l551"><span class="linenum"> 551</span></a>  <span class="comment">         */</span>
<a name="l552"><span class="linenum"> 552</span></a>          <a class="function" onClick="logFunction('track_step')" href="../_functions/track_step.html" onMouseOver="funcPopup(event,'track_step')">track_step</a>( 'installer-menu' );
<a name="l553"><span class="linenum"> 553</span></a>  
<a name="l554"><span class="linenum"> 554</span></a>          <a class="function" onClick="logFunction('display_locale_selector')" href="../_functions/display_locale_selector.html" onMouseOver="funcPopup(event,'display_locale_selector')">display_locale_selector</a>();
<a name="l555"><span class="linenum"> 555</span></a>  
<a name="l556"><span class="linenum"> 556</span></a>          ?&gt;
<a name="l557"><span class="linenum"> 557</span></a>          &lt;h1&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('How would you like your b2evolution installed?') ?&gt;&lt;/h1&gt;
<a name="l558"><span class="linenum"> 558</span></a>  
<a name="l559"><span class="linenum"> 559</span></a>          &lt;?php
<a name="l560"><span class="linenum"> 560</span></a>              <a class="var it6821" onMouseOver="hilite(6821)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../_variables/old_db_version.html">$old_db_version</a> = <a class="function" onClick="logFunction('get_db_version')" href="../_functions/get_db_version.html" onMouseOver="funcPopup(event,'get_db_version')">get_db_version</a>();
<a name="l561"><span class="linenum"> 561</span></a>              <a class="var it5141" onMouseOver="hilite(5141)" onMouseOut="lolite()" onClick="logVariable('require_charset_update')" href="../_variables/require_charset_update.html">$require_charset_update</a> = false;
<a name="l562"><span class="linenum"> 562</span></a>  
<a name="l563"><span class="linenum"> 563</span></a>              if( ! <a class="phpfunction" onClick="logFunction('is_null')" href="../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>( <a class="var it6821" onMouseOver="hilite(6821)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../_variables/old_db_version.html">$old_db_version</a> ) )
<a name="l564"><span class="linenum"> 564</span></a>              {
<a name="l565"><span class="linenum"> 565</span></a>                  <a class="var it5139" onMouseOver="hilite(5139)" onMouseOut="lolite()" onClick="logVariable('expected_connection_charset')" href="../_variables/expected_connection_charset.html">$expected_connection_charset</a> = <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('php_to_mysql_charmap')" href="../_functions/php_to_mysql_charmap.html" onMouseOver="funcPopup(event,'php_to_mysql_charmap')">php_to_mysql_charmap</a>( <a class="var it926" onMouseOver="hilite(926)" onMouseOut="lolite()" onClick="logVariable('evo_charset')" href="../_variables/evo_charset.html">$evo_charset</a> );
<a name="l566"><span class="linenum"> 566</span></a>                  if( <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('connection_charset')" class="var it10754" onMouseOver="hilite(10754)" onMouseOut="lolite()" href="../_variables/connection_charset.html">connection_charset</a> != <a class="var it5139" onMouseOver="hilite(5139)" onMouseOut="lolite()" onClick="logVariable('expected_connection_charset')" href="../_variables/expected_connection_charset.html">$expected_connection_charset</a> )
<a name="l567"><span class="linenum"> 567</span></a>                  {
<a name="l568"><span class="linenum"> 568</span></a>                      <a class="function" onClick="logFunction('display_install_messages')" href="../_functions/display_install_messages.html" onMouseOver="funcPopup(event,'display_install_messages')">display_install_messages</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('In order to install b2evolution with the %s locale, your MySQL needs to support the %s connection charset.').' (mysqli::set_charset(%s))',
<a name="l569"><span class="linenum"> 569</span></a>                          <a class="var it3554" onMouseOver="hilite(3554)" onMouseOut="lolite()" onClick="logVariable('current_locale')" href="../_variables/current_locale.html">$current_locale</a>, <a class="var it926" onMouseOver="hilite(926)" onMouseOut="lolite()" onClick="logVariable('evo_charset')" href="../_variables/evo_charset.html">$evo_charset</a>, <a class="var it5139" onMouseOver="hilite(5139)" onMouseOut="lolite()" onClick="logVariable('expected_connection_charset')" href="../_variables/expected_connection_charset.html">$expected_connection_charset</a> ) );
<a name="l570"><span class="linenum"> 570</span></a>  <span class="comment">                    // sam2kb&gt; TODO: If something is not supported we can display a message saying &quot;do this and that, enable extension X etc. etc... or switch to a better hosting&quot;.</span>
<a name="l571"><span class="linenum"> 571</span></a>                      break;
<a name="l572"><span class="linenum"> 572</span></a>                  }
<a name="l573"><span class="linenum"> 573</span></a>                  else
<a name="l574"><span class="linenum"> 574</span></a>                  { // Check if some of the tables have different charset than what we expect
<a name="l575"><span class="linenum"> 575</span></a>                      <a class="function" onClick="logFunction('load_funcs')" href="../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>( 'tools/model/_system.funcs.php' );
<a name="l576"><span class="linenum"> 576</span></a>                      if( <a class="function" onClick="logFunction('system_check_charset_update')" href="../_functions/system_check_charset_update.html" onMouseOver="funcPopup(event,'system_check_charset_update')">system_check_charset_update</a>() )
<a name="l577"><span class="linenum"> 577</span></a>                      {
<a name="l578"><span class="linenum"> 578</span></a>                          if( ! <a class="phpfunction" onClick="logFunction('is_null')" href="../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>( <a class="var it6821" onMouseOver="hilite(6821)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../_variables/old_db_version.html">$old_db_version</a> ) &amp;&amp; <a class="var it6821" onMouseOver="hilite(6821)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../_variables/old_db_version.html">$old_db_version</a> &lt; <a class="var it3593" onMouseOver="hilite(3593)" onMouseOut="lolite()" onClick="logVariable('new_db_version')" href="../_variables/new_db_version.html">$new_db_version</a> )
<a name="l579"><span class="linenum"> 579</span></a>                          { // DB is not updagraded to new version yet, We should not suggest to normalize DB to avoid errors
<a name="l580"><span class="linenum"> 580</span></a>                              <a class="function" onClick="logFunction('display_install_messages')" href="../_functions/display_install_messages.html" onMouseOver="funcPopup(event,'display_install_messages')">display_install_messages</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('WARNING: Some of your tables have a different charset than the expected %s. You should normalize your database after upgrade.'), <a class="function" onClick="logFunction('utf8_strtoupper')" href="../_functions/utf8_strtoupper.html" onMouseOver="funcPopup(event,'utf8_strtoupper')">utf8_strtoupper</a>( <a class="var it926" onMouseOver="hilite(926)" onMouseOut="lolite()" onClick="logVariable('evo_charset')" href="../_variables/evo_charset.html">$evo_charset</a> ) ), 'warning' );
<a name="l581"><span class="linenum"> 581</span></a>                          }
<a name="l582"><span class="linenum"> 582</span></a>                          else
<a name="l583"><span class="linenum"> 583</span></a>                          { // DB is already upgraded to last version, Siggest to normalize DB
<a name="l584"><span class="linenum"> 584</span></a>                              <a class="var it5141" onMouseOver="hilite(5141)" onMouseOut="lolite()" onClick="logVariable('require_charset_update')" href="../_variables/require_charset_update.html">$require_charset_update</a> = true;
<a name="l585"><span class="linenum"> 585</span></a>                              <a class="function" onClick="logFunction('display_install_messages')" href="../_functions/display_install_messages.html" onMouseOver="funcPopup(event,'display_install_messages')">display_install_messages</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('WARNING: Some of your tables have a different charset than the expected %s. It is strongly recommended to normalize your database charset by running the preselected task below:'), <a class="function" onClick="logFunction('utf8_strtoupper')" href="../_functions/utf8_strtoupper.html" onMouseOver="funcPopup(event,'utf8_strtoupper')">utf8_strtoupper</a>( <a class="var it926" onMouseOver="hilite(926)" onMouseOut="lolite()" onClick="logVariable('evo_charset')" href="../_variables/evo_charset.html">$evo_charset</a> ) ) );
<a name="l586"><span class="linenum"> 586</span></a>                          }
<a name="l587"><span class="linenum"> 587</span></a>                      }
<a name="l588"><span class="linenum"> 588</span></a>                  }
<a name="l589"><span class="linenum"> 589</span></a>              }
<a name="l590"><span class="linenum"> 590</span></a>          ?&gt;
<a name="l591"><span class="linenum"> 591</span></a>  
<a name="l592"><span class="linenum"> 592</span></a>          &lt;form action="<a class="filename" href="../index.php.html">index.php</a>" method=&quot;get&quot; class=&quot;evo_form__install&quot;&gt;
<a name="l593"><span class="linenum"> 593</span></a>              &lt;input type=&quot;hidden&quot; name=&quot;locale&quot; value=&quot;&lt;?php echo <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a> ?&gt;&quot; /&gt;
<a name="l594"><span class="linenum"> 594</span></a>              &lt;input type=&quot;hidden&quot; name=&quot;confirmed&quot; value=&quot;0&quot; /&gt;
<a name="l595"><span class="linenum"> 595</span></a>              &lt;input type=&quot;hidden&quot; name=&quot;installer_version&quot; value=&quot;10&quot; /&gt;
<a name="l596"><span class="linenum"> 596</span></a>  
<a name="l597"><span class="linenum"> 597</span></a>              &lt;p&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The installation can be done in different ways. Choose one:')?&gt;&lt;/p&gt;
<a name="l598"><span class="linenum"> 598</span></a>  
<a name="l599"><span class="linenum"> 599</span></a>              &lt;div class=&quot;radio&quot;&gt;
<a name="l600"><span class="linenum"> 600</span></a>                  &lt;label&gt;
<a name="l601"><span class="linenum"> 601</span></a>                      &lt;input type=&quot;radio&quot; name=&quot;action&quot; id=&quot;newdb&quot; value=&quot;menu-install&quot;
<a name="l602"><span class="linenum"> 602</span></a>                      &lt;?php
<a name="l603"><span class="linenum"> 603</span></a>  <span class="comment">                        // fp&gt; change the above to 'newdbsettings' for an additional settings screen.</span>
<a name="l604"><span class="linenum"> 604</span></a>                          if( <a class="phpfunction" onClick="logFunction('is_null')" href="../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it6821" onMouseOver="hilite(6821)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../_variables/old_db_version.html">$old_db_version</a>) )
<a name="l605"><span class="linenum"> 605</span></a>                          {
<a name="l606"><span class="linenum"> 606</span></a>                              echo 'checked=&quot;checked&quot;';
<a name="l607"><span class="linenum"> 607</span></a>                          }
<a name="l608"><span class="linenum"> 608</span></a>                      ?&gt;/&gt;
<a name="l609"><span class="linenum"> 609</span></a>                      &lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('&lt;strong&gt;New Install&lt;/strong&gt;: Install the b2evolution database tables. Optionally add some default contents.')?&gt;
<a name="l610"><span class="linenum"> 610</span></a>                  &lt;/label&gt;
<a name="l611"><span class="linenum"> 611</span></a>              &lt;/div&gt;
<a name="l612"><span class="linenum"> 612</span></a>  
<a name="l613"><span class="linenum"> 613</span></a>              &lt;div class=&quot;radio&quot;&gt;
<a name="l614"><span class="linenum"> 614</span></a>                  &lt;label&gt;
<a name="l615"><span class="linenum"> 615</span></a>                      &lt;input type=&quot;radio&quot; name=&quot;action&quot; id=&quot;evoupgrade&quot; value=&quot;evoupgrade&quot;
<a name="l616"><span class="linenum"> 616</span></a>                      &lt;?php if( !<a class="phpfunction" onClick="logFunction('is_null')" href="../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it6821" onMouseOver="hilite(6821)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../_variables/old_db_version.html">$old_db_version</a>) &amp;&amp; ! <a class="var it5141" onMouseOver="hilite(5141)" onMouseOut="lolite()" onClick="logVariable('require_charset_update')" href="../_variables/require_charset_update.html">$require_charset_update</a> &amp;&amp; <a class="var it6821" onMouseOver="hilite(6821)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../_variables/old_db_version.html">$old_db_version</a> &lt; <a class="var it3593" onMouseOver="hilite(3593)" onMouseOut="lolite()" onClick="logVariable('new_db_version')" href="../_variables/new_db_version.html">$new_db_version</a> )
<a name="l617"><span class="linenum"> 617</span></a>                          {
<a name="l618"><span class="linenum"> 618</span></a>                              echo 'checked=&quot;checked&quot;';
<a name="l619"><span class="linenum"> 619</span></a>                          }
<a name="l620"><span class="linenum"> 620</span></a>                      ?&gt;/&gt;
<a name="l621"><span class="linenum"> 621</span></a>                      &lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('&lt;strong&gt;Upgrade from a previous version of b2evolution&lt;/strong&gt;: Upgrade your b2evolution database tables in order to make them compatible with the current version. &lt;strong&gt;WARNING:&lt;/strong&gt; If you have modified your database, this operation may fail. Make sure you have a backup.') ?&gt;
<a name="l622"><span class="linenum"> 622</span></a>                  &lt;/label&gt;
<a name="l623"><span class="linenum"> 623</span></a>              &lt;/div&gt;
<a name="l624"><span class="linenum"> 624</span></a>  
<a name="l625"><span class="linenum"> 625</span></a>              &lt;?php
<a name="l626"><span class="linenum"> 626</span></a>              if( <a class="var it2921" onMouseOver="hilite(2921)" onMouseOut="lolite()" onClick="logVariable('allow_evodb_reset')" href="../_variables/allow_evodb_reset.html">$allow_evodb_reset</a> == 1 )
<a name="l627"><span class="linenum"> 627</span></a>              {
<a name="l628"><span class="linenum"> 628</span></a>              ?&gt;
<a name="l629"><span class="linenum"> 629</span></a>              &lt;div class=&quot;radio&quot;&gt;
<a name="l630"><span class="linenum"> 630</span></a>                  &lt;label&gt;
<a name="l631"><span class="linenum"> 631</span></a>                      &lt;input type=&quot;radio&quot; name=&quot;action&quot; id=&quot;deletedb&quot; value=&quot;deletedb&quot; /&gt;
<a name="l632"><span class="linenum"> 632</span></a>                      &lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('&lt;strong&gt;Delete b2evolution tables &amp;amp; cache files. WARNING:&lt;/strong&gt; All your b2evolution tables and data will be lost! Any non-b2evolution tables will remain untouched.')?&gt;
<a name="l633"><span class="linenum"> 633</span></a>                  &lt;/label&gt;
<a name="l634"><span class="linenum"> 634</span></a>              &lt;/div&gt;
<a name="l635"><span class="linenum"> 635</span></a>  
<a name="l636"><span class="linenum"> 636</span></a>              &lt;div class=&quot;radio&quot;&gt;
<a name="l637"><span class="linenum"> 637</span></a>                  &lt;label&gt;
<a name="l638"><span class="linenum"> 638</span></a>                      &lt;input type=&quot;radio&quot; name=&quot;action&quot; id=&quot;start&quot; value=&quot;start&quot; /&gt;
<a name="l639"><span class="linenum"> 639</span></a>                      &lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('&lt;strong&gt;Change your base configuration&lt;/strong&gt; (see recap below): You only want to do this in rare occasions where you may have moved your b2evolution files or database to a different location...')?&gt;
<a name="l640"><span class="linenum"> 640</span></a>                  &lt;/label&gt;
<a name="l641"><span class="linenum"> 641</span></a>              &lt;/div&gt;
<a name="l642"><span class="linenum"> 642</span></a>              &lt;?php
<a name="l643"><span class="linenum"> 643</span></a>              }
<a name="l644"><span class="linenum"> 644</span></a>              ?&gt;
<a name="l645"><span class="linenum"> 645</span></a>              &lt;div class=&quot;radio&quot;&gt;
<a name="l646"><span class="linenum"> 646</span></a>                  &lt;label&gt;
<a name="l647"><span class="linenum"> 647</span></a>                      &lt;input type=&quot;radio&quot; name=&quot;action&quot; id=&quot;utf8check&quot; value=&quot;utf8check&quot;&lt;?php echo ( <a class="var it5141" onMouseOver="hilite(5141)" onMouseOut="lolite()" onClick="logVariable('require_charset_update')" href="../_variables/require_charset_update.html">$require_charset_update</a> ) ? ' checked=&quot;checked&quot;' : '' ?&gt;/&gt;
<a name="l648"><span class="linenum"> 648</span></a>                      &lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('&lt;strong&gt;Convert/Normalize your DB to UTF-8/ASCII&lt;/strong&gt;: The content tables in your b2evolution MySQL database will be converted to UTF-8 instead of their current charset. Some system tables will also be converted to plain ASCII for better performance.')?&gt;
<a name="l649"><span class="linenum"> 649</span></a>                  &lt;/label&gt;
<a name="l650"><span class="linenum"> 650</span></a>              &lt;/div&gt;
<a name="l651"><span class="linenum"> 651</span></a>              &lt;?php
<a name="l652"><span class="linenum"> 652</span></a>  
<a name="l653"><span class="linenum"> 653</span></a>  
<a name="l654"><span class="linenum"> 654</span></a>              if( <a class="var it2921" onMouseOver="hilite(2921)" onMouseOut="lolite()" onClick="logVariable('allow_evodb_reset')" href="../_variables/allow_evodb_reset.html">$allow_evodb_reset</a> != 1 )
<a name="l655"><span class="linenum"> 655</span></a>              {
<a name="l656"><span class="linenum"> 656</span></a>                  echo '&lt;div class=&quot;pull-right&quot;&gt;&lt;a href=&quot;index.php?action=deletedb&amp;amp;locale='.<a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a>.'&quot;&gt;'.<a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Need to start anew?').' &amp;raquo;&lt;/a&gt;&lt;/div&gt;';
<a name="l657"><span class="linenum"> 657</span></a>              }
<a name="l658"><span class="linenum"> 658</span></a>              ?&gt;
<a name="l659"><span class="linenum"> 659</span></a>  
<a name="l660"><span class="linenum"> 660</span></a>              &lt;p class=&quot;evo_form__install_buttons&quot; style=&quot;margin-top:24px&quot;&gt;
<a name="l661"><span class="linenum"> 661</span></a>                  &lt;button id=&quot;install_button&quot; type=&quot;submit&quot; class=&quot;btn btn-primary btn-lg&quot;&gt;&amp;nbsp; &lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('GO!')?&gt; &amp;nbsp;&lt;/button&gt;
<a name="l662"><span class="linenum"> 662</span></a>              &lt;/p&gt;
<a name="l663"><span class="linenum"> 663</span></a>              &lt;/form&gt;
<a name="l664"><span class="linenum"> 664</span></a>          &lt;?php
<a name="l665"><span class="linenum"> 665</span></a>  
<a name="l666"><span class="linenum"> 666</span></a>          <a class="function" onClick="logFunction('display_base_config_recap')" href="../_functions/display_base_config_recap.html" onMouseOver="funcPopup(event,'display_base_config_recap')">display_base_config_recap</a>();
<a name="l667"><span class="linenum"> 667</span></a>          <a class="function" onClick="logFunction('echo_install_button_js')" href="../_functions/echo_install_button_js.html" onMouseOver="funcPopup(event,'echo_install_button_js')">echo_install_button_js</a>();
<a name="l668"><span class="linenum"> 668</span></a>          break;
<a name="l669"><span class="linenum"> 669</span></a>  
<a name="l670"><span class="linenum"> 670</span></a>      case 'menu-install':
<a name="l671"><span class="linenum"> 671</span></a>          <span class="comment">/*</span>
<a name="l672"><span class="linenum"> 672</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l673"><span class="linenum"> 673</span></a>  <span class="comment">         * b2evolution is already installed (STEP 2)</span>
<a name="l674"><span class="linenum"> 674</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l675"><span class="linenum"> 675</span></a>  <span class="comment">         */</span>
<a name="l676"><span class="linenum"> 676</span></a>          ?&gt;
<a name="l677"><span class="linenum"> 677</span></a>  
<a name="l678"><span class="linenum"> 678</span></a>          &lt;form action="<a class="filename" href="../index.php.html">index.php</a>" method=&quot;get&quot; class=&quot;evo_form__install&quot;&gt;
<a name="l679"><span class="linenum"> 679</span></a>              &lt;input type=&quot;hidden&quot; name=&quot;locale&quot; value=&quot;&lt;?php echo <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a> ?&gt;&quot; /&gt;
<a name="l680"><span class="linenum"> 680</span></a>              &lt;input type=&quot;hidden&quot; name=&quot;confirmed&quot; value=&quot;0&quot; /&gt;
<a name="l681"><span class="linenum"> 681</span></a>              &lt;input type=&quot;hidden&quot; name=&quot;installer_version&quot; value=&quot;10&quot; /&gt;
<a name="l682"><span class="linenum"> 682</span></a>  
<a name="l683"><span class="linenum"> 683</span></a>              &lt;h2&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('b2evolution is already installed') ?&gt;&lt;/h2&gt;
<a name="l684"><span class="linenum"> 684</span></a>  
<a name="l685"><span class="linenum"> 685</span></a>          &lt;?php
<a name="l686"><span class="linenum"> 686</span></a>          if( <a class="var it1073" onMouseOver="hilite(1073)" onMouseOut="lolite()" onClick="logVariable('test_install_all_features')" href="../_variables/test_install_all_features.html">$test_install_all_features</a> &amp;&amp; <a class="var it2921" onMouseOver="hilite(2921)" onMouseOut="lolite()" onClick="logVariable('allow_evodb_reset')" href="../_variables/allow_evodb_reset.html">$allow_evodb_reset</a> )
<a name="l687"><span class="linenum"> 687</span></a>          { // We can allow to continue installation with deleting DB
<a name="l688"><span class="linenum"> 688</span></a>          ?&gt;
<a name="l689"><span class="linenum"> 689</span></a>              &lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;menu-options&quot; /&gt;
<a name="l690"><span class="linenum"> 690</span></a>              &lt;p&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Would you like to DELETE ALL before RE-INSTALL?'); ?&gt;&lt;/p&gt;
<a name="l691"><span class="linenum"> 691</span></a>  
<a name="l692"><span class="linenum"> 692</span></a>              &lt;p class=&quot;text-danger&quot;&gt;&lt;evo:error&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('ATTENTION: all your b2evolution data will be lost and reset to its original state.'); ?&gt;&lt;/evo:error&gt;&lt;/p&gt;
<a name="l693"><span class="linenum"> 693</span></a>  
<a name="l694"><span class="linenum"> 694</span></a>              &lt;p class=&quot;evo_form__install_buttons&quot;&gt;
<a name="l695"><span class="linenum"> 695</span></a>                  &lt;button id=&quot;delete_button&quot; type=&quot;submit&quot; class=&quot;btn btn-danger btn-lg&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('DELETE ALL &amp; Continue')?&gt; &amp;raquo;&lt;/button&gt;&lt;?php
<a name="l696"><span class="linenum"> 696</span></a>                  ?&gt;&lt;a href=&quot;index.php?locale=&lt;?php echo <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a> ?&gt;&quot; class=&quot;btn btn-default btn-lg&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Cancel')?&gt;&lt;/a&gt;
<a name="l697"><span class="linenum"> 697</span></a>              &lt;/p&gt;
<a name="l698"><span class="linenum"> 698</span></a>          &lt;?php
<a name="l699"><span class="linenum"> 699</span></a>          }
<a name="l700"><span class="linenum"> 700</span></a>          else
<a name="l701"><span class="linenum"> 701</span></a>          { // Don't allow to continue installation because the DB deleting is disabled in config
<a name="l702"><span class="linenum"> 702</span></a>          ?&gt;
<a name="l703"><span class="linenum"> 703</span></a>              &lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;menu&quot; /&gt;
<a name="l704"><span class="linenum"> 704</span></a>              &lt;p&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('We cannot install because there is already a b2evolution installation in the current database. You may delete it first or maybe upgrade it to the latest version.'); ?&gt;&lt;/p&gt;
<a name="l705"><span class="linenum"> 705</span></a>  
<a name="l706"><span class="linenum"> 706</span></a>              &lt;p class=&quot;evo_form__install_buttons&quot;&gt;
<a name="l707"><span class="linenum"> 707</span></a>                  &lt;button id=&quot;cancel_button&quot; type=&quot;submit&quot; class=&quot;btn btn-primary btn-lg&quot;&gt;&amp;laquo; &lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Back to Menu')?&gt;&lt;/button&gt;
<a name="l708"><span class="linenum"> 708</span></a>              &lt;/p&gt;
<a name="l709"><span class="linenum"> 709</span></a>          &lt;?php } ?&gt;
<a name="l710"><span class="linenum"> 710</span></a>          &lt;/form&gt;
<a name="l711"><span class="linenum"> 711</span></a>  
<a name="l712"><span class="linenum"> 712</span></a>          &lt;?php
<a name="l713"><span class="linenum"> 713</span></a>          break;
<a name="l714"><span class="linenum"> 714</span></a>  
<a name="l715"><span class="linenum"> 715</span></a>      case 'menu-options':
<a name="l716"><span class="linenum"> 716</span></a>          <span class="comment">/*</span>
<a name="l717"><span class="linenum"> 717</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l718"><span class="linenum"> 718</span></a>  <span class="comment">         * Menu Install Options (STEP 3)</span>
<a name="l719"><span class="linenum"> 719</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l720"><span class="linenum"> 720</span></a>  <span class="comment">         */</span>
<a name="l721"><span class="linenum"> 721</span></a>          <a class="function" onClick="logFunction('track_step')" href="../_functions/track_step.html" onMouseOver="funcPopup(event,'track_step')">track_step</a>( 'installer-options' );
<a name="l722"><span class="linenum"> 722</span></a>          ?&gt;
<a name="l723"><span class="linenum"> 723</span></a>  
<a name="l724"><span class="linenum"> 724</span></a>          &lt;form action="<a class="filename" href="../index.php.html">index.php</a>" method=&quot;get&quot; class=&quot;evo_form__install&quot;&gt;
<a name="l725"><span class="linenum"> 725</span></a>              &lt;input type=&quot;hidden&quot; name=&quot;locale&quot; value=&quot;&lt;?php echo <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a> ?&gt;&quot; /&gt;
<a name="l726"><span class="linenum"> 726</span></a>              &lt;input type=&quot;hidden&quot; name=&quot;confirmed&quot; value=&quot;0&quot; /&gt;
<a name="l727"><span class="linenum"> 727</span></a>              &lt;input type=&quot;hidden&quot; name=&quot;installer_version&quot; value=&quot;10&quot; /&gt;
<a name="l728"><span class="linenum"> 728</span></a>              &lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;newdb&quot; /&gt;
<a name="l729"><span class="linenum"> 729</span></a>  
<a name="l730"><span class="linenum"> 730</span></a>              &lt;h2&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('b2evolution installation options') ?&gt;&lt;/h2&gt;
<a name="l731"><span class="linenum"> 731</span></a>  
<a name="l732"><span class="linenum"> 732</span></a>              &lt;p&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('You can start adding your own content whenever you\'re ready. Until then, it may be handy to have some demo contents to play around with. You can easily delete these demo contents once you\'re done testing.'); ?&gt;&lt;/p&gt;
<a name="l733"><span class="linenum"> 733</span></a>  
<a name="l734"><span class="linenum"> 734</span></a>              &lt;div class=&quot;checkbox&quot;&gt;
<a name="l735"><span class="linenum"> 735</span></a>                  &lt;label&gt;
<a name="l736"><span class="linenum"> 736</span></a>                      &lt;input type=&quot;checkbox&quot; name=&quot;create_sample_contents&quot; id=&quot;create_sample_contents&quot; value=&quot;1&quot; checked=&quot;checked&quot; /&gt;
<a name="l737"><span class="linenum"> 737</span></a>                      &lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Install sample collections &amp;amp; sample contents. The sample posts explain several features of b2evolution. This is highly recommended for new users.') ?&gt;
<a name="l738"><span class="linenum"> 738</span></a>                  &lt;/label&gt;
<a name="l739"><span class="linenum"> 739</span></a>                  &lt;div id=&quot;create_sample_contents_options&quot; style=&quot;margin:10px 0 0 20px&quot;&gt;
<a name="l740"><span class="linenum"> 740</span></a>                      &lt;?php
<a name="l741"><span class="linenum"> 741</span></a>                      echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Which demo collections would you like to install?');
<a name="l742"><span class="linenum"> 742</span></a>  
<a name="l743"><span class="linenum"> 743</span></a>  <span class="comment">                    // Display the collections to select which install</span>
<a name="l744"><span class="linenum"> 744</span></a>                      <a class="var it3619" onMouseOver="hilite(3619)" onMouseOut="lolite()" onClick="logVariable('collections')" href="../_variables/collections.html">$collections</a> = array(
<a name="l745"><span class="linenum"> 745</span></a>                              'home'   =&gt; <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Home'),
<a name="l746"><span class="linenum"> 746</span></a>                              'a'      =&gt; <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Blog A'),
<a name="l747"><span class="linenum"> 747</span></a>                              'b'      =&gt; <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Blog B'),
<a name="l748"><span class="linenum"> 748</span></a>                              'photos' =&gt; <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Photos'),
<a name="l749"><span class="linenum"> 749</span></a>                              'forums' =&gt; <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Forums'),
<a name="l750"><span class="linenum"> 750</span></a>                              'manual' =&gt; <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Manual'),
<a name="l751"><span class="linenum"> 751</span></a>                          );
<a name="l752"><span class="linenum"> 752</span></a>  
<a name="l753"><span class="linenum"> 753</span></a>  <span class="comment">                    // Allow all modules to set what collections should be installed</span>
<a name="l754"><span class="linenum"> 754</span></a>                      <a class="var it6832" onMouseOver="hilite(6832)" onMouseOut="lolite()" onClick="logVariable('module_collections')" href="../_variables/module_collections.html">$module_collections</a> = <a class="function" onClick="logFunction('modules_call_method')" href="../_functions/modules_call_method.html" onMouseOver="funcPopup(event,'modules_call_method')">modules_call_method</a>( 'get_demo_collections' );
<a name="l755"><span class="linenum"> 755</span></a>                      if( ! empty( <a class="var it6832" onMouseOver="hilite(6832)" onMouseOut="lolite()" onClick="logVariable('module_collections')" href="../_variables/module_collections.html">$module_collections</a> ) )
<a name="l756"><span class="linenum"> 756</span></a>                      {
<a name="l757"><span class="linenum"> 757</span></a>                          foreach( <a class="var it6832" onMouseOver="hilite(6832)" onMouseOut="lolite()" onClick="logVariable('module_collections')" href="../_variables/module_collections.html">$module_collections</a> as <a class="var it6833" onMouseOver="hilite(6833)" onMouseOut="lolite()" onClick="logVariable('module_key')" href="../_variables/module_key.html">$module_key</a> =&gt; <a class="var it6834" onMouseOver="hilite(6834)" onMouseOut="lolite()" onClick="logVariable('module_colls')" href="../_variables/module_colls.html">$module_colls</a> )
<a name="l758"><span class="linenum"> 758</span></a>                          {
<a name="l759"><span class="linenum"> 759</span></a>                              foreach( <a class="var it6834" onMouseOver="hilite(6834)" onMouseOut="lolite()" onClick="logVariable('module_colls')" href="../_variables/module_colls.html">$module_colls</a> as <a class="var it6835" onMouseOver="hilite(6835)" onMouseOut="lolite()" onClick="logVariable('module_coll_key')" href="../_variables/module_coll_key.html">$module_coll_key</a> =&gt; <a class="var it6836" onMouseOver="hilite(6836)" onMouseOut="lolite()" onClick="logVariable('module_coll_title')" href="../_variables/module_coll_title.html">$module_coll_title</a> )
<a name="l760"><span class="linenum"> 760</span></a>                              {
<a name="l761"><span class="linenum"> 761</span></a>                                  <a class="var it3619" onMouseOver="hilite(3619)" onMouseOut="lolite()" onClick="logVariable('collections')" href="../_variables/collections.html">$collections</a>[ <a class="var it6833" onMouseOver="hilite(6833)" onMouseOut="lolite()" onClick="logVariable('module_key')" href="../_variables/module_key.html">$module_key</a>.'_'.<a class="var it6835" onMouseOver="hilite(6835)" onMouseOut="lolite()" onClick="logVariable('module_coll_key')" href="../_variables/module_coll_key.html">$module_coll_key</a> ] = <a class="var it6836" onMouseOver="hilite(6836)" onMouseOut="lolite()" onClick="logVariable('module_coll_title')" href="../_variables/module_coll_title.html">$module_coll_title</a>;
<a name="l762"><span class="linenum"> 762</span></a>                              }
<a name="l763"><span class="linenum"> 763</span></a>                          }
<a name="l764"><span class="linenum"> 764</span></a>                      }
<a name="l765"><span class="linenum"> 765</span></a>  
<a name="l766"><span class="linenum"> 766</span></a>                      foreach( <a class="var it3619" onMouseOver="hilite(3619)" onMouseOut="lolite()" onClick="logVariable('collections')" href="../_variables/collections.html">$collections</a> as <a class="var it6837" onMouseOver="hilite(6837)" onMouseOut="lolite()" onClick="logVariable('coll_index')" href="../_variables/coll_index.html">$coll_index</a> =&gt; <a class="var it6838" onMouseOver="hilite(6838)" onMouseOut="lolite()" onClick="logVariable('coll_title')" href="../_variables/coll_title.html">$coll_title</a> )
<a name="l767"><span class="linenum"> 767</span></a>                      { // Display the checkboxes to select what demo collection to install
<a name="l768"><span class="linenum"> 768</span></a>                      ?&gt;
<a name="l769"><span class="linenum"> 769</span></a>                      &lt;div class=&quot;checkbox&quot; style=&quot;margin-left:1em&quot;&gt;
<a name="l770"><span class="linenum"> 770</span></a>                          &lt;label&gt;
<a name="l771"><span class="linenum"> 771</span></a>                              &lt;input type=&quot;checkbox&quot; name=&quot;collections[]&quot; id=&quot;collection_&lt;?php echo <a class="var it6837" onMouseOver="hilite(6837)" onMouseOut="lolite()" onClick="logVariable('coll_index')" href="../_variables/coll_index.html">$coll_index</a>; ?&gt;&quot; value=&quot;&lt;?php echo <a class="var it6837" onMouseOver="hilite(6837)" onMouseOut="lolite()" onClick="logVariable('coll_index')" href="../_variables/coll_index.html">$coll_index</a>; ?&gt;&quot; checked=&quot;checked&quot; /&gt;
<a name="l772"><span class="linenum"> 772</span></a>                              &lt;?php echo <a class="var it6838" onMouseOver="hilite(6838)" onMouseOut="lolite()" onClick="logVariable('coll_title')" href="../_variables/coll_title.html">$coll_title</a>; ?&gt;
<a name="l773"><span class="linenum"> 773</span></a>                          &lt;/label&gt;
<a name="l774"><span class="linenum"> 774</span></a>                      &lt;/div&gt;
<a name="l775"><span class="linenum"> 775</span></a>                      &lt;?php } ?&gt;
<a name="l776"><span class="linenum"> 776</span></a>                  &lt;/div&gt;
<a name="l777"><span class="linenum"> 777</span></a>              &lt;/div&gt;
<a name="l778"><span class="linenum"> 778</span></a>              &lt;?php
<a name="l779"><span class="linenum"> 779</span></a>                  if( <a class="var it1073" onMouseOver="hilite(1073)" onMouseOut="lolite()" onClick="logVariable('test_install_all_features')" href="../_variables/test_install_all_features.html">$test_install_all_features</a> )
<a name="l780"><span class="linenum"> 780</span></a>                  { // Checkbox to install all features
<a name="l781"><span class="linenum"> 781</span></a>              ?&gt;
<a name="l782"><span class="linenum"> 782</span></a>              &lt;div class=&quot;checkbox&quot; style=&quot;margin-top:15px&quot;&gt;
<a name="l783"><span class="linenum"> 783</span></a>                  &lt;label&gt;
<a name="l784"><span class="linenum"> 784</span></a>                      &lt;input accept=&quot;&quot;type=&quot;checkbox&quot; name=&quot;install_all_features&quot; id=&quot;install_all_features&quot; value=&quot;1&quot; /&gt;
<a name="l785"><span class="linenum"> 785</span></a>                      &lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Also install all test features.')?&gt;
<a name="l786"><span class="linenum"> 786</span></a>                  &lt;/label&gt;
<a name="l787"><span class="linenum"> 787</span></a>              &lt;/div&gt;
<a name="l788"><span class="linenum"> 788</span></a>              &lt;?php } ?&gt;
<a name="l789"><span class="linenum"> 789</span></a>              &lt;div class=&quot;checkbox&quot; style=&quot;margin:15px 0 15px&quot;&gt;
<a name="l790"><span class="linenum"> 790</span></a>                  &lt;label&gt;
<a name="l791"><span class="linenum"> 791</span></a>                      &lt;input type=&quot;checkbox&quot; name=&quot;local_installation&quot; id=&quot;local_installation&quot; value=&quot;1&quot;&lt;?php echo <a class="function" onClick="logFunction('check_local_installation')" href="../_functions/check_local_installation.html" onMouseOver="funcPopup(event,'check_local_installation')">check_local_installation</a>() ? ' checked=&quot;checked&quot;' : ''; ?&gt; /&gt;
<a name="l792"><span class="linenum"> 792</span></a>                      &lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('This is a local / test / intranet installation.')?&gt;
<a name="l793"><span class="linenum"> 793</span></a>                  &lt;/label&gt;
<a name="l794"><span class="linenum"> 794</span></a>              &lt;/div&gt;
<a name="l795"><span class="linenum"> 795</span></a>  
<a name="l796"><span class="linenum"> 796</span></a>              &lt;p class=&quot;evo_form__install_buttons&quot;&gt;
<a name="l797"><span class="linenum"> 797</span></a>              &lt;?php
<a name="l798"><span class="linenum"> 798</span></a>              if( <a class="var it1073" onMouseOver="hilite(1073)" onMouseOut="lolite()" onClick="logVariable('test_install_all_features')" href="../_variables/test_install_all_features.html">$test_install_all_features</a> &amp;&amp; <a class="var it2921" onMouseOver="hilite(2921)" onMouseOut="lolite()" onClick="logVariable('allow_evodb_reset')" href="../_variables/allow_evodb_reset.html">$allow_evodb_reset</a> &amp;&amp; <a class="var it6821" onMouseOver="hilite(6821)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../_variables/old_db_version.html">$old_db_version</a> = <a class="function" onClick="logFunction('get_db_version')" href="../_functions/get_db_version.html" onMouseOver="funcPopup(event,'get_db_version')">get_db_version</a>() )
<a name="l799"><span class="linenum"> 799</span></a>              { // We can allow to delete DB before installation
<a name="l800"><span class="linenum"> 800</span></a>              ?&gt;
<a name="l801"><span class="linenum"> 801</span></a>                  &lt;input type=&quot;hidden&quot; name=&quot;delete_contents&quot; value=&quot;1&quot; /&gt;
<a name="l802"><span class="linenum"> 802</span></a>                  &lt;button id=&quot;cancel_button&quot; type=&quot;submit&quot; class=&quot;btn btn-danger btn-lg&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('DELETE ALL &amp; RE-INSTALL!')?&gt;&lt;/button&gt;&lt;?php
<a name="l803"><span class="linenum"> 803</span></a>              }
<a name="l804"><span class="linenum"> 804</span></a>              else
<a name="l805"><span class="linenum"> 805</span></a>              { // Allow only install <span class="keyword">new </span><a class="class" onClick="logClass('DB')" href="../_classes/db.html" onMouseOver="classPopup(event,'db')">DB</a> without deleting previous DB
<a name="l806"><span class="linenum"> 806</span></a>              ?&gt;
<a name="l807"><span class="linenum"> 807</span></a>              &lt;button id=&quot;cancel_button&quot; type=&quot;submit&quot; class=&quot;btn btn-success btn-lg&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('INSTALL!')?&gt;&lt;/button&gt;&lt;?php
<a name="l808"><span class="linenum"> 808</span></a>              }
<a name="l809"><span class="linenum"> 809</span></a>              ?&gt;&lt;a href=&quot;index.php?locale=&lt;?php echo <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a> ?&gt;&quot; class=&quot;btn btn-default btn-lg&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Cancel')?&gt;&lt;/a&gt;
<a name="l810"><span class="linenum"> 810</span></a>              &lt;/p&gt;
<a name="l811"><span class="linenum"> 811</span></a>          &lt;/form&gt;
<a name="l812"><span class="linenum"> 812</span></a>  
<a name="l813"><span class="linenum"> 813</span></a>          &lt;script type=&quot;text/javascript&quot;&gt;
<a name="l814"><span class="linenum"> 814</span></a>              jQuery( '#create_sample_contents' ).click( function()
<a name="l815"><span class="linenum"> 815</span></a>              {
<a name="l816"><span class="linenum"> 816</span></a>                  jQuery( '#create_sample_contents_options' ).toggle();
<a name="l817"><span class="linenum"> 817</span></a>              } );
<a name="l818"><span class="linenum"> 818</span></a>          &lt;/script&gt;
<a name="l819"><span class="linenum"> 819</span></a>          &lt;?php
<a name="l820"><span class="linenum"> 820</span></a>          break;
<a name="l821"><span class="linenum"> 821</span></a>  
<a name="l822"><span class="linenum"> 822</span></a>      case 'localeinfo':
<a name="l823"><span class="linenum"> 823</span></a>  <span class="comment">        // Info about getting additional locales.</span>
<a name="l824"><span class="linenum"> 824</span></a>          <a class="function" onClick="logFunction('display_locale_selector')" href="../_functions/display_locale_selector.html" onMouseOver="funcPopup(event,'display_locale_selector')">display_locale_selector</a>();
<a name="l825"><span class="linenum"> 825</span></a>  
<a name="l826"><span class="linenum"> 826</span></a>  <span class="comment">        // Note: Do NOT make these strings translatable. We are not in the desired language anyways!</span>
<a name="l827"><span class="linenum"> 827</span></a>          ?&gt;
<a name="l828"><span class="linenum"> 828</span></a>          &lt;h2&gt;What if your language is not in the list above?&lt;/h2&gt;
<a name="l829"><span class="linenum"> 829</span></a>          &lt;ol&gt;
<a name="l830"><span class="linenum"> 830</span></a>              &lt;li&gt;Go to the &lt;a href=&quot;http://b2evolution.net/downloads/language-packs.html&quot; target=&quot;_blank&quot;&gt;language packs section on b2evolution.net&lt;/a&gt;.&lt;/li&gt;
<a name="l831"><span class="linenum"> 831</span></a>              &lt;li&gt;Select the version of b2evolution you're trying to install. If it's not available select the closest match (in most cases this should work).&lt;/li&gt;
<a name="l832"><span class="linenum"> 832</span></a>              &lt;li&gt;Find your language and click the &quot;Download&quot; link.&lt;/li&gt;
<a name="l833"><span class="linenum"> 833</span></a>              &lt;li&gt;Unzip the contents of the downloaded ZIP file.&lt;/li&gt;
<a name="l834"><span class="linenum"> 834</span></a>              &lt;li&gt;Upload the new folder (for example es_ES) into the /locales folder on your server. (The /locales folder already contains a few locales such as de_DE, ru_RU, etc.)&lt;/li&gt;
<a name="l835"><span class="linenum"> 835</span></a>              &lt;li&gt;Reload this page. The new locale should now appear in the list at the top of this screen. If it doesn't, it means the language pack you installed is not compatible with this version of b2evolution.&lt;/li&gt;
<a name="l836"><span class="linenum"> 836</span></a>          &lt;/ol&gt;
<a name="l837"><span class="linenum"> 837</span></a>  
<a name="l838"><span class="linenum"> 838</span></a>          &lt;h3&gt;What if there is no language pack to download?&lt;/h3&gt;
<a name="l839"><span class="linenum"> 839</span></a>          &lt;p&gt;Nobody has contributed a language pack in your language yet. You could help by providing a translation for your language.&lt;/p&gt;
<a name="l840"><span class="linenum"> 840</span></a>          &lt;p&gt;For now, you will have to install b2evolution with a supported language.&lt;/p&gt;
<a name="l841"><span class="linenum"> 841</span></a>          &lt;p&gt;Once you get familiar with b2evolution you will be able to &lt;a href=&quot;&lt;?php echo <a class="function" onClick="logFunction('get_manual_url')" href="../_functions/get_manual_url.html" onMouseOver="funcPopup(event,'get_manual_url')">get_manual_url</a>( 'localization' ); ?&gt;&quot; target=&quot;_blank&quot;&gt;create your own language pack&lt;/a&gt; fairly easily.&lt;/p&gt;
<a name="l842"><span class="linenum"> 842</span></a>          &lt;?php
<a name="l843"><span class="linenum"> 843</span></a>  <span class="comment">        // A link to back to install menu</span>
<a name="l844"><span class="linenum"> 844</span></a>          <a class="function" onClick="logFunction('display_install_back_link')" href="../_functions/display_install_back_link.html" onMouseOver="funcPopup(event,'display_install_back_link')">display_install_back_link</a>();
<a name="l845"><span class="linenum"> 845</span></a>          break;
<a name="l846"><span class="linenum"> 846</span></a>  
<a name="l847"><span class="linenum"> 847</span></a>      case 'newdbsettings':
<a name="l848"><span class="linenum"> 848</span></a>          <span class="comment">/*</span>
<a name="l849"><span class="linenum"> 849</span></a>  <span class="comment">         * fp&gt; TODO: Add a screen for additionnal settings:</span>
<a name="l850"><span class="linenum"> 850</span></a>  <span class="comment">         * - create_sample_contents : to be moved away from main screen</span>
<a name="l851"><span class="linenum"> 851</span></a>  <span class="comment">         * - admin_email: to be moved out of conf file</span>
<a name="l852"><span class="linenum"> 852</span></a>  <span class="comment">         * - storage_charset: offer option to FORCE storing data in UTF-8 even if current locale doesn't require it (must be supported by MySQL) -- recommended for multilingual blogs</span>
<a name="l853"><span class="linenum"> 853</span></a>  <span class="comment">         * - evo_charset: offer option to FORCE handling data internally in UTF-8 even if current locale doesn't require it (requires mbstring) -- not recommended in most situations</span>
<a name="l854"><span class="linenum"> 854</span></a>  <span class="comment">         */</span>
<a name="l855"><span class="linenum"> 855</span></a>  
<a name="l856"><span class="linenum"> 856</span></a>  
<a name="l857"><span class="linenum"> 857</span></a>      case 'newdb':
<a name="l858"><span class="linenum"> 858</span></a>          <span class="comment">/*</span>
<a name="l859"><span class="linenum"> 859</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l860"><span class="linenum"> 860</span></a>  <span class="comment">         * NEW DB: install a new b2evolution database.</span>
<a name="l861"><span class="linenum"> 861</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l862"><span class="linenum"> 862</span></a>  <span class="comment">         * Note: auto installers should kick in directly at this step and provide all required params.</span>
<a name="l863"><span class="linenum"> 863</span></a>  <span class="comment">         */</span>
<a name="l864"><span class="linenum"> 864</span></a>          <a class="function" onClick="logFunction('track_step')" href="../_functions/track_step.html" onMouseOver="funcPopup(event,'track_step')">track_step</a>( 'install-start' );
<a name="l865"><span class="linenum"> 865</span></a>  
<a name="l866"><span class="linenum"> 866</span></a>          <a class="var it3555" onMouseOver="hilite(3555)" onMouseOut="lolite()" onClick="logVariable('create_sample_contents')" href="../_variables/create_sample_contents.html">$create_sample_contents</a> = <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'create_sample_contents', 'string', '' );
<a name="l867"><span class="linenum"> 867</span></a>  
<a name="l868"><span class="linenum"> 868</span></a>          <a class="var it6839" onMouseOver="hilite(6839)" onMouseOut="lolite()" onClick="logVariable('config_test_install_all_features')" href="../_variables/config_test_install_all_features.html">$config_test_install_all_features</a> = <a class="var it1073" onMouseOver="hilite(1073)" onMouseOut="lolite()" onClick="logVariable('test_install_all_features')" href="../_variables/test_install_all_features.html">$test_install_all_features</a>;
<a name="l869"><span class="linenum"> 869</span></a>          if( <a class="var it1073" onMouseOver="hilite(1073)" onMouseOut="lolite()" onClick="logVariable('test_install_all_features')" href="../_variables/test_install_all_features.html">$test_install_all_features</a> )
<a name="l870"><span class="linenum"> 870</span></a>          { // Allow to use <a class="var it1073" onMouseOver="hilite(1073)" onMouseOut="lolite()" onClick="logVariable('test_install_all_features')" href="../_variables/test_install_all_features.html">$test_install_all_features</a> from request only when it is enabled in config
<a name="l871"><span class="linenum"> 871</span></a>              <a class="var it1073" onMouseOver="hilite(1073)" onMouseOut="lolite()" onClick="logVariable('test_install_all_features')" href="../_variables/test_install_all_features.html">$test_install_all_features</a> = <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'install_all_features', 'boolean', false );
<a name="l872"><span class="linenum"> 872</span></a>          }
<a name="l873"><span class="linenum"> 873</span></a>          else
<a name="l874"><span class="linenum"> 874</span></a>          {
<a name="l875"><span class="linenum"> 875</span></a>              <a class="var it1073" onMouseOver="hilite(1073)" onMouseOut="lolite()" onClick="logVariable('test_install_all_features')" href="../_variables/test_install_all_features.html">$test_install_all_features</a> = false;
<a name="l876"><span class="linenum"> 876</span></a>          }
<a name="l877"><span class="linenum"> 877</span></a>  
<a name="l878"><span class="linenum"> 878</span></a>  <span class="comment">        // fp&gt; TODO: this test should probably be made more generic and applied to upgrade too.</span>
<a name="l879"><span class="linenum"> 879</span></a>          <a class="var it5139" onMouseOver="hilite(5139)" onMouseOut="lolite()" onClick="logVariable('expected_connection_charset')" href="../_variables/expected_connection_charset.html">$expected_connection_charset</a> = <a class="class" onClick="logClass('DB')" href="../_classes/db.html" onMouseOver="classPopup(event,'db')">DB</a>::<a class="function" onClick="logFunction('php_to_mysql_charmap')" href="../_functions/php_to_mysql_charmap.html" onMouseOver="funcPopup(event,'php_to_mysql_charmap')">php_to_mysql_charmap</a>(<a class="var it926" onMouseOver="hilite(926)" onMouseOut="lolite()" onClick="logVariable('evo_charset')" href="../_variables/evo_charset.html">$evo_charset</a>);
<a name="l880"><span class="linenum"> 880</span></a>          if( <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('connection_charset')" class="var it10754" onMouseOver="hilite(10754)" onMouseOut="lolite()" href="../_variables/connection_charset.html">connection_charset</a> != <a class="var it5139" onMouseOver="hilite(5139)" onMouseOut="lolite()" onClick="logVariable('expected_connection_charset')" href="../_variables/expected_connection_charset.html">$expected_connection_charset</a> )
<a name="l881"><span class="linenum"> 881</span></a>          {
<a name="l882"><span class="linenum"> 882</span></a>              <a class="function" onClick="logFunction('display_install_messages')" href="../_functions/display_install_messages.html" onMouseOver="funcPopup(event,'display_install_messages')">display_install_messages</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('In order to install b2evolution with the %s locale, your MySQL needs to support the %s connection charset.').' (mysqli::set_charset(%s))',
<a name="l883"><span class="linenum"> 883</span></a>                  <a class="var it3554" onMouseOver="hilite(3554)" onMouseOut="lolite()" onClick="logVariable('current_locale')" href="../_variables/current_locale.html">$current_locale</a>, <a class="var it926" onMouseOver="hilite(926)" onMouseOut="lolite()" onClick="logVariable('evo_charset')" href="../_variables/evo_charset.html">$evo_charset</a>, <a class="var it5139" onMouseOver="hilite(5139)" onMouseOut="lolite()" onClick="logVariable('expected_connection_charset')" href="../_variables/expected_connection_charset.html">$expected_connection_charset</a> ) );
<a name="l884"><span class="linenum"> 884</span></a>  <span class="comment">            // sam2kb&gt; TODO: If something is not supported we can display a message saying &quot;do this and that, enable extension X etc. etc... or switch to a better hosting&quot;.</span>
<a name="l885"><span class="linenum"> 885</span></a>              break;
<a name="l886"><span class="linenum"> 886</span></a>          }
<a name="l887"><span class="linenum"> 887</span></a>  
<a name="l888"><span class="linenum"> 888</span></a>  <span class="comment">        // Progress bar</span>
<a name="l889"><span class="linenum"> 889</span></a>          <a class="function" onClick="logFunction('start_install_progress_bar')" href="../_functions/start_install_progress_bar.html" onMouseOver="funcPopup(event,'start_install_progress_bar')">start_install_progress_bar</a>( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Installation in progress'), <a class="function" onClick="logFunction('get_install_steps_count')" href="../_functions/get_install_steps_count.html" onMouseOver="funcPopup(event,'get_install_steps_count')">get_install_steps_count</a>() );
<a name="l890"><span class="linenum"> 890</span></a>  
<a name="l891"><span class="linenum"> 891</span></a>          echo '&lt;h2&gt;'.<a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Installing b2evolution...').'&lt;/h2&gt;';
<a name="l892"><span class="linenum"> 892</span></a>  
<a name="l893"><span class="linenum"> 893</span></a>  <span class="comment">        // Try to display the messages here because they can be created during checking params of quick installation:</span>
<a name="l894"><span class="linenum"> 894</span></a>          <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('display')" href="../_functions/display.html" onMouseOver="funcPopup(event,'display')">display</a>();
<a name="l895"><span class="linenum"> 895</span></a>          if( ! empty( <a class="var it6840" onMouseOver="hilite(6840)" onMouseOut="lolite()" onClick="logVariable('basic_config_file_result_messages')" href="../_variables/basic_config_file_result_messages.html">$basic_config_file_result_messages</a> ) )
<a name="l896"><span class="linenum"> 896</span></a>          { // Display messages that were generated on creating basic config file on quick installation:
<a name="l897"><span class="linenum"> 897</span></a>              echo <a class="var it6840" onMouseOver="hilite(6840)" onMouseOut="lolite()" onClick="logVariable('basic_config_file_result_messages')" href="../_variables/basic_config_file_result_messages.html">$basic_config_file_result_messages</a>;
<a name="l898"><span class="linenum"> 898</span></a>          }
<a name="l899"><span class="linenum"> 899</span></a>  
<a name="l900"><span class="linenum"> 900</span></a>          if( <a class="var it6839" onMouseOver="hilite(6839)" onMouseOut="lolite()" onClick="logVariable('config_test_install_all_features')" href="../_variables/config_test_install_all_features.html">$config_test_install_all_features</a> &amp;&amp; <a class="var it2921" onMouseOver="hilite(2921)" onMouseOut="lolite()" onClick="logVariable('allow_evodb_reset')" href="../_variables/allow_evodb_reset.html">$allow_evodb_reset</a> )
<a name="l901"><span class="linenum"> 901</span></a>          { // Allow to quick delete before new installation only when these two settings are enabled in config files
<a name="l902"><span class="linenum"> 902</span></a>              <a class="var it6841" onMouseOver="hilite(6841)" onMouseOut="lolite()" onClick="logVariable('delete_contents')" href="../_variables/delete_contents.html">$delete_contents</a> = <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'delete_contents', 'integer', 0 );
<a name="l903"><span class="linenum"> 903</span></a>  
<a name="l904"><span class="linenum"> 904</span></a>              if( <a class="var it6841" onMouseOver="hilite(6841)" onMouseOut="lolite()" onClick="logVariable('delete_contents')" href="../_variables/delete_contents.html">$delete_contents</a> )
<a name="l905"><span class="linenum"> 905</span></a>              { // A quick deletion is requested before new installation
<a name="l906"><span class="linenum"> 906</span></a>                  require_once( <a class="phpfunction" onClick="logFunction('dirname')" href="../_functions/dirname.html" onMouseOver="phpfuncPopup(event,'dirname')">dirname</a>(__FILE__). '/_functions_delete.php' );
<a name="l907"><span class="linenum"> 907</span></a>  
<a name="l908"><span class="linenum"> 908</span></a>                  echo '&lt;h2&gt;'.<a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Deleting b2evolution tables from the datatase...').'&lt;/h2&gt;';
<a name="l909"><span class="linenum"> 909</span></a>                  <a class="function" onClick="logFunction('evo_flush')" href="../_functions/evo_flush.html" onMouseOver="funcPopup(event,'evo_flush')">evo_flush</a>();
<a name="l910"><span class="linenum"> 910</span></a>  
<a name="l911"><span class="linenum"> 911</span></a>  <span class="comment">                // Uninstall b2evolution: Delete DB &amp; Cache files</span>
<a name="l912"><span class="linenum"> 912</span></a>                  <a class="function" onClick="logFunction('uninstall_b2evolution')" href="../_functions/uninstall_b2evolution.html" onMouseOver="funcPopup(event,'uninstall_b2evolution')">uninstall_b2evolution</a>();
<a name="l913"><span class="linenum"> 913</span></a>  
<a name="l914"><span class="linenum"> 914</span></a>  <span class="comment">                // Update the progress bar status</span>
<a name="l915"><span class="linenum"> 915</span></a>                  <a class="function" onClick="logFunction('update_install_progress_bar')" href="../_functions/update_install_progress_bar.html" onMouseOver="funcPopup(event,'update_install_progress_bar')">update_install_progress_bar</a>();
<a name="l916"><span class="linenum"> 916</span></a>              }
<a name="l917"><span class="linenum"> 917</span></a>          }
<a name="l918"><span class="linenum"> 918</span></a>  
<a name="l919"><span class="linenum"> 919</span></a>          if( <a class="var it6821" onMouseOver="hilite(6821)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../_variables/old_db_version.html">$old_db_version</a> = <a class="function" onClick="logFunction('get_db_version')" href="../_functions/get_db_version.html" onMouseOver="funcPopup(event,'get_db_version')">get_db_version</a>() )
<a name="l920"><span class="linenum"> 920</span></a>          {
<a name="l921"><span class="linenum"> 921</span></a>              echo '&lt;p class=&quot;text-warning&quot;&gt;&lt;strong&gt;&lt;evo:warning&gt;'.<a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('OOPS! It seems b2evolution is already installed!').'&lt;/evo:warning&gt;&lt;/strong&gt;&lt;/p&gt;';
<a name="l922"><span class="linenum"> 922</span></a>  
<a name="l923"><span class="linenum"> 923</span></a>              if( <a class="var it6821" onMouseOver="hilite(6821)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../_variables/old_db_version.html">$old_db_version</a> &lt; <a class="var it3593" onMouseOver="hilite(3593)" onMouseOut="lolite()" onClick="logVariable('new_db_version')" href="../_variables/new_db_version.html">$new_db_version</a> )
<a name="l924"><span class="linenum"> 924</span></a>              {
<a name="l925"><span class="linenum"> 925</span></a>                  echo '&lt;p&gt;'.sprintf( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Would you like to &lt;a %s&gt;upgrade your existing installation now&lt;/a&gt;?'), 'href=&quot;?action=evoupgrade&quot;' ).'&lt;/p&gt;';
<a name="l926"><span class="linenum"> 926</span></a>              }
<a name="l927"><span class="linenum"> 927</span></a>  
<a name="l928"><span class="linenum"> 928</span></a>  <span class="comment">            // Stop the animation of the progress bar</span>
<a name="l929"><span class="linenum"> 929</span></a>              <a class="function" onClick="logFunction('stop_install_progress_bar')" href="../_functions/stop_install_progress_bar.html" onMouseOver="funcPopup(event,'stop_install_progress_bar')">stop_install_progress_bar</a>();
<a name="l930"><span class="linenum"> 930</span></a>  
<a name="l931"><span class="linenum"> 931</span></a>              break;
<a name="l932"><span class="linenum"> 932</span></a>          }
<a name="l933"><span class="linenum"> 933</span></a>  
<a name="l934"><span class="linenum"> 934</span></a>          echo '&lt;h2&gt;'.<a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Checking files...').'&lt;/h2&gt;';
<a name="l935"><span class="linenum"> 935</span></a>          <a class="function" onClick="logFunction('evo_flush')" href="../_functions/evo_flush.html" onMouseOver="funcPopup(event,'evo_flush')">evo_flush</a>();
<a name="l936"><span class="linenum"> 936</span></a>  <span class="comment">        // Check for .htaccess:</span>
<a name="l937"><span class="linenum"> 937</span></a>          if( ! <a class="function" onClick="logFunction('install_htaccess')" href="../_functions/install_htaccess.html" onMouseOver="funcPopup(event,'install_htaccess')">install_htaccess</a>( false ) )
<a name="l938"><span class="linenum"> 938</span></a>          { // Exit installation here because the .htaccess file has the some errors
<a name="l939"><span class="linenum"> 939</span></a>              break;
<a name="l940"><span class="linenum"> 940</span></a>          }
<a name="l941"><span class="linenum"> 941</span></a>  
<a name="l942"><span class="linenum"> 942</span></a>  <span class="comment">        // Update the progress bar status</span>
<a name="l943"><span class="linenum"> 943</span></a>          <a class="function" onClick="logFunction('update_install_progress_bar')" href="../_functions/update_install_progress_bar.html" onMouseOver="funcPopup(event,'update_install_progress_bar')">update_install_progress_bar</a>();
<a name="l944"><span class="linenum"> 944</span></a>  
<a name="l945"><span class="linenum"> 945</span></a>  <span class="comment">        // Here's the meat!</span>
<a name="l946"><span class="linenum"> 946</span></a>          <a class="function" onClick="logFunction('install_newdb')" href="../_functions/install_newdb.html" onMouseOver="funcPopup(event,'install_newdb')">install_newdb</a>();
<a name="l947"><span class="linenum"> 947</span></a>  
<a name="l948"><span class="linenum"> 948</span></a>  <span class="comment">        // Stop the animation of the progress bar</span>
<a name="l949"><span class="linenum"> 949</span></a>          <a class="function" onClick="logFunction('stop_install_progress_bar')" href="../_functions/stop_install_progress_bar.html" onMouseOver="funcPopup(event,'stop_install_progress_bar')">stop_install_progress_bar</a>();
<a name="l950"><span class="linenum"> 950</span></a>          break;
<a name="l951"><span class="linenum"> 951</span></a>  
<a name="l952"><span class="linenum"> 952</span></a>  
<a name="l953"><span class="linenum"> 953</span></a>      case 'evoupgrade':
<a name="l954"><span class="linenum"> 954</span></a>      case 'auto_upgrade':
<a name="l955"><span class="linenum"> 955</span></a>      case 'svn_upgrade':
<a name="l956"><span class="linenum"> 956</span></a>          <span class="comment">/*</span>
<a name="l957"><span class="linenum"> 957</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l958"><span class="linenum"> 958</span></a>  <span class="comment">         * EVO UPGRADE: Upgrade data from existing b2evolution database</span>
<a name="l959"><span class="linenum"> 959</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l960"><span class="linenum"> 960</span></a>  <span class="comment">         */</span>
<a name="l961"><span class="linenum"> 961</span></a>          <a class="function" onClick="logFunction('track_step')" href="../_functions/track_step.html" onMouseOver="funcPopup(event,'track_step')">track_step</a>( 'upgrade-start' );
<a name="l962"><span class="linenum"> 962</span></a>  
<a name="l963"><span class="linenum"> 963</span></a>          require_once( <a class="phpfunction" onClick="logFunction('dirname')" href="../_functions/dirname.html" onMouseOver="phpfuncPopup(event,'dirname')">dirname</a>(__FILE__). '/_functions_evoupgrade.php' );
<a name="l964"><span class="linenum"> 964</span></a>  
<a name="l965"><span class="linenum"> 965</span></a>  <span class="comment">        // Progress bar</span>
<a name="l966"><span class="linenum"> 966</span></a>          <a class="function" onClick="logFunction('start_install_progress_bar')" href="../_functions/start_install_progress_bar.html" onMouseOver="funcPopup(event,'start_install_progress_bar')">start_install_progress_bar</a>( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Uprade in progress'), <a class="function" onClick="logFunction('get_upgrade_steps_count')" href="../_functions/get_upgrade_steps_count.html" onMouseOver="funcPopup(event,'get_upgrade_steps_count')">get_upgrade_steps_count</a>() );
<a name="l967"><span class="linenum"> 967</span></a>  
<a name="l968"><span class="linenum"> 968</span></a>          echo '&lt;h2&gt;'.<a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Upgrading b2evolution...').'&lt;/h2&gt;';
<a name="l969"><span class="linenum"> 969</span></a>  
<a name="l970"><span class="linenum"> 970</span></a>          echo '&lt;h2&gt;'.<a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Checking files...').'&lt;/h2&gt;';
<a name="l971"><span class="linenum"> 971</span></a>          <a class="function" onClick="logFunction('evo_flush')" href="../_functions/evo_flush.html" onMouseOver="funcPopup(event,'evo_flush')">evo_flush</a>();
<a name="l972"><span class="linenum"> 972</span></a>  <span class="comment">        // Check for .htaccess:</span>
<a name="l973"><span class="linenum"> 973</span></a>          if( ! <a class="function" onClick="logFunction('install_htaccess')" href="../_functions/install_htaccess.html" onMouseOver="funcPopup(event,'install_htaccess')">install_htaccess</a>( true ) )
<a name="l974"><span class="linenum"> 974</span></a>          { // Exit installation here because the .htaccess file has the some errors
<a name="l975"><span class="linenum"> 975</span></a>              break;
<a name="l976"><span class="linenum"> 976</span></a>          }
<a name="l977"><span class="linenum"> 977</span></a>  
<a name="l978"><span class="linenum"> 978</span></a>  <span class="comment">        // Update the progress bar status</span>
<a name="l979"><span class="linenum"> 979</span></a>          <a class="function" onClick="logFunction('update_install_progress_bar')" href="../_functions/update_install_progress_bar.html" onMouseOver="funcPopup(event,'update_install_progress_bar')">update_install_progress_bar</a>();
<a name="l980"><span class="linenum"> 980</span></a>  
<a name="l981"><span class="linenum"> 981</span></a>  <span class="comment">        // Try to obtain some serious time to do some serious processing (5 minutes)</span>
<a name="l982"><span class="linenum"> 982</span></a>  <span class="comment">        // NOte: this must NOT be in upgrade_b2evo_tables(), otherwise it will mess with the longer setting used by the auto upgrade feature.</span>
<a name="l983"><span class="linenum"> 983</span></a>          if( <a class="function" onClick="logFunction('set_max_execution_time')" href="../_functions/set_max_execution_time.html" onMouseOver="funcPopup(event,'set_max_execution_time')">set_max_execution_time</a>(300) === false )
<a name="l984"><span class="linenum"> 984</span></a>          { // max_execution_time ini setting could not be changed for this script, display a warning
<a name="l985"><span class="linenum"> 985</span></a>              <a class="var it6842" onMouseOver="hilite(6842)" onMouseOut="lolite()" onClick="logVariable('manual_url')" href="../_variables/manual_url.html">$manual_url</a> = 'href=&quot;'.<a class="function" onClick="logFunction('get_manual_url')" href="../_functions/get_manual_url.html" onMouseOver="funcPopup(event,'get_manual_url')">get_manual_url</a>( 'blank-or-partial-page' ).'&quot; target = &quot;_blank&quot;';
<a name="l986"><span class="linenum"> 986</span></a>              echo '&lt;div class=&quot;text-warning&quot;&gt;&lt;evo:warning&gt;'.sprintf( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('WARNING: the max_execution_time is set to %s seconds in php.ini and cannot be increased automatically. This may lead to a PHP &lt;a %s&gt;timeout causing the upgrade to fail&lt;/a&gt;. If so please post a screenshot to the &lt;a %s&gt;forums&lt;/a&gt;.'), <a class="phpfunction" onClick="logFunction('ini_get')" href="../_functions/ini_get.html" onMouseOver="phpfuncPopup(event,'ini_get')">ini_get</a>( 'max_execution_time' ), <a class="var it6842" onMouseOver="hilite(6842)" onMouseOut="lolite()" onClick="logVariable('manual_url')" href="../_variables/manual_url.html">$manual_url</a>, 'href=&quot;http://forums.b2evolution.net/&quot;' ).'&lt;/evo:warning&gt;&lt;/div&gt;';
<a name="l987"><span class="linenum"> 987</span></a>          }
<a name="l988"><span class="linenum"> 988</span></a>  
<a name="l989"><span class="linenum"> 989</span></a>          echo '&lt;h2&gt;'.<a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Upgrading data in existing b2evolution database...').'&lt;/h2&gt;';
<a name="l990"><span class="linenum"> 990</span></a>          <a class="function" onClick="logFunction('evo_flush')" href="../_functions/evo_flush.html" onMouseOver="funcPopup(event,'evo_flush')">evo_flush</a>();
<a name="l991"><span class="linenum"> 991</span></a>  
<a name="l992"><span class="linenum"> 992</span></a>          <a class="var it6843" onMouseOver="hilite(6843)" onMouseOut="lolite()" onClick="logVariable('is_automated_upgrade')" href="../_variables/is_automated_upgrade.html">$is_automated_upgrade</a> = ( <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a> !== 'evoupgrade' );
<a name="l993"><span class="linenum"> 993</span></a>  
<a name="l994"><span class="linenum"> 994</span></a>          <a class="var it6844" onMouseOver="hilite(6844)" onMouseOut="lolite()" onClick="logVariable('upgrade_result')" href="../_variables/upgrade_result.html">$upgrade_result</a> = <a class="function" onClick="logFunction('upgrade_b2evo_tables')" href="../_functions/upgrade_b2evo_tables.html" onMouseOver="funcPopup(event,'upgrade_b2evo_tables')">upgrade_b2evo_tables</a>( <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a> );
<a name="l995"><span class="linenum"> 995</span></a>  
<a name="l996"><span class="linenum"> 996</span></a>          if( <a class="var it6844" onMouseOver="hilite(6844)" onMouseOut="lolite()" onClick="logVariable('upgrade_result')" href="../_variables/upgrade_result.html">$upgrade_result</a> === 'need-fix' )
<a name="l997"><span class="linenum"> 997</span></a>          {    // We are waiting for the user to click on &quot;try to repair/upgrade now&quot;...
<a name="l998"><span class="linenum"> 998</span></a>  <span class="comment">            // We already displayed the orange upgrade button. Offer an alternative:</span>
<a name="l999"><span class="linenum"> 999</span></a>  <span class="comment">            // A link back to install menu</span>
<a name="l1000"><span class="linenum">1000</span></a>              <a class="function" onClick="logFunction('display_install_back_link')" href="../_functions/display_install_back_link.html" onMouseOver="funcPopup(event,'display_install_back_link')">display_install_back_link</a>();
<a name="l1001"><span class="linenum">1001</span></a>          }
<a name="l1002"><span class="linenum">1002</span></a>          elseif( <a class="var it6844" onMouseOver="hilite(6844)" onMouseOut="lolite()" onClick="logVariable('upgrade_result')" href="../_variables/upgrade_result.html">$upgrade_result</a> === true )
<a name="l1003"><span class="linenum">1003</span></a>          {
<a name="l1004"><span class="linenum">1004</span></a>              if( <a class="var it6843" onMouseOver="hilite(6843)" onMouseOut="lolite()" onClick="logVariable('is_automated_upgrade')" href="../_variables/is_automated_upgrade.html">$is_automated_upgrade</a> )  // What EXACTLY does &quot;<a class="var it6845" onMouseOver="hilite(6845)" onMouseOut="lolite()" onClick="logVariable('not_upgrade')" href="../_variables/not_upgrade.html">$not_upgrade</a> mean???&quot;
<a name="l1005"><span class="linenum">1005</span></a>              { // After successful auto_upgrade or svn_upgrade we must remove files/folder based on the upgrade_policy.conf
<a name="l1006"><span class="linenum">1006</span></a>                  <a class="function" onClick="logFunction('remove_after_upgrade')" href="../_functions/remove_after_upgrade.html" onMouseOver="funcPopup(event,'remove_after_upgrade')">remove_after_upgrade</a>();
<a name="l1007"><span class="linenum">1007</span></a>  <span class="comment">                // disable maintenance mode at the end of the upgrade script</span>
<a name="l1008"><span class="linenum">1008</span></a>                  <a class="function" onClick="logFunction('switch_maintenance_mode')" href="../_functions/switch_maintenance_mode.html" onMouseOver="funcPopup(event,'switch_maintenance_mode')">switch_maintenance_mode</a>( false, 'upgrade' );
<a name="l1009"><span class="linenum">1009</span></a>              }
<a name="l1010"><span class="linenum">1010</span></a>  
<a name="l1011"><span class="linenum">1011</span></a>  <span class="comment">            // Update the progress bar status</span>
<a name="l1012"><span class="linenum">1012</span></a>              <a class="function" onClick="logFunction('update_install_progress_bar')" href="../_functions/update_install_progress_bar.html" onMouseOver="funcPopup(event,'update_install_progress_bar')">update_install_progress_bar</a>();
<a name="l1013"><span class="linenum">1013</span></a>  
<a name="l1014"><span class="linenum">1014</span></a>              <a class="var it6846" onMouseOver="hilite(6846)" onMouseOut="lolite()" onClick="logVariable('upgrade_result_title')" href="../_variables/upgrade_result_title.html">$upgrade_result_title</a> = <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Upgrade completed successfully!');
<a name="l1015"><span class="linenum">1015</span></a>              <a class="var it6847" onMouseOver="hilite(6847)" onMouseOut="lolite()" onClick="logVariable('upgrade_result_body')" href="../_variables/upgrade_result_body.html">$upgrade_result_body</a> = sprintf( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Now you can &lt;a %s&gt;log in&lt;/a&gt; with your usual b2evolution username and password.'), 'href=&quot;'.<a class="var it136" onMouseOver="hilite(136)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../_variables/admin_url.html">$admin_url</a>.'&quot;' );
<a name="l1016"><span class="linenum">1016</span></a>  
<a name="l1017"><span class="linenum">1017</span></a>              ?&gt;
<a name="l1018"><span class="linenum">1018</span></a>              &lt;p class=&quot;alert alert-success&quot;&gt;&lt;evo:success&gt;&lt;?php echo <a class="var it6846" onMouseOver="hilite(6846)" onMouseOut="lolite()" onClick="logVariable('upgrade_result_title')" href="../_variables/upgrade_result_title.html">$upgrade_result_title</a>; ?&gt;&lt;/evo:success&gt;&lt;/p&gt;
<a name="l1019"><span class="linenum">1019</span></a>              &lt;p&gt;&lt;?php echo <a class="var it6847" onMouseOver="hilite(6847)" onMouseOut="lolite()" onClick="logVariable('upgrade_result_body')" href="../_variables/upgrade_result_body.html">$upgrade_result_body</a>; ?&gt;&lt;/p&gt;
<a name="l1020"><span class="linenum">1020</span></a>              &lt;?php
<a name="l1021"><span class="linenum">1021</span></a>  
<a name="l1022"><span class="linenum">1022</span></a>  <span class="comment">            // Display modal window with upgrade data and instructions</span>
<a name="l1023"><span class="linenum">1023</span></a>              <a class="function" onClick="logFunction('display_install_result_window')" href="../_functions/display_install_result_window.html" onMouseOver="funcPopup(event,'display_install_result_window')">display_install_result_window</a>( <a class="var it6846" onMouseOver="hilite(6846)" onMouseOut="lolite()" onClick="logVariable('upgrade_result_title')" href="../_variables/upgrade_result_title.html">$upgrade_result_title</a>, <a class="var it6847" onMouseOver="hilite(6847)" onMouseOut="lolite()" onClick="logVariable('upgrade_result_body')" href="../_variables/upgrade_result_body.html">$upgrade_result_body</a> );
<a name="l1024"><span class="linenum">1024</span></a>          }
<a name="l1025"><span class="linenum">1025</span></a>          else
<a name="l1026"><span class="linenum">1026</span></a>          {    // There has been an error during upgrade... (or upgrade was not performed)
<a name="l1027"><span class="linenum">1027</span></a>  
<a name="l1028"><span class="linenum">1028</span></a>              if( <a class="var it6843" onMouseOver="hilite(6843)" onMouseOut="lolite()" onClick="logVariable('is_automated_upgrade')" href="../_variables/is_automated_upgrade.html">$is_automated_upgrade</a> )
<a name="l1029"><span class="linenum">1029</span></a>              {    // disable maintenance mode at the end of the upgrade script
<a name="l1030"><span class="linenum">1030</span></a>  <span class="comment">                // TODO: check all exist conditions, and do this only when upgrade was aborted, not when upgrade failed in the middle...</span>
<a name="l1031"><span class="linenum">1031</span></a>                  <a class="function" onClick="logFunction('switch_maintenance_mode')" href="../_functions/switch_maintenance_mode.html" onMouseOver="funcPopup(event,'switch_maintenance_mode')">switch_maintenance_mode</a>( false, 'upgrade' );
<a name="l1032"><span class="linenum">1032</span></a>              }
<a name="l1033"><span class="linenum">1033</span></a>  
<a name="l1034"><span class="linenum">1034</span></a>              ?&gt;
<a name="l1035"><span class="linenum">1035</span></a>              &lt;p class=&quot;alert alert-danger&quot; style=&quot;margin-top: 40px;&quot;&gt;&lt;evo:error&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Upgrade failed!')?&gt;&lt;/evo:error&gt;&lt;/p&gt;
<a name="l1036"><span class="linenum">1036</span></a>              &lt;?php
<a name="l1037"><span class="linenum">1037</span></a>  
<a name="l1038"><span class="linenum">1038</span></a>  <span class="comment">            // A link back to install menu</span>
<a name="l1039"><span class="linenum">1039</span></a>              <a class="function" onClick="logFunction('display_install_back_link')" href="../_functions/display_install_back_link.html" onMouseOver="funcPopup(event,'display_install_back_link')">display_install_back_link</a>();
<a name="l1040"><span class="linenum">1040</span></a>          }
<a name="l1041"><span class="linenum">1041</span></a>  
<a name="l1042"><span class="linenum">1042</span></a>  <span class="comment">        // Stop the animation of the progress bar</span>
<a name="l1043"><span class="linenum">1043</span></a>          <a class="function" onClick="logFunction('stop_install_progress_bar')" href="../_functions/stop_install_progress_bar.html" onMouseOver="funcPopup(event,'stop_install_progress_bar')">stop_install_progress_bar</a>();
<a name="l1044"><span class="linenum">1044</span></a>  
<a name="l1045"><span class="linenum">1045</span></a>          break;
<a name="l1046"><span class="linenum">1046</span></a>  
<a name="l1047"><span class="linenum">1047</span></a>  
<a name="l1048"><span class="linenum">1048</span></a>      case 'deletedb':
<a name="l1049"><span class="linenum">1049</span></a>          <span class="comment">/*</span>
<a name="l1050"><span class="linenum">1050</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l1051"><span class="linenum">1051</span></a>  <span class="comment">         * DELETE DB: Delete the db structure!!! (Everything will be lost)</span>
<a name="l1052"><span class="linenum">1052</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l1053"><span class="linenum">1053</span></a>  <span class="comment">         */</span>
<a name="l1054"><span class="linenum">1054</span></a>          require_once( <a class="phpfunction" onClick="logFunction('dirname')" href="../_functions/dirname.html" onMouseOver="phpfuncPopup(event,'dirname')">dirname</a>(__FILE__). '/_functions_delete.php' );
<a name="l1055"><span class="linenum">1055</span></a>  
<a name="l1056"><span class="linenum">1056</span></a>          <a class="var it1088" onMouseOver="hilite(1088)" onMouseOut="lolite()" onClick="logVariable('confirmed')" href="../_variables/confirmed.html">$confirmed</a> = <a class="function" onClick="logFunction('param')" href="../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'confirmed', 'integer', 1 );
<a name="l1057"><span class="linenum">1057</span></a>  
<a name="l1058"><span class="linenum">1058</span></a>          if( <a class="var it1088" onMouseOver="hilite(1088)" onMouseOut="lolite()" onClick="logVariable('confirmed')" href="../_variables/confirmed.html">$confirmed</a> )
<a name="l1059"><span class="linenum">1059</span></a>          { // Progress bar
<a name="l1060"><span class="linenum">1060</span></a>              <a class="function" onClick="logFunction('start_install_progress_bar')" href="../_functions/start_install_progress_bar.html" onMouseOver="funcPopup(event,'start_install_progress_bar')">start_install_progress_bar</a>( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Deletion in progress') );
<a name="l1061"><span class="linenum">1061</span></a>          }
<a name="l1062"><span class="linenum">1062</span></a>  
<a name="l1063"><span class="linenum">1063</span></a>          echo '&lt;h2&gt;'.<a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Deleting b2evolution tables from the datatase...').'&lt;/h2&gt;';
<a name="l1064"><span class="linenum">1064</span></a>          <a class="function" onClick="logFunction('evo_flush')" href="../_functions/evo_flush.html" onMouseOver="funcPopup(event,'evo_flush')">evo_flush</a>();
<a name="l1065"><span class="linenum">1065</span></a>  
<a name="l1066"><span class="linenum">1066</span></a>          if( <a class="var it2921" onMouseOver="hilite(2921)" onMouseOut="lolite()" onClick="logVariable('allow_evodb_reset')" href="../_variables/allow_evodb_reset.html">$allow_evodb_reset</a> != 1 )
<a name="l1067"><span class="linenum">1067</span></a>          {
<a name="l1068"><span class="linenum">1068</span></a>              echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('If you have installed b2evolution tables before and wish to start anew, you must delete the b2evolution tables before you can start a new installation. b2evolution can delete its own tables for you, but for obvious security reasons, this feature is disabled by default.');
<a name="l1069"><span class="linenum">1069</span></a>              echo '&lt;p&gt;'.sprintf( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('To enable it, please go to the %s file and change: %s to %s'), '/conf/_basic_config.php', '&lt;pre&gt;<a class="var it2921" onMouseOver="hilite(2921)" onMouseOut="lolite()" onClick="logVariable('allow_evodb_reset')" href="../_variables/allow_evodb_reset.html">$allow_evodb_reset</a> = 0;&lt;/pre&gt;', '&lt;pre&gt;<a class="var it2921" onMouseOver="hilite(2921)" onMouseOut="lolite()" onClick="logVariable('allow_evodb_reset')" href="../_variables/allow_evodb_reset.html">$allow_evodb_reset</a> = 1;&lt;/pre&gt;' ).'&lt;/p&gt;';
<a name="l1070"><span class="linenum">1070</span></a>              echo '&lt;p&gt;'.<a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Then reload this page and a reset option will appear.').'&lt;/p&gt;';
<a name="l1071"><span class="linenum">1071</span></a>  <span class="comment">            // A link to back to install menu</span>
<a name="l1072"><span class="linenum">1072</span></a>              <a class="function" onClick="logFunction('display_install_back_link')" href="../_functions/display_install_back_link.html" onMouseOver="funcPopup(event,'display_install_back_link')">display_install_back_link</a>();
<a name="l1073"><span class="linenum">1073</span></a>  
<a name="l1074"><span class="linenum">1074</span></a>              break;
<a name="l1075"><span class="linenum">1075</span></a>          }
<a name="l1076"><span class="linenum">1076</span></a>  
<a name="l1077"><span class="linenum">1077</span></a>          if( ! <a class="var it1088" onMouseOver="hilite(1088)" onMouseOut="lolite()" onClick="logVariable('confirmed')" href="../_variables/confirmed.html">$confirmed</a> )
<a name="l1078"><span class="linenum">1078</span></a>          {
<a name="l1079"><span class="linenum">1079</span></a>              ?&gt;
<a name="l1080"><span class="linenum">1080</span></a>              &lt;p&gt;
<a name="l1081"><span class="linenum">1081</span></a>              &lt;?php
<a name="l1082"><span class="linenum">1082</span></a>              echo <a class="phpfunction" onClick="logFunction('nl2br')" href="../_functions/nl2br.html" onMouseOver="phpfuncPopup(event,'nl2br')">nl2br</a>( <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>( sprintf( <span class="comment">/* TRANS: %s gets replaced by app name, usually &quot;b2evolution&quot; */</span> <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>( &quot;Are you sure you want to delete your existing %s tables?\nDo you have a backup?&quot; ), <a class="var it1348" onMouseOver="hilite(1348)" onMouseOut="lolite()" onClick="logVariable('app_name')" href="../_variables/app_name.html">$app_name</a> ) ) );
<a name="l1083"><span class="linenum">1083</span></a>              ?&gt;
<a name="l1084"><span class="linenum">1084</span></a>              &lt;/p&gt;
<a name="l1085"><span class="linenum">1085</span></a>              &lt;p&gt;
<a name="l1086"><span class="linenum">1086</span></a>              &lt;form name=&quot;form&quot; action="<a class="filename" href="../index.php.html">index.php</a>" method=&quot;post&quot; style=&quot;display:inline-block&quot;&gt;
<a name="l1087"><span class="linenum">1087</span></a>                  &lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;deletedb&quot; /&gt;
<a name="l1088"><span class="linenum">1088</span></a>                  &lt;input type=&quot;hidden&quot; name=&quot;confirmed&quot; value=&quot;1&quot; /&gt;
<a name="l1089"><span class="linenum">1089</span></a>                  &lt;input type=&quot;hidden&quot; name=&quot;locale&quot; value=&quot;&lt;?php echo <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a>; ?&gt;&quot; /&gt;
<a name="l1090"><span class="linenum">1090</span></a>                  &lt;input type=&quot;submit&quot; value=&quot;&amp;nbsp; &lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('I am sure!')?&gt; &amp;nbsp;&quot; class=&quot;btn btn-danger btn-lg&quot; /&gt;
<a name="l1091"><span class="linenum">1091</span></a>              &lt;/form&gt;
<a name="l1092"><span class="linenum">1092</span></a>  
<a name="l1093"><span class="linenum">1093</span></a>              &lt;form name=&quot;form&quot; action="<a class="filename" href="../index.php.html">index.php</a>" method=&quot;get&quot; style=&quot;display:inline-block&quot;&gt;
<a name="l1094"><span class="linenum">1094</span></a>                  &lt;input type=&quot;hidden&quot; name=&quot;locale&quot; value=&quot;&lt;?php echo <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a>; ?&gt;&quot; /&gt;
<a name="l1095"><span class="linenum">1095</span></a>                  &lt;input type=&quot;submit&quot; value=&quot;&amp;nbsp; &lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('CANCEL')?&gt; &amp;nbsp;&quot; class=&quot;btn btn-default btn-lg&quot; /&gt;
<a name="l1096"><span class="linenum">1096</span></a>              &lt;/form&gt;
<a name="l1097"><span class="linenum">1097</span></a>              &lt;/p&gt;
<a name="l1098"><span class="linenum">1098</span></a>              &lt;?php
<a name="l1099"><span class="linenum">1099</span></a>              break;
<a name="l1100"><span class="linenum">1100</span></a>          }
<a name="l1101"><span class="linenum">1101</span></a>  
<a name="l1102"><span class="linenum">1102</span></a>  <span class="comment">        // Uninstall Plugins</span>
<a name="l1103"><span class="linenum">1103</span></a>  <span class="comment">        // TODO: fp&gt;&gt; I don't trust the plugins to uninstall themselves correctly. There will be tons of lousy poorly written plugins. All I trust them to do is to crash the uninstall procedure. We want a hardcore brute force uninsall! and most users &quot;may NOT want&quot; to even think about &quot;ma-nu-al-ly&quot; removing something from their DB.</span>
<a name="l1104"><span class="linenum">1104</span></a>          <span class="comment">/*</span>
<a name="l1105"><span class="linenum">1105</span></a>  <span class="comment">                $DB-&gt;show_errors = $DB-&gt;halt_on_error = false;</span>
<a name="l1106"><span class="linenum">1106</span></a>  <span class="comment">                $Plugins = new Plugins();</span>
<a name="l1107"><span class="linenum">1107</span></a>  <span class="comment">                $DB-&gt;show_errors = $DB-&gt;halt_on_error = true;</span>
<a name="l1108"><span class="linenum">1108</span></a>  <span class="comment">                $at_least_one_failed = false;</span>
<a name="l1109"><span class="linenum">1109</span></a>  <span class="comment">                foreach( $Plugins-&gt;get_list_by_event( 'Uninstall' ) as $l_Plugin )</span>
<a name="l1110"><span class="linenum">1110</span></a>  <span class="comment">                {</span>
<a name="l1111"><span class="linenum">1111</span></a>  <span class="comment">                    $success = $Plugins-&gt;call_method( $l_Plugin-&gt;ID, 'Uninstall', $params = array( 'unattended' =&gt; true ) );</span>
<a name="l1112"><span class="linenum">1112</span></a>  <span class="comment">                    if( $success === false )</span>
<a name="l1113"><span class="linenum">1113</span></a>  <span class="comment">                    {</span>
<a name="l1114"><span class="linenum">1114</span></a>  <span class="comment">                        echo &quot;Failed un-installing plugin $l_Plugin-&gt;classname (ID $l_Plugin-&gt;ID)...&lt;br /&gt;\n&quot;;</span>
<a name="l1115"><span class="linenum">1115</span></a>  <span class="comment">                        $at_least_one_failed = false;</span>
<a name="l1116"><span class="linenum">1116</span></a>  <span class="comment">                    }</span>
<a name="l1117"><span class="linenum">1117</span></a>  <span class="comment">                    else</span>
<a name="l1118"><span class="linenum">1118</span></a>  <span class="comment">                    {</span>
<a name="l1119"><span class="linenum">1119</span></a>  <span class="comment">                        echo &quot;Uninstalled plugin $l_Plugin-&gt;classname (ID $l_Plugin-&gt;ID)...&lt;br /&gt;\n&quot;;</span>
<a name="l1120"><span class="linenum">1120</span></a>  <span class="comment">                    }</span>
<a name="l1121"><span class="linenum">1121</span></a>  <span class="comment">                }</span>
<a name="l1122"><span class="linenum">1122</span></a>  <span class="comment">                if( $at_least_one_failed )</span>
<a name="l1123"><span class="linenum">1123</span></a>  <span class="comment">                {</span>
<a name="l1124"><span class="linenum">1124</span></a>  <span class="comment">                    echo &quot;You may want to manually remove left files or DB tables from the failed plugin(s).&lt;br /&gt;\n&quot;;</span>
<a name="l1125"><span class="linenum">1125</span></a>  <span class="comment">                }</span>
<a name="l1126"><span class="linenum">1126</span></a>  <span class="comment">                $DB-&gt;show_errors = $DB-&gt;halt_on_error = true;</span>
<a name="l1127"><span class="linenum">1127</span></a>  <span class="comment">        */</span>
<a name="l1128"><span class="linenum">1128</span></a>  
<a name="l1129"><span class="linenum">1129</span></a>  <span class="comment">        // Uninstall b2evolution: Delete DB &amp; Cache files</span>
<a name="l1130"><span class="linenum">1130</span></a>          <a class="function" onClick="logFunction('uninstall_b2evolution')" href="../_functions/uninstall_b2evolution.html" onMouseOver="funcPopup(event,'uninstall_b2evolution')">uninstall_b2evolution</a>();
<a name="l1131"><span class="linenum">1131</span></a>  
<a name="l1132"><span class="linenum">1132</span></a>  <span class="comment">        // Stop the animation of the progress bar</span>
<a name="l1133"><span class="linenum">1133</span></a>          <a class="function" onClick="logFunction('stop_install_progress_bar')" href="../_functions/stop_install_progress_bar.html" onMouseOver="funcPopup(event,'stop_install_progress_bar')">stop_install_progress_bar</a>();
<a name="l1134"><span class="linenum">1134</span></a>  
<a name="l1135"><span class="linenum">1135</span></a>  <span class="comment">        // A link to back to install menu</span>
<a name="l1136"><span class="linenum">1136</span></a>          <a class="function" onClick="logFunction('display_install_back_link')" href="../_functions/display_install_back_link.html" onMouseOver="funcPopup(event,'display_install_back_link')">display_install_back_link</a>();
<a name="l1137"><span class="linenum">1137</span></a>          break;
<a name="l1138"><span class="linenum">1138</span></a>  
<a name="l1139"><span class="linenum">1139</span></a>  
<a name="l1140"><span class="linenum">1140</span></a>      case 'utf8check':
<a name="l1141"><span class="linenum">1141</span></a>          <span class="comment">/*</span>
<a name="l1142"><span class="linenum">1142</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l1143"><span class="linenum">1143</span></a>  <span class="comment">         * CHECK DB tables for expecting COLLATION</span>
<a name="l1144"><span class="linenum">1144</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l1145"><span class="linenum">1145</span></a>  <span class="comment">         */</span>
<a name="l1146"><span class="linenum">1146</span></a>  
<a name="l1147"><span class="linenum">1147</span></a>          <a class="function" onClick="logFunction('load_funcs')" href="../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>('_core/model/db/_upgrade.funcs.php');
<a name="l1148"><span class="linenum">1148</span></a>          ?&gt;
<a name="l1149"><span class="linenum">1149</span></a>  
<a name="l1150"><span class="linenum">1150</span></a>          &lt;form action="<a class="filename" href="../index.php.html">index.php</a>" method=&quot;get&quot; class=&quot;evo_form__install&quot;&gt;
<a name="l1151"><span class="linenum">1151</span></a>              &lt;input type=&quot;hidden&quot; name=&quot;locale&quot; value=&quot;&lt;?php echo <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a>; ?&gt;&quot; /&gt;
<a name="l1152"><span class="linenum">1152</span></a>              &lt;input type=&quot;hidden&quot; name=&quot;confirmed&quot; value=&quot;0&quot; /&gt;
<a name="l1153"><span class="linenum">1153</span></a>              &lt;input type=&quot;hidden&quot; name=&quot;installer_version&quot; value=&quot;10&quot; /&gt;
<a name="l1154"><span class="linenum">1154</span></a>              &lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;utf8upgrade&quot; /&gt;
<a name="l1155"><span class="linenum">1155</span></a>  
<a name="l1156"><span class="linenum">1156</span></a>              &lt;?php <a class="function" onClick="logFunction('db_check_utf8_ascii')" href="../_functions/db_check_utf8_ascii.html" onMouseOver="funcPopup(event,'db_check_utf8_ascii')">db_check_utf8_ascii</a>(); ?&gt;
<a name="l1157"><span class="linenum">1157</span></a>  
<a name="l1158"><span class="linenum">1158</span></a>              &lt;p class=&quot;evo_form__install_buttons&quot;&gt;
<a name="l1159"><span class="linenum">1159</span></a>                  &lt;button type=&quot;submit&quot; class=&quot;btn btn-primary btn-lg&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Proceed with normalization procedure!'); ?&gt;&lt;/button&gt;&lt;?php
<a name="l1160"><span class="linenum">1160</span></a>                  ?&gt;&lt;a href=&quot;index.php?locale=&lt;?php echo <a class="var it624" onMouseOver="hilite(624)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../_variables/default_locale.html">$default_locale</a>; ?&gt;&quot; class=&quot;btn btn-default btn-lg&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Cancel'); ?&gt;&lt;/a&gt;
<a name="l1161"><span class="linenum">1161</span></a>              &lt;/p&gt;
<a name="l1162"><span class="linenum">1162</span></a>          &lt;/form&gt;
<a name="l1163"><span class="linenum">1163</span></a>  
<a name="l1164"><span class="linenum">1164</span></a>          &lt;?php
<a name="l1165"><span class="linenum">1165</span></a>          break;
<a name="l1166"><span class="linenum">1166</span></a>  
<a name="l1167"><span class="linenum">1167</span></a>  
<a name="l1168"><span class="linenum">1168</span></a>      case 'utf8upgrade':
<a name="l1169"><span class="linenum">1169</span></a>          <span class="comment">/*</span>
<a name="l1170"><span class="linenum">1170</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l1171"><span class="linenum">1171</span></a>  <span class="comment">         * UPGRADE DB to UTF-8: all DB tables will be converted to UTF-8</span>
<a name="l1172"><span class="linenum">1172</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l1173"><span class="linenum">1173</span></a>  <span class="comment">         */</span>
<a name="l1174"><span class="linenum">1174</span></a>  
<a name="l1175"><span class="linenum">1175</span></a>          <a class="function" onClick="logFunction('load_funcs')" href="../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>('_core/model/db/_upgrade.funcs.php');
<a name="l1176"><span class="linenum">1176</span></a>  
<a name="l1177"><span class="linenum">1177</span></a>  <span class="comment">        // Progress bar</span>
<a name="l1178"><span class="linenum">1178</span></a>          <a class="function" onClick="logFunction('start_install_progress_bar')" href="../_functions/start_install_progress_bar.html" onMouseOver="funcPopup(event,'start_install_progress_bar')">start_install_progress_bar</a>( <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Conversion in progress') );
<a name="l1179"><span class="linenum">1179</span></a>  
<a name="l1180"><span class="linenum">1180</span></a>          <a class="function" onClick="logFunction('db_upgrade_to_utf8_ascii')" href="../_functions/db_upgrade_to_utf8_ascii.html" onMouseOver="funcPopup(event,'db_upgrade_to_utf8_ascii')">db_upgrade_to_utf8_ascii</a>();
<a name="l1181"><span class="linenum">1181</span></a>  
<a name="l1182"><span class="linenum">1182</span></a>  <span class="comment">        // Stop the animation of the progress bar</span>
<a name="l1183"><span class="linenum">1183</span></a>          <a class="function" onClick="logFunction('stop_install_progress_bar')" href="../_functions/stop_install_progress_bar.html" onMouseOver="funcPopup(event,'stop_install_progress_bar')">stop_install_progress_bar</a>();
<a name="l1184"><span class="linenum">1184</span></a>  
<a name="l1185"><span class="linenum">1185</span></a>  <span class="comment">        // A link to back to install menu</span>
<a name="l1186"><span class="linenum">1186</span></a>          <a class="function" onClick="logFunction('display_install_back_link')" href="../_functions/display_install_back_link.html" onMouseOver="funcPopup(event,'display_install_back_link')">display_install_back_link</a>();
<a name="l1187"><span class="linenum">1187</span></a>          break;
<a name="l1188"><span class="linenum">1188</span></a>  }
<a name="l1189"><span class="linenum">1189</span></a>  
<a name="l1190"><span class="linenum">1190</span></a>  <a class="function" onClick="logFunction('block_close')" href="../_functions/block_close.html" onMouseOver="funcPopup(event,'block_close')">block_close</a>();
<a name="l1191"><span class="linenum">1191</span></a>  ?&gt;
<a name="l1192"><span class="linenum">1192</span></a>  
<a name="l1193"><span class="linenum">1193</span></a>  &lt;!-- InstanceEndEditable --&gt;
<a name="l1194"><span class="linenum">1194</span></a>  
<a name="l1195"><span class="linenum">1195</span></a>              &lt;?php
<a name="l1196"><span class="linenum">1196</span></a>              if( <a class="var it378" onMouseOver="hilite(378)" onMouseOut="lolite()" onClick="logVariable('display')" href="../_variables/display.html">$display</a> == 'normal' )
<a name="l1197"><span class="linenum">1197</span></a>              { // Display footer only on normal mode:
<a name="l1198"><span class="linenum">1198</span></a>              ?&gt;
<a name="l1199"><span class="linenum">1199</span></a>              &lt;footer class=&quot;footer&quot; id=&quot;sticky_footer&quot;&gt;
<a name="l1200"><span class="linenum">1200</span></a>                  &lt;p class=&quot;pull-right&quot;&gt;&lt;a href=&quot;https://github.com/b2evolution/b2evolution&quot; class=&quot;text-nowrap&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('GitHub page'); ?&gt;&lt;/a&gt;&lt;/p&gt;
<a name="l1201"><span class="linenum">1201</span></a>                  &lt;p&gt;&lt;a href=&quot;http://b2evolution.net/&quot; class=&quot;text-nowrap&quot;&gt;b2evolution.net&lt;/a&gt;
<a name="l1202"><span class="linenum">1202</span></a>                  &amp;bull; &lt;a href=&quot;http://b2evolution.net/about/recommended-hosting-lamp-best-choices.php&quot; class=&quot;text-nowrap&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Find a host'); ?&gt;&lt;/a&gt;
<a name="l1203"><span class="linenum">1203</span></a>                  &amp;bull; &lt;a href=&quot;http://b2evolution.net/man/&quot; class=&quot;text-nowrap&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Online manual'); ?&gt;&lt;/a&gt;
<a name="l1204"><span class="linenum">1204</span></a>                  &amp;bull; &lt;a href=&quot;http://forums.b2evolution.net&quot; class=&quot;text-nowrap&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Help forums'); ?&gt;&lt;/a&gt;
<a name="l1205"><span class="linenum">1205</span></a>                  &lt;/p&gt;
<a name="l1206"><span class="linenum">1206</span></a>              &lt;/footer&gt;
<a name="l1207"><span class="linenum">1207</span></a>              &lt;?php } ?&gt;
<a name="l1208"><span class="linenum">1208</span></a>  
<a name="l1209"><span class="linenum">1209</span></a>          &lt;/div&gt;&lt;!-- /container --&gt;
<a name="l1210"><span class="linenum">1210</span></a>  
<a name="l1211"><span class="linenum">1211</span></a>      &lt;?php
<a name="l1212"><span class="linenum">1212</span></a>  <span class="comment">        // We need to manually call debug_info since there is no shutdown function registered during the install process.</span>
<a name="l1213"><span class="linenum">1213</span></a>  <span class="comment">        // debug_info( true ); // force output of debug info</span>
<a name="l1214"><span class="linenum">1214</span></a>  
<a name="l1215"><span class="linenum">1215</span></a>  <span class="comment">        // The following comments get checked in the automatic install script of demo.b2evolution.net:</span>
<a name="l1216"><span class="linenum">1216</span></a>  ?&gt;
<a name="l1217"><span class="linenum">1217</span></a>  &lt;!-- b2evo-install-action:&lt;?php echo <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../_variables/action.html">$action</a> ?&gt; --&gt;
<a name="l1218"><span class="linenum">1218</span></a>  &lt;!-- b2evo-install-end --&gt;
<a name="l1219"><span class="linenum">1219</span></a>      &lt;/body&gt;
<a name="l1220"><span class="linenum">1220</span></a>  &lt;/html&gt;
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'locale': ['locale', 'Template function: display locale for item ', [['inc/items/model','_itemlight.class.php',879]], 9],
'header_redirect': ['header_redirect', 'Sends HTTP header to redirect to the previous location (which can be given as function parameter, GET parameter (redirect_to), is taken from {@link Hit::$referer} or {@link $baseurl}). ', [['inc/_core','_template.funcs.php',91]], 427],
'echo_install_button_js': ['echo_install_button_js', 'Print JavaScript to control button on install page ', [['install','_functions_install.php',1412]], 1],
'get_install_steps_count': ['get_install_steps_count', 'Calculate a number of the steps for current installation ', [['install','_functions_install.php',1208]], 1],
'set_params': ['set_params', 'Set params for messages ', [['inc/_core/model','_messages.class.php',325]], 6],
'get_manual_url': ['get_manual_url', 'Get the manual url for the given topic ', [['inc/_core','_misc.funcs.php',4922]], 60],
'uninstall_b2evolution': ['uninstall_b2evolution', 'Uninstall b2evolution: Delete DB & Cache files ', [['install','_functions_delete.php',41]], 2],
'get_php_bytes_size': ['get_php_bytes_size', 'Get how much bytes php ini value takes ', [['inc/tools/model','_system.funcs.php',524]], 6],
'list': ['list', '', [['rsc/js/bootstrap','typeahead.bundle.js',156]], 105],
'begin_form': ['begin_form', 'Builds the form field ', [['inc/_core/ui/forms','_form.class.php',1816]], 194],
'switch_maintenance_mode': ['switch_maintenance_mode', 'Enable/disable maintenance mode ', [['inc/maintenance/model','_maintenance.funcs.php',95]], 6],
'evo_flush': ['evo_flush', 'Flush the output buffer ', [['inc/_core','_misc.funcs.php',6613]], 166],
'locale_lang': ['locale_lang', 'Displays/Returns the current locale. (for backward compatibility) ', [['inc/locales','_locale.funcs.php',352]], 22],
'db_upgrade_to_utf8_ascii': ['db_upgrade_to_utf8_ascii', 'Upgrade DB to UTF-8 and fix ASCII fields ', [['inc/_core/model/db','_upgrade.funcs.php',1799]], 2],
'install_newdb': ['install_newdb', 'Install new DB. ', [['install','_functions_install.php',152]], 1],
'init_charsets': ['init_charsets', 'Init charset handling between Input/Output ($io_charset) and the internal handling ($evo_charset). ', [['inc/locales','_locale.funcs.php',1125]], 11],
'install_validate_requirements': ['install_validate_requirements', 'Validate install requirements. ', [['install','_functions_install.php',382]], 1],
'display_base_config_recap': ['display_base_config_recap', 'Base config recap ', [['install','_functions_install.php',112]], 2],
'system_check_charset_update': ['system_check_charset_update', 'Check if some of the tables have different charset than what we expect ', [['inc/tools/model','_system.funcs.php',559]], 3],
'install_htaccess': ['install_htaccess', 'Install htaccess: Check if it works with the webserver, then install it for real. ', [['install','_functions_install.php',959]], 2],
'locale_activate': ['locale_activate', 'Activate a locale. ', [['inc/locales','_locale.funcs.php',300]], 17],
'utf8_strtoupper': ['utf8_strtoupper', 'utf8_strtoupper( ) ', [['inc/_ext','_portable_utf8.php',1464]], 4],
'display_install_messages': ['display_install_messages', 'Display the messages on install pages ', [['install','_functions_install.php',1351]], 15],
'load_class': ['load_class', 'In PHP4, this really loads the class. In PHP5, it\'s smarter than that: It only registers the class & file name so that __autoload() can later load the class IF and ONLY IF the class is actually needed during execution. ', [['inc/_core','_class5.funcs.php',64],['inc/_core','_class4.funcs.php',19]], 435],
'install': ['install', 'Install current skin to DB ', [['inc/skins/model','_skin.class.php',108]], 4],
'get_version': ['get_version', 'version 1 ', [['plugins/twitter_plugin/twitteroauth','oauth.php',555],['inc/_core/model/db','_db.class.php',683]], 6],
'system_check_memory_limit': ['system_check_memory_limit', '', [['inc/tools/model','_system.funcs.php',491]], 6],
'load_funcs': ['load_funcs', '', [['inc/_core','_misc.funcs.php',158]], 242],
'get_upgrade_steps_count': ['get_upgrade_steps_count', 'Calculate a number of the steps for current upgrading ', [['install','_functions_install.php',1303]], 1],
'end_form': ['end_form', 'Ends the form, optionally displays buttons and closes all open fieldsets. ', [['inc/_core/ui/forms','_form.class.php',1975]], 208],
'display': ['display', 'Display the widget! ', [['inc/widgets/widgets','_coll_tag_cloud.widget.php',170],['inc/_core/model/db','_sql.class.php',68],['inc/widgets/widgets','_coll_logo.widget.php',138],['inc/widgets/widgets','_mobile_skin_switcher.widget.php',105],['inc/widgets/widgets','_online_users.widget.php',95],['inc/widgets/widgets','_user_login.widget.php',195],['inc/widgets/widgets','_coll_item_list.widget.php',274],['inc/_core/model','_messages.class.php',183],['inc/widgets/widgets','_user_links.widget.php',114],['inc/widgets/widgets','_coll_featured_intro.widget.php',171],['plugins','_calendar.plugin.php',619],['inc/widgets/widgets','_coll_search_form.widget.php',135],['inc/widgets/widgets','_coll_longdesc.widget.php',99],['inc/widgets/widgets','_content_hierarchy.widget.php',120],['inc/widgets/widgets','_coll_tagline.widget.php',79],['inc/widgets/widgets','_coll_current_filters.widget.php',113],['inc/widgets/widgets','_coll_category_list.widget.php',198],['inc/widgets/widgets','_org_members.widget.php',147],['inc/widgets/widgets','_coll_comment_list.widget.php',129],['inc/_core/model','_log.class.php',276],['inc/_core/model','_log.class.php',602],['inc/widgets/widgets','_member_count.widget.php',66],['inc/widgets/widgets','_menu_link.widget.php',202],['inc/_core/ui/results','_results.class.php',916],['inc/widgets/widgets','_free_html.widget.php',110],['inc/widgets/widgets','_breadcrumb_path.widget.php',103],['inc/widgets/widgets','_image.widget.php',139],['inc/widgets/widgets','_profile_menu_link.widget.php',128],['inc/widgets/widgets','_coll_media_index.widget.php',199],['inc/widgets/model','_widget.class.php',513],['inc/widgets/widgets','_colls_list_owner.widget.php',121],['inc/widgets/widgets','_user_tools.widget.php',252],['inc/widgets/widgets','_coll_common_links.widget.php',167],['inc/widgets/widgets','_msg_menu_link.widget.php',191],['inc/widgets/widgets','_user_avatars.widget.php',177],['inc/widgets/widgets','_coll_xml_feeds.widget.php',120],['inc/widgets/widgets','_coll_avatar.widget.php',92],['inc/widgets/widgets','_user_register.widget.php',156],['inc/widgets/widgets','_colls_list_public.widget.php',121],['inc/widgets/widgets','_coll_title.widget.php',100]], 129],
'set_max_execution_time': ['set_max_execution_time', 'Set max execution time ', [['inc/_core','_misc.funcs.php',5931]], 20],
'modules_call_method': ['modules_call_method', 'Call a method for all modules in a row ', [['inc/_core','_misc.funcs.php',33]], 26],
'update_install_progress_bar': ['update_install_progress_bar', 'Print JavaScript to update the progress bar status ', [['install','_functions_install.php',1176]], 18],
'format_to_output': ['format_to_output', 'Format a string/content for being output ', [['inc/_core','_misc.funcs.php',264]], 318],
'get_requri': ['get_requri', 'Get $ReqPath, $ReqURI ', [['inc/_core','_misc.funcs.php',5767]], 3],
'remove_after_upgrade': ['remove_after_upgrade', 'Remove files/folders after upgrade, See file upgrade_policy.conf ', [['inc/maintenance/model','_maintenance.funcs.php',688]], 1],
'start_install_progress_bar': ['start_install_progress_bar', 'Display a progress bar to start an animation of a process ', [['install','_functions_install.php',1113]], 4],
'get_default_locale_from_db': ['get_default_locale_from_db', 'Get default locale from db ', [['install','_functions_install.php',294]], 1],
'update_basic_config_file': ['update_basic_config_file', 'Update file /conf/_basic_config.php ', [['install','_functions_install.php',1670]], 2],
'text': ['text', 'Builds a text (or password) input field. ', [['inc/_core/ui/forms','_form.class.php',1037]], 228],
'track_step': ['track_step', 'We use the following tracking to determine the installer reliability (% of failed vs successful installs). ', [['install','_functions_install.php',1088]], 7],
'hidden': ['hidden', 'Builds an hidden input tag, overwriting any previous hidden values (except for "foo[]"). ', [['inc/_core/ui/forms','_form.class.php',3046]], 689],
'php_to_mysql_charmap': ['php_to_mysql_charmap', 'Convert a PHP charset to its MySQL equivalent. ', [['inc/_core/model/db','_db.class.php',1660]], 7],
'locale_from_httpaccept': ['locale_from_httpaccept', 'Detect language from HTTP_ACCEPT_LANGUAGE ', [['inc/locales','_locale.funcs.php',582]], 2],
'check_quick_install_request': ['check_quick_install_request', 'Check request for quick installation Update basic config file from url params ', [['install','_functions_install.php',1561]], 1],
'display_locale_selector': ['display_locale_selector', 'Language selector ', [['install','_functions_install.php',50]], 5],
'param': ['param', 'Sets a parameter with values from the request or to provided default, except if param is already set! ', [['inc/_core','_param.funcs.php',35]], 2141],
'upgrade_b2evo_tables': ['upgrade_b2evo_tables', 'Upgrade the module\'s tables in b2evo database ', [['inc/_core/model','_module.class.php',91],['install','_functions_evoupgrade.php',285]], 1],
't_': ['t_', 'Provide translation in the context of this module: ', [['inc/_core/model','_module.class.php',67],['rsc/js','blog_widgets.js',467],['inc/skins/model','_skin.class.php',1131],['inc/plugins','_plugin.class.php',2799],['inc/locales','_locale.funcs.php',29],['inc/locales','_locale.funcs.php',226]], 12118],
'check_local_installation': ['check_local_installation', 'Check if current installation is local ', [['install','_functions_install.php',1488]], 2],
'display_install_back_link': ['display_install_back_link', 'Display a link to back to install menu ', [['install','_functions_install.php',1100]], 6],
'db_check_utf8_ascii': ['db_check_utf8_ascii', 'Upgrade DB to UTF-8 and fix ASCII fields ', [['inc/_core/model/db','_upgrade.funcs.php',1762]], 2],
'stop_install_progress_bar': ['stop_install_progress_bar', 'Print JavaScript to stop the animation of the progress bar ', [['install','_functions_install.php',1157]], 5],
'display_install_result_window': ['display_install_result_window', 'Display modal window after install process with some data ', [['install','_functions_install.php',1519]], 2],
'get_db_version': ['get_db_version', '', [['install','_functions_install.php',268]], 7],
'get_script_baseurl': ['get_script_baseurl', 'Get baseurl depending on current called script ', [['inc/_core','_misc.funcs.php',7447]], 4],
'locales_load_available_defs': ['locales_load_available_defs', 'Load available locale definitions ', [['inc/locales','_locale.funcs.php',1219]], 6],
'switch_template_parts': ['switch_template_parts', 'Set a parts of form from array ', [['inc/_core/ui/forms','_form.class.php',690]], 76],
'block_open': ['block_open', 'Open a block ', [['install','_functions_install.php',13]], 6],
'block_close': ['block_close', 'Close a block ', [['install','_functions_install.php',36]], 8],
'ini_get': ['ini_get', '', [], 43],
'dirname': ['dirname', '', [], 182],
'time': ['time', '', [], 76],
'file': ['file', '', [], 78],
'version_compare': ['version_compare', '', [], 113],
'nl2br': ['nl2br', '', [], 21],
'is_null': ['is_null', '', [], 299],
'define': ['define', '', [], 192],
'preg_match': ['preg_match', '', [], 423],
'htmlspecialchars': ['htmlspecialchars', '', [], 152],
'preg_replace': ['preg_replace', '', [], 325],
'ini_set': ['ini_set', '', [], 37],
'floor': ['floor', '', [], 116],
'header': ['header', '', [], 83]};
CLASS_DATA={
'log': ['log', 'Log class. Logs notes and errors. ', [['inc/_core/model','_log.class.php',26]], 9],
'timer': ['timer', 'This is a simple class to allow timing/profiling of code portions. ', [['inc/_core/model','_timer.class.php',22]], 7],
'messages': ['messages', 'Messages class. For displaying notes, successful actions & errors. ', [['inc/_core/model','_messages.class.php',26]], 4],
'form': ['form', 'Form class ', [['inc/_core/ui/forms','_form.class.php',28]], 208],
'db': ['db', 'The Main Class ', [['inc/_core/model/db','_db.class.php',54]], 16]};
CONST_DATA={
'EVO_IS_INSTALLING': ['EVO_IS_INSTALLING', '', [['install','index.php',31]], 5],
'EVO_MAIN_INIT': ['EVO_MAIN_INIT', '', [['install','index.php',26],['inc','_main.inc.php',36],['install','debug.php',22]], 912]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Sat Nov 21 22:13:19 2015</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>

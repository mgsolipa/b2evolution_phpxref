<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /blogs/inc/items/items.ctrl.php source</title>
    <link rel="stylesheet" href="../../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Sat Jul  5 12:18:44 2014 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../../';
subdir='blogs/inc/items';
filename='items.ctrl.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/blogs/inc/items/</a> -> <a href="items.ctrl.php.html">items.ctrl.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="items.ctrl.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="items.ctrl.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">/**</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment"> * This file implements the UI controller for managing posts.</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment"> *</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment"> * b2evolution - {@link http://b2evolution.net/}</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment"> * Released under GNU GPL License - {@link http://b2evolution.net/about/license.html}</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment"> * @copyright (c)2003-2014 by Francois Planque - {@link http://fplanque.com/}</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment"> *</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment"> * {@internal Open Source relicensing agreement:</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment"> * }}</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment"> *</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment"> * @todo dh&gt; AFAICS there are three params used for &quot;item ID&quot;: &quot;p&quot;, &quot;post_ID&quot;</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment"> *       and &quot;item_ID&quot;. This should get cleaned up.</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment"> *       Side effect: &quot;post_ID required&quot; error if you switch tabs (expert/simple),</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment"> *       after an error is display (e.g. entering an invalid issue time).</span>
<a name="l16"><span class="linenum">  16</span></a>  <span class="comment"> *       (related to $tab_switch_params)</span>
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment"> * fp&gt; Yes, it's a mess...</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> *     Ironically the correct name would be itm_ID (which is what the DB uses,</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *     except for the Items table which should actually also use itm_ prefixes instead of post_</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> *     ... a lot of history lead to this :p</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> *</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @package admin</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> *</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> * {@internal Below is a list of authors who have contributed to design/coding of this file: }}</span>
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment"> * @author fplanque: Francois PLANQUE.</span>
<a name="l26"><span class="linenum">  26</span></a>  <span class="comment"> *</span>
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment"> * @version $Id: items.ctrl.php 6650 2014-05-09 09:22:38Z yura $</span>
<a name="l28"><span class="linenum">  28</span></a>  <span class="comment"> */</span>
<a name="l29"><span class="linenum">  29</span></a>  if( !<a class="phpfunction" onClick="logFunction('defined')" href="../../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('EVO_MAIN_INIT')" href="../../../_constants/EVO_MAIN_INIT.html" onMouseOver="constPopup(event,'EVO_MAIN_INIT')">EVO_MAIN_INIT</a>') ) die( 'Please, do not access this page directly.' );
<a name="l30"><span class="linenum">  30</span></a>  
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment">/**</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> * @var AdminUI</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> */</span>
<a name="l34"><span class="linenum">  34</span></a>  global <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>;
<a name="l35"><span class="linenum">  35</span></a>  
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment">/**</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment"> * @var UserSettings</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment"> */</span>
<a name="l39"><span class="linenum">  39</span></a>  global <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('UserSettings')" href="../../../_variables/UserSettings.html">$UserSettings</a>;
<a name="l40"><span class="linenum">  40</span></a>  
<a name="l41"><span class="linenum">  41</span></a>  <span class="comment">/**</span>
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment"> * @var User</span>
<a name="l43"><span class="linenum">  43</span></a>  <span class="comment"> */</span>
<a name="l44"><span class="linenum">  44</span></a>  global <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>;
<a name="l45"><span class="linenum">  45</span></a>  
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment">/**</span>
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment"> * @var Blog</span>
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment"> */</span>
<a name="l49"><span class="linenum">  49</span></a>  global <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>;
<a name="l50"><span class="linenum">  50</span></a>  
<a name="l51"><span class="linenum">  51</span></a>  global <a class="var it230" onMouseOver="hilite(230)" onMouseOut="lolite()" onClick="logVariable('dispatcher')" href="../../../_variables/dispatcher.html">$dispatcher</a>;
<a name="l52"><span class="linenum">  52</span></a>  
<a name="l53"><span class="linenum">  53</span></a>  <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = <a class="function" onClick="logFunction('param_action')" href="../../../_functions/param_action.html" onMouseOver="funcPopup(event,'param_action')">param_action</a>( 'list' );
<a name="l54"><span class="linenum">  54</span></a>  
<a name="l55"><span class="linenum">  55</span></a>  <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('set_path')" href="../../../_functions/set_path.html" onMouseOver="funcPopup(event,'set_path')">set_path</a>( 'items' );    <span class="comment">// Sublevel may be attached below</span>
<a name="l56"><span class="linenum">  56</span></a>  
<a name="l57"><span class="linenum">  57</span></a>  
<a name="l58"><span class="linenum">  58</span></a>  <span class="comment">/*</span>
<a name="l59"><span class="linenum">  59</span></a>  <span class="comment"> * Init the objects we want to work on.</span>
<a name="l60"><span class="linenum">  60</span></a>  <span class="comment"> *</span>
<a name="l61"><span class="linenum">  61</span></a>  <span class="comment"> * Autoselect a blog where we have PERMISSION to browse (preferably the last used blog):</span>
<a name="l62"><span class="linenum">  62</span></a>  <span class="comment"> * Note: for some actions, we'll get the blog from the post ID</span>
<a name="l63"><span class="linenum">  63</span></a>  <span class="comment"> */</span>
<a name="l64"><span class="linenum">  64</span></a>  
<a name="l65"><span class="linenum">  65</span></a>  <a class="var it6475" onMouseOver="hilite(6475)" onMouseOut="lolite()" onClick="logVariable('mass_create')" href="../../../_variables/mass_create.html">$mass_create</a> = <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'mass_create', 'integer' );
<a name="l66"><span class="linenum">  66</span></a>  if( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> == 'new_switchtab' &amp;&amp; !empty( <a class="var it6475" onMouseOver="hilite(6475)" onMouseOut="lolite()" onClick="logVariable('mass_create')" href="../../../_variables/mass_create.html">$mass_create</a> ) )
<a name="l67"><span class="linenum">  67</span></a>  {    // Replace action with mass create action
<a name="l68"><span class="linenum">  68</span></a>      <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'new_mass';
<a name="l69"><span class="linenum">  69</span></a>  }
<a name="l70"><span class="linenum">  70</span></a>  
<a name="l71"><span class="linenum">  71</span></a>  <span class="comment">// for post from files</span>
<a name="l72"><span class="linenum">  72</span></a>  if( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> == 'group_action' )
<a name="l73"><span class="linenum">  73</span></a>  { // Get the real action from the select:
<a name="l74"><span class="linenum">  74</span></a>      <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'group_action', 'string', '' );
<a name="l75"><span class="linenum">  75</span></a>  }
<a name="l76"><span class="linenum">  76</span></a>  
<a name="l77"><span class="linenum">  77</span></a>  
<a name="l78"><span class="linenum">  78</span></a>  switch( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> )
<a name="l79"><span class="linenum">  79</span></a>  {
<a name="l80"><span class="linenum">  80</span></a>      case 'edit':
<a name="l81"><span class="linenum">  81</span></a>      case 'history':
<a name="l82"><span class="linenum">  82</span></a>      case 'history_details':
<a name="l83"><span class="linenum">  83</span></a>      case 'history_compare':
<a name="l84"><span class="linenum">  84</span></a>      case 'history_restore':
<a name="l85"><span class="linenum">  85</span></a>  <span class="comment">        // Load post to edit:</span>
<a name="l86"><span class="linenum">  86</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'p', 'integer', true, true );
<a name="l87"><span class="linenum">  87</span></a>          <a class="var it99" onMouseOver="hilite(99)" onMouseOut="lolite()" onClick="logVariable('ItemCache')" href="../../../_variables/ItemCache.html">$ItemCache</a> = &amp; get_ItemCache();
<a name="l88"><span class="linenum">  88</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> = &amp; <a class="var it99" onMouseOver="hilite(99)" onMouseOut="lolite()" onClick="logVariable('ItemCache')" href="../../../_variables/ItemCache.html">$ItemCache</a>-&gt;get_by_ID( <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('p')" href="../../../_variables/p.html">$p</a> );
<a name="l89"><span class="linenum">  89</span></a>  
<a name="l90"><span class="linenum">  90</span></a>  <span class="comment">        // Load the blog we're in:</span>
<a name="l91"><span class="linenum">  91</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a> = &amp; <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;get_Blog();
<a name="l92"><span class="linenum">  92</span></a>          <a class="function" onClick="logFunction('set_working_blog')" href="../../../_functions/set_working_blog.html" onMouseOver="funcPopup(event,'set_working_blog')">set_working_blog</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a onClick="logVariable('ID')" class="var it8952" onMouseOver="hilite(8952)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> );
<a name="l93"><span class="linenum">  93</span></a>  
<a name="l94"><span class="linenum">  94</span></a>  <span class="comment">        // Where are we going to redirect to?</span>
<a name="l95"><span class="linenum">  95</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'redirect_to', 'url', <a class="function" onClick="logFunction('url_add_param')" href="../../../_functions/url_add_param.html" onMouseOver="funcPopup(event,'url_add_param')">url_add_param</a>( <a class="var it346" onMouseOver="hilite(346)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../../_variables/admin_url.html">$admin_url</a>, 'ctrl=items&amp;filter=restore&amp;blog='.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a onClick="logVariable('ID')" class="var it8952" onMouseOver="hilite(8952)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>.'&amp;highlight='.<a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, '&amp;' ) );
<a name="l96"><span class="linenum">  96</span></a>          break;
<a name="l97"><span class="linenum">  97</span></a>  
<a name="l98"><span class="linenum">  98</span></a>      case 'mass_edit' :
<a name="l99"><span class="linenum">  99</span></a>          break;
<a name="l100"><span class="linenum"> 100</span></a>  
<a name="l101"><span class="linenum"> 101</span></a>      case 'update_edit' :
<a name="l102"><span class="linenum"> 102</span></a>      case 'update' :
<a name="l103"><span class="linenum"> 103</span></a>      case 'update_publish' :
<a name="l104"><span class="linenum"> 104</span></a>      case 'publish' :
<a name="l105"><span class="linenum"> 105</span></a>      case 'publish_now' :
<a name="l106"><span class="linenum"> 106</span></a>      case 'restrict' :
<a name="l107"><span class="linenum"> 107</span></a>      case 'deprecate' :
<a name="l108"><span class="linenum"> 108</span></a>      case 'delete' :
<a name="l109"><span class="linenum"> 109</span></a>  <span class="comment">    // Note: we need to *not* use $p in the cases above or it will conflict with the list display</span>
<a name="l110"><span class="linenum"> 110</span></a>      case 'edit_switchtab' : // this gets set as action by JS, when we switch tabs
<a name="l111"><span class="linenum"> 111</span></a>          if( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> != 'edit_switchtab' )
<a name="l112"><span class="linenum"> 112</span></a>          { // Stop a request from the blocked IP addresses or Domains
<a name="l113"><span class="linenum"> 113</span></a>              <a class="function" onClick="logFunction('antispam_block_request')" href="../../../_functions/antispam_block_request.html" onMouseOver="funcPopup(event,'antispam_block_request')">antispam_block_request</a>();
<a name="l114"><span class="linenum"> 114</span></a>          }
<a name="l115"><span class="linenum"> 115</span></a>  
<a name="l116"><span class="linenum"> 116</span></a>  <span class="comment">        // Load post to edit:</span>
<a name="l117"><span class="linenum"> 117</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a> ( 'post_ID', 'integer', true, true );
<a name="l118"><span class="linenum"> 118</span></a>          <a class="var it99" onMouseOver="hilite(99)" onMouseOut="lolite()" onClick="logVariable('ItemCache')" href="../../../_variables/ItemCache.html">$ItemCache</a> = &amp; get_ItemCache ();
<a name="l119"><span class="linenum"> 119</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> = &amp; <a class="var it99" onMouseOver="hilite(99)" onMouseOut="lolite()" onClick="logVariable('ItemCache')" href="../../../_variables/ItemCache.html">$ItemCache</a>-&gt;<a onClick="logVariable('get_by_ID')" class="var it9027" onMouseOver="hilite(9027)" onMouseOut="lolite()" href="../../../_variables/get_by_ID.html">get_by_ID</a> ( <a class="var it41" onMouseOver="hilite(41)" onMouseOut="lolite()" onClick="logVariable('post_ID')" href="../../../_variables/post_ID.html">$post_ID</a> );
<a name="l120"><span class="linenum"> 120</span></a>  
<a name="l121"><span class="linenum"> 121</span></a>  <span class="comment">        // Load the blog we're in:</span>
<a name="l122"><span class="linenum"> 122</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a> = &amp; <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;get_Blog();
<a name="l123"><span class="linenum"> 123</span></a>          <a class="function" onClick="logFunction('set_working_blog')" href="../../../_functions/set_working_blog.html" onMouseOver="funcPopup(event,'set_working_blog')">set_working_blog</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a onClick="logVariable('ID')" class="var it8952" onMouseOver="hilite(8952)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> );
<a name="l124"><span class="linenum"> 124</span></a>  
<a name="l125"><span class="linenum"> 125</span></a>  <span class="comment">        // Where are we going to redirect to?</span>
<a name="l126"><span class="linenum"> 126</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'redirect_to', 'url', <a class="function" onClick="logFunction('url_add_param')" href="../../../_functions/url_add_param.html" onMouseOver="funcPopup(event,'url_add_param')">url_add_param</a>( <a class="var it346" onMouseOver="hilite(346)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../../_variables/admin_url.html">$admin_url</a>, 'ctrl=items&amp;filter=restore&amp;blog='.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a onClick="logVariable('ID')" class="var it8952" onMouseOver="hilite(8952)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>.'&amp;highlight='.<a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, '&amp;' ) );
<a name="l127"><span class="linenum"> 127</span></a>  
<a name="l128"><span class="linenum"> 128</span></a>  <span class="comment">        // What form button has been pressed?</span>
<a name="l129"><span class="linenum"> 129</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'save', 'string', '' );
<a name="l130"><span class="linenum"> 130</span></a>          <a class="var it6477" onMouseOver="hilite(6477)" onMouseOut="lolite()" onClick="logVariable('exit_after_save')" href="../../../_variables/exit_after_save.html">$exit_after_save</a> = ( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> != 'update_edit' );
<a name="l131"><span class="linenum"> 131</span></a>          break;
<a name="l132"><span class="linenum"> 132</span></a>  
<a name="l133"><span class="linenum"> 133</span></a>      case 'mass_save' :
<a name="l134"><span class="linenum"> 134</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'redirect_to', 'url', <a class="function" onClick="logFunction('url_add_param')" href="../../../_functions/url_add_param.html" onMouseOver="funcPopup(event,'url_add_param')">url_add_param</a>( <a class="var it346" onMouseOver="hilite(346)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../../_variables/admin_url.html">$admin_url</a>, 'ctrl=items&amp;filter=restore&amp;blog=' . <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a onClick="logVariable('ID')" class="var it8952" onMouseOver="hilite(8952)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, '&amp;' ) );
<a name="l135"><span class="linenum"> 135</span></a>          break;
<a name="l136"><span class="linenum"> 136</span></a>  
<a name="l137"><span class="linenum"> 137</span></a>      case 'new' :
<a name="l138"><span class="linenum"> 138</span></a>      case 'new_switchtab' : // this gets set as action by JS, when we switch tabs
<a name="l139"><span class="linenum"> 139</span></a>      case 'new_mass' :
<a name="l140"><span class="linenum"> 140</span></a>      case 'copy' :
<a name="l141"><span class="linenum"> 141</span></a>      case 'create_edit' :
<a name="l142"><span class="linenum"> 142</span></a>      case 'create' :
<a name="l143"><span class="linenum"> 143</span></a>      case 'create_publish' :
<a name="l144"><span class="linenum"> 144</span></a>      case 'list' :
<a name="l145"><span class="linenum"> 145</span></a>          if( <a class="phpfunction" onClick="logFunction('in_array')" href="../../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a>, array( 'create_edit', 'create', 'create_publish' ) ) )
<a name="l146"><span class="linenum"> 146</span></a>          { // Stop a request from the blocked IP addresses or Domains
<a name="l147"><span class="linenum"> 147</span></a>              <a class="function" onClick="logFunction('antispam_block_request')" href="../../../_functions/antispam_block_request.html" onMouseOver="funcPopup(event,'antispam_block_request')">antispam_block_request</a>();
<a name="l148"><span class="linenum"> 148</span></a>          }
<a name="l149"><span class="linenum"> 149</span></a>  
<a name="l150"><span class="linenum"> 150</span></a>          if( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> == 'list' )
<a name="l151"><span class="linenum"> 151</span></a>          {    // We only need view permission
<a name="l152"><span class="linenum"> 152</span></a>              <a class="var it1427" onMouseOver="hilite(1427)" onMouseOut="lolite()" onClick="logVariable('selected')" href="../../../_variables/selected.html">$selected</a> = <a class="function" onClick="logFunction('autoselect_blog')" href="../../../_functions/autoselect_blog.html" onMouseOver="funcPopup(event,'autoselect_blog')">autoselect_blog</a>( 'blog_ismember', 'view' );
<a name="l153"><span class="linenum"> 153</span></a>          }
<a name="l154"><span class="linenum"> 154</span></a>          else
<a name="l155"><span class="linenum"> 155</span></a>          {    // We need posting permission
<a name="l156"><span class="linenum"> 156</span></a>              <a class="var it1427" onMouseOver="hilite(1427)" onMouseOut="lolite()" onClick="logVariable('selected')" href="../../../_variables/selected.html">$selected</a> = <a class="function" onClick="logFunction('autoselect_blog')" href="../../../_functions/autoselect_blog.html" onMouseOver="funcPopup(event,'autoselect_blog')">autoselect_blog</a>( 'blog_post_statuses', 'edit' );
<a name="l157"><span class="linenum"> 157</span></a>          }
<a name="l158"><span class="linenum"> 158</span></a>  
<a name="l159"><span class="linenum"> 159</span></a>          if( ! <a class="var it1427" onMouseOver="hilite(1427)" onMouseOut="lolite()" onClick="logVariable('selected')" href="../../../_variables/selected.html">$selected</a>  )
<a name="l160"><span class="linenum"> 160</span></a>          { // No blog could be selected
<a name="l161"><span class="linenum"> 161</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Sorry, you have no permission to post yet.'), 'error' );
<a name="l162"><span class="linenum"> 162</span></a>              <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'nil';
<a name="l163"><span class="linenum"> 163</span></a>          }
<a name="l164"><span class="linenum"> 164</span></a>          else
<a name="l165"><span class="linenum"> 165</span></a>          {
<a name="l166"><span class="linenum"> 166</span></a>              if( <a class="function" onClick="logFunction('set_working_blog')" href="../../../_functions/set_working_blog.html" onMouseOver="funcPopup(event,'set_working_blog')">set_working_blog</a>( <a class="var it1427" onMouseOver="hilite(1427)" onMouseOut="lolite()" onClick="logVariable('selected')" href="../../../_variables/selected.html">$selected</a> ) )    // set <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a> &amp; memorize in user prefs
<a name="l167"><span class="linenum"> 167</span></a>              {    // Selected a <span class="keyword">new </span><a class="class" onClick="logClass('blog')" href="../../../_classes/blog.html" onMouseOver="classPopup(event,'blog')">blog</a>:
<a name="l168"><span class="linenum"> 168</span></a>                  <a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('BlogCache')" href="../../../_variables/BlogCache.html">$BlogCache</a> = &amp; get_BlogCache();
<a name="l169"><span class="linenum"> 169</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a> = &amp; <a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('BlogCache')" href="../../../_variables/BlogCache.html">$BlogCache</a>-&gt;get_by_ID( <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a> );
<a name="l170"><span class="linenum"> 170</span></a>              }
<a name="l171"><span class="linenum"> 171</span></a>  
<a name="l172"><span class="linenum"> 172</span></a>  <span class="comment">            // Where are we going to redirect to?</span>
<a name="l173"><span class="linenum"> 173</span></a>              <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'redirect_to', 'url', <a class="function" onClick="logFunction('url_add_param')" href="../../../_functions/url_add_param.html" onMouseOver="funcPopup(event,'url_add_param')">url_add_param</a>( <a class="var it346" onMouseOver="hilite(346)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../../_variables/admin_url.html">$admin_url</a>, 'ctrl=items&amp;filter=restore&amp;blog='.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a onClick="logVariable('ID')" class="var it8952" onMouseOver="hilite(8952)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, '&amp;' ) );
<a name="l174"><span class="linenum"> 174</span></a>  
<a name="l175"><span class="linenum"> 175</span></a>  <span class="comment">            // What form buttton has been pressed?</span>
<a name="l176"><span class="linenum"> 176</span></a>              <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'save', 'string', '' );
<a name="l177"><span class="linenum"> 177</span></a>              <a class="var it6477" onMouseOver="hilite(6477)" onMouseOut="lolite()" onClick="logVariable('exit_after_save')" href="../../../_variables/exit_after_save.html">$exit_after_save</a> = ( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> != 'create_edit' );
<a name="l178"><span class="linenum"> 178</span></a>          }
<a name="l179"><span class="linenum"> 179</span></a>          break;
<a name="l180"><span class="linenum"> 180</span></a>  
<a name="l181"><span class="linenum"> 181</span></a>      case 'make_posts_pre':
<a name="l182"><span class="linenum"> 182</span></a>  <span class="comment">        // form for edit several posts</span>
<a name="l183"><span class="linenum"> 183</span></a>  
<a name="l184"><span class="linenum"> 184</span></a>          if( empty( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a> ) )
<a name="l185"><span class="linenum"> 185</span></a>          {
<a name="l186"><span class="linenum"> 186</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('No destination blog is selected.'), 'error' );
<a name="l187"><span class="linenum"> 187</span></a>              break;
<a name="l188"><span class="linenum"> 188</span></a>          }
<a name="l189"><span class="linenum"> 189</span></a>  
<a name="l190"><span class="linenum"> 190</span></a>  <span class="comment">        // Check perms:</span>
<a name="l191"><span class="linenum"> 191</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'blog_post_statuses', 'edit', true, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a onClick="logVariable('ID')" class="var it8952" onMouseOver="hilite(8952)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> );
<a name="l192"><span class="linenum"> 192</span></a>          break;
<a name="l193"><span class="linenum"> 193</span></a>  
<a name="l194"><span class="linenum"> 194</span></a>      case 'make_posts_from_files':
<a name="l195"><span class="linenum"> 195</span></a>  <span class="comment">        // Make posts with selected images:</span>
<a name="l196"><span class="linenum"> 196</span></a>  
<a name="l197"><span class="linenum"> 197</span></a>  <span class="comment">        // Stop a request from the blocked IP addresses or Domains</span>
<a name="l198"><span class="linenum"> 198</span></a>          <a class="function" onClick="logFunction('antispam_block_request')" href="../../../_functions/antispam_block_request.html" onMouseOver="funcPopup(event,'antispam_block_request')">antispam_block_request</a>();
<a name="l199"><span class="linenum"> 199</span></a>  
<a name="l200"><span class="linenum"> 200</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l201"><span class="linenum"> 201</span></a>          <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'file' );
<a name="l202"><span class="linenum"> 202</span></a>  
<a name="l203"><span class="linenum"> 203</span></a>          <a class="var it782" onMouseOver="hilite(782)" onMouseOut="lolite()" onClick="logVariable('FileRootCache')" href="../../../_variables/FileRootCache.html">$FileRootCache</a> = &amp; get_FileRootCache();
<a name="l204"><span class="linenum"> 204</span></a>  <span class="comment">        // getting root</span>
<a name="l205"><span class="linenum"> 205</span></a>          <a class="var it1677" onMouseOver="hilite(1677)" onMouseOut="lolite()" onClick="logVariable('root')" href="../../../_variables/root.html">$root</a> = <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'root' );
<a name="l206"><span class="linenum"> 206</span></a>  
<a name="l207"><span class="linenum"> 207</span></a>          <a class="var it1682" onMouseOver="hilite(1682)" onMouseOut="lolite()" onClick="logVariable('fm_FileRoot')" href="../../../_variables/fm_FileRoot.html">$fm_FileRoot</a> = &amp; <a class="var it782" onMouseOver="hilite(782)" onMouseOut="lolite()" onClick="logVariable('FileRootCache')" href="../../../_variables/FileRootCache.html">$FileRootCache</a>-&gt;get_by_ID( <a class="var it1677" onMouseOver="hilite(1677)" onMouseOut="lolite()" onClick="logVariable('root')" href="../../../_variables/root.html">$root</a>, true );
<a name="l208"><span class="linenum"> 208</span></a>  
<a name="l209"><span class="linenum"> 209</span></a>  <span class="comment">        // fp&gt; TODO: this block should move to a general level</span>
<a name="l210"><span class="linenum"> 210</span></a>  <span class="comment">        // Try to go to the right blog:</span>
<a name="l211"><span class="linenum"> 211</span></a>          if( <a class="var it1682" onMouseOver="hilite(1682)" onMouseOut="lolite()" onClick="logVariable('fm_FileRoot')" href="../../../_variables/fm_FileRoot.html">$fm_FileRoot</a>-&gt;<a onClick="logVariable('type')" class="var it8992" onMouseOver="hilite(8992)" onMouseOut="lolite()" href="../../../_variables/type.html">type</a> == 'collection' )
<a name="l212"><span class="linenum"> 212</span></a>          {
<a name="l213"><span class="linenum"> 213</span></a>              <a class="function" onClick="logFunction('set_working_blog')" href="../../../_functions/set_working_blog.html" onMouseOver="funcPopup(event,'set_working_blog')">set_working_blog</a>( <a class="var it1682" onMouseOver="hilite(1682)" onMouseOut="lolite()" onClick="logVariable('fm_FileRoot')" href="../../../_variables/fm_FileRoot.html">$fm_FileRoot</a>-&gt;<a onClick="logVariable('in_type_ID')" class="var it8992" onMouseOver="hilite(8992)" onMouseOut="lolite()" href="../../../_variables/in_type_ID.html">in_type_ID</a> );
<a name="l214"><span class="linenum"> 214</span></a>  <span class="comment">            // Load the blog we're in:</span>
<a name="l215"><span class="linenum"> 215</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a> = &amp; <a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('BlogCache')" href="../../../_variables/BlogCache.html">$BlogCache</a>-&gt;get_by_ID( <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a> );
<a name="l216"><span class="linenum"> 216</span></a>          }
<a name="l217"><span class="linenum"> 217</span></a>  <span class="comment">        // ---</span>
<a name="l218"><span class="linenum"> 218</span></a>  
<a name="l219"><span class="linenum"> 219</span></a>          if( empty( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a> ) )
<a name="l220"><span class="linenum"> 220</span></a>          {
<a name="l221"><span class="linenum"> 221</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('No destination blog is selected.'), 'error' );
<a name="l222"><span class="linenum"> 222</span></a>              break;
<a name="l223"><span class="linenum"> 223</span></a>          }
<a name="l224"><span class="linenum"> 224</span></a>  
<a name="l225"><span class="linenum"> 225</span></a>  <span class="comment">        // Get status (includes PERM CHECK):</span>
<a name="l226"><span class="linenum"> 226</span></a>          <a class="var it1723" onMouseOver="hilite(1723)" onMouseOut="lolite()" onClick="logVariable('item_status')" href="../../../_variables/item_status.html">$item_status</a> = <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'post_status', 'string', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a class="function" onClick="logFunction('get_allowed_item_status')" href="../../../_functions/get_allowed_item_status.html" onMouseOver="funcPopup(event,'get_allowed_item_status')">get_allowed_item_status</a>() );
<a name="l227"><span class="linenum"> 227</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'blog_post!'.<a class="var it1723" onMouseOver="hilite(1723)" onMouseOut="lolite()" onClick="logVariable('item_status')" href="../../../_variables/item_status.html">$item_status</a>, 'create', true, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a onClick="logVariable('ID')" class="var it8952" onMouseOver="hilite(8952)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> );
<a name="l228"><span class="linenum"> 228</span></a>  
<a name="l229"><span class="linenum"> 229</span></a>          <a class="function" onClick="logFunction('load_class')" href="../../../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( 'files/model/_filelist.class.php', 'FileList' );
<a name="l230"><span class="linenum"> 230</span></a>          <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('selected_Filelist')" href="../../../_variables/selected_Filelist.html">$selected_Filelist</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Filelist')" href="../../../_classes/filelist.html" onMouseOver="classPopup(event,'filelist')">Filelist</a>( <a class="var it1682" onMouseOver="hilite(1682)" onMouseOut="lolite()" onClick="logVariable('fm_FileRoot')" href="../../../_variables/fm_FileRoot.html">$fm_FileRoot</a>, false );
<a name="l231"><span class="linenum"> 231</span></a>          <a class="var it1689" onMouseOver="hilite(1689)" onMouseOut="lolite()" onClick="logVariable('fm_selected')" href="../../../_variables/fm_selected.html">$fm_selected</a> = <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( &quot;fm_selected&quot; , &quot;array&quot; );
<a name="l232"><span class="linenum"> 232</span></a>          foreach( <a class="var it1689" onMouseOver="hilite(1689)" onMouseOut="lolite()" onClick="logVariable('fm_selected')" href="../../../_variables/fm_selected.html">$fm_selected</a> as <a class="var it1690" onMouseOver="hilite(1690)" onMouseOut="lolite()" onClick="logVariable('l_source_path')" href="../../../_variables/l_source_path.html">$l_source_path</a> )
<a name="l233"><span class="linenum"> 233</span></a>          {
<a name="l234"><span class="linenum"> 234</span></a>              <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('selected_Filelist')" href="../../../_variables/selected_Filelist.html">$selected_Filelist</a>-&gt;<a class="function" onClick="logFunction('add_by_subpath')" href="../../../_functions/add_by_subpath.html" onMouseOver="funcPopup(event,'add_by_subpath')">add_by_subpath</a>( <a class="phpfunction" onClick="logFunction('urldecode')" href="../../../_functions/urldecode.html" onMouseOver="phpfuncPopup(event,'urldecode')">urldecode</a>(<a class="var it1690" onMouseOver="hilite(1690)" onMouseOut="lolite()" onClick="logVariable('l_source_path')" href="../../../_variables/l_source_path.html">$l_source_path</a>), true );
<a name="l235"><span class="linenum"> 235</span></a>          }
<a name="l236"><span class="linenum"> 236</span></a>  <span class="comment">        // make sure we have loaded metas for all files in selection!</span>
<a name="l237"><span class="linenum"> 237</span></a>          <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('selected_Filelist')" href="../../../_variables/selected_Filelist.html">$selected_Filelist</a>-&gt;<a class="function" onClick="logFunction('load_meta')" href="../../../_functions/load_meta.html" onMouseOver="funcPopup(event,'load_meta')">load_meta</a>();
<a name="l238"><span class="linenum"> 238</span></a>  
<a name="l239"><span class="linenum"> 239</span></a>  <span class="comment">        // Ready to create post(s):</span>
<a name="l240"><span class="linenum"> 240</span></a>          <a class="function" onClick="logFunction('load_class')" href="../../../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( 'items/model/_item.class.php', 'Item' );
<a name="l241"><span class="linenum"> 241</span></a>  
<a name="l242"><span class="linenum"> 242</span></a>          <a class="var it6478" onMouseOver="hilite(6478)" onMouseOut="lolite()" onClick="logVariable('fileNum')" href="../../../_variables/fileNum.html">$fileNum</a> = 0;
<a name="l243"><span class="linenum"> 243</span></a>          <a class="var it6479" onMouseOver="hilite(6479)" onMouseOut="lolite()" onClick="logVariable('cat_Array')" href="../../../_variables/cat_Array.html">$cat_Array</a> = <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'category', 'array/string' );
<a name="l244"><span class="linenum"> 244</span></a>          <a class="var it6480" onMouseOver="hilite(6480)" onMouseOut="lolite()" onClick="logVariable('title_Array')" href="../../../_variables/title_Array.html">$title_Array</a> = <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'post_title', 'array/string' );
<a name="l245"><span class="linenum"> 245</span></a>          <a class="var it6481" onMouseOver="hilite(6481)" onMouseOut="lolite()" onClick="logVariable('new_categories')" href="../../../_variables/new_categories.html">$new_categories</a> = <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'new_categories', 'array/string', array() );
<a name="l246"><span class="linenum"> 246</span></a>          while( <a class="var it1721" onMouseOver="hilite(1721)" onMouseOut="lolite()" onClick="logVariable('l_File')" href="../../../_variables/l_File.html">$l_File</a> = &amp; <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('selected_Filelist')" href="../../../_variables/selected_Filelist.html">$selected_Filelist</a>-&gt;get_next() )
<a name="l247"><span class="linenum"> 247</span></a>          {
<a name="l248"><span class="linenum"> 248</span></a>  <span class="comment">            // Create a post:</span>
<a name="l249"><span class="linenum"> 249</span></a>              <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Item')" href="../../../_classes/item.html" onMouseOver="classPopup(event,'item')">Item</a>();
<a name="l250"><span class="linenum"> 250</span></a>              <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'status', <a class="var it1723" onMouseOver="hilite(1723)" onMouseOut="lolite()" onClick="logVariable('item_status')" href="../../../_variables/item_status.html">$item_status</a> );
<a name="l251"><span class="linenum"> 251</span></a>  
<a name="l252"><span class="linenum"> 252</span></a>  <span class="comment">            // replacing category if selected at preview screen</span>
<a name="l253"><span class="linenum"> 253</span></a>              if( isset( <a class="var it6479" onMouseOver="hilite(6479)" onMouseOut="lolite()" onClick="logVariable('cat_Array')" href="../../../_variables/cat_Array.html">$cat_Array</a>[ <a class="var it6478" onMouseOver="hilite(6478)" onMouseOut="lolite()" onClick="logVariable('fileNum')" href="../../../_variables/fileNum.html">$fileNum</a> ] ) )
<a name="l254"><span class="linenum"> 254</span></a>              {
<a name="l255"><span class="linenum"> 255</span></a>  <span class="comment">                // checking if selected &quot;same as above&quot; category option</span>
<a name="l256"><span class="linenum"> 256</span></a>                  switch( <a class="var it6479" onMouseOver="hilite(6479)" onMouseOut="lolite()" onClick="logVariable('cat_Array')" href="../../../_variables/cat_Array.html">$cat_Array</a>[ <a class="var it6478" onMouseOver="hilite(6478)" onMouseOut="lolite()" onClick="logVariable('fileNum')" href="../../../_variables/fileNum.html">$fileNum</a> ] )
<a name="l257"><span class="linenum"> 257</span></a>                  {
<a name="l258"><span class="linenum"> 258</span></a>                      case 'same':
<a name="l259"><span class="linenum"> 259</span></a>  <span class="comment">                        // Get a category ID from previous item</span>
<a name="l260"><span class="linenum"> 260</span></a>                          <a class="var it6479" onMouseOver="hilite(6479)" onMouseOut="lolite()" onClick="logVariable('cat_Array')" href="../../../_variables/cat_Array.html">$cat_Array</a>[ <a class="var it6478" onMouseOver="hilite(6478)" onMouseOut="lolite()" onClick="logVariable('fileNum')" href="../../../_variables/fileNum.html">$fileNum</a> ] = <a class="var it6479" onMouseOver="hilite(6479)" onMouseOut="lolite()" onClick="logVariable('cat_Array')" href="../../../_variables/cat_Array.html">$cat_Array</a>[ <a class="var it6478" onMouseOver="hilite(6478)" onMouseOut="lolite()" onClick="logVariable('fileNum')" href="../../../_variables/fileNum.html">$fileNum</a> - 1 ];
<a name="l261"><span class="linenum"> 261</span></a>                          break;
<a name="l262"><span class="linenum"> 262</span></a>  
<a name="l263"><span class="linenum"> 263</span></a>                      case 'new':
<a name="l264"><span class="linenum"> 264</span></a>  <span class="comment">                        // Create a new category from an entered name</span>
<a name="l265"><span class="linenum"> 265</span></a>  
<a name="l266"><span class="linenum"> 266</span></a>  <span class="comment">                        // Check permissions:</span>
<a name="l267"><span class="linenum"> 267</span></a>                          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'blog_cats', '', true, <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a> );
<a name="l268"><span class="linenum"> 268</span></a>  
<a name="l269"><span class="linenum"> 269</span></a>                          <a class="var it4909" onMouseOver="hilite(4909)" onMouseOut="lolite()" onClick="logVariable('GenericCategoryCache')" href="../../../_variables/GenericCategoryCache.html">$GenericCategoryCache</a> = &amp; get_ChapterCache();
<a name="l270"><span class="linenum"> 270</span></a>                          <a class="var it6482" onMouseOver="hilite(6482)" onMouseOut="lolite()" onClick="logVariable('new_GenericCategory')" href="../../../_variables/new_GenericCategory.html">$new_GenericCategory</a> = &amp; <a class="var it4909" onMouseOver="hilite(4909)" onMouseOut="lolite()" onClick="logVariable('GenericCategoryCache')" href="../../../_variables/GenericCategoryCache.html">$GenericCategoryCache</a>-&gt;new_obj( NULL, <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a> );    <span class="comment">// create new category object</span>
<a name="l271"><span class="linenum"> 271</span></a>                          <a class="var it6482" onMouseOver="hilite(6482)" onMouseOut="lolite()" onClick="logVariable('new_GenericCategory')" href="../../../_variables/new_GenericCategory.html">$new_GenericCategory</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'name', <a class="var it6481" onMouseOver="hilite(6481)" onMouseOut="lolite()" onClick="logVariable('new_categories')" href="../../../_variables/new_categories.html">$new_categories</a>[ <a class="var it6478" onMouseOver="hilite(6478)" onMouseOut="lolite()" onClick="logVariable('fileNum')" href="../../../_variables/fileNum.html">$fileNum</a> ] );
<a name="l272"><span class="linenum"> 272</span></a>                          if( <a class="var it6482" onMouseOver="hilite(6482)" onMouseOut="lolite()" onClick="logVariable('new_GenericCategory')" href="../../../_variables/new_GenericCategory.html">$new_GenericCategory</a>-&gt;<a class="function" onClick="logFunction('dbinsert')" href="../../../_functions/dbinsert.html" onMouseOver="funcPopup(event,'dbinsert')">dbinsert</a>() !== false )
<a name="l273"><span class="linenum"> 273</span></a>                          { // Category is created successfully
<a name="l274"><span class="linenum"> 274</span></a>                              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('New category %s created.'), '&lt;b&gt;'.<a class="var it6481" onMouseOver="hilite(6481)" onMouseOut="lolite()" onClick="logVariable('new_categories')" href="../../../_variables/new_categories.html">$new_categories</a>[ <a class="var it6478" onMouseOver="hilite(6478)" onMouseOut="lolite()" onClick="logVariable('fileNum')" href="../../../_variables/fileNum.html">$fileNum</a> ].'&lt;/b&gt;' ), 'success' );
<a name="l275"><span class="linenum"> 275</span></a>                              <a class="var it4909" onMouseOver="hilite(4909)" onMouseOut="lolite()" onClick="logVariable('GenericCategoryCache')" href="../../../_variables/GenericCategoryCache.html">$GenericCategoryCache</a>-&gt;<a class="function" onClick="logFunction('clear')" href="../../../_functions/clear.html" onMouseOver="funcPopup(event,'clear')">clear</a>();
<a name="l276"><span class="linenum"> 276</span></a>                          }
<a name="l277"><span class="linenum"> 277</span></a>                          else
<a name="l278"><span class="linenum"> 278</span></a>                          { // Error on creating new category
<a name="l279"><span class="linenum"> 279</span></a>                              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('New category %s creation failed.'), '&lt;b&gt;'.<a class="var it6481" onMouseOver="hilite(6481)" onMouseOut="lolite()" onClick="logVariable('new_categories')" href="../../../_variables/new_categories.html">$new_categories</a>[ <a class="var it6478" onMouseOver="hilite(6478)" onMouseOut="lolite()" onClick="logVariable('fileNum')" href="../../../_variables/fileNum.html">$fileNum</a> ].'&lt;/b&gt;' ), 'error' );
<a name="l280"><span class="linenum"> 280</span></a>                              continue; <span class="comment">// Skip this post</span>
<a name="l281"><span class="linenum"> 281</span></a>                          }
<a name="l282"><span class="linenum"> 282</span></a>                          <a class="var it6479" onMouseOver="hilite(6479)" onMouseOut="lolite()" onClick="logVariable('cat_Array')" href="../../../_variables/cat_Array.html">$cat_Array</a>[ <a class="var it6478" onMouseOver="hilite(6478)" onMouseOut="lolite()" onClick="logVariable('fileNum')" href="../../../_variables/fileNum.html">$fileNum</a> ] = <a class="var it6482" onMouseOver="hilite(6482)" onMouseOut="lolite()" onClick="logVariable('new_GenericCategory')" href="../../../_variables/new_GenericCategory.html">$new_GenericCategory</a>-&gt;<a onClick="logVariable('ID')" class="var it9189" onMouseOver="hilite(9189)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>;
<a name="l283"><span class="linenum"> 283</span></a>                          break;
<a name="l284"><span class="linenum"> 284</span></a>                  }
<a name="l285"><span class="linenum"> 285</span></a>                  <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'main_cat_ID', <a class="phpfunction" onClick="logFunction('intval')" href="../../../_functions/intval.html" onMouseOver="phpfuncPopup(event,'intval')">intval</a>( <a class="var it6479" onMouseOver="hilite(6479)" onMouseOut="lolite()" onClick="logVariable('cat_Array')" href="../../../_variables/cat_Array.html">$cat_Array</a>[ <a class="var it6478" onMouseOver="hilite(6478)" onMouseOut="lolite()" onClick="logVariable('fileNum')" href="../../../_variables/fileNum.html">$fileNum</a> ] ) );
<a name="l286"><span class="linenum"> 286</span></a>              }
<a name="l287"><span class="linenum"> 287</span></a>              else
<a name="l288"><span class="linenum"> 288</span></a>              { // Use default category ID if it was not selected on the form
<a name="l289"><span class="linenum"> 289</span></a>                  <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'main_cat_ID', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a class="function" onClick="logFunction('get_default_cat_ID')" href="../../../_functions/get_default_cat_id.html" onMouseOver="funcPopup(event,'get_default_cat_id')">get_default_cat_ID</a>() );
<a name="l290"><span class="linenum"> 290</span></a>              }
<a name="l291"><span class="linenum"> 291</span></a>  
<a name="l292"><span class="linenum"> 292</span></a>              <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> = <a class="var it1721" onMouseOver="hilite(1721)" onMouseOut="lolite()" onClick="logVariable('l_File')" href="../../../_variables/l_File.html">$l_File</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>('title');
<a name="l293"><span class="linenum"> 293</span></a>              if( empty( <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> ) )
<a name="l294"><span class="linenum"> 294</span></a>              {
<a name="l295"><span class="linenum"> 295</span></a>                  <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> = <a class="var it1721" onMouseOver="hilite(1721)" onMouseOut="lolite()" onClick="logVariable('l_File')" href="../../../_variables/l_File.html">$l_File</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>('name');
<a name="l296"><span class="linenum"> 296</span></a>              }
<a name="l297"><span class="linenum"> 297</span></a>  
<a name="l298"><span class="linenum"> 298</span></a>              <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'title', <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> );
<a name="l299"><span class="linenum"> 299</span></a>  
<a name="l300"><span class="linenum"> 300</span></a>  <span class="comment">            // replacing category if selected at preview screen</span>
<a name="l301"><span class="linenum"> 301</span></a>              if( isset( <a class="var it6480" onMouseOver="hilite(6480)" onMouseOut="lolite()" onClick="logVariable('title_Array')" href="../../../_variables/title_Array.html">$title_Array</a>[ <a class="var it6478" onMouseOver="hilite(6478)" onMouseOut="lolite()" onClick="logVariable('fileNum')" href="../../../_variables/fileNum.html">$fileNum</a> ] ) ) {
<a name="l302"><span class="linenum"> 302</span></a>                  <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'title', <a class="var it6480" onMouseOver="hilite(6480)" onMouseOut="lolite()" onClick="logVariable('title_Array')" href="../../../_variables/title_Array.html">$title_Array</a>[ <a class="var it6478" onMouseOver="hilite(6478)" onMouseOut="lolite()" onClick="logVariable('fileNum')" href="../../../_variables/fileNum.html">$fileNum</a> ] );
<a name="l303"><span class="linenum"> 303</span></a>              }
<a name="l304"><span class="linenum"> 304</span></a>  
<a name="l305"><span class="linenum"> 305</span></a>              <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('begin')" href="../../../_functions/begin.html" onMouseOver="funcPopup(event,'begin')">begin</a>( 'SERIALIZABLE' );
<a name="l306"><span class="linenum"> 306</span></a>  <span class="comment">            // INSERT NEW POST INTO DB:</span>
<a name="l307"><span class="linenum"> 307</span></a>              if( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('dbinsert')" href="../../../_functions/dbinsert.html" onMouseOver="funcPopup(event,'dbinsert')">dbinsert</a>() )
<a name="l308"><span class="linenum"> 308</span></a>              {
<a name="l309"><span class="linenum"> 309</span></a>  <span class="comment">                // echo '&lt;br&gt;file meta: '.$l_File-&gt;meta;</span>
<a name="l310"><span class="linenum"> 310</span></a>                  if( <a class="var it1721" onMouseOver="hilite(1721)" onMouseOut="lolite()" onClick="logVariable('l_File')" href="../../../_variables/l_File.html">$l_File</a>-&gt;<a onClick="logVariable('meta')" class="var it9041" onMouseOver="hilite(9041)" onMouseOut="lolite()" href="../../../_variables/meta.html">meta</a> == 'notfound' )
<a name="l311"><span class="linenum"> 311</span></a>                  { // That file has no meta data yet, create it now!
<a name="l312"><span class="linenum"> 312</span></a>                      <a class="var it1721" onMouseOver="hilite(1721)" onMouseOut="lolite()" onClick="logVariable('l_File')" href="../../../_variables/l_File.html">$l_File</a>-&gt;<a class="function" onClick="logFunction('dbsave')" href="../../../_functions/dbsave.html" onMouseOver="funcPopup(event,'dbsave')">dbsave</a>();
<a name="l313"><span class="linenum"> 313</span></a>                  }
<a name="l314"><span class="linenum"> 314</span></a>  
<a name="l315"><span class="linenum"> 315</span></a>  <span class="comment">                // Let's make the link!</span>
<a name="l316"><span class="linenum"> 316</span></a>                  <a class="var it1691" onMouseOver="hilite(1691)" onMouseOut="lolite()" onClick="logVariable('edited_Link')" href="../../../_variables/edited_Link.html">$edited_Link</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Link')" href="../../../_classes/link.html" onMouseOver="classPopup(event,'link')">Link</a>();
<a name="l317"><span class="linenum"> 317</span></a>                  <a class="var it1691" onMouseOver="hilite(1691)" onMouseOut="lolite()" onClick="logVariable('edited_Link')" href="../../../_variables/edited_Link.html">$edited_Link</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'itm_ID', <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> );
<a name="l318"><span class="linenum"> 318</span></a>                  <a class="var it1691" onMouseOver="hilite(1691)" onMouseOut="lolite()" onClick="logVariable('edited_Link')" href="../../../_variables/edited_Link.html">$edited_Link</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'file_ID', <a class="var it1721" onMouseOver="hilite(1721)" onMouseOut="lolite()" onClick="logVariable('l_File')" href="../../../_variables/l_File.html">$l_File</a>-&gt;<a onClick="logVariable('ID')" class="var it9041" onMouseOver="hilite(9041)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> );
<a name="l319"><span class="linenum"> 319</span></a>                  <a class="var it1691" onMouseOver="hilite(1691)" onMouseOut="lolite()" onClick="logVariable('edited_Link')" href="../../../_variables/edited_Link.html">$edited_Link</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'position', 'teaser' );
<a name="l320"><span class="linenum"> 320</span></a>                  <a class="var it1691" onMouseOver="hilite(1691)" onMouseOut="lolite()" onClick="logVariable('edited_Link')" href="../../../_variables/edited_Link.html">$edited_Link</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'order', 1 );
<a name="l321"><span class="linenum"> 321</span></a>                  <a class="var it1691" onMouseOver="hilite(1691)" onMouseOut="lolite()" onClick="logVariable('edited_Link')" href="../../../_variables/edited_Link.html">$edited_Link</a>-&gt;<a class="function" onClick="logFunction('dbinsert')" href="../../../_functions/dbinsert.html" onMouseOver="funcPopup(event,'dbinsert')">dbinsert</a>();
<a name="l322"><span class="linenum"> 322</span></a>  
<a name="l323"><span class="linenum"> 323</span></a>                  <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('commit')" href="../../../_functions/commit.html" onMouseOver="funcPopup(event,'commit')">commit</a>();
<a name="l324"><span class="linenum"> 324</span></a>  
<a name="l325"><span class="linenum"> 325</span></a>  <span class="comment">                // Invalidate blog's media BlockCache</span>
<a name="l326"><span class="linenum"> 326</span></a>                  <a class="class" onClick="logClass('BlockCache')" href="../../../_classes/blockcache.html" onMouseOver="classPopup(event,'blockcache')">BlockCache</a>::<a class="function" onClick="logFunction('invalidate_key')" href="../../../_functions/invalidate_key.html" onMouseOver="funcPopup(event,'invalidate_key')">invalidate_key</a>( 'media_coll_ID', <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('get_blog_ID')" href="../../../_functions/get_blog_id.html" onMouseOver="funcPopup(event,'get_blog_id')">get_blog_ID</a>() );
<a name="l327"><span class="linenum"> 327</span></a>  
<a name="l328"><span class="linenum"> 328</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('&amp;laquo;%s&amp;raquo; has been posted.'), <a class="var it1721" onMouseOver="hilite(1721)" onMouseOut="lolite()" onClick="logVariable('l_File')" href="../../../_variables/l_File.html">$l_File</a>-&gt;<a class="function" onClick="logFunction('dget')" href="../../../_functions/dget.html" onMouseOver="funcPopup(event,'dget')">dget</a>('name') ), 'success' );
<a name="l329"><span class="linenum"> 329</span></a>                  <a class="var it6478" onMouseOver="hilite(6478)" onMouseOut="lolite()" onClick="logVariable('fileNum')" href="../../../_variables/fileNum.html">$fileNum</a>++;
<a name="l330"><span class="linenum"> 330</span></a>              }
<a name="l331"><span class="linenum"> 331</span></a>              else
<a name="l332"><span class="linenum"> 332</span></a>              {
<a name="l333"><span class="linenum"> 333</span></a>                  <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('rollback')" href="../../../_functions/rollback.html" onMouseOver="funcPopup(event,'rollback')">rollback</a>();
<a name="l334"><span class="linenum"> 334</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('&amp;laquo;%s&amp;raquo; couldn\'t be posted.'), <a class="var it1721" onMouseOver="hilite(1721)" onMouseOut="lolite()" onClick="logVariable('l_File')" href="../../../_variables/l_File.html">$l_File</a>-&gt;<a class="function" onClick="logFunction('dget')" href="../../../_functions/dget.html" onMouseOver="funcPopup(event,'dget')">dget</a>('name') ), 'error' );
<a name="l335"><span class="linenum"> 335</span></a>              }
<a name="l336"><span class="linenum"> 336</span></a>          }
<a name="l337"><span class="linenum"> 337</span></a>  
<a name="l338"><span class="linenum"> 338</span></a>  <span class="comment">        // Note: we redirect without restoring filter. This should allow to see the new files.</span>
<a name="l339"><span class="linenum"> 339</span></a>  <span class="comment">        // &amp;filter=restore</span>
<a name="l340"><span class="linenum"> 340</span></a>          <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( <a class="var it230" onMouseOver="hilite(230)" onMouseOut="lolite()" onClick="logVariable('dispatcher')" href="../../../_variables/dispatcher.html">$dispatcher</a>.'?ctrl=items&amp;blog='.<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a> );    <span class="comment">// Will save $Messages</span>
<a name="l341"><span class="linenum"> 341</span></a>  
<a name="l342"><span class="linenum"> 342</span></a>  <span class="comment">        // Note: we should have EXITED here. In case we don't (error, or sth...)</span>
<a name="l343"><span class="linenum"> 343</span></a>  
<a name="l344"><span class="linenum"> 344</span></a>  <span class="comment">        // Reset stuff so it doesn't interfere with upcomming display</span>
<a name="l345"><span class="linenum"> 345</span></a>          unset( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> );
<a name="l346"><span class="linenum"> 346</span></a>          unset( <a class="var it1691" onMouseOver="hilite(1691)" onMouseOut="lolite()" onClick="logVariable('edited_Link')" href="../../../_variables/edited_Link.html">$edited_Link</a> );
<a name="l347"><span class="linenum"> 347</span></a>          <a class="var it646" onMouseOver="hilite(646)" onMouseOut="lolite()" onClick="logVariable('selected_Filelist')" href="../../../_variables/selected_Filelist.html">$selected_Filelist</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Filelist')" href="../../../_classes/filelist.html" onMouseOver="classPopup(event,'filelist')">Filelist</a>( <a class="var it1702" onMouseOver="hilite(1702)" onMouseOut="lolite()" onClick="logVariable('fm_Filelist')" href="../../../_variables/fm_Filelist.html">$fm_Filelist</a>-&gt;get_FileRoot(), false );
<a name="l348"><span class="linenum"> 348</span></a>          break;
<a name="l349"><span class="linenum"> 349</span></a>  
<a name="l350"><span class="linenum"> 350</span></a>  
<a name="l351"><span class="linenum"> 351</span></a>      default:
<a name="l352"><span class="linenum"> 352</span></a>          <a class="function" onClick="logFunction('debug_die')" href="../../../_functions/debug_die.html" onMouseOver="funcPopup(event,'debug_die')">debug_die</a>( 'unhandled action 1:'.<a class="function" onClick="logFunction('evo_htmlspecialchars')" href="../../../_functions/evo_htmlspecialchars.html" onMouseOver="funcPopup(event,'evo_htmlspecialchars')">evo_htmlspecialchars</a>(<a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a>) );
<a name="l353"><span class="linenum"> 353</span></a>  }
<a name="l354"><span class="linenum"> 354</span></a>  
<a name="l355"><span class="linenum"> 355</span></a>  <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_init')" href="../../../_functions/breadcrumbpath_init.html" onMouseOver="funcPopup(event,'breadcrumbpath_init')">breadcrumbpath_init</a>( true, array( 'text' =&gt; <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Contents'), 'url' =&gt; '?ctrl=items&amp;amp;blog=<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a>$&amp;amp;tab=full&amp;amp;filter=restore' ) );
<a name="l356"><span class="linenum"> 356</span></a>  
<a name="l357"><span class="linenum"> 357</span></a>  <span class="comment">/**</span>
<a name="l358"><span class="linenum"> 358</span></a>  <span class="comment"> * Perform action:</span>
<a name="l359"><span class="linenum"> 359</span></a>  <span class="comment"> */</span>
<a name="l360"><span class="linenum"> 360</span></a>  switch( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> )
<a name="l361"><span class="linenum"> 361</span></a>  {
<a name="l362"><span class="linenum"> 362</span></a>      case 'nil':
<a name="l363"><span class="linenum"> 363</span></a>  <span class="comment">        // Do nothing</span>
<a name="l364"><span class="linenum"> 364</span></a>          break;
<a name="l365"><span class="linenum"> 365</span></a>  
<a name="l366"><span class="linenum"> 366</span></a>      case 'new':
<a name="l367"><span class="linenum"> 367</span></a>      case 'new_mass':
<a name="l368"><span class="linenum"> 368</span></a>  <span class="comment">        // $set_issue_date = 'now';</span>
<a name="l369"><span class="linenum"> 369</span></a>          <a class="var it33" onMouseOver="hilite(33)" onMouseOut="lolite()" onClick="logVariable('item_issue_date')" href="../../../_variables/item_issue_date.html">$item_issue_date</a> = <a class="function" onClick="logFunction('date_i18n')" href="../../../_functions/date_i18n.html" onMouseOver="funcPopup(event,'date_i18n')">date_i18n</a>( <a class="function" onClick="logFunction('locale_datefmt')" href="../../../_functions/locale_datefmt.html" onMouseOver="funcPopup(event,'locale_datefmt')">locale_datefmt</a>(), <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('localtimenow')" href="../../../_variables/localtimenow.html">$localtimenow</a> );
<a name="l370"><span class="linenum"> 370</span></a>          <a class="var it6483" onMouseOver="hilite(6483)" onMouseOut="lolite()" onClick="logVariable('item_issue_time')" href="../../../_variables/item_issue_time.html">$item_issue_time</a> = <a class="phpfunction" onClick="logFunction('date')" href="../../../_functions/date.html" onMouseOver="phpfuncPopup(event,'date')">date</a>( 'H:i:s', <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('localtimenow')" href="../../../_variables/localtimenow.html">$localtimenow</a> );
<a name="l371"><span class="linenum"> 371</span></a>  <span class="comment">        // pre_dump( $item_issue_date, $item_issue_time );</span>
<a name="l372"><span class="linenum"> 372</span></a>      case 'new_switchtab': // this gets set as action by JS, when we switch tabs
<a name="l373"><span class="linenum"> 373</span></a>  <span class="comment">        // New post form  (can be a bookmarklet form if mode == bookmarklet )</span>
<a name="l374"><span class="linenum"> 374</span></a>  
<a name="l375"><span class="linenum"> 375</span></a>  <span class="comment">        // We don't check the following earlier, because we want the blog switching buttons to be available:</span>
<a name="l376"><span class="linenum"> 376</span></a>          if( ! <a class="function" onClick="logFunction('blog_has_cats')" href="../../../_functions/blog_has_cats.html" onMouseOver="funcPopup(event,'blog_has_cats')">blog_has_cats</a>( <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a> ) )
<a name="l377"><span class="linenum"> 377</span></a>          {
<a name="l378"><span class="linenum"> 378</span></a>              break;
<a name="l379"><span class="linenum"> 379</span></a>          }
<a name="l380"><span class="linenum"> 380</span></a>  
<a name="l381"><span class="linenum"> 381</span></a>          <a class="function" onClick="logFunction('load_class')" href="../../../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( 'items/model/_item.class.php', 'Item' );
<a name="l382"><span class="linenum"> 382</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Item')" href="../../../_classes/item.html" onMouseOver="classPopup(event,'item')">Item</a>();
<a name="l383"><span class="linenum"> 383</span></a>  
<a name="l384"><span class="linenum"> 384</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>('main_cat_ID', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a class="function" onClick="logFunction('get_default_cat_ID')" href="../../../_functions/get_default_cat_id.html" onMouseOver="funcPopup(event,'get_default_cat_id')">get_default_cat_ID</a>());
<a name="l385"><span class="linenum"> 385</span></a>  
<a name="l386"><span class="linenum"> 386</span></a>  <span class="comment">        // We use the request variables to fill the edit form, because we need to be able to pass those values</span>
<a name="l387"><span class="linenum"> 387</span></a>  <span class="comment">        // from tab to tab via javascript when the editor wants to switch views...</span>
<a name="l388"><span class="linenum"> 388</span></a>  <span class="comment">        // Also used by bookmarklet</span>
<a name="l389"><span class="linenum"> 389</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('load_from_Request')" href="../../../_functions/load_from_request.html" onMouseOver="funcPopup(event,'load_from_request')">load_from_Request</a>( true ); <span class="comment">// needs Blog set</span>
<a name="l390"><span class="linenum"> 390</span></a>  
<a name="l391"><span class="linenum"> 391</span></a>  <span class="comment">        // Set default locations from current user</span>
<a name="l392"><span class="linenum"> 392</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set_creator_location')" href="../../../_functions/set_creator_location.html" onMouseOver="funcPopup(event,'set_creator_location')">set_creator_location</a>( 'country' );
<a name="l393"><span class="linenum"> 393</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set_creator_location')" href="../../../_functions/set_creator_location.html" onMouseOver="funcPopup(event,'set_creator_location')">set_creator_location</a>( 'region' );
<a name="l394"><span class="linenum"> 394</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set_creator_location')" href="../../../_functions/set_creator_location.html" onMouseOver="funcPopup(event,'set_creator_location')">set_creator_location</a>( 'subregion' );
<a name="l395"><span class="linenum"> 395</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set_creator_location')" href="../../../_functions/set_creator_location.html" onMouseOver="funcPopup(event,'set_creator_location')">set_creator_location</a>( 'city' );
<a name="l396"><span class="linenum"> 396</span></a>  
<a name="l397"><span class="linenum"> 397</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('status')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/status.html">status</a> = <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'post_status', 'string', NULL );        <span class="comment">// 'published' or 'draft' or ...</span>
<a name="l398"><span class="linenum"> 398</span></a>  <span class="comment">        // We know we can use at least one status,</span>
<a name="l399"><span class="linenum"> 399</span></a>  <span class="comment">        // but we need to make sure the requested/default one is ok:</span>
<a name="l400"><span class="linenum"> 400</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('status')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/status.html">status</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a onClick="logVariable('get_allowed_item_status')" class="var it8952" onMouseOver="hilite(8952)" onMouseOut="lolite()" href="../../../_variables/get_allowed_item_status.html">get_allowed_item_status</a> ( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('status')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/status.html">status</a> );
<a name="l401"><span class="linenum"> 401</span></a>  
<a name="l402"><span class="linenum"> 402</span></a>  <span class="comment">        // Check if new category was started to create. If yes then set up parameters for next page</span>
<a name="l403"><span class="linenum"> 403</span></a>          <a class="function" onClick="logFunction('check_categories_nosave')" href="../../../_functions/check_categories_nosave.html" onMouseOver="funcPopup(event,'check_categories_nosave')">check_categories_nosave</a> ( <a class="var it28" onMouseOver="hilite(28)" onMouseOut="lolite()" onClick="logVariable('post_category')" href="../../../_variables/post_category.html">$post_category</a>, <a class="var it29" onMouseOver="hilite(29)" onMouseOut="lolite()" onClick="logVariable('post_extracats')" href="../../../_variables/post_extracats.html">$post_extracats</a> );
<a name="l404"><span class="linenum"> 404</span></a>  
<a name="l405"><span class="linenum"> 405</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('set')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/set.html">set</a> ( 'main_cat_ID', <a class="var it28" onMouseOver="hilite(28)" onMouseOut="lolite()" onClick="logVariable('post_category')" href="../../../_variables/post_category.html">$post_category</a> );
<a name="l406"><span class="linenum"> 406</span></a>          if( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('main_cat_ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/main_cat_ID.html">main_cat_ID</a> &amp;&amp; ( <a class="function" onClick="logFunction('get_allow_cross_posting')" href="../../../_functions/get_allow_cross_posting.html" onMouseOver="funcPopup(event,'get_allow_cross_posting')">get_allow_cross_posting</a>() &lt; 2 ) &amp;&amp; <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('get_blog_ID')" href="../../../_functions/get_blog_id.html" onMouseOver="funcPopup(event,'get_blog_id')">get_blog_ID</a>() != <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a> )
<a name="l407"><span class="linenum"> 407</span></a>          { // the main cat is not in the list of categories; this happens, if the user switches blogs during editing:
<a name="l408"><span class="linenum"> 408</span></a>              <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>('main_cat_ID', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a class="function" onClick="logFunction('get_default_cat_ID')" href="../../../_functions/get_default_cat_id.html" onMouseOver="funcPopup(event,'get_default_cat_id')">get_default_cat_ID</a>());
<a name="l409"><span class="linenum"> 409</span></a>          }
<a name="l410"><span class="linenum"> 410</span></a>          <a class="var it29" onMouseOver="hilite(29)" onMouseOut="lolite()" onClick="logVariable('post_extracats')" href="../../../_variables/post_extracats.html">$post_extracats</a> = <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'post_extracats', 'array/integer', <a class="var it29" onMouseOver="hilite(29)" onMouseOut="lolite()" onClick="logVariable('post_extracats')" href="../../../_variables/post_extracats.html">$post_extracats</a> );
<a name="l411"><span class="linenum"> 411</span></a>  
<a name="l412"><span class="linenum"> 412</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'item_tags', 'string', '' );
<a name="l413"><span class="linenum"> 413</span></a>  
<a name="l414"><span class="linenum"> 414</span></a>  <span class="comment">        // Trackback addresses (never saved into item)</span>
<a name="l415"><span class="linenum"> 415</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'trackback_url', 'string', '' );
<a name="l416"><span class="linenum"> 416</span></a>  
<a name="l417"><span class="linenum"> 417</span></a>  <span class="comment">        // Page title:</span>
<a name="l418"><span class="linenum"> 418</span></a>          switch( <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'item_typ_ID', 'integer', 1 ) )
<a name="l419"><span class="linenum"> 419</span></a>          {
<a name="l420"><span class="linenum"> 420</span></a>              case 1000:
<a name="l421"><span class="linenum"> 421</span></a>                  <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('New page');
<a name="l422"><span class="linenum"> 422</span></a>                  break;
<a name="l423"><span class="linenum"> 423</span></a>  
<a name="l424"><span class="linenum"> 424</span></a>              case 1600:
<a name="l425"><span class="linenum"> 425</span></a>                  <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('New intro');
<a name="l426"><span class="linenum"> 426</span></a>                  break;
<a name="l427"><span class="linenum"> 427</span></a>  
<a name="l428"><span class="linenum"> 428</span></a>              case 2000:
<a name="l429"><span class="linenum"> 429</span></a>                  <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('New podcast episode');
<a name="l430"><span class="linenum"> 430</span></a>                  break;
<a name="l431"><span class="linenum"> 431</span></a>  
<a name="l432"><span class="linenum"> 432</span></a>              case 3000:
<a name="l433"><span class="linenum"> 433</span></a>                  <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('<span class="keyword">New </span><a class="class" onClick="logClass('link')" href="../../../_classes/link.html" onMouseOver="classPopup(event,'link')">link</a>');
<a name="l434"><span class="linenum"> 434</span></a>                  break;
<a name="l435"><span class="linenum"> 435</span></a>  
<a name="l436"><span class="linenum"> 436</span></a>              case 4000:
<a name="l437"><span class="linenum"> 437</span></a>                  <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('New advertisement');
<a name="l438"><span class="linenum"> 438</span></a>                  break;
<a name="l439"><span class="linenum"> 439</span></a>  
<a name="l440"><span class="linenum"> 440</span></a>              default:
<a name="l441"><span class="linenum"> 441</span></a>                  <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('New post');
<a name="l442"><span class="linenum"> 442</span></a>                  break;
<a name="l443"><span class="linenum"> 443</span></a>          }
<a name="l444"><span class="linenum"> 444</span></a>  
<a name="l445"><span class="linenum"> 445</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a>, '?ctrl=items&amp;amp;action=new&amp;amp;blog='.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a onClick="logVariable('ID')" class="var it8952" onMouseOver="hilite(8952)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>.'&amp;amp;item_typ_ID='.<a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('item_typ_ID')" href="../../../_variables/item_typ_ID.html">$item_typ_ID</a> );
<a name="l446"><span class="linenum"> 446</span></a>  
<a name="l447"><span class="linenum"> 447</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a onClick="logVariable('title_titlearea')" class="var it8956" onMouseOver="hilite(8956)" onMouseOut="lolite()" href="../../../_variables/title_titlearea.html">title_titlearea</a> = <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a>.': ';;
<a name="l448"><span class="linenum"> 448</span></a>  
<a name="l449"><span class="linenum"> 449</span></a>  <span class="comment">        // Params we need for tab switching:</span>
<a name="l450"><span class="linenum"> 450</span></a>          <a class="var it6485" onMouseOver="hilite(6485)" onMouseOut="lolite()" onClick="logVariable('tab_switch_params')" href="../../../_variables/tab_switch_params.html">$tab_switch_params</a> = 'blog='.<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a>;
<a name="l451"><span class="linenum"> 451</span></a>          break;
<a name="l452"><span class="linenum"> 452</span></a>  
<a name="l453"><span class="linenum"> 453</span></a>  
<a name="l454"><span class="linenum"> 454</span></a>      case 'copy': // Duplicate post
<a name="l455"><span class="linenum"> 455</span></a>          <a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('item_ID')" href="../../../_variables/item_ID.html">$item_ID</a> = <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'p', 'integer', true );
<a name="l456"><span class="linenum"> 456</span></a>          <a class="var it99" onMouseOver="hilite(99)" onMouseOut="lolite()" onClick="logVariable('ItemCache')" href="../../../_variables/ItemCache.html">$ItemCache</a> = &amp;get_ItemCache();
<a name="l457"><span class="linenum"> 457</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> = &amp; <a class="var it99" onMouseOver="hilite(99)" onMouseOut="lolite()" onClick="logVariable('ItemCache')" href="../../../_variables/ItemCache.html">$ItemCache</a>-&gt;get_by_ID( <a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('item_ID')" href="../../../_variables/item_ID.html">$item_ID</a> );
<a name="l458"><span class="linenum"> 458</span></a>  
<a name="l459"><span class="linenum"> 459</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('load_Blog')" href="../../../_functions/load_blog.html" onMouseOver="funcPopup(event,'load_blog')">load_Blog</a>();
<a name="l460"><span class="linenum"> 460</span></a>          <a class="var it1723" onMouseOver="hilite(1723)" onMouseOut="lolite()" onClick="logVariable('item_status')" href="../../../_variables/item_status.html">$item_status</a> = <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('Blog')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/Blog.html">Blog</a>-&gt;<a class="function" onClick="logFunction('get_allowed_item_status')" href="../../../_functions/get_allowed_item_status.html" onMouseOver="funcPopup(event,'get_allowed_item_status')">get_allowed_item_status</a>();
<a name="l461"><span class="linenum"> 461</span></a>  
<a name="l462"><span class="linenum"> 462</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'status', <a class="var it1723" onMouseOver="hilite(1723)" onMouseOut="lolite()" onClick="logVariable('item_status')" href="../../../_variables/item_status.html">$item_status</a> );
<a name="l463"><span class="linenum"> 463</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'dateset', 0 );    <span class="comment">// Date not explicitly set yet</span>
<a name="l464"><span class="linenum"> 464</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'issue_date', <a class="phpfunction" onClick="logFunction('date')" href="../../../_functions/date.html" onMouseOver="phpfuncPopup(event,'date')">date</a>( 'Y-m-d H:i:s', <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('localtimenow')" href="../../../_variables/localtimenow.html">$localtimenow</a> ) );
<a name="l465"><span class="linenum"> 465</span></a>  
<a name="l466"><span class="linenum"> 466</span></a>  <span class="comment">        // Set post comment status and extracats</span>
<a name="l467"><span class="linenum"> 467</span></a>          <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('post_comment_status')" href="../../../_variables/post_comment_status.html">$post_comment_status</a> = <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>( 'comment_status' );
<a name="l468"><span class="linenum"> 468</span></a>          <a class="var it29" onMouseOver="hilite(29)" onMouseOut="lolite()" onClick="logVariable('post_extracats')" href="../../../_variables/post_extracats.html">$post_extracats</a> = <a class="function" onClick="logFunction('postcats_get_byID')" href="../../../_functions/postcats_get_byid.html" onMouseOver="funcPopup(event,'postcats_get_byid')">postcats_get_byID</a>( <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('p')" href="../../../_variables/p.html">$p</a> );
<a name="l469"><span class="linenum"> 469</span></a>  
<a name="l470"><span class="linenum"> 470</span></a>  <span class="comment">        // Check if new category was started to create. If yes then set up parameters for next page</span>
<a name="l471"><span class="linenum"> 471</span></a>          <a class="function" onClick="logFunction('check_categories_nosave')" href="../../../_functions/check_categories_nosave.html" onMouseOver="funcPopup(event,'check_categories_nosave')">check_categories_nosave</a> ( <a class="var it28" onMouseOver="hilite(28)" onMouseOut="lolite()" onClick="logVariable('post_category')" href="../../../_variables/post_category.html">$post_category</a>, <a class="var it29" onMouseOver="hilite(29)" onMouseOut="lolite()" onClick="logVariable('post_extracats')" href="../../../_variables/post_extracats.html">$post_extracats</a> );
<a name="l472"><span class="linenum"> 472</span></a>  
<a name="l473"><span class="linenum"> 473</span></a>  <span class="comment">        // Page title:</span>
<a name="l474"><span class="linenum"> 474</span></a>          switch( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ptyp_ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ptyp_ID.html">ptyp_ID</a> )
<a name="l475"><span class="linenum"> 475</span></a>          {
<a name="l476"><span class="linenum"> 476</span></a>              case 1000:
<a name="l477"><span class="linenum"> 477</span></a>                  <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Duplicate page');
<a name="l478"><span class="linenum"> 478</span></a>                  break;
<a name="l479"><span class="linenum"> 479</span></a>  
<a name="l480"><span class="linenum"> 480</span></a>              case 1600:
<a name="l481"><span class="linenum"> 481</span></a>                  <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Duplicate intro');
<a name="l482"><span class="linenum"> 482</span></a>                  break;
<a name="l483"><span class="linenum"> 483</span></a>  
<a name="l484"><span class="linenum"> 484</span></a>              case 2000:
<a name="l485"><span class="linenum"> 485</span></a>                  <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Duplicate podcast episode');
<a name="l486"><span class="linenum"> 486</span></a>                  break;
<a name="l487"><span class="linenum"> 487</span></a>  
<a name="l488"><span class="linenum"> 488</span></a>              case 3000:
<a name="l489"><span class="linenum"> 489</span></a>                  <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Duplicate link');
<a name="l490"><span class="linenum"> 490</span></a>                  break;
<a name="l491"><span class="linenum"> 491</span></a>  
<a name="l492"><span class="linenum"> 492</span></a>              case 4000:
<a name="l493"><span class="linenum"> 493</span></a>                  <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Duplicate advertisement');
<a name="l494"><span class="linenum"> 494</span></a>                  break;
<a name="l495"><span class="linenum"> 495</span></a>  
<a name="l496"><span class="linenum"> 496</span></a>              default:
<a name="l497"><span class="linenum"> 497</span></a>                  <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Duplicate post');
<a name="l498"><span class="linenum"> 498</span></a>                  break;
<a name="l499"><span class="linenum"> 499</span></a>          }
<a name="l500"><span class="linenum"> 500</span></a>  
<a name="l501"><span class="linenum"> 501</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a>, '?ctrl=items&amp;amp;action=copy&amp;amp;blog='.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a onClick="logVariable('ID')" class="var it8952" onMouseOver="hilite(8952)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>.'&amp;amp;p='.<a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> );
<a name="l502"><span class="linenum"> 502</span></a>  
<a name="l503"><span class="linenum"> 503</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a onClick="logVariable('title_titlearea')" class="var it8956" onMouseOver="hilite(8956)" onMouseOut="lolite()" href="../../../_variables/title_titlearea.html">title_titlearea</a> = <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a>.': ';
<a name="l504"><span class="linenum"> 504</span></a>  
<a name="l505"><span class="linenum"> 505</span></a>  <span class="comment">        // Params we need for tab switching:</span>
<a name="l506"><span class="linenum"> 506</span></a>          <a class="var it6485" onMouseOver="hilite(6485)" onMouseOut="lolite()" onClick="logVariable('tab_switch_params')" href="../../../_variables/tab_switch_params.html">$tab_switch_params</a> = 'blog='.<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a>;
<a name="l507"><span class="linenum"> 507</span></a>          break;
<a name="l508"><span class="linenum"> 508</span></a>  
<a name="l509"><span class="linenum"> 509</span></a>  
<a name="l510"><span class="linenum"> 510</span></a>      case 'edit_switchtab': // this gets set as action by JS, when we switch tabs
<a name="l511"><span class="linenum"> 511</span></a>  <span class="comment">        // This is somewhat in between new and edit...</span>
<a name="l512"><span class="linenum"> 512</span></a>  
<a name="l513"><span class="linenum"> 513</span></a>  <span class="comment">        // Check permission based on DB status:</span>
<a name="l514"><span class="linenum"> 514</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'item_post!CURSTATUS', 'edit', true, <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> );
<a name="l515"><span class="linenum"> 515</span></a>  
<a name="l516"><span class="linenum"> 516</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('status')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/status.html">status</a> = <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'post_status', 'string', NULL );        <span class="comment">// 'published' or 'draft' or ...</span>
<a name="l517"><span class="linenum"> 517</span></a>  <span class="comment">        // We know we can use at least one status,</span>
<a name="l518"><span class="linenum"> 518</span></a>  <span class="comment">        // but we need to make sure the requested/default one is ok:</span>
<a name="l519"><span class="linenum"> 519</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('status')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/status.html">status</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a class="function" onClick="logFunction('get_allowed_item_status')" href="../../../_functions/get_allowed_item_status.html" onMouseOver="funcPopup(event,'get_allowed_item_status')">get_allowed_item_status</a>( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('status')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/status.html">status</a> );
<a name="l520"><span class="linenum"> 520</span></a>  
<a name="l521"><span class="linenum"> 521</span></a>  <span class="comment">        // We use the request variables to fill the edit form, because we need to be able to pass those values</span>
<a name="l522"><span class="linenum"> 522</span></a>  <span class="comment">        // from tab to tab via javascript when the editor wants to switch views...</span>
<a name="l523"><span class="linenum"> 523</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('load_from_Request')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/load_from_Request.html">load_from_Request</a> ( true ); <span class="comment">// needs Blog set</span>
<a name="l524"><span class="linenum"> 524</span></a>  
<a name="l525"><span class="linenum"> 525</span></a>  <span class="comment">        // Check if new category was started to create. If yes then set up parameters for next page</span>
<a name="l526"><span class="linenum"> 526</span></a>          <a class="function" onClick="logFunction('check_categories_nosave')" href="../../../_functions/check_categories_nosave.html" onMouseOver="funcPopup(event,'check_categories_nosave')">check_categories_nosave</a> ( <a class="var it28" onMouseOver="hilite(28)" onMouseOut="lolite()" onClick="logVariable('post_category')" href="../../../_variables/post_category.html">$post_category</a>, <a class="var it29" onMouseOver="hilite(29)" onMouseOut="lolite()" onClick="logVariable('post_extracats')" href="../../../_variables/post_extracats.html">$post_extracats</a> );
<a name="l527"><span class="linenum"> 527</span></a>  
<a name="l528"><span class="linenum"> 528</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('set')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/set.html">set</a> ( 'main_cat_ID', <a class="var it28" onMouseOver="hilite(28)" onMouseOut="lolite()" onClick="logVariable('post_category')" href="../../../_variables/post_category.html">$post_category</a> );
<a name="l529"><span class="linenum"> 529</span></a>          if( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('main_cat_ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/main_cat_ID.html">main_cat_ID</a> &amp;&amp; ( <a class="function" onClick="logFunction('get_allow_cross_posting')" href="../../../_functions/get_allow_cross_posting.html" onMouseOver="funcPopup(event,'get_allow_cross_posting')">get_allow_cross_posting</a>() &lt; 2 ) &amp;&amp; <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('get_blog_ID')" href="../../../_functions/get_blog_id.html" onMouseOver="funcPopup(event,'get_blog_id')">get_blog_ID</a>() != <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a> )
<a name="l530"><span class="linenum"> 530</span></a>          { // the main cat is not in the list of categories; this happens, if the user switches blogs during editing:
<a name="l531"><span class="linenum"> 531</span></a>              <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>('main_cat_ID', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a class="function" onClick="logFunction('get_default_cat_ID')" href="../../../_functions/get_default_cat_id.html" onMouseOver="funcPopup(event,'get_default_cat_id')">get_default_cat_ID</a>());
<a name="l532"><span class="linenum"> 532</span></a>          }
<a name="l533"><span class="linenum"> 533</span></a>          <a class="var it29" onMouseOver="hilite(29)" onMouseOut="lolite()" onClick="logVariable('post_extracats')" href="../../../_variables/post_extracats.html">$post_extracats</a> = <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'post_extracats', 'array/integer', <a class="var it29" onMouseOver="hilite(29)" onMouseOut="lolite()" onClick="logVariable('post_extracats')" href="../../../_variables/post_extracats.html">$post_extracats</a> );
<a name="l534"><span class="linenum"> 534</span></a>  
<a name="l535"><span class="linenum"> 535</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'item_tags', 'string', '' );
<a name="l536"><span class="linenum"> 536</span></a>  
<a name="l537"><span class="linenum"> 537</span></a>  <span class="comment">        // Trackback addresses (never saved into item)</span>
<a name="l538"><span class="linenum"> 538</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'trackback_url', 'string', '' );
<a name="l539"><span class="linenum"> 539</span></a>  
<a name="l540"><span class="linenum"> 540</span></a>  <span class="comment">        // Page title:</span>
<a name="l541"><span class="linenum"> 541</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a onClick="logVariable('title_titlearea')" class="var it8956" onMouseOver="hilite(8956)" onMouseOut="lolite()" href="../../../_variables/title_titlearea.html">title_titlearea</a> = sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Editing post #%d: %s'), <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>('name') );
<a name="l542"><span class="linenum"> 542</span></a>  
<a name="l543"><span class="linenum"> 543</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Post #%s'), <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> ), '?ctrl=items&amp;amp;blog='.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a onClick="logVariable('ID')" class="var it8952" onMouseOver="hilite(8952)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>.'&amp;amp;p='.<a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> );
<a name="l544"><span class="linenum"> 544</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Edit'), '?ctrl=items&amp;amp;action=edit&amp;amp;blog='.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a onClick="logVariable('ID')" class="var it8952" onMouseOver="hilite(8952)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>.'&amp;amp;p='.<a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> );
<a name="l545"><span class="linenum"> 545</span></a>  
<a name="l546"><span class="linenum"> 546</span></a>  <span class="comment">        // Params we need for tab switching:</span>
<a name="l547"><span class="linenum"> 547</span></a>          <a class="var it6485" onMouseOver="hilite(6485)" onMouseOut="lolite()" onClick="logVariable('tab_switch_params')" href="../../../_variables/tab_switch_params.html">$tab_switch_params</a> = 'p='.<a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>;
<a name="l548"><span class="linenum"> 548</span></a>          break;
<a name="l549"><span class="linenum"> 549</span></a>  
<a name="l550"><span class="linenum"> 550</span></a>      case 'history':
<a name="l551"><span class="linenum"> 551</span></a>  <span class="comment">        // Check permission:</span>
<a name="l552"><span class="linenum"> 552</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'item_post!CURSTATUS', 'edit', true, <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> );
<a name="l553"><span class="linenum"> 553</span></a>          break;
<a name="l554"><span class="linenum"> 554</span></a>  
<a name="l555"><span class="linenum"> 555</span></a>      case 'history_details':
<a name="l556"><span class="linenum"> 556</span></a>  <span class="comment">        // Check permission:</span>
<a name="l557"><span class="linenum"> 557</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'item_post!CURSTATUS', 'edit', true, <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> );
<a name="l558"><span class="linenum"> 558</span></a>  
<a name="l559"><span class="linenum"> 559</span></a>  <span class="comment">        // get revision param, but it is possible that it is not a number because current version sign is 'C'</span>
<a name="l560"><span class="linenum"> 560</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'r', 'integer', 0, false, false, true, false );
<a name="l561"><span class="linenum"> 561</span></a>  
<a name="l562"><span class="linenum"> 562</span></a>          <a class="var it1643" onMouseOver="hilite(1643)" onMouseOut="lolite()" onClick="logVariable('Revision')" href="../../../_variables/Revision.html">$Revision</a> = <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('get_revision')" href="../../../_functions/get_revision.html" onMouseOver="funcPopup(event,'get_revision')">get_revision</a>( <a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../../_variables/r.html">$r</a> );
<a name="l563"><span class="linenum"> 563</span></a>          break;
<a name="l564"><span class="linenum"> 564</span></a>  
<a name="l565"><span class="linenum"> 565</span></a>      case 'history_compare':
<a name="l566"><span class="linenum"> 566</span></a>  <span class="comment">        // Check permission:</span>
<a name="l567"><span class="linenum"> 567</span></a>          if( ! <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'item_post!CURSTATUS', 'edit', false, <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> ) )
<a name="l568"><span class="linenum"> 568</span></a>          {
<a name="l569"><span class="linenum"> 569</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('You have no permission to view history for this item.'), 'error' );
<a name="l570"><span class="linenum"> 570</span></a>              <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( <a class="var it346" onMouseOver="hilite(346)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../../_variables/admin_url.html">$admin_url</a> );
<a name="l571"><span class="linenum"> 571</span></a>          }
<a name="l572"><span class="linenum"> 572</span></a>  
<a name="l573"><span class="linenum"> 573</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'r1', 'integer', 0 );
<a name="l574"><span class="linenum"> 574</span></a>          <a class="var it1160" onMouseOver="hilite(1160)" onMouseOut="lolite()" onClick="logVariable('r2')" href="../../../_variables/r2.html">$r2</a> = (int)<a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'r2', 'string', 0 );
<a name="l575"><span class="linenum"> 575</span></a>  
<a name="l576"><span class="linenum"> 576</span></a>          <a class="var it3571" onMouseOver="hilite(3571)" onMouseOut="lolite()" onClick="logVariable('Revision_1')" href="../../../_variables/Revision_1.html">$Revision_1</a> = <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('get_revision')" href="../../../_functions/get_revision.html" onMouseOver="funcPopup(event,'get_revision')">get_revision</a>( <a class="var it6487" onMouseOver="hilite(6487)" onMouseOut="lolite()" onClick="logVariable('r1')" href="../../../_variables/r1.html">$r1</a> );
<a name="l577"><span class="linenum"> 577</span></a>          <a class="var it3572" onMouseOver="hilite(3572)" onMouseOut="lolite()" onClick="logVariable('Revision_2')" href="../../../_variables/Revision_2.html">$Revision_2</a> = <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('get_revision')" href="../../../_functions/get_revision.html" onMouseOver="funcPopup(event,'get_revision')">get_revision</a>( <a class="var it1160" onMouseOver="hilite(1160)" onMouseOut="lolite()" onClick="logVariable('r2')" href="../../../_variables/r2.html">$r2</a> );
<a name="l578"><span class="linenum"> 578</span></a>  
<a name="l579"><span class="linenum"> 579</span></a>          <a class="function" onClick="logFunction('load_class')" href="../../../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( '_core/model/_diff.class.php', 'Diff' );
<a name="l580"><span class="linenum"> 580</span></a>  
<a name="l581"><span class="linenum"> 581</span></a>  <span class="comment">        // Compare the titles of two revisions</span>
<a name="l582"><span class="linenum"> 582</span></a>          <a class="var it3573" onMouseOver="hilite(3573)" onMouseOut="lolite()" onClick="logVariable('revisions_difference_title')" href="../../../_variables/revisions_difference_title.html">$revisions_difference_title</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Diff')" href="../../../_classes/diff.html" onMouseOver="classPopup(event,'diff')">Diff</a>( <a class="phpfunction" onClick="logFunction('explode')" href="../../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>( &quot;\n&quot;, <a class="var it3571" onMouseOver="hilite(3571)" onMouseOut="lolite()" onClick="logVariable('Revision_1')" href="../../../_variables/Revision_1.html">$Revision_1</a>-&gt;<a onClick="logVariable('iver_title')" class="var it8996" onMouseOver="hilite(8996)" onMouseOut="lolite()" href="../../../_variables/iver_title.html">iver_title</a> ), <a class="phpfunction" onClick="logFunction('explode')" href="../../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>( &quot;\n&quot;, <a class="var it3572" onMouseOver="hilite(3572)" onMouseOut="lolite()" onClick="logVariable('Revision_2')" href="../../../_variables/Revision_2.html">$Revision_2</a>-&gt;<a onClick="logVariable('iver_title')" class="var it8997" onMouseOver="hilite(8997)" onMouseOut="lolite()" href="../../../_variables/iver_title.html">iver_title</a> ) );
<a name="l583"><span class="linenum"> 583</span></a>          <a class="var it531" onMouseOver="hilite(531)" onMouseOut="lolite()" onClick="logVariable('format')" href="../../../_variables/format.html">$format</a> = <span class="keyword">new </span><a class="class" onClick="logClass('TitleDiffFormatter')" href="../../../_classes/titlediffformatter.html" onMouseOver="classPopup(event,'titlediffformatter')">TitleDiffFormatter</a>();
<a name="l584"><span class="linenum"> 584</span></a>          <a class="var it3573" onMouseOver="hilite(3573)" onMouseOut="lolite()" onClick="logVariable('revisions_difference_title')" href="../../../_variables/revisions_difference_title.html">$revisions_difference_title</a> = <a class="var it531" onMouseOver="hilite(531)" onMouseOut="lolite()" onClick="logVariable('format')" href="../../../_variables/format.html">$format</a>-&gt;<a class="function" onClick="logFunction('format')" href="../../../_functions/format.html" onMouseOver="funcPopup(event,'format')">format</a>( <a class="var it3573" onMouseOver="hilite(3573)" onMouseOut="lolite()" onClick="logVariable('revisions_difference_title')" href="../../../_variables/revisions_difference_title.html">$revisions_difference_title</a> );
<a name="l585"><span class="linenum"> 585</span></a>  
<a name="l586"><span class="linenum"> 586</span></a>  <span class="comment">        // Compare the contents of two revisions</span>
<a name="l587"><span class="linenum"> 587</span></a>          <a class="var it3574" onMouseOver="hilite(3574)" onMouseOut="lolite()" onClick="logVariable('revisions_difference_content')" href="../../../_variables/revisions_difference_content.html">$revisions_difference_content</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Diff')" href="../../../_classes/diff.html" onMouseOver="classPopup(event,'diff')">Diff</a>( <a class="phpfunction" onClick="logFunction('explode')" href="../../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>( &quot;\n&quot;, <a class="var it3571" onMouseOver="hilite(3571)" onMouseOut="lolite()" onClick="logVariable('Revision_1')" href="../../../_variables/Revision_1.html">$Revision_1</a>-&gt;<a onClick="logVariable('iver_content')" class="var it8996" onMouseOver="hilite(8996)" onMouseOut="lolite()" href="../../../_variables/iver_content.html">iver_content</a> ), <a class="phpfunction" onClick="logFunction('explode')" href="../../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>( &quot;\n&quot;, <a class="var it3572" onMouseOver="hilite(3572)" onMouseOut="lolite()" onClick="logVariable('Revision_2')" href="../../../_variables/Revision_2.html">$Revision_2</a>-&gt;<a onClick="logVariable('iver_content')" class="var it8997" onMouseOver="hilite(8997)" onMouseOut="lolite()" href="../../../_variables/iver_content.html">iver_content</a> ) );
<a name="l588"><span class="linenum"> 588</span></a>          <a class="var it531" onMouseOver="hilite(531)" onMouseOut="lolite()" onClick="logVariable('format')" href="../../../_variables/format.html">$format</a> = <span class="keyword">new </span><a class="class" onClick="logClass('TableDiffFormatter')" href="../../../_classes/tablediffformatter.html" onMouseOver="classPopup(event,'tablediffformatter')">TableDiffFormatter</a>();
<a name="l589"><span class="linenum"> 589</span></a>          <a class="var it3574" onMouseOver="hilite(3574)" onMouseOut="lolite()" onClick="logVariable('revisions_difference_content')" href="../../../_variables/revisions_difference_content.html">$revisions_difference_content</a> = <a class="var it531" onMouseOver="hilite(531)" onMouseOut="lolite()" onClick="logVariable('format')" href="../../../_variables/format.html">$format</a>-&gt;<a class="function" onClick="logFunction('format')" href="../../../_functions/format.html" onMouseOver="funcPopup(event,'format')">format</a>( <a class="var it3574" onMouseOver="hilite(3574)" onMouseOut="lolite()" onClick="logVariable('revisions_difference_content')" href="../../../_variables/revisions_difference_content.html">$revisions_difference_content</a> );
<a name="l590"><span class="linenum"> 590</span></a>  
<a name="l591"><span class="linenum"> 591</span></a>          break;
<a name="l592"><span class="linenum"> 592</span></a>  
<a name="l593"><span class="linenum"> 593</span></a>      case 'history_restore':
<a name="l594"><span class="linenum"> 594</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l595"><span class="linenum"> 595</span></a>          <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'item' );
<a name="l596"><span class="linenum"> 596</span></a>  
<a name="l597"><span class="linenum"> 597</span></a>  <span class="comment">        // Check permission:</span>
<a name="l598"><span class="linenum"> 598</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'item_post!CURSTATUS', 'edit', true, <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> );
<a name="l599"><span class="linenum"> 599</span></a>  
<a name="l600"><span class="linenum"> 600</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'r', 'integer', 0 );
<a name="l601"><span class="linenum"> 601</span></a>  
<a name="l602"><span class="linenum"> 602</span></a>          if( <a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../../_variables/r.html">$r</a> &gt; 0 )
<a name="l603"><span class="linenum"> 603</span></a>          {    // Update item only from revisions (<a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../../_variables/r.html">$r</a> == 0 for current version)
<a name="l604"><span class="linenum"> 604</span></a>              <a class="var it1643" onMouseOver="hilite(1643)" onMouseOut="lolite()" onClick="logVariable('Revision')" href="../../../_variables/Revision.html">$Revision</a> = <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('get_revision')" href="../../../_functions/get_revision.html" onMouseOver="funcPopup(event,'get_revision')">get_revision</a>( <a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../../_variables/r.html">$r</a> );
<a name="l605"><span class="linenum"> 605</span></a>  
<a name="l606"><span class="linenum"> 606</span></a>              <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'status', <a class="var it1643" onMouseOver="hilite(1643)" onMouseOut="lolite()" onClick="logVariable('Revision')" href="../../../_variables/Revision.html">$Revision</a>-&gt;<a onClick="logVariable('iver_status')" class="var it8998" onMouseOver="hilite(8998)" onMouseOut="lolite()" href="../../../_variables/iver_status.html">iver_status</a> );
<a name="l607"><span class="linenum"> 607</span></a>              <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'title', <a class="var it1643" onMouseOver="hilite(1643)" onMouseOut="lolite()" onClick="logVariable('Revision')" href="../../../_variables/Revision.html">$Revision</a>-&gt;<a onClick="logVariable('iver_title')" class="var it8998" onMouseOver="hilite(8998)" onMouseOut="lolite()" href="../../../_variables/iver_title.html">iver_title</a> );
<a name="l608"><span class="linenum"> 608</span></a>              <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'content', <a class="var it1643" onMouseOver="hilite(1643)" onMouseOut="lolite()" onClick="logVariable('Revision')" href="../../../_variables/Revision.html">$Revision</a>-&gt;<a onClick="logVariable('iver_content')" class="var it8998" onMouseOver="hilite(8998)" onMouseOut="lolite()" href="../../../_variables/iver_content.html">iver_content</a> );
<a name="l609"><span class="linenum"> 609</span></a>  
<a name="l610"><span class="linenum"> 610</span></a>              if( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('dbupdate')" href="../../../_functions/dbupdate.html" onMouseOver="funcPopup(event,'dbupdate')">dbupdate</a>() )
<a name="l611"><span class="linenum"> 611</span></a>              {    // Item updated
<a name="l612"><span class="linenum"> 612</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Item has been restored from revision #%s'), <a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../../_variables/r.html">$r</a> ), 'success' );
<a name="l613"><span class="linenum"> 613</span></a>              }
<a name="l614"><span class="linenum"> 614</span></a>          }
<a name="l615"><span class="linenum"> 615</span></a>  
<a name="l616"><span class="linenum"> 616</span></a>          <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( <a class="function" onClick="logFunction('regenerate_url')" href="../../../_functions/regenerate_url.html" onMouseOver="funcPopup(event,'regenerate_url')">regenerate_url</a>( 'action', 'action=history', '', '&amp;' ) );
<a name="l617"><span class="linenum"> 617</span></a>          break;
<a name="l618"><span class="linenum"> 618</span></a>  
<a name="l619"><span class="linenum"> 619</span></a>      case 'edit':
<a name="l620"><span class="linenum"> 620</span></a>  <span class="comment">        // Check permission:</span>
<a name="l621"><span class="linenum"> 621</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'item_post!CURSTATUS', 'edit', true, <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> );
<a name="l622"><span class="linenum"> 622</span></a>  
<a name="l623"><span class="linenum"> 623</span></a>          <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('post_comment_status')" href="../../../_variables/post_comment_status.html">$post_comment_status</a> = <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>( 'comment_status' );
<a name="l624"><span class="linenum"> 624</span></a>          <a class="var it29" onMouseOver="hilite(29)" onMouseOut="lolite()" onClick="logVariable('post_extracats')" href="../../../_variables/post_extracats.html">$post_extracats</a> = <a class="function" onClick="logFunction('postcats_get_byID')" href="../../../_functions/postcats_get_byid.html" onMouseOver="funcPopup(event,'postcats_get_byid')">postcats_get_byID</a>( <a class="var it658" onMouseOver="hilite(658)" onMouseOut="lolite()" onClick="logVariable('p')" href="../../../_variables/p.html">$p</a> ); <span class="comment">// NOTE: dh&gt; using $edited_Item-&gt;get_Chapters here instead fails (empty list, since no postIDlist).</span>
<a name="l625"><span class="linenum"> 625</span></a>  
<a name="l626"><span class="linenum"> 626</span></a>          <a class="var it980" onMouseOver="hilite(980)" onMouseOut="lolite()" onClick="logVariable('item_tags')" href="../../../_variables/item_tags.html">$item_tags</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( ', ', <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('get_tags')" href="../../../_functions/get_tags.html" onMouseOver="funcPopup(event,'get_tags')">get_tags</a>() );
<a name="l627"><span class="linenum"> 627</span></a>          <a class="var it977" onMouseOver="hilite(977)" onMouseOut="lolite()" onClick="logVariable('trackback_url')" href="../../../_variables/trackback_url.html">$trackback_url</a> = '';
<a name="l628"><span class="linenum"> 628</span></a>  
<a name="l629"><span class="linenum"> 629</span></a>  <span class="comment">        // Page title:</span>
<a name="l630"><span class="linenum"> 630</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a onClick="logVariable('title_titlearea')" class="var it8956" onMouseOver="hilite(8956)" onMouseOut="lolite()" href="../../../_variables/title_titlearea.html">title_titlearea</a> = sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Editing post #%d: %s'), <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>('name') );
<a name="l631"><span class="linenum"> 631</span></a>  
<a name="l632"><span class="linenum"> 632</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Post #%s'), <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> ), '?ctrl=items&amp;amp;blog='.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a onClick="logVariable('ID')" class="var it8952" onMouseOver="hilite(8952)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>.'&amp;amp;p='.<a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> );
<a name="l633"><span class="linenum"> 633</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Edit'), '?ctrl=items&amp;amp;action=edit&amp;amp;blog='.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a onClick="logVariable('ID')" class="var it8952" onMouseOver="hilite(8952)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>.'&amp;amp;p='.<a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> );
<a name="l634"><span class="linenum"> 634</span></a>  
<a name="l635"><span class="linenum"> 635</span></a>  <span class="comment">        // Params we need for tab switching:</span>
<a name="l636"><span class="linenum"> 636</span></a>          <a class="var it6485" onMouseOver="hilite(6485)" onMouseOut="lolite()" onClick="logVariable('tab_switch_params')" href="../../../_variables/tab_switch_params.html">$tab_switch_params</a> = 'p='.<a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>;
<a name="l637"><span class="linenum"> 637</span></a>          break;
<a name="l638"><span class="linenum"> 638</span></a>  
<a name="l639"><span class="linenum"> 639</span></a>  
<a name="l640"><span class="linenum"> 640</span></a>      case 'create_edit':
<a name="l641"><span class="linenum"> 641</span></a>      case 'create':
<a name="l642"><span class="linenum"> 642</span></a>      case 'create_publish':
<a name="l643"><span class="linenum"> 643</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l644"><span class="linenum"> 644</span></a>          <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'item' );
<a name="l645"><span class="linenum"> 645</span></a>  
<a name="l646"><span class="linenum"> 646</span></a>  <span class="comment">        // We need early decoding of these in order to check permissions:</span>
<a name="l647"><span class="linenum"> 647</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'post_status', 'string', 'published' );
<a name="l648"><span class="linenum"> 648</span></a>  
<a name="l649"><span class="linenum"> 649</span></a>          if( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> == 'create_publish' )
<a name="l650"><span class="linenum"> 650</span></a>          { // load publish status from param, because a post can be published to many status
<a name="l651"><span class="linenum"> 651</span></a>              <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('post_status')" href="../../../_variables/post_status.html">$post_status</a> = <a class="function" onClick="logFunction('load_publish_status')" href="../../../_functions/load_publish_status.html" onMouseOver="funcPopup(event,'load_publish_status')">load_publish_status</a>( true );
<a name="l652"><span class="linenum"> 652</span></a>          }
<a name="l653"><span class="linenum"> 653</span></a>  
<a name="l654"><span class="linenum"> 654</span></a>  <span class="comment">        // Check if new category was started to create. If yes check if it is valid.</span>
<a name="l655"><span class="linenum"> 655</span></a>          <a class="function" onClick="logFunction('check_categories')" href="../../../_functions/check_categories.html" onMouseOver="funcPopup(event,'check_categories')">check_categories</a> ( <a class="var it28" onMouseOver="hilite(28)" onMouseOut="lolite()" onClick="logVariable('post_category')" href="../../../_variables/post_category.html">$post_category</a>, <a class="var it29" onMouseOver="hilite(29)" onMouseOut="lolite()" onClick="logVariable('post_extracats')" href="../../../_variables/post_extracats.html">$post_extracats</a> );
<a name="l656"><span class="linenum"> 656</span></a>  
<a name="l657"><span class="linenum"> 657</span></a>  <span class="comment">        // Check permission on statuses:</span>
<a name="l658"><span class="linenum"> 658</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'cats_post!'.<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('post_status')" href="../../../_variables/post_status.html">$post_status</a>, 'create', true, <a class="var it29" onMouseOver="hilite(29)" onMouseOut="lolite()" onClick="logVariable('post_extracats')" href="../../../_variables/post_extracats.html">$post_extracats</a> );
<a name="l659"><span class="linenum"> 659</span></a>  <span class="comment">        // Check permission on post type:</span>
<a name="l660"><span class="linenum"> 660</span></a>          <a class="function" onClick="logFunction('check_perm_posttype')" href="../../../_functions/check_perm_posttype.html" onMouseOver="funcPopup(event,'check_perm_posttype')">check_perm_posttype</a>( <a class="var it29" onMouseOver="hilite(29)" onMouseOut="lolite()" onClick="logVariable('post_extracats')" href="../../../_variables/post_extracats.html">$post_extracats</a> );
<a name="l661"><span class="linenum"> 661</span></a>  
<a name="l662"><span class="linenum"> 662</span></a>  <span class="comment">        // CREATE NEW POST:</span>
<a name="l663"><span class="linenum"> 663</span></a>          <a class="function" onClick="logFunction('load_class')" href="../../../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( 'items/model/_item.class.php', 'Item' );
<a name="l664"><span class="linenum"> 664</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Item')" href="../../../_classes/item.html" onMouseOver="classPopup(event,'item')">Item</a>();
<a name="l665"><span class="linenum"> 665</span></a>  
<a name="l666"><span class="linenum"> 666</span></a>  <span class="comment">        // Set the params we already got:</span>
<a name="l667"><span class="linenum"> 667</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'status', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('post_status')" href="../../../_variables/post_status.html">$post_status</a> );
<a name="l668"><span class="linenum"> 668</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'main_cat_ID', <a class="var it28" onMouseOver="hilite(28)" onMouseOut="lolite()" onClick="logVariable('post_category')" href="../../../_variables/post_category.html">$post_category</a> );
<a name="l669"><span class="linenum"> 669</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'extra_cat_IDs', <a class="var it29" onMouseOver="hilite(29)" onMouseOut="lolite()" onClick="logVariable('post_extracats')" href="../../../_variables/post_extracats.html">$post_extracats</a> );
<a name="l670"><span class="linenum"> 670</span></a>  
<a name="l671"><span class="linenum"> 671</span></a>  <span class="comment">        // Set object params:</span>
<a name="l672"><span class="linenum"> 672</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('load_from_Request')" href="../../../_functions/load_from_request.html" onMouseOver="funcPopup(event,'load_from_request')">load_from_Request</a>( <span class="comment">/* editing? */</span> (<a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> == 'create_edit'), <span class="comment">/* creating? */</span> true );
<a name="l673"><span class="linenum"> 673</span></a>  
<a name="l674"><span class="linenum"> 674</span></a>  <span class="comment">        // Check and clear inline images, to avoid to have placeholders without corresponding attachment</span>
<a name="l675"><span class="linenum"> 675</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('check_and_clear_inline_images')" href="../../../_functions/check_and_clear_inline_images.html" onMouseOver="funcPopup(event,'check_and_clear_inline_images')">check_and_clear_inline_images</a>();
<a name="l676"><span class="linenum"> 676</span></a>  
<a name="l677"><span class="linenum"> 677</span></a>          <a class="var it16" onMouseOver="hilite(16)" onMouseOut="lolite()" onClick="logVariable('Plugins')" href="../../../_variables/Plugins.html">$Plugins</a>-&gt;<a onClick="logVariable('trigger_event')" class="var it9066" onMouseOver="hilite(9066)" onMouseOut="lolite()" href="../../../_variables/trigger_event.html">trigger_event</a> ( 'AdminBeforeItemEditCreate', array ('Item' =&gt; &amp; <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> ) );
<a name="l678"><span class="linenum"> 678</span></a>  
<a name="l679"><span class="linenum"> 679</span></a>          if( !empty( <a class="var it6475" onMouseOver="hilite(6475)" onMouseOut="lolite()" onClick="logVariable('mass_create')" href="../../../_variables/mass_create.html">$mass_create</a> ) )
<a name="l680"><span class="linenum"> 680</span></a>          {    // ------ MASS CREATE ------
<a name="l681"><span class="linenum"> 681</span></a>              <a class="var it1981" onMouseOver="hilite(1981)" onMouseOut="lolite()" onClick="logVariable('Items')" href="../../../_variables/Items.html">$Items</a> = &amp; create_multiple_posts( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>, <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'paragraphs_linebreak', 'boolean', 0 ) );
<a name="l682"><span class="linenum"> 682</span></a>              if( empty( <a class="var it1981" onMouseOver="hilite(1981)" onMouseOut="lolite()" onClick="logVariable('Items')" href="../../../_variables/Items.html">$Items</a> ) )
<a name="l683"><span class="linenum"> 683</span></a>              {
<a name="l684"><span class="linenum"> 684</span></a>                  <a class="function" onClick="logFunction('param_error')" href="../../../_functions/param_error.html" onMouseOver="funcPopup(event,'param_error')">param_error</a>( 'content', <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>( 'Content must not be empty.' ) );
<a name="l685"><span class="linenum"> 685</span></a>              }
<a name="l686"><span class="linenum"> 686</span></a>          }
<a name="l687"><span class="linenum"> 687</span></a>  
<a name="l688"><span class="linenum"> 688</span></a>          <a class="var it156" onMouseOver="hilite(156)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a> = !<a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('has_errors')" href="../../../_functions/has_errors.html" onMouseOver="funcPopup(event,'has_errors')">has_errors</a>();
<a name="l689"><span class="linenum"> 689</span></a>  
<a name="l690"><span class="linenum"> 690</span></a>          if( <a class="var it156" onMouseOver="hilite(156)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a> )
<a name="l691"><span class="linenum"> 691</span></a>          { // There are no validation errors
<a name="l692"><span class="linenum"> 692</span></a>              if( isset( <a class="var it1981" onMouseOver="hilite(1981)" onMouseOut="lolite()" onClick="logVariable('Items')" href="../../../_variables/Items.html">$Items</a> ) &amp;&amp; !empty( <a class="var it1981" onMouseOver="hilite(1981)" onMouseOut="lolite()" onClick="logVariable('Items')" href="../../../_variables/Items.html">$Items</a> ) )
<a name="l693"><span class="linenum"> 693</span></a>              {    // We can create multiple posts from single post
<a name="l694"><span class="linenum"> 694</span></a>                  foreach( <a class="var it1981" onMouseOver="hilite(1981)" onMouseOut="lolite()" onClick="logVariable('Items')" href="../../../_variables/Items.html">$Items</a> as <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> )
<a name="l695"><span class="linenum"> 695</span></a>                  {    // INSERT NEW POST INTO DB:
<a name="l696"><span class="linenum"> 696</span></a>                      <a class="var it156" onMouseOver="hilite(156)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a> = <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('dbinsert')" href="../../../_functions/dbinsert.html" onMouseOver="funcPopup(event,'dbinsert')">dbinsert</a>();
<a name="l697"><span class="linenum"> 697</span></a>                  }
<a name="l698"><span class="linenum"> 698</span></a>              }
<a name="l699"><span class="linenum"> 699</span></a>              else
<a name="l700"><span class="linenum"> 700</span></a>              {    // INSERT NEW POST INTO DB:
<a name="l701"><span class="linenum"> 701</span></a>                  <a class="var it156" onMouseOver="hilite(156)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a> = <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('dbinsert')" href="../../../_functions/dbinsert.html" onMouseOver="funcPopup(event,'dbinsert')">dbinsert</a>();
<a name="l702"><span class="linenum"> 702</span></a>              }
<a name="l703"><span class="linenum"> 703</span></a>              if( !<a class="var it156" onMouseOver="hilite(156)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a> )
<a name="l704"><span class="linenum"> 704</span></a>              { // Add error message
<a name="l705"><span class="linenum"> 705</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Couldn\'t create the new post'), 'error' );
<a name="l706"><span class="linenum"> 706</span></a>              }
<a name="l707"><span class="linenum"> 707</span></a>          }
<a name="l708"><span class="linenum"> 708</span></a>  
<a name="l709"><span class="linenum"> 709</span></a>          if( !<a class="var it156" onMouseOver="hilite(156)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a> )
<a name="l710"><span class="linenum"> 710</span></a>          { // could not insert the new <a class="function" onClick="logFunction('post')" href="../../../_functions/post.html" onMouseOver="funcPopup(event,'post')">post</a> ( validation errors or unsuccessful db insert )
<a name="l711"><span class="linenum"> 711</span></a>              if( !empty( <a class="var it6475" onMouseOver="hilite(6475)" onMouseOut="lolite()" onClick="logVariable('mass_create')" href="../../../_variables/mass_create.html">$mass_create</a> ) )
<a name="l712"><span class="linenum"> 712</span></a>              {
<a name="l713"><span class="linenum"> 713</span></a>                  <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'new_mass';
<a name="l714"><span class="linenum"> 714</span></a>              }
<a name="l715"><span class="linenum"> 715</span></a>  <span class="comment">            // Params we need for tab switching:</span>
<a name="l716"><span class="linenum"> 716</span></a>              <a class="var it6485" onMouseOver="hilite(6485)" onMouseOut="lolite()" onClick="logVariable('tab_switch_params')" href="../../../_variables/tab_switch_params.html">$tab_switch_params</a> = 'blog='.<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a>;
<a name="l717"><span class="linenum"> 717</span></a>              break;
<a name="l718"><span class="linenum"> 718</span></a>          }
<a name="l719"><span class="linenum"> 719</span></a>  
<a name="l720"><span class="linenum"> 720</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'is_attachments', 'string' );
<a name="l721"><span class="linenum"> 721</span></a>          if( !empty( <a class="var it6489" onMouseOver="hilite(6489)" onMouseOut="lolite()" onClick="logVariable('is_attachments')" href="../../../_variables/is_attachments.html">$is_attachments</a> ) &amp;&amp; <a class="var it6489" onMouseOver="hilite(6489)" onMouseOut="lolite()" onClick="logVariable('is_attachments')" href="../../../_variables/is_attachments.html">$is_attachments</a> === 'true' )
<a name="l722"><span class="linenum"> 722</span></a>          { // Set session variable to dynamically create js popup:
<a name="l723"><span class="linenum"> 723</span></a>              <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>('create_edit_attachment', true);
<a name="l724"><span class="linenum"> 724</span></a>          }
<a name="l725"><span class="linenum"> 725</span></a>  
<a name="l726"><span class="linenum"> 726</span></a>  <span class="comment">        // post post-publishing operations:</span>
<a name="l727"><span class="linenum"> 727</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'trackback_url', 'string' );
<a name="l728"><span class="linenum"> 728</span></a>          if( !empty( <a class="var it977" onMouseOver="hilite(977)" onMouseOut="lolite()" onClick="logVariable('trackback_url')" href="../../../_variables/trackback_url.html">$trackback_url</a> ) )
<a name="l729"><span class="linenum"> 729</span></a>          {
<a name="l730"><span class="linenum"> 730</span></a>              if( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('status')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/status.html">status</a> != 'published' )
<a name="l731"><span class="linenum"> 731</span></a>              {
<a name="l732"><span class="linenum"> 732</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Post not publicly published: skipping trackback...'), 'note' );
<a name="l733"><span class="linenum"> 733</span></a>              }
<a name="l734"><span class="linenum"> 734</span></a>              else
<a name="l735"><span class="linenum"> 735</span></a>              { // trackback now:
<a name="l736"><span class="linenum"> 736</span></a>                  <a class="function" onClick="logFunction('load_funcs')" href="../../../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>('comments/_trackback.funcs.php');
<a name="l737"><span class="linenum"> 737</span></a>                  <a class="function" onClick="logFunction('trackbacks')" href="../../../_functions/trackbacks.html" onMouseOver="funcPopup(event,'trackbacks')">trackbacks</a>( <a class="var it977" onMouseOver="hilite(977)" onMouseOut="lolite()" onClick="logVariable('trackback_url')" href="../../../_variables/trackback_url.html">$trackback_url</a>, <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> );
<a name="l738"><span class="linenum"> 738</span></a>              }
<a name="l739"><span class="linenum"> 739</span></a>          }
<a name="l740"><span class="linenum"> 740</span></a>  
<a name="l741"><span class="linenum"> 741</span></a>  <span class="comment">        // Execute or schedule notifications &amp; pings:</span>
<a name="l742"><span class="linenum"> 742</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('handle_post_processing')" href="../../../_functions/handle_post_processing.html" onMouseOver="funcPopup(event,'handle_post_processing')">handle_post_processing</a>( true, <a class="var it6477" onMouseOver="hilite(6477)" onMouseOut="lolite()" onClick="logVariable('exit_after_save')" href="../../../_variables/exit_after_save.html">$exit_after_save</a> );
<a name="l743"><span class="linenum"> 743</span></a>  
<a name="l744"><span class="linenum"> 744</span></a>          <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Post has been created.'), 'success' );
<a name="l745"><span class="linenum"> 745</span></a>  
<a name="l746"><span class="linenum"> 746</span></a>          if( ! <a class="var it6477" onMouseOver="hilite(6477)" onMouseOut="lolite()" onClick="logVariable('exit_after_save')" href="../../../_variables/exit_after_save.html">$exit_after_save</a> )
<a name="l747"><span class="linenum"> 747</span></a>          {    // We want to continue editing...
<a name="l748"><span class="linenum"> 748</span></a>              <a class="var it6485" onMouseOver="hilite(6485)" onMouseOut="lolite()" onClick="logVariable('tab_switch_params')" href="../../../_variables/tab_switch_params.html">$tab_switch_params</a> = 'p='.<a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>;
<a name="l749"><span class="linenum"> 749</span></a>              <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'edit';    <span class="comment">// It's basically as if we had updated</span>
<a name="l750"><span class="linenum"> 750</span></a>              break;
<a name="l751"><span class="linenum"> 751</span></a>          }
<a name="l752"><span class="linenum"> 752</span></a>  
<a name="l753"><span class="linenum"> 753</span></a>  <span class="comment">        // We want to highlight the edited object on next list display:</span>
<a name="l754"><span class="linenum"> 754</span></a>          <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'fadeout_array', array( 'item-'.<a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> ) );
<a name="l755"><span class="linenum"> 755</span></a>  
<a name="l756"><span class="linenum"> 756</span></a>          if( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('status')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/status.html">status</a> == 'published' &amp;&amp;
<a name="l757"><span class="linenum"> 757</span></a>              ! <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../../_variables/redirect_to.html">$redirect_to</a>, 'tab=tracker' ) &amp;&amp;
<a name="l758"><span class="linenum"> 758</span></a>              ! <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../../_variables/redirect_to.html">$redirect_to</a>, 'tab=manual' ) )
<a name="l759"><span class="linenum"> 759</span></a>          {    // fp&gt; I noticed that after publishing a new post, I always want to see how the blog looks like
<a name="l760"><span class="linenum"> 760</span></a>  <span class="comment">            // If anyone doesn't want that, we can make this optional...</span>
<a name="l761"><span class="linenum"> 761</span></a>  <span class="comment">            // sam2kb&gt; Please make this optional, this is really annoying when you create more than one post or when you publish draft images created from FM.</span>
<a name="l762"><span class="linenum"> 762</span></a>  <span class="comment">            // yura&gt; When a post is created from &quot;workflow&quot; or &quot;manual&quot; we should display a post list</span>
<a name="l763"><span class="linenum"> 763</span></a>  
<a name="l764"><span class="linenum"> 764</span></a>  <span class="comment">            // Where do we want to go after publishing?</span>
<a name="l765"><span class="linenum"> 765</span></a>              if( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('Blog')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/Blog.html">Blog</a>-&gt;<a class="function" onClick="logFunction('get_setting')" href="../../../_functions/get_setting.html" onMouseOver="funcPopup(event,'get_setting')">get_setting</a>( 'enable_goto_blog' ) == 'blog' )
<a name="l766"><span class="linenum"> 766</span></a>              {    // go to blog:
<a name="l767"><span class="linenum"> 767</span></a>                  <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('load_Blog')" href="../../../_functions/load_blog.html" onMouseOver="funcPopup(event,'load_blog')">load_Blog</a>();
<a name="l768"><span class="linenum"> 768</span></a>                  <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../../_variables/redirect_to.html">$redirect_to</a> = <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('Blog')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/Blog.html">Blog</a>-&gt;<a class="function" onClick="logFunction('gen_blogurl')" href="../../../_functions/gen_blogurl.html" onMouseOver="funcPopup(event,'gen_blogurl')">gen_blogurl</a>();
<a name="l769"><span class="linenum"> 769</span></a>              }
<a name="l770"><span class="linenum"> 770</span></a>              elseif( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('Blog')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/Blog.html">Blog</a>-&gt;<a class="function" onClick="logFunction('get_setting')" href="../../../_functions/get_setting.html" onMouseOver="funcPopup(event,'get_setting')">get_setting</a>( 'enable_goto_blog' ) == 'post' )
<a name="l771"><span class="linenum"> 771</span></a>              {    // redirect to post page:
<a name="l772"><span class="linenum"> 772</span></a>                  <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../../_variables/redirect_to.html">$redirect_to</a> = <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('get_permanent_url')" href="../../../_functions/get_permanent_url.html" onMouseOver="funcPopup(event,'get_permanent_url')">get_permanent_url</a>();
<a name="l773"><span class="linenum"> 773</span></a>              }
<a name="l774"><span class="linenum"> 774</span></a>              else// 'no'
<a name="l775"><span class="linenum"> 775</span></a>              {    // redirect to posts list:
<a name="l776"><span class="linenum"> 776</span></a>                  <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( <a class="function" onClick="logFunction('regenerate_url')" href="../../../_functions/regenerate_url.html" onMouseOver="funcPopup(event,'regenerate_url')">regenerate_url</a>( '', '&amp;highlight='.<a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, '', '&amp;' ) );
<a name="l777"><span class="linenum"> 777</span></a>              }
<a name="l778"><span class="linenum"> 778</span></a>          }
<a name="l779"><span class="linenum"> 779</span></a>  
<a name="l780"><span class="linenum"> 780</span></a>  <span class="comment">        // REDIRECT / EXIT</span>
<a name="l781"><span class="linenum"> 781</span></a>          <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( <a class="function" onClick="logFunction('url_add_param')" href="../../../_functions/url_add_param.html" onMouseOver="funcPopup(event,'url_add_param')">url_add_param</a>( <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../../_variables/redirect_to.html">$redirect_to</a>, 'highlight='.<a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, '&amp;' ) );
<a name="l782"><span class="linenum"> 782</span></a>  <span class="comment">        // Switch to list mode:</span>
<a name="l783"><span class="linenum"> 783</span></a>  <span class="comment">        // $action = 'list';</span>
<a name="l784"><span class="linenum"> 784</span></a>  <span class="comment">        //init_list_mode();</span>
<a name="l785"><span class="linenum"> 785</span></a>          break;
<a name="l786"><span class="linenum"> 786</span></a>  
<a name="l787"><span class="linenum"> 787</span></a>  
<a name="l788"><span class="linenum"> 788</span></a>      case 'update_edit':
<a name="l789"><span class="linenum"> 789</span></a>      case 'update':
<a name="l790"><span class="linenum"> 790</span></a>      case 'update_publish':
<a name="l791"><span class="linenum"> 791</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l792"><span class="linenum"> 792</span></a>          <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'item' );
<a name="l793"><span class="linenum"> 793</span></a>  
<a name="l794"><span class="linenum"> 794</span></a>  <span class="comment">        // Check edit permission:</span>
<a name="l795"><span class="linenum"> 795</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'item_post!CURSTATUS', 'edit', true, <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> );
<a name="l796"><span class="linenum"> 796</span></a>  
<a name="l797"><span class="linenum"> 797</span></a>  <span class="comment">        // We need early decoding of these in order to check permissions:</span>
<a name="l798"><span class="linenum"> 798</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'post_status', 'string', 'published' );
<a name="l799"><span class="linenum"> 799</span></a>  
<a name="l800"><span class="linenum"> 800</span></a>          if( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> == 'update_publish' )
<a name="l801"><span class="linenum"> 801</span></a>          { // load publish status from param, because a post can be published to many status
<a name="l802"><span class="linenum"> 802</span></a>              <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('post_status')" href="../../../_variables/post_status.html">$post_status</a> = <a class="function" onClick="logFunction('load_publish_status')" href="../../../_functions/load_publish_status.html" onMouseOver="funcPopup(event,'load_publish_status')">load_publish_status</a>();
<a name="l803"><span class="linenum"> 803</span></a>          }
<a name="l804"><span class="linenum"> 804</span></a>  
<a name="l805"><span class="linenum"> 805</span></a>  <span class="comment">        // Check if new category was started to create.  If yes check if it is valid.</span>
<a name="l806"><span class="linenum"> 806</span></a>          <a class="var it6490" onMouseOver="hilite(6490)" onMouseOut="lolite()" onClick="logVariable('isset_category')" href="../../../_variables/isset_category.html">$isset_category</a> = <a class="function" onClick="logFunction('check_categories')" href="../../../_functions/check_categories.html" onMouseOver="funcPopup(event,'check_categories')">check_categories</a>( <a class="var it28" onMouseOver="hilite(28)" onMouseOut="lolite()" onClick="logVariable('post_category')" href="../../../_variables/post_category.html">$post_category</a>, <a class="var it29" onMouseOver="hilite(29)" onMouseOut="lolite()" onClick="logVariable('post_extracats')" href="../../../_variables/post_extracats.html">$post_extracats</a> );
<a name="l807"><span class="linenum"> 807</span></a>  
<a name="l808"><span class="linenum"> 808</span></a>  <span class="comment">        // Check permission on statuses:</span>
<a name="l809"><span class="linenum"> 809</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'cats_post!'.<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('post_status')" href="../../../_variables/post_status.html">$post_status</a>, 'edit', true, <a class="var it29" onMouseOver="hilite(29)" onMouseOut="lolite()" onClick="logVariable('post_extracats')" href="../../../_variables/post_extracats.html">$post_extracats</a> );
<a name="l810"><span class="linenum"> 810</span></a>  <span class="comment">        // Check permission on post type:</span>
<a name="l811"><span class="linenum"> 811</span></a>          <a class="function" onClick="logFunction('check_perm_posttype')" href="../../../_functions/check_perm_posttype.html" onMouseOver="funcPopup(event,'check_perm_posttype')">check_perm_posttype</a>( <a class="var it29" onMouseOver="hilite(29)" onMouseOut="lolite()" onClick="logVariable('post_extracats')" href="../../../_variables/post_extracats.html">$post_extracats</a> );
<a name="l812"><span class="linenum"> 812</span></a>  
<a name="l813"><span class="linenum"> 813</span></a>  <span class="comment">        // Is this post already published?</span>
<a name="l814"><span class="linenum"> 814</span></a>          <a class="var it6443" onMouseOver="hilite(6443)" onMouseOut="lolite()" onClick="logVariable('was_published')" href="../../../_variables/was_published.html">$was_published</a> = <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('status')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/status.html">status</a> == 'published';
<a name="l815"><span class="linenum"> 815</span></a>  
<a name="l816"><span class="linenum"> 816</span></a>  <span class="comment">        // UPDATE POST:</span>
<a name="l817"><span class="linenum"> 817</span></a>  <span class="comment">        // Set the params we already got:</span>
<a name="l818"><span class="linenum"> 818</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'status', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('post_status')" href="../../../_variables/post_status.html">$post_status</a> );
<a name="l819"><span class="linenum"> 819</span></a>  
<a name="l820"><span class="linenum"> 820</span></a>          if( <a class="var it6490" onMouseOver="hilite(6490)" onMouseOut="lolite()" onClick="logVariable('isset_category')" href="../../../_variables/isset_category.html">$isset_category</a> )
<a name="l821"><span class="linenum"> 821</span></a>          { // we change the categories only if the check was succesfull
<a name="l822"><span class="linenum"> 822</span></a>              <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'main_cat_ID', <a class="var it28" onMouseOver="hilite(28)" onMouseOut="lolite()" onClick="logVariable('post_category')" href="../../../_variables/post_category.html">$post_category</a> );
<a name="l823"><span class="linenum"> 823</span></a>              <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'extra_cat_IDs', <a class="var it29" onMouseOver="hilite(29)" onMouseOut="lolite()" onClick="logVariable('post_extracats')" href="../../../_variables/post_extracats.html">$post_extracats</a> );
<a name="l824"><span class="linenum"> 824</span></a>          }
<a name="l825"><span class="linenum"> 825</span></a>  
<a name="l826"><span class="linenum"> 826</span></a>  <span class="comment">        // Set object params:</span>
<a name="l827"><span class="linenum"> 827</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('load_from_Request')" href="../../../_functions/load_from_request.html" onMouseOver="funcPopup(event,'load_from_request')">load_from_Request</a>( false );
<a name="l828"><span class="linenum"> 828</span></a>  
<a name="l829"><span class="linenum"> 829</span></a>  <span class="comment">        // Check and clear inline images, to avoid to have placeholders without corresponding attachment</span>
<a name="l830"><span class="linenum"> 830</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('check_and_clear_inline_images')" href="../../../_functions/check_and_clear_inline_images.html" onMouseOver="funcPopup(event,'check_and_clear_inline_images')">check_and_clear_inline_images</a>();
<a name="l831"><span class="linenum"> 831</span></a>  
<a name="l832"><span class="linenum"> 832</span></a>          <a class="var it16" onMouseOver="hilite(16)" onMouseOut="lolite()" onClick="logVariable('Plugins')" href="../../../_variables/Plugins.html">$Plugins</a>-&gt;<a class="function" onClick="logFunction('trigger_event')" href="../../../_functions/trigger_event.html" onMouseOver="funcPopup(event,'trigger_event')">trigger_event</a>( 'AdminBeforeItemEditUpdate', array( 'Item' =&gt; &amp; <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> ) );
<a name="l833"><span class="linenum"> 833</span></a>  
<a name="l834"><span class="linenum"> 834</span></a>  <span class="comment">        // Params we need for tab switching (in case of error or if we save&amp;edit)</span>
<a name="l835"><span class="linenum"> 835</span></a>          <a class="var it6485" onMouseOver="hilite(6485)" onMouseOut="lolite()" onClick="logVariable('tab_switch_params')" href="../../../_variables/tab_switch_params.html">$tab_switch_params</a> = 'p='.<a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>;
<a name="l836"><span class="linenum"> 836</span></a>  
<a name="l837"><span class="linenum"> 837</span></a>          if( <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('has_errors')" href="../../../_functions/has_errors.html" onMouseOver="funcPopup(event,'has_errors')">has_errors</a>() )
<a name="l838"><span class="linenum"> 838</span></a>          {    // There have been some validation errors:
<a name="l839"><span class="linenum"> 839</span></a>              break;
<a name="l840"><span class="linenum"> 840</span></a>          }
<a name="l841"><span class="linenum"> 841</span></a>  
<a name="l842"><span class="linenum"> 842</span></a>  <span class="comment">        // UPDATE POST IN DB:</span>
<a name="l843"><span class="linenum"> 843</span></a>          if( !<a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('dbupdate')" href="../../../_functions/dbupdate.html" onMouseOver="funcPopup(event,'dbupdate')">dbupdate</a>() )
<a name="l844"><span class="linenum"> 844</span></a>          { // Could not update successful
<a name="l845"><span class="linenum"> 845</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The post couldn\'t be updated.'), 'error' );
<a name="l846"><span class="linenum"> 846</span></a>              break;
<a name="l847"><span class="linenum"> 847</span></a>          }
<a name="l848"><span class="linenum"> 848</span></a>  
<a name="l849"><span class="linenum"> 849</span></a>  <span class="comment">        // post post-publishing operations:</span>
<a name="l850"><span class="linenum"> 850</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'trackback_url', 'string' );
<a name="l851"><span class="linenum"> 851</span></a>          if( !empty( <a class="var it977" onMouseOver="hilite(977)" onMouseOut="lolite()" onClick="logVariable('trackback_url')" href="../../../_variables/trackback_url.html">$trackback_url</a> ) )
<a name="l852"><span class="linenum"> 852</span></a>          {
<a name="l853"><span class="linenum"> 853</span></a>              if( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('status')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/status.html">status</a> != 'published' )
<a name="l854"><span class="linenum"> 854</span></a>              {
<a name="l855"><span class="linenum"> 855</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Post not publicly published: skipping trackback...'), 'note' );
<a name="l856"><span class="linenum"> 856</span></a>              }
<a name="l857"><span class="linenum"> 857</span></a>              else
<a name="l858"><span class="linenum"> 858</span></a>              { // trackback now:
<a name="l859"><span class="linenum"> 859</span></a>                  <a class="function" onClick="logFunction('load_funcs')" href="../../../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>('comments/_trackback.funcs.php');
<a name="l860"><span class="linenum"> 860</span></a>                  <a class="function" onClick="logFunction('trackbacks')" href="../../../_functions/trackbacks.html" onMouseOver="funcPopup(event,'trackbacks')">trackbacks</a>( <a class="var it977" onMouseOver="hilite(977)" onMouseOut="lolite()" onClick="logVariable('trackback_url')" href="../../../_variables/trackback_url.html">$trackback_url</a>, <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> );
<a name="l861"><span class="linenum"> 861</span></a>              }
<a name="l862"><span class="linenum"> 862</span></a>          }
<a name="l863"><span class="linenum"> 863</span></a>  
<a name="l864"><span class="linenum"> 864</span></a>  <span class="comment">        // Execute or schedule notifications &amp; pings:</span>
<a name="l865"><span class="linenum"> 865</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('handle_post_processing')" href="../../../_functions/handle_post_processing.html" onMouseOver="funcPopup(event,'handle_post_processing')">handle_post_processing</a>( false, <a class="var it6477" onMouseOver="hilite(6477)" onMouseOut="lolite()" onClick="logVariable('exit_after_save')" href="../../../_variables/exit_after_save.html">$exit_after_save</a> );
<a name="l866"><span class="linenum"> 866</span></a>  
<a name="l867"><span class="linenum"> 867</span></a>          <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Post has been updated.'), 'success' );
<a name="l868"><span class="linenum"> 868</span></a>  
<a name="l869"><span class="linenum"> 869</span></a>          if( ! <a class="var it6477" onMouseOver="hilite(6477)" onMouseOut="lolite()" onClick="logVariable('exit_after_save')" href="../../../_variables/exit_after_save.html">$exit_after_save</a> )
<a name="l870"><span class="linenum"> 870</span></a>          { // We want to continue editing...
<a name="l871"><span class="linenum"> 871</span></a>              break;
<a name="l872"><span class="linenum"> 872</span></a>          }
<a name="l873"><span class="linenum"> 873</span></a>  
<a name="l874"><span class="linenum"> 874</span></a>          <span class="comment">/* fp&gt; I noticed that after publishing a new post, I always want</span>
<a name="l875"><span class="linenum"> 875</span></a>  <span class="comment">         *     to see how the blog looks like. If anyone doesn't want that,</span>
<a name="l876"><span class="linenum"> 876</span></a>  <span class="comment">         *     we can make this optional...</span>
<a name="l877"><span class="linenum"> 877</span></a>  <span class="comment">         */</span>
<a name="l878"><span class="linenum"> 878</span></a>          if( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('status')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/status.html">status</a> == 'redirected' ||
<a name="l879"><span class="linenum"> 879</span></a>              <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../../_variables/redirect_to.html">$redirect_to</a>, 'tab=tracker' ) ||
<a name="l880"><span class="linenum"> 880</span></a>              <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../../_variables/redirect_to.html">$redirect_to</a>, 'tab=manual' ) )
<a name="l881"><span class="linenum"> 881</span></a>          { // We should show the posts list if:
<a name="l882"><span class="linenum"> 882</span></a>  <span class="comment">            //    a post is in &quot;Redirected&quot; status</span>
<a name="l883"><span class="linenum"> 883</span></a>  <span class="comment">            //    a post is updated from &quot;workflow&quot; or &quot;manual&quot; view tab</span>
<a name="l884"><span class="linenum"> 884</span></a>              <a class="var it6491" onMouseOver="hilite(6491)" onMouseOut="lolite()" onClick="logVariable('blog_redirect_setting')" href="../../../_variables/blog_redirect_setting.html">$blog_redirect_setting</a> = 'no';
<a name="l885"><span class="linenum"> 885</span></a>          }
<a name="l886"><span class="linenum"> 886</span></a>          elseif( ! <a class="var it6443" onMouseOver="hilite(6443)" onMouseOut="lolite()" onClick="logVariable('was_published')" href="../../../_variables/was_published.html">$was_published</a> &amp;&amp; <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('status')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/status.html">status</a> == 'published' )
<a name="l887"><span class="linenum"> 887</span></a>          { // The post's last status wasn't &quot;published&quot;, but we're going to publish it now.
<a name="l888"><span class="linenum"> 888</span></a>              <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('load_Blog')" href="../../../_functions/load_blog.html" onMouseOver="funcPopup(event,'load_blog')">load_Blog</a>();
<a name="l889"><span class="linenum"> 889</span></a>              <a class="var it6491" onMouseOver="hilite(6491)" onMouseOut="lolite()" onClick="logVariable('blog_redirect_setting')" href="../../../_variables/blog_redirect_setting.html">$blog_redirect_setting</a> = <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('Blog')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/Blog.html">Blog</a>-&gt;<a class="function" onClick="logFunction('get_setting')" href="../../../_functions/get_setting.html" onMouseOver="funcPopup(event,'get_setting')">get_setting</a>( 'enable_goto_blog' );
<a name="l890"><span class="linenum"> 890</span></a>          }
<a name="l891"><span class="linenum"> 891</span></a>          else
<a name="l892"><span class="linenum"> 892</span></a>          { // The post was changed
<a name="l893"><span class="linenum"> 893</span></a>              <a class="var it6491" onMouseOver="hilite(6491)" onMouseOut="lolite()" onClick="logVariable('blog_redirect_setting')" href="../../../_variables/blog_redirect_setting.html">$blog_redirect_setting</a> = <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('Blog')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/Blog.html">Blog</a>-&gt;<a class="function" onClick="logFunction('get_setting')" href="../../../_functions/get_setting.html" onMouseOver="funcPopup(event,'get_setting')">get_setting</a>( 'editing_goto_blog' );
<a name="l894"><span class="linenum"> 894</span></a>          }
<a name="l895"><span class="linenum"> 895</span></a>  
<a name="l896"><span class="linenum"> 896</span></a>          if( <a class="var it6491" onMouseOver="hilite(6491)" onMouseOut="lolite()" onClick="logVariable('blog_redirect_setting')" href="../../../_variables/blog_redirect_setting.html">$blog_redirect_setting</a> == 'blog' )
<a name="l897"><span class="linenum"> 897</span></a>          { // go to blog:
<a name="l898"><span class="linenum"> 898</span></a>              <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('load_Blog')" href="../../../_functions/load_blog.html" onMouseOver="funcPopup(event,'load_blog')">load_Blog</a>();
<a name="l899"><span class="linenum"> 899</span></a>              <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../../_variables/redirect_to.html">$redirect_to</a> = <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('Blog')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/Blog.html">Blog</a>-&gt;<a class="function" onClick="logFunction('gen_blogurl')" href="../../../_functions/gen_blogurl.html" onMouseOver="funcPopup(event,'gen_blogurl')">gen_blogurl</a>();
<a name="l900"><span class="linenum"> 900</span></a>          }
<a name="l901"><span class="linenum"> 901</span></a>          elseif( <a class="var it6491" onMouseOver="hilite(6491)" onMouseOut="lolite()" onClick="logVariable('blog_redirect_setting')" href="../../../_variables/blog_redirect_setting.html">$blog_redirect_setting</a> == 'post' )
<a name="l902"><span class="linenum"> 902</span></a>          { // redirect to post page:
<a name="l903"><span class="linenum"> 903</span></a>              <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../../_variables/redirect_to.html">$redirect_to</a> = <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('get_permanent_url')" href="../../../_functions/get_permanent_url.html" onMouseOver="funcPopup(event,'get_permanent_url')">get_permanent_url</a>();
<a name="l904"><span class="linenum"> 904</span></a>          }
<a name="l905"><span class="linenum"> 905</span></a>          else// <a class="var it6491" onMouseOver="hilite(6491)" onMouseOut="lolite()" onClick="logVariable('blog_redirect_setting')" href="../../../_variables/blog_redirect_setting.html">$blog_redirect_setting</a> == 'no'
<a name="l906"><span class="linenum"> 906</span></a>          { // redirect to posts list
<a name="l907"><span class="linenum"> 907</span></a>  <span class="comment">            // Set highlight</span>
<a name="l908"><span class="linenum"> 908</span></a>              <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'highlight_id', <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> );
<a name="l909"><span class="linenum"> 909</span></a>              <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( <a class="function" onClick="logFunction('regenerate_url')" href="../../../_functions/regenerate_url.html" onMouseOver="funcPopup(event,'regenerate_url')">regenerate_url</a>( '', '&amp;highlight='.<a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, '', '&amp;' ) );
<a name="l910"><span class="linenum"> 910</span></a>          }
<a name="l911"><span class="linenum"> 911</span></a>  
<a name="l912"><span class="linenum"> 912</span></a>  
<a name="l913"><span class="linenum"> 913</span></a>  <span class="comment">        // REDIRECT / EXIT</span>
<a name="l914"><span class="linenum"> 914</span></a>          <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../../_variables/redirect_to.html">$redirect_to</a>, 303 );
<a name="l915"><span class="linenum"> 915</span></a>  <span class="comment">        /* EXITED */</span>
<a name="l916"><span class="linenum"> 916</span></a>          break;
<a name="l917"><span class="linenum"> 917</span></a>  
<a name="l918"><span class="linenum"> 918</span></a>      case 'mass_save' :
<a name="l919"><span class="linenum"> 919</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l920"><span class="linenum"> 920</span></a>          <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a onClick="logVariable('assert_received_crumb')" class="var it9059" onMouseOver="hilite(9059)" onMouseOut="lolite()" href="../../../_variables/assert_received_crumb.html">assert_received_crumb</a> ( 'item' );
<a name="l921"><span class="linenum"> 921</span></a>  
<a name="l922"><span class="linenum"> 922</span></a>          <a class="function" onClick="logFunction('init_list_mode')" href="../../../_functions/init_list_mode.html" onMouseOver="funcPopup(event,'init_list_mode')">init_list_mode</a> ();
<a name="l923"><span class="linenum"> 923</span></a>          <a class="var it652" onMouseOver="hilite(652)" onMouseOut="lolite()" onClick="logVariable('ItemList')" href="../../../_variables/ItemList.html">$ItemList</a>-&gt;<a onClick="logVariable('query')" class="var it9000" onMouseOver="hilite(9000)" onMouseOut="lolite()" href="../../../_variables/query.html">query</a> ();
<a name="l924"><span class="linenum"> 924</span></a>  
<a name="l925"><span class="linenum"> 925</span></a>          global <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l926"><span class="linenum"> 926</span></a>  
<a name="l927"><span class="linenum"> 927</span></a>          <a class="var it6493" onMouseOver="hilite(6493)" onMouseOut="lolite()" onClick="logVariable('update_nr')" href="../../../_variables/update_nr.html">$update_nr</a> = 0;
<a name="l928"><span class="linenum"> 928</span></a>  
<a name="l929"><span class="linenum"> 929</span></a>          while ( <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('Item')" href="../../../_variables/Item.html">$Item</a> = &amp; <a class="var it652" onMouseOver="hilite(652)" onMouseOut="lolite()" onClick="logVariable('ItemList')" href="../../../_variables/ItemList.html">$ItemList</a>-&gt;<a onClick="logVariable('get_item')" class="var it9000" onMouseOver="hilite(9000)" onMouseOut="lolite()" href="../../../_variables/get_item.html">get_item</a> () )
<a name="l930"><span class="linenum"> 930</span></a>          {    // check user permission
<a name="l931"><span class="linenum"> 931</span></a>              <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'item_post!CURSTATUS', 'edit', true, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('Item')" href="../../../_variables/Item.html">$Item</a> );
<a name="l932"><span class="linenum"> 932</span></a>  
<a name="l933"><span class="linenum"> 933</span></a>  <span class="comment">            // Not allow html content on post titles</span>
<a name="l934"><span class="linenum"> 934</span></a>              <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a> ( 'mass_title_' . <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('Item')" href="../../../_variables/Item.html">$Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8969" onMouseOver="hilite(8969)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, 'htmlspecialchars', NULL );
<a name="l935"><span class="linenum"> 935</span></a>              <a class="var it974" onMouseOver="hilite(974)" onMouseOut="lolite()" onClick="logVariable('urltitle')" href="../../../_variables/urltitle.html">$urltitle</a> = <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a> ( 'mass_urltitle_' . <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('Item')" href="../../../_variables/Item.html">$Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8969" onMouseOver="hilite(8969)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, 'string', NULL );
<a name="l936"><span class="linenum"> 936</span></a>              <a class="var it6495" onMouseOver="hilite(6495)" onMouseOut="lolite()" onClick="logVariable('titletag')" href="../../../_variables/titletag.html">$titletag</a> = <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a> ( 'mass_titletag_' . <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('Item')" href="../../../_variables/Item.html">$Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8969" onMouseOver="hilite(8969)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, 'string', NULL );
<a name="l937"><span class="linenum"> 937</span></a>  
<a name="l938"><span class="linenum"> 938</span></a>              if (<a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> != NULL)
<a name="l939"><span class="linenum"> 939</span></a>              {
<a name="l940"><span class="linenum"> 940</span></a>                  <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('Item')" href="../../../_variables/Item.html">$Item</a>-&gt;<a onClick="logVariable('set')" class="var it8969" onMouseOver="hilite(8969)" onMouseOut="lolite()" href="../../../_variables/set.html">set</a> ( 'title', <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> );
<a name="l941"><span class="linenum"> 941</span></a>              }
<a name="l942"><span class="linenum"> 942</span></a>  
<a name="l943"><span class="linenum"> 943</span></a>              if (<a class="var it974" onMouseOver="hilite(974)" onMouseOut="lolite()" onClick="logVariable('urltitle')" href="../../../_variables/urltitle.html">$urltitle</a> != NULL)
<a name="l944"><span class="linenum"> 944</span></a>              {
<a name="l945"><span class="linenum"> 945</span></a>                  <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('Item')" href="../../../_variables/Item.html">$Item</a>-&gt;<a onClick="logVariable('set')" class="var it8969" onMouseOver="hilite(8969)" onMouseOut="lolite()" href="../../../_variables/set.html">set</a> ( 'urltitle', <a class="var it974" onMouseOver="hilite(974)" onMouseOut="lolite()" onClick="logVariable('urltitle')" href="../../../_variables/urltitle.html">$urltitle</a> );
<a name="l946"><span class="linenum"> 946</span></a>              }
<a name="l947"><span class="linenum"> 947</span></a>  
<a name="l948"><span class="linenum"> 948</span></a>              if (<a class="var it6495" onMouseOver="hilite(6495)" onMouseOut="lolite()" onClick="logVariable('titletag')" href="../../../_variables/titletag.html">$titletag</a> != NULL)
<a name="l949"><span class="linenum"> 949</span></a>              {
<a name="l950"><span class="linenum"> 950</span></a>                  <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('Item')" href="../../../_variables/Item.html">$Item</a>-&gt;<a onClick="logVariable('set')" class="var it8969" onMouseOver="hilite(8969)" onMouseOut="lolite()" href="../../../_variables/set.html">set</a> ( 'titletag', <a class="var it6495" onMouseOver="hilite(6495)" onMouseOut="lolite()" onClick="logVariable('titletag')" href="../../../_variables/titletag.html">$titletag</a> );
<a name="l951"><span class="linenum"> 951</span></a>              }
<a name="l952"><span class="linenum"> 952</span></a>  
<a name="l953"><span class="linenum"> 953</span></a>              if( <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('Item')" href="../../../_variables/Item.html">$Item</a>-&gt;<a onClick="logVariable('dbupdate')" class="var it8969" onMouseOver="hilite(8969)" onMouseOut="lolite()" href="../../../_variables/dbupdate.html">dbupdate</a> ())
<a name="l954"><span class="linenum"> 954</span></a>              {
<a name="l955"><span class="linenum"> 955</span></a>                  <a class="var it6493" onMouseOver="hilite(6493)" onMouseOut="lolite()" onClick="logVariable('update_nr')" href="../../../_variables/update_nr.html">$update_nr</a>++;    <span class="comment">// successfully updated post number</span>
<a name="l956"><span class="linenum"> 956</span></a>              }
<a name="l957"><span class="linenum"> 957</span></a>          }
<a name="l958"><span class="linenum"> 958</span></a>  
<a name="l959"><span class="linenum"> 959</span></a>          if( <a class="var it6493" onMouseOver="hilite(6493)" onMouseOut="lolite()" onClick="logVariable('update_nr')" href="../../../_variables/update_nr.html">$update_nr</a> &gt; 0 )
<a name="l960"><span class="linenum"> 960</span></a>          {
<a name="l961"><span class="linenum"> 961</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="var it6493" onMouseOver="hilite(6493)" onMouseOut="lolite()" onClick="logVariable('update_nr')" href="../../../_variables/update_nr.html">$update_nr</a> == 1 ?
<a name="l962"><span class="linenum"> 962</span></a>                  <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('One post has been updated!') :
<a name="l963"><span class="linenum"> 963</span></a>                  sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('%d posts have been updated!'), <a class="var it6493" onMouseOver="hilite(6493)" onMouseOut="lolite()" onClick="logVariable('update_nr')" href="../../../_variables/update_nr.html">$update_nr</a> ), 'success' );
<a name="l964"><span class="linenum"> 964</span></a>          }
<a name="l965"><span class="linenum"> 965</span></a>          else
<a name="l966"><span class="linenum"> 966</span></a>          {
<a name="l967"><span class="linenum"> 967</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('No update executed!') );
<a name="l968"><span class="linenum"> 968</span></a>          }
<a name="l969"><span class="linenum"> 969</span></a>  <span class="comment">        // REDIRECT / EXIT</span>
<a name="l970"><span class="linenum"> 970</span></a>          <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a> ( <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../../_variables/redirect_to.html">$redirect_to</a>, 303 );
<a name="l971"><span class="linenum"> 971</span></a>  <span class="comment">        /* EXITED */</span>
<a name="l972"><span class="linenum"> 972</span></a>          break;
<a name="l973"><span class="linenum"> 973</span></a>  
<a name="l974"><span class="linenum"> 974</span></a>      case 'publish' :
<a name="l975"><span class="linenum"> 975</span></a>      case 'publish_now' :
<a name="l976"><span class="linenum"> 976</span></a>  <span class="comment">        // Publish NOW:</span>
<a name="l977"><span class="linenum"> 977</span></a>  
<a name="l978"><span class="linenum"> 978</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l979"><span class="linenum"> 979</span></a>          <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'item' );
<a name="l980"><span class="linenum"> 980</span></a>  
<a name="l981"><span class="linenum"> 981</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('post_status')" href="../../../_variables/post_status.html">$post_status</a> = ( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> == 'publish_now' ) ? 'published' : <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'post_status', 'string', 'published' );
<a name="l982"><span class="linenum"> 982</span></a>  <span class="comment">        // Check permissions:</span>
<a name="l983"><span class="linenum"> 983</span></a>  <span class="comment">        /* TODO: Check extra categories!!! */</span>
<a name="l984"><span class="linenum"> 984</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'item_post!'.<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('post_status')" href="../../../_variables/post_status.html">$post_status</a>, 'edit', true, <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> );
<a name="l985"><span class="linenum"> 985</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'status', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('post_status')" href="../../../_variables/post_status.html">$post_status</a> );
<a name="l986"><span class="linenum"> 986</span></a>  
<a name="l987"><span class="linenum"> 987</span></a>          if( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> == 'publish_now' )
<a name="l988"><span class="linenum"> 988</span></a>          { // Update post dates
<a name="l989"><span class="linenum"> 989</span></a>              <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'blog_edit_ts', 'edit', true, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a onClick="logVariable('ID')" class="var it8952" onMouseOver="hilite(8952)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> );
<a name="l990"><span class="linenum"> 990</span></a>  <span class="comment">            // fp&gt; TODO: remove seconds ONLY if date is in the future</span>
<a name="l991"><span class="linenum"> 991</span></a>              <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'datestart', <a class="function" onClick="logFunction('remove_seconds')" href="../../../_functions/remove_seconds.html" onMouseOver="funcPopup(event,'remove_seconds')">remove_seconds</a>(<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('localtimenow')" href="../../../_variables/localtimenow.html">$localtimenow</a>) );
<a name="l992"><span class="linenum"> 992</span></a>              <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'datemodified', <a class="phpfunction" onClick="logFunction('date')" href="../../../_functions/date.html" onMouseOver="phpfuncPopup(event,'date')">date</a>('Y-m-d H:i:s', <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('localtimenow')" href="../../../_variables/localtimenow.html">$localtimenow</a>) );
<a name="l993"><span class="linenum"> 993</span></a>          }
<a name="l994"><span class="linenum"> 994</span></a>  
<a name="l995"><span class="linenum"> 995</span></a>  <span class="comment">        // UPDATE POST IN DB:</span>
<a name="l996"><span class="linenum"> 996</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('dbupdate')" href="../../../_functions/dbupdate.html" onMouseOver="funcPopup(event,'dbupdate')">dbupdate</a>();
<a name="l997"><span class="linenum"> 997</span></a>  
<a name="l998"><span class="linenum"> 998</span></a>  <span class="comment">        // Execute or schedule notifications &amp; pings:</span>
<a name="l999"><span class="linenum"> 999</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('handle_post_processing')" href="../../../_functions/handle_post_processing.html" onMouseOver="funcPopup(event,'handle_post_processing')">handle_post_processing</a>( false );
<a name="l1000"><span class="linenum">1000</span></a>  
<a name="l1001"><span class="linenum">1001</span></a>  <span class="comment">        // Set the success message corresponding for the new status</span>
<a name="l1002"><span class="linenum">1002</span></a>          switch( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('status')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/status.html">status</a> )
<a name="l1003"><span class="linenum">1003</span></a>          {
<a name="l1004"><span class="linenum">1004</span></a>              case 'published':
<a name="l1005"><span class="linenum">1005</span></a>                  <a class="var it3995" onMouseOver="hilite(3995)" onMouseOut="lolite()" onClick="logVariable('success_message')" href="../../../_variables/success_message.html">$success_message</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Post has been published.');
<a name="l1006"><span class="linenum">1006</span></a>                  break;
<a name="l1007"><span class="linenum">1007</span></a>              case 'community':
<a name="l1008"><span class="linenum">1008</span></a>                  <a class="var it3995" onMouseOver="hilite(3995)" onMouseOut="lolite()" onClick="logVariable('success_message')" href="../../../_variables/success_message.html">$success_message</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The post is now visible by the community.');
<a name="l1009"><span class="linenum">1009</span></a>                  break;
<a name="l1010"><span class="linenum">1010</span></a>              case 'protected':
<a name="l1011"><span class="linenum">1011</span></a>                  <a class="var it3995" onMouseOver="hilite(3995)" onMouseOut="lolite()" onClick="logVariable('success_message')" href="../../../_variables/success_message.html">$success_message</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The post is now visible by the members.');
<a name="l1012"><span class="linenum">1012</span></a>                  break;
<a name="l1013"><span class="linenum">1013</span></a>              case 'review':
<a name="l1014"><span class="linenum">1014</span></a>                  <a class="var it3995" onMouseOver="hilite(3995)" onMouseOut="lolite()" onClick="logVariable('success_message')" href="../../../_variables/success_message.html">$success_message</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The post is now visible by moderators.');
<a name="l1015"><span class="linenum">1015</span></a>                  break;
<a name="l1016"><span class="linenum">1016</span></a>              default:
<a name="l1017"><span class="linenum">1017</span></a>                  <a class="var it3995" onMouseOver="hilite(3995)" onMouseOut="lolite()" onClick="logVariable('success_message')" href="../../../_variables/success_message.html">$success_message</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Post has been updated.');
<a name="l1018"><span class="linenum">1018</span></a>                  break;
<a name="l1019"><span class="linenum">1019</span></a>          }
<a name="l1020"><span class="linenum">1020</span></a>          <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="var it3995" onMouseOver="hilite(3995)" onMouseOut="lolite()" onClick="logVariable('success_message')" href="../../../_variables/success_message.html">$success_message</a>, 'success' );
<a name="l1021"><span class="linenum">1021</span></a>  
<a name="l1022"><span class="linenum">1022</span></a>  <span class="comment">        // fp&gt; I noticed that after publishing a new post, I always want to see how the blog looks like</span>
<a name="l1023"><span class="linenum">1023</span></a>  <span class="comment">        // If anyone doesn't want that, we can make this optional...</span>
<a name="l1024"><span class="linenum">1024</span></a>  
<a name="l1025"><span class="linenum">1025</span></a>  <span class="comment">        // REDIRECT / EXIT</span>
<a name="l1026"><span class="linenum">1026</span></a>          if( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> == 'publish' &amp;&amp; !empty( <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../../_variables/redirect_to.html">$redirect_to</a> ) &amp;&amp; ( <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../../_variables/redirect_to.html">$redirect_to</a>, <a class="var it346" onMouseOver="hilite(346)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../../_variables/admin_url.html">$admin_url</a> ) !== 0 ) )
<a name="l1027"><span class="linenum">1027</span></a>          { // We clicked publish button from the front office
<a name="l1028"><span class="linenum">1028</span></a>              <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../../_variables/redirect_to.html">$redirect_to</a> );
<a name="l1029"><span class="linenum">1029</span></a>          }
<a name="l1030"><span class="linenum">1030</span></a>          elseif( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('Blog')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/Blog.html">Blog</a>-&gt;<a class="function" onClick="logFunction('get_setting')" href="../../../_functions/get_setting.html" onMouseOver="funcPopup(event,'get_setting')">get_setting</a>( 'enable_goto_blog' ) == 'blog' )
<a name="l1031"><span class="linenum">1031</span></a>          {    // Redirect to blog:
<a name="l1032"><span class="linenum">1032</span></a>              <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('load_Blog')" href="../../../_functions/load_blog.html" onMouseOver="funcPopup(event,'load_blog')">load_Blog</a>();
<a name="l1033"><span class="linenum">1033</span></a>              <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('Blog')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/Blog.html">Blog</a>-&gt;<a class="function" onClick="logFunction('gen_blogurl')" href="../../../_functions/gen_blogurl.html" onMouseOver="funcPopup(event,'gen_blogurl')">gen_blogurl</a>() );
<a name="l1034"><span class="linenum">1034</span></a>          }
<a name="l1035"><span class="linenum">1035</span></a>          elseif( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('Blog')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/Blog.html">Blog</a>-&gt;<a class="function" onClick="logFunction('get_setting')" href="../../../_functions/get_setting.html" onMouseOver="funcPopup(event,'get_setting')">get_setting</a>( 'enable_goto_blog' ) == 'post' )
<a name="l1036"><span class="linenum">1036</span></a>          {    // Redirect to post page:
<a name="l1037"><span class="linenum">1037</span></a>              <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('get_permanent_url')" href="../../../_functions/get_permanent_url.html" onMouseOver="funcPopup(event,'get_permanent_url')">get_permanent_url</a>() );
<a name="l1038"><span class="linenum">1038</span></a>          }
<a name="l1039"><span class="linenum">1039</span></a>          else// 'no'
<a name="l1040"><span class="linenum">1040</span></a>          {    // Redirect to posts list:
<a name="l1041"><span class="linenum">1041</span></a>              <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( <a class="function" onClick="logFunction('regenerate_url')" href="../../../_functions/regenerate_url.html" onMouseOver="funcPopup(event,'regenerate_url')">regenerate_url</a>( '', '&amp;highlight='.<a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, '', '&amp;' ) );
<a name="l1042"><span class="linenum">1042</span></a>          }
<a name="l1043"><span class="linenum">1043</span></a>  <span class="comment">        // Switch to list mode:</span>
<a name="l1044"><span class="linenum">1044</span></a>  <span class="comment">        // $action = 'list';</span>
<a name="l1045"><span class="linenum">1045</span></a>  <span class="comment">        // init_list_mode();</span>
<a name="l1046"><span class="linenum">1046</span></a>          break;
<a name="l1047"><span class="linenum">1047</span></a>  
<a name="l1048"><span class="linenum">1048</span></a>      case 'restrict':
<a name="l1049"><span class="linenum">1049</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l1050"><span class="linenum">1050</span></a>          <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'item' );
<a name="l1051"><span class="linenum">1051</span></a>  
<a name="l1052"><span class="linenum">1052</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('post_status')" href="../../../_variables/post_status.html">$post_status</a> = <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'post_status', 'string', true );
<a name="l1053"><span class="linenum">1053</span></a>  <span class="comment">        // Check permissions:</span>
<a name="l1054"><span class="linenum">1054</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'item_post!'.<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('post_status')" href="../../../_variables/post_status.html">$post_status</a>, 'moderate', true, <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> );
<a name="l1055"><span class="linenum">1055</span></a>  
<a name="l1056"><span class="linenum">1056</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'status', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('post_status')" href="../../../_variables/post_status.html">$post_status</a> );
<a name="l1057"><span class="linenum">1057</span></a>  
<a name="l1058"><span class="linenum">1058</span></a>  <span class="comment">        // UPDATE POST IN DB:</span>
<a name="l1059"><span class="linenum">1059</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('dbupdate')" href="../../../_functions/dbupdate.html" onMouseOver="funcPopup(event,'dbupdate')">dbupdate</a>();
<a name="l1060"><span class="linenum">1060</span></a>  
<a name="l1061"><span class="linenum">1061</span></a>          <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Post has been restricted.'), 'success' );
<a name="l1062"><span class="linenum">1062</span></a>  
<a name="l1063"><span class="linenum">1063</span></a>  <span class="comment">        // REDIRECT / EXIT</span>
<a name="l1064"><span class="linenum">1064</span></a>          <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../../_variables/redirect_to.html">$redirect_to</a> );
<a name="l1065"><span class="linenum">1065</span></a>          break;
<a name="l1066"><span class="linenum">1066</span></a>  
<a name="l1067"><span class="linenum">1067</span></a>      case 'deprecate':
<a name="l1068"><span class="linenum">1068</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l1069"><span class="linenum">1069</span></a>          <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'item' );
<a name="l1070"><span class="linenum">1070</span></a>  
<a name="l1071"><span class="linenum">1071</span></a>          <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('post_status')" href="../../../_variables/post_status.html">$post_status</a> = 'deprecated';
<a name="l1072"><span class="linenum">1072</span></a>  <span class="comment">        // Check permissions:</span>
<a name="l1073"><span class="linenum">1073</span></a>  <span class="comment">        /* TODO: Check extra categories!!! */</span>
<a name="l1074"><span class="linenum">1074</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'item_post!'.<a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('post_status')" href="../../../_variables/post_status.html">$post_status</a>, 'edit', true, <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> );
<a name="l1075"><span class="linenum">1075</span></a>  
<a name="l1076"><span class="linenum">1076</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'status', <a class="var it20" onMouseOver="hilite(20)" onMouseOut="lolite()" onClick="logVariable('post_status')" href="../../../_variables/post_status.html">$post_status</a> );
<a name="l1077"><span class="linenum">1077</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'datemodified', <a class="phpfunction" onClick="logFunction('date')" href="../../../_functions/date.html" onMouseOver="phpfuncPopup(event,'date')">date</a>('Y-m-d H:i:s',<a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('localtimenow')" href="../../../_variables/localtimenow.html">$localtimenow</a>) );
<a name="l1078"><span class="linenum">1078</span></a>  
<a name="l1079"><span class="linenum">1079</span></a>  <span class="comment">        // UPDATE POST IN DB:</span>
<a name="l1080"><span class="linenum">1080</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('dbupdate')" href="../../../_functions/dbupdate.html" onMouseOver="funcPopup(event,'dbupdate')">dbupdate</a>();
<a name="l1081"><span class="linenum">1081</span></a>  
<a name="l1082"><span class="linenum">1082</span></a>          <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Post has been deprecated.'), 'success' );
<a name="l1083"><span class="linenum">1083</span></a>  
<a name="l1084"><span class="linenum">1084</span></a>  <span class="comment">        // REDIRECT / EXIT</span>
<a name="l1085"><span class="linenum">1085</span></a>          <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../../_variables/redirect_to.html">$redirect_to</a> );
<a name="l1086"><span class="linenum">1086</span></a>  <span class="comment">        // Switch to list mode:</span>
<a name="l1087"><span class="linenum">1087</span></a>  <span class="comment">        // $action = 'list';</span>
<a name="l1088"><span class="linenum">1088</span></a>  <span class="comment">        // init_list_mode();</span>
<a name="l1089"><span class="linenum">1089</span></a>          break;
<a name="l1090"><span class="linenum">1090</span></a>  
<a name="l1091"><span class="linenum">1091</span></a>  
<a name="l1092"><span class="linenum">1092</span></a>      case 'delete':
<a name="l1093"><span class="linenum">1093</span></a>  <span class="comment">        // Delete an Item:</span>
<a name="l1094"><span class="linenum">1094</span></a>  
<a name="l1095"><span class="linenum">1095</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l1096"><span class="linenum">1096</span></a>          <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'item' );
<a name="l1097"><span class="linenum">1097</span></a>  
<a name="l1098"><span class="linenum">1098</span></a>  <span class="comment">        // Check permission:</span>
<a name="l1099"><span class="linenum">1099</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'blog_del_post', '', true, <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a> );
<a name="l1100"><span class="linenum">1100</span></a>  
<a name="l1101"><span class="linenum">1101</span></a>  <span class="comment">        // fp&gt; TODO: non javascript confirmation</span>
<a name="l1102"><span class="linenum">1102</span></a>  <span class="comment">        // $AdminUI-&gt;title = T_('Deleting post...');</span>
<a name="l1103"><span class="linenum">1103</span></a>  
<a name="l1104"><span class="linenum">1104</span></a>          <a class="var it16" onMouseOver="hilite(16)" onMouseOut="lolite()" onClick="logVariable('Plugins')" href="../../../_variables/Plugins.html">$Plugins</a>-&gt;<a class="function" onClick="logFunction('trigger_event')" href="../../../_functions/trigger_event.html" onMouseOver="funcPopup(event,'trigger_event')">trigger_event</a>( 'AdminBeforeItemEditDelete', array( 'Item' =&gt; &amp; <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> ) );
<a name="l1105"><span class="linenum">1105</span></a>  
<a name="l1106"><span class="linenum">1106</span></a>          if( ! <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('has_errors')" href="../../../_functions/has_errors.html" onMouseOver="funcPopup(event,'has_errors')">has_errors</a>() )
<a name="l1107"><span class="linenum">1107</span></a>          {    // There have been no validation errors:
<a name="l1108"><span class="linenum">1108</span></a>  <span class="comment">            // DELETE POST FROM DB:</span>
<a name="l1109"><span class="linenum">1109</span></a>              <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('dbdelete')" href="../../../_functions/dbdelete.html" onMouseOver="funcPopup(event,'dbdelete')">dbdelete</a>();
<a name="l1110"><span class="linenum">1110</span></a>  
<a name="l1111"><span class="linenum">1111</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Post has been deleted.'), 'success' );
<a name="l1112"><span class="linenum">1112</span></a>          }
<a name="l1113"><span class="linenum">1113</span></a>  
<a name="l1114"><span class="linenum">1114</span></a>  <span class="comment">        // REDIRECT / EXIT</span>
<a name="l1115"><span class="linenum">1115</span></a>          <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../../_variables/redirect_to.html">$redirect_to</a> );
<a name="l1116"><span class="linenum">1116</span></a>  <span class="comment">        // Switch to list mode:</span>
<a name="l1117"><span class="linenum">1117</span></a>  <span class="comment">        // $action = 'list';</span>
<a name="l1118"><span class="linenum">1118</span></a>  <span class="comment">        // init_list_mode();</span>
<a name="l1119"><span class="linenum">1119</span></a>          break;
<a name="l1120"><span class="linenum">1120</span></a>  
<a name="l1121"><span class="linenum">1121</span></a>  
<a name="l1122"><span class="linenum">1122</span></a>      case 'mass_edit' :
<a name="l1123"><span class="linenum">1123</span></a>          <a class="function" onClick="logFunction('init_list_mode')" href="../../../_functions/init_list_mode.html" onMouseOver="funcPopup(event,'init_list_mode')">init_list_mode</a> ();
<a name="l1124"><span class="linenum">1124</span></a>          break;
<a name="l1125"><span class="linenum">1125</span></a>  
<a name="l1126"><span class="linenum">1126</span></a>  
<a name="l1127"><span class="linenum">1127</span></a>      case 'list':
<a name="l1128"><span class="linenum">1128</span></a>          <a class="function" onClick="logFunction('init_list_mode')" href="../../../_functions/init_list_mode.html" onMouseOver="funcPopup(event,'init_list_mode')">init_list_mode</a>();
<a name="l1129"><span class="linenum">1129</span></a>  
<a name="l1130"><span class="linenum">1130</span></a>          if( <a class="var it652" onMouseOver="hilite(652)" onMouseOut="lolite()" onClick="logVariable('ItemList')" href="../../../_variables/ItemList.html">$ItemList</a>-&gt;<a onClick="logVariable('single_post')" class="var it9000" onMouseOver="hilite(9000)" onMouseOut="lolite()" href="../../../_variables/single_post.html">single_post</a> )
<a name="l1131"><span class="linenum">1131</span></a>          {    // We have requested to view a SINGLE specific post:
<a name="l1132"><span class="linenum">1132</span></a>              <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'view';
<a name="l1133"><span class="linenum">1133</span></a>          }
<a name="l1134"><span class="linenum">1134</span></a>          break;
<a name="l1135"><span class="linenum">1135</span></a>  
<a name="l1136"><span class="linenum">1136</span></a>      case 'make_posts_pre':
<a name="l1137"><span class="linenum">1137</span></a>  <span class="comment">        // Make posts with selected images action:</span>
<a name="l1138"><span class="linenum">1138</span></a>          break;
<a name="l1139"><span class="linenum">1139</span></a>  
<a name="l1140"><span class="linenum">1140</span></a>      default:
<a name="l1141"><span class="linenum">1141</span></a>          <a class="function" onClick="logFunction('debug_die')" href="../../../_functions/debug_die.html" onMouseOver="funcPopup(event,'debug_die')">debug_die</a>( 'unhandled action 2: '.<a class="function" onClick="logFunction('evo_htmlspecialchars')" href="../../../_functions/evo_htmlspecialchars.html" onMouseOver="funcPopup(event,'evo_htmlspecialchars')">evo_htmlspecialchars</a>(<a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a>) );
<a name="l1142"><span class="linenum">1142</span></a>  }
<a name="l1143"><span class="linenum">1143</span></a>  
<a name="l1144"><span class="linenum">1144</span></a>  
<a name="l1145"><span class="linenum">1145</span></a>  <span class="comment">/**</span>
<a name="l1146"><span class="linenum">1146</span></a>  <span class="comment"> * Initialize list mode; Several actions need this.</span>
<a name="l1147"><span class="linenum">1147</span></a>  <span class="comment"> */</span>
<a name="l1148"><span class="linenum">1148</span></a>  function <a class="function" onClick="logFunction('init_list_mode')" href="../../../_functions/init_list_mode.html" onMouseOver="funcPopup(event,'init_list_mode')">init_list_mode</a>()
<a name="l1149"><span class="linenum">1149</span></a>  {
<a name="l1150"><span class="linenum">1150</span></a>      global <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a>, <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>, <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('UserSettings')" href="../../../_variables/UserSettings.html">$UserSettings</a>, <a class="var it652" onMouseOver="hilite(652)" onMouseOut="lolite()" onClick="logVariable('ItemList')" href="../../../_variables/ItemList.html">$ItemList</a>, <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>, <a class="var it4528" onMouseOver="hilite(4528)" onMouseOut="lolite()" onClick="logVariable('posttypes_perms')" href="../../../_variables/posttypes_perms.html">$posttypes_perms</a>;
<a name="l1151"><span class="linenum">1151</span></a>  
<a name="l1152"><span class="linenum">1152</span></a>  <span class="comment">    // set default itemslist param prefix</span>
<a name="l1153"><span class="linenum">1153</span></a>      <a class="var it6497" onMouseOver="hilite(6497)" onMouseOut="lolite()" onClick="logVariable('items_list_param_prefix')" href="../../../_variables/items_list_param_prefix.html">$items_list_param_prefix</a> = 'items_';
<a name="l1154"><span class="linenum">1154</span></a>  
<a name="l1155"><span class="linenum">1155</span></a>      if ( <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'p', 'integer', NULL ) || <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'title', 'string', NULL ) )
<a name="l1156"><span class="linenum">1156</span></a>      {    // Single post requested, do not filter any post types. If the user
<a name="l1157"><span class="linenum">1157</span></a>  <span class="comment">        // has clicked a post link on the dashboard and previously has selected</span>
<a name="l1158"><span class="linenum">1158</span></a>  <span class="comment">        // a tab which would filter this post, it wouldn't be displayed now.</span>
<a name="l1159"><span class="linenum">1159</span></a>          <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a> = 'full';
<a name="l1160"><span class="linenum">1160</span></a>  <span class="comment">        // in case of single item view params prefix must be empty</span>
<a name="l1161"><span class="linenum">1161</span></a>          <a class="var it6497" onMouseOver="hilite(6497)" onMouseOut="lolite()" onClick="logVariable('items_list_param_prefix')" href="../../../_variables/items_list_param_prefix.html">$items_list_param_prefix</a> = NULL;
<a name="l1162"><span class="linenum">1162</span></a>      }
<a name="l1163"><span class="linenum">1163</span></a>      else
<a name="l1164"><span class="linenum">1164</span></a>      {    // Store/retrieve preferred tab from UserSettings:
<a name="l1165"><span class="linenum">1165</span></a>          <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('UserSettings')" href="../../../_variables/UserSettings.html">$UserSettings</a>-&gt;<a class="function" onClick="logFunction('param_Request')" href="../../../_functions/param_request.html" onMouseOver="funcPopup(event,'param_request')">param_Request</a>( 'tab', 'pref_browse_tab', 'string', NULL, true <span class="comment">/* memorize */</span>, true <span class="comment">/* force */</span> );
<a name="l1166"><span class="linenum">1166</span></a>      }
<a name="l1167"><span class="linenum">1167</span></a>  
<a name="l1168"><span class="linenum">1168</span></a>      if( <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a> == 'tracker' &amp;&amp; ! <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a class="function" onClick="logFunction('get_setting')" href="../../../_functions/get_setting.html" onMouseOver="funcPopup(event,'get_setting')">get_setting</a>( 'use_workflow' ) )
<a name="l1169"><span class="linenum">1169</span></a>      { // Display workflow view only if it is enabled
<a name="l1170"><span class="linenum">1170</span></a>          global <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>;
<a name="l1171"><span class="linenum">1171</span></a>          <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Workflow feature has not been enabled for this collection.'), 'note' );
<a name="l1172"><span class="linenum">1172</span></a>          <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a> = 'full';
<a name="l1173"><span class="linenum">1173</span></a>      }
<a name="l1174"><span class="linenum">1174</span></a>  
<a name="l1175"><span class="linenum">1175</span></a>      <span class="comment">/*</span>
<a name="l1176"><span class="linenum">1176</span></a>  <span class="comment">     * Init list of posts to display:</span>
<a name="l1177"><span class="linenum">1177</span></a>  <span class="comment">     */</span>
<a name="l1178"><span class="linenum">1178</span></a>      <a class="function" onClick="logFunction('load_class')" href="../../../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( 'items/model/_itemlist.class.php', 'ItemList2' );
<a name="l1179"><span class="linenum">1179</span></a>  
<a name="l1180"><span class="linenum">1180</span></a>      if( !empty( <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a> ) &amp;&amp; !empty( <a class="var it6497" onMouseOver="hilite(6497)" onMouseOut="lolite()" onClick="logVariable('items_list_param_prefix')" href="../../../_variables/items_list_param_prefix.html">$items_list_param_prefix</a> ) )
<a name="l1181"><span class="linenum">1181</span></a>      {    // Use different param prefix for each tab
<a name="l1182"><span class="linenum">1182</span></a>          <a class="var it6497" onMouseOver="hilite(6497)" onMouseOut="lolite()" onClick="logVariable('items_list_param_prefix')" href="../../../_variables/items_list_param_prefix.html">$items_list_param_prefix</a> .= <a class="phpfunction" onClick="logFunction('substr')" href="../../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>( <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a>, 0, 7 ).'_';
<a name="l1183"><span class="linenum">1183</span></a>      }
<a name="l1184"><span class="linenum">1184</span></a>  <span class="comment">    // Create empty List:</span>
<a name="l1185"><span class="linenum">1185</span></a>      <a class="var it652" onMouseOver="hilite(652)" onMouseOut="lolite()" onClick="logVariable('ItemList')" href="../../../_variables/ItemList.html">$ItemList</a> = <span class="keyword">new </span><a class="class" onClick="logClass('ItemList2')" href="../../../_classes/itemlist2.html" onMouseOver="classPopup(event,'itemlist2')">ItemList2</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>, NULL, NULL, <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('UserSettings')" href="../../../_variables/UserSettings.html">$UserSettings</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>('results_per_page'), 'ItemCache', <a class="var it6497" onMouseOver="hilite(6497)" onMouseOut="lolite()" onClick="logVariable('items_list_param_prefix')" href="../../../_variables/items_list_param_prefix.html">$items_list_param_prefix</a>, <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a> <span class="comment">/* filterset name */</span> ); <span class="comment">// COPY (func)</span>
<a name="l1186"><span class="linenum">1186</span></a>  
<a name="l1187"><span class="linenum">1187</span></a>      <a class="var it652" onMouseOver="hilite(652)" onMouseOut="lolite()" onClick="logVariable('ItemList')" href="../../../_variables/ItemList.html">$ItemList</a>-&gt;<a class="function" onClick="logFunction('set_default_filters')" href="../../../_functions/set_default_filters.html" onMouseOver="funcPopup(event,'set_default_filters')">set_default_filters</a>( array(
<a name="l1188"><span class="linenum">1188</span></a>              'visibility_array' =&gt; <a class="function" onClick="logFunction('get_visibility_statuses')" href="../../../_functions/get_visibility_statuses.html" onMouseOver="funcPopup(event,'get_visibility_statuses')">get_visibility_statuses</a>('keys'),
<a name="l1189"><span class="linenum">1189</span></a>          ) );
<a name="l1190"><span class="linenum">1190</span></a>  
<a name="l1191"><span class="linenum">1191</span></a>      if( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a class="function" onClick="logFunction('get_setting')" href="../../../_functions/get_setting.html" onMouseOver="funcPopup(event,'get_setting')">get_setting</a>('orderby') == 'RAND' )
<a name="l1192"><span class="linenum">1192</span></a>      {    // Do not display random posts in backoffice for easy management
<a name="l1193"><span class="linenum">1193</span></a>          <a class="var it652" onMouseOver="hilite(652)" onMouseOut="lolite()" onClick="logVariable('ItemList')" href="../../../_variables/ItemList.html">$ItemList</a>-&gt;<a class="function" onClick="logFunction('set_default_filters')" href="../../../_functions/set_default_filters.html" onMouseOver="funcPopup(event,'set_default_filters')">set_default_filters</a>( array(
<a name="l1194"><span class="linenum">1194</span></a>                  'orderby' =&gt; 'datemodified',
<a name="l1195"><span class="linenum">1195</span></a>              ) );
<a name="l1196"><span class="linenum">1196</span></a>      }
<a name="l1197"><span class="linenum">1197</span></a>  
<a name="l1198"><span class="linenum">1198</span></a>      switch( <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a> )
<a name="l1199"><span class="linenum">1199</span></a>      {
<a name="l1200"><span class="linenum">1200</span></a>          case 'full':
<a name="l1201"><span class="linenum">1201</span></a>              <a class="var it652" onMouseOver="hilite(652)" onMouseOut="lolite()" onClick="logVariable('ItemList')" href="../../../_variables/ItemList.html">$ItemList</a>-&gt;<a class="function" onClick="logFunction('set_default_filters')" href="../../../_functions/set_default_filters.html" onMouseOver="funcPopup(event,'set_default_filters')">set_default_filters</a>( array(
<a name="l1202"><span class="linenum">1202</span></a>                      'types' =&gt; NULL, // All types (suited for tab with full posts)
<a name="l1203"><span class="linenum">1203</span></a>                  ) );
<a name="l1204"><span class="linenum">1204</span></a>  <span class="comment">            // $AdminUI-&gt;breadcrumbpath_add( T_('All items'), '?ctrl=items&amp;amp;blog=$blog$&amp;amp;tab='.$tab.'&amp;amp;filter=restore' );</span>
<a name="l1205"><span class="linenum">1205</span></a>  
<a name="l1206"><span class="linenum">1206</span></a>  <span class="comment">            // require colorbox js</span>
<a name="l1207"><span class="linenum">1207</span></a>              <a class="function" onClick="logFunction('require_js_helper')" href="../../../_functions/require_js_helper.html" onMouseOver="funcPopup(event,'require_js_helper')">require_js_helper</a>( 'colorbox' );
<a name="l1208"><span class="linenum">1208</span></a>              break;
<a name="l1209"><span class="linenum">1209</span></a>  
<a name="l1210"><span class="linenum">1210</span></a>          case 'manual':
<a name="l1211"><span class="linenum">1211</span></a>              if( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>( 'type' ) != 'manual' )
<a name="l1212"><span class="linenum">1212</span></a>              {    // Display this tab only for manual blogs
<a name="l1213"><span class="linenum">1213</span></a>                  global <a class="var it346" onMouseOver="hilite(346)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../../_variables/admin_url.html">$admin_url</a>;
<a name="l1214"><span class="linenum">1214</span></a>                  <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( <a class="var it346" onMouseOver="hilite(346)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../../_variables/admin_url.html">$admin_url</a>.'?ctrl=items&amp;blog='.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a onClick="logVariable('ID')" class="var it8952" onMouseOver="hilite(8952)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>.'&amp;tab=list&amp;filter=restore' );
<a name="l1215"><span class="linenum">1215</span></a>              }
<a name="l1216"><span class="linenum">1216</span></a>  
<a name="l1217"><span class="linenum">1217</span></a>              global <a class="var it136" onMouseOver="hilite(136)" onMouseOut="lolite()" onClick="logVariable('ReqURI')" href="../../../_variables/ReqURI.html">$ReqURI</a>, <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a>;
<a name="l1218"><span class="linenum">1218</span></a>  
<a name="l1219"><span class="linenum">1219</span></a>              <a class="function" onClick="logFunction('init_field_editor_js')" href="../../../_functions/init_field_editor_js.html" onMouseOver="funcPopup(event,'init_field_editor_js')">init_field_editor_js</a>( array(
<a name="l1220"><span class="linenum">1220</span></a>                      'action_url' =&gt; <a class="var it136" onMouseOver="hilite(136)" onMouseOut="lolite()" onClick="logVariable('ReqURI')" href="../../../_variables/ReqURI.html">$ReqURI</a>.'&amp;blog='.<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a>.'&amp;order_action=update&amp;order_data=',
<a name="l1221"><span class="linenum">1221</span></a>                  ) );
<a name="l1222"><span class="linenum">1222</span></a>  
<a name="l1223"><span class="linenum">1223</span></a>              <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Manual view'), '?ctrl=items&amp;amp;blog=<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a>$&amp;amp;tab='.<a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a>.'&amp;amp;filter=restore' );
<a name="l1224"><span class="linenum">1224</span></a>              break;
<a name="l1225"><span class="linenum">1225</span></a>  
<a name="l1226"><span class="linenum">1226</span></a>          case 'list':
<a name="l1227"><span class="linenum">1227</span></a>  <span class="comment">            // Nothing special</span>
<a name="l1228"><span class="linenum">1228</span></a>              <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Regular posts'), '?ctrl=items&amp;amp;blog=<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a>$&amp;amp;tab='.<a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a>.'&amp;amp;filter=restore' );
<a name="l1229"><span class="linenum">1229</span></a>              break;
<a name="l1230"><span class="linenum">1230</span></a>  
<a name="l1231"><span class="linenum">1231</span></a>          case 'pages':
<a name="l1232"><span class="linenum">1232</span></a>              <a class="var it652" onMouseOver="hilite(652)" onMouseOut="lolite()" onClick="logVariable('ItemList')" href="../../../_variables/ItemList.html">$ItemList</a>-&gt;<a class="function" onClick="logFunction('set_default_filters')" href="../../../_functions/set_default_filters.html" onMouseOver="funcPopup(event,'set_default_filters')">set_default_filters</a>( array(
<a name="l1233"><span class="linenum">1233</span></a>                      'types' =&gt; <a class="phpfunction" onClick="logFunction('implode')" href="../../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(',',<a class="var it4528" onMouseOver="hilite(4528)" onMouseOut="lolite()" onClick="logVariable('posttypes_perms')" href="../../../_variables/posttypes_perms.html">$posttypes_perms</a>['page']), // Pages
<a name="l1234"><span class="linenum">1234</span></a>                  ) );
<a name="l1235"><span class="linenum">1235</span></a>              <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Pages'), '?ctrl=items&amp;amp;blog=<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a>$&amp;amp;tab='.<a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a>.'&amp;amp;filter=restore' );
<a name="l1236"><span class="linenum">1236</span></a>              break;
<a name="l1237"><span class="linenum">1237</span></a>  
<a name="l1238"><span class="linenum">1238</span></a>          case 'intros':
<a name="l1239"><span class="linenum">1239</span></a>              <a class="var it652" onMouseOver="hilite(652)" onMouseOut="lolite()" onClick="logVariable('ItemList')" href="../../../_variables/ItemList.html">$ItemList</a>-&gt;<a class="function" onClick="logFunction('set_default_filters')" href="../../../_functions/set_default_filters.html" onMouseOver="funcPopup(event,'set_default_filters')">set_default_filters</a>( array(
<a name="l1240"><span class="linenum">1240</span></a>                      'types' =&gt; <a class="phpfunction" onClick="logFunction('implode')" href="../../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(',',<a class="var it4528" onMouseOver="hilite(4528)" onMouseOut="lolite()" onClick="logVariable('posttypes_perms')" href="../../../_variables/posttypes_perms.html">$posttypes_perms</a>['intro']), // Intros
<a name="l1241"><span class="linenum">1241</span></a>                  ) );
<a name="l1242"><span class="linenum">1242</span></a>              <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Intro posts'), '?ctrl=items&amp;amp;blog=<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a>$&amp;amp;tab='.<a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a>.'&amp;amp;filter=restore' );
<a name="l1243"><span class="linenum">1243</span></a>              break;
<a name="l1244"><span class="linenum">1244</span></a>  
<a name="l1245"><span class="linenum">1245</span></a>          case 'podcasts':
<a name="l1246"><span class="linenum">1246</span></a>              <a class="var it652" onMouseOver="hilite(652)" onMouseOut="lolite()" onClick="logVariable('ItemList')" href="../../../_variables/ItemList.html">$ItemList</a>-&gt;<a class="function" onClick="logFunction('set_default_filters')" href="../../../_functions/set_default_filters.html" onMouseOver="funcPopup(event,'set_default_filters')">set_default_filters</a>( array(
<a name="l1247"><span class="linenum">1247</span></a>                      'types' =&gt; <a class="phpfunction" onClick="logFunction('implode')" href="../../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(',',<a class="var it4528" onMouseOver="hilite(4528)" onMouseOut="lolite()" onClick="logVariable('posttypes_perms')" href="../../../_variables/posttypes_perms.html">$posttypes_perms</a>['podcast']), // Podcasts
<a name="l1248"><span class="linenum">1248</span></a>                  ) );
<a name="l1249"><span class="linenum">1249</span></a>              <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Podcasts'), '?ctrl=items&amp;amp;blog=<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a>$&amp;amp;tab='.<a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a>.'&amp;amp;filter=restore' );
<a name="l1250"><span class="linenum">1250</span></a>              break;
<a name="l1251"><span class="linenum">1251</span></a>  
<a name="l1252"><span class="linenum">1252</span></a>          case 'links':
<a name="l1253"><span class="linenum">1253</span></a>              <a class="var it652" onMouseOver="hilite(652)" onMouseOut="lolite()" onClick="logVariable('ItemList')" href="../../../_variables/ItemList.html">$ItemList</a>-&gt;<a class="function" onClick="logFunction('set_default_filters')" href="../../../_functions/set_default_filters.html" onMouseOver="funcPopup(event,'set_default_filters')">set_default_filters</a>( array(
<a name="l1254"><span class="linenum">1254</span></a>                      'types' =&gt; '3000', // Links
<a name="l1255"><span class="linenum">1255</span></a>                  ) );
<a name="l1256"><span class="linenum">1256</span></a>              <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Links'), '?ctrl=items&amp;amp;blog=<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a>$&amp;amp;tab='.<a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a>.'&amp;amp;filter=restore' );
<a name="l1257"><span class="linenum">1257</span></a>              break;
<a name="l1258"><span class="linenum">1258</span></a>  
<a name="l1259"><span class="linenum">1259</span></a>          case 'ads':
<a name="l1260"><span class="linenum">1260</span></a>              <a class="var it652" onMouseOver="hilite(652)" onMouseOut="lolite()" onClick="logVariable('ItemList')" href="../../../_variables/ItemList.html">$ItemList</a>-&gt;<a class="function" onClick="logFunction('set_default_filters')" href="../../../_functions/set_default_filters.html" onMouseOver="funcPopup(event,'set_default_filters')">set_default_filters</a>( array(
<a name="l1261"><span class="linenum">1261</span></a>                      'types' =&gt; '4000', // Advertisements
<a name="l1262"><span class="linenum">1262</span></a>                  ) );
<a name="l1263"><span class="linenum">1263</span></a>              <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Advertisements'), '?ctrl=items&amp;amp;blog=<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a>$&amp;amp;tab='.<a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a>.'&amp;amp;filter=restore' );
<a name="l1264"><span class="linenum">1264</span></a>              break;
<a name="l1265"><span class="linenum">1265</span></a>  
<a name="l1266"><span class="linenum">1266</span></a>          case 'tracker':
<a name="l1267"><span class="linenum">1267</span></a>  <span class="comment">            // In tracker mode, we want a different default sort:</span>
<a name="l1268"><span class="linenum">1268</span></a>              <a class="var it652" onMouseOver="hilite(652)" onMouseOut="lolite()" onClick="logVariable('ItemList')" href="../../../_variables/ItemList.html">$ItemList</a>-&gt;<a class="function" onClick="logFunction('set_default_filters')" href="../../../_functions/set_default_filters.html" onMouseOver="funcPopup(event,'set_default_filters')">set_default_filters</a>( array(
<a name="l1269"><span class="linenum">1269</span></a>                      'orderby' =&gt; 'priority',
<a name="l1270"><span class="linenum">1270</span></a>                      'order' =&gt; 'ASC' ) );
<a name="l1271"><span class="linenum">1271</span></a>              <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>( 'Workflow view' ), '?ctrl=items&amp;amp;blog=<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a>$&amp;amp;tab=tracker&amp;amp;filter=restore' );
<a name="l1272"><span class="linenum">1272</span></a>  <span class="comment">            // JS to edit priority of items from list view</span>
<a name="l1273"><span class="linenum">1273</span></a>              <a class="function" onClick="logFunction('require_js')" href="../../../_functions/require_js.html" onMouseOver="funcPopup(event,'require_js')">require_js</a>( 'jquery/jquery.jeditable.js', 'rsc_url' );
<a name="l1274"><span class="linenum">1274</span></a>              break;
<a name="l1275"><span class="linenum">1275</span></a>  
<a name="l1276"><span class="linenum">1276</span></a>          default:
<a name="l1277"><span class="linenum">1277</span></a>  <span class="comment">            // Delete the pref_browse_tab setting so that the default</span>
<a name="l1278"><span class="linenum">1278</span></a>  <span class="comment">            // (full) gets used the next time the user wants to browse</span>
<a name="l1279"><span class="linenum">1279</span></a>  <span class="comment">            // a blog and we don't run into the same error again.</span>
<a name="l1280"><span class="linenum">1280</span></a>              <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('UserSettings')" href="../../../_variables/UserSettings.html">$UserSettings</a>-&gt;<a class="function" onClick="logFunction('delete')" href="../../../_functions/delete.html" onMouseOver="funcPopup(event,'delete')">delete</a>( 'pref_browse_tab' );
<a name="l1281"><span class="linenum">1281</span></a>              <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('UserSettings')" href="../../../_variables/UserSettings.html">$UserSettings</a>-&gt;<a class="function" onClick="logFunction('dbupdate')" href="../../../_functions/dbupdate.html" onMouseOver="funcPopup(event,'dbupdate')">dbupdate</a>();
<a name="l1282"><span class="linenum">1282</span></a>              <a class="function" onClick="logFunction('debug_die')" href="../../../_functions/debug_die.html" onMouseOver="funcPopup(event,'debug_die')">debug_die</a>( 'Unknown filterset ['.<a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a>.']' );
<a name="l1283"><span class="linenum">1283</span></a>      }
<a name="l1284"><span class="linenum">1284</span></a>  
<a name="l1285"><span class="linenum">1285</span></a>  <span class="comment">    // Init filter params:</span>
<a name="l1286"><span class="linenum">1286</span></a>      if( ! <a class="var it652" onMouseOver="hilite(652)" onMouseOut="lolite()" onClick="logVariable('ItemList')" href="../../../_variables/ItemList.html">$ItemList</a>-&gt;<a class="function" onClick="logFunction('load_from_Request')" href="../../../_functions/load_from_request.html" onMouseOver="funcPopup(event,'load_from_request')">load_from_Request</a>() )
<a name="l1287"><span class="linenum">1287</span></a>      { // If we could not init a filterset from request
<a name="l1288"><span class="linenum">1288</span></a>  <span class="comment">        // typically happens when we could no fall back to previously saved filterset...</span>
<a name="l1289"><span class="linenum">1289</span></a>  <span class="comment">        // echo ' no filterset!';</span>
<a name="l1290"><span class="linenum">1290</span></a>      }
<a name="l1291"><span class="linenum">1291</span></a>  }
<a name="l1292"><span class="linenum">1292</span></a>  
<a name="l1293"><span class="linenum">1293</span></a>  <span class="comment">/**</span>
<a name="l1294"><span class="linenum">1294</span></a>  <span class="comment"> * Configure page navigation:</span>
<a name="l1295"><span class="linenum">1295</span></a>  <span class="comment"> */</span>
<a name="l1296"><span class="linenum">1296</span></a>  switch( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> )
<a name="l1297"><span class="linenum">1297</span></a>  {
<a name="l1298"><span class="linenum">1298</span></a>      case 'new':
<a name="l1299"><span class="linenum">1299</span></a>      case 'new_switchtab': // this gets set as action by JS, when we switch tabs
<a name="l1300"><span class="linenum">1300</span></a>      case 'copy':
<a name="l1301"><span class="linenum">1301</span></a>      case 'create_edit':
<a name="l1302"><span class="linenum">1302</span></a>      case 'create':
<a name="l1303"><span class="linenum">1303</span></a>      case 'create_publish':
<a name="l1304"><span class="linenum">1304</span></a>  <span class="comment">        // Generate available blogs list:</span>
<a name="l1305"><span class="linenum">1305</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('set_coll_list_params')" href="../../../_functions/set_coll_list_params.html" onMouseOver="funcPopup(event,'set_coll_list_params')">set_coll_list_params</a>( 'blog_post_statuses', 'edit',
<a name="l1306"><span class="linenum">1306</span></a>                          array( 'ctrl' =&gt; 'items', 'action' =&gt; 'new' ), NULL, '',
<a name="l1307"><span class="linenum">1307</span></a>                          'return <a class="function" onClick="logFunction('b2edit_reload')" href="../../../_functions/b2edit_reload.html" onMouseOver="funcPopup(event,'b2edit_reload')">b2edit_reload</a>( document.getElementById(\'item_checkchanges\'), \''.<a class="var it230" onMouseOver="hilite(230)" onMouseOut="lolite()" onClick="logVariable('dispatcher')" href="../../../_variables/dispatcher.html">$dispatcher</a>.'\', %s )' );
<a name="l1308"><span class="linenum">1308</span></a>  
<a name="l1309"><span class="linenum">1309</span></a>  <span class="comment">        // We don't check the following earlier, because we want the blog switching buttons to be available:</span>
<a name="l1310"><span class="linenum">1310</span></a>          if( ! <a class="function" onClick="logFunction('blog_has_cats')" href="../../../_functions/blog_has_cats.html" onMouseOver="funcPopup(event,'blog_has_cats')">blog_has_cats</a>( <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a> ) )
<a name="l1311"><span class="linenum">1311</span></a>          {
<a name="l1312"><span class="linenum">1312</span></a>              <a class="var it350" onMouseOver="hilite(350)" onMouseOut="lolite()" onClick="logVariable('error_message')" href="../../../_variables/error_message.html">$error_message</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Since this blog has no categories, you cannot post into it.');
<a name="l1313"><span class="linenum">1313</span></a>              if( <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'blog_cats', 'edit', false, <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a> ) )
<a name="l1314"><span class="linenum">1314</span></a>              { // If current user has a permission to create a category
<a name="l1315"><span class="linenum">1315</span></a>                  global <a class="var it346" onMouseOver="hilite(346)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../../_variables/admin_url.html">$admin_url</a>;
<a name="l1316"><span class="linenum">1316</span></a>                  <a class="var it350" onMouseOver="hilite(350)" onMouseOut="lolite()" onClick="logVariable('error_message')" href="../../../_variables/error_message.html">$error_message</a> .= ' '.sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('You must &lt;a %s&gt;create categories&lt;/a&gt; first.'), 'href=&quot;'.<a class="var it346" onMouseOver="hilite(346)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../../_variables/admin_url.html">$admin_url</a>.'?ctrl=chapters&amp;amp;blog='.<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a>.'&quot;');
<a name="l1317"><span class="linenum">1317</span></a>              }
<a name="l1318"><span class="linenum">1318</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="var it350" onMouseOver="hilite(350)" onMouseOut="lolite()" onClick="logVariable('error_message')" href="../../../_variables/error_message.html">$error_message</a>, 'error' );
<a name="l1319"><span class="linenum">1319</span></a>              <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'nil';
<a name="l1320"><span class="linenum">1320</span></a>              break;
<a name="l1321"><span class="linenum">1321</span></a>          }
<a name="l1322"><span class="linenum">1322</span></a>  
<a name="l1323"><span class="linenum">1323</span></a>  <span class="comment">        /* NOBREAK */</span>
<a name="l1324"><span class="linenum">1324</span></a>  
<a name="l1325"><span class="linenum">1325</span></a>      case 'edit':
<a name="l1326"><span class="linenum">1326</span></a>      case 'edit_switchtab': // this gets set as action by JS, when we switch tabs
<a name="l1327"><span class="linenum">1327</span></a>      case 'update_edit':
<a name="l1328"><span class="linenum">1328</span></a>      case 'update': // on error
<a name="l1329"><span class="linenum">1329</span></a>      case 'update_publish': // on error
<a name="l1330"><span class="linenum">1330</span></a>  <span class="comment">        // Get tab (&quot;simple&quot; or &quot;expert&quot;) from Request or UserSettings:</span>
<a name="l1331"><span class="linenum">1331</span></a>          <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a> = <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('UserSettings')" href="../../../_variables/UserSettings.html">$UserSettings</a>-&gt;<a class="function" onClick="logFunction('param_Request')" href="../../../_functions/param_request.html" onMouseOver="funcPopup(event,'param_request')">param_Request</a>( 'tab', 'pref_edit_tab', 'string', NULL, true <span class="comment">/* memorize */</span>, true <span class="comment">/* force */</span> );
<a name="l1332"><span class="linenum">1332</span></a>  
<a name="l1333"><span class="linenum">1333</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('add_menu_entries')" href="../../../_functions/add_menu_entries.html" onMouseOver="funcPopup(event,'add_menu_entries')">add_menu_entries</a>( 'items', <a class="function" onClick="logFunction('get_item_edit_modes')" href="../../../_functions/get_item_edit_modes.html" onMouseOver="funcPopup(event,'get_item_edit_modes')">get_item_edit_modes</a>( <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a>, <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a>, <a class="var it230" onMouseOver="hilite(230)" onMouseOut="lolite()" onClick="logVariable('dispatcher')" href="../../../_variables/dispatcher.html">$dispatcher</a>, <a class="var it6485" onMouseOver="hilite(6485)" onMouseOut="lolite()" onClick="logVariable('tab_switch_params')" href="../../../_variables/tab_switch_params.html">$tab_switch_params</a> ) );
<a name="l1334"><span class="linenum">1334</span></a>  
<a name="l1335"><span class="linenum">1335</span></a>  <span class="comment">        // Generate available blogs list:</span>
<a name="l1336"><span class="linenum">1336</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('set_coll_list_params')" href="../../../_functions/set_coll_list_params.html" onMouseOver="funcPopup(event,'set_coll_list_params')">set_coll_list_params</a>( 'blog_ismember', 'view', array( 'ctrl' =&gt; 'items', 'filter' =&gt; 'restore' ) );
<a name="l1337"><span class="linenum">1337</span></a>  
<a name="l1338"><span class="linenum">1338</span></a>          switch( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> )
<a name="l1339"><span class="linenum">1339</span></a>          {
<a name="l1340"><span class="linenum">1340</span></a>              case 'edit':
<a name="l1341"><span class="linenum">1341</span></a>              case 'edit_switchtab': // this gets set as action by JS, when we switch tabs
<a name="l1342"><span class="linenum">1342</span></a>              case 'update_edit':
<a name="l1343"><span class="linenum">1343</span></a>              case 'update': // on error
<a name="l1344"><span class="linenum">1344</span></a>              case 'update_publish': // on error
<a name="l1345"><span class="linenum">1345</span></a>                  if( <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'item_post!CURSTATUS', 'delete', false, <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a> ) )
<a name="l1346"><span class="linenum">1346</span></a>                  {    // User has permissions to delete this post
<a name="l1347"><span class="linenum">1347</span></a>                      <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('global_icon')" href="../../../_functions/global_icon.html" onMouseOver="funcPopup(event,'global_icon')">global_icon</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Delete this post'), 'delete', '?ctrl=items&amp;amp;action=delete&amp;amp;post_ID='.<a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>.'&amp;amp;'.<a class="function" onClick="logFunction('url_crumb')" href="../../../_functions/url_crumb.html" onMouseOver="funcPopup(event,'url_crumb')">url_crumb</a>('item'),
<a name="l1348"><span class="linenum">1348</span></a>                           ' '.<a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Delete'), 4, 3, array(
<a name="l1349"><span class="linenum">1349</span></a>                                   'onclick' =&gt; 'return confirm(\''.<a class="function" onClick="logFunction('TS_')" href="../../../_functions/ts_.html" onMouseOver="funcPopup(event,'ts_')">TS_</a>('You are about to delete this post!\\nThis cannot be undone!').'\')',
<a name="l1350"><span class="linenum">1350</span></a>                                   'style' =&gt; 'margin-right: 3ex;',    // Avoid misclicks by all means!
<a name="l1351"><span class="linenum">1351</span></a>                           ) );
<a name="l1352"><span class="linenum">1352</span></a>                  }
<a name="l1353"><span class="linenum">1353</span></a>  
<a name="l1354"><span class="linenum">1354</span></a>                  <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('global_icon')" href="../../../_functions/global_icon.html" onMouseOver="funcPopup(event,'global_icon')">global_icon</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Permanent link to full entry'), 'permalink', <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('get_permanent_url')" href="../../../_functions/get_permanent_url.html" onMouseOver="funcPopup(event,'get_permanent_url')">get_permanent_url</a>(),
<a name="l1355"><span class="linenum">1355</span></a>                          ' '.<a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Permalink'), 4, 3, array(
<a name="l1356"><span class="linenum">1356</span></a>                                   'style' =&gt; 'margin-right: 3ex',
<a name="l1357"><span class="linenum">1357</span></a>                           ) );
<a name="l1358"><span class="linenum">1358</span></a>  
<a name="l1359"><span class="linenum">1359</span></a>                  if( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('ID')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> &gt; 0 )
<a name="l1360"><span class="linenum">1360</span></a>                  { // Display a link to history if Item exists in DB
<a name="l1361"><span class="linenum">1361</span></a>                      <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('global_icon')" href="../../../_functions/global_icon.html" onMouseOver="funcPopup(event,'global_icon')">global_icon</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('History'), '', <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('get_history_url')" href="../../../_functions/get_history_url.html" onMouseOver="funcPopup(event,'get_history_url')">get_history_url</a>(),
<a name="l1362"><span class="linenum">1362</span></a>                          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('history_info_icon')" href="../../../_functions/history_info_icon.html" onMouseOver="funcPopup(event,'history_info_icon')">history_info_icon</a>().' '.<a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('History'), 4, 3, array(
<a name="l1363"><span class="linenum">1363</span></a>                                  'style' =&gt; 'margin-right: 3ex'
<a name="l1364"><span class="linenum">1364</span></a>                          ) );
<a name="l1365"><span class="linenum">1365</span></a>                  }
<a name="l1366"><span class="linenum">1366</span></a>                  break;
<a name="l1367"><span class="linenum">1367</span></a>          }
<a name="l1368"><span class="linenum">1368</span></a>  
<a name="l1369"><span class="linenum">1369</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('global_icon')" href="../../../_functions/global_icon.html" onMouseOver="funcPopup(event,'global_icon')">global_icon</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Cancel editing!'), 'close', <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../../_variables/redirect_to.html">$redirect_to</a>, <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Cancel'), 4, 2 );
<a name="l1370"><span class="linenum">1370</span></a>  
<a name="l1371"><span class="linenum">1371</span></a>          <a class="function" onClick="logFunction('init_tokeninput_js')" href="../../../_functions/init_tokeninput_js.html" onMouseOver="funcPopup(event,'init_tokeninput_js')">init_tokeninput_js</a>();
<a name="l1372"><span class="linenum">1372</span></a>  
<a name="l1373"><span class="linenum">1373</span></a>          break;
<a name="l1374"><span class="linenum">1374</span></a>  
<a name="l1375"><span class="linenum">1375</span></a>      case 'new_mass':
<a name="l1376"><span class="linenum">1376</span></a>  
<a name="l1377"><span class="linenum">1377</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('set_coll_list_params')" href="../../../_functions/set_coll_list_params.html" onMouseOver="funcPopup(event,'set_coll_list_params')">set_coll_list_params</a>( 'blog_post_statuses', 'edit',
<a name="l1378"><span class="linenum">1378</span></a>                          array( 'ctrl' =&gt; 'items', 'action' =&gt; 'new' ), NULL, '',
<a name="l1379"><span class="linenum">1379</span></a>                          'return <a class="function" onClick="logFunction('b2edit_reload')" href="../../../_functions/b2edit_reload.html" onMouseOver="funcPopup(event,'b2edit_reload')">b2edit_reload</a>( document.getElementById(\'item_checkchanges\'), \''.<a class="var it230" onMouseOver="hilite(230)" onMouseOut="lolite()" onClick="logVariable('dispatcher')" href="../../../_variables/dispatcher.html">$dispatcher</a>.'\', %s )' );
<a name="l1380"><span class="linenum">1380</span></a>  
<a name="l1381"><span class="linenum">1381</span></a>  <span class="comment">        // We don't check the following earlier, because we want the blog switching buttons to be available:</span>
<a name="l1382"><span class="linenum">1382</span></a>          if( ! <a class="function" onClick="logFunction('blog_has_cats')" href="../../../_functions/blog_has_cats.html" onMouseOver="funcPopup(event,'blog_has_cats')">blog_has_cats</a>( <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a> ) )
<a name="l1383"><span class="linenum">1383</span></a>          {
<a name="l1384"><span class="linenum">1384</span></a>              <a class="var it350" onMouseOver="hilite(350)" onMouseOut="lolite()" onClick="logVariable('error_message')" href="../../../_variables/error_message.html">$error_message</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Since this blog has no categories, you cannot post into it.');
<a name="l1385"><span class="linenum">1385</span></a>              if( <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'blog_cats', 'edit', false, <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a> ) )
<a name="l1386"><span class="linenum">1386</span></a>              { // If current user has a permission to create a category
<a name="l1387"><span class="linenum">1387</span></a>                  global <a class="var it346" onMouseOver="hilite(346)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../../_variables/admin_url.html">$admin_url</a>;
<a name="l1388"><span class="linenum">1388</span></a>                  <a class="var it350" onMouseOver="hilite(350)" onMouseOut="lolite()" onClick="logVariable('error_message')" href="../../../_variables/error_message.html">$error_message</a> .= ' '.sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('You must &lt;a %s&gt;create categories&lt;/a&gt; first.'), 'href=&quot;'.<a class="var it346" onMouseOver="hilite(346)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../../_variables/admin_url.html">$admin_url</a>.'?ctrl=chapters&amp;amp;blog='.<a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a>.'&quot;');
<a name="l1389"><span class="linenum">1389</span></a>              }
<a name="l1390"><span class="linenum">1390</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="var it350" onMouseOver="hilite(350)" onMouseOut="lolite()" onClick="logVariable('error_message')" href="../../../_variables/error_message.html">$error_message</a>, 'error' );
<a name="l1391"><span class="linenum">1391</span></a>              <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'nil';
<a name="l1392"><span class="linenum">1392</span></a>              break;
<a name="l1393"><span class="linenum">1393</span></a>          }
<a name="l1394"><span class="linenum">1394</span></a>  
<a name="l1395"><span class="linenum">1395</span></a>      break;
<a name="l1396"><span class="linenum">1396</span></a>  
<a name="l1397"><span class="linenum">1397</span></a>      case 'view':
<a name="l1398"><span class="linenum">1398</span></a>  <span class="comment">        // We're displaying a SINGLE specific post:</span>
<a name="l1399"><span class="linenum">1399</span></a>          <a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('item_ID')" href="../../../_variables/item_ID.html">$item_ID</a> = <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'p', 'integer', true );
<a name="l1400"><span class="linenum">1400</span></a>  
<a name="l1401"><span class="linenum">1401</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a onClick="logVariable('title_titlearea')" class="var it8956" onMouseOver="hilite(8956)" onMouseOut="lolite()" href="../../../_variables/title_titlearea.html">title_titlearea</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('View post &amp; comments');
<a name="l1402"><span class="linenum">1402</span></a>  
<a name="l1403"><span class="linenum">1403</span></a>  <span class="comment">        // Generate available blogs list:</span>
<a name="l1404"><span class="linenum">1404</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('set_coll_list_params')" href="../../../_functions/set_coll_list_params.html" onMouseOver="funcPopup(event,'set_coll_list_params')">set_coll_list_params</a>( 'blog_ismember', 'view', array( 'ctrl' =&gt; 'items', 'tab' =&gt; <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a>, 'filter' =&gt; 'restore' ) );
<a name="l1405"><span class="linenum">1405</span></a>  
<a name="l1406"><span class="linenum">1406</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Post #%s'), <a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('item_ID')" href="../../../_variables/item_ID.html">$item_ID</a> ), '?ctrl=items&amp;amp;blog='.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a onClick="logVariable('ID')" class="var it8952" onMouseOver="hilite(8952)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>.'&amp;amp;p='.<a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('item_ID')" href="../../../_variables/item_ID.html">$item_ID</a> );
<a name="l1407"><span class="linenum">1407</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('View post &amp; comments'), '?ctrl=items&amp;amp;blog='.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a onClick="logVariable('ID')" class="var it8952" onMouseOver="hilite(8952)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>.'&amp;amp;p='.<a class="var it333" onMouseOver="hilite(333)" onMouseOut="lolite()" onClick="logVariable('item_ID')" href="../../../_variables/item_ID.html">$item_ID</a> );
<a name="l1408"><span class="linenum">1408</span></a>          break;
<a name="l1409"><span class="linenum">1409</span></a>  
<a name="l1410"><span class="linenum">1410</span></a>      case 'list':
<a name="l1411"><span class="linenum">1411</span></a>  <span class="comment">        // We're displaying a list of posts:</span>
<a name="l1412"><span class="linenum">1412</span></a>  
<a name="l1413"><span class="linenum">1413</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a onClick="logVariable('title_titlearea')" class="var it8956" onMouseOver="hilite(8956)" onMouseOut="lolite()" href="../../../_variables/title_titlearea.html">title_titlearea</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Browse blog');
<a name="l1414"><span class="linenum">1414</span></a>  
<a name="l1415"><span class="linenum">1415</span></a>  <span class="comment">        // Generate available blogs list:</span>
<a name="l1416"><span class="linenum">1416</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('set_coll_list_params')" href="../../../_functions/set_coll_list_params.html" onMouseOver="funcPopup(event,'set_coll_list_params')">set_coll_list_params</a>( 'blog_ismember', 'view', array( 'ctrl' =&gt; 'items', 'tab' =&gt; <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a>, 'filter' =&gt; 'restore' ) );
<a name="l1417"><span class="linenum">1417</span></a>  
<a name="l1418"><span class="linenum">1418</span></a>          <span class="comment">/*</span>
<a name="l1419"><span class="linenum">1419</span></a>  <span class="comment">         * Add sub menu entries:</span>
<a name="l1420"><span class="linenum">1420</span></a>  <span class="comment">         * We do this here instead of _header because we need to include all filter params into regenerate_url()</span>
<a name="l1421"><span class="linenum">1421</span></a>  <span class="comment">         */</span>
<a name="l1422"><span class="linenum">1422</span></a>          <a class="function" onClick="logFunction('attach_browse_tabs')" href="../../../_functions/attach_browse_tabs.html" onMouseOver="funcPopup(event,'attach_browse_tabs')">attach_browse_tabs</a>();
<a name="l1423"><span class="linenum">1423</span></a>  
<a name="l1424"><span class="linenum">1424</span></a>          break;
<a name="l1425"><span class="linenum">1425</span></a>  }
<a name="l1426"><span class="linenum">1426</span></a>  
<a name="l1427"><span class="linenum">1427</span></a>  if( !empty(<a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a>) )
<a name="l1428"><span class="linenum">1428</span></a>  {
<a name="l1429"><span class="linenum">1429</span></a>      <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('append_path_level')" href="../../../_functions/append_path_level.html" onMouseOver="funcPopup(event,'append_path_level')">append_path_level</a>( <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a> );
<a name="l1430"><span class="linenum">1430</span></a>  
<a name="l1431"><span class="linenum">1431</span></a>      if( <a class="phpfunction" onClick="logFunction('in_array')" href="../../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>( <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a>, array( 'expert', 'full', 'list', 'pages', 'intros', 'podcasts', 'links', 'ads', 'tracker' ) ) )
<a name="l1432"><span class="linenum">1432</span></a>      { // Init JS to autcomplete the user logins
<a name="l1433"><span class="linenum">1433</span></a>          <a class="function" onClick="logFunction('init_autocomplete_login_js')" href="../../../_functions/init_autocomplete_login_js.html" onMouseOver="funcPopup(event,'init_autocomplete_login_js')">init_autocomplete_login_js</a>( 'rsc_url' );
<a name="l1434"><span class="linenum">1434</span></a>      }
<a name="l1435"><span class="linenum">1435</span></a>  }
<a name="l1436"><span class="linenum">1436</span></a>  
<a name="l1437"><span class="linenum">1437</span></a>  <span class="comment">// Load the date picker style for _item_simple.form.php and _item_expert.form.php</span>
<a name="l1438"><span class="linenum">1438</span></a>  <a class="function" onClick="logFunction('require_css')" href="../../../_functions/require_css.html" onMouseOver="funcPopup(event,'require_css')">require_css</a>( 'ui.datepicker.css' );
<a name="l1439"><span class="linenum">1439</span></a>  <span class="comment">// Load the appropriate blog navigation styles (including calendar, comment forms...):</span>
<a name="l1440"><span class="linenum">1440</span></a>  <a class="function" onClick="logFunction('require_css')" href="../../../_functions/require_css.html" onMouseOver="funcPopup(event,'require_css')">require_css</a>( <a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('rsc_url')" href="../../../_variables/rsc_url.html">$rsc_url</a>.'css/blog_base.css' ); <span class="comment">// Default styles for the blog navigation</span>
<a name="l1441"><span class="linenum">1441</span></a>  <span class="comment">// Load jquery ui css for tag autocomplete</span>
<a name="l1442"><span class="linenum">1442</span></a>  <a class="function" onClick="logFunction('require_css')" href="../../../_functions/require_css.html" onMouseOver="funcPopup(event,'require_css')">require_css</a>( <a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('rsc_url')" href="../../../_variables/rsc_url.html">$rsc_url</a>.'css/jquery/smoothness/jquery-ui.css' );
<a name="l1443"><span class="linenum">1443</span></a>  <a class="function" onClick="logFunction('require_js')" href="../../../_functions/require_js.html" onMouseOver="funcPopup(event,'require_js')">require_js</a>( 'communication.js' ); <span class="comment">// auto requires jQuery</span>
<a name="l1444"><span class="linenum">1444</span></a>  <a class="function" onClick="logFunction('init_plugins_js')" href="../../../_functions/init_plugins_js.html" onMouseOver="funcPopup(event,'init_plugins_js')">init_plugins_js</a>( 'rsc_url', <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('get_template')" href="../../../_functions/get_template.html" onMouseOver="funcPopup(event,'get_template')">get_template</a>( 'tooltip_plugin' ) );
<a name="l1445"><span class="linenum">1445</span></a>  
<a name="l1446"><span class="linenum">1446</span></a>  <span class="comment">// Load the appropriate ITEM/POST styles depending on the blog's skin:</span>
<a name="l1447"><span class="linenum">1447</span></a>  <span class="comment">// It's possible that we have no Blog on the restricted admin interface, when current User doesn't have permission to any blog</span>
<a name="l1448"><span class="linenum">1448</span></a>  if( !empty( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a> ) )
<a name="l1449"><span class="linenum">1449</span></a>  { // set blog skin ID if the Blog is set
<a name="l1450"><span class="linenum">1450</span></a>      <a class="var it6498" onMouseOver="hilite(6498)" onMouseOut="lolite()" onClick="logVariable('blog_sking_ID')" href="../../../_variables/blog_sking_ID.html">$blog_sking_ID</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a class="function" onClick="logFunction('get_skin_ID')" href="../../../_functions/get_skin_id.html" onMouseOver="funcPopup(event,'get_skin_id')">get_skin_ID</a>();
<a name="l1451"><span class="linenum">1451</span></a>      if( ! empty( <a class="var it6498" onMouseOver="hilite(6498)" onMouseOut="lolite()" onClick="logVariable('blog_sking_ID')" href="../../../_variables/blog_sking_ID.html">$blog_sking_ID</a> ) )
<a name="l1452"><span class="linenum">1452</span></a>      {
<a name="l1453"><span class="linenum">1453</span></a>          <a class="var it621" onMouseOver="hilite(621)" onMouseOut="lolite()" onClick="logVariable('SkinCache')" href="../../../_variables/SkinCache.html">$SkinCache</a> = &amp; get_SkinCache();
<a name="l1454"><span class="linenum">1454</span></a>          <span class="comment">/**</span>
<a name="l1455"><span class="linenum">1455</span></a>  <span class="comment">         * @var Skin</span>
<a name="l1456"><span class="linenum">1456</span></a>  <span class="comment">         */</span>
<a name="l1457"><span class="linenum">1457</span></a>          <a class="var it543" onMouseOver="hilite(543)" onMouseOut="lolite()" onClick="logVariable('Skin')" href="../../../_variables/Skin.html">$Skin</a> = <a class="var it621" onMouseOver="hilite(621)" onMouseOut="lolite()" onClick="logVariable('SkinCache')" href="../../../_variables/SkinCache.html">$SkinCache</a>-&gt;get_by_ID( <a class="var it6498" onMouseOver="hilite(6498)" onMouseOut="lolite()" onClick="logVariable('blog_sking_ID')" href="../../../_variables/blog_sking_ID.html">$blog_sking_ID</a> );
<a name="l1458"><span class="linenum">1458</span></a>          <a class="function" onClick="logFunction('require_css')" href="../../../_functions/require_css.html" onMouseOver="funcPopup(event,'require_css')">require_css</a>( 'basic_styles.css', 'blog' ); <span class="comment">// the REAL basic styles</span>
<a name="l1459"><span class="linenum">1459</span></a>          <a class="function" onClick="logFunction('require_css')" href="../../../_functions/require_css.html" onMouseOver="funcPopup(event,'require_css')">require_css</a>( 'item_base.css', 'blog' ); <span class="comment">// Default styles for the post CONTENT</span>
<a name="l1460"><span class="linenum">1460</span></a>          <a class="function" onClick="logFunction('require_css')" href="../../../_functions/require_css.html" onMouseOver="funcPopup(event,'require_css')">require_css</a>( <a class="var it606" onMouseOver="hilite(606)" onMouseOut="lolite()" onClick="logVariable('skins_url')" href="../../../_variables/skins_url.html">$skins_url</a>.<a class="var it543" onMouseOver="hilite(543)" onMouseOut="lolite()" onClick="logVariable('Skin')" href="../../../_variables/Skin.html">$Skin</a>-&gt;<a onClick="logVariable('folder')" class="var it9033" onMouseOver="hilite(9033)" onMouseOut="lolite()" href="../../../_variables/folder.html">folder</a>.'/item.css' ); <span class="comment">// fp&gt; TODO: this needs to be a param... &quot;of course&quot; -- if none: else item_default.css ?</span>
<a name="l1461"><span class="linenum">1461</span></a>  <span class="comment">        // else: $item_css_url = $rsc_url.'css/item_base.css';</span>
<a name="l1462"><span class="linenum">1462</span></a>      }
<a name="l1463"><span class="linenum">1463</span></a>  <span class="comment">    // else item_default.css ? is it still possible to have no skin set?</span>
<a name="l1464"><span class="linenum">1464</span></a>  }
<a name="l1465"><span class="linenum">1465</span></a>  
<a name="l1466"><span class="linenum">1466</span></a>  
<a name="l1467"><span class="linenum">1467</span></a>  <span class="comment">// Display &lt;html&gt;&lt;head&gt;...&lt;/head&gt; section! (Note: should be done early if actions do not redirect)</span>
<a name="l1468"><span class="linenum">1468</span></a>  <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_html_head')" href="../../../_functions/disp_html_head.html" onMouseOver="funcPopup(event,'disp_html_head')">disp_html_head</a>();
<a name="l1469"><span class="linenum">1469</span></a>  
<a name="l1470"><span class="linenum">1470</span></a>  <span class="comment">// Display title, menu, messages, etc. (Note: messages MUST be displayed AFTER the actions)</span>
<a name="l1471"><span class="linenum">1471</span></a>  <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_body_top')" href="../../../_functions/disp_body_top.html" onMouseOver="funcPopup(event,'disp_body_top')">disp_body_top</a>( <a class="var it456" onMouseOver="hilite(456)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../../../_variables/mode.html">$mode</a> != 'iframe' );    <span class="comment">// do NOT display stupid messages in iframe (UGLY UGLY UGLY!!!!)</span>
<a name="l1472"><span class="linenum">1472</span></a>  
<a name="l1473"><span class="linenum">1473</span></a>  
<a name="l1474"><span class="linenum">1474</span></a>  <span class="comment">/*</span>
<a name="l1475"><span class="linenum">1475</span></a>  <span class="comment"> * Display payload:</span>
<a name="l1476"><span class="linenum">1476</span></a>  <span class="comment"> */</span>
<a name="l1477"><span class="linenum">1477</span></a>  switch( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> )
<a name="l1478"><span class="linenum">1478</span></a>  {
<a name="l1479"><span class="linenum">1479</span></a>      case 'nil':
<a name="l1480"><span class="linenum">1480</span></a>  <span class="comment">        // Do nothing</span>
<a name="l1481"><span class="linenum">1481</span></a>          break;
<a name="l1482"><span class="linenum">1482</span></a>  
<a name="l1483"><span class="linenum">1483</span></a>      case 'new_switchtab': // this gets set as action by JS, when we switch tabs
<a name="l1484"><span class="linenum">1484</span></a>      case 'edit_switchtab': // this gets set as action by JS, when we switch tabs
<a name="l1485"><span class="linenum">1485</span></a>          <a class="var it978" onMouseOver="hilite(978)" onMouseOut="lolite()" onClick="logVariable('bozo_start_modified')" href="../../../_variables/bozo_start_modified.html">$bozo_start_modified</a> = true;    <span class="comment">// We want to start with a form being already modified</span>
<a name="l1486"><span class="linenum">1486</span></a>      case 'new':
<a name="l1487"><span class="linenum">1487</span></a>      case 'copy':
<a name="l1488"><span class="linenum">1488</span></a>      case 'create_edit':
<a name="l1489"><span class="linenum">1489</span></a>      case 'create':
<a name="l1490"><span class="linenum">1490</span></a>      case 'create_publish':
<a name="l1491"><span class="linenum">1491</span></a>      case 'edit':
<a name="l1492"><span class="linenum">1492</span></a>      case 'update_edit':
<a name="l1493"><span class="linenum">1493</span></a>      case 'update':    // on error
<a name="l1494"><span class="linenum">1494</span></a>      case 'update_publish':    // on error
<a name="l1495"><span class="linenum">1495</span></a>  <span class="comment">        // Begin payload block:</span>
<a name="l1496"><span class="linenum">1496</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_payload_begin')" href="../../../_functions/disp_payload_begin.html" onMouseOver="funcPopup(event,'disp_payload_begin')">disp_payload_begin</a>();
<a name="l1497"><span class="linenum">1497</span></a>  
<a name="l1498"><span class="linenum">1498</span></a>  <span class="comment">        // We never allow HTML in titles, so we always encode and decode special chars.</span>
<a name="l1499"><span class="linenum">1499</span></a>          <a class="var it981" onMouseOver="hilite(981)" onMouseOut="lolite()" onClick="logVariable('item_title')" href="../../../_variables/item_title.html">$item_title</a> = <a class="function" onClick="logFunction('htmlspecialchars_decode')" href="../../../_functions/htmlspecialchars_decode.html" onMouseOver="funcPopup(event,'htmlspecialchars_decode')">htmlspecialchars_decode</a>( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('title')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/title.html">title</a> );
<a name="l1500"><span class="linenum">1500</span></a>  
<a name="l1501"><span class="linenum">1501</span></a>          <a class="var it982" onMouseOver="hilite(982)" onMouseOut="lolite()" onClick="logVariable('item_content')" href="../../../_variables/item_content.html">$item_content</a> = <a class="function" onClick="logFunction('prepare_item_content')" href="../../../_functions/prepare_item_content.html" onMouseOver="funcPopup(event,'prepare_item_content')">prepare_item_content</a>( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('content')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/content.html">content</a> );
<a name="l1502"><span class="linenum">1502</span></a>  
<a name="l1503"><span class="linenum">1503</span></a>          if( ! <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a class="function" onClick="logFunction('get_setting')" href="../../../_functions/get_setting.html" onMouseOver="funcPopup(event,'get_setting')">get_setting</a>( 'allow_html_post' ) )
<a name="l1504"><span class="linenum">1504</span></a>          { // HTML is disallowed for this post, content is encoded in DB and we need to decode it for editing:
<a name="l1505"><span class="linenum">1505</span></a>              <a class="var it982" onMouseOver="hilite(982)" onMouseOut="lolite()" onClick="logVariable('item_content')" href="../../../_variables/item_content.html">$item_content</a> = <a class="function" onClick="logFunction('htmlspecialchars_decode')" href="../../../_functions/htmlspecialchars_decode.html" onMouseOver="funcPopup(event,'htmlspecialchars_decode')">htmlspecialchars_decode</a>( <a class="var it982" onMouseOver="hilite(982)" onMouseOut="lolite()" onClick="logVariable('item_content')" href="../../../_variables/item_content.html">$item_content</a> );
<a name="l1506"><span class="linenum">1506</span></a>          }
<a name="l1507"><span class="linenum">1507</span></a>  
<a name="l1508"><span class="linenum">1508</span></a>  <span class="comment">        // Format content for editing, if we were not already in editing...</span>
<a name="l1509"><span class="linenum">1509</span></a>          <a class="var it39" onMouseOver="hilite(39)" onMouseOut="lolite()" onClick="logVariable('Plugins_admin')" href="../../../_variables/Plugins_admin.html">$Plugins_admin</a> = &amp; get_Plugins_admin();
<a name="l1510"><span class="linenum">1510</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('load_Blog')" href="../../../_functions/load_blog.html" onMouseOver="funcPopup(event,'load_blog')">load_Blog</a>();
<a name="l1511"><span class="linenum">1511</span></a>          <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a> = array( 'object_type' =&gt; 'Item', 'object_Blog' =&gt; &amp; <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('Blog')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/Blog.html">Blog</a> );
<a name="l1512"><span class="linenum">1512</span></a>          <a class="var it39" onMouseOver="hilite(39)" onMouseOut="lolite()" onClick="logVariable('Plugins_admin')" href="../../../_variables/Plugins_admin.html">$Plugins_admin</a>-&gt;<a class="function" onClick="logFunction('unfilter_contents')" href="../../../_functions/unfilter_contents.html" onMouseOver="funcPopup(event,'unfilter_contents')">unfilter_contents</a>( <a class="var it981" onMouseOver="hilite(981)" onMouseOut="lolite()" onClick="logVariable('item_title')" href="../../../_variables/item_title.html">$item_title</a> <span class="comment">/* by ref */</span>, <a class="var it982" onMouseOver="hilite(982)" onMouseOut="lolite()" onClick="logVariable('item_content')" href="../../../_variables/item_content.html">$item_content</a> <span class="comment">/* by ref */</span>, <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('get_renderers_validated')" href="../../../_functions/get_renderers_validated.html" onMouseOver="funcPopup(event,'get_renderers_validated')">get_renderers_validated</a>(), <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a> );
<a name="l1513"><span class="linenum">1513</span></a>  
<a name="l1514"><span class="linenum">1514</span></a>  <span class="comment">        // Display VIEW:</span>
<a name="l1515"><span class="linenum">1515</span></a>          switch( <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a> )
<a name="l1516"><span class="linenum">1516</span></a>          {
<a name="l1517"><span class="linenum">1517</span></a>              case 'simple':
<a name="l1518"><span class="linenum">1518</span></a>                  <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'items/views/_item_simple.form.php' );
<a name="l1519"><span class="linenum">1519</span></a>                  break;
<a name="l1520"><span class="linenum">1520</span></a>  
<a name="l1521"><span class="linenum">1521</span></a>              case 'expert':
<a name="l1522"><span class="linenum">1522</span></a>              default:
<a name="l1523"><span class="linenum">1523</span></a>                  <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'items/views/_item_expert.form.php' );
<a name="l1524"><span class="linenum">1524</span></a>                  break;
<a name="l1525"><span class="linenum">1525</span></a>          }
<a name="l1526"><span class="linenum">1526</span></a>  
<a name="l1527"><span class="linenum">1527</span></a>  <span class="comment">        // End payload block:</span>
<a name="l1528"><span class="linenum">1528</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_payload_end')" href="../../../_functions/disp_payload_end.html" onMouseOver="funcPopup(event,'disp_payload_end')">disp_payload_end</a>();
<a name="l1529"><span class="linenum">1529</span></a>          break;
<a name="l1530"><span class="linenum">1530</span></a>  
<a name="l1531"><span class="linenum">1531</span></a>  
<a name="l1532"><span class="linenum">1532</span></a>      case 'new_mass':
<a name="l1533"><span class="linenum">1533</span></a>  <span class="comment">        // Begin payload block:</span>
<a name="l1534"><span class="linenum">1534</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_payload_begin')" href="../../../_functions/disp_payload_begin.html" onMouseOver="funcPopup(event,'disp_payload_begin')">disp_payload_begin</a>();
<a name="l1535"><span class="linenum">1535</span></a>  
<a name="l1536"><span class="linenum">1536</span></a>  <span class="comment">        // We never allow HTML in titles, so we always encode and decode special chars.</span>
<a name="l1537"><span class="linenum">1537</span></a>          <a class="var it981" onMouseOver="hilite(981)" onMouseOut="lolite()" onClick="logVariable('item_title')" href="../../../_variables/item_title.html">$item_title</a> = <a class="function" onClick="logFunction('htmlspecialchars_decode')" href="../../../_functions/htmlspecialchars_decode.html" onMouseOver="funcPopup(event,'htmlspecialchars_decode')">htmlspecialchars_decode</a>( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('title')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/title.html">title</a> );
<a name="l1538"><span class="linenum">1538</span></a>  
<a name="l1539"><span class="linenum">1539</span></a>          <a class="var it982" onMouseOver="hilite(982)" onMouseOut="lolite()" onClick="logVariable('item_content')" href="../../../_variables/item_content.html">$item_content</a> = <a class="function" onClick="logFunction('prepare_item_content')" href="../../../_functions/prepare_item_content.html" onMouseOver="funcPopup(event,'prepare_item_content')">prepare_item_content</a>( <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('content')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/content.html">content</a> );
<a name="l1540"><span class="linenum">1540</span></a>  
<a name="l1541"><span class="linenum">1541</span></a>          if( ! <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a class="function" onClick="logFunction('get_setting')" href="../../../_functions/get_setting.html" onMouseOver="funcPopup(event,'get_setting')">get_setting</a>( 'allow_html_post' ) )
<a name="l1542"><span class="linenum">1542</span></a>          { // HTML is disallowed for this post, content is encoded in DB and we need to decode it for editing:
<a name="l1543"><span class="linenum">1543</span></a>              <a class="var it982" onMouseOver="hilite(982)" onMouseOut="lolite()" onClick="logVariable('item_content')" href="../../../_variables/item_content.html">$item_content</a> = <a class="function" onClick="logFunction('htmlspecialchars_decode')" href="../../../_functions/htmlspecialchars_decode.html" onMouseOver="funcPopup(event,'htmlspecialchars_decode')">htmlspecialchars_decode</a>( <a class="var it982" onMouseOver="hilite(982)" onMouseOut="lolite()" onClick="logVariable('item_content')" href="../../../_variables/item_content.html">$item_content</a> );
<a name="l1544"><span class="linenum">1544</span></a>          }
<a name="l1545"><span class="linenum">1545</span></a>  
<a name="l1546"><span class="linenum">1546</span></a>  <span class="comment">        // Format content for editing, if we were not already in editing...</span>
<a name="l1547"><span class="linenum">1547</span></a>          <a class="var it39" onMouseOver="hilite(39)" onMouseOut="lolite()" onClick="logVariable('Plugins_admin')" href="../../../_variables/Plugins_admin.html">$Plugins_admin</a> = &amp; get_Plugins_admin();
<a name="l1548"><span class="linenum">1548</span></a>          <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('load_Blog')" href="../../../_functions/load_blog.html" onMouseOver="funcPopup(event,'load_blog')">load_Blog</a>();
<a name="l1549"><span class="linenum">1549</span></a>          <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a> = array( 'object_type' =&gt; 'Item', 'object_Blog' =&gt; &amp; <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a onClick="logVariable('Blog')" class="var it8994" onMouseOver="hilite(8994)" onMouseOut="lolite()" href="../../../_variables/Blog.html">Blog</a> );
<a name="l1550"><span class="linenum">1550</span></a>          <a class="var it39" onMouseOver="hilite(39)" onMouseOut="lolite()" onClick="logVariable('Plugins_admin')" href="../../../_variables/Plugins_admin.html">$Plugins_admin</a>-&gt;<a class="function" onClick="logFunction('unfilter_contents')" href="../../../_functions/unfilter_contents.html" onMouseOver="funcPopup(event,'unfilter_contents')">unfilter_contents</a>( <a class="var it981" onMouseOver="hilite(981)" onMouseOut="lolite()" onClick="logVariable('item_title')" href="../../../_variables/item_title.html">$item_title</a> <span class="comment">/* by ref */</span>, <a class="var it982" onMouseOver="hilite(982)" onMouseOut="lolite()" onClick="logVariable('item_content')" href="../../../_variables/item_content.html">$item_content</a> <span class="comment">/* by ref */</span>, <a class="var it979" onMouseOver="hilite(979)" onMouseOut="lolite()" onClick="logVariable('edited_Item')" href="../../../_variables/edited_Item.html">$edited_Item</a>-&gt;<a class="function" onClick="logFunction('get_renderers_validated')" href="../../../_functions/get_renderers_validated.html" onMouseOver="funcPopup(event,'get_renderers_validated')">get_renderers_validated</a>(), <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a> );
<a name="l1551"><span class="linenum">1551</span></a>  
<a name="l1552"><span class="linenum">1552</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'items/views/_item_mass.form.php' );
<a name="l1553"><span class="linenum">1553</span></a>  
<a name="l1554"><span class="linenum">1554</span></a>  <span class="comment">        // End payload block:</span>
<a name="l1555"><span class="linenum">1555</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_payload_end')" href="../../../_functions/disp_payload_end.html" onMouseOver="funcPopup(event,'disp_payload_end')">disp_payload_end</a>();
<a name="l1556"><span class="linenum">1556</span></a>  
<a name="l1557"><span class="linenum">1557</span></a>          break;
<a name="l1558"><span class="linenum">1558</span></a>  
<a name="l1559"><span class="linenum">1559</span></a>  
<a name="l1560"><span class="linenum">1560</span></a>      case 'view':
<a name="l1561"><span class="linenum">1561</span></a>      case 'delete':
<a name="l1562"><span class="linenum">1562</span></a>  <span class="comment">        // View a single post:</span>
<a name="l1563"><span class="linenum">1563</span></a>  
<a name="l1564"><span class="linenum">1564</span></a>  <span class="comment">        // Memorize 'p' in case we reload while changing some display settings</span>
<a name="l1565"><span class="linenum">1565</span></a>          <a class="function" onClick="logFunction('memorize_param')" href="../../../_functions/memorize_param.html" onMouseOver="funcPopup(event,'memorize_param')">memorize_param</a>( 'p', 'integer', NULL );
<a name="l1566"><span class="linenum">1566</span></a>  
<a name="l1567"><span class="linenum">1567</span></a>  <span class="comment">         // Begin payload block:</span>
<a name="l1568"><span class="linenum">1568</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_payload_begin')" href="../../../_functions/disp_payload_begin.html" onMouseOver="funcPopup(event,'disp_payload_begin')">disp_payload_begin</a>();
<a name="l1569"><span class="linenum">1569</span></a>  
<a name="l1570"><span class="linenum">1570</span></a>  <span class="comment">        // We use the &quot;full&quot; view for displaying single posts:</span>
<a name="l1571"><span class="linenum">1571</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'items/views/_item_list_full.view.php' );
<a name="l1572"><span class="linenum">1572</span></a>  
<a name="l1573"><span class="linenum">1573</span></a>  <span class="comment">        // End payload block:</span>
<a name="l1574"><span class="linenum">1574</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_payload_end')" href="../../../_functions/disp_payload_end.html" onMouseOver="funcPopup(event,'disp_payload_end')">disp_payload_end</a>();
<a name="l1575"><span class="linenum">1575</span></a>  
<a name="l1576"><span class="linenum">1576</span></a>          break;
<a name="l1577"><span class="linenum">1577</span></a>  
<a name="l1578"><span class="linenum">1578</span></a>      case 'history':
<a name="l1579"><span class="linenum">1579</span></a>          <a class="function" onClick="logFunction('memorize_param')" href="../../../_functions/memorize_param.html" onMouseOver="funcPopup(event,'memorize_param')">memorize_param</a>( 'action', 'string', NULL );
<a name="l1580"><span class="linenum">1580</span></a>  
<a name="l1581"><span class="linenum">1581</span></a>  <span class="comment">        // Begin payload block:</span>
<a name="l1582"><span class="linenum">1582</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_payload_begin')" href="../../../_functions/disp_payload_begin.html" onMouseOver="funcPopup(event,'disp_payload_begin')">disp_payload_begin</a>();
<a name="l1583"><span class="linenum">1583</span></a>  
<a name="l1584"><span class="linenum">1584</span></a>  <span class="comment">        // view:</span>
<a name="l1585"><span class="linenum">1585</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'items/views/_item_history.view.php' );
<a name="l1586"><span class="linenum">1586</span></a>  
<a name="l1587"><span class="linenum">1587</span></a>  <span class="comment">        // End payload block:</span>
<a name="l1588"><span class="linenum">1588</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_payload_end')" href="../../../_functions/disp_payload_end.html" onMouseOver="funcPopup(event,'disp_payload_end')">disp_payload_end</a>();
<a name="l1589"><span class="linenum">1589</span></a>          break;
<a name="l1590"><span class="linenum">1590</span></a>  
<a name="l1591"><span class="linenum">1591</span></a>      case 'history_details':
<a name="l1592"><span class="linenum">1592</span></a>  <span class="comment">        // Begin payload block:</span>
<a name="l1593"><span class="linenum">1593</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_payload_begin')" href="../../../_functions/disp_payload_begin.html" onMouseOver="funcPopup(event,'disp_payload_begin')">disp_payload_begin</a>();
<a name="l1594"><span class="linenum">1594</span></a>  
<a name="l1595"><span class="linenum">1595</span></a>  <span class="comment">        // view:</span>
<a name="l1596"><span class="linenum">1596</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'items/views/_item_history_details.view.php' );
<a name="l1597"><span class="linenum">1597</span></a>  
<a name="l1598"><span class="linenum">1598</span></a>  <span class="comment">        // End payload block:</span>
<a name="l1599"><span class="linenum">1599</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_payload_end')" href="../../../_functions/disp_payload_end.html" onMouseOver="funcPopup(event,'disp_payload_end')">disp_payload_end</a>();
<a name="l1600"><span class="linenum">1600</span></a>          break;
<a name="l1601"><span class="linenum">1601</span></a>  
<a name="l1602"><span class="linenum">1602</span></a>      case 'history_compare':
<a name="l1603"><span class="linenum">1603</span></a>  <span class="comment">        // Begin payload block:</span>
<a name="l1604"><span class="linenum">1604</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_payload_begin')" href="../../../_functions/disp_payload_begin.html" onMouseOver="funcPopup(event,'disp_payload_begin')">disp_payload_begin</a>();
<a name="l1605"><span class="linenum">1605</span></a>  
<a name="l1606"><span class="linenum">1606</span></a>  <span class="comment">        // view:</span>
<a name="l1607"><span class="linenum">1607</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'items/views/_item_history_compare.view.php' );
<a name="l1608"><span class="linenum">1608</span></a>  
<a name="l1609"><span class="linenum">1609</span></a>  <span class="comment">        // End payload block:</span>
<a name="l1610"><span class="linenum">1610</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_payload_end')" href="../../../_functions/disp_payload_end.html" onMouseOver="funcPopup(event,'disp_payload_end')">disp_payload_end</a>();
<a name="l1611"><span class="linenum">1611</span></a>          break;
<a name="l1612"><span class="linenum">1612</span></a>  
<a name="l1613"><span class="linenum">1613</span></a>      case 'mass_edit' :
<a name="l1614"><span class="linenum">1614</span></a>  <span class="comment">        // Begin payload block:</span>
<a name="l1615"><span class="linenum">1615</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a onClick="logVariable('disp_payload_begin')" class="var it8956" onMouseOver="hilite(8956)" onMouseOut="lolite()" href="../../../_variables/disp_payload_begin.html">disp_payload_begin</a> ();
<a name="l1616"><span class="linenum">1616</span></a>  
<a name="l1617"><span class="linenum">1617</span></a>  <span class="comment">        // view:</span>
<a name="l1618"><span class="linenum">1618</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a onClick="logVariable('disp_view')" class="var it8956" onMouseOver="hilite(8956)" onMouseOut="lolite()" href="../../../_variables/disp_view.html">disp_view</a> ( 'items/views/_item_mass_edit.view.php' );
<a name="l1619"><span class="linenum">1619</span></a>  
<a name="l1620"><span class="linenum">1620</span></a>  <span class="comment">        // End payload block:</span>
<a name="l1621"><span class="linenum">1621</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a onClick="logVariable('disp_payload_end')" class="var it8956" onMouseOver="hilite(8956)" onMouseOut="lolite()" href="../../../_variables/disp_payload_end.html">disp_payload_end</a> ();
<a name="l1622"><span class="linenum">1622</span></a>          break;
<a name="l1623"><span class="linenum">1623</span></a>  
<a name="l1624"><span class="linenum">1624</span></a>      case 'make_posts_pre':
<a name="l1625"><span class="linenum">1625</span></a>  <span class="comment">        // Make posts with selected images action:</span>
<a name="l1626"><span class="linenum">1626</span></a>  
<a name="l1627"><span class="linenum">1627</span></a>          <a class="var it782" onMouseOver="hilite(782)" onMouseOut="lolite()" onClick="logVariable('FileRootCache')" href="../../../_variables/FileRootCache.html">$FileRootCache</a> = &amp; get_FileRootCache();
<a name="l1628"><span class="linenum">1628</span></a>  <span class="comment">        // getting root</span>
<a name="l1629"><span class="linenum">1629</span></a>          <a class="var it1677" onMouseOver="hilite(1677)" onMouseOut="lolite()" onClick="logVariable('root')" href="../../../_variables/root.html">$root</a> = <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>(&quot;root&quot;);
<a name="l1630"><span class="linenum">1630</span></a>          global <a class="var it1682" onMouseOver="hilite(1682)" onMouseOut="lolite()" onClick="logVariable('fm_FileRoot')" href="../../../_variables/fm_FileRoot.html">$fm_FileRoot</a>;
<a name="l1631"><span class="linenum">1631</span></a>          <a class="var it1682" onMouseOver="hilite(1682)" onMouseOut="lolite()" onClick="logVariable('fm_FileRoot')" href="../../../_variables/fm_FileRoot.html">$fm_FileRoot</a> = &amp; <a class="var it782" onMouseOver="hilite(782)" onMouseOut="lolite()" onClick="logVariable('FileRootCache')" href="../../../_variables/FileRootCache.html">$FileRootCache</a>-&gt;get_by_ID(<a class="var it1677" onMouseOver="hilite(1677)" onMouseOut="lolite()" onClick="logVariable('root')" href="../../../_variables/root.html">$root</a>, true);
<a name="l1632"><span class="linenum">1632</span></a>  
<a name="l1633"><span class="linenum">1633</span></a>  <span class="comment">        // Begin payload block:</span>
<a name="l1634"><span class="linenum">1634</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_payload_begin')" href="../../../_functions/disp_payload_begin.html" onMouseOver="funcPopup(event,'disp_payload_begin')">disp_payload_begin</a>();
<a name="l1635"><span class="linenum">1635</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l1636"><span class="linenum">1636</span></a>          <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'file' );
<a name="l1637"><span class="linenum">1637</span></a>  
<a name="l1638"><span class="linenum">1638</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'items/views/_file_create_posts.form.php' );
<a name="l1639"><span class="linenum">1639</span></a>  <span class="comment">        // End payload block:</span>
<a name="l1640"><span class="linenum">1640</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_payload_end')" href="../../../_functions/disp_payload_end.html" onMouseOver="funcPopup(event,'disp_payload_end')">disp_payload_end</a>();
<a name="l1641"><span class="linenum">1641</span></a>          break;
<a name="l1642"><span class="linenum">1642</span></a>  
<a name="l1643"><span class="linenum">1643</span></a>      case 'list':
<a name="l1644"><span class="linenum">1644</span></a>      default:
<a name="l1645"><span class="linenum">1645</span></a>  <span class="comment">        // Begin payload block:</span>
<a name="l1646"><span class="linenum">1646</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_payload_begin')" href="../../../_functions/disp_payload_begin.html" onMouseOver="funcPopup(event,'disp_payload_begin')">disp_payload_begin</a>();
<a name="l1647"><span class="linenum">1647</span></a>  
<a name="l1648"><span class="linenum">1648</span></a>  <span class="comment">        // fplanque&gt; Note: this is depressing, but I have to put a table back here</span>
<a name="l1649"><span class="linenum">1649</span></a>  <span class="comment">        // just because IE supports standards really badly! :'(</span>
<a name="l1650"><span class="linenum">1650</span></a>          <a class="var it6213" onMouseOver="hilite(6213)" onMouseOut="lolite()" onClick="logVariable('table_browse_template')" href="../../../_variables/table_browse_template.html">$table_browse_template</a> = <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('get_template')" href="../../../_functions/get_template.html" onMouseOver="funcPopup(event,'get_template')">get_template</a>( 'table_browse' );
<a name="l1651"><span class="linenum">1651</span></a>          echo <a class="var it6213" onMouseOver="hilite(6213)" onMouseOut="lolite()" onClick="logVariable('table_browse_template')" href="../../../_variables/table_browse_template.html">$table_browse_template</a>['table_start'];
<a name="l1652"><span class="linenum">1652</span></a>  
<a name="l1653"><span class="linenum">1653</span></a>          if( <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a> == 'manual' )
<a name="l1654"><span class="linenum">1654</span></a>          {
<a name="l1655"><span class="linenum">1655</span></a>              echo <a class="var it6213" onMouseOver="hilite(6213)" onMouseOut="lolite()" onClick="logVariable('table_browse_template')" href="../../../_variables/table_browse_template.html">$table_browse_template</a>['full_col_start'];
<a name="l1656"><span class="linenum">1656</span></a>          }
<a name="l1657"><span class="linenum">1657</span></a>          else{
<a name="l1658"><span class="linenum">1658</span></a>              echo <a class="var it6213" onMouseOver="hilite(6213)" onMouseOut="lolite()" onClick="logVariable('table_browse_template')" href="../../../_variables/table_browse_template.html">$table_browse_template</a>['left_col_start'];
<a name="l1659"><span class="linenum">1659</span></a>          }
<a name="l1660"><span class="linenum">1660</span></a>  
<a name="l1661"><span class="linenum">1661</span></a>              switch( <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a> )
<a name="l1662"><span class="linenum">1662</span></a>              {
<a name="l1663"><span class="linenum">1663</span></a>                  case 'tracker':
<a name="l1664"><span class="linenum">1664</span></a>  <span class="comment">                    // Display VIEW:</span>
<a name="l1665"><span class="linenum">1665</span></a>                      <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'items/views/_item_list_track.view.php' );
<a name="l1666"><span class="linenum">1666</span></a>                      break;
<a name="l1667"><span class="linenum">1667</span></a>  
<a name="l1668"><span class="linenum">1668</span></a>                  case 'full':
<a name="l1669"><span class="linenum">1669</span></a>  <span class="comment">                    // Display VIEW:</span>
<a name="l1670"><span class="linenum">1670</span></a>                      <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'items/views/_item_list_full.view.php' );
<a name="l1671"><span class="linenum">1671</span></a>                      break;
<a name="l1672"><span class="linenum">1672</span></a>  
<a name="l1673"><span class="linenum">1673</span></a>                  case 'manual':
<a name="l1674"><span class="linenum">1674</span></a>  <span class="comment">                    // Display VIEW:</span>
<a name="l1675"><span class="linenum">1675</span></a>                      <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'items/views/_item_list_manual.view.php' );
<a name="l1676"><span class="linenum">1676</span></a>                      break;
<a name="l1677"><span class="linenum">1677</span></a>  
<a name="l1678"><span class="linenum">1678</span></a>                  case 'list':
<a name="l1679"><span class="linenum">1679</span></a>                  case 'pages':
<a name="l1680"><span class="linenum">1680</span></a>                  case 'intros':
<a name="l1681"><span class="linenum">1681</span></a>                  case 'podcasts':
<a name="l1682"><span class="linenum">1682</span></a>                  default:
<a name="l1683"><span class="linenum">1683</span></a>  <span class="comment">                    // Display VIEW:</span>
<a name="l1684"><span class="linenum">1684</span></a>                      <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'items/views/_item_list_table.view.php' );
<a name="l1685"><span class="linenum">1685</span></a>                      break;
<a name="l1686"><span class="linenum">1686</span></a>              }
<a name="l1687"><span class="linenum">1687</span></a>  
<a name="l1688"><span class="linenum">1688</span></a>  <span class="comment">            // TODO: a specific field for the backoffice, at the bottom of the page</span>
<a name="l1689"><span class="linenum">1689</span></a>  <span class="comment">            // would be used for moderation rules.</span>
<a name="l1690"><span class="linenum">1690</span></a>              if( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>( 'notes' ) )
<a name="l1691"><span class="linenum">1691</span></a>              {
<a name="l1692"><span class="linenum">1692</span></a>                  <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('block_item_Widget')" href="../../../_variables/block_item_Widget.html">$block_item_Widget</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Widget')" href="../../../_classes/widget.html" onMouseOver="classPopup(event,'widget')">Widget</a>( 'block_item' );
<a name="l1693"><span class="linenum">1693</span></a>                  <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('block_item_Widget')" href="../../../_variables/block_item_Widget.html">$block_item_Widget</a>-&gt;<a onClick="logVariable('title')" class="var it8999" onMouseOver="hilite(8999)" onMouseOut="lolite()" href="../../../_variables/title.html">title</a> = <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Notes');
<a name="l1694"><span class="linenum">1694</span></a>  <span class="comment">                // show a quicklink to edit if user has permission:</span>
<a name="l1695"><span class="linenum">1695</span></a>  <span class="comment">/* fp&gt; TODO: use an action icon (will appear on the right)</span>
<a name="l1696"><span class="linenum">1696</span></a>  <span class="comment">                if( $current_User-&gt;check_perm( 'blog_properties', 'edit', false, $blog ) )</span>
<a name="l1697"><span class="linenum">1697</span></a>  <span class="comment">                    $block_item_Widget-&gt;title .=    ' &lt;a href=&quot;?ctrl=coll_settings&amp;amp;tab=advanced&amp;amp;blog='.$Blog-&gt;ID.'#ffield_blog_notes&quot;&gt;'.get_icon( 'edit' ).'&lt;/a&gt;';</span>
<a name="l1698"><span class="linenum">1698</span></a>  <span class="comment">*/</span>
<a name="l1699"><span class="linenum">1699</span></a>                  <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('block_item_Widget')" href="../../../_variables/block_item_Widget.html">$block_item_Widget</a>-&gt;<a class="function" onClick="logFunction('disp_template_replaced')" href="../../../_functions/disp_template_replaced.html" onMouseOver="funcPopup(event,'disp_template_replaced')">disp_template_replaced</a>( 'block_start' );
<a name="l1700"><span class="linenum">1700</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a class="function" onClick="logFunction('disp')" href="../../../_functions/disp.html" onMouseOver="funcPopup(event,'disp')">disp</a>( 'notes', 'htmlbody' );
<a name="l1701"><span class="linenum">1701</span></a>                  <a class="var it130" onMouseOver="hilite(130)" onMouseOut="lolite()" onClick="logVariable('block_item_Widget')" href="../../../_variables/block_item_Widget.html">$block_item_Widget</a>-&gt;<a class="function" onClick="logFunction('disp_template_replaced')" href="../../../_functions/disp_template_replaced.html" onMouseOver="funcPopup(event,'disp_template_replaced')">disp_template_replaced</a>( 'block_end' );
<a name="l1702"><span class="linenum">1702</span></a>              }
<a name="l1703"><span class="linenum">1703</span></a>  
<a name="l1704"><span class="linenum">1704</span></a>          echo <a class="var it6213" onMouseOver="hilite(6213)" onMouseOut="lolite()" onClick="logVariable('table_browse_template')" href="../../../_variables/table_browse_template.html">$table_browse_template</a>['left_col_end'];
<a name="l1705"><span class="linenum">1705</span></a>  
<a name="l1706"><span class="linenum">1706</span></a>          if( <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../../_variables/tab.html">$tab</a> != 'manual' )
<a name="l1707"><span class="linenum">1707</span></a>          {
<a name="l1708"><span class="linenum">1708</span></a>              echo <a class="var it6213" onMouseOver="hilite(6213)" onMouseOut="lolite()" onClick="logVariable('table_browse_template')" href="../../../_variables/table_browse_template.html">$table_browse_template</a>['right_col_start'];
<a name="l1709"><span class="linenum">1709</span></a>  <span class="comment">                // Display VIEW:</span>
<a name="l1710"><span class="linenum">1710</span></a>                  <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'items/views/_item_list_sidebar.view.php' );
<a name="l1711"><span class="linenum">1711</span></a>              echo <a class="var it6213" onMouseOver="hilite(6213)" onMouseOut="lolite()" onClick="logVariable('table_browse_template')" href="../../../_variables/table_browse_template.html">$table_browse_template</a>['right_col_end'];
<a name="l1712"><span class="linenum">1712</span></a>          }
<a name="l1713"><span class="linenum">1713</span></a>  
<a name="l1714"><span class="linenum">1714</span></a>          echo <a class="var it6213" onMouseOver="hilite(6213)" onMouseOut="lolite()" onClick="logVariable('table_browse_template')" href="../../../_variables/table_browse_template.html">$table_browse_template</a>['table_end'];
<a name="l1715"><span class="linenum">1715</span></a>  
<a name="l1716"><span class="linenum">1716</span></a>  <span class="comment">        // End payload block:</span>
<a name="l1717"><span class="linenum">1717</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_payload_end')" href="../../../_functions/disp_payload_end.html" onMouseOver="funcPopup(event,'disp_payload_end')">disp_payload_end</a>();
<a name="l1718"><span class="linenum">1718</span></a>          break;
<a name="l1719"><span class="linenum">1719</span></a>  }
<a name="l1720"><span class="linenum">1720</span></a>  
<a name="l1721"><span class="linenum">1721</span></a>  <span class="comment">// Display body bottom, debug info and close &lt;/html&gt;:</span>
<a name="l1722"><span class="linenum">1722</span></a>  <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_global_footer')" href="../../../_functions/disp_global_footer.html" onMouseOver="funcPopup(event,'disp_global_footer')">disp_global_footer</a>();
<a name="l1723"><span class="linenum">1723</span></a>  
<a name="l1724"><span class="linenum">1724</span></a>  ?&gt;
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'param': ['param', 'Sets a parameter with values from the request or to provided default, except if param is already set! ', [['blogs/inc/_core','_param.funcs.php',50]], 1906],
'init_tokeninput_js': ['init_tokeninput_js', 'Registers headlines for initialization of jQuery Tokeninput plugin ', [['blogs/inc/_core','_template.funcs.php',1348]], 8],
'disp_template_replaced': ['disp_template_replaced', 'Display a template param with its variables replaced ', [['blogs/inc/_core/ui','_uiwidget.class.php',121]], 50],
'begin': ['begin', 'BEGIN A TRANSCATION ', [['blogs/inc/_core/model/db','_db.class.php',1547]], 101],
'get_skin_id': ['get_skin_id', '', [['blogs/inc/collections/model','_blog.class.php',2634]], 13],
'check_categories': ['check_categories', '', [['blogs/inc/items/model','_item.funcs.php',1984]], 4],
'debug_die': ['debug_die', 'Outputs Unexpected Error message. When in debug mode it also prints a backtrace. ', [['blogs/inc/_core','_misc.funcs.php',2535]], 216],
'dbupdate': ['dbupdate', 'Update the DB based on previously recorded changes ', [['blogs/inc/chapters/model','_chapter.class.php',317],['blogs/inc/collections/model','_collsettings.class.php',260],['blogs/inc/users/model','_group.class.php',470],['blogs/inc/widgets/model','_widget.class.php',757],['blogs/inc/collections/model','_blog.class.php',2327],['blogs/inc/settings/model','_abstractsettings.class.php',593],['blogs/inc/users/model','_user.class.php',2934],['blogs/inc/skins/model','_skin.class.php',348],['blogs/inc/comments/model','_comment.class.php',3470],['blogs/inc/users/model','_groupsettings.class.php',159],['blogs/inc/cron/model','_cronjob.class.php',207],['blogs/inc/items/model','_item.class.php',4867],['blogs/inc/slugs/model','_slug.class.php',265],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',129],['blogs/inc/files/model','_file.class.php',1739]], 266],
'check_perm_posttype': ['check_perm_posttype', 'Assert that the supplied post type can be used by the current user in the post\'s extra categories\' context. ', [['blogs/inc/items/model','_item.funcs.php',1867]], 4],
'check_categories_nosave': ['check_categories_nosave', '', [['blogs/inc/items/model','_item.funcs.php',2135]], 11],
'get_visibility_statuses': ['get_visibility_statuses', 'Get available post statuses ', [['blogs/inc/collections/model','_blog.funcs.php',897]], 60],
'param_action': ['param_action', 'Get the action from params. ', [['blogs/inc/_core','_param.funcs.php',478]], 54],
'antispam_block_request': ['antispam_block_request', 'Block request by IP address, Domain of current user or block because of a Plugin Bock by Plugin: e.g. GeoIP plugin can block the request if it comes from a blocked country ', [['blogs/inc/antispam/model','_antispam.funcs.php',479]], 22],
'unfilter_contents': ['unfilter_contents', 'UnFilter (post) contents by calling the relevant filter plugins. ', [['blogs/inc/plugins/model','_plugins_admin.class.php',1511]], 7],
'history_info_icon': ['history_info_icon', 'Create icon with dataobject history ', [['blogs/inc/_core/model/dataobjects','_dataobject.class.php',842]], 3],
'assert_received_crumb': ['assert_received_crumb', 'Assert that we received a valid crumb for the object we want to act on. ', [['blogs/inc/sessions/model','_session.class.php',582]], 256],
'disp_payload_end': ['disp_payload_end', 'Display the end of a payload block ', [['blogs/skins_adm','_adminUI_general.class.php',651]], 91],
'param_error': ['param_error', 'Add an error for a variable, either to the Form\'s field and/or the global {@link $Messages} object. ', [['blogs/inc/_core','_param.funcs.php',1519]], 132],
'locale_datefmt': ['locale_datefmt', 'Returns the current locale\'s default date format ', [['blogs/inc/locales','_locale.funcs.php',399]], 54],
'init_list_mode': ['init_list_mode', 'Initialize list mode; Several actions need this. ', [['blogs/inc/items','items.ctrl.php',1145]], 3],
'get_blog_id': ['get_blog_id', '', [['blogs/inc/items/model','_itemlight.class.php',733]], 33],
'set_coll_list_params': ['set_coll_list_params', 'Set params for blog list. ', [['blogs/skins_adm','_adminUI_general.class.php',710]], 16],
'dbdelete': ['dbdelete', 'Delete message and dependencies from database ', [['blogs/inc/messaging/model','_message.class.php',411],['blogs/inc/users/model','_group.class.php',489],['blogs/inc/collections/model','_blog.class.php',2361],['blogs/inc/users/model','_user.class.php',2998],['blogs/inc/comments/model','_comment.class.php',3568],['blogs/inc/items/model','_item.class.php',5055],['blogs/inc/messaging/model','_thread.class.php',418],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',331]], 57],
'url_crumb': ['url_crumb', 'Create a crumb param to be passed in action urls... ', [['blogs/inc/_core','_url.funcs.php',579]], 248],
'htmlspecialchars_decode': ['htmlspecialchars_decode', '', [['blogs/rsc/js/multiupload','fileuploader.js',74],['blogs/inc/_core','_misc.funcs.php',6144]], 13],
'disp': ['disp', 'TEMPLATE TAG ', [['blogs/inc/_core/model','_log.class.php',257],['blogs/inc/_core/model','_log.class.php',613],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',601],['blogs/inc/_core/model','_messages.class.php',159]], 66],
'get_history_url': ['get_history_url', 'Get URL to history of Item ', [['blogs/inc/items/model','_itemlight.class.php',1379]], 2],
'header_redirect': ['header_redirect', 'Sends HTTP header to redirect to the previous location (which can be given as function parameter, GET parameter (redirect_to), is taken from {@link Hit::$referer} or {@link $baseurl}). ', [['blogs/inc/_core','_template.funcs.php',110]], 373],
'rollback': ['rollback', 'Rollback current transaction ', [['blogs/inc/_core/model/db','_db.class.php',1621]], 38],
'set_working_blog': ['set_working_blog', 'Set working blog to a new value and memorize it in user settings if needed. ', [['blogs/inc/collections/model','_blog.funcs.php',305]], 21],
'memorize_param': ['memorize_param', 'Set a param (global) & Memorize it for automatic future use in regenerate_url() ', [['blogs/inc/_core','_param.funcs.php',1618]], 101],
'evo_htmlspecialchars': ['evo_htmlspecialchars', 'Wrapper function for htmlspecialchars to use the $evo_charset as default charset ', [['blogs/inc/_core','_misc.funcs.php',759]], 138],
'init_field_editor_js': ['init_field_editor_js', '', [['blogs/inc/_core','_template.funcs.php',2761]], 2],
'date_i18n': ['date_i18n', 'Date internationalization: same as date() formatting but with i18n support. ', [['blogs/inc/_core','_misc.funcs.php',1334]], 23],
'url_add_param': ['url_add_param', 'Add param(s) at the end of an URL, using either "?" or "&amp;" depending on existing url ', [['blogs/inc/_core','_url.funcs.php',507]], 241],
'dbsave': ['dbsave', 'Updates session data in database. ', [['blogs/inc/sessions/model','_session.class.php',472],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',309]], 49],
'init_plugins_js': ['init_plugins_js', 'Registers headlines required to display a bubbletip to the right of plugin help icon. ', [['blogs/inc/_core','_template.funcs.php',1274]], 6],
'attach_browse_tabs': ['attach_browse_tabs', 'Used by the items & the comments controllers ', [['blogs/inc/items/model','_item.funcs.php',1366]], 7],
'require_js_helper': ['require_js_helper', 'Memorize that a specific js helper will be required by the current page. This allows to require JS + SS + do init. ', [['blogs/inc/_core','_template.funcs.php',994]], 31],
'set_path': ['set_path', 'Set the full selected path. ', [['blogs/skins_adm','_adminUI_general.class.php',1350]], 77],
'dget': ['dget', 'Get a ready-to-display member param by its name ', [['blogs/inc/_core/model/dataobjects','_dataobject.class.php',586]], 225],
'check_and_clear_inline_images': ['check_and_clear_inline_images', 'Check if the post contains inline image placeholders without corresponding attachemnt file. Removes the invalid inline image placeholders from the item content. ', [['blogs/inc/items/model','_item.class.php',1171]], 2],
'trigger_event': ['trigger_event', 'Call all plugins for a given event. ', [['blogs/inc/plugins/model','_plugins.class.php',827]], 114],
'set_creator_location': ['set_creator_location', 'Set the Item location from the current user. Use to create a new post. ', [['blogs/inc/items/model','_item.class.php',4588]], 8],
'ts_': ['ts_', 'Translate and escape single quotes. ', [['blogs/inc/locales','_locale.funcs.php',247],['blogs/inc/skins/model','_skin.class.php',703],['blogs/inc/plugins','_plugin.class.php',2665]], 242],
'get_default_cat_id': ['get_default_cat_id', 'Get default category for current blog ', [['blogs/inc/collections/model','_blog.class.php',1566]], 20],
'regenerate_url': ['regenerate_url', 'Regenerate current URL from parameters This may clean it up But it is also useful when generating static pages: you cannot rely on $_REQUEST[] ', [['blogs/inc/_core','_param.funcs.php',1743]], 456],
'breadcrumbpath_init': ['breadcrumbpath_init', 'Note: These are not real breadcrumbs. It\'s just "so to speak" for a hierarchical path. ', [['blogs/skins_adm','_adminUI_general.class.php',173]], 55],
'load_funcs': ['load_funcs', '', [['blogs/inc/_core','_misc.funcs.php',115]], 214],
'disp_body_top': ['disp_body_top', 'Dsiplay the top of the HTML <body>... ', [['blogs/skins_adm','_adminUI_general.class.php',515]], 58],
'b2edit_reload': ['b2edit_reload', 'Submits the form after setting its action attribute to "newaction" and the blog value to "blog" (if given). ', [['blogs/rsc/js','admin.js',77]], 9],
'param_request': ['param_request', 'Get a param from Request and save it to Settings, or default to previously saved user setting. ', [['blogs/inc/settings/model','_abstractsettings.class.php',734],['blogs/inc/users/model','_usersettings.class.php',236]], 13],
'load_from_request': ['load_from_request', 'Init filter params from Request params ', [['blogs/inc/items/model','_itemlistlight.class.php',336],['blogs/inc/chapters/model','_chapter.class.php',98],['blogs/inc/users/model','_userfield.class.php',179],['blogs/inc/generic/model','_genericelement.class.php',82],['blogs/inc/messaging/model','_message.class.php',89],['blogs/inc/sessions/model','_goalcat.class.php',55],['blogs/inc/users/model','_group.class.php',118],['blogs/inc/widgets/model','_widget.class.php',145],['blogs/inc/regional/model','_region.class.php',78],['blogs/inc/regional/model','_city.class.php',80],['blogs/inc/collections/model','_blog.class.php',300],['blogs/inc/users/model','_user.class.php',272],['blogs/inc/users/model','_userlist.class.php',253],['blogs/inc/generic/model','_genericcategory.class.php',80],['blogs/inc/tools/model','_emailaddress.class.php',99],['blogs/inc/skins/model','_skin.class.php',136],['blogs/inc/items/model','_itemtype.class.php',78],['blogs/inc/regional/model','_country.class.php',82],['blogs/inc/email_campaigns/model','_emailcampaign.class.php',186],['blogs/inc/cron/model','_cronjob.class.php',122],['blogs/inc/items/model','_item.class.php',522],['blogs/inc/files/model','_filetype.class.php',84],['blogs/inc/comments/model','_commentlist.class.php',266],['blogs/inc/sessions/model','_domain.class.php',63],['blogs/inc/users/model','_userfieldgroup.class.php',73],['blogs/inc/slugs/model','_slug.class.php',94],['blogs/inc/regional/model','_currency.class.php',74],['blogs/inc/messaging/model','_thread.class.php',160],['blogs/inc/maintenance/model','_backup.class.php',169],['blogs/inc/widgets/widgets','_coll_tag_cloud.widget.php',49],['blogs/inc/regional/model','_subregion.class.php',90],['blogs/inc/antispam/model','_iprange.class.php',95],['blogs/inc/sessions/model','_goal.class.php',110]], 79],
'gen_blogurl': ['gen_blogurl', 'Generate blog URL. That is the URL of the main page/home page of the blog. This will nto necessarily be a folder. For example, it can end in index.php?blog=4 ', [['blogs/inc/collections/model','_blog.class.php',1127]], 115],
'load_blog': ['load_blog', '', [['blogs/inc/chapters/model','_chapter.class.php',277],['blogs/inc/items/model','_itemlight.class.php',1342],['blogs/inc/links/model','_linkuser.class.php',126],['blogs/inc/links/model','_linkitem.class.php',137],['blogs/inc/links/model','_linkcomment.class.php',113]], 56],
'prepare_item_content': ['prepare_item_content', 'Prepare item content ', [['blogs/inc/items/model','_item.funcs.php',2987]], 4],
'add': ['add', 'Add object to cache, handling our own indices. ', [['blogs/inc/collections/model','_blogcache.class.php',69],['blogs/inc/users/model','_usercache.class.php',231],['blogs/inc/files/model','_filelist.class.php',392],['blogs/inc/_core/model','_log.class.php',124],['blogs/inc/_core/model','_log.class.php',593],['blogs/inc/files/model','_filetypecache.class.php',57],['blogs/inc/_ext/pclzip','pclzip.lib.php',455],['blogs/inc/_core/model/dataobjects','_dataobjectcache.class.php',356],['blogs/inc/users/model','_groupsettings.class.php',103],['blogs/inc/links/model','_linkcache.class.php',101],['blogs/inc/skins/model','_skincache.class.php',62],['blogs/inc/generic/model','_genericcategorycache.class.php',113],['blogs/inc/_core/model','_messages.class.php',121]], 2022],
'get_item_edit_modes': ['get_item_edit_modes', 'Get item edit modes ', [['blogs/inc/items/model','_item.funcs.php',2652]], 2],
'autoselect_blog': ['autoselect_blog', 'Check permissions on a given blog (by ID) and autoselect an appropriate blog if necessary. ', [['blogs/inc/collections/model','_blog.funcs.php',235]], 10],
'post': ['post', 'POST wrapper for oAuthRequest. ', [['blogs/plugins/twitter_plugin/twitteroauth','twitteroauth.php',157]], 40],
'global_icon': ['global_icon', 'Registers a global action icon ', [['blogs/inc/_core/ui','_uiwidget.class.php',89]], 152],
'handle_post_processing': ['handle_post_processing', 'Execute or schedule post(=after) processing tasks ', [['blogs/inc/items/model','_item.class.php',5331]], 9],
'get_allowed_item_status': ['get_allowed_item_status', 'Get allowed post status for current user in this blog ', [['blogs/inc/collections/model','_blog.class.php',1522]], 8],
'get_allow_cross_posting': ['get_allow_cross_posting', 'Get global cross posting settings -- (cross posting = 1 post in multiple blogs) ', [['blogs/inc/collections/model','_category.funcs.php',536]], 14],
'require_css': ['require_css', 'Memorize that a specific css that file will be required by the current page. All requested files will be included in the page head only once (when headlines is called) ', [['blogs/inc/_core','_template.funcs.php',947]], 236],
'require_js': ['require_js', 'Memorize that a specific javascript file will be required by the current page. All requested files will be included in the page head only once (when headlines is called) ', [['blogs/inc/_core','_template.funcs.php',905]], 146],
'delete': ['delete', 'Delete a hit. ', [['blogs/inc/sessions/model','_hitlist.class.php',47],['blogs/inc/plugins/model','_pluginsettings.class.php',83],['blogs/inc/settings/model','_abstractsettings.class.php',522],['blogs/inc/plugins/model','_pluginusersettings.class.php',107],['blogs/inc/_ext/pclzip','pclzip.lib.php',1007],['blogs/inc/users/model','_usersettings.class.php',212],['blogs/inc/users/model','_groupsettings.class.php',181],['blogs/inc/sessions/model','_session.class.php',452],['blogs/plugins/twitter_plugin/twitteroauth','twitteroauth.php',168]], 90],
'format': ['format', 'Format a diff. ', [['blogs/inc/_core/model','_diff.class.php',813],['blogs/inc/_core/model','_diff.class.php',976]], 29],
'trackbacks': ['trackbacks', 'trackbacks(-) ', [['blogs/inc/comments','_trackback.funcs.php',34]], 12],
'load_publish_status': ['load_publish_status', 'Load new status when the item was published If the status is invalid then an error message will be added to messages ', [['blogs/inc/items/model','_item.funcs.php',1661]], 3],
'get_setting': ['get_setting', 'Get a setting. ', [['blogs/inc/collections/model','_blog.class.php',2021],['blogs/inc/skins/model','_skin.class.php',553],['blogs/inc/items/model','_item.class.php',6236]], 640],
'disp_view': ['disp_view', 'Display a view ', [['blogs/skins_adm','_adminUI_general.class.php',681]], 209],
'get_permanent_url': ['get_permanent_url', 'Generate the URL to access the category. ', [['blogs/inc/chapters/model','_chapter.class.php',182],['blogs/inc/items/model','_itemlight.class.php',334],['blogs/inc/comments/model','_comment.class.php',2255]], 115],
't_': ['t_', 'TRANSLATE! ', [['blogs/inc/locales','_locale.funcs.php',48],['blogs/inc/locales','_locale.funcs.php',240],['blogs/inc/skins/model','_skin.class.php',672],['blogs/inc/_core/model','_module.class.php',79],['blogs/rsc/js','blog_widgets.js',422],['blogs/inc/plugins','_plugin.class.php',2617]], 10201],
'add_by_subpath': ['add_by_subpath', 'Add a file to the list, by filename. ', [['blogs/inc/files/model','_filelist.class.php',502]], 4],
'get_renderers_validated': ['get_renderers_validated', 'Get the list of validated renderers for this Comment. This includes stealth plugins etc. ', [['blogs/inc/comments/model','_comment.class.php',2797],['blogs/inc/items/model','_item.class.php',5836]], 20],
'disp_payload_begin': ['disp_payload_begin', 'Display the start of a payload block ', [['blogs/skins_adm','_adminUI_general.class.php',600],['blogs/skins_adm/bootstrap','_adminUI.class.php',552]], 91],
'invalidate_key': ['invalidate_key', 'Invalidate a special key ', [['blogs/inc/_core/model','_blockcache.class.php',81]], 12],
'has_errors': ['has_errors', 'Has error message in current object ', [['blogs/inc/_core/model','_messages.class.php',313]], 47],
'breadcrumbpath_add': ['breadcrumbpath_add', 'Note: These are not real breadcrumbs. It\'s just "so to speak" for a hierarchical path. ', [['blogs/skins_adm','_adminUI_general.class.php',212]], 234],
'dbinsert': ['dbinsert', 'Insert object into DB based on previously recorded changes. ', [['blogs/inc/chapters/model','_chapter.class.php',287],['blogs/inc/generic/model','_genericordered.class.php',101],['blogs/inc/users/model','_group.class.php',451],['blogs/inc/widgets/model','_widget.class.php',725],['blogs/inc/collections/model','_blog.class.php',2171],['blogs/inc/users/model','_user.class.php',2872],['blogs/inc/skins/model','_skin.class.php',370],['blogs/inc/comments/model','_comment.class.php',3511],['blogs/inc/items/model','_item.class.php',4685],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',210],['blogs/inc/files/model','_file.class.php',1698]], 93],
'set': ['set', 'Set param value ', [['blogs/inc/users/model','_userfield.class.php',243],['blogs/inc/generic/model','_genericordered.class.php',75],['blogs/inc/users/model','_group.class.php',204],['blogs/inc/items/model','_itemlight.class.php',1258],['blogs/inc/plugins/model','_pluginsettings.class.php',70],['blogs/inc/widgets/model','_widget.class.php',321],['blogs/inc/regional/model','_region.class.php',102],['blogs/inc/regional/model','_city.class.php',110],['blogs/inc/collections/model','_blog.class.php',1102],['blogs/inc/settings/model','_abstractsettings.class.php',446],['blogs/inc/plugins/model','_pluginusersettings.class.php',82],['blogs/inc/users/model','_user.class.php',1861],['blogs/inc/generic/model','_genericcategory.class.php',100],['blogs/inc/tools/model','_emailaddress.class.php',85],['blogs/inc/users/model','_usersettings.class.php',187],['blogs/inc/regional/model','_country.class.php',106],['blogs/inc/comments/model','_comment.class.php',315],['blogs/inc/users/model','_groupsettings.class.php',140],['blogs/inc/cron/model','_cronjob.class.php',79],['blogs/inc/items/model','_item.class.php',4497],['blogs/inc/files/model','_filetype.class.php',149],['blogs/inc/users/model','_userfieldgroup.class.php',92],['blogs/inc/sessions/model','_session.class.php',420],['blogs/plugins','_calendar.plugin.php',530],['blogs/inc/slugs/model','_slug.class.php',80],['blogs/inc/regional/model','_currency.class.php',96],['blogs/inc/messaging/model','_thread.class.php',185],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',614],['blogs/inc/regional/model','_subregion.class.php',119],['blogs/inc/antispam/model','_iprange.class.php',81],['blogs/inc/sessions/model','_goal.class.php',199]], 1121],
'load_meta': ['load_meta', 'Attempt to load meta data for all files in the list. ', [['blogs/inc/files/model','_filelist.class.php',1152],['blogs/inc/files/model','_file.class.php',281]], 27],
'check_perm': ['check_perm', 'Check permission on a message ', [['blogs/inc/messaging/model','_message.class.php',467],['blogs/inc/users/model','_group.class.php',257],['blogs/inc/users/model','_user.class.php',2022],['blogs/inc/links/model','_linkuser.class.php',51],['blogs/inc/links/model','_linkitem.class.php',54],['blogs/inc/_core/model','_module.class.php',233],['blogs/inc/messaging/model','_thread.class.php',476],['blogs/inc/links/model','_linkcomment.class.php',53],['blogs/inc/sessions/model','_goal.class.php',92]], 967],
'get_tags': ['get_tags', 'Retrieves all tags from published posts ', [['blogs/inc/collections/model','_blog.funcs.php',764]], 13],
'disp_global_footer': ['disp_global_footer', 'Display body bottom, debug info and close </html> ', [['blogs/skins_adm','_adminUI_general.class.php',577]], 58],
'disp_html_head': ['disp_html_head', 'Display doctype + <head>...</head> section ', [['blogs/skins_adm','_adminUI_general.class.php',492]], 58],
'get_revision': ['get_revision', 'Get item revision ', [['blogs/inc/items/model','_item.class.php',6471]], 4],
'set_default_filters': ['set_default_filters', 'Set default filter values we always want to use if not individually specified otherwise: ', [['blogs/inc/_core/model/dataobjects','_dataobjectlist2.class.php',135]], 20],
'append_path_level': ['append_path_level', 'Append a selected menu entry to the current path of selected entries. ', [['blogs/skins_adm','_adminUI_general.class.php',1330]], 7],
'clear': ['clear', 'Clear the cache ', [['blogs/inc/files/model','_filerootcache.class.php',173],['blogs/inc/users/model','_usercache.class.php',368],['blogs/inc/_core/model','_log.class.php',99],['blogs/inc/_core/model','_log.class.php',603],['blogs/inc/_core/model/dataobjects','_dataobjectcache.class.php',454],['blogs/inc/links/model','_linkcache.class.php',530],['blogs/inc/chapters/model','_chaptercache.class.php',65],['blogs/inc/generic/model','_genericcategorycache.class.php',98],['blogs/inc/_core/model','_messages.class.php',109]], 97],
'get_template': ['get_template', 'Those templates are used for example by the messaging screens. ', [['blogs/skins/bootstrap','_skin.class.php',123],['blogs/skins_adm/evo','_adminUI.class.php',144],['blogs/skins_adm','_adminUI_general.class.php',855],['blogs/skins_adm/chicago','_adminUI.class.php',167],['blogs/inc/skins/model','_skin.class.php',721],['blogs/skins_adm/bootstrap','_adminUI.class.php',181],['blogs/skins/pureforums','_skin.class.php',360],['blogs/inc/_core/ui','_menu.class.php',408]], 63],
'init_autocomplete_login_js': ['init_autocomplete_login_js', 'Registers headlines required to autocomplete the user logins ', [['blogs/inc/_core','_template.funcs.php',1487]], 4],
'remove_seconds': ['remove_seconds', 'Get datetime rounded to lower minute. This is meant to remove seconds and leverage MySQL\'s query cache by having SELECT queries remain identical for 60 seconds instead of just 1. ', [['blogs/inc/_core','_misc.funcs.php',1613]], 6],
'blog_has_cats': ['blog_has_cats', 'Does a given blog have categories? ', [['blogs/inc/collections/model','_category.funcs.php',422]], 6],
'postcats_get_byid': ['postcats_get_byid', 'Get category associations with given item ', [['blogs/inc/collections/model','_category.funcs.php',306]], 7],
'get': ['get', '', [['blogs/plugins/tinymce_plugin/tiny_mce','tiny_mce_src.js',941],['blogs/plugins/tinymce_plugin/tiny_mce','tiny_mce_src.js',15011],['blogs/plugins/tinymce_plugin/tiny_mce/plugins/media/js','media.js',7],['blogs/inc/links/model','_linkowner.class.php',221],['blogs/inc/_core/model/db','_sql.class.php',64],['blogs/inc/plugins/model','_pluginsettings.class.php',58],['blogs/inc/collections/model','_blog.class.php',1822],['blogs/inc/settings/model','_generalsettings.class.php',383],['blogs/inc/settings/model','_abstractsettings.class.php',271],['blogs/inc/plugins/model','_pluginusersettings.class.php',58],['blogs/inc/users/model','_user.class.php',1126],['blogs/plugins/tinymce_plugin/tiny_mce','tiny_mce_gzip.js',38],['blogs/inc/users/model','_usersettings.class.php',151],['blogs/inc/comments/model','_comment.class.php',301],['blogs/inc/users/model','_groupsettings.class.php',124],['blogs/inc/cron/model','_cronjob.class.php',104],['blogs/inc/items/model','_item.class.php',5742],['blogs/inc/sessions/model','_session.class.php',397],['blogs/inc/links/model','_linkuser.class.php',141],['blogs/inc/links/model','_linkitem.class.php',155],['blogs/inc/slugs/model','_slug.class.php',68],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',574],['blogs/plugins/twitter_plugin/twitteroauth','twitteroauth.php',146],['blogs/inc/antispam/model','_iprange.class.php',69],['blogs/inc/links/model','_linkcomment.class.php',132],['blogs/inc/files/model','_file.class.php',532]], 2417],
'commit': ['commit', 'Commit current transaction ', [['blogs/inc/_core/model/db','_db.class.php',1591]], 114],
'add_menu_entries': ['add_menu_entries', 'Add menu entries to the list of entries for a given path. ', [['blogs/inc/_core/ui','_menu.class.php',53]], 58],
'load_class': ['load_class', 'Load class file ', [['blogs/inc/_core','_class4.funcs.php',28],['blogs/inc/_core','_class5.funcs.php',79]], 408],
'in_array': ['in_array', '', [], 335],
'implode': ['implode', '', [], 456],
'defined': ['defined', '', [], 874],
'urldecode': ['urldecode', '', [], 25],
'strpos': ['strpos', '', [], 280],
'date': ['date', '', [], 361],
'explode': ['explode', '', [], 249],
'substr': ['substr', '', [], 657],
'intval': ['intval', '', [], 127]};
CLASS_DATA={
'blockcache': ['blockcache', 'Block Cache. ', [['blogs/inc/_core/model','_blockcache.class.php',31]], 14],
'widget': ['widget', 'Widget class which provides an interface to widget methods for other classes. ', [['blogs/inc/_core/ui','_uiwidget.class.php',37]], 40],
'titlediffformatter': ['titlediffformatter', 'Wikipedia Title style diff formatter. ', [['blogs/inc/_core/model','_diff.class.php',1273]], 1],
'filelist': ['filelist', 'Holds a list of File objects. ', [['blogs/inc/files/model','_filelist.class.php',40]], 11],
'item': ['item', 'Item Class ', [['blogs/inc/items/model','_item.class.php',46]], 92],
'diff': ['diff', 'Class representing a \'diff\' between two sequences of strings. ', [['blogs/inc/_core/model','_diff.class.php',586]], 3],
'blog': ['blog', 'Blog ', [['blogs/inc/collections/model','_blog.class.php',39]], 92],
'tablediffformatter': ['tablediffformatter', 'Wikipedia Table style diff formatter. ', [['blogs/inc/_core/model','_diff.class.php',1167]], 1],
'itemlist2': ['itemlist2', 'Item List Class 2 ', [['blogs/inc/items/model','_itemlist.class.php',36]], 15],
'link': ['link', 'Item Link ', [['blogs/inc/links/model','_link.class.php',33]], 16]};
CONST_DATA={
'EVO_MAIN_INIT': ['EVO_MAIN_INIT', '', [['blogs/inc','_main.inc.php',55],['blogs/install','index.php',25],['blogs/install','debug.php',22]], 827]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Sat Jul  5 12:18:44 2014</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>

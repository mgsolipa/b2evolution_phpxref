<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /blogs/inc/_init_login.inc.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Sat Jul  5 12:18:44 2014 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='blogs/inc';
filename='_init_login.inc.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/blogs/inc/</a> -> <a href="_init_login.inc.php.html">_init_login.inc.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="_init_login.inc.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="_init_login.inc.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">/**</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment"> * This file initializes everything BUT the blog!</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment"> *</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment"> * It is useful when you want to do very customized templates!</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment"> * It is also called by more complete initializers.</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment"> *</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment"> * This file is part of the evoCore framework - {@link http://evocore.net/}</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment"> * See also {@link http://sourceforge.net/projects/evocms/}.</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment"> *</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment"> * @copyright (c)2003-2014 by Francois Planque - {@link http://fplanque.com/}</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment"> * Parts of this file are copyright (c)2004-2006 by Daniel HAHLER - {@link http://thequod.de/contact}.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment"> * Parts of this file are copyright (c)2005-2006 by PROGIDISTRI - {@link http://progidistri.com/}.</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment"> *</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment"> * {@internal License choice</span>
<a name="l16"><span class="linenum">  16</span></a>  <span class="comment"> * - If you have received this file as part of a package, please find the license.txt file in</span>
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment"> *   the same folder or the closest folder above for complete license terms.</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * - If you have received this file individually (e-g: from http://evocms.cvs.sourceforge.net/)</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *   then you must choose one of the following licenses before using the file:</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> *   - GNU General Public License 2 (GPL) - http://www.opensource.org/licenses/gpl-license.php</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> *   - Mozilla Public License 1.1 (MPL) - http://www.opensource.org/licenses/mozilla1.1.php</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * }}</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> *</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> * {@internal Open Source relicensing agreement:</span>
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment"> * Daniel HAHLER grants Francois PLANQUE the right to license</span>
<a name="l26"><span class="linenum">  26</span></a>  <span class="comment"> * Daniel HAHLER's contributions to this file and the b2evolution project</span>
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment"> * under any OSI approved OSS license (http://www.opensource.org/licenses/).</span>
<a name="l28"><span class="linenum">  28</span></a>  <span class="comment"> *</span>
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment"> * Matt FOLLETT grants Francois PLANQUE the right to license</span>
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment"> * Matt FOLLETT's contributions to this file and the b2evolution project</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment"> * under any OSI approved OSS license (http://www.opensource.org/licenses/).</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> * }}</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> *</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> * @package evocore</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> *</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment"> * @version $Id: _init_login.inc.php 6581 2014-04-30 10:20:18Z attila $</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment"> */</span>
<a name="l38"><span class="linenum">  38</span></a>  if( !<a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('EVO_CONFIG_LOADED')" href="../../_constants/EVO_CONFIG_LOADED.html" onMouseOver="constPopup(event,'EVO_CONFIG_LOADED')">EVO_CONFIG_LOADED</a>') ) die( 'Please, do not access this page directly.' );
<a name="l39"><span class="linenum">  39</span></a>  
<a name="l40"><span class="linenum">  40</span></a>  
<a name="l41"><span class="linenum">  41</span></a>  <a class="var it146" onMouseOver="hilite(146)" onMouseOut="lolite()" onClick="logVariable('Timer')" href="../../_variables/Timer.html">$Timer</a>-&gt;<a class="function" onClick="logFunction('resume')" href="../../_functions/resume.html" onMouseOver="funcPopup(event,'resume')">resume</a>( '_init_login' );
<a name="l42"><span class="linenum">  42</span></a>  
<a name="l43"><span class="linenum">  43</span></a>  
<a name="l44"><span class="linenum">  44</span></a>  <span class="comment">/*</span>
<a name="l45"><span class="linenum">  45</span></a>  <span class="comment"> * Login procedure:</span>
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment"> * TODO: dh&gt; if a &quot;logged in&quot;-session exists (in most cases) it should not trigger parsing the meat of this code.</span>
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment"> * fp&gt; mind you, most hits will be on the font end and will not be loggedin sessions</span>
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment"> *     However, I agree that the login stuff should only be included when the user is actually attempting to log in.</span>
<a name="l49"><span class="linenum">  49</span></a>  <span class="comment"> */</span>
<a name="l50"><span class="linenum">  50</span></a>  if( !isset(<a class="var it742" onMouseOver="hilite(742)" onMouseOut="lolite()" onClick="logVariable('login_required')" href="../../_variables/login_required.html">$login_required</a>) )
<a name="l51"><span class="linenum">  51</span></a>  {
<a name="l52"><span class="linenum">  52</span></a>      <a class="var it742" onMouseOver="hilite(742)" onMouseOut="lolite()" onClick="logVariable('login_required')" href="../../_variables/login_required.html">$login_required</a> = false;
<a name="l53"><span class="linenum">  53</span></a>  }
<a name="l54"><span class="linenum">  54</span></a>  if( !isset(<a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('validate_required')" href="../../_variables/validate_required.html">$validate_required</a>) )
<a name="l55"><span class="linenum">  55</span></a>  {
<a name="l56"><span class="linenum">  56</span></a>      <a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('validate_required')" href="../../_variables/validate_required.html">$validate_required</a> = <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'validate_required', 'boolean', false );
<a name="l57"><span class="linenum">  57</span></a>  }
<a name="l58"><span class="linenum">  58</span></a>  
<a name="l59"><span class="linenum">  59</span></a>  global <a class="var it1606" onMouseOver="hilite(1606)" onMouseOut="lolite()" onClick="logVariable('login_error')" href="../../_variables/login_error.html">$login_error</a>;
<a name="l60"><span class="linenum">  60</span></a>  <span class="comment">/**</span>
<a name="l61"><span class="linenum">  61</span></a>  <span class="comment"> * Login error message</span>
<a name="l62"><span class="linenum">  62</span></a>  <span class="comment"> * @global string</span>
<a name="l63"><span class="linenum">  63</span></a>  <span class="comment"> */</span>
<a name="l64"><span class="linenum">  64</span></a>  <a class="var it1606" onMouseOver="hilite(1606)" onMouseOut="lolite()" onClick="logVariable('login_error')" href="../../_variables/login_error.html">$login_error</a> = '';
<a name="l65"><span class="linenum">  65</span></a>  
<a name="l66"><span class="linenum">  66</span></a>  <a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('login')" href="../../_variables/login.html">$login</a> = NULL;
<a name="l67"><span class="linenum">  67</span></a>  <a class="var it1607" onMouseOver="hilite(1607)" onMouseOut="lolite()" onClick="logVariable('pass')" href="../../_variables/pass.html">$pass</a> = NULL;
<a name="l68"><span class="linenum">  68</span></a>  <a class="var it1608" onMouseOver="hilite(1608)" onMouseOut="lolite()" onClick="logVariable('pass_md5')" href="../../_variables/pass_md5.html">$pass_md5</a> = NULL;
<a name="l69"><span class="linenum">  69</span></a>  <a class="var it1609" onMouseOver="hilite(1609)" onMouseOut="lolite()" onClick="logVariable('email_login')" href="../../_variables/email_login.html">$email_login</a> = false;
<a name="l70"><span class="linenum">  70</span></a>  
<a name="l71"><span class="linenum">  71</span></a>  if( isset(<a class="var it1610" onMouseOver="hilite(1610)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../../_variables/_POST.html">$_POST</a>[ <a class="var it299" onMouseOver="hilite(299)" onMouseOut="lolite()" onClick="logVariable('dummy_fields')" href="../../_variables/dummy_fields.html">$dummy_fields</a>[ 'login' ] ] ) &amp;&amp; isset(<a class="var it1610" onMouseOver="hilite(1610)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../../_variables/_POST.html">$_POST</a>[ <a class="var it299" onMouseOver="hilite(299)" onMouseOut="lolite()" onClick="logVariable('dummy_fields')" href="../../_variables/dummy_fields.html">$dummy_fields</a>[ 'pwd' ] ] ) )
<a name="l72"><span class="linenum">  72</span></a>  { // Trying to log in with a POST
<a name="l73"><span class="linenum">  73</span></a>      <a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('login')" href="../../_variables/login.html">$login</a> = <a class="var it1610" onMouseOver="hilite(1610)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../../_variables/_POST.html">$_POST</a>[ <a class="var it299" onMouseOver="hilite(299)" onMouseOut="lolite()" onClick="logVariable('dummy_fields')" href="../../_variables/dummy_fields.html">$dummy_fields</a>[ 'login' ] ];
<a name="l74"><span class="linenum">  74</span></a>      <a class="var it1607" onMouseOver="hilite(1607)" onMouseOut="lolite()" onClick="logVariable('pass')" href="../../_variables/pass.html">$pass</a> = <a class="var it1610" onMouseOver="hilite(1610)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../../_variables/_POST.html">$_POST</a>[ <a class="var it299" onMouseOver="hilite(299)" onMouseOut="lolite()" onClick="logVariable('dummy_fields')" href="../../_variables/dummy_fields.html">$dummy_fields</a>[ 'pwd' ] ];
<a name="l75"><span class="linenum">  75</span></a>      unset(<a class="var it1610" onMouseOver="hilite(1610)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../../_variables/_POST.html">$_POST</a>[ <a class="var it299" onMouseOver="hilite(299)" onMouseOut="lolite()" onClick="logVariable('dummy_fields')" href="../../_variables/dummy_fields.html">$dummy_fields</a>[ 'pwd' ] ]); <span class="comment">// password will be hashed below</span>
<a name="l76"><span class="linenum">  76</span></a>  }
<a name="l77"><span class="linenum">  77</span></a>  elseif( isset(<a class="var it991" onMouseOver="hilite(991)" onMouseOut="lolite()" onClick="logVariable('_GET')" href="../../_variables/_GET.html">$_GET</a>[ <a class="var it299" onMouseOver="hilite(299)" onMouseOut="lolite()" onClick="logVariable('dummy_fields')" href="../../_variables/dummy_fields.html">$dummy_fields</a>[ 'login' ] ] ) )
<a name="l78"><span class="linenum">  78</span></a>  { // Trying to log in with a GET; we might only provide a user here.
<a name="l79"><span class="linenum">  79</span></a>      <a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('login')" href="../../_variables/login.html">$login</a> = <a class="var it991" onMouseOver="hilite(991)" onMouseOut="lolite()" onClick="logVariable('_GET')" href="../../_variables/_GET.html">$_GET</a>[ <a class="var it299" onMouseOver="hilite(299)" onMouseOut="lolite()" onClick="logVariable('dummy_fields')" href="../../_variables/dummy_fields.html">$dummy_fields</a>[ 'login' ] ];
<a name="l80"><span class="linenum">  80</span></a>      <a class="var it1607" onMouseOver="hilite(1607)" onMouseOut="lolite()" onClick="logVariable('pass')" href="../../_variables/pass.html">$pass</a> = isset(<a class="var it991" onMouseOver="hilite(991)" onMouseOut="lolite()" onClick="logVariable('_GET')" href="../../_variables/_GET.html">$_GET</a>[ <a class="var it299" onMouseOver="hilite(299)" onMouseOut="lolite()" onClick="logVariable('dummy_fields')" href="../../_variables/dummy_fields.html">$dummy_fields</a>[ 'pwd' ] ]) ? <a class="var it991" onMouseOver="hilite(991)" onMouseOut="lolite()" onClick="logVariable('_GET')" href="../../_variables/_GET.html">$_GET</a>[ <a class="var it299" onMouseOver="hilite(299)" onMouseOut="lolite()" onClick="logVariable('dummy_fields')" href="../../_variables/dummy_fields.html">$dummy_fields</a>[ 'pwd' ] ] : '';
<a name="l81"><span class="linenum">  81</span></a>      unset(<a class="var it991" onMouseOver="hilite(991)" onMouseOut="lolite()" onClick="logVariable('_GET')" href="../../_variables/_GET.html">$_GET</a>[ <a class="var it299" onMouseOver="hilite(299)" onMouseOut="lolite()" onClick="logVariable('dummy_fields')" href="../../_variables/dummy_fields.html">$dummy_fields</a>[ 'pwd' ] ]); <span class="comment">// password will be hashed below</span>
<a name="l82"><span class="linenum">  82</span></a>  }
<a name="l83"><span class="linenum">  83</span></a>  
<a name="l84"><span class="linenum">  84</span></a>  <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Login: login: '.<a class="phpfunction" onClick="logFunction('var_export')" href="../../_functions/var_export.html" onMouseOver="phpfuncPopup(event,'var_export')">var_export</a>(<a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('login')" href="../../_variables/login.html">$login</a>, true), '_init_login' );
<a name="l85"><span class="linenum">  85</span></a>  <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Login: pass: '.( empty(<a class="var it1607" onMouseOver="hilite(1607)" onMouseOut="lolite()" onClick="logVariable('pass')" href="../../_variables/pass.html">$pass</a>) ? '' : 'not' ).' empty', '_init_login' );
<a name="l86"><span class="linenum">  86</span></a>  
<a name="l87"><span class="linenum">  87</span></a>  <span class="comment">// either 'login' (normal) or 'redirect_to_backoffice' may be set here. This also helps to display the login form again, if either login or pass were empty.</span>
<a name="l88"><span class="linenum">  88</span></a>  <a class="var it1611" onMouseOver="hilite(1611)" onMouseOut="lolite()" onClick="logVariable('login_action')" href="../../_variables/login_action.html">$login_action</a> = <a class="function" onClick="logFunction('param_arrayindex')" href="../../_functions/param_arrayindex.html" onMouseOver="funcPopup(event,'param_arrayindex')">param_arrayindex</a>( 'login_action' );
<a name="l89"><span class="linenum">  89</span></a>  
<a name="l90"><span class="linenum">  90</span></a>  if( ( <a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('login')" href="../../_variables/login.html">$login</a> != NULL ) &amp;&amp; ( ! <a class="phpfunction" onClick="logFunction('is_string')" href="../../_functions/is_string.html" onMouseOver="phpfuncPopup(event,'is_string')">is_string</a>( <a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('login')" href="../../_variables/login.html">$login</a> ) ) )
<a name="l91"><span class="linenum">  91</span></a>  { // Login must be string
<a name="l92"><span class="linenum">  92</span></a>      <a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('login')" href="../../_variables/login.html">$login</a> = NULL;
<a name="l93"><span class="linenum">  93</span></a>      if( ! empty( <a class="var it1611" onMouseOver="hilite(1611)" onMouseOut="lolite()" onClick="logVariable('login_action')" href="../../_variables/login_action.html">$login_action</a> ) )
<a name="l94"><span class="linenum">  94</span></a>      { // This was a login request with an invalid login parameter type, so it must be a doctored request
<a name="l95"><span class="linenum">  95</span></a>          <a class="function" onClick="logFunction('debug_die')" href="../../_functions/debug_die.html" onMouseOver="funcPopup(event,'debug_die')">debug_die</a>('The type of the received login parameter is invalid!');
<a name="l96"><span class="linenum">  96</span></a>      }
<a name="l97"><span class="linenum">  97</span></a>  }
<a name="l98"><span class="linenum">  98</span></a>  if( ( <a class="var it1607" onMouseOver="hilite(1607)" onMouseOut="lolite()" onClick="logVariable('pass')" href="../../_variables/pass.html">$pass</a> != NULL ) &amp;&amp; ( ! <a class="phpfunction" onClick="logFunction('is_string')" href="../../_functions/is_string.html" onMouseOver="phpfuncPopup(event,'is_string')">is_string</a>( <a class="var it1607" onMouseOver="hilite(1607)" onMouseOut="lolite()" onClick="logVariable('pass')" href="../../_variables/pass.html">$pass</a> ) ) )
<a name="l99"><span class="linenum">  99</span></a>  { // Password must be string
<a name="l100"><span class="linenum"> 100</span></a>      <a class="var it1607" onMouseOver="hilite(1607)" onMouseOut="lolite()" onClick="logVariable('pass')" href="../../_variables/pass.html">$pass</a> = NULL;
<a name="l101"><span class="linenum"> 101</span></a>      if( ! empty( <a class="var it1611" onMouseOver="hilite(1611)" onMouseOut="lolite()" onClick="logVariable('login_action')" href="../../_variables/login_action.html">$login_action</a> ) )
<a name="l102"><span class="linenum"> 102</span></a>      { // This was a login request with an invalid pwd parameter type, so it must be a doctored request
<a name="l103"><span class="linenum"> 103</span></a>          <a class="function" onClick="logFunction('debug_die')" href="../../_functions/debug_die.html" onMouseOver="funcPopup(event,'debug_die')">debug_die</a>('The type of the received password parameter is invalid!');
<a name="l104"><span class="linenum"> 104</span></a>      }
<a name="l105"><span class="linenum"> 105</span></a>  }
<a name="l106"><span class="linenum"> 106</span></a>  
<a name="l107"><span class="linenum"> 107</span></a>  <a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('UserCache')" href="../../_variables/UserCache.html">$UserCache</a> = &amp; get_UserCache();
<a name="l108"><span class="linenum"> 108</span></a>  
<a name="l109"><span class="linenum"> 109</span></a>  if( ! empty(<a class="var it1611" onMouseOver="hilite(1611)" onMouseOut="lolite()" onClick="logVariable('login_action')" href="../../_variables/login_action.html">$login_action</a>) || (! empty(<a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('login')" href="../../_variables/login.html">$login</a>) &amp;&amp; ! empty(<a class="var it1607" onMouseOver="hilite(1607)" onMouseOut="lolite()" onClick="logVariable('pass')" href="../../_variables/pass.html">$pass</a>)) )
<a name="l110"><span class="linenum"> 110</span></a>  { // User is trying to login right now
<a name="l111"><span class="linenum"> 111</span></a>  
<a name="l112"><span class="linenum"> 112</span></a>  <span class="comment">    // Stop a request from the blocked IP addresses or Domains</span>
<a name="l113"><span class="linenum"> 113</span></a>      <a class="function" onClick="logFunction('antispam_block_request')" href="../../_functions/antispam_block_request.html" onMouseOver="funcPopup(event,'antispam_block_request')">antispam_block_request</a>();
<a name="l114"><span class="linenum"> 114</span></a>  
<a name="l115"><span class="linenum"> 115</span></a>      global <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a>;
<a name="l116"><span class="linenum"> 116</span></a>  <span class="comment">    // Set $action so it can be recorded in the hitlog:</span>
<a name="l117"><span class="linenum"> 117</span></a>      <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> = 'login';
<a name="l118"><span class="linenum"> 118</span></a>  
<a name="l119"><span class="linenum"> 119</span></a>      <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Login: User is trying to log in.', '_init_login' );
<a name="l120"><span class="linenum"> 120</span></a>  
<a name="l121"><span class="linenum"> 121</span></a>      <a class="function" onClick="logFunction('header_nocache')" href="../../_functions/header_nocache.html" onMouseOver="funcPopup(event,'header_nocache')">header_nocache</a>();        <span class="comment">// Don't take risks here :p</span>
<a name="l122"><span class="linenum"> 122</span></a>  
<a name="l123"><span class="linenum"> 123</span></a>  <span class="comment">    // Check that this login request is not a CSRF hacked request:</span>
<a name="l124"><span class="linenum"> 124</span></a>      <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'loginform' );
<a name="l125"><span class="linenum"> 125</span></a>  <span class="comment">    // fp&gt; NOTE: TODO: now that we require goign through the login form, all the login logic that is here can probably be moved to login.php ?</span>
<a name="l126"><span class="linenum"> 126</span></a>  
<a name="l127"><span class="linenum"> 127</span></a>  <span class="comment">    // Note: login and password cannot include ' or &quot; or &gt; or &lt;</span>
<a name="l128"><span class="linenum"> 128</span></a>  <span class="comment">    // Note: login cannot include @</span>
<a name="l129"><span class="linenum"> 129</span></a>      <a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('login')" href="../../_variables/login.html">$login</a> = <a class="function" onClick="logFunction('evo_strtolower')" href="../../_functions/evo_strtolower.html" onMouseOver="funcPopup(event,'evo_strtolower')">evo_strtolower</a>(<a class="phpfunction" onClick="logFunction('strip_tags')" href="../../_functions/strip_tags.html" onMouseOver="phpfuncPopup(event,'strip_tags')">strip_tags</a>(<a class="function" onClick="logFunction('remove_magic_quotes')" href="../../_functions/remove_magic_quotes.html" onMouseOver="funcPopup(event,'remove_magic_quotes')">remove_magic_quotes</a>(<a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('login')" href="../../_variables/login.html">$login</a>)));
<a name="l130"><span class="linenum"> 130</span></a>      <a class="var it1607" onMouseOver="hilite(1607)" onMouseOut="lolite()" onClick="logVariable('pass')" href="../../_variables/pass.html">$pass</a> = <a class="phpfunction" onClick="logFunction('strip_tags')" href="../../_functions/strip_tags.html" onMouseOver="phpfuncPopup(event,'strip_tags')">strip_tags</a>(<a class="function" onClick="logFunction('remove_magic_quotes')" href="../../_functions/remove_magic_quotes.html" onMouseOver="funcPopup(event,'remove_magic_quotes')">remove_magic_quotes</a>(<a class="var it1607" onMouseOver="hilite(1607)" onMouseOut="lolite()" onClick="logVariable('pass')" href="../../_variables/pass.html">$pass</a>));
<a name="l131"><span class="linenum"> 131</span></a>      <a class="var it1608" onMouseOver="hilite(1608)" onMouseOut="lolite()" onClick="logVariable('pass_md5')" href="../../_variables/pass_md5.html">$pass_md5</a> = md5( <a class="var it1607" onMouseOver="hilite(1607)" onMouseOut="lolite()" onClick="logVariable('pass')" href="../../_variables/pass.html">$pass</a> );
<a name="l132"><span class="linenum"> 132</span></a>  
<a name="l133"><span class="linenum"> 133</span></a>  
<a name="l134"><span class="linenum"> 134</span></a>      <span class="comment">/*</span>
<a name="l135"><span class="linenum"> 135</span></a>  <span class="comment">     * Handle javascript-hashed password:</span>
<a name="l136"><span class="linenum"> 136</span></a>  <span class="comment">     * If possible, the login form will hash the entered password with a salt that changes everytime.</span>
<a name="l137"><span class="linenum"> 137</span></a>  <span class="comment">     */</span>
<a name="l138"><span class="linenum"> 138</span></a>      <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>('pwd_salt', 'string', ''); <span class="comment">// just for comparison with the one from Session</span>
<a name="l139"><span class="linenum"> 139</span></a>      <a class="var it1612" onMouseOver="hilite(1612)" onMouseOut="lolite()" onClick="logVariable('pwd_salt_sess')" href="../../_variables/pwd_salt_sess.html">$pwd_salt_sess</a> = <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>('core.pwd_salt');
<a name="l140"><span class="linenum"> 140</span></a>  
<a name="l141"><span class="linenum"> 141</span></a>  <span class="comment">    // $Debuglog-&gt;add( 'Login: salt: '.var_export($pwd_salt, true).', session salt: '.var_export($pwd_salt_sess, true), '_init_login' );</span>
<a name="l142"><span class="linenum"> 142</span></a>  
<a name="l143"><span class="linenum"> 143</span></a>      <a class="var it565" onMouseOver="hilite(565)" onMouseOut="lolite()" onClick="logVariable('transmit_hashed_password')" href="../../_variables/transmit_hashed_password.html">$transmit_hashed_password</a> = (bool)<a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../_variables/Settings.html">$Settings</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>('js_passwd_hashing') &amp;&amp; !(bool)<a class="var it16" onMouseOver="hilite(16)" onMouseOut="lolite()" onClick="logVariable('Plugins')" href="../../_variables/Plugins.html">$Plugins</a>-&gt;<a class="function" onClick="logFunction('trigger_event_first_true')" href="../../_functions/trigger_event_first_true.html" onMouseOver="funcPopup(event,'trigger_event_first_true')">trigger_event_first_true</a>('LoginAttemptNeedsRawPassword');
<a name="l144"><span class="linenum"> 144</span></a>      if( <a class="var it565" onMouseOver="hilite(565)" onMouseOut="lolite()" onClick="logVariable('transmit_hashed_password')" href="../../_variables/transmit_hashed_password.html">$transmit_hashed_password</a> )
<a name="l145"><span class="linenum"> 145</span></a>      {
<a name="l146"><span class="linenum"> 146</span></a>          <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'pwd_hashed', 'string', '' );
<a name="l147"><span class="linenum"> 147</span></a>      }
<a name="l148"><span class="linenum"> 148</span></a>      else
<a name="l149"><span class="linenum"> 149</span></a>      { // at least one plugin requests the password un-hashed:
<a name="l150"><span class="linenum"> 150</span></a>          <a class="var it1613" onMouseOver="hilite(1613)" onMouseOut="lolite()" onClick="logVariable('pwd_hashed')" href="../../_variables/pwd_hashed.html">$pwd_hashed</a> = '';
<a name="l151"><span class="linenum"> 151</span></a>      }
<a name="l152"><span class="linenum"> 152</span></a>  
<a name="l153"><span class="linenum"> 153</span></a>  <span class="comment">    // $Debuglog-&gt;add( 'Login: pwd_hashed: '.var_export($pwd_hashed, true).', pass: '.var_export($pass, true), '_init_login' );</span>
<a name="l154"><span class="linenum"> 154</span></a>  
<a name="l155"><span class="linenum"> 155</span></a>      <a class="var it1614" onMouseOver="hilite(1614)" onMouseOut="lolite()" onClick="logVariable('pass_ok')" href="../../_variables/pass_ok.html">$pass_ok</a> = false;
<a name="l156"><span class="linenum"> 156</span></a>  <span class="comment">    // Trigger Plugin event, which could create the user, according to another database:</span>
<a name="l157"><span class="linenum"> 157</span></a>      if( <a class="var it16" onMouseOver="hilite(16)" onMouseOut="lolite()" onClick="logVariable('Plugins')" href="../../_variables/Plugins.html">$Plugins</a>-&gt;<a class="function" onClick="logFunction('trigger_event')" href="../../_functions/trigger_event.html" onMouseOver="funcPopup(event,'trigger_event')">trigger_event</a>( 'LoginAttempt', array(
<a name="l158"><span class="linenum"> 158</span></a>              'login' =&gt; &amp; <a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('login')" href="../../_variables/login.html">$login</a>,
<a name="l159"><span class="linenum"> 159</span></a>              'pass' =&gt; &amp; <a class="var it1607" onMouseOver="hilite(1607)" onMouseOut="lolite()" onClick="logVariable('pass')" href="../../_variables/pass.html">$pass</a>,
<a name="l160"><span class="linenum"> 160</span></a>              'pass_md5' =&gt; &amp; <a class="var it1608" onMouseOver="hilite(1608)" onMouseOut="lolite()" onClick="logVariable('pass_md5')" href="../../_variables/pass_md5.html">$pass_md5</a>,
<a name="l161"><span class="linenum"> 161</span></a>              'pass_salt' =&gt; &amp; <a class="var it1612" onMouseOver="hilite(1612)" onMouseOut="lolite()" onClick="logVariable('pwd_salt_sess')" href="../../_variables/pwd_salt_sess.html">$pwd_salt_sess</a>,
<a name="l162"><span class="linenum"> 162</span></a>              'pass_hashed' =&gt; &amp; <a class="var it1613" onMouseOver="hilite(1613)" onMouseOut="lolite()" onClick="logVariable('pwd_hashed')" href="../../_variables/pwd_hashed.html">$pwd_hashed</a>,
<a name="l163"><span class="linenum"> 163</span></a>              'pass_ok' =&gt; &amp; <a class="var it1614" onMouseOver="hilite(1614)" onMouseOut="lolite()" onClick="logVariable('pass_ok')" href="../../_variables/pass_ok.html">$pass_ok</a> ) ) )
<a name="l164"><span class="linenum"> 164</span></a>      { // clear the UserCache, if a plugin has been called - it may have changed <a class="function" onClick="logFunction('user')" href="../../_functions/user.html" onMouseOver="funcPopup(event,'user')">user</a>(s)
<a name="l165"><span class="linenum"> 165</span></a>          <a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('UserCache')" href="../../_variables/UserCache.html">$UserCache</a>-&gt;<a class="function" onClick="logFunction('clear')" href="../../_functions/clear.html" onMouseOver="funcPopup(event,'clear')">clear</a>();
<a name="l166"><span class="linenum"> 166</span></a>      }
<a name="l167"><span class="linenum"> 167</span></a>  
<a name="l168"><span class="linenum"> 168</span></a>      if( ! empty( <a class="var it1606" onMouseOver="hilite(1606)" onMouseOut="lolite()" onClick="logVariable('login_error')" href="../../_variables/login_error.html">$login_error</a> ) )
<a name="l169"><span class="linenum"> 169</span></a>      { // A plugin has thrown a login error..
<a name="l170"><span class="linenum"> 170</span></a>  <span class="comment">        // Do nothing, the error will get displayed in the login form..</span>
<a name="l171"><span class="linenum"> 171</span></a>  
<a name="l172"><span class="linenum"> 172</span></a>  <span class="comment">        // TODO: dh&gt; make sure that the user gets logged out?! (a Plugin might have logged him in and another one thrown an error)</span>
<a name="l173"><span class="linenum"> 173</span></a>      }
<a name="l174"><span class="linenum"> 174</span></a>      else
<a name="l175"><span class="linenum"> 175</span></a>      { // Check login and password
<a name="l176"><span class="linenum"> 176</span></a>          if( <a class="function" onClick="logFunction('is_email')" href="../../_functions/is_email.html" onMouseOver="funcPopup(event,'is_email')">is_email</a>( <a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('login')" href="../../_variables/login.html">$login</a> ) )
<a name="l177"><span class="linenum"> 177</span></a>          { // we have an email address instead of login name
<a name="l178"><span class="linenum"> 178</span></a>  <span class="comment">            // get user by email and password</span>
<a name="l179"><span class="linenum"> 179</span></a>              <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>( <a class="var it197" onMouseOver="hilite(197)" onMouseOut="lolite()" onClick="logVariable('User')" href="../../_variables/User.html">$User</a>, <a class="var it1615" onMouseOver="hilite(1615)" onMouseOut="lolite()" onClick="logVariable('exists_more')" href="../../_variables/exists_more.html">$exists_more</a> ) = <a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('UserCache')" href="../../_variables/UserCache.html">$UserCache</a>-&gt;<a class="function" onClick="logFunction('get_by_emailAndPwd')" href="../../_functions/get_by_emailandpwd.html" onMouseOver="funcPopup(event,'get_by_emailandpwd')">get_by_emailAndPwd</a>( <a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('login')" href="../../_variables/login.html">$login</a>, <a class="var it1608" onMouseOver="hilite(1608)" onMouseOut="lolite()" onClick="logVariable('pass_md5')" href="../../_variables/pass_md5.html">$pass_md5</a>, <a class="var it1613" onMouseOver="hilite(1613)" onMouseOut="lolite()" onClick="logVariable('pwd_hashed')" href="../../_variables/pwd_hashed.html">$pwd_hashed</a>, <a class="var it1616" onMouseOver="hilite(1616)" onMouseOut="lolite()" onClick="logVariable('pwd_salt')" href="../../_variables/pwd_salt.html">$pwd_salt</a> );
<a name="l180"><span class="linenum"> 180</span></a>              if( <a class="var it197" onMouseOver="hilite(197)" onMouseOut="lolite()" onClick="logVariable('User')" href="../../_variables/User.html">$User</a> )
<a name="l181"><span class="linenum"> 181</span></a>              { // user was found
<a name="l182"><span class="linenum"> 182</span></a>                  <a class="var it1609" onMouseOver="hilite(1609)" onMouseOut="lolite()" onClick="logVariable('email_login')" href="../../_variables/email_login.html">$email_login</a> = <a class="var it197" onMouseOver="hilite(197)" onMouseOut="lolite()" onClick="logVariable('User')" href="../../_variables/User.html">$User</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>( 'login' );
<a name="l183"><span class="linenum"> 183</span></a>              }
<a name="l184"><span class="linenum"> 184</span></a>          }
<a name="l185"><span class="linenum"> 185</span></a>          elseif( <a class="function" onClick="logFunction('param_check_valid_login')" href="../../_functions/param_check_valid_login.html" onMouseOver="funcPopup(event,'param_check_valid_login')">param_check_valid_login</a>( <a class="var it299" onMouseOver="hilite(299)" onMouseOut="lolite()" onClick="logVariable('dummy_fields')" href="../../_variables/dummy_fields.html">$dummy_fields</a>[ 'login' ] ) )
<a name="l186"><span class="linenum"> 186</span></a>          { // Make sure that we can load the user:
<a name="l187"><span class="linenum"> 187</span></a>              <a class="var it197" onMouseOver="hilite(197)" onMouseOut="lolite()" onClick="logVariable('User')" href="../../_variables/User.html">$User</a> = &amp; <a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('UserCache')" href="../../_variables/UserCache.html">$UserCache</a>-&gt;get_by_login(<a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('login')" href="../../_variables/login.html">$login</a>);
<a name="l188"><span class="linenum"> 188</span></a>          }
<a name="l189"><span class="linenum"> 189</span></a>          else
<a name="l190"><span class="linenum"> 190</span></a>          {
<a name="l191"><span class="linenum"> 191</span></a>              <a class="var it197" onMouseOver="hilite(197)" onMouseOut="lolite()" onClick="logVariable('User')" href="../../_variables/User.html">$User</a> = false;
<a name="l192"><span class="linenum"> 192</span></a>          }
<a name="l193"><span class="linenum"> 193</span></a>  
<a name="l194"><span class="linenum"> 194</span></a>          if( <a class="var it197" onMouseOver="hilite(197)" onMouseOut="lolite()" onClick="logVariable('User')" href="../../_variables/User.html">$User</a> &amp;&amp; ! <a class="var it1614" onMouseOver="hilite(1614)" onMouseOut="lolite()" onClick="logVariable('pass_ok')" href="../../_variables/pass_ok.html">$pass_ok</a> )
<a name="l195"><span class="linenum"> 195</span></a>          { // check the password, if no plugin has said &quot;it's ok&quot;:
<a name="l196"><span class="linenum"> 196</span></a>              if( ! empty(<a class="var it1613" onMouseOver="hilite(1613)" onMouseOut="lolite()" onClick="logVariable('pwd_hashed')" href="../../_variables/pwd_hashed.html">$pwd_hashed</a>) )
<a name="l197"><span class="linenum"> 197</span></a>              { // password hashed by JavaScript:
<a name="l198"><span class="linenum"> 198</span></a>  
<a name="l199"><span class="linenum"> 199</span></a>                  <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Login: Hashed password available.', '_init_login' );
<a name="l200"><span class="linenum"> 200</span></a>  
<a name="l201"><span class="linenum"> 201</span></a>                  if( empty(<a class="var it1612" onMouseOver="hilite(1612)" onMouseOut="lolite()" onClick="logVariable('pwd_salt_sess')" href="../../_variables/pwd_salt_sess.html">$pwd_salt_sess</a>) )
<a name="l202"><span class="linenum"> 202</span></a>                  { // no salt stored in session: either cookie problem or the user had already tried logging in (from another window for example)
<a name="l203"><span class="linenum"> 203</span></a>                      <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Login: Empty salt_sess!', '_init_login' );
<a name="l204"><span class="linenum"> 204</span></a>                      if( (<a class="var it1617" onMouseOver="hilite(1617)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../../_variables/pos.html">$pos</a> = <a class="phpfunction" onClick="logFunction('strpos')" href="../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it1607" onMouseOver="hilite(1607)" onMouseOut="lolite()" onClick="logVariable('pass')" href="../../_variables/pass.html">$pass</a>, '_hashed_' ) ) &amp;&amp; <a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it1607" onMouseOver="hilite(1607)" onMouseOut="lolite()" onClick="logVariable('pass')" href="../../_variables/pass.html">$pass</a>, <a class="var it1617" onMouseOver="hilite(1617)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../../_variables/pos.html">$pos</a>+8) == <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>-&gt;<a onClick="logVariable('ID')" class="var it9059" onMouseOver="hilite(9059)" onMouseOut="lolite()" href="../../_variables/ID.html">ID</a> )
<a name="l205"><span class="linenum"> 205</span></a>                      { // session ID matches, no cookie problem
<a name="l206"><span class="linenum"> 206</span></a>                          <a class="var it1606" onMouseOver="hilite(1606)" onMouseOut="lolite()" onClick="logVariable('login_error')" href="../../_variables/login_error.html">$login_error</a> = <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The login window has expired. Please try again.');
<a name="l207"><span class="linenum"> 207</span></a>                          <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Login: Session ID matches.', '_init_login' );
<a name="l208"><span class="linenum"> 208</span></a>                      }
<a name="l209"><span class="linenum"> 209</span></a>                      else
<a name="l210"><span class="linenum"> 210</span></a>                      { // more general error:
<a name="l211"><span class="linenum"> 211</span></a>                          <a class="var it1606" onMouseOver="hilite(1606)" onMouseOut="lolite()" onClick="logVariable('login_error')" href="../../_variables/login_error.html">$login_error</a> = <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Either you have not enabled cookies or this login window has expired.');
<a name="l212"><span class="linenum"> 212</span></a>                          <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Login: Session ID does not match.', '_init_login' );
<a name="l213"><span class="linenum"> 213</span></a>                      }
<a name="l214"><span class="linenum"> 214</span></a>                  }
<a name="l215"><span class="linenum"> 215</span></a>                  elseif( <a class="var it1616" onMouseOver="hilite(1616)" onMouseOut="lolite()" onClick="logVariable('pwd_salt')" href="../../_variables/pwd_salt.html">$pwd_salt</a> != <a class="var it1612" onMouseOver="hilite(1612)" onMouseOut="lolite()" onClick="logVariable('pwd_salt_sess')" href="../../_variables/pwd_salt_sess.html">$pwd_salt_sess</a> )
<a name="l216"><span class="linenum"> 216</span></a>                  { // submitted salt differs from the one stored in the session
<a name="l217"><span class="linenum"> 217</span></a>                      <a class="var it1606" onMouseOver="hilite(1606)" onMouseOut="lolite()" onClick="logVariable('login_error')" href="../../_variables/login_error.html">$login_error</a> = <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The login window has expired. Please try again.');
<a name="l218"><span class="linenum"> 218</span></a>                      <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Login: Submitted salt and salt from Session do not match.', '_init_login' );
<a name="l219"><span class="linenum"> 219</span></a>                  }
<a name="l220"><span class="linenum"> 220</span></a>                  else
<a name="l221"><span class="linenum"> 221</span></a>                  { // compare the password, using the salt stored in the Session:
<a name="l222"><span class="linenum"> 222</span></a>  <span class="comment">                    #pre_dump( sha1($User-&gt;pass.$pwd_salt), $pwd_hashed );</span>
<a name="l223"><span class="linenum"> 223</span></a>                      <a class="var it1614" onMouseOver="hilite(1614)" onMouseOut="lolite()" onClick="logVariable('pass_ok')" href="../../_variables/pass_ok.html">$pass_ok</a> = <a class="phpfunction" onClick="logFunction('sha1')" href="../../_functions/sha1.html" onMouseOver="phpfuncPopup(event,'sha1')">sha1</a>(<a class="var it197" onMouseOver="hilite(197)" onMouseOut="lolite()" onClick="logVariable('User')" href="../../_variables/User.html">$User</a>-&gt;<a onClick="logVariable('pass')" class="var it9005" onMouseOver="hilite(9005)" onMouseOut="lolite()" href="../../_variables/pass.html">pass</a>.<a class="var it1616" onMouseOver="hilite(1616)" onMouseOut="lolite()" onClick="logVariable('pwd_salt')" href="../../_variables/pwd_salt.html">$pwd_salt</a>) == <a class="var it1613" onMouseOver="hilite(1613)" onMouseOut="lolite()" onClick="logVariable('pwd_hashed')" href="../../_variables/pwd_hashed.html">$pwd_hashed</a>;
<a name="l224"><span class="linenum"> 224</span></a>                      <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('delete')" href="../../_functions/delete.html" onMouseOver="funcPopup(event,'delete')">delete</a>('core.pwd_salt');
<a name="l225"><span class="linenum"> 225</span></a>                      <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Login: Compared hashed passwords. Result: '.(int)<a class="var it1614" onMouseOver="hilite(1614)" onMouseOut="lolite()" onClick="logVariable('pass_ok')" href="../../_variables/pass_ok.html">$pass_ok</a>, '_init_login' );
<a name="l226"><span class="linenum"> 226</span></a>                  }
<a name="l227"><span class="linenum"> 227</span></a>              }
<a name="l228"><span class="linenum"> 228</span></a>              else
<a name="l229"><span class="linenum"> 229</span></a>              {
<a name="l230"><span class="linenum"> 230</span></a>                  <a class="var it1614" onMouseOver="hilite(1614)" onMouseOut="lolite()" onClick="logVariable('pass_ok')" href="../../_variables/pass_ok.html">$pass_ok</a> = ( <a class="var it197" onMouseOver="hilite(197)" onMouseOut="lolite()" onClick="logVariable('User')" href="../../_variables/User.html">$User</a>-&gt;<a onClick="logVariable('pass')" class="var it9005" onMouseOver="hilite(9005)" onMouseOut="lolite()" href="../../_variables/pass.html">pass</a> == <a class="var it1608" onMouseOver="hilite(1608)" onMouseOut="lolite()" onClick="logVariable('pass_md5')" href="../../_variables/pass_md5.html">$pass_md5</a> );
<a name="l231"><span class="linenum"> 231</span></a>                  <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Login: Compared raw passwords. Result: '.(int)<a class="var it1614" onMouseOver="hilite(1614)" onMouseOut="lolite()" onClick="logVariable('pass_ok')" href="../../_variables/pass_ok.html">$pass_ok</a>, '_init_login' );
<a name="l232"><span class="linenum"> 232</span></a>              }
<a name="l233"><span class="linenum"> 233</span></a>          }
<a name="l234"><span class="linenum"> 234</span></a>      }
<a name="l235"><span class="linenum"> 235</span></a>  
<a name="l236"><span class="linenum"> 236</span></a>      if( <a class="var it1614" onMouseOver="hilite(1614)" onMouseOut="lolite()" onClick="logVariable('pass_ok')" href="../../_variables/pass_ok.html">$pass_ok</a> )
<a name="l237"><span class="linenum"> 237</span></a>      { // Login succeeded, set cookies
<a name="l238"><span class="linenum"> 238</span></a>          <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Login: User successfully logged in with username and password...', '_init_login');
<a name="l239"><span class="linenum"> 239</span></a>  <span class="comment">        // set the user from the login that succeeded</span>
<a name="l240"><span class="linenum"> 240</span></a>          if( <a class="var it1609" onMouseOver="hilite(1609)" onMouseOut="lolite()" onClick="logVariable('email_login')" href="../../_variables/email_login.html">$email_login</a> )
<a name="l241"><span class="linenum"> 241</span></a>          {
<a name="l242"><span class="linenum"> 242</span></a>              <a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('login')" href="../../_variables/login.html">$login</a> = <a class="var it1609" onMouseOver="hilite(1609)" onMouseOut="lolite()" onClick="logVariable('email_login')" href="../../_variables/email_login.html">$email_login</a>;
<a name="l243"><span class="linenum"> 243</span></a>          }
<a name="l244"><span class="linenum"> 244</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a> = &amp; <a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('UserCache')" href="../../_variables/UserCache.html">$UserCache</a>-&gt;get_by_login(<a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('login')" href="../../_variables/login.html">$login</a>);
<a name="l245"><span class="linenum"> 245</span></a>  <span class="comment">        // check and don't login if the current user account was closed</span>
<a name="l246"><span class="linenum"> 246</span></a>          if( <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_status')" href="../../_functions/check_status.html" onMouseOver="funcPopup(event,'check_status')">check_status</a>( 'is_closed' ) )
<a name="l247"><span class="linenum"> 247</span></a>          { // user account was closed
<a name="l248"><span class="linenum"> 248</span></a>              unset( <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a> );
<a name="l249"><span class="linenum"> 249</span></a>              <a class="var it1606" onMouseOver="hilite(1606)" onMouseOut="lolite()" onClick="logVariable('login_error')" href="../../_variables/login_error.html">$login_error</a> = <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('This account is closed. You cannot log in.');
<a name="l250"><span class="linenum"> 250</span></a>          }
<a name="l251"><span class="linenum"> 251</span></a>          elseif( <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../_variables/Settings.html">$Settings</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>('system_lock') &amp;&amp; !<a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'users', 'edit' ) )
<a name="l252"><span class="linenum"> 252</span></a>          { // System is locked for maintenance and current user has no permission to log in this mode
<a name="l253"><span class="linenum"> 253</span></a>              unset( <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a> );
<a name="l254"><span class="linenum"> 254</span></a>              <a class="var it1606" onMouseOver="hilite(1606)" onMouseOut="lolite()" onClick="logVariable('login_error')" href="../../_variables/login_error.html">$login_error</a> = <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('You cannot log in at this time because the system is under maintenance. Please try again in a few moments.');
<a name="l255"><span class="linenum"> 255</span></a>          }
<a name="l256"><span class="linenum"> 256</span></a>          else
<a name="l257"><span class="linenum"> 257</span></a>          { // save the user for later hits
<a name="l258"><span class="linenum"> 258</span></a>              <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('set_User')" href="../../_functions/set_user.html" onMouseOver="funcPopup(event,'set_user')">set_User</a>( <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a> );
<a name="l259"><span class="linenum"> 259</span></a>  
<a name="l260"><span class="linenum"> 260</span></a>              <a class="var it1618" onMouseOver="hilite(1618)" onMouseOut="lolite()" onClick="logVariable('current_user_locale')" href="../../_variables/current_user_locale.html">$current_user_locale</a> = <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>( 'locale' );
<a name="l261"><span class="linenum"> 261</span></a>              if( ( ! isset( <a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('locales')" href="../../_variables/locales.html">$locales</a>[<a class="var it1618" onMouseOver="hilite(1618)" onMouseOut="lolite()" onClick="logVariable('current_user_locale')" href="../../_variables/current_user_locale.html">$current_user_locale</a>] ) ) || ( ! <a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('locales')" href="../../_variables/locales.html">$locales</a>[<a class="var it1618" onMouseOver="hilite(1618)" onMouseOut="lolite()" onClick="logVariable('current_user_locale')" href="../../_variables/current_user_locale.html">$current_user_locale</a>]['enabled'] ) )
<a name="l262"><span class="linenum"> 262</span></a>              { // Current user locale doesn't exists or it is not enabled, update to the default locale if it is valid
<a name="l263"><span class="linenum"> 263</span></a>                  <a class="var it1620" onMouseOver="hilite(1620)" onMouseOut="lolite()" onClick="logVariable('def_locale')" href="../../_variables/def_locale.html">$def_locale</a> = <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../_variables/Settings.html">$Settings</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>( 'default_locale' );
<a name="l264"><span class="linenum"> 264</span></a>                  if( isset( <a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('locales')" href="../../_variables/locales.html">$locales</a>[<a class="var it1620" onMouseOver="hilite(1620)" onMouseOut="lolite()" onClick="logVariable('def_locale')" href="../../_variables/def_locale.html">$def_locale</a>] ) &amp;&amp; <a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('locales')" href="../../_variables/locales.html">$locales</a>[<a class="var it1620" onMouseOver="hilite(1620)" onMouseOut="lolite()" onClick="logVariable('def_locale')" href="../../_variables/def_locale.html">$def_locale</a>]['enabled'] )
<a name="l265"><span class="linenum"> 265</span></a>                  { // Update user locale to the default, and add warning message about the update
<a name="l266"><span class="linenum"> 266</span></a>                      <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'locale', <a class="var it1620" onMouseOver="hilite(1620)" onMouseOut="lolite()" onClick="logVariable('def_locale')" href="../../_variables/def_locale.html">$def_locale</a> );
<a name="l267"><span class="linenum"> 267</span></a>                      <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('dbupdate')" href="../../_functions/dbupdate.html" onMouseOver="funcPopup(event,'dbupdate')">dbupdate</a>();
<a name="l268"><span class="linenum"> 268</span></a>                      <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Your locale was invalid, now it was automitcally updated to the default locale.'), 'warning' );
<a name="l269"><span class="linenum"> 269</span></a>                  }
<a name="l270"><span class="linenum"> 270</span></a>              }
<a name="l271"><span class="linenum"> 271</span></a>  
<a name="l272"><span class="linenum"> 272</span></a>              if( <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../_variables/Settings.html">$Settings</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>('system_lock') &amp;&amp; <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'users', 'edit' ) )
<a name="l273"><span class="linenum"> 273</span></a>              { // System is locked for maintenance but current user has permission to log in, Display a message about this mode
<a name="l274"><span class="linenum"> 274</span></a>                  <a class="var it1621" onMouseOver="hilite(1621)" onMouseOut="lolite()" onClick="logVariable('system_lock_url')" href="../../_variables/system_lock_url.html">$system_lock_url</a> = ' href=&quot;'.<a class="var it346" onMouseOver="hilite(346)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../_variables/admin_url.html">$admin_url</a>.'?ctrl=gensettings&quot;';
<a name="l275"><span class="linenum"> 275</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The site is currently locked for maintenance. Click &lt;a %s&gt;here&lt;/a&gt; to access lock settings.'), <a class="var it1621" onMouseOver="hilite(1621)" onMouseOut="lolite()" onClick="logVariable('system_lock_url')" href="../../_variables/system_lock_url.html">$system_lock_url</a> ), 'warning' );
<a name="l276"><span class="linenum"> 276</span></a>              }
<a name="l277"><span class="linenum"> 277</span></a>          }
<a name="l278"><span class="linenum"> 278</span></a>      }
<a name="l279"><span class="linenum"> 279</span></a>      elseif( empty( <a class="var it1606" onMouseOver="hilite(1606)" onMouseOut="lolite()" onClick="logVariable('login_error')" href="../../_variables/login_error.html">$login_error</a> ) )
<a name="l280"><span class="linenum"> 280</span></a>      { // if the login_error wasn't set yet, add the default one:
<a name="l281"><span class="linenum"> 281</span></a>  <span class="comment">        // This will cause the login screen to &quot;popup&quot; (again)</span>
<a name="l282"><span class="linenum"> 282</span></a>          <a class="var it1606" onMouseOver="hilite(1606)" onMouseOut="lolite()" onClick="logVariable('login_error')" href="../../_variables/login_error.html">$login_error</a> = <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Wrong login/password.');
<a name="l283"><span class="linenum"> 283</span></a>      }
<a name="l284"><span class="linenum"> 284</span></a>  
<a name="l285"><span class="linenum"> 285</span></a>  }
<a name="l286"><span class="linenum"> 286</span></a>  elseif( <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('has_User')" href="../../_functions/has_user.html" onMouseOver="funcPopup(event,'has_user')">has_User</a>() <span class="comment">/* logged in */</span>
<a name="l287"><span class="linenum"> 287</span></a>      &amp;&amp; <span class="comment">/* No login param given or the same as current user: */</span>
<a name="l288"><span class="linenum"> 288</span></a>      ( empty(<a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('login')" href="../../_variables/login.html">$login</a>) || ( ( <a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('tmp_User')" href="../../_variables/tmp_User.html">$tmp_User</a> = &amp; <a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('UserCache')" href="../../_variables/UserCache.html">$UserCache</a>-&gt;get_by_ID(<a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>-&gt;<a onClick="logVariable('user_ID')" class="var it9059" onMouseOver="hilite(9059)" onMouseOut="lolite()" href="../../_variables/user_ID.html">user_ID</a>) ) &amp;&amp; <a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('login')" href="../../_variables/login.html">$login</a> == <a class="var it517" onMouseOver="hilite(517)" onMouseOut="lolite()" onClick="logVariable('tmp_User')" href="../../_variables/tmp_User.html">$tmp_User</a>-&gt;<a onClick="logVariable('login')" class="var it9262" onMouseOver="hilite(9262)" onMouseOut="lolite()" href="../../_variables/login.html">login</a> ) ) )
<a name="l289"><span class="linenum"> 289</span></a>  { <span class="comment">/* if the session has a user assigned to it:</span>
<a name="l290"><span class="linenum"> 290</span></a>  <span class="comment">     * User was not trying to log in, but he was already logged in:</span>
<a name="l291"><span class="linenum"> 291</span></a>  <span class="comment">     */</span>
<a name="l292"><span class="linenum"> 292</span></a>  <span class="comment">    // get the user ID from the session and set up the user again</span>
<a name="l293"><span class="linenum"> 293</span></a>      <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a> = &amp; <a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('UserCache')" href="../../_variables/UserCache.html">$UserCache</a>-&gt;get_by_ID( <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>-&gt;<a onClick="logVariable('user_ID')" class="var it9059" onMouseOver="hilite(9059)" onMouseOut="lolite()" href="../../_variables/user_ID.html">user_ID</a> );
<a name="l294"><span class="linenum"> 294</span></a>  
<a name="l295"><span class="linenum"> 295</span></a>      if( <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../_variables/Settings.html">$Settings</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>('system_lock') )
<a name="l296"><span class="linenum"> 296</span></a>      { // System is locked for maintenance
<a name="l297"><span class="linenum"> 297</span></a>          if( <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'users', 'edit' ) )
<a name="l298"><span class="linenum"> 298</span></a>          { // Current user is a &quot;super admin&quot;
<a name="l299"><span class="linenum"> 299</span></a>              if( ! <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>() )
<a name="l300"><span class="linenum"> 300</span></a>              { // If there are no other messages yet, display a warning about the system lock
<a name="l301"><span class="linenum"> 301</span></a>                  <a class="var it1621" onMouseOver="hilite(1621)" onMouseOut="lolite()" onClick="logVariable('system_lock_url')" href="../../_variables/system_lock_url.html">$system_lock_url</a> = ' href=&quot;'.<a class="var it346" onMouseOver="hilite(346)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../_variables/admin_url.html">$admin_url</a>.'?ctrl=gensettings&quot;';
<a name="l302"><span class="linenum"> 302</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The site is currently locked for maintenance. Click &lt;a %s&gt;here&lt;/a&gt; to access lock settings.'), <a class="var it1621" onMouseOver="hilite(1621)" onMouseOut="lolite()" onClick="logVariable('system_lock_url')" href="../../_variables/system_lock_url.html">$system_lock_url</a> ), 'warning' );
<a name="l303"><span class="linenum"> 303</span></a>              }
<a name="l304"><span class="linenum"> 304</span></a>          }
<a name="l305"><span class="linenum"> 305</span></a>          else
<a name="l306"><span class="linenum"> 306</span></a>          { // Current user has no permission to be logged in on this mode, we must logout it
<a name="l307"><span class="linenum"> 307</span></a>              <a class="function" onClick="logFunction('logout')" href="../../_functions/logout.html" onMouseOver="funcPopup(event,'logout')">logout</a>();
<a name="l308"><span class="linenum"> 308</span></a>              <a class="var it1606" onMouseOver="hilite(1606)" onMouseOut="lolite()" onClick="logVariable('login_error')" href="../../_variables/login_error.html">$login_error</a> = <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('You have been logged out because the system is under maintenance. Please log in again in a few moments.');
<a name="l309"><span class="linenum"> 309</span></a>          }
<a name="l310"><span class="linenum"> 310</span></a>      }
<a name="l311"><span class="linenum"> 311</span></a>      else
<a name="l312"><span class="linenum"> 312</span></a>      {
<a name="l313"><span class="linenum"> 313</span></a>          <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Login: Was already logged in... ['.<a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>('login').']', '_init_login' );
<a name="l314"><span class="linenum"> 314</span></a>      }
<a name="l315"><span class="linenum"> 315</span></a>  }
<a name="l316"><span class="linenum"> 316</span></a>  else
<a name="l317"><span class="linenum"> 317</span></a>  { // The Session has no user or <a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('login')" href="../../_variables/login.html">$login</a> is given (and differs from current user), allow alternate authentication through Plugin:
<a name="l318"><span class="linenum"> 318</span></a>      if( (<a class="var it1622" onMouseOver="hilite(1622)" onMouseOut="lolite()" onClick="logVariable('event_return')" href="../../_variables/event_return.html">$event_return</a> = <a class="var it16" onMouseOver="hilite(16)" onMouseOut="lolite()" onClick="logVariable('Plugins')" href="../../_variables/Plugins.html">$Plugins</a>-&gt;<a class="function" onClick="logFunction('trigger_event_first_true')" href="../../_functions/trigger_event_first_true.html" onMouseOver="funcPopup(event,'trigger_event_first_true')">trigger_event_first_true</a>( 'AlternateAuthentication' ))
<a name="l319"><span class="linenum"> 319</span></a>          &amp;&amp; <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('has_User')" href="../../_functions/has_user.html" onMouseOver="funcPopup(event,'has_user')">has_User</a>()  # the plugin should have attached the user to <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>
<a name="l320"><span class="linenum"> 320</span></a>      )
<a name="l321"><span class="linenum"> 321</span></a>      {
<a name="l322"><span class="linenum"> 322</span></a>          <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Login: User has been authenticated through plugin #'.<a class="var it1622" onMouseOver="hilite(1622)" onMouseOut="lolite()" onClick="logVariable('event_return')" href="../../_variables/event_return.html">$event_return</a>['plugin_ID'].' (AlternateAuthentication)', '_init_login' );
<a name="l323"><span class="linenum"> 323</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a> = &amp; <a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('UserCache')" href="../../_variables/UserCache.html">$UserCache</a>-&gt;get_by_ID( <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>-&gt;<a onClick="logVariable('user_ID')" class="var it9059" onMouseOver="hilite(9059)" onMouseOut="lolite()" href="../../_variables/user_ID.html">user_ID</a> );
<a name="l324"><span class="linenum"> 324</span></a>      }
<a name="l325"><span class="linenum"> 325</span></a>      elseif( <a class="var it742" onMouseOver="hilite(742)" onMouseOut="lolite()" onClick="logVariable('login_required')" href="../../_variables/login_required.html">$login_required</a> )
<a name="l326"><span class="linenum"> 326</span></a>      {    <span class="comment">/*</span>
<a name="l327"><span class="linenum"> 327</span></a>  <span class="comment">         * ---------------------------------------------------------</span>
<a name="l328"><span class="linenum"> 328</span></a>  <span class="comment">         * User was not logged in at all, but login is required</span>
<a name="l329"><span class="linenum"> 329</span></a>  <span class="comment">         * ---------------------------------------------------------</span>
<a name="l330"><span class="linenum"> 330</span></a>  <span class="comment">         */</span>
<a name="l331"><span class="linenum"> 331</span></a>  <span class="comment">        // echo ' NOT logged in...';</span>
<a name="l332"><span class="linenum"> 332</span></a>          <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Login: NOT logged in... (did not try)', '_init_login' );
<a name="l333"><span class="linenum"> 333</span></a>      }
<a name="l334"><span class="linenum"> 334</span></a>  }
<a name="l335"><span class="linenum"> 335</span></a>  unset(<a class="var it1607" onMouseOver="hilite(1607)" onMouseOut="lolite()" onClick="logVariable('pass')" href="../../_variables/pass.html">$pass</a>);
<a name="l336"><span class="linenum"> 336</span></a>  
<a name="l337"><span class="linenum"> 337</span></a>  <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> = <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'action', 'string', NULL );
<a name="l338"><span class="linenum"> 338</span></a>  <span class="comment">// Check if the user needs to be validated, but is not yet:</span>
<a name="l339"><span class="linenum"> 339</span></a>  if( <a class="function" onClick="logFunction('check_user_status')" href="../../_functions/check_user_status.html" onMouseOver="funcPopup(event,'check_user_status')">check_user_status</a>( 'can_be_validated' ) // user is logged in but not validated and validation is required
<a name="l340"><span class="linenum"> 340</span></a>      &amp;&amp; <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> != 'logout'
<a name="l341"><span class="linenum"> 341</span></a>      &amp;&amp; <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> != 'req_validatemail' &amp;&amp; <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> != 'validatemail' &amp;&amp; <a class="var it1605" onMouseOver="hilite(1605)" onMouseOut="lolite()" onClick="logVariable('validate_required')" href="../../_variables/validate_required.html">$validate_required</a> )
<a name="l342"><span class="linenum"> 342</span></a>  { // we're not in that action already:
<a name="l343"><span class="linenum"> 343</span></a>      <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> = 'req_validatemail'; <span class="comment">// for login.php</span>
<a name="l344"><span class="linenum"> 344</span></a>      if( <a class="var it1623" onMouseOver="hilite(1623)" onMouseOut="lolite()" onClick="logVariable('is_admin_page')" href="../../_variables/is_admin_page.html">$is_admin_page</a> )
<a name="l345"><span class="linenum"> 345</span></a>      {
<a name="l346"><span class="linenum"> 346</span></a>          <a class="var it1606" onMouseOver="hilite(1606)" onMouseOut="lolite()" onClick="logVariable('login_error')" href="../../_variables/login_error.html">$login_error</a> = <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('In order to access the admin interface, you must first activate your account by clicking on the activation link in the email we sent you. &lt;b&gt;See below:&lt;/b&gt;');
<a name="l347"><span class="linenum"> 347</span></a>      }
<a name="l348"><span class="linenum"> 348</span></a>  }
<a name="l349"><span class="linenum"> 349</span></a>  <span class="comment">// asimo&gt; If login action is not empty and there was no login error, and action is not logut the we must log in</span>
<a name="l350"><span class="linenum"> 350</span></a>  if( !empty(<a class="var it1611" onMouseOver="hilite(1611)" onMouseOut="lolite()" onClick="logVariable('login_action')" href="../../_variables/login_action.html">$login_action</a>) &amp;&amp; empty( <a class="var it1606" onMouseOver="hilite(1606)" onMouseOut="lolite()" onClick="logVariable('login_error')" href="../../_variables/login_error.html">$login_error</a> ) &amp;&amp; ( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> != 'logout' ) )
<a name="l351"><span class="linenum"> 351</span></a>  { // Trigger plugin event that allows the plugins to re-act on the login event:
<a name="l352"><span class="linenum"> 352</span></a>  <span class="comment">    // TODO: dh&gt; these events should provide a flag &quot;login_attempt_failed&quot;.</span>
<a name="l353"><span class="linenum"> 353</span></a>      if( empty(<a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>) )
<a name="l354"><span class="linenum"> 354</span></a>      {
<a name="l355"><span class="linenum"> 355</span></a>          <a class="var it16" onMouseOver="hilite(16)" onMouseOut="lolite()" onClick="logVariable('Plugins')" href="../../_variables/Plugins.html">$Plugins</a>-&gt;<a class="function" onClick="logFunction('trigger_event')" href="../../_functions/trigger_event.html" onMouseOver="funcPopup(event,'trigger_event')">trigger_event</a>( 'AfterLoginAnonymousUser', array() );
<a name="l356"><span class="linenum"> 356</span></a>      }
<a name="l357"><span class="linenum"> 357</span></a>      else
<a name="l358"><span class="linenum"> 358</span></a>      {
<a name="l359"><span class="linenum"> 359</span></a>          <a class="var it16" onMouseOver="hilite(16)" onMouseOut="lolite()" onClick="logVariable('Plugins')" href="../../_variables/Plugins.html">$Plugins</a>-&gt;<a class="function" onClick="logFunction('trigger_event')" href="../../_functions/trigger_event.html" onMouseOver="funcPopup(event,'trigger_event')">trigger_event</a>( 'AfterLoginRegisteredUser', array() );
<a name="l360"><span class="linenum"> 360</span></a>  
<a name="l361"><span class="linenum"> 361</span></a>          if( ! empty(<a class="var it1611" onMouseOver="hilite(1611)" onMouseOut="lolite()" onClick="logVariable('login_action')" href="../../_variables/login_action.html">$login_action</a>) )
<a name="l362"><span class="linenum"> 362</span></a>          { // We're coming from the Login form and need to redirect to the requested page:
<a name="l363"><span class="linenum"> 363</span></a>              if( <a class="var it1611" onMouseOver="hilite(1611)" onMouseOut="lolite()" onClick="logVariable('login_action')" href="../../_variables/login_action.html">$login_action</a> == 'redirect_to_backoffice' )
<a name="l364"><span class="linenum"> 364</span></a>              { // user pressed the &quot;Log into backoffice!&quot; button
<a name="l365"><span class="linenum"> 365</span></a>                  <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../_variables/redirect_to.html">$redirect_to</a> = <a class="var it346" onMouseOver="hilite(346)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../_variables/admin_url.html">$admin_url</a>;
<a name="l366"><span class="linenum"> 366</span></a>              }
<a name="l367"><span class="linenum"> 367</span></a>              else
<a name="l368"><span class="linenum"> 368</span></a>              {
<a name="l369"><span class="linenum"> 369</span></a>                  <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../_variables/redirect_to.html">$redirect_to</a> = <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'redirect_to', 'url', <a class="var it153" onMouseOver="hilite(153)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../_variables/baseurl.html">$baseurl</a> );
<a name="l370"><span class="linenum"> 370</span></a>                  if( <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>( '#/login.php([&amp;?].*)?$#', <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../_variables/redirect_to.html">$redirect_to</a> ) ||
<a name="l371"><span class="linenum"> 371</span></a>                      <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>( '#/register.php([&amp;?].*)?$#', <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../_variables/redirect_to.html">$redirect_to</a> ) ||
<a name="l372"><span class="linenum"> 372</span></a>                      <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>( '#disp=(login|register|lostpassword)#', <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../_variables/redirect_to.html">$redirect_to</a> ) )
<a name="l373"><span class="linenum"> 373</span></a>                  { // avoid redirect back to login/register screen. This shouldn't occur.
<a name="l374"><span class="linenum"> 374</span></a>                      <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../_variables/redirect_to.html">$redirect_to</a> = <a class="var it153" onMouseOver="hilite(153)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../_variables/baseurl.html">$baseurl</a>;
<a name="l375"><span class="linenum"> 375</span></a>                  }
<a name="l376"><span class="linenum"> 376</span></a>              }
<a name="l377"><span class="linenum"> 377</span></a>  
<a name="l378"><span class="linenum"> 378</span></a>              if( <a class="var it1609" onMouseOver="hilite(1609)" onMouseOut="lolite()" onClick="logVariable('email_login')" href="../../_variables/email_login.html">$email_login</a> )
<a name="l379"><span class="linenum"> 379</span></a>              {
<a name="l380"><span class="linenum"> 380</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>( 'You are now logged in as &lt;b&gt;%s&lt;/b&gt;' ), <a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('login')" href="../../_variables/login.html">$login</a> ), ( <a class="var it1615" onMouseOver="hilite(1615)" onMouseOut="lolite()" onClick="logVariable('exists_more')" href="../../_variables/exists_more.html">$exists_more</a> ? 'error' : 'success' ) );
<a name="l381"><span class="linenum"> 381</span></a>              }
<a name="l382"><span class="linenum"> 382</span></a>  
<a name="l383"><span class="linenum"> 383</span></a>              <a class="function" onClick="logFunction('header_redirect')" href="../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( <a class="var it233" onMouseOver="hilite(233)" onMouseOut="lolite()" onClick="logVariable('redirect_to')" href="../../_variables/redirect_to.html">$redirect_to</a> );
<a name="l384"><span class="linenum"> 384</span></a>              exit(0);
<a name="l385"><span class="linenum"> 385</span></a>          }
<a name="l386"><span class="linenum"> 386</span></a>      }
<a name="l387"><span class="linenum"> 387</span></a>  }
<a name="l388"><span class="linenum"> 388</span></a>  
<a name="l389"><span class="linenum"> 389</span></a>  if( ! empty( <a class="var it1606" onMouseOver="hilite(1606)" onMouseOut="lolite()" onClick="logVariable('login_error')" href="../../_variables/login_error.html">$login_error</a> ) || ( <a class="var it742" onMouseOver="hilite(742)" onMouseOut="lolite()" onClick="logVariable('login_required')" href="../../_variables/login_required.html">$login_required</a> &amp;&amp; ! <a class="function" onClick="logFunction('is_logged_in')" href="../../_functions/is_logged_in.html" onMouseOver="funcPopup(event,'is_logged_in')">is_logged_in</a>() ) )
<a name="l390"><span class="linenum"> 390</span></a>  { // ----- LOGIN FAILED ----- OR Login is required and user is not logged in yet
<a name="l391"><span class="linenum"> 391</span></a>      <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Login error: '.<a class="var it1606" onMouseOver="hilite(1606)" onMouseOut="lolite()" onClick="logVariable('login_error')" href="../../_variables/login_error.html">$login_error</a>, '_init_login' );
<a name="l392"><span class="linenum"> 392</span></a>  <span class="comment">    // inskin param is set when the login request come from the front office</span>
<a name="l393"><span class="linenum"> 393</span></a>  <span class="comment">    // we need this to decide if we should use display in-skin login from or not</span>
<a name="l394"><span class="linenum"> 394</span></a>      <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'inskin', 'boolean', 0 );
<a name="l395"><span class="linenum"> 395</span></a>      <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Param inskin: '.<a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('inskin')" href="../../_variables/inskin.html">$inskin</a>, '_init_login' );
<a name="l396"><span class="linenum"> 396</span></a>      if( <a class="var it1624" onMouseOver="hilite(1624)" onMouseOut="lolite()" onClick="logVariable('inskin')" href="../../_variables/inskin.html">$inskin</a> || <a class="function" onClick="logFunction('use_in_skin_login')" href="../../_functions/use_in_skin_login.html" onMouseOver="funcPopup(event,'use_in_skin_login')">use_in_skin_login</a>() )
<a name="l397"><span class="linenum"> 397</span></a>      { // Use in-skin login
<a name="l398"><span class="linenum"> 398</span></a>          <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Trying to use in-skin login', '_init_login' );
<a name="l399"><span class="linenum"> 399</span></a>  
<a name="l400"><span class="linenum"> 400</span></a>          if( <a class="function" onClick="logFunction('is_logged_in')" href="../../_functions/is_logged_in.html" onMouseOver="funcPopup(event,'is_logged_in')">is_logged_in</a>() )
<a name="l401"><span class="linenum"> 401</span></a>          { // user is logged in, but the email address is not validated yet
<a name="l402"><span class="linenum"> 402</span></a>              <a class="var it313" onMouseOver="hilite(313)" onMouseOut="lolite()" onClick="logVariable('login')" href="../../_variables/login.html">$login</a> = <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a onClick="logVariable('login')" class="var it8987" onMouseOver="hilite(8987)" onMouseOut="lolite()" href="../../_variables/login.html">login</a>;
<a name="l403"><span class="linenum"> 403</span></a>              <a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('email')" href="../../_variables/email.html">$email</a> = <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a onClick="logVariable('email')" class="var it8987" onMouseOver="hilite(8987)" onMouseOut="lolite()" href="../../_variables/email.html">email</a>;
<a name="l404"><span class="linenum"> 404</span></a>          }
<a name="l405"><span class="linenum"> 405</span></a>  
<a name="l406"><span class="linenum"> 406</span></a>          if( empty( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../_variables/Blog.html">$Blog</a> ) &amp;&amp; <a class="function" onClick="logFunction('init_requested_blog')" href="../../_functions/init_requested_blog.html" onMouseOver="funcPopup(event,'init_requested_blog')">init_requested_blog</a>() )
<a name="l407"><span class="linenum"> 407</span></a>          { // <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../_variables/blog.html">$blog</a> is set, init <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../_variables/Blog.html">$Blog</a> also
<a name="l408"><span class="linenum"> 408</span></a>              <a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('BlogCache')" href="../../_variables/BlogCache.html">$BlogCache</a> = &amp; get_BlogCache();
<a name="l409"><span class="linenum"> 409</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../_variables/Blog.html">$Blog</a> = <a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('BlogCache')" href="../../_variables/BlogCache.html">$BlogCache</a>-&gt;get_by_ID( <a class="var it231" onMouseOver="hilite(231)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../_variables/blog.html">$blog</a>, false, false );
<a name="l410"><span class="linenum"> 410</span></a>          }
<a name="l411"><span class="linenum"> 411</span></a>  
<a name="l412"><span class="linenum"> 412</span></a>          <a class="var it1625" onMouseOver="hilite(1625)" onMouseOut="lolite()" onClick="logVariable('blog_skin_ID')" href="../../_variables/blog_skin_ID.html">$blog_skin_ID</a> = NULL;
<a name="l413"><span class="linenum"> 413</span></a>          if( !empty( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../_variables/Blog.html">$Blog</a> ) )
<a name="l414"><span class="linenum"> 414</span></a>          { // Blog was set
<a name="l415"><span class="linenum"> 415</span></a>              <a class="var it1625" onMouseOver="hilite(1625)" onMouseOut="lolite()" onClick="logVariable('blog_skin_ID')" href="../../_variables/blog_skin_ID.html">$blog_skin_ID</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../_variables/Blog.html">$Blog</a>-&gt;<a class="function" onClick="logFunction('get_skin_ID')" href="../../_functions/get_skin_id.html" onMouseOver="funcPopup(event,'get_skin_id')">get_skin_ID</a>();
<a name="l416"><span class="linenum"> 416</span></a>          }
<a name="l417"><span class="linenum"> 417</span></a>  
<a name="l418"><span class="linenum"> 418</span></a>          if( !empty( <a class="var it1625" onMouseOver="hilite(1625)" onMouseOut="lolite()" onClick="logVariable('blog_skin_ID')" href="../../_variables/blog_skin_ID.html">$blog_skin_ID</a> ) )
<a name="l419"><span class="linenum"> 419</span></a>          { // Blog exists and skin ID is set
<a name="l420"><span class="linenum"> 420</span></a>  <span class="comment">            // Init charset handling:</span>
<a name="l421"><span class="linenum"> 421</span></a>              <a class="function" onClick="logFunction('init_charsets')" href="../../_functions/init_charsets.html" onMouseOver="funcPopup(event,'init_charsets')">init_charsets</a>( <a class="var it1626" onMouseOver="hilite(1626)" onMouseOut="lolite()" onClick="logVariable('current_charset')" href="../../_variables/current_charset.html">$current_charset</a> );
<a name="l422"><span class="linenum"> 422</span></a>              <a class="function" onClick="logFunction('locale_activate')" href="../../_functions/locale_activate.html" onMouseOver="funcPopup(event,'locale_activate')">locale_activate</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../_variables/Blog.html">$Blog</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>('locale') );
<a name="l423"><span class="linenum"> 423</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="var it1606" onMouseOver="hilite(1606)" onMouseOut="lolite()" onClick="logVariable('login_error')" href="../../_variables/login_error.html">$login_error</a> );
<a name="l424"><span class="linenum"> 424</span></a>              <a class="var it621" onMouseOver="hilite(621)" onMouseOut="lolite()" onClick="logVariable('SkinCache')" href="../../_variables/SkinCache.html">$SkinCache</a> = &amp; get_SkinCache();
<a name="l425"><span class="linenum"> 425</span></a>              <a class="var it543" onMouseOver="hilite(543)" onMouseOut="lolite()" onClick="logVariable('Skin')" href="../../_variables/Skin.html">$Skin</a> = &amp; <a class="var it621" onMouseOver="hilite(621)" onMouseOut="lolite()" onClick="logVariable('SkinCache')" href="../../_variables/SkinCache.html">$SkinCache</a>-&gt;get_by_ID( <a class="var it1625" onMouseOver="hilite(1625)" onMouseOut="lolite()" onClick="logVariable('blog_skin_ID')" href="../../_variables/blog_skin_ID.html">$blog_skin_ID</a> );
<a name="l426"><span class="linenum"> 426</span></a>              <a class="var it244" onMouseOver="hilite(244)" onMouseOut="lolite()" onClick="logVariable('skin')" href="../../_variables/skin.html">$skin</a> = <a class="var it543" onMouseOver="hilite(543)" onMouseOut="lolite()" onClick="logVariable('Skin')" href="../../_variables/Skin.html">$Skin</a>-&gt;<a onClick="logVariable('folder')" class="var it9033" onMouseOver="hilite(9033)" onMouseOut="lolite()" href="../../_variables/folder.html">folder</a>;
<a name="l427"><span class="linenum"> 427</span></a>              <a class="var it140" onMouseOver="hilite(140)" onMouseOut="lolite()" onClick="logVariable('disp')" href="../../_variables/disp.html">$disp</a> = 'login';
<a name="l428"><span class="linenum"> 428</span></a>  <span class="comment">            // fp&gt; We ABSOLUTELY want to recover the previous redirect_to so that after a new login attempt that may be successful,</span>
<a name="l429"><span class="linenum"> 429</span></a>  <span class="comment">            // we will finally reach our intended destination. This is paramount with emails telling people to come back to the site</span>
<a name="l430"><span class="linenum"> 430</span></a>  <span class="comment">            // to read a message or sth like that. They must log in first and they may enter the wrong password multiple times.</span>
<a name="l431"><span class="linenum"> 431</span></a>              <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'redirect_to', 'url', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../_variables/Blog.html">$Blog</a>-&gt;<a class="function" onClick="logFunction('gen_blogurl')" href="../../_functions/gen_blogurl.html" onMouseOver="funcPopup(event,'gen_blogurl')">gen_blogurl</a>() );
<a name="l432"><span class="linenum"> 432</span></a>              <a class="var it583" onMouseOver="hilite(583)" onMouseOut="lolite()" onClick="logVariable('ads_current_skin_path')" href="../../_variables/ads_current_skin_path.html">$ads_current_skin_path</a> = <a class="var it584" onMouseOver="hilite(584)" onMouseOut="lolite()" onClick="logVariable('skins_path')" href="../../_variables/skins_path.html">$skins_path</a>.<a class="var it244" onMouseOver="hilite(244)" onMouseOut="lolite()" onClick="logVariable('skin')" href="../../_variables/skin.html">$skin</a>.'/';
<a name="l433"><span class="linenum"> 433</span></a>              require <a class="var it583" onMouseOver="hilite(583)" onMouseOut="lolite()" onClick="logVariable('ads_current_skin_path')" href="../../_variables/ads_current_skin_path.html">$ads_current_skin_path</a>.'index.main.php';
<a name="l434"><span class="linenum"> 434</span></a>              exit(0);
<a name="l435"><span class="linenum"> 435</span></a>  <span class="comment">            // --- EXITED !! ---</span>
<a name="l436"><span class="linenum"> 436</span></a>          }
<a name="l437"><span class="linenum"> 437</span></a>  
<a name="l438"><span class="linenum"> 438</span></a>          <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'we have NO valid blog to use for inskin login', '_init_login' );
<a name="l439"><span class="linenum"> 439</span></a>      }
<a name="l440"><span class="linenum"> 440</span></a>  
<a name="l441"><span class="linenum"> 441</span></a>  <span class="comment">    // Use standard login</span>
<a name="l442"><span class="linenum"> 442</span></a>      <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Using standard login', '_init_login' );
<a name="l443"><span class="linenum"> 443</span></a>  <span class="comment">    // Init charset handling:</span>
<a name="l444"><span class="linenum"> 444</span></a>      <a class="function" onClick="logFunction('init_charsets')" href="../../_functions/init_charsets.html" onMouseOver="funcPopup(event,'init_charsets')">init_charsets</a>( <a class="var it1626" onMouseOver="hilite(1626)" onMouseOut="lolite()" onClick="logVariable('current_charset')" href="../../_variables/current_charset.html">$current_charset</a> );
<a name="l445"><span class="linenum"> 445</span></a>      require <a class="var it1627" onMouseOver="hilite(1627)" onMouseOut="lolite()" onClick="logVariable('htsrv_path')" href="../../_variables/htsrv_path.html">$htsrv_path</a>.'login.php';
<a name="l446"><span class="linenum"> 446</span></a>      exit(0);
<a name="l447"><span class="linenum"> 447</span></a>  <span class="comment">    // --- EXITED !! ---</span>
<a name="l448"><span class="linenum"> 448</span></a>  }
<a name="l449"><span class="linenum"> 449</span></a>  
<a name="l450"><span class="linenum"> 450</span></a>  <a class="var it146" onMouseOver="hilite(146)" onMouseOut="lolite()" onClick="logVariable('Timer')" href="../../_variables/Timer.html">$Timer</a>-&gt;<a class="function" onClick="logFunction('pause')" href="../../_functions/pause.html" onMouseOver="funcPopup(event,'pause')">pause</a>( '_init_login' );
<a name="l451"><span class="linenum"> 451</span></a>  
<a name="l452"><span class="linenum"> 452</span></a>  ?&gt;
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'user': ['user', 'Constructor ', [['blogs/inc/users/model','_user.class.php',154]], 20],
'trigger_event': ['trigger_event', 'Call all plugins for a given event. ', [['blogs/inc/plugins/model','_plugins.class.php',827]], 114],
'pause': ['pause', 'Pauses a timer category. It may me resumed later on, see {@link resume()}. ', [['blogs/inc/_core/model','_timer.class.php',114]], 71],
'is_email': ['is_email', 'Check that email address looks valid. ', [['blogs/inc/_core','_misc.funcs.php',1789]], 12],
'is_logged_in': ['is_logged_in', 'is_logged_in(-) ', [['blogs/inc/users/model','_user.funcs.php',60]], 190],
'header_redirect': ['header_redirect', 'Sends HTTP header to redirect to the previous location (which can be given as function parameter, GET parameter (redirect_to), is taken from {@link Hit::$referer} or {@link $baseurl}). ', [['blogs/inc/_core','_template.funcs.php',110]], 373],
'remove_magic_quotes': ['remove_magic_quotes', '', [['blogs/inc/_core','_param.funcs.php',1945],['blogs/inc/_core','_param.funcs.php',1964],['blogs/inc/_core','_param.funcs.php',1996]], 15],
'header_nocache': ['header_nocache', 'Sends HTTP headers to avoid caching of the page at the browser level (at least without revalidating with the server to make sure whether the content has changed or not). ', [['blogs/inc/_core','_template.funcs.php',270]], 9],
'set_user': ['set_user', 'Attach a User object to the session. ', [['blogs/inc/sessions/model','_session.class.php',290]], 3],
'assert_received_crumb': ['assert_received_crumb', 'Assert that we received a valid crumb for the object we want to act on. ', [['blogs/inc/sessions/model','_session.class.php',582]], 256],
'antispam_block_request': ['antispam_block_request', 'Block request by IP address, Domain of current user or block because of a Plugin Bock by Plugin: e.g. GeoIP plugin can block the request if it comes from a blocked country ', [['blogs/inc/antispam/model','_antispam.funcs.php',479]], 22],
'evo_strtolower': ['evo_strtolower', 'mbstring wrapper for strtolower function ', [['blogs/inc/_core','_misc.funcs.php',668]], 56],
'check_user_status': ['check_user_status', 'Check if current User status permit the give action ', [['blogs/inc/users/model','_user.funcs.php',73]], 17],
'get_by_emailandpwd': ['get_by_emailandpwd', '', [['blogs/inc/users/model','_usercache.class.php',163]], 1],
'get_skin_id': ['get_skin_id', '', [['blogs/inc/collections/model','_blog.class.php',2634]], 13],
'init_charsets': ['init_charsets', 'Init charset handling between Input/Output ($io_charset) and the internal handling ($evo_charset). ', [['blogs/inc/locales','_locale.funcs.php',1081]], 12],
'check_status': ['check_status', 'Check if user status permit the give action ', [['blogs/inc/users/model','_user.class.php',2598]], 74],
'debug_die': ['debug_die', 'Outputs Unexpected Error message. When in debug mode it also prints a backtrace. ', [['blogs/inc/_core','_misc.funcs.php',2535]], 216],
'list': ['list', '', [['blogs/rsc/js/bootstrap','typeahead.bundle.js',156]], 95],
'param': ['param', 'Sets a parameter with values from the request or to provided default, except if param is already set! ', [['blogs/inc/_core','_param.funcs.php',50]], 1906],
'resume': ['resume', 'Resumes the timer on a category. ', [['blogs/inc/_core/model','_timer.class.php',144]], 43],
'dbupdate': ['dbupdate', 'Update the DB based on previously recorded changes ', [['blogs/inc/chapters/model','_chapter.class.php',317],['blogs/inc/collections/model','_collsettings.class.php',260],['blogs/inc/users/model','_group.class.php',470],['blogs/inc/widgets/model','_widget.class.php',757],['blogs/inc/collections/model','_blog.class.php',2327],['blogs/inc/settings/model','_abstractsettings.class.php',593],['blogs/inc/users/model','_user.class.php',2934],['blogs/inc/skins/model','_skin.class.php',348],['blogs/inc/comments/model','_comment.class.php',3470],['blogs/inc/users/model','_groupsettings.class.php',159],['blogs/inc/cron/model','_cronjob.class.php',207],['blogs/inc/items/model','_item.class.php',4867],['blogs/inc/slugs/model','_slug.class.php',265],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',129],['blogs/inc/files/model','_file.class.php',1739]], 266],
'clear': ['clear', 'Clear the cache ', [['blogs/inc/files/model','_filerootcache.class.php',173],['blogs/inc/users/model','_usercache.class.php',368],['blogs/inc/_core/model','_log.class.php',99],['blogs/inc/_core/model','_log.class.php',603],['blogs/inc/_core/model/dataobjects','_dataobjectcache.class.php',454],['blogs/inc/links/model','_linkcache.class.php',530],['blogs/inc/chapters/model','_chaptercache.class.php',65],['blogs/inc/generic/model','_genericcategorycache.class.php',98],['blogs/inc/_core/model','_messages.class.php',109]], 97],
'get': ['get', '', [['blogs/plugins/tinymce_plugin/tiny_mce','tiny_mce_src.js',941],['blogs/plugins/tinymce_plugin/tiny_mce','tiny_mce_src.js',15011],['blogs/plugins/tinymce_plugin/tiny_mce/plugins/media/js','media.js',7],['blogs/inc/links/model','_linkowner.class.php',221],['blogs/inc/_core/model/db','_sql.class.php',64],['blogs/inc/plugins/model','_pluginsettings.class.php',58],['blogs/inc/collections/model','_blog.class.php',1822],['blogs/inc/settings/model','_generalsettings.class.php',383],['blogs/inc/settings/model','_abstractsettings.class.php',271],['blogs/inc/plugins/model','_pluginusersettings.class.php',58],['blogs/inc/users/model','_user.class.php',1126],['blogs/plugins/tinymce_plugin/tiny_mce','tiny_mce_gzip.js',38],['blogs/inc/users/model','_usersettings.class.php',151],['blogs/inc/comments/model','_comment.class.php',301],['blogs/inc/users/model','_groupsettings.class.php',124],['blogs/inc/cron/model','_cronjob.class.php',104],['blogs/inc/items/model','_item.class.php',5742],['blogs/inc/sessions/model','_session.class.php',397],['blogs/inc/links/model','_linkuser.class.php',141],['blogs/inc/links/model','_linkitem.class.php',155],['blogs/inc/slugs/model','_slug.class.php',68],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',574],['blogs/plugins/twitter_plugin/twitteroauth','twitteroauth.php',146],['blogs/inc/antispam/model','_iprange.class.php',69],['blogs/inc/links/model','_linkcomment.class.php',132],['blogs/inc/files/model','_file.class.php',532]], 2417],
'init_requested_blog': ['init_requested_blog', 'Initialize global $blog variable to the requested blog ', [['blogs/inc/collections/model','_blog.funcs.php',490]], 3],
'param_arrayindex': ['param_arrayindex', 'Get the param from an array param\'s first index instead of the value. ', [['blogs/inc/_core','_param.funcs.php',446]], 3],
'check_perm': ['check_perm', 'Check permission on a message ', [['blogs/inc/messaging/model','_message.class.php',467],['blogs/inc/users/model','_group.class.php',257],['blogs/inc/users/model','_user.class.php',2022],['blogs/inc/links/model','_linkuser.class.php',51],['blogs/inc/links/model','_linkitem.class.php',54],['blogs/inc/_core/model','_module.class.php',233],['blogs/inc/messaging/model','_thread.class.php',476],['blogs/inc/links/model','_linkcomment.class.php',53],['blogs/inc/sessions/model','_goal.class.php',92]], 967],
'set': ['set', 'Set param value ', [['blogs/inc/users/model','_userfield.class.php',243],['blogs/inc/generic/model','_genericordered.class.php',75],['blogs/inc/users/model','_group.class.php',204],['blogs/inc/items/model','_itemlight.class.php',1258],['blogs/inc/plugins/model','_pluginsettings.class.php',70],['blogs/inc/widgets/model','_widget.class.php',321],['blogs/inc/regional/model','_region.class.php',102],['blogs/inc/regional/model','_city.class.php',110],['blogs/inc/collections/model','_blog.class.php',1102],['blogs/inc/settings/model','_abstractsettings.class.php',446],['blogs/inc/plugins/model','_pluginusersettings.class.php',82],['blogs/inc/users/model','_user.class.php',1861],['blogs/inc/generic/model','_genericcategory.class.php',100],['blogs/inc/tools/model','_emailaddress.class.php',85],['blogs/inc/users/model','_usersettings.class.php',187],['blogs/inc/regional/model','_country.class.php',106],['blogs/inc/comments/model','_comment.class.php',315],['blogs/inc/users/model','_groupsettings.class.php',140],['blogs/inc/cron/model','_cronjob.class.php',79],['blogs/inc/items/model','_item.class.php',4497],['blogs/inc/files/model','_filetype.class.php',149],['blogs/inc/users/model','_userfieldgroup.class.php',92],['blogs/inc/sessions/model','_session.class.php',420],['blogs/plugins','_calendar.plugin.php',530],['blogs/inc/slugs/model','_slug.class.php',80],['blogs/inc/regional/model','_currency.class.php',96],['blogs/inc/messaging/model','_thread.class.php',185],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',614],['blogs/inc/regional/model','_subregion.class.php',119],['blogs/inc/antispam/model','_iprange.class.php',81],['blogs/inc/sessions/model','_goal.class.php',199]], 1121],
'delete': ['delete', 'Delete a hit. ', [['blogs/inc/sessions/model','_hitlist.class.php',47],['blogs/inc/plugins/model','_pluginsettings.class.php',83],['blogs/inc/settings/model','_abstractsettings.class.php',522],['blogs/inc/plugins/model','_pluginusersettings.class.php',107],['blogs/inc/_ext/pclzip','pclzip.lib.php',1007],['blogs/inc/users/model','_usersettings.class.php',212],['blogs/inc/users/model','_groupsettings.class.php',181],['blogs/inc/sessions/model','_session.class.php',452],['blogs/plugins/twitter_plugin/twitteroauth','twitteroauth.php',168]], 90],
'param_check_valid_login': ['param_check_valid_login', 'Check if the value is a valid login (in terms of allowed chars) ', [['blogs/inc/_core','_param.funcs.php',752]], 3],
'logout': ['logout', 'Log the user out ', [['blogs/inc/users/model','_user.funcs.php',43],['blogs/inc/sessions/model','_session.class.php',334],['blogs/inc/plugins','_plugin.class.php',2244]], 6],
't_': ['t_', 'TRANSLATE! ', [['blogs/inc/locales','_locale.funcs.php',48],['blogs/inc/locales','_locale.funcs.php',240],['blogs/inc/skins/model','_skin.class.php',672],['blogs/inc/_core/model','_module.class.php',79],['blogs/rsc/js','blog_widgets.js',422],['blogs/inc/plugins','_plugin.class.php',2617]], 10201],
'locale_activate': ['locale_activate', 'Activate a locale. ', [['blogs/inc/locales','_locale.funcs.php',314]], 17],
'has_user': ['has_user', 'Check if session has a user attached. ', [['blogs/inc/sessions/model','_session.class.php',361]], 4],
'use_in_skin_login': ['use_in_skin_login', 'Use in-skin login ', [['blogs/inc/users/model','_user.funcs.php',356]], 5],
'add': ['add', 'Add object to cache, handling our own indices. ', [['blogs/inc/collections/model','_blogcache.class.php',69],['blogs/inc/users/model','_usercache.class.php',231],['blogs/inc/files/model','_filelist.class.php',392],['blogs/inc/_core/model','_log.class.php',124],['blogs/inc/_core/model','_log.class.php',593],['blogs/inc/files/model','_filetypecache.class.php',57],['blogs/inc/_ext/pclzip','pclzip.lib.php',455],['blogs/inc/_core/model/dataobjects','_dataobjectcache.class.php',356],['blogs/inc/users/model','_groupsettings.class.php',103],['blogs/inc/links/model','_linkcache.class.php',101],['blogs/inc/skins/model','_skincache.class.php',62],['blogs/inc/generic/model','_genericcategorycache.class.php',113],['blogs/inc/_core/model','_messages.class.php',121]], 2022],
'gen_blogurl': ['gen_blogurl', 'Generate blog URL. That is the URL of the main page/home page of the blog. This will nto necessarily be a folder. For example, it can end in index.php?blog=4 ', [['blogs/inc/collections/model','_blog.class.php',1127]], 115],
'trigger_event_first_true': ['trigger_event_first_true', 'Call all plugins for a given event, until the first one returns true. ', [['blogs/inc/plugins/model','_plugins.class.php',862]], 17],
'preg_match': ['preg_match', '', [], 363],
'substr': ['substr', '', [], 657],
'sha1': ['sha1', '', [], 4],
'strip_tags': ['strip_tags', '', [], 61],
'var_export': ['var_export', '', [], 48],
'strpos': ['strpos', '', [], 280],
'count': ['count', '', [], 754],
'is_string': ['is_string', '', [], 58],
'defined': ['defined', '', [], 874]};
CLASS_DATA={
};
CONST_DATA={
'EVO_CONFIG_LOADED': ['EVO_CONFIG_LOADED', '', [['blogs/conf','_config.php',44]], 33]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Sat Jul  5 12:18:44 2014</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>

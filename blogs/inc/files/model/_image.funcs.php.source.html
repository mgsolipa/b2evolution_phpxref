<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /blogs/inc/files/model/_image.funcs.php source</title>
    <link rel="stylesheet" href="../../../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Sat Jul  5 12:18:44 2014 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../../../';
subdir='blogs/inc/files/model';
filename='_image.funcs.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/blogs/inc/files/model/</a> -> <a href="_image.funcs.php.html">_image.funcs.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="_image.funcs.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="_image.funcs.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">/**</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment"> * This file implements various Image File handling functions.</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment"> *</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment"> * This file is part of the evoCore framework - {@link http://evocore.net/}</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment"> * See also {@link http://sourceforge.net/projects/evocms/}.</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment"> *</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment"> * @copyright (c)2003-2014 by Francois Planque - {@link http://fplanque.com/}</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment"> *</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment"> * {@internal License choice</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment"> * - If you have received this file as part of a package, please find the license.txt file in</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment"> *   the same folder or the closest folder above for complete license terms.</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment"> * - If you have received this file individually (e-g: from http://evocms.cvs.sourceforge.net/)</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment"> *   then you must choose one of the following licenses before using the file:</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment"> *   - GNU General Public License 2 (GPL) - http://www.opensource.org/licenses/gpl-license.php</span>
<a name="l16"><span class="linenum">  16</span></a>  <span class="comment"> *   - Mozilla Public License 1.1 (MPL) - http://www.opensource.org/licenses/mozilla1.1.php</span>
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment"> * }}</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> *</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> * {@internal Open Source relicensing agreement:</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * }}</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> *</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * @package evocore</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> *</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> * {@internal Below is a list of authors who have contributed to design/coding of this file: }}</span>
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment"> * @author fplanque: Francois PLANQUE.</span>
<a name="l26"><span class="linenum">  26</span></a>  <span class="comment"> *</span>
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment"> * @version $Id: _image.funcs.php 6444 2014-04-10 13:01:00Z yura $</span>
<a name="l28"><span class="linenum">  28</span></a>  <span class="comment"> */</span>
<a name="l29"><span class="linenum">  29</span></a>  if( !<a class="phpfunction" onClick="logFunction('defined')" href="../../../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('EVO_MAIN_INIT')" href="../../../../_constants/EVO_MAIN_INIT.html" onMouseOver="constPopup(event,'EVO_MAIN_INIT')">EVO_MAIN_INIT</a>') ) die( 'Please, do not access this page directly.' );
<a name="l30"><span class="linenum">  30</span></a>  
<a name="l31"><span class="linenum">  31</span></a>  
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment">/**</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> * Get available thumbnail sizes</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> *</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> * @param string The text that used for the &quot;None&quot; option</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment"> * @return array 'key'=&gt;'name'</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment"> */</span>
<a name="l38"><span class="linenum">  38</span></a>  function <a class="function" onClick="logFunction('get_available_thumb_sizes')" href="../../../../_functions/get_available_thumb_sizes.html" onMouseOver="funcPopup(event,'get_available_thumb_sizes')">get_available_thumb_sizes</a>( <a class="var it1497" onMouseOver="hilite(1497)" onMouseOut="lolite()" onClick="logVariable('allow_none_text')" href="../../../../_variables/allow_none_text.html">$allow_none_text</a> = NULL )
<a name="l39"><span class="linenum">  39</span></a>  {
<a name="l40"><span class="linenum">  40</span></a>      global <a class="var it1498" onMouseOver="hilite(1498)" onMouseOut="lolite()" onClick="logVariable('thumbnail_sizes')" href="../../../../_variables/thumbnail_sizes.html">$thumbnail_sizes</a>;
<a name="l41"><span class="linenum">  41</span></a>  
<a name="l42"><span class="linenum">  42</span></a>      <a class="var it1499" onMouseOver="hilite(1499)" onMouseOut="lolite()" onClick="logVariable('thumb_size_names')" href="../../../../_variables/thumb_size_names.html">$thumb_size_names</a> = array();
<a name="l43"><span class="linenum">  43</span></a>  
<a name="l44"><span class="linenum">  44</span></a>      if( !empty( <a class="var it1497" onMouseOver="hilite(1497)" onMouseOut="lolite()" onClick="logVariable('allow_none_text')" href="../../../../_variables/allow_none_text.html">$allow_none_text</a> ) )
<a name="l45"><span class="linenum">  45</span></a>      {    // 'None' option
<a name="l46"><span class="linenum">  46</span></a>          <a class="var it1499" onMouseOver="hilite(1499)" onMouseOut="lolite()" onClick="logVariable('thumb_size_names')" href="../../../../_variables/thumb_size_names.html">$thumb_size_names</a>[''] = <a class="var it1497" onMouseOver="hilite(1497)" onMouseOut="lolite()" onClick="logVariable('allow_none_text')" href="../../../../_variables/allow_none_text.html">$allow_none_text</a>;
<a name="l47"><span class="linenum">  47</span></a>      }
<a name="l48"><span class="linenum">  48</span></a>  
<a name="l49"><span class="linenum">  49</span></a>      foreach( <a class="var it1498" onMouseOver="hilite(1498)" onMouseOut="lolite()" onClick="logVariable('thumbnail_sizes')" href="../../../../_variables/thumbnail_sizes.html">$thumbnail_sizes</a> as <a class="var it963" onMouseOver="hilite(963)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>=&gt;<a class="var it1500" onMouseOver="hilite(1500)" onMouseOut="lolite()" onClick="logVariable('dummy')" href="../../../../_variables/dummy.html">$dummy</a> )
<a name="l50"><span class="linenum">  50</span></a>      {
<a name="l51"><span class="linenum">  51</span></a>          <a class="var it1499" onMouseOver="hilite(1499)" onMouseOut="lolite()" onClick="logVariable('thumb_size_names')" href="../../../../_variables/thumb_size_names.html">$thumb_size_names</a>[<a class="var it963" onMouseOver="hilite(963)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>] = <a class="var it963" onMouseOver="hilite(963)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>;
<a name="l52"><span class="linenum">  52</span></a>      }
<a name="l53"><span class="linenum">  53</span></a>  
<a name="l54"><span class="linenum">  54</span></a>      return <a class="var it1499" onMouseOver="hilite(1499)" onMouseOut="lolite()" onClick="logVariable('thumb_size_names')" href="../../../../_variables/thumb_size_names.html">$thumb_size_names</a>;
<a name="l55"><span class="linenum">  55</span></a>  }
<a name="l56"><span class="linenum">  56</span></a>  
<a name="l57"><span class="linenum">  57</span></a>  
<a name="l58"><span class="linenum">  58</span></a>  <span class="comment">/**</span>
<a name="l59"><span class="linenum">  59</span></a>  <span class="comment"> * Crop dimensions to fit into a constrained size, while preserving aspect ratio.</span>
<a name="l60"><span class="linenum">  60</span></a>  <span class="comment"> *</span>
<a name="l61"><span class="linenum">  61</span></a>  <span class="comment"> * @param integer source width</span>
<a name="l62"><span class="linenum">  62</span></a>  <span class="comment"> * @param integer source height</span>
<a name="l63"><span class="linenum">  63</span></a>  <span class="comment"> * @param integer constrained width</span>
<a name="l64"><span class="linenum">  64</span></a>  <span class="comment"> * @param integer constrained height</span>
<a name="l65"><span class="linenum">  65</span></a>  <span class="comment"> * @param string align: center, top</span>
<a name="l66"><span class="linenum">  66</span></a>  <span class="comment"> * @return array ( x, y, width, height )</span>
<a name="l67"><span class="linenum">  67</span></a>  <span class="comment"> */</span>
<a name="l68"><span class="linenum">  68</span></a>  function <a class="function" onClick="logFunction('crop_to_constraint')" href="../../../../_functions/crop_to_constraint.html" onMouseOver="funcPopup(event,'crop_to_constraint')">crop_to_constraint</a>( <a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a>, <a class="var it1502" onMouseOver="hilite(1502)" onMouseOut="lolite()" onClick="logVariable('src_height')" href="../../../../_variables/src_height.html">$src_height</a>, <a class="var it1503" onMouseOver="hilite(1503)" onMouseOut="lolite()" onClick="logVariable('max_width')" href="../../../../_variables/max_width.html">$max_width</a>, <a class="var it1504" onMouseOver="hilite(1504)" onMouseOut="lolite()" onClick="logVariable('max_height')" href="../../../../_variables/max_height.html">$max_height</a>, <a class="var it1461" onMouseOver="hilite(1461)" onMouseOut="lolite()" onClick="logVariable('align')" href="../../../../_variables/align.html">$align</a> = 'center' )
<a name="l69"><span class="linenum">  69</span></a>  {
<a name="l70"><span class="linenum">  70</span></a>      <a class="var it1505" onMouseOver="hilite(1505)" onMouseOut="lolite()" onClick="logVariable('src_ratio')" href="../../../../_variables/src_ratio.html">$src_ratio</a> = <a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a> / <a class="var it1502" onMouseOver="hilite(1502)" onMouseOut="lolite()" onClick="logVariable('src_height')" href="../../../../_variables/src_height.html">$src_height</a>;
<a name="l71"><span class="linenum">  71</span></a>      <a class="var it1506" onMouseOver="hilite(1506)" onMouseOut="lolite()" onClick="logVariable('max_ratio')" href="../../../../_variables/max_ratio.html">$max_ratio</a> = <a class="var it1503" onMouseOver="hilite(1503)" onMouseOut="lolite()" onClick="logVariable('max_width')" href="../../../../_variables/max_width.html">$max_width</a> / <a class="var it1504" onMouseOver="hilite(1504)" onMouseOut="lolite()" onClick="logVariable('max_height')" href="../../../../_variables/max_height.html">$max_height</a>;
<a name="l72"><span class="linenum">  72</span></a>      if( <a class="var it1506" onMouseOver="hilite(1506)" onMouseOut="lolite()" onClick="logVariable('max_ratio')" href="../../../../_variables/max_ratio.html">$max_ratio</a> &lt;= <a class="var it1505" onMouseOver="hilite(1505)" onMouseOut="lolite()" onClick="logVariable('src_ratio')" href="../../../../_variables/src_ratio.html">$src_ratio</a> )
<a name="l73"><span class="linenum">  73</span></a>      {
<a name="l74"><span class="linenum">  74</span></a>          <a class="var it1507" onMouseOver="hilite(1507)" onMouseOut="lolite()" onClick="logVariable('y')" href="../../../../_variables/y.html">$y</a> = 0;
<a name="l75"><span class="linenum">  75</span></a>          <a class="var it1508" onMouseOver="hilite(1508)" onMouseOut="lolite()" onClick="logVariable('x')" href="../../../../_variables/x.html">$x</a> = (<a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a> - (<a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a> * (<a class="var it1506" onMouseOver="hilite(1506)" onMouseOut="lolite()" onClick="logVariable('max_ratio')" href="../../../../_variables/max_ratio.html">$max_ratio</a>/<a class="var it1505" onMouseOver="hilite(1505)" onMouseOut="lolite()" onClick="logVariable('src_ratio')" href="../../../../_variables/src_ratio.html">$src_ratio</a>))) / 2;
<a name="l76"><span class="linenum">  76</span></a>          <a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a> = <a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a> * (<a class="var it1506" onMouseOver="hilite(1506)" onMouseOut="lolite()" onClick="logVariable('max_ratio')" href="../../../../_variables/max_ratio.html">$max_ratio</a>/<a class="var it1505" onMouseOver="hilite(1505)" onMouseOut="lolite()" onClick="logVariable('src_ratio')" href="../../../../_variables/src_ratio.html">$src_ratio</a>);
<a name="l77"><span class="linenum">  77</span></a>      }
<a name="l78"><span class="linenum">  78</span></a>      else
<a name="l79"><span class="linenum">  79</span></a>      {
<a name="l80"><span class="linenum">  80</span></a>          <a class="var it1508" onMouseOver="hilite(1508)" onMouseOut="lolite()" onClick="logVariable('x')" href="../../../../_variables/x.html">$x</a> = 0;
<a name="l81"><span class="linenum">  81</span></a>          if( <a class="var it1461" onMouseOver="hilite(1461)" onMouseOut="lolite()" onClick="logVariable('align')" href="../../../../_variables/align.html">$align</a> == 'top' )
<a name="l82"><span class="linenum">  82</span></a>          {    // top - 15%
<a name="l83"><span class="linenum">  83</span></a>              <a class="var it1507" onMouseOver="hilite(1507)" onMouseOut="lolite()" onClick="logVariable('y')" href="../../../../_variables/y.html">$y</a> = ( <a class="var it1502" onMouseOver="hilite(1502)" onMouseOut="lolite()" onClick="logVariable('src_height')" href="../../../../_variables/src_height.html">$src_height</a> - <a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a> ) * 0.15;
<a name="l84"><span class="linenum">  84</span></a>          }
<a name="l85"><span class="linenum">  85</span></a>          else
<a name="l86"><span class="linenum">  86</span></a>          {    // center
<a name="l87"><span class="linenum">  87</span></a>              <a class="var it1507" onMouseOver="hilite(1507)" onMouseOut="lolite()" onClick="logVariable('y')" href="../../../../_variables/y.html">$y</a> = (<a class="var it1502" onMouseOver="hilite(1502)" onMouseOut="lolite()" onClick="logVariable('src_height')" href="../../../../_variables/src_height.html">$src_height</a> - <a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a>/<a class="var it1506" onMouseOver="hilite(1506)" onMouseOut="lolite()" onClick="logVariable('max_ratio')" href="../../../../_variables/max_ratio.html">$max_ratio</a>) / 2;
<a name="l88"><span class="linenum">  88</span></a>          }
<a name="l89"><span class="linenum">  89</span></a>          <a class="var it1502" onMouseOver="hilite(1502)" onMouseOut="lolite()" onClick="logVariable('src_height')" href="../../../../_variables/src_height.html">$src_height</a> = <a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a>/<a class="var it1506" onMouseOver="hilite(1506)" onMouseOut="lolite()" onClick="logVariable('max_ratio')" href="../../../../_variables/max_ratio.html">$max_ratio</a>;
<a name="l90"><span class="linenum">  90</span></a>      }
<a name="l91"><span class="linenum">  91</span></a>  
<a name="l92"><span class="linenum">  92</span></a>      return array( <a class="var it1508" onMouseOver="hilite(1508)" onMouseOut="lolite()" onClick="logVariable('x')" href="../../../../_variables/x.html">$x</a>, <a class="var it1507" onMouseOver="hilite(1507)" onMouseOut="lolite()" onClick="logVariable('y')" href="../../../../_variables/y.html">$y</a>, <a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a>, <a class="var it1502" onMouseOver="hilite(1502)" onMouseOut="lolite()" onClick="logVariable('src_height')" href="../../../../_variables/src_height.html">$src_height</a> );
<a name="l93"><span class="linenum">  93</span></a>  }
<a name="l94"><span class="linenum">  94</span></a>  
<a name="l95"><span class="linenum">  95</span></a>  
<a name="l96"><span class="linenum">  96</span></a>  <span class="comment">/**</span>
<a name="l97"><span class="linenum">  97</span></a>  <span class="comment"> * Scale dimensions to fit into a constrained size, while preserving aspect ratio.</span>
<a name="l98"><span class="linenum">  98</span></a>  <span class="comment"> *</span>
<a name="l99"><span class="linenum">  99</span></a>  <span class="comment"> * @param integer source width</span>
<a name="l100"><span class="linenum"> 100</span></a>  <span class="comment"> * @param integer source height</span>
<a name="l101"><span class="linenum"> 101</span></a>  <span class="comment"> * @param integer constrained width (might be NULL/0 to use source width)</span>
<a name="l102"><span class="linenum"> 102</span></a>  <span class="comment"> * @param integer constrained height (might be NULL/0 to use source height)</span>
<a name="l103"><span class="linenum"> 103</span></a>  <span class="comment"> * @return array (width, height)</span>
<a name="l104"><span class="linenum"> 104</span></a>  <span class="comment"> */</span>
<a name="l105"><span class="linenum"> 105</span></a>  function <a class="function" onClick="logFunction('scale_to_constraint')" href="../../../../_functions/scale_to_constraint.html" onMouseOver="funcPopup(event,'scale_to_constraint')">scale_to_constraint</a>( <a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a>, <a class="var it1502" onMouseOver="hilite(1502)" onMouseOut="lolite()" onClick="logVariable('src_height')" href="../../../../_variables/src_height.html">$src_height</a>, <a class="var it1503" onMouseOver="hilite(1503)" onMouseOut="lolite()" onClick="logVariable('max_width')" href="../../../../_variables/max_width.html">$max_width</a>, <a class="var it1504" onMouseOver="hilite(1504)" onMouseOut="lolite()" onClick="logVariable('max_height')" href="../../../../_variables/max_height.html">$max_height</a> )
<a name="l106"><span class="linenum"> 106</span></a>  {
<a name="l107"><span class="linenum"> 107</span></a>      if( <a class="var it1503" onMouseOver="hilite(1503)" onMouseOut="lolite()" onClick="logVariable('max_width')" href="../../../../_variables/max_width.html">$max_width</a> == 0 )
<a name="l108"><span class="linenum"> 108</span></a>          <a class="var it1503" onMouseOver="hilite(1503)" onMouseOut="lolite()" onClick="logVariable('max_width')" href="../../../../_variables/max_width.html">$max_width</a> = <a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a>;
<a name="l109"><span class="linenum"> 109</span></a>      if( <a class="var it1504" onMouseOver="hilite(1504)" onMouseOut="lolite()" onClick="logVariable('max_height')" href="../../../../_variables/max_height.html">$max_height</a> == 0 )
<a name="l110"><span class="linenum"> 110</span></a>          <a class="var it1504" onMouseOver="hilite(1504)" onMouseOut="lolite()" onClick="logVariable('max_height')" href="../../../../_variables/max_height.html">$max_height</a> = <a class="var it1502" onMouseOver="hilite(1502)" onMouseOut="lolite()" onClick="logVariable('src_height')" href="../../../../_variables/src_height.html">$src_height</a>;
<a name="l111"><span class="linenum"> 111</span></a>  
<a name="l112"><span class="linenum"> 112</span></a>      <a class="var it1505" onMouseOver="hilite(1505)" onMouseOut="lolite()" onClick="logVariable('src_ratio')" href="../../../../_variables/src_ratio.html">$src_ratio</a> = <a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a> / <a class="var it1502" onMouseOver="hilite(1502)" onMouseOut="lolite()" onClick="logVariable('src_height')" href="../../../../_variables/src_height.html">$src_height</a>;
<a name="l113"><span class="linenum"> 113</span></a>      if( <a class="var it1503" onMouseOver="hilite(1503)" onMouseOut="lolite()" onClick="logVariable('max_width')" href="../../../../_variables/max_width.html">$max_width</a> / <a class="var it1504" onMouseOver="hilite(1504)" onMouseOut="lolite()" onClick="logVariable('max_height')" href="../../../../_variables/max_height.html">$max_height</a> &lt;= <a class="var it1505" onMouseOver="hilite(1505)" onMouseOut="lolite()" onClick="logVariable('src_ratio')" href="../../../../_variables/src_ratio.html">$src_ratio</a> )
<a name="l114"><span class="linenum"> 114</span></a>      {
<a name="l115"><span class="linenum"> 115</span></a>          <a class="var it731" onMouseOver="hilite(731)" onMouseOut="lolite()" onClick="logVariable('width')" href="../../../../_variables/width.html">$width</a> = <a class="var it1503" onMouseOver="hilite(1503)" onMouseOut="lolite()" onClick="logVariable('max_width')" href="../../../../_variables/max_width.html">$max_width</a>;
<a name="l116"><span class="linenum"> 116</span></a>          <a class="var it732" onMouseOver="hilite(732)" onMouseOut="lolite()" onClick="logVariable('height')" href="../../../../_variables/height.html">$height</a> = (int)<a class="phpfunction" onClick="logFunction('round')" href="../../../../_functions/round.html" onMouseOver="phpfuncPopup(event,'round')">round</a>( <a class="var it1503" onMouseOver="hilite(1503)" onMouseOut="lolite()" onClick="logVariable('max_width')" href="../../../../_variables/max_width.html">$max_width</a> / <a class="var it1505" onMouseOver="hilite(1505)" onMouseOut="lolite()" onClick="logVariable('src_ratio')" href="../../../../_variables/src_ratio.html">$src_ratio</a> );
<a name="l117"><span class="linenum"> 117</span></a>      }
<a name="l118"><span class="linenum"> 118</span></a>      else
<a name="l119"><span class="linenum"> 119</span></a>      {
<a name="l120"><span class="linenum"> 120</span></a>          <a class="var it731" onMouseOver="hilite(731)" onMouseOut="lolite()" onClick="logVariable('width')" href="../../../../_variables/width.html">$width</a> = (int)<a class="phpfunction" onClick="logFunction('round')" href="../../../../_functions/round.html" onMouseOver="phpfuncPopup(event,'round')">round</a>( <a class="var it1504" onMouseOver="hilite(1504)" onMouseOut="lolite()" onClick="logVariable('max_height')" href="../../../../_variables/max_height.html">$max_height</a> * <a class="var it1505" onMouseOver="hilite(1505)" onMouseOut="lolite()" onClick="logVariable('src_ratio')" href="../../../../_variables/src_ratio.html">$src_ratio</a> );
<a name="l121"><span class="linenum"> 121</span></a>          <a class="var it732" onMouseOver="hilite(732)" onMouseOut="lolite()" onClick="logVariable('height')" href="../../../../_variables/height.html">$height</a> = <a class="var it1504" onMouseOver="hilite(1504)" onMouseOut="lolite()" onClick="logVariable('max_height')" href="../../../../_variables/max_height.html">$max_height</a>;
<a name="l122"><span class="linenum"> 122</span></a>      }
<a name="l123"><span class="linenum"> 123</span></a>  
<a name="l124"><span class="linenum"> 124</span></a>      return array( <a class="var it731" onMouseOver="hilite(731)" onMouseOut="lolite()" onClick="logVariable('width')" href="../../../../_variables/width.html">$width</a>, <a class="var it732" onMouseOver="hilite(732)" onMouseOut="lolite()" onClick="logVariable('height')" href="../../../../_variables/height.html">$height</a> );
<a name="l125"><span class="linenum"> 125</span></a>  }
<a name="l126"><span class="linenum"> 126</span></a>  
<a name="l127"><span class="linenum"> 127</span></a>  
<a name="l128"><span class="linenum"> 128</span></a>  <span class="comment">/**</span>
<a name="l129"><span class="linenum"> 129</span></a>  <span class="comment"> * Scale dimensions to fit into a constrained size, while preserving aspect ratio.</span>
<a name="l130"><span class="linenum"> 130</span></a>  <span class="comment"> * The scaling only happens if the source is larger than the constraint.</span>
<a name="l131"><span class="linenum"> 131</span></a>  <span class="comment"> *</span>
<a name="l132"><span class="linenum"> 132</span></a>  <span class="comment"> * @param integer source width</span>
<a name="l133"><span class="linenum"> 133</span></a>  <span class="comment"> * @param integer source height</span>
<a name="l134"><span class="linenum"> 134</span></a>  <span class="comment"> * @param integer constrained width</span>
<a name="l135"><span class="linenum"> 135</span></a>  <span class="comment"> * @param integer constrained height</span>
<a name="l136"><span class="linenum"> 136</span></a>  <span class="comment"> */</span>
<a name="l137"><span class="linenum"> 137</span></a>  function <a class="function" onClick="logFunction('fit_into_constraint')" href="../../../../_functions/fit_into_constraint.html" onMouseOver="funcPopup(event,'fit_into_constraint')">fit_into_constraint</a>( <a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a>, <a class="var it1502" onMouseOver="hilite(1502)" onMouseOut="lolite()" onClick="logVariable('src_height')" href="../../../../_variables/src_height.html">$src_height</a>, <a class="var it1503" onMouseOver="hilite(1503)" onMouseOut="lolite()" onClick="logVariable('max_width')" href="../../../../_variables/max_width.html">$max_width</a>, <a class="var it1504" onMouseOver="hilite(1504)" onMouseOut="lolite()" onClick="logVariable('max_height')" href="../../../../_variables/max_height.html">$max_height</a> )
<a name="l138"><span class="linenum"> 138</span></a>  {
<a name="l139"><span class="linenum"> 139</span></a>      if( <a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a> &gt; <a class="var it1503" onMouseOver="hilite(1503)" onMouseOut="lolite()" onClick="logVariable('max_width')" href="../../../../_variables/max_width.html">$max_width</a> || <a class="var it1502" onMouseOver="hilite(1502)" onMouseOut="lolite()" onClick="logVariable('src_height')" href="../../../../_variables/src_height.html">$src_height</a> &gt; <a class="var it1504" onMouseOver="hilite(1504)" onMouseOut="lolite()" onClick="logVariable('max_height')" href="../../../../_variables/max_height.html">$max_height</a> )
<a name="l140"><span class="linenum"> 140</span></a>      {
<a name="l141"><span class="linenum"> 141</span></a>          return <a class="function" onClick="logFunction('scale_to_constraint')" href="../../../../_functions/scale_to_constraint.html" onMouseOver="funcPopup(event,'scale_to_constraint')">scale_to_constraint</a>( <a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a>, <a class="var it1502" onMouseOver="hilite(1502)" onMouseOut="lolite()" onClick="logVariable('src_height')" href="../../../../_variables/src_height.html">$src_height</a>, <a class="var it1503" onMouseOver="hilite(1503)" onMouseOut="lolite()" onClick="logVariable('max_width')" href="../../../../_variables/max_width.html">$max_width</a>, <a class="var it1504" onMouseOver="hilite(1504)" onMouseOut="lolite()" onClick="logVariable('max_height')" href="../../../../_variables/max_height.html">$max_height</a> );
<a name="l142"><span class="linenum"> 142</span></a>      }
<a name="l143"><span class="linenum"> 143</span></a>  
<a name="l144"><span class="linenum"> 144</span></a>      return array( <a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a>, <a class="var it1502" onMouseOver="hilite(1502)" onMouseOut="lolite()" onClick="logVariable('src_height')" href="../../../../_variables/src_height.html">$src_height</a> );
<a name="l145"><span class="linenum"> 145</span></a>  }
<a name="l146"><span class="linenum"> 146</span></a>  
<a name="l147"><span class="linenum"> 147</span></a>  
<a name="l148"><span class="linenum"> 148</span></a>  <span class="comment">/**</span>
<a name="l149"><span class="linenum"> 149</span></a>  <span class="comment"> * Load an image from a file into memory</span>
<a name="l150"><span class="linenum"> 150</span></a>  <span class="comment"> *</span>
<a name="l151"><span class="linenum"> 151</span></a>  <span class="comment"> * @param string pathname of image file</span>
<a name="l152"><span class="linenum"> 152</span></a>  <span class="comment"> * @param string</span>
<a name="l153"><span class="linenum"> 153</span></a>  <span class="comment"> * @return array resource image handle or NULL</span>
<a name="l154"><span class="linenum"> 154</span></a>  <span class="comment"> */</span>
<a name="l155"><span class="linenum"> 155</span></a>  function <a class="function" onClick="logFunction('load_image')" href="../../../../_functions/load_image.html" onMouseOver="funcPopup(event,'load_image')">load_image</a>( <a class="var it1083" onMouseOver="hilite(1083)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../../_variables/path.html">$path</a>, <a class="var it739" onMouseOver="hilite(739)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../../../../_variables/mimetype.html">$mimetype</a> )
<a name="l156"><span class="linenum"> 156</span></a>  {
<a name="l157"><span class="linenum"> 157</span></a>  <span class="comment">    // yabs&gt; GD library uses shedloads of memory</span>
<a name="l158"><span class="linenum"> 158</span></a>  <span class="comment">    // fp&gt; 256M is way too high to sneak this in here. There should be some checks in the systems page to warn against low memory conditions. Also i'm not sure it makes sense to bump memory just for images. If you allow memory you might as well allow it for anything. Anyways, this is too much to be snuk in.</span>
<a name="l159"><span class="linenum"> 159</span></a>  <span class="comment">    // @ini_set('memory_limit', '256M'); // artificially inflate memory if we can</span>
<a name="l160"><span class="linenum"> 160</span></a>      <a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a> = NULL;
<a name="l161"><span class="linenum"> 161</span></a>      <a class="var it1510" onMouseOver="hilite(1510)" onMouseOut="lolite()" onClick="logVariable('imh')" href="../../../../_variables/imh.html">$imh</a> = NULL;
<a name="l162"><span class="linenum"> 162</span></a>      <a class="var it1511" onMouseOver="hilite(1511)" onMouseOut="lolite()" onClick="logVariable('function')" href="../../../../_variables/function.html">$function</a> = NULL;
<a name="l163"><span class="linenum"> 163</span></a>  
<a name="l164"><span class="linenum"> 164</span></a>      <a class="var it1512" onMouseOver="hilite(1512)" onMouseOut="lolite()" onClick="logVariable('image_info')" href="../../../../_variables/image_info.html">$image_info</a> = <a class="phpfunction" onClick="logFunction('getimagesize')" href="../../../../_functions/getimagesize.html" onMouseOver="phpfuncPopup(event,'getimagesize')">getimagesize</a>(<a class="var it1083" onMouseOver="hilite(1083)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../../_variables/path.html">$path</a>);
<a name="l165"><span class="linenum"> 165</span></a>  
<a name="l166"><span class="linenum"> 166</span></a>      if( ! <a class="var it1512" onMouseOver="hilite(1512)" onMouseOut="lolite()" onClick="logVariable('image_info')" href="../../../../_variables/image_info.html">$image_info</a> || <a class="var it1512" onMouseOver="hilite(1512)" onMouseOut="lolite()" onClick="logVariable('image_info')" href="../../../../_variables/image_info.html">$image_info</a>['mime'] != <a class="var it739" onMouseOver="hilite(739)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../../../../_variables/mimetype.html">$mimetype</a> )
<a name="l167"><span class="linenum"> 167</span></a>      {
<a name="l168"><span class="linenum"> 168</span></a>          <a class="var it1513" onMouseOver="hilite(1513)" onMouseOut="lolite()" onClick="logVariable('FiletypeCache')" href="../../../../_variables/FiletypeCache.html">$FiletypeCache</a> = get_Cache('FiletypeCache');
<a name="l169"><span class="linenum"> 169</span></a>          <a class="var it1514" onMouseOver="hilite(1514)" onMouseOut="lolite()" onClick="logVariable('correct_Filetype')" href="../../../../_variables/correct_Filetype.html">$correct_Filetype</a> = <a class="var it1513" onMouseOver="hilite(1513)" onMouseOut="lolite()" onClick="logVariable('FiletypeCache')" href="../../../../_variables/FiletypeCache.html">$FiletypeCache</a>-&gt;get_by_mimetype(<a class="var it1512" onMouseOver="hilite(1512)" onMouseOut="lolite()" onClick="logVariable('image_info')" href="../../../../_variables/image_info.html">$image_info</a>['mime']);
<a name="l170"><span class="linenum"> 170</span></a>          <a class="var it1515" onMouseOver="hilite(1515)" onMouseOut="lolite()" onClick="logVariable('correct_extension')" href="../../../../_variables/correct_extension.html">$correct_extension</a> = <a class="phpfunction" onClick="logFunction('array_shift')" href="../../../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>(<a class="var it1514" onMouseOver="hilite(1514)" onMouseOut="lolite()" onClick="logVariable('correct_Filetype')" href="../../../../_variables/correct_Filetype.html">$correct_Filetype</a>-&gt;<a class="function" onClick="logFunction('get_extensions')" href="../../../../_functions/get_extensions.html" onMouseOver="funcPopup(event,'get_extensions')">get_extensions</a>());
<a name="l171"><span class="linenum"> 171</span></a>  
<a name="l172"><span class="linenum"> 172</span></a>          <a class="var it1516" onMouseOver="hilite(1516)" onMouseOut="lolite()" onClick="logVariable('path_info')" href="../../../../_variables/path_info.html">$path_info</a> = <a class="phpfunction" onClick="logFunction('pathinfo')" href="../../../../_functions/pathinfo.html" onMouseOver="phpfuncPopup(event,'pathinfo')">pathinfo</a>(<a class="var it1083" onMouseOver="hilite(1083)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../../_variables/path.html">$path</a>);
<a name="l173"><span class="linenum"> 173</span></a>          <a class="var it1517" onMouseOver="hilite(1517)" onMouseOut="lolite()" onClick="logVariable('wrong_extension')" href="../../../../_variables/wrong_extension.html">$wrong_extension</a> = <a class="var it1516" onMouseOver="hilite(1516)" onMouseOut="lolite()" onClick="logVariable('path_info')" href="../../../../_variables/path_info.html">$path_info</a>['extension'];
<a name="l174"><span class="linenum"> 174</span></a>  
<a name="l175"><span class="linenum"> 175</span></a>          <a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a> = '!'.<a class="var it1515" onMouseOver="hilite(1515)" onMouseOut="lolite()" onClick="logVariable('correct_extension')" href="../../../../_variables/correct_extension.html">$correct_extension</a>.' extension mismatch: use .'.<a class="var it1515" onMouseOver="hilite(1515)" onMouseOut="lolite()" onClick="logVariable('correct_extension')" href="../../../../_variables/correct_extension.html">$correct_extension</a>.' instead of .'.<a class="var it1517" onMouseOver="hilite(1517)" onMouseOut="lolite()" onClick="logVariable('wrong_extension')" href="../../../../_variables/wrong_extension.html">$wrong_extension</a>;
<a name="l176"><span class="linenum"> 176</span></a>      }
<a name="l177"><span class="linenum"> 177</span></a>      else
<a name="l178"><span class="linenum"> 178</span></a>      {
<a name="l179"><span class="linenum"> 179</span></a>          <a class="var it1518" onMouseOver="hilite(1518)" onMouseOut="lolite()" onClick="logVariable('mime_function')" href="../../../../_variables/mime_function.html">$mime_function</a> = array(
<a name="l180"><span class="linenum"> 180</span></a>                  'image/jpeg' =&gt; 'imagecreatefromjpeg',
<a name="l181"><span class="linenum"> 181</span></a>                  'image/gif'  =&gt; 'imagecreatefromgif',
<a name="l182"><span class="linenum"> 182</span></a>                  'image/png'  =&gt; 'imagecreatefrompng',
<a name="l183"><span class="linenum"> 183</span></a>              );
<a name="l184"><span class="linenum"> 184</span></a>  
<a name="l185"><span class="linenum"> 185</span></a>          if( isset(<a class="var it1518" onMouseOver="hilite(1518)" onMouseOut="lolite()" onClick="logVariable('mime_function')" href="../../../../_variables/mime_function.html">$mime_function</a>[<a class="var it739" onMouseOver="hilite(739)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../../../../_variables/mimetype.html">$mimetype</a>]) )
<a name="l186"><span class="linenum"> 186</span></a>          {
<a name="l187"><span class="linenum"> 187</span></a>              <a class="var it1511" onMouseOver="hilite(1511)" onMouseOut="lolite()" onClick="logVariable('function')" href="../../../../_variables/function.html">$function</a> = <a class="var it1518" onMouseOver="hilite(1518)" onMouseOut="lolite()" onClick="logVariable('mime_function')" href="../../../../_variables/mime_function.html">$mime_function</a>[<a class="var it739" onMouseOver="hilite(739)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../../../../_variables/mimetype.html">$mimetype</a>];
<a name="l188"><span class="linenum"> 188</span></a>          }
<a name="l189"><span class="linenum"> 189</span></a>          else
<a name="l190"><span class="linenum"> 190</span></a>          { // Unrecognized mime type
<a name="l191"><span class="linenum"> 191</span></a>              <a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a> = '!Unsupported format '.<a class="var it739" onMouseOver="hilite(739)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../../../../_variables/mimetype.html">$mimetype</a>.' (load_image)';
<a name="l192"><span class="linenum"> 192</span></a>          }
<a name="l193"><span class="linenum"> 193</span></a>      }
<a name="l194"><span class="linenum"> 194</span></a>  <span class="comment">    //pre_dump( $function );</span>
<a name="l195"><span class="linenum"> 195</span></a>      if( <a class="var it1511" onMouseOver="hilite(1511)" onMouseOut="lolite()" onClick="logVariable('function')" href="../../../../_variables/function.html">$function</a> )
<a name="l196"><span class="linenum"> 196</span></a>      {    // Call GD built-in function to load image
<a name="l197"><span class="linenum"> 197</span></a>  <span class="comment">        // fp&gt; Note: sometimes this GD call will die and there is no real way to recover :/</span>
<a name="l198"><span class="linenum"> 198</span></a>          <a class="function" onClick="logFunction('load_funcs')" href="../../../../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>( 'tools/model/_system.funcs.php' );
<a name="l199"><span class="linenum"> 199</span></a>          <a class="var it1519" onMouseOver="hilite(1519)" onMouseOut="lolite()" onClick="logVariable('memory_limit')" href="../../../../_variables/memory_limit.html">$memory_limit</a> = <a class="function" onClick="logFunction('system_check_memory_limit')" href="../../../../_functions/system_check_memory_limit.html" onMouseOver="funcPopup(event,'system_check_memory_limit')">system_check_memory_limit</a>();
<a name="l200"><span class="linenum"> 200</span></a>          <a class="var it1520" onMouseOver="hilite(1520)" onMouseOut="lolite()" onClick="logVariable('curr_mem_usage')" href="../../../../_variables/curr_mem_usage.html">$curr_mem_usage</a> = <a class="phpfunction" onClick="logFunction('memory_get_usage')" href="../../../../_functions/memory_get_usage.html" onMouseOver="phpfuncPopup(event,'memory_get_usage')">memory_get_usage</a>( true );
<a name="l201"><span class="linenum"> 201</span></a>  <span class="comment">        // Calculate the aproximative memory size which would be required to create the image resource</span>
<a name="l202"><span class="linenum"> 202</span></a>          <a class="var it1521" onMouseOver="hilite(1521)" onMouseOut="lolite()" onClick="logVariable('tweakfactor')" href="../../../../_variables/tweakfactor.html">$tweakfactor</a> = 1.8; <span class="comment">// Or whatever works for you</span>
<a name="l203"><span class="linenum"> 203</span></a>          <a class="var it1522" onMouseOver="hilite(1522)" onMouseOut="lolite()" onClick="logVariable('memory_needed')" href="../../../../_variables/memory_needed.html">$memory_needed</a> = <a class="phpfunction" onClick="logFunction('round')" href="../../../../_functions/round.html" onMouseOver="phpfuncPopup(event,'round')">round</a>( ( <a class="var it1512" onMouseOver="hilite(1512)" onMouseOut="lolite()" onClick="logVariable('image_info')" href="../../../../_variables/image_info.html">$image_info</a>[0] * <a class="var it1512" onMouseOver="hilite(1512)" onMouseOut="lolite()" onClick="logVariable('image_info')" href="../../../../_variables/image_info.html">$image_info</a>[1]
<a name="l204"><span class="linenum"> 204</span></a>                  * ( isset( <a class="var it1512" onMouseOver="hilite(1512)" onMouseOut="lolite()" onClick="logVariable('image_info')" href="../../../../_variables/image_info.html">$image_info</a>['bits'] ) ? <a class="var it1512" onMouseOver="hilite(1512)" onMouseOut="lolite()" onClick="logVariable('image_info')" href="../../../../_variables/image_info.html">$image_info</a>['bits'] : 4 )
<a name="l205"><span class="linenum"> 205</span></a>                  * ( isset( <a class="var it1512" onMouseOver="hilite(1512)" onMouseOut="lolite()" onClick="logVariable('image_info')" href="../../../../_variables/image_info.html">$image_info</a>['channels'] ) ? <a class="var it1512" onMouseOver="hilite(1512)" onMouseOut="lolite()" onClick="logVariable('image_info')" href="../../../../_variables/image_info.html">$image_info</a>['channels'] / 8 : 1 )
<a name="l206"><span class="linenum"> 206</span></a>                  + <a class="phpfunction" onClick="logFunction('Pow')" href="../../../../_functions/pow.html" onMouseOver="phpfuncPopup(event,'pow')">Pow</a>( 2, 16 ) // number of bytes in 64K
<a name="l207"><span class="linenum"> 207</span></a>              ) * <a class="var it1521" onMouseOver="hilite(1521)" onMouseOut="lolite()" onClick="logVariable('tweakfactor')" href="../../../../_variables/tweakfactor.html">$tweakfactor</a> );
<a name="l208"><span class="linenum"> 208</span></a>          if( ( <a class="var it1519" onMouseOver="hilite(1519)" onMouseOut="lolite()" onClick="logVariable('memory_limit')" href="../../../../_variables/memory_limit.html">$memory_limit</a> - <a class="var it1520" onMouseOver="hilite(1520)" onMouseOut="lolite()" onClick="logVariable('curr_mem_usage')" href="../../../../_variables/curr_mem_usage.html">$curr_mem_usage</a> ) &lt; <a class="var it1522" onMouseOver="hilite(1522)" onMouseOut="lolite()" onClick="logVariable('memory_needed')" href="../../../../_variables/memory_needed.html">$memory_needed</a> )// ( 4 * <a class="var it1512" onMouseOver="hilite(1512)" onMouseOut="lolite()" onClick="logVariable('image_info')" href="../../../../_variables/image_info.html">$image_info</a>[0] * <a class="var it1512" onMouseOver="hilite(1512)" onMouseOut="lolite()" onClick="logVariable('image_info')" href="../../../../_variables/image_info.html">$image_info</a>[1] ) )
<a name="l209"><span class="linenum"> 209</span></a>          { // Don't try to load the image into the memory because it would cause 'Allowed memory size exhausted' error
<a name="l210"><span class="linenum"> 210</span></a>              return array( &quot;!Cannot resize too large image&quot;, false );
<a name="l211"><span class="linenum"> 211</span></a>          }
<a name="l212"><span class="linenum"> 212</span></a>          <a class="var it1510" onMouseOver="hilite(1510)" onMouseOut="lolite()" onClick="logVariable('imh')" href="../../../../_variables/imh.html">$imh</a> = <a class="var it1511" onMouseOver="hilite(1511)" onMouseOut="lolite()" onClick="logVariable('function')" href="../../../../_variables/function.html">$function</a>( <a class="var it1083" onMouseOver="hilite(1083)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../../_variables/path.html">$path</a> );
<a name="l213"><span class="linenum"> 213</span></a>      }
<a name="l214"><span class="linenum"> 214</span></a>  
<a name="l215"><span class="linenum"> 215</span></a>      if( <a class="var it1510" onMouseOver="hilite(1510)" onMouseOut="lolite()" onClick="logVariable('imh')" href="../../../../_variables/imh.html">$imh</a> === false )
<a name="l216"><span class="linenum"> 216</span></a>      {
<a name="l217"><span class="linenum"> 217</span></a>          <a class="phpfunction" onClick="logFunction('trigger_error')" href="../../../../_functions/trigger_error.html" onMouseOver="phpfuncPopup(event,'trigger_error')">trigger_error</a>( 'load_image failed: '.<a class="var it1083" onMouseOver="hilite(1083)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../../_variables/path.html">$path</a>.' / '.<a class="var it739" onMouseOver="hilite(739)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../../../../_variables/mimetype.html">$mimetype</a> ); <span class="comment">// DEBUG</span>
<a name="l218"><span class="linenum"> 218</span></a>  <span class="comment">        // e.g. &quot;imagecreatefromjpeg(): $FILE is not a valid JPEG file&quot;</span>
<a name="l219"><span class="linenum"> 219</span></a>          <a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a> = '!load_image failed (no valid image?)';
<a name="l220"><span class="linenum"> 220</span></a>      }
<a name="l221"><span class="linenum"> 221</span></a>      if( <a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a> )
<a name="l222"><span class="linenum"> 222</span></a>      {
<a name="l223"><span class="linenum"> 223</span></a>          <a class="phpfunction" onClick="logFunction('error_log')" href="../../../../_functions/error_log.html" onMouseOver="phpfuncPopup(event,'error_log')">error_log</a>( 'load_image failed: '.<a class="phpfunction" onClick="logFunction('substr')" href="../../../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a>, 1).' ('.<a class="var it1083" onMouseOver="hilite(1083)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../../_variables/path.html">$path</a>.' / '.<a class="var it739" onMouseOver="hilite(739)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../../../../_variables/mimetype.html">$mimetype</a>.')' );
<a name="l224"><span class="linenum"> 224</span></a>      }
<a name="l225"><span class="linenum"> 225</span></a>  
<a name="l226"><span class="linenum"> 226</span></a>      return array( <a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a>, <a class="var it1510" onMouseOver="hilite(1510)" onMouseOut="lolite()" onClick="logVariable('imh')" href="../../../../_variables/imh.html">$imh</a> );
<a name="l227"><span class="linenum"> 227</span></a>  }
<a name="l228"><span class="linenum"> 228</span></a>  
<a name="l229"><span class="linenum"> 229</span></a>  
<a name="l230"><span class="linenum"> 230</span></a>  <span class="comment">/**</span>
<a name="l231"><span class="linenum"> 231</span></a>  <span class="comment"> * Output an image from memory to web client</span>
<a name="l232"><span class="linenum"> 232</span></a>  <span class="comment"> *</span>
<a name="l233"><span class="linenum"> 233</span></a>  <span class="comment"> * @param resource image handle</span>
<a name="l234"><span class="linenum"> 234</span></a>  <span class="comment"> * @param string pathname of image file</span>
<a name="l235"><span class="linenum"> 235</span></a>  <span class="comment"> * @param string</span>
<a name="l236"><span class="linenum"> 236</span></a>  <span class="comment"> * @param integer</span>
<a name="l237"><span class="linenum"> 237</span></a>  <span class="comment"> * @param string permissions</span>
<a name="l238"><span class="linenum"> 238</span></a>  <span class="comment"> * @return string</span>
<a name="l239"><span class="linenum"> 239</span></a>  <span class="comment"> */</span>
<a name="l240"><span class="linenum"> 240</span></a>  function <a class="function" onClick="logFunction('save_image')" href="../../../../_functions/save_image.html" onMouseOver="funcPopup(event,'save_image')">save_image</a>( <a class="var it1510" onMouseOver="hilite(1510)" onMouseOut="lolite()" onClick="logVariable('imh')" href="../../../../_variables/imh.html">$imh</a>, <a class="var it1083" onMouseOver="hilite(1083)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../../_variables/path.html">$path</a>, <a class="var it739" onMouseOver="hilite(739)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../../../../_variables/mimetype.html">$mimetype</a>, <a class="var it1523" onMouseOver="hilite(1523)" onMouseOut="lolite()" onClick="logVariable('quality')" href="../../../../_variables/quality.html">$quality</a> = 90, <a class="var it1524" onMouseOver="hilite(1524)" onMouseOut="lolite()" onClick="logVariable('chmod')" href="../../../../_variables/chmod.html">$chmod</a> = NULL )
<a name="l241"><span class="linenum"> 241</span></a>  {
<a name="l242"><span class="linenum"> 242</span></a>      <a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a> = NULL;
<a name="l243"><span class="linenum"> 243</span></a>  
<a name="l244"><span class="linenum"> 244</span></a>      switch( <a class="var it739" onMouseOver="hilite(739)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../../../../_variables/mimetype.html">$mimetype</a> )
<a name="l245"><span class="linenum"> 245</span></a>      {
<a name="l246"><span class="linenum"> 246</span></a>          case 'image/jpeg':
<a name="l247"><span class="linenum"> 247</span></a>              if( <a class="phpfunction" onClick="logFunction('imagesx')" href="../../../../_functions/imagesx.html" onMouseOver="phpfuncPopup(event,'imagesx')">imagesx</a>( <a class="var it1510" onMouseOver="hilite(1510)" onMouseOut="lolite()" onClick="logVariable('imh')" href="../../../../_variables/imh.html">$imh</a> ) &gt; 32 || <a class="phpfunction" onClick="logFunction('imagesy')" href="../../../../_functions/imagesy.html" onMouseOver="phpfuncPopup(event,'imagesy')">imagesy</a>( <a class="var it1510" onMouseOver="hilite(1510)" onMouseOut="lolite()" onClick="logVariable('imh')" href="../../../../_variables/imh.html">$imh</a> ) &gt; 32 )
<a name="l248"><span class="linenum"> 248</span></a>              { // Enable interlacing
<a name="l249"><span class="linenum"> 249</span></a>                  <a class="phpfunction" onClick="logFunction('imageinterlace')" href="../../../../_functions/imageinterlace.html" onMouseOver="phpfuncPopup(event,'imageinterlace')">imageinterlace</a>( <a class="var it1510" onMouseOver="hilite(1510)" onMouseOut="lolite()" onClick="logVariable('imh')" href="../../../../_variables/imh.html">$imh</a>, 1 );
<a name="l250"><span class="linenum"> 250</span></a>              }
<a name="l251"><span class="linenum"> 251</span></a>              <a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../../../_variables/r.html">$r</a> = @<a class="phpfunction" onClick="logFunction('imagejpeg')" href="../../../../_functions/imagejpeg.html" onMouseOver="phpfuncPopup(event,'imagejpeg')">imagejpeg</a>( <a class="var it1510" onMouseOver="hilite(1510)" onMouseOut="lolite()" onClick="logVariable('imh')" href="../../../../_variables/imh.html">$imh</a>, <a class="var it1083" onMouseOver="hilite(1083)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../../_variables/path.html">$path</a>, <a class="var it1523" onMouseOver="hilite(1523)" onMouseOut="lolite()" onClick="logVariable('quality')" href="../../../../_variables/quality.html">$quality</a> );
<a name="l252"><span class="linenum"> 252</span></a>              break;
<a name="l253"><span class="linenum"> 253</span></a>  
<a name="l254"><span class="linenum"> 254</span></a>          case 'image/gif':
<a name="l255"><span class="linenum"> 255</span></a>              <a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../../../_variables/r.html">$r</a> = @<a class="phpfunction" onClick="logFunction('imagegif')" href="../../../../_functions/imagegif.html" onMouseOver="phpfuncPopup(event,'imagegif')">imagegif</a>( <a class="var it1510" onMouseOver="hilite(1510)" onMouseOut="lolite()" onClick="logVariable('imh')" href="../../../../_variables/imh.html">$imh</a>, <a class="var it1083" onMouseOver="hilite(1083)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../../_variables/path.html">$path</a> );
<a name="l256"><span class="linenum"> 256</span></a>              break;
<a name="l257"><span class="linenum"> 257</span></a>  
<a name="l258"><span class="linenum"> 258</span></a>          case 'image/png':
<a name="l259"><span class="linenum"> 259</span></a>              <a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../../../_variables/r.html">$r</a> = @<a class="phpfunction" onClick="logFunction('imagepng')" href="../../../../_functions/imagepng.html" onMouseOver="phpfuncPopup(event,'imagepng')">imagepng</a>( <a class="var it1510" onMouseOver="hilite(1510)" onMouseOut="lolite()" onClick="logVariable('imh')" href="../../../../_variables/imh.html">$imh</a>, <a class="var it1083" onMouseOver="hilite(1083)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../../_variables/path.html">$path</a> );
<a name="l260"><span class="linenum"> 260</span></a>              break;
<a name="l261"><span class="linenum"> 261</span></a>  
<a name="l262"><span class="linenum"> 262</span></a>          default:
<a name="l263"><span class="linenum"> 263</span></a>  <span class="comment">            // Unrecognized mime type</span>
<a name="l264"><span class="linenum"> 264</span></a>              <a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a> = '!Unsupported format '.<a class="var it739" onMouseOver="hilite(739)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../../../../_variables/mimetype.html">$mimetype</a>.' (save_image)';
<a name="l265"><span class="linenum"> 265</span></a>              break;
<a name="l266"><span class="linenum"> 266</span></a>      }
<a name="l267"><span class="linenum"> 267</span></a>  
<a name="l268"><span class="linenum"> 268</span></a>  <span class="comment">    // Catch any errors by image* functions:</span>
<a name="l269"><span class="linenum"> 269</span></a>      if( ! <a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../../../_variables/r.html">$r</a> )
<a name="l270"><span class="linenum"> 270</span></a>      {
<a name="l271"><span class="linenum"> 271</span></a>  <span class="comment">        // TODO: dh&gt; This might become a generic function, since it's useful. Something similar is used in DB, too.</span>
<a name="l272"><span class="linenum"> 272</span></a>          if( isset(<a class="var it1078" onMouseOver="hilite(1078)" onMouseOut="lolite()" onClick="logVariable('php_errormsg')" href="../../../../_variables/php_errormsg.html">$php_errormsg</a>) )
<a name="l273"><span class="linenum"> 273</span></a>              <a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a> = '!'.<a class="var it1078" onMouseOver="hilite(1078)" onMouseOut="lolite()" onClick="logVariable('php_errormsg')" href="../../../../_variables/php_errormsg.html">$php_errormsg</a>;
<a name="l274"><span class="linenum"> 274</span></a>          elseif( <a class="phpfunction" onClick="logFunction('function_exists')" href="../../../../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>('error_get_last') ) // PHP 5.2
<a name="l275"><span class="linenum"> 275</span></a>          {
<a name="l276"><span class="linenum"> 276</span></a>              <a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a> = error_get_last();
<a name="l277"><span class="linenum"> 277</span></a>              <a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a> = '!'.<a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a>['message'];
<a name="l278"><span class="linenum"> 278</span></a>          }
<a name="l279"><span class="linenum"> 279</span></a>  
<a name="l280"><span class="linenum"> 280</span></a>          if( ! isset(<a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a>) )
<a name="l281"><span class="linenum"> 281</span></a>              <a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a> = '!Unknown error in <a class="function" onClick="logFunction('save_image')" href="../../../../_functions/save_image.html" onMouseOver="funcPopup(event,'save_image')">save_image</a>().';
<a name="l282"><span class="linenum"> 282</span></a>      }
<a name="l283"><span class="linenum"> 283</span></a>  
<a name="l284"><span class="linenum"> 284</span></a>      if( empty( <a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a> ) )
<a name="l285"><span class="linenum"> 285</span></a>      {
<a name="l286"><span class="linenum"> 286</span></a>  <span class="comment">        // Make sure the file has the default permissions we want:</span>
<a name="l287"><span class="linenum"> 287</span></a>          if( <a class="var it1524" onMouseOver="hilite(1524)" onMouseOut="lolite()" onClick="logVariable('chmod')" href="../../../../_variables/chmod.html">$chmod</a> === NULL )
<a name="l288"><span class="linenum"> 288</span></a>          {
<a name="l289"><span class="linenum"> 289</span></a>              global <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../../../_variables/Settings.html">$Settings</a>;
<a name="l290"><span class="linenum"> 290</span></a>              <a class="var it1524" onMouseOver="hilite(1524)" onMouseOut="lolite()" onClick="logVariable('chmod')" href="../../../../_variables/chmod.html">$chmod</a> = <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../../../_variables/Settings.html">$Settings</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>('fm_default_chmod_file');
<a name="l291"><span class="linenum"> 291</span></a>          }
<a name="l292"><span class="linenum"> 292</span></a>          <a class="phpfunction" onClick="logFunction('chmod')" href="../../../../_functions/chmod.html" onMouseOver="phpfuncPopup(event,'chmod')">chmod</a>( <a class="var it1083" onMouseOver="hilite(1083)" onMouseOut="lolite()" onClick="logVariable('path')" href="../../../../_variables/path.html">$path</a>, <a class="phpfunction" onClick="logFunction('octdec')" href="../../../../_functions/octdec.html" onMouseOver="phpfuncPopup(event,'octdec')">octdec</a>( <a class="var it1524" onMouseOver="hilite(1524)" onMouseOut="lolite()" onClick="logVariable('chmod')" href="../../../../_variables/chmod.html">$chmod</a> ) );
<a name="l293"><span class="linenum"> 293</span></a>      }
<a name="l294"><span class="linenum"> 294</span></a>  
<a name="l295"><span class="linenum"> 295</span></a>      return <a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a>;
<a name="l296"><span class="linenum"> 296</span></a>  }
<a name="l297"><span class="linenum"> 297</span></a>  
<a name="l298"><span class="linenum"> 298</span></a>  
<a name="l299"><span class="linenum"> 299</span></a>  <span class="comment">/**</span>
<a name="l300"><span class="linenum"> 300</span></a>  <span class="comment"> * Output an image from memory to web client</span>
<a name="l301"><span class="linenum"> 301</span></a>  <span class="comment"> *</span>
<a name="l302"><span class="linenum"> 302</span></a>  <span class="comment"> * @param resource image handle</span>
<a name="l303"><span class="linenum"> 303</span></a>  <span class="comment"> * @param string</span>
<a name="l304"><span class="linenum"> 304</span></a>  <span class="comment"> * @return string</span>
<a name="l305"><span class="linenum"> 305</span></a>  <span class="comment"> */</span>
<a name="l306"><span class="linenum"> 306</span></a>  function <a class="function" onClick="logFunction('output_image')" href="../../../../_functions/output_image.html" onMouseOver="funcPopup(event,'output_image')">output_image</a>( <a class="var it1510" onMouseOver="hilite(1510)" onMouseOut="lolite()" onClick="logVariable('imh')" href="../../../../_variables/imh.html">$imh</a>, <a class="var it739" onMouseOver="hilite(739)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../../../../_variables/mimetype.html">$mimetype</a> )
<a name="l307"><span class="linenum"> 307</span></a>  {
<a name="l308"><span class="linenum"> 308</span></a>      <a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a> = NULL;
<a name="l309"><span class="linenum"> 309</span></a>  
<a name="l310"><span class="linenum"> 310</span></a>      switch( <a class="var it739" onMouseOver="hilite(739)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../../../../_variables/mimetype.html">$mimetype</a> )
<a name="l311"><span class="linenum"> 311</span></a>      {
<a name="l312"><span class="linenum"> 312</span></a>          case 'image/jpeg':
<a name="l313"><span class="linenum"> 313</span></a>              <a class="phpfunction" onClick="logFunction('header')" href="../../../../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>('Content-type: '.<a class="var it739" onMouseOver="hilite(739)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../../../../_variables/mimetype.html">$mimetype</a> );
<a name="l314"><span class="linenum"> 314</span></a>              if( <a class="phpfunction" onClick="logFunction('imagesx')" href="../../../../_functions/imagesx.html" onMouseOver="phpfuncPopup(event,'imagesx')">imagesx</a>( <a class="var it1510" onMouseOver="hilite(1510)" onMouseOut="lolite()" onClick="logVariable('imh')" href="../../../../_variables/imh.html">$imh</a> ) &gt; 32 || <a class="phpfunction" onClick="logFunction('imagesy')" href="../../../../_functions/imagesy.html" onMouseOver="phpfuncPopup(event,'imagesy')">imagesy</a>( <a class="var it1510" onMouseOver="hilite(1510)" onMouseOut="lolite()" onClick="logVariable('imh')" href="../../../../_variables/imh.html">$imh</a> ) &gt; 32 )
<a name="l315"><span class="linenum"> 315</span></a>              { // Enable interlacing
<a name="l316"><span class="linenum"> 316</span></a>                  <a class="phpfunction" onClick="logFunction('imageinterlace')" href="../../../../_functions/imageinterlace.html" onMouseOver="phpfuncPopup(event,'imageinterlace')">imageinterlace</a>( <a class="var it1510" onMouseOver="hilite(1510)" onMouseOut="lolite()" onClick="logVariable('imh')" href="../../../../_variables/imh.html">$imh</a>, 1 );
<a name="l317"><span class="linenum"> 317</span></a>              }
<a name="l318"><span class="linenum"> 318</span></a>              <a class="phpfunction" onClick="logFunction('imagejpeg')" href="../../../../_functions/imagejpeg.html" onMouseOver="phpfuncPopup(event,'imagejpeg')">imagejpeg</a>( <a class="var it1510" onMouseOver="hilite(1510)" onMouseOut="lolite()" onClick="logVariable('imh')" href="../../../../_variables/imh.html">$imh</a> );
<a name="l319"><span class="linenum"> 319</span></a>              break;
<a name="l320"><span class="linenum"> 320</span></a>  
<a name="l321"><span class="linenum"> 321</span></a>          case 'image/gif':
<a name="l322"><span class="linenum"> 322</span></a>              <a class="phpfunction" onClick="logFunction('header')" href="../../../../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>('Content-type: '.<a class="var it739" onMouseOver="hilite(739)" onMouseOut="lolite()" onClick="logVariable('mimetype')" href="../../../../_variables/mimetype.html">$mimetype</a> );
<a name="l323"><span class="linenum"> 323</span></a>              <a class="phpfunction" onClick="logFunction('imagegif')" href="../../../../_functions/imagegif.html" onMouseOver="phpfuncPopup(event,'imagegif')">imagegif</a>( <a class="var it1510" onMouseOver="hilite(1510)" onMouseOut="lolite()" onClick="logVariable('imh')" href="../../../../_variables/imh.html">$imh</a> );
<a name="l324"><span class="linenum"> 324</span></a>              break;
<a name="l325"><span class="linenum"> 325</span></a>  
<a name="l326"><span class="linenum"> 326</span></a>          default:
<a name="l327"><span class="linenum"> 327</span></a>  <span class="comment">            // Unrecognized mime type</span>
<a name="l328"><span class="linenum"> 328</span></a>              <a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a> = 'Emime';    <span class="comment">// Sort error code</span>
<a name="l329"><span class="linenum"> 329</span></a>              break;
<a name="l330"><span class="linenum"> 330</span></a>      }
<a name="l331"><span class="linenum"> 331</span></a>  
<a name="l332"><span class="linenum"> 332</span></a>      return <a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a>;
<a name="l333"><span class="linenum"> 333</span></a>  }
<a name="l334"><span class="linenum"> 334</span></a>  
<a name="l335"><span class="linenum"> 335</span></a>  
<a name="l336"><span class="linenum"> 336</span></a>  <span class="comment">/**</span>
<a name="l337"><span class="linenum"> 337</span></a>  <span class="comment"> * Generate a thumbnail</span>
<a name="l338"><span class="linenum"> 338</span></a>  <span class="comment"> *</span>
<a name="l339"><span class="linenum"> 339</span></a>  <span class="comment"> * @param resource Image resource</span>
<a name="l340"><span class="linenum"> 340</span></a>  <span class="comment"> * @param string Thumbnail type ('crop'|'fit')</span>
<a name="l341"><span class="linenum"> 341</span></a>  <span class="comment"> * @param int Thumbnail width</span>
<a name="l342"><span class="linenum"> 342</span></a>  <span class="comment"> * @param int Thumbnail height</span>
<a name="l343"><span class="linenum"> 343</span></a>  <span class="comment"> * @param int Thumbnail percent of blur effect (0 - No blur, 1% - Max blur effect, 99% - Min blur effect)</span>
<a name="l344"><span class="linenum"> 344</span></a>  <span class="comment"> * @param integer Ratio size, can be 1, 2 and etc.</span>
<a name="l345"><span class="linenum"> 345</span></a>  <span class="comment"> * @return array short error code + dest image handler</span>
<a name="l346"><span class="linenum"> 346</span></a>  <span class="comment"> */</span>
<a name="l347"><span class="linenum"> 347</span></a>  function <a class="function" onClick="logFunction('generate_thumb')" href="../../../../_functions/generate_thumb.html" onMouseOver="funcPopup(event,'generate_thumb')">generate_thumb</a>( <a class="var it1525" onMouseOver="hilite(1525)" onMouseOut="lolite()" onClick="logVariable('src_imh')" href="../../../../_variables/src_imh.html">$src_imh</a>, <a class="var it1526" onMouseOver="hilite(1526)" onMouseOut="lolite()" onClick="logVariable('thumb_type')" href="../../../../_variables/thumb_type.html">$thumb_type</a>, <a class="var it1527" onMouseOver="hilite(1527)" onMouseOut="lolite()" onClick="logVariable('thumb_width')" href="../../../../_variables/thumb_width.html">$thumb_width</a>, <a class="var it1528" onMouseOver="hilite(1528)" onMouseOut="lolite()" onClick="logVariable('thumb_height')" href="../../../../_variables/thumb_height.html">$thumb_height</a>, <a class="var it1529" onMouseOver="hilite(1529)" onMouseOut="lolite()" onClick="logVariable('thumb_percent_blur')" href="../../../../_variables/thumb_percent_blur.html">$thumb_percent_blur</a> = 0, <a class="var it1530" onMouseOver="hilite(1530)" onMouseOut="lolite()" onClick="logVariable('size_x')" href="../../../../_variables/size_x.html">$size_x</a> = 1 )
<a name="l348"><span class="linenum"> 348</span></a>  {
<a name="l349"><span class="linenum"> 349</span></a>      <a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a> = <a class="phpfunction" onClick="logFunction('imagesx')" href="../../../../_functions/imagesx.html" onMouseOver="phpfuncPopup(event,'imagesx')">imagesx</a>( <a class="var it1525" onMouseOver="hilite(1525)" onMouseOut="lolite()" onClick="logVariable('src_imh')" href="../../../../_variables/src_imh.html">$src_imh</a> );
<a name="l350"><span class="linenum"> 350</span></a>      <a class="var it1502" onMouseOver="hilite(1502)" onMouseOut="lolite()" onClick="logVariable('src_height')" href="../../../../_variables/src_height.html">$src_height</a> = <a class="phpfunction" onClick="logFunction('imagesy')" href="../../../../_functions/imagesy.html" onMouseOver="phpfuncPopup(event,'imagesy')">imagesy</a>( <a class="var it1525" onMouseOver="hilite(1525)" onMouseOut="lolite()" onClick="logVariable('src_imh')" href="../../../../_variables/src_imh.html">$src_imh</a> );
<a name="l351"><span class="linenum"> 351</span></a>  
<a name="l352"><span class="linenum"> 352</span></a>      <a class="var it1530" onMouseOver="hilite(1530)" onMouseOut="lolite()" onClick="logVariable('size_x')" href="../../../../_variables/size_x.html">$size_x</a> = <a class="phpfunction" onClick="logFunction('intval')" href="../../../../_functions/intval.html" onMouseOver="phpfuncPopup(event,'intval')">intval</a>( <a class="var it1530" onMouseOver="hilite(1530)" onMouseOut="lolite()" onClick="logVariable('size_x')" href="../../../../_variables/size_x.html">$size_x</a> );
<a name="l353"><span class="linenum"> 353</span></a>      if( <a class="var it1530" onMouseOver="hilite(1530)" onMouseOut="lolite()" onClick="logVariable('size_x')" href="../../../../_variables/size_x.html">$size_x</a> &gt; 1 )
<a name="l354"><span class="linenum"> 354</span></a>      { // Use the expanded size
<a name="l355"><span class="linenum"> 355</span></a>          <a class="var it1527" onMouseOver="hilite(1527)" onMouseOut="lolite()" onClick="logVariable('thumb_width')" href="../../../../_variables/thumb_width.html">$thumb_width</a> = <a class="var it1527" onMouseOver="hilite(1527)" onMouseOut="lolite()" onClick="logVariable('thumb_width')" href="../../../../_variables/thumb_width.html">$thumb_width</a> * <a class="var it1530" onMouseOver="hilite(1530)" onMouseOut="lolite()" onClick="logVariable('size_x')" href="../../../../_variables/size_x.html">$size_x</a>;
<a name="l356"><span class="linenum"> 356</span></a>          <a class="var it1528" onMouseOver="hilite(1528)" onMouseOut="lolite()" onClick="logVariable('thumb_height')" href="../../../../_variables/thumb_height.html">$thumb_height</a> = <a class="var it1528" onMouseOver="hilite(1528)" onMouseOut="lolite()" onClick="logVariable('thumb_height')" href="../../../../_variables/thumb_height.html">$thumb_height</a> * <a class="var it1530" onMouseOver="hilite(1530)" onMouseOut="lolite()" onClick="logVariable('size_x')" href="../../../../_variables/size_x.html">$size_x</a>;
<a name="l357"><span class="linenum"> 357</span></a>      }
<a name="l358"><span class="linenum"> 358</span></a>  
<a name="l359"><span class="linenum"> 359</span></a>      if( <a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a> &lt;= <a class="var it1527" onMouseOver="hilite(1527)" onMouseOut="lolite()" onClick="logVariable('thumb_width')" href="../../../../_variables/thumb_width.html">$thumb_width</a> &amp;&amp; <a class="var it1502" onMouseOver="hilite(1502)" onMouseOut="lolite()" onClick="logVariable('src_height')" href="../../../../_variables/src_height.html">$src_height</a> &lt;= <a class="var it1528" onMouseOver="hilite(1528)" onMouseOut="lolite()" onClick="logVariable('thumb_height')" href="../../../../_variables/thumb_height.html">$thumb_height</a> )
<a name="l360"><span class="linenum"> 360</span></a>      { // There is no need to resample, use original!
<a name="l361"><span class="linenum"> 361</span></a>          return array( NULL, <a class="var it1525" onMouseOver="hilite(1525)" onMouseOut="lolite()" onClick="logVariable('src_imh')" href="../../../../_variables/src_imh.html">$src_imh</a> );
<a name="l362"><span class="linenum"> 362</span></a>      }
<a name="l363"><span class="linenum"> 363</span></a>  
<a name="l364"><span class="linenum"> 364</span></a>      switch( <a class="var it1526" onMouseOver="hilite(1526)" onMouseOut="lolite()" onClick="logVariable('thumb_type')" href="../../../../_variables/thumb_type.html">$thumb_type</a> )
<a name="l365"><span class="linenum"> 365</span></a>      {
<a name="l366"><span class="linenum"> 366</span></a>          case 'crop':
<a name="l367"><span class="linenum"> 367</span></a>          case 'crop-top':
<a name="l368"><span class="linenum"> 368</span></a>              <a class="var it1461" onMouseOver="hilite(1461)" onMouseOut="lolite()" onClick="logVariable('align')" href="../../../../_variables/align.html">$align</a> = <a class="var it1526" onMouseOver="hilite(1526)" onMouseOut="lolite()" onClick="logVariable('thumb_type')" href="../../../../_variables/thumb_type.html">$thumb_type</a> == 'crop-top' ? 'top' : 'center';
<a name="l369"><span class="linenum"> 369</span></a>              <a class="function" onClick="logFunction('list')" href="../../../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>( <a class="var it1531" onMouseOver="hilite(1531)" onMouseOut="lolite()" onClick="logVariable('src_x')" href="../../../../_variables/src_x.html">$src_x</a>, <a class="var it1532" onMouseOver="hilite(1532)" onMouseOut="lolite()" onClick="logVariable('src_y')" href="../../../../_variables/src_y.html">$src_y</a>, <a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a>, <a class="var it1502" onMouseOver="hilite(1502)" onMouseOut="lolite()" onClick="logVariable('src_height')" href="../../../../_variables/src_height.html">$src_height</a>) = <a class="function" onClick="logFunction('crop_to_constraint')" href="../../../../_functions/crop_to_constraint.html" onMouseOver="funcPopup(event,'crop_to_constraint')">crop_to_constraint</a>( <a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a>, <a class="var it1502" onMouseOver="hilite(1502)" onMouseOut="lolite()" onClick="logVariable('src_height')" href="../../../../_variables/src_height.html">$src_height</a>, <a class="var it1527" onMouseOver="hilite(1527)" onMouseOut="lolite()" onClick="logVariable('thumb_width')" href="../../../../_variables/thumb_width.html">$thumb_width</a>, <a class="var it1528" onMouseOver="hilite(1528)" onMouseOut="lolite()" onClick="logVariable('thumb_height')" href="../../../../_variables/thumb_height.html">$thumb_height</a>, <a class="var it1461" onMouseOver="hilite(1461)" onMouseOut="lolite()" onClick="logVariable('align')" href="../../../../_variables/align.html">$align</a> );
<a name="l370"><span class="linenum"> 370</span></a>              <a class="var it1533" onMouseOver="hilite(1533)" onMouseOut="lolite()" onClick="logVariable('dest_width')" href="../../../../_variables/dest_width.html">$dest_width</a> = <a class="var it1527" onMouseOver="hilite(1527)" onMouseOut="lolite()" onClick="logVariable('thumb_width')" href="../../../../_variables/thumb_width.html">$thumb_width</a>;
<a name="l371"><span class="linenum"> 371</span></a>              <a class="var it1534" onMouseOver="hilite(1534)" onMouseOut="lolite()" onClick="logVariable('dest_height')" href="../../../../_variables/dest_height.html">$dest_height</a> = <a class="var it1528" onMouseOver="hilite(1528)" onMouseOut="lolite()" onClick="logVariable('thumb_height')" href="../../../../_variables/thumb_height.html">$thumb_height</a>;
<a name="l372"><span class="linenum"> 372</span></a>              break;
<a name="l373"><span class="linenum"> 373</span></a>  
<a name="l374"><span class="linenum"> 374</span></a>          case 'fit':
<a name="l375"><span class="linenum"> 375</span></a>          default:
<a name="l376"><span class="linenum"> 376</span></a>              <a class="function" onClick="logFunction('list')" href="../../../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>( <a class="var it1533" onMouseOver="hilite(1533)" onMouseOut="lolite()" onClick="logVariable('dest_width')" href="../../../../_variables/dest_width.html">$dest_width</a>, <a class="var it1534" onMouseOver="hilite(1534)" onMouseOut="lolite()" onClick="logVariable('dest_height')" href="../../../../_variables/dest_height.html">$dest_height</a> ) = <a class="function" onClick="logFunction('scale_to_constraint')" href="../../../../_functions/scale_to_constraint.html" onMouseOver="funcPopup(event,'scale_to_constraint')">scale_to_constraint</a>( <a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a>, <a class="var it1502" onMouseOver="hilite(1502)" onMouseOut="lolite()" onClick="logVariable('src_height')" href="../../../../_variables/src_height.html">$src_height</a>, <a class="var it1527" onMouseOver="hilite(1527)" onMouseOut="lolite()" onClick="logVariable('thumb_width')" href="../../../../_variables/thumb_width.html">$thumb_width</a>, <a class="var it1528" onMouseOver="hilite(1528)" onMouseOut="lolite()" onClick="logVariable('thumb_height')" href="../../../../_variables/thumb_height.html">$thumb_height</a> );
<a name="l377"><span class="linenum"> 377</span></a>              <a class="var it1531" onMouseOver="hilite(1531)" onMouseOut="lolite()" onClick="logVariable('src_x')" href="../../../../_variables/src_x.html">$src_x</a> = <a class="var it1532" onMouseOver="hilite(1532)" onMouseOut="lolite()" onClick="logVariable('src_y')" href="../../../../_variables/src_y.html">$src_y</a> = 0;
<a name="l378"><span class="linenum"> 378</span></a>      }
<a name="l379"><span class="linenum"> 379</span></a>  
<a name="l380"><span class="linenum"> 380</span></a>  <span class="comment">    // pre_dump( $src_x, $src_y, $dest_width, $dest_height, $src_width, $src_height );</span>
<a name="l381"><span class="linenum"> 381</span></a>  
<a name="l382"><span class="linenum"> 382</span></a>  <span class="comment">    // Create a transparent image:</span>
<a name="l383"><span class="linenum"> 383</span></a>      <a class="var it1535" onMouseOver="hilite(1535)" onMouseOut="lolite()" onClick="logVariable('dest_imh')" href="../../../../_variables/dest_imh.html">$dest_imh</a> = <a class="phpfunction" onClick="logFunction('imagecreatetruecolor')" href="../../../../_functions/imagecreatetruecolor.html" onMouseOver="phpfuncPopup(event,'imagecreatetruecolor')">imagecreatetruecolor</a>( <a class="var it1533" onMouseOver="hilite(1533)" onMouseOut="lolite()" onClick="logVariable('dest_width')" href="../../../../_variables/dest_width.html">$dest_width</a>, <a class="var it1534" onMouseOver="hilite(1534)" onMouseOut="lolite()" onClick="logVariable('dest_height')" href="../../../../_variables/dest_height.html">$dest_height</a> );
<a name="l384"><span class="linenum"> 384</span></a>      <a class="phpfunction" onClick="logFunction('imagealphablending')" href="../../../../_functions/imagealphablending.html" onMouseOver="phpfuncPopup(event,'imagealphablending')">imagealphablending</a>(<a class="var it1535" onMouseOver="hilite(1535)" onMouseOut="lolite()" onClick="logVariable('dest_imh')" href="../../../../_variables/dest_imh.html">$dest_imh</a>, true);
<a name="l385"><span class="linenum"> 385</span></a>      <a class="phpfunction" onClick="logFunction('imagefill')" href="../../../../_functions/imagefill.html" onMouseOver="phpfuncPopup(event,'imagefill')">imagefill</a>(<a class="var it1535" onMouseOver="hilite(1535)" onMouseOut="lolite()" onClick="logVariable('dest_imh')" href="../../../../_variables/dest_imh.html">$dest_imh</a>, 0, 0, <a class="phpfunction" onClick="logFunction('imagecolortransparent')" href="../../../../_functions/imagecolortransparent.html" onMouseOver="phpfuncPopup(event,'imagecolortransparent')">imagecolortransparent</a>(<a class="var it1535" onMouseOver="hilite(1535)" onMouseOut="lolite()" onClick="logVariable('dest_imh')" href="../../../../_variables/dest_imh.html">$dest_imh</a>, <a class="phpfunction" onClick="logFunction('imagecolorallocatealpha')" href="../../../../_functions/imagecolorallocatealpha.html" onMouseOver="phpfuncPopup(event,'imagecolorallocatealpha')">imagecolorallocatealpha</a>(<a class="var it1535" onMouseOver="hilite(1535)" onMouseOut="lolite()" onClick="logVariable('dest_imh')" href="../../../../_variables/dest_imh.html">$dest_imh</a>, 0, 0, 0, 127)));
<a name="l386"><span class="linenum"> 386</span></a>      <a class="phpfunction" onClick="logFunction('imagesavealpha')" href="../../../../_functions/imagesavealpha.html" onMouseOver="phpfuncPopup(event,'imagesavealpha')">imagesavealpha</a>(<a class="var it1535" onMouseOver="hilite(1535)" onMouseOut="lolite()" onClick="logVariable('dest_imh')" href="../../../../_variables/dest_imh.html">$dest_imh</a>, true);
<a name="l387"><span class="linenum"> 387</span></a>  
<a name="l388"><span class="linenum"> 388</span></a>      if( ! <a class="phpfunction" onClick="logFunction('imagecopyresampled')" href="../../../../_functions/imagecopyresampled.html" onMouseOver="phpfuncPopup(event,'imagecopyresampled')">imagecopyresampled</a>( <a class="var it1535" onMouseOver="hilite(1535)" onMouseOut="lolite()" onClick="logVariable('dest_imh')" href="../../../../_variables/dest_imh.html">$dest_imh</a>, <a class="var it1525" onMouseOver="hilite(1525)" onMouseOut="lolite()" onClick="logVariable('src_imh')" href="../../../../_variables/src_imh.html">$src_imh</a>, 0, 0, <a class="var it1531" onMouseOver="hilite(1531)" onMouseOut="lolite()" onClick="logVariable('src_x')" href="../../../../_variables/src_x.html">$src_x</a>, <a class="var it1532" onMouseOver="hilite(1532)" onMouseOut="lolite()" onClick="logVariable('src_y')" href="../../../../_variables/src_y.html">$src_y</a>, <a class="var it1533" onMouseOver="hilite(1533)" onMouseOut="lolite()" onClick="logVariable('dest_width')" href="../../../../_variables/dest_width.html">$dest_width</a>, <a class="var it1534" onMouseOver="hilite(1534)" onMouseOut="lolite()" onClick="logVariable('dest_height')" href="../../../../_variables/dest_height.html">$dest_height</a>, <a class="var it1501" onMouseOver="hilite(1501)" onMouseOut="lolite()" onClick="logVariable('src_width')" href="../../../../_variables/src_width.html">$src_width</a>, <a class="var it1502" onMouseOver="hilite(1502)" onMouseOut="lolite()" onClick="logVariable('src_height')" href="../../../../_variables/src_height.html">$src_height</a> ) )
<a name="l389"><span class="linenum"> 389</span></a>      {
<a name="l390"><span class="linenum"> 390</span></a>          return array( '!GD-library internal <a class="function" onClick="logFunction('error')" href="../../../../_functions/error.html" onMouseOver="funcPopup(event,'error')">error</a> (resample)', <a class="var it1535" onMouseOver="hilite(1535)" onMouseOut="lolite()" onClick="logVariable('dest_imh')" href="../../../../_variables/dest_imh.html">$dest_imh</a> );
<a name="l391"><span class="linenum"> 391</span></a>      }
<a name="l392"><span class="linenum"> 392</span></a>  
<a name="l393"><span class="linenum"> 393</span></a>      if( <a class="var it1529" onMouseOver="hilite(1529)" onMouseOut="lolite()" onClick="logVariable('thumb_percent_blur')" href="../../../../_variables/thumb_percent_blur.html">$thumb_percent_blur</a> &gt; 0 )
<a name="l394"><span class="linenum"> 394</span></a>      {    // Apply blur effect
<a name="l395"><span class="linenum"> 395</span></a>          <a class="var it1535" onMouseOver="hilite(1535)" onMouseOut="lolite()" onClick="logVariable('dest_imh')" href="../../../../_variables/dest_imh.html">$dest_imh</a> = <a class="function" onClick="logFunction('pixelblur')" href="../../../../_functions/pixelblur.html" onMouseOver="funcPopup(event,'pixelblur')">pixelblur</a>( <a class="var it1535" onMouseOver="hilite(1535)" onMouseOut="lolite()" onClick="logVariable('dest_imh')" href="../../../../_variables/dest_imh.html">$dest_imh</a>, <a class="var it1533" onMouseOver="hilite(1533)" onMouseOut="lolite()" onClick="logVariable('dest_width')" href="../../../../_variables/dest_width.html">$dest_width</a>, <a class="var it1534" onMouseOver="hilite(1534)" onMouseOut="lolite()" onClick="logVariable('dest_height')" href="../../../../_variables/dest_height.html">$dest_height</a>, <a class="var it1529" onMouseOver="hilite(1529)" onMouseOut="lolite()" onClick="logVariable('thumb_percent_blur')" href="../../../../_variables/thumb_percent_blur.html">$thumb_percent_blur</a> );
<a name="l396"><span class="linenum"> 396</span></a>      }
<a name="l397"><span class="linenum"> 397</span></a>  
<a name="l398"><span class="linenum"> 398</span></a>  <span class="comment">    // TODO: imageinterlace();</span>
<a name="l399"><span class="linenum"> 399</span></a>  
<a name="l400"><span class="linenum"> 400</span></a>      return array( NULL, <a class="var it1535" onMouseOver="hilite(1535)" onMouseOut="lolite()" onClick="logVariable('dest_imh')" href="../../../../_variables/dest_imh.html">$dest_imh</a> );
<a name="l401"><span class="linenum"> 401</span></a>  }
<a name="l402"><span class="linenum"> 402</span></a>  
<a name="l403"><span class="linenum"> 403</span></a>  
<a name="l404"><span class="linenum"> 404</span></a>  <span class="comment">/**</span>
<a name="l405"><span class="linenum"> 405</span></a>  <span class="comment"> * Apply blur effect</span>
<a name="l406"><span class="linenum"> 406</span></a>  <span class="comment"> *</span>
<a name="l407"><span class="linenum"> 407</span></a>  <span class="comment"> * @param resource Image resource</span>
<a name="l408"><span class="linenum"> 408</span></a>  <span class="comment"> * @param int Source width</span>
<a name="l409"><span class="linenum"> 409</span></a>  <span class="comment"> * @param int Source height</span>
<a name="l410"><span class="linenum"> 410</span></a>  <span class="comment"> * @param int Percent of blur effect (0 - No blur, 1% - Max blur effect, 99% - Min blur effect)</span>
<a name="l411"><span class="linenum"> 411</span></a>  <span class="comment"> * @return resource Image resource</span>
<a name="l412"><span class="linenum"> 412</span></a>  <span class="comment"> */</span>
<a name="l413"><span class="linenum"> 413</span></a>  function <a class="function" onClick="logFunction('pixelblur')" href="../../../../_functions/pixelblur.html" onMouseOver="funcPopup(event,'pixelblur')">pixelblur</a>( <a class="var it1536" onMouseOver="hilite(1536)" onMouseOut="lolite()" onClick="logVariable('image_source')" href="../../../../_variables/image_source.html">$image_source</a>, <a class="var it1537" onMouseOver="hilite(1537)" onMouseOut="lolite()" onClick="logVariable('width_source')" href="../../../../_variables/width_source.html">$width_source</a>, <a class="var it1538" onMouseOver="hilite(1538)" onMouseOut="lolite()" onClick="logVariable('height_source')" href="../../../../_variables/height_source.html">$height_source</a>, <a class="var it1539" onMouseOver="hilite(1539)" onMouseOut="lolite()" onClick="logVariable('percent_blur')" href="../../../../_variables/percent_blur.html">$percent_blur</a> )
<a name="l414"><span class="linenum"> 414</span></a>  {
<a name="l415"><span class="linenum"> 415</span></a>      if( <a class="var it1539" onMouseOver="hilite(1539)" onMouseOut="lolite()" onClick="logVariable('percent_blur')" href="../../../../_variables/percent_blur.html">$percent_blur</a> &lt; 1 &amp;&amp; <a class="var it1539" onMouseOver="hilite(1539)" onMouseOut="lolite()" onClick="logVariable('percent_blur')" href="../../../../_variables/percent_blur.html">$percent_blur</a> &gt; 99 )
<a name="l416"><span class="linenum"> 416</span></a>      {    // Don't spend a time for processing of blur effect with bad percent request
<a name="l417"><span class="linenum"> 417</span></a>          return <a class="var it1536" onMouseOver="hilite(1536)" onMouseOut="lolite()" onClick="logVariable('image_source')" href="../../../../_variables/image_source.html">$image_source</a>;
<a name="l418"><span class="linenum"> 418</span></a>      }
<a name="l419"><span class="linenum"> 419</span></a>  
<a name="l420"><span class="linenum"> 420</span></a>      <a class="var it1540" onMouseOver="hilite(1540)" onMouseOut="lolite()" onClick="logVariable('width_resized')" href="../../../../_variables/width_resized.html">$width_resized</a> = <a class="phpfunction" onClick="logFunction('ceil')" href="../../../../_functions/ceil.html" onMouseOver="phpfuncPopup(event,'ceil')">ceil</a>( <a class="var it1537" onMouseOver="hilite(1537)" onMouseOut="lolite()" onClick="logVariable('width_source')" href="../../../../_variables/width_source.html">$width_source</a> * <a class="var it1539" onMouseOver="hilite(1539)" onMouseOut="lolite()" onClick="logVariable('percent_blur')" href="../../../../_variables/percent_blur.html">$percent_blur</a> / 100 );
<a name="l421"><span class="linenum"> 421</span></a>      <a class="var it1541" onMouseOver="hilite(1541)" onMouseOut="lolite()" onClick="logVariable('height_resized')" href="../../../../_variables/height_resized.html">$height_resized</a> = <a class="phpfunction" onClick="logFunction('ceil')" href="../../../../_functions/ceil.html" onMouseOver="phpfuncPopup(event,'ceil')">ceil</a>( <a class="var it1538" onMouseOver="hilite(1538)" onMouseOut="lolite()" onClick="logVariable('height_source')" href="../../../../_variables/height_source.html">$height_source</a> * <a class="var it1539" onMouseOver="hilite(1539)" onMouseOut="lolite()" onClick="logVariable('percent_blur')" href="../../../../_variables/percent_blur.html">$percent_blur</a> / 100 );
<a name="l422"><span class="linenum"> 422</span></a>  
<a name="l423"><span class="linenum"> 423</span></a>      <a class="var it1542" onMouseOver="hilite(1542)" onMouseOut="lolite()" onClick="logVariable('image_resized')" href="../../../../_variables/image_resized.html">$image_resized</a> = <a class="phpfunction" onClick="logFunction('imagecreatetruecolor')" href="../../../../_functions/imagecreatetruecolor.html" onMouseOver="phpfuncPopup(event,'imagecreatetruecolor')">imagecreatetruecolor</a>( <a class="var it1540" onMouseOver="hilite(1540)" onMouseOut="lolite()" onClick="logVariable('width_resized')" href="../../../../_variables/width_resized.html">$width_resized</a>, <a class="var it1541" onMouseOver="hilite(1541)" onMouseOut="lolite()" onClick="logVariable('height_resized')" href="../../../../_variables/height_resized.html">$height_resized</a> );
<a name="l424"><span class="linenum"> 424</span></a>  <span class="comment">    // Reduce image size by given percent</span>
<a name="l425"><span class="linenum"> 425</span></a>      <a class="phpfunction" onClick="logFunction('imagecopyresampled')" href="../../../../_functions/imagecopyresampled.html" onMouseOver="phpfuncPopup(event,'imagecopyresampled')">imagecopyresampled</a>( <a class="var it1542" onMouseOver="hilite(1542)" onMouseOut="lolite()" onClick="logVariable('image_resized')" href="../../../../_variables/image_resized.html">$image_resized</a>, <a class="var it1536" onMouseOver="hilite(1536)" onMouseOut="lolite()" onClick="logVariable('image_source')" href="../../../../_variables/image_source.html">$image_source</a>, 0, 0, 0, 0, <a class="var it1540" onMouseOver="hilite(1540)" onMouseOut="lolite()" onClick="logVariable('width_resized')" href="../../../../_variables/width_resized.html">$width_resized</a>, <a class="var it1541" onMouseOver="hilite(1541)" onMouseOut="lolite()" onClick="logVariable('height_resized')" href="../../../../_variables/height_resized.html">$height_resized</a>, <a class="var it1537" onMouseOver="hilite(1537)" onMouseOut="lolite()" onClick="logVariable('width_source')" href="../../../../_variables/width_source.html">$width_source</a>, <a class="var it1538" onMouseOver="hilite(1538)" onMouseOut="lolite()" onClick="logVariable('height_source')" href="../../../../_variables/height_source.html">$height_source</a> );
<a name="l426"><span class="linenum"> 426</span></a>  <span class="comment">    // Apply blur effect from GD library</span>
<a name="l427"><span class="linenum"> 427</span></a>    if( <a class="phpfunction" onClick="logFunction('function_exists')" href="../../../../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>('imagefilter') )
<a name="l428"><span class="linenum"> 428</span></a>    {
<a name="l429"><span class="linenum"> 429</span></a>      <a class="phpfunction" onClick="logFunction('imagefilter')" href="../../../../_functions/imagefilter.html" onMouseOver="phpfuncPopup(event,'imagefilter')">imagefilter</a>( <a class="var it1542" onMouseOver="hilite(1542)" onMouseOut="lolite()" onClick="logVariable('image_resized')" href="../../../../_variables/image_resized.html">$image_resized</a>, IMG_FILTER_GAUSSIAN_BLUR );
<a name="l430"><span class="linenum"> 430</span></a>    }
<a name="l431"><span class="linenum"> 431</span></a>  <span class="comment">    // Expand image to the source size</span>
<a name="l432"><span class="linenum"> 432</span></a>      <a class="phpfunction" onClick="logFunction('imagecopyresampled')" href="../../../../_functions/imagecopyresampled.html" onMouseOver="phpfuncPopup(event,'imagecopyresampled')">imagecopyresampled</a>( <a class="var it1536" onMouseOver="hilite(1536)" onMouseOut="lolite()" onClick="logVariable('image_source')" href="../../../../_variables/image_source.html">$image_source</a>, <a class="var it1542" onMouseOver="hilite(1542)" onMouseOut="lolite()" onClick="logVariable('image_resized')" href="../../../../_variables/image_resized.html">$image_resized</a>, 0, 0, 0, 0, <a class="var it1537" onMouseOver="hilite(1537)" onMouseOut="lolite()" onClick="logVariable('width_source')" href="../../../../_variables/width_source.html">$width_source</a>, <a class="var it1538" onMouseOver="hilite(1538)" onMouseOut="lolite()" onClick="logVariable('height_source')" href="../../../../_variables/height_source.html">$height_source</a>, <a class="var it1540" onMouseOver="hilite(1540)" onMouseOut="lolite()" onClick="logVariable('width_resized')" href="../../../../_variables/width_resized.html">$width_resized</a>, <a class="var it1541" onMouseOver="hilite(1541)" onMouseOut="lolite()" onClick="logVariable('height_resized')" href="../../../../_variables/height_resized.html">$height_resized</a> );
<a name="l433"><span class="linenum"> 433</span></a>  
<a name="l434"><span class="linenum"> 434</span></a>      return <a class="var it1536" onMouseOver="hilite(1536)" onMouseOut="lolite()" onClick="logVariable('image_source')" href="../../../../_variables/image_source.html">$image_source</a>;
<a name="l435"><span class="linenum"> 435</span></a>  }
<a name="l436"><span class="linenum"> 436</span></a>  
<a name="l437"><span class="linenum"> 437</span></a>  
<a name="l438"><span class="linenum"> 438</span></a>  <span class="comment">/**</span>
<a name="l439"><span class="linenum"> 439</span></a>  <span class="comment"> * Rotate image</span>
<a name="l440"><span class="linenum"> 440</span></a>  <span class="comment"> *</span>
<a name="l441"><span class="linenum"> 441</span></a>  <span class="comment"> * @param object File</span>
<a name="l442"><span class="linenum"> 442</span></a>  <span class="comment"> * @param integer # degrees to rotate</span>
<a name="l443"><span class="linenum"> 443</span></a>  <span class="comment"> * @return boolean TRUE if rotating is successful</span>
<a name="l444"><span class="linenum"> 444</span></a>  <span class="comment"> */</span>
<a name="l445"><span class="linenum"> 445</span></a>  function <a class="function" onClick="logFunction('rotate_image')" href="../../../../_functions/rotate_image.html" onMouseOver="funcPopup(event,'rotate_image')">rotate_image</a>( <a class="var it613" onMouseOver="hilite(613)" onMouseOut="lolite()" onClick="logVariable('File')" href="../../../../_variables/File.html">$File</a>, <a class="var it1543" onMouseOver="hilite(1543)" onMouseOut="lolite()" onClick="logVariable('degrees')" href="../../../../_variables/degrees.html">$degrees</a> )
<a name="l446"><span class="linenum"> 446</span></a>  {
<a name="l447"><span class="linenum"> 447</span></a>      <a class="var it1544" onMouseOver="hilite(1544)" onMouseOut="lolite()" onClick="logVariable('Filetype')" href="../../../../_variables/Filetype.html">$Filetype</a> = &amp; <a class="var it613" onMouseOver="hilite(613)" onMouseOut="lolite()" onClick="logVariable('File')" href="../../../../_variables/File.html">$File</a>-&gt;get_Filetype();
<a name="l448"><span class="linenum"> 448</span></a>      if( !<a class="var it1544" onMouseOver="hilite(1544)" onMouseOut="lolite()" onClick="logVariable('Filetype')" href="../../../../_variables/Filetype.html">$Filetype</a> )
<a name="l449"><span class="linenum"> 449</span></a>      {    // Error
<a name="l450"><span class="linenum"> 450</span></a>          return false;
<a name="l451"><span class="linenum"> 451</span></a>      }
<a name="l452"><span class="linenum"> 452</span></a>  
<a name="l453"><span class="linenum"> 453</span></a>  <span class="comment">    // Load image</span>
<a name="l454"><span class="linenum"> 454</span></a>      <a class="function" onClick="logFunction('list')" href="../../../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>( <a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a>, <a class="var it1510" onMouseOver="hilite(1510)" onMouseOut="lolite()" onClick="logVariable('imh')" href="../../../../_variables/imh.html">$imh</a> ) = <a class="function" onClick="logFunction('load_image')" href="../../../../_functions/load_image.html" onMouseOver="funcPopup(event,'load_image')">load_image</a>( <a class="var it613" onMouseOver="hilite(613)" onMouseOut="lolite()" onClick="logVariable('File')" href="../../../../_variables/File.html">$File</a>-&gt;<a class="function" onClick="logFunction('get_full_path')" href="../../../../_functions/get_full_path.html" onMouseOver="funcPopup(event,'get_full_path')">get_full_path</a>(), <a class="var it1544" onMouseOver="hilite(1544)" onMouseOut="lolite()" onClick="logVariable('Filetype')" href="../../../../_variables/Filetype.html">$Filetype</a>-&gt;<a onClick="logVariable('mimetype')" class="var it9065" onMouseOver="hilite(9065)" onMouseOut="lolite()" href="../../../../_variables/mimetype.html">mimetype</a> );
<a name="l455"><span class="linenum"> 455</span></a>      if( !empty( <a class="var it1509" onMouseOver="hilite(1509)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a> ) )
<a name="l456"><span class="linenum"> 456</span></a>      {    // Error
<a name="l457"><span class="linenum"> 457</span></a>          return false;
<a name="l458"><span class="linenum"> 458</span></a>      }
<a name="l459"><span class="linenum"> 459</span></a>  
<a name="l460"><span class="linenum"> 460</span></a>  <span class="comment">    // Rotate image</span>
<a name="l461"><span class="linenum"> 461</span></a>      if( ! <a class="var it1510" onMouseOver="hilite(1510)" onMouseOut="lolite()" onClick="logVariable('imh')" href="../../../../_variables/imh.html">$imh</a> = @<a class="phpfunction" onClick="logFunction('imagerotate')" href="../../../../_functions/imagerotate.html" onMouseOver="phpfuncPopup(event,'imagerotate')">imagerotate</a>( <a class="var it1510" onMouseOver="hilite(1510)" onMouseOut="lolite()" onClick="logVariable('imh')" href="../../../../_variables/imh.html">$imh</a>, (int)<a class="var it1543" onMouseOver="hilite(1543)" onMouseOut="lolite()" onClick="logVariable('degrees')" href="../../../../_variables/degrees.html">$degrees</a>, 0 ) )
<a name="l462"><span class="linenum"> 462</span></a>      {    // If func imagerorate is not defined for example:
<a name="l463"><span class="linenum"> 463</span></a>          return false;
<a name="l464"><span class="linenum"> 464</span></a>      }
<a name="l465"><span class="linenum"> 465</span></a>  
<a name="l466"><span class="linenum"> 466</span></a>  <span class="comment">    // Save image</span>
<a name="l467"><span class="linenum"> 467</span></a>      <a class="function" onClick="logFunction('save_image')" href="../../../../_functions/save_image.html" onMouseOver="funcPopup(event,'save_image')">save_image</a>( <a class="var it1510" onMouseOver="hilite(1510)" onMouseOut="lolite()" onClick="logVariable('imh')" href="../../../../_variables/imh.html">$imh</a>, <a class="var it613" onMouseOver="hilite(613)" onMouseOut="lolite()" onClick="logVariable('File')" href="../../../../_variables/File.html">$File</a>-&gt;<a class="function" onClick="logFunction('get_full_path')" href="../../../../_functions/get_full_path.html" onMouseOver="funcPopup(event,'get_full_path')">get_full_path</a>(), <a class="var it1544" onMouseOver="hilite(1544)" onMouseOut="lolite()" onClick="logVariable('Filetype')" href="../../../../_variables/Filetype.html">$Filetype</a>-&gt;<a onClick="logVariable('mimetype')" class="var it9065" onMouseOver="hilite(9065)" onMouseOut="lolite()" href="../../../../_variables/mimetype.html">mimetype</a> );
<a name="l468"><span class="linenum"> 468</span></a>  
<a name="l469"><span class="linenum"> 469</span></a>  <span class="comment">    // Remove the old thumbnails</span>
<a name="l470"><span class="linenum"> 470</span></a>      <a class="var it613" onMouseOver="hilite(613)" onMouseOut="lolite()" onClick="logVariable('File')" href="../../../../_variables/File.html">$File</a>-&gt;<a class="function" onClick="logFunction('rm_cache')" href="../../../../_functions/rm_cache.html" onMouseOver="funcPopup(event,'rm_cache')">rm_cache</a>();
<a name="l471"><span class="linenum"> 471</span></a>  
<a name="l472"><span class="linenum"> 472</span></a>      return true;
<a name="l473"><span class="linenum"> 473</span></a>  }
<a name="l474"><span class="linenum"> 474</span></a>  
<a name="l475"><span class="linenum"> 475</span></a>  
<a name="l476"><span class="linenum"> 476</span></a>  <span class="comment">/**</span>
<a name="l477"><span class="linenum"> 477</span></a>  <span class="comment"> * Provide imagerotate for undefined cases</span>
<a name="l478"><span class="linenum"> 478</span></a>  <span class="comment"> *</span>
<a name="l479"><span class="linenum"> 479</span></a>  <span class="comment"> * Rotate an image with a given angle</span>
<a name="l480"><span class="linenum"> 480</span></a>  <span class="comment"> * @param resource Image: An image resource, returned by one of the image creation functions, such as imagecreatetruecolor().</span>
<a name="l481"><span class="linenum"> 481</span></a>  <span class="comment"> * @param integer Angle: Rotation angle, in degrees. The rotation angle is interpreted as the number of degrees to rotate the image anticlockwise.</span>
<a name="l482"><span class="linenum"> 482</span></a>  <span class="comment"> * @param string Bgd_color: Specifies the color of the uncovered zone after the rotation</span>
<a name="l483"><span class="linenum"> 483</span></a>  <span class="comment"> * @param integer Ignore_transparent: If set and non-zero, transparent colors are ignored (otherwise kept).</span>
<a name="l484"><span class="linenum"> 484</span></a>  <span class="comment"> * @return resource Returns an image resource for the rotated image, or FALSE on failure.</span>
<a name="l485"><span class="linenum"> 485</span></a>  <span class="comment"> */</span>
<a name="l486"><span class="linenum"> 486</span></a>  if( !<a class="phpfunction" onClick="logFunction('function_exists')" href="../../../../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>( 'imagerotate' ) )
<a name="l487"><span class="linenum"> 487</span></a>  {
<a name="l488"><span class="linenum"> 488</span></a>      <span class="comment">/**</span>
<a name="l489"><span class="linenum"> 489</span></a>  <span class="comment">     * Imagerotate replacement. ignore_transparent is work for png images</span>
<a name="l490"><span class="linenum"> 490</span></a>  <span class="comment">     * Also, have some standard functions for 90, 180 and 270 degrees.</span>
<a name="l491"><span class="linenum"> 491</span></a>  <span class="comment">     */</span>
<a name="l492"><span class="linenum"> 492</span></a>  	function <a class="function" onClick="logFunction('imagerotate')" href="../../../../_functions/imagerotate.html" onMouseOver="funcPopup(event,'imagerotate')">imagerotate</a>( <a class="var it1545" onMouseOver="hilite(1545)" onMouseOut="lolite()" onClick="logVariable('srcImg')" href="../../../../_variables/srcImg.html">$srcImg</a>, <a class="var it1546" onMouseOver="hilite(1546)" onMouseOut="lolite()" onClick="logVariable('angle')" href="../../../../_variables/angle.html">$angle</a>, <a class="var it1547" onMouseOver="hilite(1547)" onMouseOut="lolite()" onClick="logVariable('bgcolor')" href="../../../../_variables/bgcolor.html">$bgcolor</a>, <a class="var it1548" onMouseOver="hilite(1548)" onMouseOut="lolite()" onClick="logVariable('ignore_transparent')" href="../../../../_variables/ignore_transparent.html">$ignore_transparent</a> = 0 )
<a name="l493"><span class="linenum"> 493</span></a>      {
<a name="l494"><span class="linenum"> 494</span></a>  		function <a class="function" onClick="logFunction('rotateX')" href="../../../../_functions/rotatex.html" onMouseOver="funcPopup(event,'rotatex')">rotateX</a>( <a class="var it1508" onMouseOver="hilite(1508)" onMouseOut="lolite()" onClick="logVariable('x')" href="../../../../_variables/x.html">$x</a>, <a class="var it1507" onMouseOver="hilite(1507)" onMouseOut="lolite()" onClick="logVariable('y')" href="../../../../_variables/y.html">$y</a>, <a class="var it1549" onMouseOver="hilite(1549)" onMouseOut="lolite()" onClick="logVariable('theta')" href="../../../../_variables/theta.html">$theta</a> )
<a name="l495"><span class="linenum"> 495</span></a>          {
<a name="l496"><span class="linenum"> 496</span></a>              return <a class="var it1508" onMouseOver="hilite(1508)" onMouseOut="lolite()" onClick="logVariable('x')" href="../../../../_variables/x.html">$x</a> * <a class="phpfunction" onClick="logFunction('cos')" href="../../../../_functions/cos.html" onMouseOver="phpfuncPopup(event,'cos')">cos</a>( <a class="var it1549" onMouseOver="hilite(1549)" onMouseOut="lolite()" onClick="logVariable('theta')" href="../../../../_variables/theta.html">$theta</a> ) - <a class="var it1507" onMouseOver="hilite(1507)" onMouseOut="lolite()" onClick="logVariable('y')" href="../../../../_variables/y.html">$y</a> * <a class="phpfunction" onClick="logFunction('sin')" href="../../../../_functions/sin.html" onMouseOver="phpfuncPopup(event,'sin')">sin</a>( <a class="var it1549" onMouseOver="hilite(1549)" onMouseOut="lolite()" onClick="logVariable('theta')" href="../../../../_variables/theta.html">$theta</a> );
<a name="l497"><span class="linenum"> 497</span></a>          }
<a name="l498"><span class="linenum"> 498</span></a>  		function <a class="function" onClick="logFunction('rotateY')" href="../../../../_functions/rotatey.html" onMouseOver="funcPopup(event,'rotatey')">rotateY</a>( <a class="var it1508" onMouseOver="hilite(1508)" onMouseOut="lolite()" onClick="logVariable('x')" href="../../../../_variables/x.html">$x</a>, <a class="var it1507" onMouseOver="hilite(1507)" onMouseOut="lolite()" onClick="logVariable('y')" href="../../../../_variables/y.html">$y</a>, <a class="var it1549" onMouseOver="hilite(1549)" onMouseOut="lolite()" onClick="logVariable('theta')" href="../../../../_variables/theta.html">$theta</a> )
<a name="l499"><span class="linenum"> 499</span></a>          {
<a name="l500"><span class="linenum"> 500</span></a>              return <a class="var it1508" onMouseOver="hilite(1508)" onMouseOut="lolite()" onClick="logVariable('x')" href="../../../../_variables/x.html">$x</a> * <a class="phpfunction" onClick="logFunction('sin')" href="../../../../_functions/sin.html" onMouseOver="phpfuncPopup(event,'sin')">sin</a>( <a class="var it1549" onMouseOver="hilite(1549)" onMouseOut="lolite()" onClick="logVariable('theta')" href="../../../../_variables/theta.html">$theta</a> ) + <a class="var it1507" onMouseOver="hilite(1507)" onMouseOut="lolite()" onClick="logVariable('y')" href="../../../../_variables/y.html">$y</a> * <a class="phpfunction" onClick="logFunction('cos')" href="../../../../_functions/cos.html" onMouseOver="phpfuncPopup(event,'cos')">cos</a>( <a class="var it1549" onMouseOver="hilite(1549)" onMouseOut="lolite()" onClick="logVariable('theta')" href="../../../../_variables/theta.html">$theta</a> );
<a name="l501"><span class="linenum"> 501</span></a>          }
<a name="l502"><span class="linenum"> 502</span></a>  
<a name="l503"><span class="linenum"> 503</span></a>          <a class="var it1550" onMouseOver="hilite(1550)" onMouseOut="lolite()" onClick="logVariable('srcw')" href="../../../../_variables/srcw.html">$srcw</a> = <a class="phpfunction" onClick="logFunction('imagesx')" href="../../../../_functions/imagesx.html" onMouseOver="phpfuncPopup(event,'imagesx')">imagesx</a>( <a class="var it1545" onMouseOver="hilite(1545)" onMouseOut="lolite()" onClick="logVariable('srcImg')" href="../../../../_variables/srcImg.html">$srcImg</a> );
<a name="l504"><span class="linenum"> 504</span></a>          <a class="var it1551" onMouseOver="hilite(1551)" onMouseOut="lolite()" onClick="logVariable('srch')" href="../../../../_variables/srch.html">$srch</a> = <a class="phpfunction" onClick="logFunction('imagesy')" href="../../../../_functions/imagesy.html" onMouseOver="phpfuncPopup(event,'imagesy')">imagesy</a>( <a class="var it1545" onMouseOver="hilite(1545)" onMouseOut="lolite()" onClick="logVariable('srcImg')" href="../../../../_variables/srcImg.html">$srcImg</a> );
<a name="l505"><span class="linenum"> 505</span></a>  
<a name="l506"><span class="linenum"> 506</span></a>  <span class="comment">        //Normalize angle</span>
<a name="l507"><span class="linenum"> 507</span></a>          <a class="var it1546" onMouseOver="hilite(1546)" onMouseOut="lolite()" onClick="logVariable('angle')" href="../../../../_variables/angle.html">$angle</a> %= 360;
<a name="l508"><span class="linenum"> 508</span></a>  
<a name="l509"><span class="linenum"> 509</span></a>          if( <a class="var it1546" onMouseOver="hilite(1546)" onMouseOut="lolite()" onClick="logVariable('angle')" href="../../../../_variables/angle.html">$angle</a> == 0 )
<a name="l510"><span class="linenum"> 510</span></a>          {
<a name="l511"><span class="linenum"> 511</span></a>              if( <a class="var it1548" onMouseOver="hilite(1548)" onMouseOut="lolite()" onClick="logVariable('ignore_transparent')" href="../../../../_variables/ignore_transparent.html">$ignore_transparent</a> == 0 )
<a name="l512"><span class="linenum"> 512</span></a>              {
<a name="l513"><span class="linenum"> 513</span></a>                  <a class="phpfunction" onClick="logFunction('imagesavealpha')" href="../../../../_functions/imagesavealpha.html" onMouseOver="phpfuncPopup(event,'imagesavealpha')">imagesavealpha</a>( <a class="var it1545" onMouseOver="hilite(1545)" onMouseOut="lolite()" onClick="logVariable('srcImg')" href="../../../../_variables/srcImg.html">$srcImg</a>, true );
<a name="l514"><span class="linenum"> 514</span></a>              }
<a name="l515"><span class="linenum"> 515</span></a>              return <a class="var it1545" onMouseOver="hilite(1545)" onMouseOut="lolite()" onClick="logVariable('srcImg')" href="../../../../_variables/srcImg.html">$srcImg</a>;
<a name="l516"><span class="linenum"> 516</span></a>          }
<a name="l517"><span class="linenum"> 517</span></a>  
<a name="l518"><span class="linenum"> 518</span></a>  <span class="comment">        // Convert the angle to radians</span>
<a name="l519"><span class="linenum"> 519</span></a>          <a class="var it1549" onMouseOver="hilite(1549)" onMouseOut="lolite()" onClick="logVariable('theta')" href="../../../../_variables/theta.html">$theta</a> = <a class="phpfunction" onClick="logFunction('deg2rad')" href="../../../../_functions/deg2rad.html" onMouseOver="phpfuncPopup(event,'deg2rad')">deg2rad</a>( <a class="var it1546" onMouseOver="hilite(1546)" onMouseOut="lolite()" onClick="logVariable('angle')" href="../../../../_variables/angle.html">$angle</a> );
<a name="l520"><span class="linenum"> 520</span></a>  
<a name="l521"><span class="linenum"> 521</span></a>  <span class="comment">        //Standart case of rotate</span>
<a name="l522"><span class="linenum"> 522</span></a>          if( ( <a class="phpfunction" onClick="logFunction('abs')" href="../../../../_functions/abs.html" onMouseOver="phpfuncPopup(event,'abs')">abs</a>( <a class="var it1546" onMouseOver="hilite(1546)" onMouseOut="lolite()" onClick="logVariable('angle')" href="../../../../_variables/angle.html">$angle</a> ) == 90 ) || ( <a class="phpfunction" onClick="logFunction('abs')" href="../../../../_functions/abs.html" onMouseOver="phpfuncPopup(event,'abs')">abs</a>( <a class="var it1546" onMouseOver="hilite(1546)" onMouseOut="lolite()" onClick="logVariable('angle')" href="../../../../_variables/angle.html">$angle</a> ) == 270) )
<a name="l523"><span class="linenum"> 523</span></a>          {
<a name="l524"><span class="linenum"> 524</span></a>              <a class="var it731" onMouseOver="hilite(731)" onMouseOut="lolite()" onClick="logVariable('width')" href="../../../../_variables/width.html">$width</a> = <a class="var it1551" onMouseOver="hilite(1551)" onMouseOut="lolite()" onClick="logVariable('srch')" href="../../../../_variables/srch.html">$srch</a>;
<a name="l525"><span class="linenum"> 525</span></a>              <a class="var it732" onMouseOver="hilite(732)" onMouseOut="lolite()" onClick="logVariable('height')" href="../../../../_variables/height.html">$height</a> = <a class="var it1550" onMouseOver="hilite(1550)" onMouseOut="lolite()" onClick="logVariable('srcw')" href="../../../../_variables/srcw.html">$srcw</a>;
<a name="l526"><span class="linenum"> 526</span></a>              if( ( <a class="var it1546" onMouseOver="hilite(1546)" onMouseOut="lolite()" onClick="logVariable('angle')" href="../../../../_variables/angle.html">$angle</a> == 90 ) || ( <a class="var it1546" onMouseOver="hilite(1546)" onMouseOut="lolite()" onClick="logVariable('angle')" href="../../../../_variables/angle.html">$angle</a> == -270 ) )
<a name="l527"><span class="linenum"> 527</span></a>              {
<a name="l528"><span class="linenum"> 528</span></a>                  <a class="var it1552" onMouseOver="hilite(1552)" onMouseOut="lolite()" onClick="logVariable('minX')" href="../../../../_variables/minX.html">$minX</a> = 0;
<a name="l529"><span class="linenum"> 529</span></a>                  <a class="var it1553" onMouseOver="hilite(1553)" onMouseOut="lolite()" onClick="logVariable('maxX')" href="../../../../_variables/maxX.html">$maxX</a> = <a class="var it731" onMouseOver="hilite(731)" onMouseOut="lolite()" onClick="logVariable('width')" href="../../../../_variables/width.html">$width</a>;
<a name="l530"><span class="linenum"> 530</span></a>                  <a class="var it1554" onMouseOver="hilite(1554)" onMouseOut="lolite()" onClick="logVariable('minY')" href="../../../../_variables/minY.html">$minY</a> = -<a class="var it732" onMouseOver="hilite(732)" onMouseOut="lolite()" onClick="logVariable('height')" href="../../../../_variables/height.html">$height</a>+1;
<a name="l531"><span class="linenum"> 531</span></a>                  <a class="var it1555" onMouseOver="hilite(1555)" onMouseOut="lolite()" onClick="logVariable('maxY')" href="../../../../_variables/maxY.html">$maxY</a> = 1;
<a name="l532"><span class="linenum"> 532</span></a>              }
<a name="l533"><span class="linenum"> 533</span></a>              else if( ( <a class="var it1546" onMouseOver="hilite(1546)" onMouseOut="lolite()" onClick="logVariable('angle')" href="../../../../_variables/angle.html">$angle</a> == -90 ) || ( <a class="var it1546" onMouseOver="hilite(1546)" onMouseOut="lolite()" onClick="logVariable('angle')" href="../../../../_variables/angle.html">$angle</a> == 270 ) )
<a name="l534"><span class="linenum"> 534</span></a>              {
<a name="l535"><span class="linenum"> 535</span></a>                  <a class="var it1552" onMouseOver="hilite(1552)" onMouseOut="lolite()" onClick="logVariable('minX')" href="../../../../_variables/minX.html">$minX</a> = -<a class="var it731" onMouseOver="hilite(731)" onMouseOut="lolite()" onClick="logVariable('width')" href="../../../../_variables/width.html">$width</a>+1;
<a name="l536"><span class="linenum"> 536</span></a>                  <a class="var it1553" onMouseOver="hilite(1553)" onMouseOut="lolite()" onClick="logVariable('maxX')" href="../../../../_variables/maxX.html">$maxX</a> = 1;
<a name="l537"><span class="linenum"> 537</span></a>                  <a class="var it1554" onMouseOver="hilite(1554)" onMouseOut="lolite()" onClick="logVariable('minY')" href="../../../../_variables/minY.html">$minY</a> = 0;
<a name="l538"><span class="linenum"> 538</span></a>                  <a class="var it1555" onMouseOver="hilite(1555)" onMouseOut="lolite()" onClick="logVariable('maxY')" href="../../../../_variables/maxY.html">$maxY</a> = <a class="var it732" onMouseOver="hilite(732)" onMouseOut="lolite()" onClick="logVariable('height')" href="../../../../_variables/height.html">$height</a>;
<a name="l539"><span class="linenum"> 539</span></a>              }
<a name="l540"><span class="linenum"> 540</span></a>          }
<a name="l541"><span class="linenum"> 541</span></a>          else if( <a class="phpfunction" onClick="logFunction('abs')" href="../../../../_functions/abs.html" onMouseOver="phpfuncPopup(event,'abs')">abs</a>( <a class="var it1546" onMouseOver="hilite(1546)" onMouseOut="lolite()" onClick="logVariable('angle')" href="../../../../_variables/angle.html">$angle</a> ) === 180 )
<a name="l542"><span class="linenum"> 542</span></a>          {
<a name="l543"><span class="linenum"> 543</span></a>              <a class="var it731" onMouseOver="hilite(731)" onMouseOut="lolite()" onClick="logVariable('width')" href="../../../../_variables/width.html">$width</a> = <a class="var it1550" onMouseOver="hilite(1550)" onMouseOut="lolite()" onClick="logVariable('srcw')" href="../../../../_variables/srcw.html">$srcw</a>;
<a name="l544"><span class="linenum"> 544</span></a>              <a class="var it732" onMouseOver="hilite(732)" onMouseOut="lolite()" onClick="logVariable('height')" href="../../../../_variables/height.html">$height</a> = <a class="var it1551" onMouseOver="hilite(1551)" onMouseOut="lolite()" onClick="logVariable('srch')" href="../../../../_variables/srch.html">$srch</a>;
<a name="l545"><span class="linenum"> 545</span></a>              <a class="var it1552" onMouseOver="hilite(1552)" onMouseOut="lolite()" onClick="logVariable('minX')" href="../../../../_variables/minX.html">$minX</a> = -<a class="var it731" onMouseOver="hilite(731)" onMouseOut="lolite()" onClick="logVariable('width')" href="../../../../_variables/width.html">$width</a>+1;
<a name="l546"><span class="linenum"> 546</span></a>              <a class="var it1553" onMouseOver="hilite(1553)" onMouseOut="lolite()" onClick="logVariable('maxX')" href="../../../../_variables/maxX.html">$maxX</a> = 1;
<a name="l547"><span class="linenum"> 547</span></a>              <a class="var it1554" onMouseOver="hilite(1554)" onMouseOut="lolite()" onClick="logVariable('minY')" href="../../../../_variables/minY.html">$minY</a> = -<a class="var it732" onMouseOver="hilite(732)" onMouseOut="lolite()" onClick="logVariable('height')" href="../../../../_variables/height.html">$height</a>+1;
<a name="l548"><span class="linenum"> 548</span></a>              <a class="var it1555" onMouseOver="hilite(1555)" onMouseOut="lolite()" onClick="logVariable('maxY')" href="../../../../_variables/maxY.html">$maxY</a> = 1;
<a name="l549"><span class="linenum"> 549</span></a>          }
<a name="l550"><span class="linenum"> 550</span></a>          else
<a name="l551"><span class="linenum"> 551</span></a>          {
<a name="l552"><span class="linenum"> 552</span></a>  <span class="comment">            // Calculate the width of the destination image.</span>
<a name="l553"><span class="linenum"> 553</span></a>              <a class="var it1556" onMouseOver="hilite(1556)" onMouseOut="lolite()" onClick="logVariable('temp')" href="../../../../_variables/temp.html">$temp</a> = array( <a class="function" onClick="logFunction('rotateX')" href="../../../../_functions/rotatex.html" onMouseOver="funcPopup(event,'rotatex')">rotateX</a>( 0, 0, 0-<a class="var it1549" onMouseOver="hilite(1549)" onMouseOut="lolite()" onClick="logVariable('theta')" href="../../../../_variables/theta.html">$theta</a> ),
<a name="l554"><span class="linenum"> 554</span></a>                      <a class="function" onClick="logFunction('rotateX')" href="../../../../_functions/rotatex.html" onMouseOver="funcPopup(event,'rotatex')">rotateX</a>( <a class="var it1550" onMouseOver="hilite(1550)" onMouseOut="lolite()" onClick="logVariable('srcw')" href="../../../../_variables/srcw.html">$srcw</a>, 0, 0-<a class="var it1549" onMouseOver="hilite(1549)" onMouseOut="lolite()" onClick="logVariable('theta')" href="../../../../_variables/theta.html">$theta</a> ),
<a name="l555"><span class="linenum"> 555</span></a>                      <a class="function" onClick="logFunction('rotateX')" href="../../../../_functions/rotatex.html" onMouseOver="funcPopup(event,'rotatex')">rotateX</a>( 0, <a class="var it1551" onMouseOver="hilite(1551)" onMouseOut="lolite()" onClick="logVariable('srch')" href="../../../../_variables/srch.html">$srch</a>, 0-<a class="var it1549" onMouseOver="hilite(1549)" onMouseOut="lolite()" onClick="logVariable('theta')" href="../../../../_variables/theta.html">$theta</a> ),
<a name="l556"><span class="linenum"> 556</span></a>                      <a class="function" onClick="logFunction('rotateX')" href="../../../../_functions/rotatex.html" onMouseOver="funcPopup(event,'rotatex')">rotateX</a>( <a class="var it1550" onMouseOver="hilite(1550)" onMouseOut="lolite()" onClick="logVariable('srcw')" href="../../../../_variables/srcw.html">$srcw</a>, <a class="var it1551" onMouseOver="hilite(1551)" onMouseOut="lolite()" onClick="logVariable('srch')" href="../../../../_variables/srch.html">$srch</a>, 0-<a class="var it1549" onMouseOver="hilite(1549)" onMouseOut="lolite()" onClick="logVariable('theta')" href="../../../../_variables/theta.html">$theta</a> )
<a name="l557"><span class="linenum"> 557</span></a>                  );
<a name="l558"><span class="linenum"> 558</span></a>              <a class="var it1552" onMouseOver="hilite(1552)" onMouseOut="lolite()" onClick="logVariable('minX')" href="../../../../_variables/minX.html">$minX</a> = <a class="phpfunction" onClick="logFunction('floor')" href="../../../../_functions/floor.html" onMouseOver="phpfuncPopup(event,'floor')">floor</a>( <a class="phpfunction" onClick="logFunction('min')" href="../../../../_functions/min.html" onMouseOver="phpfuncPopup(event,'min')">min</a>( <a class="var it1556" onMouseOver="hilite(1556)" onMouseOut="lolite()" onClick="logVariable('temp')" href="../../../../_variables/temp.html">$temp</a> ) );
<a name="l559"><span class="linenum"> 559</span></a>              <a class="var it1553" onMouseOver="hilite(1553)" onMouseOut="lolite()" onClick="logVariable('maxX')" href="../../../../_variables/maxX.html">$maxX</a> = <a class="phpfunction" onClick="logFunction('ceil')" href="../../../../_functions/ceil.html" onMouseOver="phpfuncPopup(event,'ceil')">ceil</a>( <a class="phpfunction" onClick="logFunction('max')" href="../../../../_functions/max.html" onMouseOver="phpfuncPopup(event,'max')">max</a>( <a class="var it1556" onMouseOver="hilite(1556)" onMouseOut="lolite()" onClick="logVariable('temp')" href="../../../../_variables/temp.html">$temp</a> ) );
<a name="l560"><span class="linenum"> 560</span></a>              <a class="var it731" onMouseOver="hilite(731)" onMouseOut="lolite()" onClick="logVariable('width')" href="../../../../_variables/width.html">$width</a> = <a class="var it1553" onMouseOver="hilite(1553)" onMouseOut="lolite()" onClick="logVariable('maxX')" href="../../../../_variables/maxX.html">$maxX</a> - <a class="var it1552" onMouseOver="hilite(1552)" onMouseOut="lolite()" onClick="logVariable('minX')" href="../../../../_variables/minX.html">$minX</a>;
<a name="l561"><span class="linenum"> 561</span></a>  
<a name="l562"><span class="linenum"> 562</span></a>  <span class="comment">            // Calculate the height of the destination image.</span>
<a name="l563"><span class="linenum"> 563</span></a>              <a class="var it1556" onMouseOver="hilite(1556)" onMouseOut="lolite()" onClick="logVariable('temp')" href="../../../../_variables/temp.html">$temp</a> = array( <a class="function" onClick="logFunction('rotateY')" href="../../../../_functions/rotatey.html" onMouseOver="funcPopup(event,'rotatey')">rotateY</a>( 0, 0, 0-<a class="var it1549" onMouseOver="hilite(1549)" onMouseOut="lolite()" onClick="logVariable('theta')" href="../../../../_variables/theta.html">$theta</a> ),
<a name="l564"><span class="linenum"> 564</span></a>                      <a class="function" onClick="logFunction('rotateY')" href="../../../../_functions/rotatey.html" onMouseOver="funcPopup(event,'rotatey')">rotateY</a>( <a class="var it1550" onMouseOver="hilite(1550)" onMouseOut="lolite()" onClick="logVariable('srcw')" href="../../../../_variables/srcw.html">$srcw</a>, 0, 0-<a class="var it1549" onMouseOver="hilite(1549)" onMouseOut="lolite()" onClick="logVariable('theta')" href="../../../../_variables/theta.html">$theta</a> ),
<a name="l565"><span class="linenum"> 565</span></a>                      <a class="function" onClick="logFunction('rotateY')" href="../../../../_functions/rotatey.html" onMouseOver="funcPopup(event,'rotatey')">rotateY</a>( 0, <a class="var it1551" onMouseOver="hilite(1551)" onMouseOut="lolite()" onClick="logVariable('srch')" href="../../../../_variables/srch.html">$srch</a>, 0-<a class="var it1549" onMouseOver="hilite(1549)" onMouseOut="lolite()" onClick="logVariable('theta')" href="../../../../_variables/theta.html">$theta</a> ),
<a name="l566"><span class="linenum"> 566</span></a>                      <a class="function" onClick="logFunction('rotateY')" href="../../../../_functions/rotatey.html" onMouseOver="funcPopup(event,'rotatey')">rotateY</a>( <a class="var it1550" onMouseOver="hilite(1550)" onMouseOut="lolite()" onClick="logVariable('srcw')" href="../../../../_variables/srcw.html">$srcw</a>, <a class="var it1551" onMouseOver="hilite(1551)" onMouseOut="lolite()" onClick="logVariable('srch')" href="../../../../_variables/srch.html">$srch</a>, 0-<a class="var it1549" onMouseOver="hilite(1549)" onMouseOut="lolite()" onClick="logVariable('theta')" href="../../../../_variables/theta.html">$theta</a> )
<a name="l567"><span class="linenum"> 567</span></a>                  );
<a name="l568"><span class="linenum"> 568</span></a>              <a class="var it1554" onMouseOver="hilite(1554)" onMouseOut="lolite()" onClick="logVariable('minY')" href="../../../../_variables/minY.html">$minY</a> = <a class="phpfunction" onClick="logFunction('floor')" href="../../../../_functions/floor.html" onMouseOver="phpfuncPopup(event,'floor')">floor</a>( <a class="phpfunction" onClick="logFunction('min')" href="../../../../_functions/min.html" onMouseOver="phpfuncPopup(event,'min')">min</a>( <a class="var it1556" onMouseOver="hilite(1556)" onMouseOut="lolite()" onClick="logVariable('temp')" href="../../../../_variables/temp.html">$temp</a> ) );
<a name="l569"><span class="linenum"> 569</span></a>              <a class="var it1555" onMouseOver="hilite(1555)" onMouseOut="lolite()" onClick="logVariable('maxY')" href="../../../../_variables/maxY.html">$maxY</a> = <a class="phpfunction" onClick="logFunction('ceil')" href="../../../../_functions/ceil.html" onMouseOver="phpfuncPopup(event,'ceil')">ceil</a>( <a class="phpfunction" onClick="logFunction('max')" href="../../../../_functions/max.html" onMouseOver="phpfuncPopup(event,'max')">max</a>( <a class="var it1556" onMouseOver="hilite(1556)" onMouseOut="lolite()" onClick="logVariable('temp')" href="../../../../_variables/temp.html">$temp</a> ) );
<a name="l570"><span class="linenum"> 570</span></a>              <a class="var it732" onMouseOver="hilite(732)" onMouseOut="lolite()" onClick="logVariable('height')" href="../../../../_variables/height.html">$height</a> = <a class="var it1555" onMouseOver="hilite(1555)" onMouseOut="lolite()" onClick="logVariable('maxY')" href="../../../../_variables/maxY.html">$maxY</a> - <a class="var it1554" onMouseOver="hilite(1554)" onMouseOut="lolite()" onClick="logVariable('minY')" href="../../../../_variables/minY.html">$minY</a>;
<a name="l571"><span class="linenum"> 571</span></a>          }
<a name="l572"><span class="linenum"> 572</span></a>  
<a name="l573"><span class="linenum"> 573</span></a>          <a class="var it1557" onMouseOver="hilite(1557)" onMouseOut="lolite()" onClick="logVariable('destimg')" href="../../../../_variables/destimg.html">$destimg</a> = <a class="phpfunction" onClick="logFunction('imagecreatetruecolor')" href="../../../../_functions/imagecreatetruecolor.html" onMouseOver="phpfuncPopup(event,'imagecreatetruecolor')">imagecreatetruecolor</a>( <a class="var it731" onMouseOver="hilite(731)" onMouseOut="lolite()" onClick="logVariable('width')" href="../../../../_variables/width.html">$width</a>, <a class="var it732" onMouseOver="hilite(732)" onMouseOut="lolite()" onClick="logVariable('height')" href="../../../../_variables/height.html">$height</a> );
<a name="l574"><span class="linenum"> 574</span></a>          if( <a class="var it1548" onMouseOver="hilite(1548)" onMouseOut="lolite()" onClick="logVariable('ignore_transparent')" href="../../../../_variables/ignore_transparent.html">$ignore_transparent</a> == 0 )
<a name="l575"><span class="linenum"> 575</span></a>          {
<a name="l576"><span class="linenum"> 576</span></a>              <a class="phpfunction" onClick="logFunction('imagefill')" href="../../../../_functions/imagefill.html" onMouseOver="phpfuncPopup(event,'imagefill')">imagefill</a>( <a class="var it1557" onMouseOver="hilite(1557)" onMouseOut="lolite()" onClick="logVariable('destimg')" href="../../../../_variables/destimg.html">$destimg</a>, 0, 0, <a class="phpfunction" onClick="logFunction('imagecolorallocatealpha')" href="../../../../_functions/imagecolorallocatealpha.html" onMouseOver="phpfuncPopup(event,'imagecolorallocatealpha')">imagecolorallocatealpha</a>( <a class="var it1557" onMouseOver="hilite(1557)" onMouseOut="lolite()" onClick="logVariable('destimg')" href="../../../../_variables/destimg.html">$destimg</a>, 255,255, 255, 127 ) );
<a name="l577"><span class="linenum"> 577</span></a>              <a class="phpfunction" onClick="logFunction('imagesavealpha')" href="../../../../_functions/imagesavealpha.html" onMouseOver="phpfuncPopup(event,'imagesavealpha')">imagesavealpha</a>( <a class="var it1557" onMouseOver="hilite(1557)" onMouseOut="lolite()" onClick="logVariable('destimg')" href="../../../../_variables/destimg.html">$destimg</a>, true );
<a name="l578"><span class="linenum"> 578</span></a>          }
<a name="l579"><span class="linenum"> 579</span></a>  
<a name="l580"><span class="linenum"> 580</span></a>  <span class="comment">        // sets all pixels in the new image</span>
<a name="l581"><span class="linenum"> 581</span></a>          for( <a class="var it1508" onMouseOver="hilite(1508)" onMouseOut="lolite()" onClick="logVariable('x')" href="../../../../_variables/x.html">$x</a> = <a class="var it1552" onMouseOver="hilite(1552)" onMouseOut="lolite()" onClick="logVariable('minX')" href="../../../../_variables/minX.html">$minX</a>; <a class="var it1508" onMouseOver="hilite(1508)" onMouseOut="lolite()" onClick="logVariable('x')" href="../../../../_variables/x.html">$x</a> &lt; <a class="var it1553" onMouseOver="hilite(1553)" onMouseOut="lolite()" onClick="logVariable('maxX')" href="../../../../_variables/maxX.html">$maxX</a>; <a class="var it1508" onMouseOver="hilite(1508)" onMouseOut="lolite()" onClick="logVariable('x')" href="../../../../_variables/x.html">$x</a>++ )
<a name="l582"><span class="linenum"> 582</span></a>          {
<a name="l583"><span class="linenum"> 583</span></a>              for( <a class="var it1507" onMouseOver="hilite(1507)" onMouseOut="lolite()" onClick="logVariable('y')" href="../../../../_variables/y.html">$y</a> = <a class="var it1554" onMouseOver="hilite(1554)" onMouseOut="lolite()" onClick="logVariable('minY')" href="../../../../_variables/minY.html">$minY</a>; <a class="var it1507" onMouseOver="hilite(1507)" onMouseOut="lolite()" onClick="logVariable('y')" href="../../../../_variables/y.html">$y</a> &lt; <a class="var it1555" onMouseOver="hilite(1555)" onMouseOut="lolite()" onClick="logVariable('maxY')" href="../../../../_variables/maxY.html">$maxY</a>; <a class="var it1507" onMouseOver="hilite(1507)" onMouseOut="lolite()" onClick="logVariable('y')" href="../../../../_variables/y.html">$y</a>++ )
<a name="l584"><span class="linenum"> 584</span></a>              {
<a name="l585"><span class="linenum"> 585</span></a>  <span class="comment">                // fetch corresponding pixel from the source image</span>
<a name="l586"><span class="linenum"> 586</span></a>                  <a class="var it1558" onMouseOver="hilite(1558)" onMouseOut="lolite()" onClick="logVariable('srcX')" href="../../../../_variables/srcX.html">$srcX</a> = <a class="phpfunction" onClick="logFunction('round')" href="../../../../_functions/round.html" onMouseOver="phpfuncPopup(event,'round')">round</a>( <a class="function" onClick="logFunction('rotateX')" href="../../../../_functions/rotatex.html" onMouseOver="funcPopup(event,'rotatex')">rotateX</a>( <a class="var it1508" onMouseOver="hilite(1508)" onMouseOut="lolite()" onClick="logVariable('x')" href="../../../../_variables/x.html">$x</a>, <a class="var it1507" onMouseOver="hilite(1507)" onMouseOut="lolite()" onClick="logVariable('y')" href="../../../../_variables/y.html">$y</a>, <a class="var it1549" onMouseOver="hilite(1549)" onMouseOut="lolite()" onClick="logVariable('theta')" href="../../../../_variables/theta.html">$theta</a> ) );
<a name="l587"><span class="linenum"> 587</span></a>                  <a class="var it1559" onMouseOver="hilite(1559)" onMouseOut="lolite()" onClick="logVariable('srcY')" href="../../../../_variables/srcY.html">$srcY</a> = <a class="phpfunction" onClick="logFunction('round')" href="../../../../_functions/round.html" onMouseOver="phpfuncPopup(event,'round')">round</a>( <a class="function" onClick="logFunction('rotateY')" href="../../../../_functions/rotatey.html" onMouseOver="funcPopup(event,'rotatey')">rotateY</a>( <a class="var it1508" onMouseOver="hilite(1508)" onMouseOut="lolite()" onClick="logVariable('x')" href="../../../../_variables/x.html">$x</a>, <a class="var it1507" onMouseOver="hilite(1507)" onMouseOut="lolite()" onClick="logVariable('y')" href="../../../../_variables/y.html">$y</a>, <a class="var it1549" onMouseOver="hilite(1549)" onMouseOut="lolite()" onClick="logVariable('theta')" href="../../../../_variables/theta.html">$theta</a> ) );
<a name="l588"><span class="linenum"> 588</span></a>                  if( <a class="var it1558" onMouseOver="hilite(1558)" onMouseOut="lolite()" onClick="logVariable('srcX')" href="../../../../_variables/srcX.html">$srcX</a> &gt;= 0 &amp;&amp; <a class="var it1558" onMouseOver="hilite(1558)" onMouseOut="lolite()" onClick="logVariable('srcX')" href="../../../../_variables/srcX.html">$srcX</a> &lt; <a class="var it1550" onMouseOver="hilite(1550)" onMouseOut="lolite()" onClick="logVariable('srcw')" href="../../../../_variables/srcw.html">$srcw</a> &amp;&amp; <a class="var it1559" onMouseOver="hilite(1559)" onMouseOut="lolite()" onClick="logVariable('srcY')" href="../../../../_variables/srcY.html">$srcY</a> &gt;= 0 &amp;&amp; <a class="var it1559" onMouseOver="hilite(1559)" onMouseOut="lolite()" onClick="logVariable('srcY')" href="../../../../_variables/srcY.html">$srcY</a> &lt; <a class="var it1551" onMouseOver="hilite(1551)" onMouseOut="lolite()" onClick="logVariable('srch')" href="../../../../_variables/srch.html">$srch</a> )
<a name="l589"><span class="linenum"> 589</span></a>                  {
<a name="l590"><span class="linenum"> 590</span></a>                      <a class="var it1560" onMouseOver="hilite(1560)" onMouseOut="lolite()" onClick="logVariable('color')" href="../../../../_variables/color.html">$color</a> = <a class="phpfunction" onClick="logFunction('imagecolorat')" href="../../../../_functions/imagecolorat.html" onMouseOver="phpfuncPopup(event,'imagecolorat')">imagecolorat</a>( <a class="var it1545" onMouseOver="hilite(1545)" onMouseOut="lolite()" onClick="logVariable('srcImg')" href="../../../../_variables/srcImg.html">$srcImg</a>, <a class="var it1558" onMouseOver="hilite(1558)" onMouseOut="lolite()" onClick="logVariable('srcX')" href="../../../../_variables/srcX.html">$srcX</a>, <a class="var it1559" onMouseOver="hilite(1559)" onMouseOut="lolite()" onClick="logVariable('srcY')" href="../../../../_variables/srcY.html">$srcY</a> );
<a name="l591"><span class="linenum"> 591</span></a>                  }
<a name="l592"><span class="linenum"> 592</span></a>                  else
<a name="l593"><span class="linenum"> 593</span></a>                  {
<a name="l594"><span class="linenum"> 594</span></a>                      <a class="var it1560" onMouseOver="hilite(1560)" onMouseOut="lolite()" onClick="logVariable('color')" href="../../../../_variables/color.html">$color</a> = <a class="var it1547" onMouseOver="hilite(1547)" onMouseOut="lolite()" onClick="logVariable('bgcolor')" href="../../../../_variables/bgcolor.html">$bgcolor</a>;
<a name="l595"><span class="linenum"> 595</span></a>                  }
<a name="l596"><span class="linenum"> 596</span></a>                  <a class="phpfunction" onClick="logFunction('imagesetpixel')" href="../../../../_functions/imagesetpixel.html" onMouseOver="phpfuncPopup(event,'imagesetpixel')">imagesetpixel</a>( <a class="var it1557" onMouseOver="hilite(1557)" onMouseOut="lolite()" onClick="logVariable('destimg')" href="../../../../_variables/destimg.html">$destimg</a>, <a class="var it1508" onMouseOver="hilite(1508)" onMouseOut="lolite()" onClick="logVariable('x')" href="../../../../_variables/x.html">$x</a>-<a class="var it1552" onMouseOver="hilite(1552)" onMouseOut="lolite()" onClick="logVariable('minX')" href="../../../../_variables/minX.html">$minX</a>, <a class="var it1507" onMouseOver="hilite(1507)" onMouseOut="lolite()" onClick="logVariable('y')" href="../../../../_variables/y.html">$y</a>-<a class="var it1554" onMouseOver="hilite(1554)" onMouseOut="lolite()" onClick="logVariable('minY')" href="../../../../_variables/minY.html">$minY</a>, <a class="var it1560" onMouseOver="hilite(1560)" onMouseOut="lolite()" onClick="logVariable('color')" href="../../../../_variables/color.html">$color</a> );
<a name="l597"><span class="linenum"> 597</span></a>              }
<a name="l598"><span class="linenum"> 598</span></a>          }
<a name="l599"><span class="linenum"> 599</span></a>          return <a class="var it1557" onMouseOver="hilite(1557)" onMouseOut="lolite()" onClick="logVariable('destimg')" href="../../../../_variables/destimg.html">$destimg</a>;
<a name="l600"><span class="linenum"> 600</span></a>      }
<a name="l601"><span class="linenum"> 601</span></a>  }
<a name="l602"><span class="linenum"> 602</span></a>  
<a name="l603"><span class="linenum"> 603</span></a>  ?&gt;
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'get_available_thumb_sizes': ['get_available_thumb_sizes', 'Get available thumbnail sizes ', [['blogs/inc/files/model','_image.funcs.php',32]], 16],
'get_extensions': ['get_extensions', 'Get list of extensions for this filetype. The first is being considered the default / most appropriate one. ', [['blogs/inc/files/model','_filetype.class.php',192]], 4],
'output_image': ['output_image', 'Output an image from memory to web client ', [['blogs/inc/files/model','_image.funcs.php',299]], 0],
'rm_cache': ['rm_cache', 'Delete cache for a file ', [['blogs/inc/files/model','_file.class.php',2221]], 7],
'imagerotate': ['imagerotate', 'Imagerotate replacement. ignore_transparent is work for png images Also, have some standard functions for 90, 180 and 270 degrees. ', [['blogs/inc/files/model','_image.funcs.php',488]], 4],
'rotatex': ['rotatex', '', [['blogs/inc/files/model','_image.funcs.php',494]], 5],
'error': ['error', '', [['blogs/plugins/tinymce_plugin/tiny_mce','tiny_mce_src.js',8636],['blogs/plugins/tinymce_plugin/tiny_mce/plugins/spellchecker/includes','general.php',77],['blogs/plugins/tinymce_plugin/tiny_mce/plugins/spellchecker/classes/utils','Logger.php',156]], 81],
'load_image': ['load_image', 'Load an image from a file into memory ', [['blogs/inc/files/model','_image.funcs.php',148]], 3],
'get_full_path': ['get_full_path', 'Get the full path (directory and name) to the file. ', [['blogs/inc/files/model','_file.class.php',615]], 44],
'crop_to_constraint': ['crop_to_constraint', 'Crop dimensions to fit into a constrained size, while preserving aspect ratio. ', [['blogs/inc/files/model','_image.funcs.php',58]], 1],
'rotatey': ['rotatey', '', [['blogs/inc/files/model','_image.funcs.php',498]], 5],
'load_funcs': ['load_funcs', '', [['blogs/inc/_core','_misc.funcs.php',115]], 214],
'pixelblur': ['pixelblur', 'Apply blur effect ', [['blogs/inc/files/model','_image.funcs.php',404]], 1],
'save_image': ['save_image', 'Output an image from memory to web client ', [['blogs/inc/files/model','_image.funcs.php',230]], 5],
'get': ['get', '', [['blogs/plugins/tinymce_plugin/tiny_mce','tiny_mce_src.js',941],['blogs/plugins/tinymce_plugin/tiny_mce','tiny_mce_src.js',15011],['blogs/plugins/tinymce_plugin/tiny_mce/plugins/media/js','media.js',7],['blogs/inc/links/model','_linkowner.class.php',221],['blogs/inc/_core/model/db','_sql.class.php',64],['blogs/inc/plugins/model','_pluginsettings.class.php',58],['blogs/inc/collections/model','_blog.class.php',1822],['blogs/inc/settings/model','_generalsettings.class.php',383],['blogs/inc/settings/model','_abstractsettings.class.php',271],['blogs/inc/plugins/model','_pluginusersettings.class.php',58],['blogs/inc/users/model','_user.class.php',1126],['blogs/plugins/tinymce_plugin/tiny_mce','tiny_mce_gzip.js',38],['blogs/inc/users/model','_usersettings.class.php',151],['blogs/inc/comments/model','_comment.class.php',301],['blogs/inc/users/model','_groupsettings.class.php',124],['blogs/inc/cron/model','_cronjob.class.php',104],['blogs/inc/items/model','_item.class.php',5742],['blogs/inc/sessions/model','_session.class.php',397],['blogs/inc/links/model','_linkuser.class.php',141],['blogs/inc/links/model','_linkitem.class.php',155],['blogs/inc/slugs/model','_slug.class.php',68],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',574],['blogs/plugins/twitter_plugin/twitteroauth','twitteroauth.php',146],['blogs/inc/antispam/model','_iprange.class.php',69],['blogs/inc/links/model','_linkcomment.class.php',132],['blogs/inc/files/model','_file.class.php',532]], 2417],
'generate_thumb': ['generate_thumb', 'Generate a thumbnail ', [['blogs/inc/files/model','_image.funcs.php',336]], 2],
'system_check_memory_limit': ['system_check_memory_limit', '', [['blogs/inc/tools/model','_system.funcs.php',450]], 5],
'list': ['list', '', [['blogs/rsc/js/bootstrap','typeahead.bundle.js',156]], 95],
'scale_to_constraint': ['scale_to_constraint', 'Scale dimensions to fit into a constrained size, while preserving aspect ratio. ', [['blogs/inc/files/model','_image.funcs.php',96]], 2],
'rotate_image': ['rotate_image', 'Rotate image ', [['blogs/inc/files/model','_image.funcs.php',438]], 2],
'fit_into_constraint': ['fit_into_constraint', 'Scale dimensions to fit into a constrained size, while preserving aspect ratio. The scaling only happens if the source is larger than the constraint. ', [['blogs/inc/files/model','_image.funcs.php',128]], 0],
'array_shift': ['array_shift', '', [], 51],
'octdec': ['octdec', '', [], 11],
'getimagesize': ['getimagesize', '', [], 9],
'imagecreatetruecolor': ['imagecreatetruecolor', '', [], 5],
'deg2rad': ['deg2rad', '', [], 1],
'floor': ['floor', '', [], 79],
'intval': ['intval', '', [], 127],
'imagejpeg': ['imagejpeg', '', [], 2],
'substr': ['substr', '', [], 657],
'imagesy': ['imagesy', '', [], 6],
'ceil': ['ceil', '', [], 36],
'function_exists': ['function_exists', '', [], 130],
'trigger_error': ['trigger_error', '', [], 17],
'sin': ['sin', '', [], 9],
'cos': ['cos', '', [], 8],
'imageinterlace': ['imageinterlace', '', [], 2],
'imagecolorallocatealpha': ['imagecolorallocatealpha', '', [], 3],
'memory_get_usage': ['memory_get_usage', '', [], 3],
'pow': ['pow', '', [], 23],
'imagecopyresampled': ['imagecopyresampled', '', [], 4],
'max': ['max', '', [], 97],
'pathinfo': ['pathinfo', '', [], 11],
'header': ['header', '', [], 85],
'error_log': ['error_log', '', [], 54],
'imagecolorat': ['imagecolorat', '', [], 1],
'imagecolortransparent': ['imagecolortransparent', '', [], 2],
'imagefill': ['imagefill', '', [], 3],
'defined': ['defined', '', [], 874],
'imagesavealpha': ['imagesavealpha', '', [], 4],
'imagesx': ['imagesx', '', [], 6],
'chmod': ['chmod', '', [], 35],
'round': ['round', '', [], 59],
'imagesetpixel': ['imagesetpixel', '', [], 1],
'imagerotate': ['imagerotate', '', [], 4],
'imagegif': ['imagegif', '', [], 2],
'imagepng': ['imagepng', '', [], 2],
'imagefilter': ['imagefilter', '', [], 1],
'imagealphablending': ['imagealphablending', '', [], 2],
'abs': ['abs', '', [], 48],
'min': ['min', '', [], 79]};
CLASS_DATA={
};
CONST_DATA={
'EVO_MAIN_INIT': ['EVO_MAIN_INIT', '', [['blogs/inc','_main.inc.php',55],['blogs/install','index.php',25],['blogs/install','debug.php',22]], 827]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Sat Jul  5 12:18:44 2014</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>

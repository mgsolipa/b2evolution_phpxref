<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /blogs/inc/messaging/model/_message.class.php source</title>
    <link rel="stylesheet" href="../../../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Sat Jul  5 12:18:44 2014 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../../../';
subdir='blogs/inc/messaging/model';
filename='_message.class.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/blogs/inc/messaging/model/</a> -> <a href="_message.class.php.html">_message.class.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="_message.class.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="_message.class.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">/**</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment"> * This file is part of b2evolution - {@link http://b2evolution.net/}</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment"> * See also {@link http://sourceforge.net/projects/evocms/}.</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment"> *</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment"> * @copyright (c)2009-2014 by Francois PLANQUE - {@link http://fplanque.net/}</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment"> * Parts of this file are copyright (c)2009 by The Evo Factory - {@link http://www.evofactory.com/}.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment"> *</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment"> * Released under GNU GPL License - {@link http://b2evolution.net/about/license.html}</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment"> *</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment"> * {@internal Open Source relicensing agreement:</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment"> * The Evo Factory grants Francois PLANQUE the right to license</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment"> * The Evo Factory's contributions to this file and the b2evolution project</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment"> * under any OSI approved OSS license (http://www.opensource.org/licenses/).</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment"> * }}</span>
<a name="l16"><span class="linenum">  16</span></a>  <span class="comment"> *</span>
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment"> * @package messaging</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> *</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> * {@internal Below is a list of authors who have contributed to design/coding of this file: }}</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * @author efy-maxim: Evo Factory / Maxim.</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * @author fplanque: Francois Planque.</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> *</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> * @version $Id: _message.class.php 6135 2014-03-08 07:54:05Z manuel $</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> */</span>
<a name="l25"><span class="linenum">  25</span></a>  if( !<a class="phpfunction" onClick="logFunction('defined')" href="../../../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('EVO_MAIN_INIT')" href="../../../../_constants/EVO_MAIN_INIT.html" onMouseOver="constPopup(event,'EVO_MAIN_INIT')">EVO_MAIN_INIT</a>') ) die( 'Please, do not access this page directly.' );
<a name="l26"><span class="linenum">  26</span></a>  
<a name="l27"><span class="linenum">  27</span></a>  <a class="function" onClick="logFunction('load_class')" href="../../../../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( '_core/model/dataobjects/_dataobject.class.php', 'DataObject' );
<a name="l28"><span class="linenum">  28</span></a>  
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment">/**</span>
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment"> * Message Class</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment"> *</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> */</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('Message')" href="../../../../_classes/message.html" onMouseOver="classPopup(event,'message')">Message</a> <span class="keyword">extends</span> <a class="class" onClick="logClass('DataObject')" href="../../../../_classes/dataobject.html" onMouseOver="classPopup(event,'dataobject')">DataObject</a>
<a name="l34"><span class="linenum">  34</span></a>  {
<a name="l35"><span class="linenum">  35</span></a>      <span class="comment">/**</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment">     * Available message statuses constants</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment">     *</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment">     * @internal Tblue&gt; Class constants are PHP5-only!</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="comment">     */</span>
<a name="l40"><span class="linenum">  40</span></a>      var <a class="var it1804" onMouseOver="hilite(1804)" onMouseOut="lolite()" onClick="logVariable('AUTHOR')" href="../../../../_variables/AUTHOR.html">$AUTHOR</a> = 0;
<a name="l41"><span class="linenum">  41</span></a>      var <a class="var it1805" onMouseOver="hilite(1805)" onMouseOut="lolite()" onClick="logVariable('READ')" href="../../../../_variables/READ.html">$READ</a> = 1;
<a name="l42"><span class="linenum">  42</span></a>      var <a class="var it1806" onMouseOver="hilite(1806)" onMouseOut="lolite()" onClick="logVariable('UNREAD')" href="../../../../_variables/UNREAD.html">$UNREAD</a> = 2;
<a name="l43"><span class="linenum">  43</span></a>  
<a name="l44"><span class="linenum">  44</span></a>      var <a class="var it1807" onMouseOver="hilite(1807)" onMouseOut="lolite()" onClick="logVariable('thread_ID')" href="../../../../_variables/thread_ID.html">$thread_ID</a>;
<a name="l45"><span class="linenum">  45</span></a>      var <a class="var it1808" onMouseOver="hilite(1808)" onMouseOut="lolite()" onClick="logVariable('author_user_ID')" href="../../../../_variables/author_user_ID.html">$author_user_ID</a>;
<a name="l46"><span class="linenum">  46</span></a>      var <a class="var it1628" onMouseOver="hilite(1628)" onMouseOut="lolite()" onClick="logVariable('author_name')" href="../../../../_variables/author_name.html">$author_name</a> = '';
<a name="l47"><span class="linenum">  47</span></a>      var <a class="var it1237" onMouseOver="hilite(1237)" onMouseOut="lolite()" onClick="logVariable('datetime')" href="../../../../_variables/datetime.html">$datetime</a> = '';
<a name="l48"><span class="linenum">  48</span></a>  
<a name="l49"><span class="linenum">  49</span></a>      <span class="comment">/**</span>
<a name="l50"><span class="linenum">  50</span></a>  <span class="comment">     * The content of the message</span>
<a name="l51"><span class="linenum">  51</span></a>  <span class="comment">     * WARNING: It may contains MALICIOUS HTML and javascript snippets. They must ALWAYS be ESCAPED prior to display!</span>
<a name="l52"><span class="linenum">  52</span></a>  <span class="comment">     * </span>
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment">     * @var string</span>
<a name="l54"><span class="linenum">  54</span></a>  <span class="comment">     */</span>
<a name="l55"><span class="linenum">  55</span></a>      var <a class="var it85" onMouseOver="hilite(85)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../../../_variables/text.html">$text</a> = '';
<a name="l56"><span class="linenum">  56</span></a>  
<a name="l57"><span class="linenum">  57</span></a>      <span class="comment">/**</span>
<a name="l58"><span class="linenum">  58</span></a>  <span class="comment">     * Thread lazy filled</span>
<a name="l59"><span class="linenum">  59</span></a>  <span class="comment">     *</span>
<a name="l60"><span class="linenum">  60</span></a>  <span class="comment">     * @var instance of Thread class</span>
<a name="l61"><span class="linenum">  61</span></a>  <span class="comment">     */</span>
<a name="l62"><span class="linenum">  62</span></a>      var <a class="var it1809" onMouseOver="hilite(1809)" onMouseOut="lolite()" onClick="logVariable('Thread')" href="../../../../_variables/Thread.html">$Thread</a>;
<a name="l63"><span class="linenum">  63</span></a>  
<a name="l64"><span class="linenum">  64</span></a>  
<a name="l65"><span class="linenum">  65</span></a>      <span class="comment">/**</span>
<a name="l66"><span class="linenum">  66</span></a>  <span class="comment">     * Constructor</span>
<a name="l67"><span class="linenum">  67</span></a>  <span class="comment">     *</span>
<a name="l68"><span class="linenum">  68</span></a>  <span class="comment">     * @param db_row database row</span>
<a name="l69"><span class="linenum">  69</span></a>  <span class="comment">     */</span>
<a name="l70"><span class="linenum">  70</span></a>  	function <a class="function" onClick="logFunction('Message')" href="../../../../_functions/message.html" onMouseOver="funcPopup(event,'message')">Message</a>( <a class="var it321" onMouseOver="hilite(321)" onMouseOut="lolite()" onClick="logVariable('db_row')" href="../../../../_variables/db_row.html">$db_row</a> = NULL )
<a name="l71"><span class="linenum">  71</span></a>      {
<a name="l72"><span class="linenum">  72</span></a>  <span class="comment">        // Call parent constructor:</span>
<a name="l73"><span class="linenum">  73</span></a>          parent::<a class="function" onClick="logFunction('DataObject')" href="../../../../_functions/dataobject.html" onMouseOver="funcPopup(event,'dataobject')">DataObject</a>( 'T_messaging__message', 'msg_', 'msg_ID', 'datetime', '', 'author_user_ID' );
<a name="l74"><span class="linenum">  74</span></a>  
<a name="l75"><span class="linenum">  75</span></a>            <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('delete_cascades')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/delete_cascades.html">delete_cascades</a> = array();
<a name="l76"><span class="linenum">  76</span></a>            <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('delete_restrictions')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/delete_restrictions.html">delete_restrictions</a> = array();
<a name="l77"><span class="linenum">  77</span></a>  
<a name="l78"><span class="linenum">  78</span></a>           if( <a class="var it321" onMouseOver="hilite(321)" onMouseOut="lolite()" onClick="logVariable('db_row')" href="../../../../_variables/db_row.html">$db_row</a> != NULL )
<a name="l79"><span class="linenum">  79</span></a>          {
<a name="l80"><span class="linenum">  80</span></a>              <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/ID.html">ID</a>                = <a class="var it321" onMouseOver="hilite(321)" onMouseOut="lolite()" onClick="logVariable('db_row')" href="../../../../_variables/db_row.html">$db_row</a>-&gt;<a onClick="logVariable('msg_ID')" class="var it9014" onMouseOver="hilite(9014)" onMouseOut="lolite()" href="../../../../_variables/msg_ID.html">msg_ID</a>;
<a name="l81"><span class="linenum">  81</span></a>              <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('thread_ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/thread_ID.html">thread_ID</a>         = <a class="var it321" onMouseOver="hilite(321)" onMouseOut="lolite()" onClick="logVariable('db_row')" href="../../../../_variables/db_row.html">$db_row</a>-&gt;<a onClick="logVariable('msg_thread_ID')" class="var it9014" onMouseOver="hilite(9014)" onMouseOut="lolite()" href="../../../../_variables/msg_thread_ID.html">msg_thread_ID</a>;
<a name="l82"><span class="linenum">  82</span></a>              <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('author_user_ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/author_user_ID.html">author_user_ID</a>    = <a class="var it321" onMouseOver="hilite(321)" onMouseOut="lolite()" onClick="logVariable('db_row')" href="../../../../_variables/db_row.html">$db_row</a>-&gt;<a onClick="logVariable('msg_author_user_ID')" class="var it9014" onMouseOver="hilite(9014)" onMouseOut="lolite()" href="../../../../_variables/msg_author_user_ID.html">msg_author_user_ID</a>;
<a name="l83"><span class="linenum">  83</span></a>              <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('datetime')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/datetime.html">datetime</a>          = <a class="var it321" onMouseOver="hilite(321)" onMouseOut="lolite()" onClick="logVariable('db_row')" href="../../../../_variables/db_row.html">$db_row</a>-&gt;<a onClick="logVariable('msg_datetime')" class="var it9014" onMouseOver="hilite(9014)" onMouseOut="lolite()" href="../../../../_variables/msg_datetime.html">msg_datetime</a>;
<a name="l84"><span class="linenum">  84</span></a>              <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('text')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/text.html">text</a>              = <a class="var it321" onMouseOver="hilite(321)" onMouseOut="lolite()" onClick="logVariable('db_row')" href="../../../../_variables/db_row.html">$db_row</a>-&gt;<a onClick="logVariable('msg_text')" class="var it9014" onMouseOver="hilite(9014)" onMouseOut="lolite()" href="../../../../_variables/msg_text.html">msg_text</a>;
<a name="l85"><span class="linenum">  85</span></a>          }
<a name="l86"><span class="linenum">  86</span></a>      }
<a name="l87"><span class="linenum">  87</span></a>  
<a name="l88"><span class="linenum">  88</span></a>  
<a name="l89"><span class="linenum">  89</span></a>      <span class="comment">/**</span>
<a name="l90"><span class="linenum">  90</span></a>  <span class="comment">     * Load data from Request form fields.</span>
<a name="l91"><span class="linenum">  91</span></a>  <span class="comment">     *</span>
<a name="l92"><span class="linenum">  92</span></a>  <span class="comment">     * @return boolean true if loaded data seems valid.</span>
<a name="l93"><span class="linenum">  93</span></a>  <span class="comment">     */</span>
<a name="l94"><span class="linenum">  94</span></a>  	function <a class="function" onClick="logFunction('load_from_Request')" href="../../../../_functions/load_from_request.html" onMouseOver="funcPopup(event,'load_from_request')">load_from_Request</a>()
<a name="l95"><span class="linenum">  95</span></a>      {
<a name="l96"><span class="linenum">  96</span></a>          <a class="var it1813" onMouseOver="hilite(1813)" onMouseOut="lolite()" onClick="logVariable('new_thread')" href="../../../../_variables/new_thread.html">$new_thread</a> = empty(<a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('thread_ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/thread_ID.html">thread_ID</a>);
<a name="l97"><span class="linenum">  97</span></a>  
<a name="l98"><span class="linenum">  98</span></a>  <span class="comment">        // Text</span>
<a name="l99"><span class="linenum">  99</span></a>  <span class="comment">        // WARNING: the messages may contain MALICIOUS HTML and javascript snippets. They must ALWAYS be ESCAPED prior to display!</span>
<a name="l100"><span class="linenum"> 100</span></a>          <a class="function" onClick="logFunction('param')" href="../../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'msg_text', 'html' );
<a name="l101"><span class="linenum"> 101</span></a>          if( ! <a class="var it1813" onMouseOver="hilite(1813)" onMouseOut="lolite()" onClick="logVariable('new_thread')" href="../../../../_variables/new_thread.html">$new_thread</a> )
<a name="l102"><span class="linenum"> 102</span></a>          {
<a name="l103"><span class="linenum"> 103</span></a>              <a class="function" onClick="logFunction('param_check_not_empty')" href="../../../../_functions/param_check_not_empty.html" onMouseOver="funcPopup(event,'param_check_not_empty')">param_check_not_empty</a>( 'msg_text' );
<a name="l104"><span class="linenum"> 104</span></a>          }
<a name="l105"><span class="linenum"> 105</span></a>          <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'text', <a class="function" onClick="logFunction('get_param')" href="../../../../_functions/get_param.html" onMouseOver="funcPopup(event,'get_param')">get_param</a>( 'msg_text' ) );
<a name="l106"><span class="linenum"> 106</span></a>  
<a name="l107"><span class="linenum"> 107</span></a>  <span class="comment">        // Thread</span>
<a name="l108"><span class="linenum"> 108</span></a>          if( <a class="var it1813" onMouseOver="hilite(1813)" onMouseOut="lolite()" onClick="logVariable('new_thread')" href="../../../../_variables/new_thread.html">$new_thread</a> )
<a name="l109"><span class="linenum"> 109</span></a>          {
<a name="l110"><span class="linenum"> 110</span></a>              <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('Thread')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a>-&gt;<a class="function" onClick="logFunction('load_from_Request')" href="../../../../_functions/load_from_request.html" onMouseOver="funcPopup(event,'load_from_request')">load_from_Request</a>();
<a name="l111"><span class="linenum"> 111</span></a>          }
<a name="l112"><span class="linenum"> 112</span></a>          else
<a name="l113"><span class="linenum"> 113</span></a>          { // this is a reply to an existing conversation, check if current User is allowed to reply
<a name="l114"><span class="linenum"> 114</span></a>              <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;get_Thread();
<a name="l115"><span class="linenum"> 115</span></a>              <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('Thread')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a>-&gt;<a class="function" onClick="logFunction('check_allow_reply')" href="../../../../_functions/check_allow_reply.html" onMouseOver="funcPopup(event,'check_allow_reply')">check_allow_reply</a>();
<a name="l116"><span class="linenum"> 116</span></a>          }
<a name="l117"><span class="linenum"> 117</span></a>  
<a name="l118"><span class="linenum"> 118</span></a>          return ! <a class="function" onClick="logFunction('param_errors_detected')" href="../../../../_functions/param_errors_detected.html" onMouseOver="funcPopup(event,'param_errors_detected')">param_errors_detected</a>();
<a name="l119"><span class="linenum"> 119</span></a>      }
<a name="l120"><span class="linenum"> 120</span></a>  
<a name="l121"><span class="linenum"> 121</span></a>  
<a name="l122"><span class="linenum"> 122</span></a>      <span class="comment">/**</span>
<a name="l123"><span class="linenum"> 123</span></a>  <span class="comment">     * Get Thread object</span>
<a name="l124"><span class="linenum"> 124</span></a>  <span class="comment">     */</span>
<a name="l125"><span class="linenum"> 125</span></a>      function &amp; get_Thread()
<a name="l126"><span class="linenum"> 126</span></a>      {
<a name="l127"><span class="linenum"> 127</span></a>          if( <a class="phpfunction" onClick="logFunction('is_null')" href="../../../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('Thread')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a>) &amp;&amp; !empty(<a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('thread_ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/thread_ID.html">thread_ID</a>) )
<a name="l128"><span class="linenum"> 128</span></a>          {
<a name="l129"><span class="linenum"> 129</span></a>              <a class="var it1814" onMouseOver="hilite(1814)" onMouseOut="lolite()" onClick="logVariable('ThreadCache')" href="../../../../_variables/ThreadCache.html">$ThreadCache</a> = &amp; get_ThreadCache();
<a name="l130"><span class="linenum"> 130</span></a>              <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('Thread')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a> = <a class="var it1814" onMouseOver="hilite(1814)" onMouseOut="lolite()" onClick="logVariable('ThreadCache')" href="../../../../_variables/ThreadCache.html">$ThreadCache</a>-&gt;get_by_ID( <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('thread_ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/thread_ID.html">thread_ID</a> );
<a name="l131"><span class="linenum"> 131</span></a>          }
<a name="l132"><span class="linenum"> 132</span></a>  
<a name="l133"><span class="linenum"> 133</span></a>          return <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('Thread')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a>;
<a name="l134"><span class="linenum"> 134</span></a>      }
<a name="l135"><span class="linenum"> 135</span></a>  
<a name="l136"><span class="linenum"> 136</span></a>  
<a name="l137"><span class="linenum"> 137</span></a>      <span class="comment">/**</span>
<a name="l138"><span class="linenum"> 138</span></a>  <span class="comment">     * Insert discussion (one thread for all recipients)</span>
<a name="l139"><span class="linenum"> 139</span></a>  <span class="comment">     *</span>
<a name="l140"><span class="linenum"> 140</span></a>  <span class="comment">     * @param User who sent the message, it must be set only if it is not the current User</span>
<a name="l141"><span class="linenum"> 141</span></a>  <span class="comment">     * @return true if success, false otherwise</span>
<a name="l142"><span class="linenum"> 142</span></a>  <span class="comment">     */</span>
<a name="l143"><span class="linenum"> 143</span></a>  	function <a class="function" onClick="logFunction('dbinsert_discussion')" href="../../../../_functions/dbinsert_discussion.html" onMouseOver="funcPopup(event,'dbinsert_discussion')">dbinsert_discussion</a>( <a class="var it1815" onMouseOver="hilite(1815)" onMouseOut="lolite()" onClick="logVariable('from_User')" href="../../../../_variables/from_User.html">$from_User</a> = NULL )
<a name="l144"><span class="linenum"> 144</span></a>      {
<a name="l145"><span class="linenum"> 145</span></a>          global <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>;
<a name="l146"><span class="linenum"> 146</span></a>  
<a name="l147"><span class="linenum"> 147</span></a>          if( <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/ID.html">ID</a> != 0 ) die( 'Existing object cannot be inserted!' );
<a name="l148"><span class="linenum"> 148</span></a>  
<a name="l149"><span class="linenum"> 149</span></a>          <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('begin')" href="../../../../_functions/begin.html" onMouseOver="funcPopup(event,'begin')">begin</a>();
<a name="l150"><span class="linenum"> 150</span></a>  
<a name="l151"><span class="linenum"> 151</span></a>          <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;get_Thread();
<a name="l152"><span class="linenum"> 152</span></a>  
<a name="l153"><span class="linenum"> 153</span></a>          if ( <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('Thread')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a>-&gt;<a class="function" onClick="logFunction('dbinsert')" href="../../../../_functions/dbinsert.html" onMouseOver="funcPopup(event,'dbinsert')">dbinsert</a>() )
<a name="l154"><span class="linenum"> 154</span></a>          {
<a name="l155"><span class="linenum"> 155</span></a>              <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('set_param')" href="../../../../_functions/set_param.html" onMouseOver="funcPopup(event,'set_param')">set_param</a>( 'thread_ID', 'integer', <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('Thread')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a>-&gt;ID);
<a name="l156"><span class="linenum"> 156</span></a>  
<a name="l157"><span class="linenum"> 157</span></a>              if( parent::<a class="function" onClick="logFunction('dbinsert')" href="../../../../_functions/dbinsert.html" onMouseOver="funcPopup(event,'dbinsert')">dbinsert</a>() )
<a name="l158"><span class="linenum"> 158</span></a>              {
<a name="l159"><span class="linenum"> 159</span></a>                  if( <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('dbinsert_threadstatus')" href="../../../../_functions/dbinsert_threadstatus.html" onMouseOver="funcPopup(event,'dbinsert_threadstatus')">dbinsert_threadstatus</a>( <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('Thread')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a>-&gt;recipients_list ) )
<a name="l160"><span class="linenum"> 160</span></a>                  {
<a name="l161"><span class="linenum"> 161</span></a>                      if( <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('dbinsert_contacts')" href="../../../../_functions/dbinsert_contacts.html" onMouseOver="funcPopup(event,'dbinsert_contacts')">dbinsert_contacts</a>( <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('Thread')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a>-&gt;recipients_list ) )
<a name="l162"><span class="linenum"> 162</span></a>                      {
<a name="l163"><span class="linenum"> 163</span></a>                          if( <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('dbupdate_last_contact_datetime')" href="../../../../_functions/dbupdate_last_contact_datetime.html" onMouseOver="funcPopup(event,'dbupdate_last_contact_datetime')">dbupdate_last_contact_datetime</a>() )
<a name="l164"><span class="linenum"> 164</span></a>                          {
<a name="l165"><span class="linenum"> 165</span></a>                              <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('commit')" href="../../../../_functions/commit.html" onMouseOver="funcPopup(event,'commit')">commit</a>();
<a name="l166"><span class="linenum"> 166</span></a>  
<a name="l167"><span class="linenum"> 167</span></a>                              <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('send_email_notifications')" href="../../../../_functions/send_email_notifications.html" onMouseOver="funcPopup(event,'send_email_notifications')">send_email_notifications</a>( true, <a class="var it1815" onMouseOver="hilite(1815)" onMouseOut="lolite()" onClick="logVariable('from_User')" href="../../../../_variables/from_User.html">$from_User</a> );
<a name="l168"><span class="linenum"> 168</span></a>                              return true;
<a name="l169"><span class="linenum"> 169</span></a>                          }
<a name="l170"><span class="linenum"> 170</span></a>                      }
<a name="l171"><span class="linenum"> 171</span></a>                  }
<a name="l172"><span class="linenum"> 172</span></a>              }
<a name="l173"><span class="linenum"> 173</span></a>          }
<a name="l174"><span class="linenum"> 174</span></a>  
<a name="l175"><span class="linenum"> 175</span></a>          <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('rollback')" href="../../../../_functions/rollback.html" onMouseOver="funcPopup(event,'rollback')">rollback</a>();
<a name="l176"><span class="linenum"> 176</span></a>          return false;
<a name="l177"><span class="linenum"> 177</span></a>      }
<a name="l178"><span class="linenum"> 178</span></a>  
<a name="l179"><span class="linenum"> 179</span></a>  
<a name="l180"><span class="linenum"> 180</span></a>      <span class="comment">/**</span>
<a name="l181"><span class="linenum"> 181</span></a>  <span class="comment">     * Insert new thread for each recipient</span>
<a name="l182"><span class="linenum"> 182</span></a>  <span class="comment">     *</span>
<a name="l183"><span class="linenum"> 183</span></a>  <span class="comment">     * @param User who sent the message, it must be set only if it is not the current User</span>
<a name="l184"><span class="linenum"> 184</span></a>  <span class="comment">     * @return true if success, instead false</span>
<a name="l185"><span class="linenum"> 185</span></a>  <span class="comment">     */</span>
<a name="l186"><span class="linenum"> 186</span></a>  	function <a class="function" onClick="logFunction('dbinsert_individual')" href="../../../../_functions/dbinsert_individual.html" onMouseOver="funcPopup(event,'dbinsert_individual')">dbinsert_individual</a>( <a class="var it1815" onMouseOver="hilite(1815)" onMouseOut="lolite()" onClick="logVariable('from_User')" href="../../../../_variables/from_User.html">$from_User</a> = NULL )
<a name="l187"><span class="linenum"> 187</span></a>      {
<a name="l188"><span class="linenum"> 188</span></a>          foreach( <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('Thread')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a>-&gt;recipients_list as <a class="var it1252" onMouseOver="hilite(1252)" onMouseOut="lolite()" onClick="logVariable('recipient_ID')" href="../../../../_variables/recipient_ID.html">$recipient_ID</a> )
<a name="l189"><span class="linenum"> 189</span></a>          {
<a name="l190"><span class="linenum"> 190</span></a>              <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a> = <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('clone_message')" href="../../../../_functions/clone_message.html" onMouseOver="funcPopup(event,'clone_message')">clone_message</a>( <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a> );
<a name="l191"><span class="linenum"> 191</span></a>  
<a name="l192"><span class="linenum"> 192</span></a>              <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a onClick="logVariable('Thread')" class="var it9044" onMouseOver="hilite(9044)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a>-&gt;recipients_list = array( <a class="var it1252" onMouseOver="hilite(1252)" onMouseOut="lolite()" onClick="logVariable('recipient_ID')" href="../../../../_variables/recipient_ID.html">$recipient_ID</a> );
<a name="l193"><span class="linenum"> 193</span></a>  
<a name="l194"><span class="linenum"> 194</span></a>              if ( !<a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('dbinsert_discussion')" href="../../../../_functions/dbinsert_discussion.html" onMouseOver="funcPopup(event,'dbinsert_discussion')">dbinsert_discussion</a>( <a class="var it1815" onMouseOver="hilite(1815)" onMouseOut="lolite()" onClick="logVariable('from_User')" href="../../../../_variables/from_User.html">$from_User</a> ) )
<a name="l195"><span class="linenum"> 195</span></a>              {
<a name="l196"><span class="linenum"> 196</span></a>                  return false;
<a name="l197"><span class="linenum"> 197</span></a>              }
<a name="l198"><span class="linenum"> 198</span></a>          }
<a name="l199"><span class="linenum"> 199</span></a>  
<a name="l200"><span class="linenum"> 200</span></a>          return true;
<a name="l201"><span class="linenum"> 201</span></a>      }
<a name="l202"><span class="linenum"> 202</span></a>  
<a name="l203"><span class="linenum"> 203</span></a>  
<a name="l204"><span class="linenum"> 204</span></a>      <span class="comment">/**</span>
<a name="l205"><span class="linenum"> 205</span></a>  <span class="comment">     * Insert message in existing thread</span>
<a name="l206"><span class="linenum"> 206</span></a>  <span class="comment">     *</span>
<a name="l207"><span class="linenum"> 207</span></a>  <span class="comment">     * @return true if success, instead false</span>
<a name="l208"><span class="linenum"> 208</span></a>  <span class="comment">     */</span>
<a name="l209"><span class="linenum"> 209</span></a>  	function <a class="function" onClick="logFunction('dbinsert_message')" href="../../../../_functions/dbinsert_message.html" onMouseOver="funcPopup(event,'dbinsert_message')">dbinsert_message</a>()
<a name="l210"><span class="linenum"> 210</span></a>      {
<a name="l211"><span class="linenum"> 211</span></a>          global <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('localtimenow')" href="../../../../_variables/localtimenow.html">$localtimenow</a>;
<a name="l212"><span class="linenum"> 212</span></a>  
<a name="l213"><span class="linenum"> 213</span></a>          if( <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/ID.html">ID</a> != 0 ) die( 'Existing object cannot be inserted!' );
<a name="l214"><span class="linenum"> 214</span></a>  
<a name="l215"><span class="linenum"> 215</span></a>          <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('begin')" href="../../../../_functions/begin.html" onMouseOver="funcPopup(event,'begin')">begin</a>();
<a name="l216"><span class="linenum"> 216</span></a>  
<a name="l217"><span class="linenum"> 217</span></a>          <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;get_Thread();
<a name="l218"><span class="linenum"> 218</span></a>  
<a name="l219"><span class="linenum"> 219</span></a>          <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('Thread')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a>-&gt;<a class="function" onClick="logFunction('set_param')" href="../../../../_functions/set_param.html" onMouseOver="funcPopup(event,'set_param')">set_param</a>( 'datemodified', 'string', <a class="phpfunction" onClick="logFunction('date')" href="../../../../_functions/date.html" onMouseOver="phpfuncPopup(event,'date')">date</a>( 'Y-m-d H:i:s', <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('localtimenow')" href="../../../../_variables/localtimenow.html">$localtimenow</a> ) );
<a name="l220"><span class="linenum"> 220</span></a>  
<a name="l221"><span class="linenum"> 221</span></a>          if( <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('Thread')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a>-&gt;<a class="function" onClick="logFunction('dbupdate')" href="../../../../_functions/dbupdate.html" onMouseOver="funcPopup(event,'dbupdate')">dbupdate</a>() )
<a name="l222"><span class="linenum"> 222</span></a>          {
<a name="l223"><span class="linenum"> 223</span></a>              <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('set_param')" href="../../../../_functions/set_param.html" onMouseOver="funcPopup(event,'set_param')">set_param</a>( 'thread_ID', 'integer', <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('Thread')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a>-&gt;ID);
<a name="l224"><span class="linenum"> 224</span></a>  
<a name="l225"><span class="linenum"> 225</span></a>              if( parent::<a class="function" onClick="logFunction('dbinsert')" href="../../../../_functions/dbinsert.html" onMouseOver="funcPopup(event,'dbinsert')">dbinsert</a>() )
<a name="l226"><span class="linenum"> 226</span></a>              {
<a name="l227"><span class="linenum"> 227</span></a>                  <a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../../_variables/sql.html">$sql</a> = 'UPDATE T_messaging__threadstatus
<a name="l228"><span class="linenum"> 228</span></a>                          SET tsta_first_unread_msg_ID = '.<a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/ID.html">ID</a>.'
<a name="l229"><span class="linenum"> 229</span></a>                          WHERE tsta_thread_ID = '.<a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('Thread')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a>-&gt;ID.'
<a name="l230"><span class="linenum"> 230</span></a>                              AND tsta_user_ID &lt;&gt; '.<a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('author_user_ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/author_user_ID.html">author_user_ID</a>.'
<a name="l231"><span class="linenum"> 231</span></a>                              AND tsta_first_unread_msg_ID IS NULL';
<a name="l232"><span class="linenum"> 232</span></a>  
<a name="l233"><span class="linenum"> 233</span></a>                  <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( <a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../../_variables/sql.html">$sql</a>, 'Insert thread statuses' );
<a name="l234"><span class="linenum"> 234</span></a>  
<a name="l235"><span class="linenum"> 235</span></a>  <span class="comment">                // check if contact pairs between sender and recipients exists</span>
<a name="l236"><span class="linenum"> 236</span></a>                  <a class="var it1228" onMouseOver="hilite(1228)" onMouseOut="lolite()" onClick="logVariable('recipient_list')" href="../../../../_variables/recipient_list.html">$recipient_list</a> = <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('Thread')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a>-&gt;<a class="function" onClick="logFunction('load_recipients')" href="../../../../_functions/load_recipients.html" onMouseOver="funcPopup(event,'load_recipients')">load_recipients</a>();
<a name="l237"><span class="linenum"> 237</span></a>  <span class="comment">                // remove author user from recipient list</span>
<a name="l238"><span class="linenum"> 238</span></a>                  <a class="var it1228" onMouseOver="hilite(1228)" onMouseOut="lolite()" onClick="logVariable('recipient_list')" href="../../../../_variables/recipient_list.html">$recipient_list</a> = <a class="phpfunction" onClick="logFunction('array_diff')" href="../../../../_functions/array_diff.html" onMouseOver="phpfuncPopup(event,'array_diff')">array_diff</a>( <a class="var it1228" onMouseOver="hilite(1228)" onMouseOut="lolite()" onClick="logVariable('recipient_list')" href="../../../../_variables/recipient_list.html">$recipient_list</a>, array( <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('author_user_ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/author_user_ID.html">author_user_ID</a> ) );
<a name="l239"><span class="linenum"> 239</span></a>  <span class="comment">                // insert missing contact pairs if required</span>
<a name="l240"><span class="linenum"> 240</span></a>                  if( <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('dbinsert_contacts')" href="../../../../_functions/dbinsert_contacts.html" onMouseOver="funcPopup(event,'dbinsert_contacts')">dbinsert_contacts</a>( <a class="var it1228" onMouseOver="hilite(1228)" onMouseOut="lolite()" onClick="logVariable('recipient_list')" href="../../../../_variables/recipient_list.html">$recipient_list</a> ) )
<a name="l241"><span class="linenum"> 241</span></a>                  {
<a name="l242"><span class="linenum"> 242</span></a>                      if( <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('dbupdate_last_contact_datetime')" href="../../../../_functions/dbupdate_last_contact_datetime.html" onMouseOver="funcPopup(event,'dbupdate_last_contact_datetime')">dbupdate_last_contact_datetime</a>() )
<a name="l243"><span class="linenum"> 243</span></a>                      {
<a name="l244"><span class="linenum"> 244</span></a>                          <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('commit')" href="../../../../_functions/commit.html" onMouseOver="funcPopup(event,'commit')">commit</a>();
<a name="l245"><span class="linenum"> 245</span></a>  
<a name="l246"><span class="linenum"> 246</span></a>                          <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('send_email_notifications')" href="../../../../_functions/send_email_notifications.html" onMouseOver="funcPopup(event,'send_email_notifications')">send_email_notifications</a>( false );
<a name="l247"><span class="linenum"> 247</span></a>                          return true;
<a name="l248"><span class="linenum"> 248</span></a>                      }
<a name="l249"><span class="linenum"> 249</span></a>                  }
<a name="l250"><span class="linenum"> 250</span></a>              }
<a name="l251"><span class="linenum"> 251</span></a>          }
<a name="l252"><span class="linenum"> 252</span></a>  
<a name="l253"><span class="linenum"> 253</span></a>          <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('rollback')" href="../../../../_functions/rollback.html" onMouseOver="funcPopup(event,'rollback')">rollback</a>();
<a name="l254"><span class="linenum"> 254</span></a>          return false;
<a name="l255"><span class="linenum"> 255</span></a>      }
<a name="l256"><span class="linenum"> 256</span></a>  
<a name="l257"><span class="linenum"> 257</span></a>  
<a name="l258"><span class="linenum"> 258</span></a>      <span class="comment">/**</span>
<a name="l259"><span class="linenum"> 259</span></a>  <span class="comment">     * Insert recipients into database</span>
<a name="l260"><span class="linenum"> 260</span></a>  <span class="comment">     *</span>
<a name="l261"><span class="linenum"> 261</span></a>  <span class="comment">     * @param recipients</span>
<a name="l262"><span class="linenum"> 262</span></a>  <span class="comment">     * @return true if success, instead false</span>
<a name="l263"><span class="linenum"> 263</span></a>  <span class="comment">     */</span>
<a name="l264"><span class="linenum"> 264</span></a>  	function <a class="function" onClick="logFunction('dbinsert_threadstatus')" href="../../../../_functions/dbinsert_threadstatus.html" onMouseOver="funcPopup(event,'dbinsert_threadstatus')">dbinsert_threadstatus</a>( <a class="var it1816" onMouseOver="hilite(1816)" onMouseOut="lolite()" onClick="logVariable('recipients_list')" href="../../../../_variables/recipients_list.html">$recipients_list</a> )
<a name="l265"><span class="linenum"> 265</span></a>      {
<a name="l266"><span class="linenum"> 266</span></a>          global <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>;
<a name="l267"><span class="linenum"> 267</span></a>  
<a name="l268"><span class="linenum"> 268</span></a>          <a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../../_variables/sql.html">$sql</a> = 'INSERT INTO T_messaging__threadstatus (tsta_thread_ID, tsta_user_ID, tsta_first_unread_msg_ID)
<a name="l269"><span class="linenum"> 269</span></a>                              VALUES';
<a name="l270"><span class="linenum"> 270</span></a>  
<a name="l271"><span class="linenum"> 271</span></a>          foreach ( <a class="var it1816" onMouseOver="hilite(1816)" onMouseOut="lolite()" onClick="logVariable('recipients_list')" href="../../../../_variables/recipients_list.html">$recipients_list</a> as <a class="var it1252" onMouseOver="hilite(1252)" onMouseOut="lolite()" onClick="logVariable('recipient_ID')" href="../../../../_variables/recipient_ID.html">$recipient_ID</a> )
<a name="l272"><span class="linenum"> 272</span></a>          {
<a name="l273"><span class="linenum"> 273</span></a>              <a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../../_variables/sql.html">$sql</a> .= ' ('.<a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('Thread')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a>-&gt;ID.', '.<a class="var it1252" onMouseOver="hilite(1252)" onMouseOut="lolite()" onClick="logVariable('recipient_ID')" href="../../../../_variables/recipient_ID.html">$recipient_ID</a>.', '.<a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/ID.html">ID</a>.'),';
<a name="l274"><span class="linenum"> 274</span></a>          }
<a name="l275"><span class="linenum"> 275</span></a>          <a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../../_variables/sql.html">$sql</a> .= ' ('.<a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('Thread')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a>-&gt;ID.', '.<a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('author_user_ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/author_user_ID.html">author_user_ID</a>.', NULL)';
<a name="l276"><span class="linenum"> 276</span></a>  
<a name="l277"><span class="linenum"> 277</span></a>          return <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( <a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../../_variables/sql.html">$sql</a>, 'Insert thread statuses' );
<a name="l278"><span class="linenum"> 278</span></a>      }
<a name="l279"><span class="linenum"> 279</span></a>  
<a name="l280"><span class="linenum"> 280</span></a>  
<a name="l281"><span class="linenum"> 281</span></a>      <span class="comment">/**</span>
<a name="l282"><span class="linenum"> 282</span></a>  <span class="comment">     * Insert contacts into database</span>
<a name="l283"><span class="linenum"> 283</span></a>  <span class="comment">     *</span>
<a name="l284"><span class="linenum"> 284</span></a>  <span class="comment">     * @param recipients</span>
<a name="l285"><span class="linenum"> 285</span></a>  <span class="comment">     * @return true if success, instead false</span>
<a name="l286"><span class="linenum"> 286</span></a>  <span class="comment">     */</span>
<a name="l287"><span class="linenum"> 287</span></a>  	function <a class="function" onClick="logFunction('dbinsert_contacts')" href="../../../../_functions/dbinsert_contacts.html" onMouseOver="funcPopup(event,'dbinsert_contacts')">dbinsert_contacts</a>( <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('recipients')" href="../../../../_variables/recipients.html">$recipients</a> )
<a name="l288"><span class="linenum"> 288</span></a>      {
<a name="l289"><span class="linenum"> 289</span></a>          global <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('localtimenow')" href="../../../../_variables/localtimenow.html">$localtimenow</a>;
<a name="l290"><span class="linenum"> 290</span></a>  
<a name="l291"><span class="linenum"> 291</span></a>  <span class="comment">        // select contacts of the current user</span>
<a name="l292"><span class="linenum"> 292</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('SQL')" href="../../../../_variables/SQL.html">$SQL</a> = <span class="keyword">new </span><a class="class" onClick="logClass('SQL')" href="../../../../_classes/sql.html" onMouseOver="classPopup(event,'sql')">SQL</a>();
<a name="l293"><span class="linenum"> 293</span></a>  
<a name="l294"><span class="linenum"> 294</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('SQL')" href="../../../../_variables/SQL.html">$SQL</a>-&gt;<a class="function" onClick="logFunction('SELECT')" href="../../../../_functions/select.html" onMouseOver="funcPopup(event,'select')">SELECT</a>( 'mct_to_user_ID' );
<a name="l295"><span class="linenum"> 295</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('SQL')" href="../../../../_variables/SQL.html">$SQL</a>-&gt;<a class="function" onClick="logFunction('FROM')" href="../../../../_functions/from.html" onMouseOver="funcPopup(event,'from')">FROM</a>( 'T_messaging__contact' );
<a name="l296"><span class="linenum"> 296</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('SQL')" href="../../../../_variables/SQL.html">$SQL</a>-&gt;<a class="function" onClick="logFunction('WHERE')" href="../../../../_functions/where.html" onMouseOver="funcPopup(event,'where')">WHERE</a>( 'mct_from_user_ID = '.<a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('author_user_ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/author_user_ID.html">author_user_ID</a> );
<a name="l297"><span class="linenum"> 297</span></a>  
<a name="l298"><span class="linenum"> 298</span></a>          <a class="var it1817" onMouseOver="hilite(1817)" onMouseOut="lolite()" onClick="logVariable('contact_list')" href="../../../../_variables/contact_list.html">$contact_list</a> = array();
<a name="l299"><span class="linenum"> 299</span></a>          foreach( <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_results')" href="../../../../_functions/get_results.html" onMouseOver="funcPopup(event,'get_results')">get_results</a>( <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('SQL')" href="../../../../_variables/SQL.html">$SQL</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>() ) as <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../../../_variables/row.html">$row</a> )
<a name="l300"><span class="linenum"> 300</span></a>          {
<a name="l301"><span class="linenum"> 301</span></a>              <a class="var it1817" onMouseOver="hilite(1817)" onMouseOut="lolite()" onClick="logVariable('contact_list')" href="../../../../_variables/contact_list.html">$contact_list</a>[] = <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../../../_variables/row.html">$row</a>-&gt;<a onClick="logVariable('mct_to_user_ID')" class="var it8964" onMouseOver="hilite(8964)" onMouseOut="lolite()" href="../../../../_variables/mct_to_user_ID.html">mct_to_user_ID</a>;
<a name="l302"><span class="linenum"> 302</span></a>          }
<a name="l303"><span class="linenum"> 303</span></a>  
<a name="l304"><span class="linenum"> 304</span></a>  <span class="comment">        // get users/recipients which are not in contact list</span>
<a name="l305"><span class="linenum"> 305</span></a>          <a class="var it1817" onMouseOver="hilite(1817)" onMouseOut="lolite()" onClick="logVariable('contact_list')" href="../../../../_variables/contact_list.html">$contact_list</a> = <a class="phpfunction" onClick="logFunction('array_diff')" href="../../../../_functions/array_diff.html" onMouseOver="phpfuncPopup(event,'array_diff')">array_diff</a>( <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('recipients')" href="../../../../_variables/recipients.html">$recipients</a>, <a class="var it1817" onMouseOver="hilite(1817)" onMouseOut="lolite()" onClick="logVariable('contact_list')" href="../../../../_variables/contact_list.html">$contact_list</a> );
<a name="l306"><span class="linenum"> 306</span></a>  
<a name="l307"><span class="linenum"> 307</span></a>  <span class="comment">        // select users who have author User on their contact list</span>
<a name="l308"><span class="linenum"> 308</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('SQL')" href="../../../../_variables/SQL.html">$SQL</a> = <span class="keyword">new </span><a class="class" onClick="logClass('SQL')" href="../../../../_classes/sql.html" onMouseOver="classPopup(event,'sql')">SQL</a>();
<a name="l309"><span class="linenum"> 309</span></a>  
<a name="l310"><span class="linenum"> 310</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('SQL')" href="../../../../_variables/SQL.html">$SQL</a>-&gt;<a class="function" onClick="logFunction('SELECT')" href="../../../../_functions/select.html" onMouseOver="funcPopup(event,'select')">SELECT</a>( 'mct_from_user_ID' );
<a name="l311"><span class="linenum"> 311</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('SQL')" href="../../../../_variables/SQL.html">$SQL</a>-&gt;<a class="function" onClick="logFunction('FROM')" href="../../../../_functions/from.html" onMouseOver="funcPopup(event,'from')">FROM</a>( 'T_messaging__contact' );
<a name="l312"><span class="linenum"> 312</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('SQL')" href="../../../../_variables/SQL.html">$SQL</a>-&gt;<a class="function" onClick="logFunction('WHERE')" href="../../../../_functions/where.html" onMouseOver="funcPopup(event,'where')">WHERE</a>( 'mct_to_user_ID = '.<a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('author_user_ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/author_user_ID.html">author_user_ID</a> );
<a name="l313"><span class="linenum"> 313</span></a>  
<a name="l314"><span class="linenum"> 314</span></a>          <a class="var it1819" onMouseOver="hilite(1819)" onMouseOut="lolite()" onClick="logVariable('reverse_contact_list')" href="../../../../_variables/reverse_contact_list.html">$reverse_contact_list</a> = array();
<a name="l315"><span class="linenum"> 315</span></a>          foreach( <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_results')" href="../../../../_functions/get_results.html" onMouseOver="funcPopup(event,'get_results')">get_results</a>( <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('SQL')" href="../../../../_variables/SQL.html">$SQL</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>() ) as <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../../../_variables/row.html">$row</a> )
<a name="l316"><span class="linenum"> 316</span></a>          {
<a name="l317"><span class="linenum"> 317</span></a>              <a class="var it1819" onMouseOver="hilite(1819)" onMouseOut="lolite()" onClick="logVariable('reverse_contact_list')" href="../../../../_variables/reverse_contact_list.html">$reverse_contact_list</a>[] = <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../../../_variables/row.html">$row</a>-&gt;<a onClick="logVariable('mct_from_user_ID')" class="var it8964" onMouseOver="hilite(8964)" onMouseOut="lolite()" href="../../../../_variables/mct_from_user_ID.html">mct_from_user_ID</a>;
<a name="l318"><span class="linenum"> 318</span></a>          }
<a name="l319"><span class="linenum"> 319</span></a>  
<a name="l320"><span class="linenum"> 320</span></a>  <span class="comment">        // get users/recipients which are not in reverse contact list</span>
<a name="l321"><span class="linenum"> 321</span></a>          <a class="var it1819" onMouseOver="hilite(1819)" onMouseOut="lolite()" onClick="logVariable('reverse_contact_list')" href="../../../../_variables/reverse_contact_list.html">$reverse_contact_list</a> = <a class="phpfunction" onClick="logFunction('array_diff')" href="../../../../_functions/array_diff.html" onMouseOver="phpfuncPopup(event,'array_diff')">array_diff</a>( <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('recipients')" href="../../../../_variables/recipients.html">$recipients</a>, <a class="var it1819" onMouseOver="hilite(1819)" onMouseOut="lolite()" onClick="logVariable('reverse_contact_list')" href="../../../../_variables/reverse_contact_list.html">$reverse_contact_list</a> );
<a name="l322"><span class="linenum"> 322</span></a>  
<a name="l323"><span class="linenum"> 323</span></a>          if( !empty( <a class="var it1817" onMouseOver="hilite(1817)" onMouseOut="lolite()" onClick="logVariable('contact_list')" href="../../../../_variables/contact_list.html">$contact_list</a> ) || !empty( <a class="var it1819" onMouseOver="hilite(1819)" onMouseOut="lolite()" onClick="logVariable('reverse_contact_list')" href="../../../../_variables/reverse_contact_list.html">$reverse_contact_list</a> ) )
<a name="l324"><span class="linenum"> 324</span></a>          {    // insert users/recipients which are not in contact list
<a name="l325"><span class="linenum"> 325</span></a>  
<a name="l326"><span class="linenum"> 326</span></a>              <a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../../_variables/sql.html">$sql</a> = 'INSERT INTO T_messaging__contact (mct_from_user_ID, mct_to_user_ID, mct_last_contact_datetime)
<a name="l327"><span class="linenum"> 327</span></a>                                  VALUES';
<a name="l328"><span class="linenum"> 328</span></a>  
<a name="l329"><span class="linenum"> 329</span></a>              <a class="var it1237" onMouseOver="hilite(1237)" onMouseOut="lolite()" onClick="logVariable('datetime')" href="../../../../_variables/datetime.html">$datetime</a> = <a class="phpfunction" onClick="logFunction('date')" href="../../../../_functions/date.html" onMouseOver="phpfuncPopup(event,'date')">date</a>( 'Y-m-d H:i:s', <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('localtimenow')" href="../../../../_variables/localtimenow.html">$localtimenow</a> );
<a name="l330"><span class="linenum"> 330</span></a>  
<a name="l331"><span class="linenum"> 331</span></a>              <a class="var it1821" onMouseOver="hilite(1821)" onMouseOut="lolite()" onClick="logVariable('statements')" href="../../../../_variables/statements.html">$statements</a> = array();
<a name="l332"><span class="linenum"> 332</span></a>              foreach ( <a class="var it1817" onMouseOver="hilite(1817)" onMouseOut="lolite()" onClick="logVariable('contact_list')" href="../../../../_variables/contact_list.html">$contact_list</a> as <a class="var it1822" onMouseOver="hilite(1822)" onMouseOut="lolite()" onClick="logVariable('contact_ID')" href="../../../../_variables/contact_ID.html">$contact_ID</a> )
<a name="l333"><span class="linenum"> 333</span></a>              {
<a name="l334"><span class="linenum"> 334</span></a>                  <a class="var it1821" onMouseOver="hilite(1821)" onMouseOut="lolite()" onClick="logVariable('statements')" href="../../../../_variables/statements.html">$statements</a>[] = ' ('.<a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('author_user_ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/author_user_ID.html">author_user_ID</a>.', '.<a class="var it1822" onMouseOver="hilite(1822)" onMouseOut="lolite()" onClick="logVariable('contact_ID')" href="../../../../_variables/contact_ID.html">$contact_ID</a>.', \''.<a class="var it1237" onMouseOver="hilite(1237)" onMouseOut="lolite()" onClick="logVariable('datetime')" href="../../../../_variables/datetime.html">$datetime</a>.'\')';
<a name="l335"><span class="linenum"> 335</span></a>              }
<a name="l336"><span class="linenum"> 336</span></a>              foreach ( <a class="var it1819" onMouseOver="hilite(1819)" onMouseOut="lolite()" onClick="logVariable('reverse_contact_list')" href="../../../../_variables/reverse_contact_list.html">$reverse_contact_list</a> as <a class="var it1822" onMouseOver="hilite(1822)" onMouseOut="lolite()" onClick="logVariable('contact_ID')" href="../../../../_variables/contact_ID.html">$contact_ID</a> )
<a name="l337"><span class="linenum"> 337</span></a>              {
<a name="l338"><span class="linenum"> 338</span></a>                  <a class="var it1821" onMouseOver="hilite(1821)" onMouseOut="lolite()" onClick="logVariable('statements')" href="../../../../_variables/statements.html">$statements</a>[] = ' ('.<a class="var it1822" onMouseOver="hilite(1822)" onMouseOut="lolite()" onClick="logVariable('contact_ID')" href="../../../../_variables/contact_ID.html">$contact_ID</a>.', '.<a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('author_user_ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/author_user_ID.html">author_user_ID</a>.', \''.<a class="var it1237" onMouseOver="hilite(1237)" onMouseOut="lolite()" onClick="logVariable('datetime')" href="../../../../_variables/datetime.html">$datetime</a>.'\')';
<a name="l339"><span class="linenum"> 339</span></a>              }
<a name="l340"><span class="linenum"> 340</span></a>              <a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../../_variables/sql.html">$sql</a> .= <a class="phpfunction" onClick="logFunction('implode')" href="../../../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( ', ', <a class="var it1821" onMouseOver="hilite(1821)" onMouseOut="lolite()" onClick="logVariable('statements')" href="../../../../_variables/statements.html">$statements</a> );
<a name="l341"><span class="linenum"> 341</span></a>  
<a name="l342"><span class="linenum"> 342</span></a>              return <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( <a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../../_variables/sql.html">$sql</a>, 'Insert contacts' );
<a name="l343"><span class="linenum"> 343</span></a>          }
<a name="l344"><span class="linenum"> 344</span></a>  
<a name="l345"><span class="linenum"> 345</span></a>          return true;
<a name="l346"><span class="linenum"> 346</span></a>      }
<a name="l347"><span class="linenum"> 347</span></a>  
<a name="l348"><span class="linenum"> 348</span></a>  
<a name="l349"><span class="linenum"> 349</span></a>      <span class="comment">/**</span>
<a name="l350"><span class="linenum"> 350</span></a>  <span class="comment">     * Update last contact datetimes</span>
<a name="l351"><span class="linenum"> 351</span></a>  <span class="comment">     *</span>
<a name="l352"><span class="linenum"> 352</span></a>  <span class="comment">     * @return true if success</span>
<a name="l353"><span class="linenum"> 353</span></a>  <span class="comment">     */</span>
<a name="l354"><span class="linenum"> 354</span></a>  	function <a class="function" onClick="logFunction('dbupdate_last_contact_datetime')" href="../../../../_functions/dbupdate_last_contact_datetime.html" onMouseOver="funcPopup(event,'dbupdate_last_contact_datetime')">dbupdate_last_contact_datetime</a>()
<a name="l355"><span class="linenum"> 355</span></a>      {
<a name="l356"><span class="linenum"> 356</span></a>          global <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>, <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('localtimenow')" href="../../../../_variables/localtimenow.html">$localtimenow</a>;
<a name="l357"><span class="linenum"> 357</span></a>  
<a name="l358"><span class="linenum"> 358</span></a>  <span class="comment">        // efy-maxim&gt; TODO: two SQL queries are used instead one update with subselect,</span>
<a name="l359"><span class="linenum"> 359</span></a>  <span class="comment">        // because T_messaging__threadstatus alias is not converted to real table name.</span>
<a name="l360"><span class="linenum"> 360</span></a>  <span class="comment">        // Also, it can't be improved right now because it depends of</span>
<a name="l361"><span class="linenum"> 361</span></a>  <span class="comment">        // (pls. see blueyed's comment for $DB-&gt;query() function)</span>
<a name="l362"><span class="linenum"> 362</span></a>  
<a name="l363"><span class="linenum"> 363</span></a>          <a class="var it1235" onMouseOver="hilite(1235)" onMouseOut="lolite()" onClick="logVariable('select_SQL')" href="../../../../_variables/select_SQL.html">$select_SQL</a> = <span class="keyword">new </span><a class="class" onClick="logClass('SQL')" href="../../../../_classes/sql.html" onMouseOver="classPopup(event,'sql')">SQL</a>();
<a name="l364"><span class="linenum"> 364</span></a>          <a class="var it1235" onMouseOver="hilite(1235)" onMouseOut="lolite()" onClick="logVariable('select_SQL')" href="../../../../_variables/select_SQL.html">$select_SQL</a>-&gt;<a class="function" onClick="logFunction('SELECT')" href="../../../../_functions/select.html" onMouseOver="funcPopup(event,'select')">SELECT</a>( 'GROUP_CONCAT(tsta_user_ID SEPARATOR \',\')' );
<a name="l365"><span class="linenum"> 365</span></a>          <a class="var it1235" onMouseOver="hilite(1235)" onMouseOut="lolite()" onClick="logVariable('select_SQL')" href="../../../../_variables/select_SQL.html">$select_SQL</a>-&gt;<a class="function" onClick="logFunction('FROM')" href="../../../../_functions/from.html" onMouseOver="funcPopup(event,'from')">FROM</a>( 'T_messaging__threadstatus' );
<a name="l366"><span class="linenum"> 366</span></a>          <a class="var it1235" onMouseOver="hilite(1235)" onMouseOut="lolite()" onClick="logVariable('select_SQL')" href="../../../../_variables/select_SQL.html">$select_SQL</a>-&gt;<a class="function" onClick="logFunction('WHERE')" href="../../../../_functions/where.html" onMouseOver="funcPopup(event,'where')">WHERE</a>( 'tsta_thread_ID = '.<a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('Thread')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a>-&gt;ID );
<a name="l367"><span class="linenum"> 367</span></a>  
<a name="l368"><span class="linenum"> 368</span></a>          <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('recipients')" href="../../../../_variables/recipients.html">$recipients</a> = <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_var')" href="../../../../_functions/get_var.html" onMouseOver="funcPopup(event,'get_var')">get_var</a>( <a class="var it1235" onMouseOver="hilite(1235)" onMouseOut="lolite()" onClick="logVariable('select_SQL')" href="../../../../_variables/select_SQL.html">$select_SQL</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>() );
<a name="l369"><span class="linenum"> 369</span></a>  
<a name="l370"><span class="linenum"> 370</span></a>          <a class="var it1237" onMouseOver="hilite(1237)" onMouseOut="lolite()" onClick="logVariable('datetime')" href="../../../../_variables/datetime.html">$datetime</a> = <a class="phpfunction" onClick="logFunction('date')" href="../../../../_functions/date.html" onMouseOver="phpfuncPopup(event,'date')">date</a>( 'Y-m-d H:i:s', <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('localtimenow')" href="../../../../_variables/localtimenow.html">$localtimenow</a> );
<a name="l371"><span class="linenum"> 371</span></a>  
<a name="l372"><span class="linenum"> 372</span></a>          <a class="var it1454" onMouseOver="hilite(1454)" onMouseOut="lolite()" onClick="logVariable('update_sql')" href="../../../../_variables/update_sql.html">$update_sql</a> = 'UPDATE T_messaging__contact
<a name="l373"><span class="linenum"> 373</span></a>                      SET mct_last_contact_datetime = \''.<a class="var it1237" onMouseOver="hilite(1237)" onMouseOut="lolite()" onClick="logVariable('datetime')" href="../../../../_variables/datetime.html">$datetime</a>.'\'
<a name="l374"><span class="linenum"> 374</span></a>                      WHERE mct_from_user_ID = '.<a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('author_user_ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/author_user_ID.html">author_user_ID</a>.'
<a name="l375"><span class="linenum"> 375</span></a>                          AND mct_to_user_ID IN ('.<a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('recipients')" href="../../../../_variables/recipients.html">$recipients</a>.')';
<a name="l376"><span class="linenum"> 376</span></a>  
<a name="l377"><span class="linenum"> 377</span></a>          <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( <a class="var it1454" onMouseOver="hilite(1454)" onMouseOut="lolite()" onClick="logVariable('update_sql')" href="../../../../_variables/update_sql.html">$update_sql</a>, 'Update last contact datetimes' );
<a name="l378"><span class="linenum"> 378</span></a>  
<a name="l379"><span class="linenum"> 379</span></a>          return true;
<a name="l380"><span class="linenum"> 380</span></a>      }
<a name="l381"><span class="linenum"> 381</span></a>  
<a name="l382"><span class="linenum"> 382</span></a>  
<a name="l383"><span class="linenum"> 383</span></a>      <span class="comment">/**</span>
<a name="l384"><span class="linenum"> 384</span></a>  <span class="comment">     * Clone current message and convert cloned message from 'individual' to 'discussion'.</span>
<a name="l385"><span class="linenum"> 385</span></a>  <span class="comment">     *</span>
<a name="l386"><span class="linenum"> 386</span></a>  <span class="comment">     * @param instance of Message class</span>
<a name="l387"><span class="linenum"> 387</span></a>  <span class="comment">     * @return cloned message</span>
<a name="l388"><span class="linenum"> 388</span></a>  <span class="comment">     */</span>
<a name="l389"><span class="linenum"> 389</span></a>  	function <a class="function" onClick="logFunction('clone_message')" href="../../../../_functions/clone_message.html" onMouseOver="funcPopup(event,'clone_message')">clone_message</a>( <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a> )
<a name="l390"><span class="linenum"> 390</span></a>      {
<a name="l391"><span class="linenum"> 391</span></a>          <a class="var it1823" onMouseOver="hilite(1823)" onMouseOut="lolite()" onClick="logVariable('new_Message')" href="../../../../_variables/new_Message.html">$new_Message</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Message')" href="../../../../_classes/message.html" onMouseOver="classPopup(event,'message')">Message</a>();
<a name="l392"><span class="linenum"> 392</span></a>          <a class="var it1823" onMouseOver="hilite(1823)" onMouseOut="lolite()" onClick="logVariable('new_Message')" href="../../../../_variables/new_Message.html">$new_Message</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'text', <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a onClick="logVariable('text')" class="var it9044" onMouseOver="hilite(9044)" onMouseOut="lolite()" href="../../../../_variables/text.html">text</a> );
<a name="l393"><span class="linenum"> 393</span></a>          if( !empty( <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a onClick="logVariable('author_user_ID')" class="var it9044" onMouseOver="hilite(9044)" onMouseOut="lolite()" href="../../../../_variables/author_user_ID.html">author_user_ID</a> ) )
<a name="l394"><span class="linenum"> 394</span></a>          {
<a name="l395"><span class="linenum"> 395</span></a>              <a class="var it1823" onMouseOver="hilite(1823)" onMouseOut="lolite()" onClick="logVariable('new_Message')" href="../../../../_variables/new_Message.html">$new_Message</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'author_user_ID', <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a onClick="logVariable('author_user_ID')" class="var it9044" onMouseOver="hilite(9044)" onMouseOut="lolite()" href="../../../../_variables/author_user_ID.html">author_user_ID</a> );
<a name="l396"><span class="linenum"> 396</span></a>          }
<a name="l397"><span class="linenum"> 397</span></a>          if( !empty( <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a onClick="logVariable('creator_user_ID')" class="var it9044" onMouseOver="hilite(9044)" onMouseOut="lolite()" href="../../../../_variables/creator_user_ID.html">creator_user_ID</a> ) )
<a name="l398"><span class="linenum"> 398</span></a>          {
<a name="l399"><span class="linenum"> 399</span></a>              <a class="var it1823" onMouseOver="hilite(1823)" onMouseOut="lolite()" onClick="logVariable('new_Message')" href="../../../../_variables/new_Message.html">$new_Message</a>-&gt;<a onClick="logVariable('creator_user_ID')" class="var it9045" onMouseOver="hilite(9045)" onMouseOut="lolite()" href="../../../../_variables/creator_user_ID.html">creator_user_ID</a> = <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a onClick="logVariable('creator_user_ID')" class="var it9044" onMouseOver="hilite(9044)" onMouseOut="lolite()" href="../../../../_variables/creator_user_ID.html">creator_user_ID</a>;
<a name="l400"><span class="linenum"> 400</span></a>          }
<a name="l401"><span class="linenum"> 401</span></a>  
<a name="l402"><span class="linenum"> 402</span></a>          <a class="var it1824" onMouseOver="hilite(1824)" onMouseOut="lolite()" onClick="logVariable('new_Thread')" href="../../../../_variables/new_Thread.html">$new_Thread</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Thread')" href="../../../../_classes/thread.html" onMouseOver="classPopup(event,'thread')">Thread</a>();
<a name="l403"><span class="linenum"> 403</span></a>          <a class="var it1824" onMouseOver="hilite(1824)" onMouseOut="lolite()" onClick="logVariable('new_Thread')" href="../../../../_variables/new_Thread.html">$new_Thread</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'title', <a class="var it155" onMouseOver="hilite(155)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a onClick="logVariable('Thread')" class="var it9044" onMouseOver="hilite(9044)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a>-&gt;title );
<a name="l404"><span class="linenum"> 404</span></a>  
<a name="l405"><span class="linenum"> 405</span></a>          <a class="var it1823" onMouseOver="hilite(1823)" onMouseOut="lolite()" onClick="logVariable('new_Message')" href="../../../../_variables/new_Message.html">$new_Message</a>-&gt;<a onClick="logVariable('Thread')" class="var it9045" onMouseOver="hilite(9045)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a> = &amp; <a class="var it1824" onMouseOver="hilite(1824)" onMouseOut="lolite()" onClick="logVariable('new_Thread')" href="../../../../_variables/new_Thread.html">$new_Thread</a>;
<a name="l406"><span class="linenum"> 406</span></a>  
<a name="l407"><span class="linenum"> 407</span></a>          return <a class="var it1823" onMouseOver="hilite(1823)" onMouseOut="lolite()" onClick="logVariable('new_Message')" href="../../../../_variables/new_Message.html">$new_Message</a>;
<a name="l408"><span class="linenum"> 408</span></a>      }
<a name="l409"><span class="linenum"> 409</span></a>  
<a name="l410"><span class="linenum"> 410</span></a>  
<a name="l411"><span class="linenum"> 411</span></a>      <span class="comment">/**</span>
<a name="l412"><span class="linenum"> 412</span></a>  <span class="comment">     * Delete message and dependencies from database</span>
<a name="l413"><span class="linenum"> 413</span></a>  <span class="comment">     *</span>
<a name="l414"><span class="linenum"> 414</span></a>  <span class="comment">     * @param Log Log object where output gets added (by reference).</span>
<a name="l415"><span class="linenum"> 415</span></a>  <span class="comment">     */</span>
<a name="l416"><span class="linenum"> 416</span></a>  	function <a class="function" onClick="logFunction('dbdelete')" href="../../../../_functions/dbdelete.html" onMouseOver="funcPopup(event,'dbdelete')">dbdelete</a>()
<a name="l417"><span class="linenum"> 417</span></a>      {
<a name="l418"><span class="linenum"> 418</span></a>          global <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>;
<a name="l419"><span class="linenum"> 419</span></a>  
<a name="l420"><span class="linenum"> 420</span></a>          if( <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/ID.html">ID</a> == 0 ) <a class="function" onClick="logFunction('debug_die')" href="../../../../_functions/debug_die.html" onMouseOver="funcPopup(event,'debug_die')">debug_die</a>( 'Non persistant object cannot be deleted!' );
<a name="l421"><span class="linenum"> 421</span></a>  
<a name="l422"><span class="linenum"> 422</span></a>  <span class="comment">        // Remember ID, because parent method resets it to 0</span>
<a name="l423"><span class="linenum"> 423</span></a>          <a class="var it1807" onMouseOver="hilite(1807)" onMouseOut="lolite()" onClick="logVariable('thread_ID')" href="../../../../_variables/thread_ID.html">$thread_ID</a> = <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('thread_ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/thread_ID.html">thread_ID</a>;
<a name="l424"><span class="linenum"> 424</span></a>  
<a name="l425"><span class="linenum"> 425</span></a>          <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('begin')" href="../../../../_functions/begin.html" onMouseOver="funcPopup(event,'begin')">begin</a>();
<a name="l426"><span class="linenum"> 426</span></a>  
<a name="l427"><span class="linenum"> 427</span></a>  <span class="comment">        // UPDATE last unread msg_ID on this thread statuses from this message ID to the next message ID or NULL if there is no next message</span>
<a name="l428"><span class="linenum"> 428</span></a>          <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'UPDATE T_messaging__threadstatus
<a name="l429"><span class="linenum"> 429</span></a>                          SET tsta_first_unread_msg_ID =
<a name="l430"><span class="linenum"> 430</span></a>                              ( SELECT msg_ID
<a name="l431"><span class="linenum"> 431</span></a>                                  FROM T_messaging__message
<a name="l432"><span class="linenum"> 432</span></a>                                  WHERE msg_thread_ID = '.<a class="var it1807" onMouseOver="hilite(1807)" onMouseOut="lolite()" onClick="logVariable('thread_ID')" href="../../../../_variables/thread_ID.html">$thread_ID</a>.' AND msg_datetime &gt; '.<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('datetime')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/datetime.html">datetime</a> ).'
<a name="l433"><span class="linenum"> 433</span></a>                                  ORDER BY msg_datetime ASC
<a name="l434"><span class="linenum"> 434</span></a>                                  LIMIT 1
<a name="l435"><span class="linenum"> 435</span></a>                              )
<a name="l436"><span class="linenum"> 436</span></a>                          WHERE tsta_first_unread_msg_ID = '.<a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/ID.html">ID</a> );
<a name="l437"><span class="linenum"> 437</span></a>  
<a name="l438"><span class="linenum"> 438</span></a>  <span class="comment">        // Delete Message</span>
<a name="l439"><span class="linenum"> 439</span></a>          if( ! parent::<a class="function" onClick="logFunction('dbdelete')" href="../../../../_functions/dbdelete.html" onMouseOver="funcPopup(event,'dbdelete')">dbdelete</a>() )
<a name="l440"><span class="linenum"> 440</span></a>          {
<a name="l441"><span class="linenum"> 441</span></a>              <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('rollback')" href="../../../../_functions/rollback.html" onMouseOver="funcPopup(event,'rollback')">rollback</a>();
<a name="l442"><span class="linenum"> 442</span></a>  
<a name="l443"><span class="linenum"> 443</span></a>              return false;
<a name="l444"><span class="linenum"> 444</span></a>          }
<a name="l445"><span class="linenum"> 445</span></a>  
<a name="l446"><span class="linenum"> 446</span></a>  <span class="comment">        // Get a count of the messages in the current thread</span>
<a name="l447"><span class="linenum"> 447</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('SQL')" href="../../../../_variables/SQL.html">$SQL</a> = <span class="keyword">new </span><a class="class" onClick="logClass('SQL')" href="../../../../_classes/sql.html" onMouseOver="classPopup(event,'sql')">SQL</a>();
<a name="l448"><span class="linenum"> 448</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('SQL')" href="../../../../_variables/SQL.html">$SQL</a>-&gt;<a class="function" onClick="logFunction('SELECT')" href="../../../../_functions/select.html" onMouseOver="funcPopup(event,'select')">SELECT</a>( '<a class="phpfunction" onClick="logFunction('COUNT')" href="../../../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">COUNT</a>( msg_ID )' );
<a name="l449"><span class="linenum"> 449</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('SQL')" href="../../../../_variables/SQL.html">$SQL</a>-&gt;<a class="function" onClick="logFunction('FROM')" href="../../../../_functions/from.html" onMouseOver="funcPopup(event,'from')">FROM</a>( <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('dbtablename')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/dbtablename.html">dbtablename</a> );
<a name="l450"><span class="linenum"> 450</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('SQL')" href="../../../../_variables/SQL.html">$SQL</a>-&gt;<a class="function" onClick="logFunction('WHERE')" href="../../../../_functions/where.html" onMouseOver="funcPopup(event,'where')">WHERE</a>( 'msg_thread_ID = '.<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="var it1807" onMouseOver="hilite(1807)" onMouseOut="lolite()" onClick="logVariable('thread_ID')" href="../../../../_variables/thread_ID.html">$thread_ID</a> ) );
<a name="l451"><span class="linenum"> 451</span></a>          <a class="var it1825" onMouseOver="hilite(1825)" onMouseOut="lolite()" onClick="logVariable('msg_count')" href="../../../../_variables/msg_count.html">$msg_count</a> = <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_var')" href="../../../../_functions/get_var.html" onMouseOver="funcPopup(event,'get_var')">get_var</a>( <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('SQL')" href="../../../../_variables/SQL.html">$SQL</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>() );
<a name="l452"><span class="linenum"> 452</span></a>  
<a name="l453"><span class="linenum"> 453</span></a>          if( <a class="var it1825" onMouseOver="hilite(1825)" onMouseOut="lolite()" onClick="logVariable('msg_count')" href="../../../../_variables/msg_count.html">$msg_count</a> == 0 )
<a name="l454"><span class="linenum"> 454</span></a>          {    // Last message was deleted from thread now, We should also delete this thread
<a name="l455"><span class="linenum"> 455</span></a>              <a class="function" onClick="logFunction('load_class')" href="../../../../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( 'messaging/model/_thread.class.php', 'Thread' );
<a name="l456"><span class="linenum"> 456</span></a>              <a class="var it1814" onMouseOver="hilite(1814)" onMouseOut="lolite()" onClick="logVariable('ThreadCache')" href="../../../../_variables/ThreadCache.html">$ThreadCache</a> = &amp; get_ThreadCache();
<a name="l457"><span class="linenum"> 457</span></a>              <a class="var it1809" onMouseOver="hilite(1809)" onMouseOut="lolite()" onClick="logVariable('Thread')" href="../../../../_variables/Thread.html">$Thread</a> = &amp; <a class="var it1814" onMouseOver="hilite(1814)" onMouseOut="lolite()" onClick="logVariable('ThreadCache')" href="../../../../_variables/ThreadCache.html">$ThreadCache</a>-&gt;get_by_ID( <a class="var it1807" onMouseOver="hilite(1807)" onMouseOut="lolite()" onClick="logVariable('thread_ID')" href="../../../../_variables/thread_ID.html">$thread_ID</a> );
<a name="l458"><span class="linenum"> 458</span></a>              <a class="var it1809" onMouseOver="hilite(1809)" onMouseOut="lolite()" onClick="logVariable('Thread')" href="../../../../_variables/Thread.html">$Thread</a>-&gt;<a class="function" onClick="logFunction('dbdelete')" href="../../../../_functions/dbdelete.html" onMouseOver="funcPopup(event,'dbdelete')">dbdelete</a>();
<a name="l459"><span class="linenum"> 459</span></a>          }
<a name="l460"><span class="linenum"> 460</span></a>  
<a name="l461"><span class="linenum"> 461</span></a>          <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('commit')" href="../../../../_functions/commit.html" onMouseOver="funcPopup(event,'commit')">commit</a>();
<a name="l462"><span class="linenum"> 462</span></a>  
<a name="l463"><span class="linenum"> 463</span></a>          return true;
<a name="l464"><span class="linenum"> 464</span></a>      }
<a name="l465"><span class="linenum"> 465</span></a>  
<a name="l466"><span class="linenum"> 466</span></a>  
<a name="l467"><span class="linenum"> 467</span></a>      <span class="comment">/**</span>
<a name="l468"><span class="linenum"> 468</span></a>  <span class="comment">     * Check permission on a message</span>
<a name="l469"><span class="linenum"> 469</span></a>  <span class="comment">     *</span>
<a name="l470"><span class="linenum"> 470</span></a>  <span class="comment">     * @return boolean true if granted</span>
<a name="l471"><span class="linenum"> 471</span></a>  <span class="comment">     */</span>
<a name="l472"><span class="linenum"> 472</span></a>  	function <a class="function" onClick="logFunction('check_perm')" href="../../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../../_variables/action.html">$action</a>, <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('assert')" href="../../../../_variables/assert.html">$assert</a> = true )
<a name="l473"><span class="linenum"> 473</span></a>      {
<a name="l474"><span class="linenum"> 474</span></a>          global <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../../_variables/current_User.html">$current_User</a>;
<a name="l475"><span class="linenum"> 475</span></a>  
<a name="l476"><span class="linenum"> 476</span></a>          return <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'perm_messaging', <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../../_variables/action.html">$action</a>, <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('assert')" href="../../../../_variables/assert.html">$assert</a> );
<a name="l477"><span class="linenum"> 477</span></a>      }
<a name="l478"><span class="linenum"> 478</span></a>  
<a name="l479"><span class="linenum"> 479</span></a>  
<a name="l480"><span class="linenum"> 480</span></a>      <span class="comment">/**</span>
<a name="l481"><span class="linenum"> 481</span></a>  <span class="comment">     * Send email notification to recipients on new thread or new message event.</span>
<a name="l482"><span class="linenum"> 482</span></a>  <span class="comment">     *</span>
<a name="l483"><span class="linenum"> 483</span></a>  <span class="comment">     * @param boolean true if new thread, false if new message in the current thread</span>
<a name="l484"><span class="linenum"> 484</span></a>  <span class="comment">     * @param boolean the User who sent the message, in case of current User it may be NULL ( This is not the current User e.g. in case of welcome messages )</span>
<a name="l485"><span class="linenum"> 485</span></a>  <span class="comment">     * @return boolean True if all messages could be sent, false otherwise.</span>
<a name="l486"><span class="linenum"> 486</span></a>  <span class="comment">     */</span>
<a name="l487"><span class="linenum"> 487</span></a>  	function <a class="function" onClick="logFunction('send_email_notifications')" href="../../../../_functions/send_email_notifications.html" onMouseOver="funcPopup(event,'send_email_notifications')">send_email_notifications</a>( <a class="var it1813" onMouseOver="hilite(1813)" onMouseOut="lolite()" onClick="logVariable('new_thread')" href="../../../../_variables/new_thread.html">$new_thread</a> = true, <a class="var it1815" onMouseOver="hilite(1815)" onMouseOut="lolite()" onClick="logVariable('from_User')" href="../../../../_variables/from_User.html">$from_User</a> = NULL )
<a name="l488"><span class="linenum"> 488</span></a>      {
<a name="l489"><span class="linenum"> 489</span></a>          global <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>, <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../../_variables/current_User.html">$current_User</a>, <a class="var it346" onMouseOver="hilite(346)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../../../_variables/admin_url.html">$admin_url</a>, <a class="var it153" onMouseOver="hilite(153)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../../../_variables/baseurl.html">$baseurl</a>, <a class="var it137" onMouseOver="hilite(137)" onMouseOut="lolite()" onClick="logVariable('app_name')" href="../../../../_variables/app_name.html">$app_name</a>;
<a name="l490"><span class="linenum"> 490</span></a>          global <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../../../_variables/Settings.html">$Settings</a>, <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('UserSettings')" href="../../../../_variables/UserSettings.html">$UserSettings</a>, <a class="var it1826" onMouseOver="hilite(1826)" onMouseOut="lolite()" onClick="logVariable('servertimenow')" href="../../../../_variables/servertimenow.html">$servertimenow</a>;
<a name="l491"><span class="linenum"> 491</span></a>  
<a name="l492"><span class="linenum"> 492</span></a>  <span class="comment">        // Select recipients of the current thread:</span>
<a name="l493"><span class="linenum"> 493</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('SQL')" href="../../../../_variables/SQL.html">$SQL</a> = <span class="keyword">new </span><a class="class" onClick="logClass('SQL')" href="../../../../_classes/sql.html" onMouseOver="classPopup(event,'sql')">SQL</a>();
<a name="l494"><span class="linenum"> 494</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('SQL')" href="../../../../_variables/SQL.html">$SQL</a>-&gt;<a class="function" onClick="logFunction('SELECT')" href="../../../../_functions/select.html" onMouseOver="funcPopup(event,'select')">SELECT</a>( 'u.user_ID, us.uset_value as notify_messages' );
<a name="l495"><span class="linenum"> 495</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('SQL')" href="../../../../_variables/SQL.html">$SQL</a>-&gt;<a class="function" onClick="logFunction('FROM')" href="../../../../_functions/from.html" onMouseOver="funcPopup(event,'from')">FROM</a>( 'T_messaging__threadstatus ts
<a name="l496"><span class="linenum"> 496</span></a>                          INNER JOIN T_messaging__contact c
<a name="l497"><span class="linenum"> 497</span></a>                              ON ts.tsta_user_ID = c.mct_to_user_ID AND c.mct_from_user_ID = '.<a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('author_user_ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/author_user_ID.html">author_user_ID</a>.' AND c.mct_blocked = 0
<a name="l498"><span class="linenum"> 498</span></a>                          INNER JOIN T_users u
<a name="l499"><span class="linenum"> 499</span></a>                              ON ts.tsta_user_ID = u.user_ID
<a name="l500"><span class="linenum"> 500</span></a>                          LEFT OUTER JOIN T_users__usersettings us ON u.user_ID = us.uset_user_ID AND us.uset_name = &quot;notify_messages&quot;' );
<a name="l501"><span class="linenum"> 501</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('SQL')" href="../../../../_variables/SQL.html">$SQL</a>-&gt;<a class="function" onClick="logFunction('WHERE')" href="../../../../_functions/where.html" onMouseOver="funcPopup(event,'where')">WHERE</a>( 'ts.tsta_thread_ID = '.<a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('Thread')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/Thread.html">Thread</a>-&gt;ID.' AND ts.tsta_user_ID &lt;&gt; '.<a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('author_user_ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/author_user_ID.html">author_user_ID</a> );
<a name="l502"><span class="linenum"> 502</span></a>  
<a name="l503"><span class="linenum"> 503</span></a>          <a class="var it1827" onMouseOver="hilite(1827)" onMouseOut="lolite()" onClick="logVariable('thrd_recipients')" href="../../../../_variables/thrd_recipients.html">$thrd_recipients</a> = <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_assoc')" href="../../../../_functions/get_assoc.html" onMouseOver="funcPopup(event,'get_assoc')">get_assoc</a>( <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('SQL')" href="../../../../_variables/SQL.html">$SQL</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>() );
<a name="l504"><span class="linenum"> 504</span></a>  
<a name="l505"><span class="linenum"> 505</span></a>  <span class="comment">        // set message link:</span>
<a name="l506"><span class="linenum"> 506</span></a>          <a class="function" onClick="logFunction('list')" href="../../../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>( <a class="var it1828" onMouseOver="hilite(1828)" onMouseOut="lolite()" onClick="logVariable('message_link')" href="../../../../_variables/message_link.html">$message_link</a>, <a class="var it1829" onMouseOver="hilite(1829)" onMouseOut="lolite()" onClick="logVariable('prefs_link')" href="../../../../_variables/prefs_link.html">$prefs_link</a> ) = <a class="function" onClick="logFunction('get_messages_link_to')" href="../../../../_functions/get_messages_link_to.html" onMouseOver="funcPopup(event,'get_messages_link_to')">get_messages_link_to</a>( <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('thread_ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/thread_ID.html">thread_ID</a> );
<a name="l507"><span class="linenum"> 507</span></a>  
<a name="l508"><span class="linenum"> 508</span></a>  <span class="comment">        // Construct message subject and body:</span>
<a name="l509"><span class="linenum"> 509</span></a>          if( <a class="var it1813" onMouseOver="hilite(1813)" onMouseOut="lolite()" onClick="logVariable('new_thread')" href="../../../../_variables/new_thread.html">$new_thread</a> )
<a name="l510"><span class="linenum"> 510</span></a>          {
<a name="l511"><span class="linenum"> 511</span></a>              <a class="var it1308" onMouseOver="hilite(1308)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../../../../_variables/subject.html">$subject</a> = <a class="function" onClick="logFunction('NT_')" href="../../../../_functions/nt_.html" onMouseOver="funcPopup(event,'nt_')">NT_</a>( '%s just sent you a <span class="keyword">new </span><a class="class" onClick="logClass('message')" href="../../../../_classes/message.html" onMouseOver="classPopup(event,'message')">message</a>!' );
<a name="l512"><span class="linenum"> 512</span></a>          }
<a name="l513"><span class="linenum"> 513</span></a>          elseif( <a class="phpfunction" onClick="logFunction('count')" href="../../../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>( <a class="var it1827" onMouseOver="hilite(1827)" onMouseOut="lolite()" onClick="logVariable('thrd_recipients')" href="../../../../_variables/thrd_recipients.html">$thrd_recipients</a> ) == 1 )
<a name="l514"><span class="linenum"> 514</span></a>          {
<a name="l515"><span class="linenum"> 515</span></a>              <a class="var it1308" onMouseOver="hilite(1308)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../../../../_variables/subject.html">$subject</a> = <a class="function" onClick="logFunction('NT_')" href="../../../../_functions/nt_.html" onMouseOver="funcPopup(event,'nt_')">NT_</a>( '%s just replied to your message!' );
<a name="l516"><span class="linenum"> 516</span></a>          }
<a name="l517"><span class="linenum"> 517</span></a>          else
<a name="l518"><span class="linenum"> 518</span></a>          {
<a name="l519"><span class="linenum"> 519</span></a>              <a class="var it1308" onMouseOver="hilite(1308)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../../../../_variables/subject.html">$subject</a> = <a class="function" onClick="logFunction('NT_')" href="../../../../_functions/nt_.html" onMouseOver="funcPopup(event,'nt_')">NT_</a>( '%s just replied to a conversation you are involved in!' );
<a name="l520"><span class="linenum"> 520</span></a>          }
<a name="l521"><span class="linenum"> 521</span></a>  
<a name="l522"><span class="linenum"> 522</span></a>  <span class="comment">        // Get other unread threads</span>
<a name="l523"><span class="linenum"> 523</span></a>          <a class="var it1830" onMouseOver="hilite(1830)" onMouseOut="lolite()" onClick="logVariable('other_unread_threads')" href="../../../../_variables/other_unread_threads.html">$other_unread_threads</a> = <a class="function" onClick="logFunction('get_users_unread_threads')" href="../../../../_functions/get_users_unread_threads.html" onMouseOver="funcPopup(event,'get_users_unread_threads')">get_users_unread_threads</a>( <a class="phpfunction" onClick="logFunction('array_keys')" href="../../../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>( <a class="var it1827" onMouseOver="hilite(1827)" onMouseOut="lolite()" onClick="logVariable('thrd_recipients')" href="../../../../_variables/thrd_recipients.html">$thrd_recipients</a> ), <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('thread_ID')" class="var it8951" onMouseOver="hilite(8951)" onMouseOut="lolite()" href="../../../../_variables/thread_ID.html">thread_ID</a>, 'array', 'html' );
<a name="l524"><span class="linenum"> 524</span></a>  
<a name="l525"><span class="linenum"> 525</span></a>  <span class="comment">        // Load all users who will be notified</span>
<a name="l526"><span class="linenum"> 526</span></a>          <a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('UserCache')" href="../../../../_variables/UserCache.html">$UserCache</a> = &amp; get_UserCache();
<a name="l527"><span class="linenum"> 527</span></a>          <a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('UserCache')" href="../../../../_variables/UserCache.html">$UserCache</a>-&gt;<a class="function" onClick="logFunction('load_list')" href="../../../../_functions/load_list.html" onMouseOver="funcPopup(event,'load_list')">load_list</a>( <a class="phpfunction" onClick="logFunction('array_keys')" href="../../../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>( <a class="var it1827" onMouseOver="hilite(1827)" onMouseOut="lolite()" onClick="logVariable('thrd_recipients')" href="../../../../_variables/thrd_recipients.html">$thrd_recipients</a> ) );
<a name="l528"><span class="linenum"> 528</span></a>  
<a name="l529"><span class="linenum"> 529</span></a>  <span class="comment">        // Send email notifications.</span>
<a name="l530"><span class="linenum"> 530</span></a>          <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('ret')" href="../../../../_variables/ret.html">$ret</a> = true;
<a name="l531"><span class="linenum"> 531</span></a>          <a class="var it1831" onMouseOver="hilite(1831)" onMouseOut="lolite()" onClick="logVariable('def_notify_messages')" href="../../../../_variables/def_notify_messages.html">$def_notify_messages</a> = <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../../../_variables/Settings.html">$Settings</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>( 'def_notify_messages' );
<a name="l532"><span class="linenum"> 532</span></a>          foreach( <a class="var it1827" onMouseOver="hilite(1827)" onMouseOut="lolite()" onClick="logVariable('thrd_recipients')" href="../../../../_variables/thrd_recipients.html">$thrd_recipients</a> as <a class="var it1252" onMouseOver="hilite(1252)" onMouseOut="lolite()" onClick="logVariable('recipient_ID')" href="../../../../_variables/recipient_ID.html">$recipient_ID</a> =&gt; <a class="var it1832" onMouseOver="hilite(1832)" onMouseOut="lolite()" onClick="logVariable('notify_messages')" href="../../../../_variables/notify_messages.html">$notify_messages</a> )
<a name="l533"><span class="linenum"> 533</span></a>          { // Send mail to recipients who needs to be notified. recipients are already loaded into the UserCache
<a name="l534"><span class="linenum"> 534</span></a>              if( !( <a class="var it1832" onMouseOver="hilite(1832)" onMouseOut="lolite()" onClick="logVariable('notify_messages')" href="../../../../_variables/notify_messages.html">$notify_messages</a> || ( <a class="phpfunction" onClick="logFunction('is_null')" href="../../../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>( <a class="var it1832" onMouseOver="hilite(1832)" onMouseOut="lolite()" onClick="logVariable('notify_messages')" href="../../../../_variables/notify_messages.html">$notify_messages</a> ) &amp;&amp; <a class="var it1831" onMouseOver="hilite(1831)" onMouseOut="lolite()" onClick="logVariable('def_notify_messages')" href="../../../../_variables/def_notify_messages.html">$def_notify_messages</a> ) ) )
<a name="l535"><span class="linenum"> 535</span></a>              { // User should NOT be notified
<a name="l536"><span class="linenum"> 536</span></a>                  continue;
<a name="l537"><span class="linenum"> 537</span></a>              }
<a name="l538"><span class="linenum"> 538</span></a>  
<a name="l539"><span class="linenum"> 539</span></a>              <a class="var it367" onMouseOver="hilite(367)" onMouseOut="lolite()" onClick="logVariable('email_template_params')" href="../../../../_variables/email_template_params.html">$email_template_params</a> = array(
<a name="l540"><span class="linenum"> 540</span></a>                      'recipient_ID'         =&gt; <a class="var it1252" onMouseOver="hilite(1252)" onMouseOut="lolite()" onClick="logVariable('recipient_ID')" href="../../../../_variables/recipient_ID.html">$recipient_ID</a>,
<a name="l541"><span class="linenum"> 541</span></a>                      'new_thread'           =&gt; <a class="var it1813" onMouseOver="hilite(1813)" onMouseOut="lolite()" onClick="logVariable('new_thread')" href="../../../../_variables/new_thread.html">$new_thread</a>,
<a name="l542"><span class="linenum"> 542</span></a>                      'thrd_recipients'      =&gt; <a class="var it1827" onMouseOver="hilite(1827)" onMouseOut="lolite()" onClick="logVariable('thrd_recipients')" href="../../../../_variables/thrd_recipients.html">$thrd_recipients</a>,
<a name="l543"><span class="linenum"> 543</span></a>                      'Message'              =&gt; <a class="var it17" onMouseOver="hilite(17)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>,
<a name="l544"><span class="linenum"> 544</span></a>                      'message_link'         =&gt; <a class="var it1828" onMouseOver="hilite(1828)" onMouseOut="lolite()" onClick="logVariable('message_link')" href="../../../../_variables/message_link.html">$message_link</a>,
<a name="l545"><span class="linenum"> 545</span></a>                      'other_unread_threads' =&gt; <a class="var it1830" onMouseOver="hilite(1830)" onMouseOut="lolite()" onClick="logVariable('other_unread_threads')" href="../../../../_variables/other_unread_threads.html">$other_unread_threads</a>[<a class="var it1252" onMouseOver="hilite(1252)" onMouseOut="lolite()" onClick="logVariable('recipient_ID')" href="../../../../_variables/recipient_ID.html">$recipient_ID</a>],
<a name="l546"><span class="linenum"> 546</span></a>                      'from_User'            =&gt; <a class="var it1815" onMouseOver="hilite(1815)" onMouseOut="lolite()" onClick="logVariable('from_User')" href="../../../../_variables/from_User.html">$from_User</a>,
<a name="l547"><span class="linenum"> 547</span></a>                  );
<a name="l548"><span class="linenum"> 548</span></a>              <a class="var it1833" onMouseOver="hilite(1833)" onMouseOut="lolite()" onClick="logVariable('notify_User')" href="../../../../_variables/notify_User.html">$notify_User</a> = <a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('UserCache')" href="../../../../_variables/UserCache.html">$UserCache</a>-&gt;get_by_ID( <a class="var it1252" onMouseOver="hilite(1252)" onMouseOut="lolite()" onClick="logVariable('recipient_ID')" href="../../../../_variables/recipient_ID.html">$recipient_ID</a> );
<a name="l549"><span class="linenum"> 549</span></a>  <span class="comment">            // Change locale here to localize the email subject and content</span>
<a name="l550"><span class="linenum"> 550</span></a>              <a class="function" onClick="logFunction('locale_temp_switch')" href="../../../../_functions/locale_temp_switch.html" onMouseOver="funcPopup(event,'locale_temp_switch')">locale_temp_switch</a>( <a class="var it1833" onMouseOver="hilite(1833)" onMouseOut="lolite()" onClick="logVariable('notify_User')" href="../../../../_variables/notify_User.html">$notify_User</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>( 'locale' ) );
<a name="l551"><span class="linenum"> 551</span></a>              <a class="var it1834" onMouseOver="hilite(1834)" onMouseOut="lolite()" onClick="logVariable('sender_login')" href="../../../../_variables/sender_login.html">$sender_login</a> = ( <a class="var it1815" onMouseOver="hilite(1815)" onMouseOut="lolite()" onClick="logVariable('from_User')" href="../../../../_variables/from_User.html">$from_User</a> === NULL ) ? <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../../_variables/current_User.html">$current_User</a>-&gt;<a onClick="logVariable('login')" class="var it8987" onMouseOver="hilite(8987)" onMouseOut="lolite()" href="../../../../_variables/login.html">login</a> : <a class="var it1815" onMouseOver="hilite(1815)" onMouseOut="lolite()" onClick="logVariable('from_User')" href="../../../../_variables/from_User.html">$from_User</a>-&gt;<a onClick="logVariable('login')" class="var it9046" onMouseOver="hilite(9046)" onMouseOut="lolite()" href="../../../../_variables/login.html">login</a>;
<a name="l552"><span class="linenum"> 552</span></a>              <a class="var it1835" onMouseOver="hilite(1835)" onMouseOut="lolite()" onClick="logVariable('localized_subject')" href="../../../../_variables/localized_subject.html">$localized_subject</a> = sprintf( <a class="function" onClick="logFunction('T_')" href="../../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>( <a class="var it1308" onMouseOver="hilite(1308)" onMouseOut="lolite()" onClick="logVariable('subject')" href="../../../../_variables/subject.html">$subject</a> ), <a class="var it1834" onMouseOver="hilite(1834)" onMouseOut="lolite()" onClick="logVariable('sender_login')" href="../../../../_variables/sender_login.html">$sender_login</a> );
<a name="l553"><span class="linenum"> 553</span></a>  <span class="comment">            // Note: Not activated users won't get notification email</span>
<a name="l554"><span class="linenum"> 554</span></a>              if( <a class="function" onClick="logFunction('send_mail_to_User')" href="../../../../_functions/send_mail_to_user.html" onMouseOver="funcPopup(event,'send_mail_to_user')">send_mail_to_User</a>( <a class="var it1252" onMouseOver="hilite(1252)" onMouseOut="lolite()" onClick="logVariable('recipient_ID')" href="../../../../_variables/recipient_ID.html">$recipient_ID</a>, <a class="var it1835" onMouseOver="hilite(1835)" onMouseOut="lolite()" onClick="logVariable('localized_subject')" href="../../../../_variables/localized_subject.html">$localized_subject</a>, 'private_message_new', <a class="var it367" onMouseOver="hilite(367)" onMouseOut="lolite()" onClick="logVariable('email_template_params')" href="../../../../_variables/email_template_params.html">$email_template_params</a> ) )
<a name="l555"><span class="linenum"> 555</span></a>              { // email sent successful, update las_unread_message_reminder timestamp, because the notification contains all unread messages
<a name="l556"><span class="linenum"> 556</span></a>                  <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('UserSettings')" href="../../../../_variables/UserSettings.html">$UserSettings</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'last_unread_messages_reminder', <a class="function" onClick="logFunction('date2mysql')" href="../../../../_functions/date2mysql.html" onMouseOver="funcPopup(event,'date2mysql')">date2mysql</a>( <a class="var it1826" onMouseOver="hilite(1826)" onMouseOut="lolite()" onClick="logVariable('servertimenow')" href="../../../../_variables/servertimenow.html">$servertimenow</a> ), <a class="var it1252" onMouseOver="hilite(1252)" onMouseOut="lolite()" onClick="logVariable('recipient_ID')" href="../../../../_variables/recipient_ID.html">$recipient_ID</a> );
<a name="l557"><span class="linenum"> 557</span></a>              }
<a name="l558"><span class="linenum"> 558</span></a>              else
<a name="l559"><span class="linenum"> 559</span></a>              { // message was not sent
<a name="l560"><span class="linenum"> 560</span></a>                  <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('ret')" href="../../../../_variables/ret.html">$ret</a> = false;
<a name="l561"><span class="linenum"> 561</span></a>              }
<a name="l562"><span class="linenum"> 562</span></a>              <a class="function" onClick="logFunction('locale_restore_previous')" href="../../../../_functions/locale_restore_previous.html" onMouseOver="funcPopup(event,'locale_restore_previous')">locale_restore_previous</a>();
<a name="l563"><span class="linenum"> 563</span></a>          }
<a name="l564"><span class="linenum"> 564</span></a>  <span class="comment">        // update reminder timestamp changes</span>
<a name="l565"><span class="linenum"> 565</span></a>          <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('UserSettings')" href="../../../../_variables/UserSettings.html">$UserSettings</a>-&gt;<a class="function" onClick="logFunction('dbupdate')" href="../../../../_functions/dbupdate.html" onMouseOver="funcPopup(event,'dbupdate')">dbupdate</a>();
<a name="l566"><span class="linenum"> 566</span></a>          return <a class="var it157" onMouseOver="hilite(157)" onMouseOut="lolite()" onClick="logVariable('ret')" href="../../../../_variables/ret.html">$ret</a>;
<a name="l567"><span class="linenum"> 567</span></a>      }
<a name="l568"><span class="linenum"> 568</span></a>  }
<a name="l569"><span class="linenum"> 569</span></a>  
<a name="l570"><span class="linenum"> 570</span></a>  ?&gt;
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'send_email_notifications': ['send_email_notifications', 'Send email notification to recipients on new thread or new message event. ', [['blogs/inc/messaging/model','_message.class.php',480],['blogs/inc/comments/model','_comment.class.php',3143],['blogs/inc/items/model','_item.class.php',5538]], 7],
'get_users_unread_threads': ['get_users_unread_threads', 'Get all those user threads and their recipients where the corresponding users have unread messages. This function is used for the different email notifications. ', [['blogs/inc/messaging/model','_messaging.funcs.php',470]], 3],
'get_var': ['get_var', 'Get one variable from the DB - see docs for more detail ', [['blogs/inc/_core/model/db','_db.class.php',961]], 137],
't_': ['t_', 'TRANSLATE! ', [['blogs/inc/locales','_locale.funcs.php',48],['blogs/inc/locales','_locale.funcs.php',240],['blogs/inc/skins/model','_skin.class.php',672],['blogs/inc/_core/model','_module.class.php',79],['blogs/rsc/js','blog_widgets.js',422],['blogs/inc/plugins','_plugin.class.php',2617]], 10201],
'dbdelete': ['dbdelete', 'Delete message and dependencies from database ', [['blogs/inc/messaging/model','_message.class.php',411],['blogs/inc/users/model','_group.class.php',489],['blogs/inc/collections/model','_blog.class.php',2361],['blogs/inc/users/model','_user.class.php',2998],['blogs/inc/comments/model','_comment.class.php',3568],['blogs/inc/items/model','_item.class.php',5055],['blogs/inc/messaging/model','_thread.class.php',418],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',331]], 57],
'get_results': ['get_results', 'Return the the query as a result set - see docs for more details ', [['blogs/inc/_core/model/db','_db.class.php',1092]], 140],
'check_allow_reply': ['check_allow_reply', 'Check if current User is allowed to reply on this thread. Users are allowed to reply only to those threads where they are involved and there is at least one user between the recipients who didn\'t block the User. Note: Currently it doesn\'t matter if the sender is in the recipients user\'s contact list or not except in that case when the sender is blocked. ', [['blogs/inc/messaging/model','_thread.class.php',502]], 1],
'select': ['select', 'Set SELECT clause ', [['blogs/inc/_core/model/db','_sql.class.php',194],['blogs/inc/_core/model/db','_db.class.php',466],['blogs/inc/_core/ui/forms','_form.class.php',1820]], 461],
'get_assoc': ['get_assoc', 'Function to get the second column from the cached result indexed by the first column ', [['blogs/inc/_core/model/db','_db.class.php',1066]], 49],
'dbinsert_discussion': ['dbinsert_discussion', '', [['blogs/inc/messaging/model','_message.class.php',143]], 2],
'clone_message': ['clone_message', 'Clone current message and convert cloned message from \'individual\' to \'discussion\'. ', [['blogs/inc/messaging/model','_message.class.php',383]], 1],
'param_errors_detected': ['param_errors_detected', 'Check if there have been validation errors ', [['blogs/inc/_core','_param.funcs.php',1475]], 56],
'get_param': ['get_param', 'Get param value. ', [['blogs/inc/widgets/model','_widget.class.php',295],['blogs/inc/_core','_param.funcs.php',1689]], 274],
'dbinsert_threadstatus': ['dbinsert_threadstatus', 'Insert recipients into database ', [['blogs/inc/messaging/model','_message.class.php',258]], 1],
'from': ['from', '', [['blogs/inc/_core/model/db','_sql.class.php',219]], 380],
'get_messages_link_to': ['get_messages_link_to', 'Get messaging urls for the messaging notification emails ', [['blogs/inc/messaging/model','_messaging.funcs.php',292]], 2],
'locale_restore_previous': ['locale_restore_previous', 'Restore the locale in use before the switch ', [['blogs/inc/locales','_locale.funcs.php',295]], 58],
'dbupdate': ['dbupdate', 'Update the DB based on previously recorded changes ', [['blogs/inc/chapters/model','_chapter.class.php',317],['blogs/inc/collections/model','_collsettings.class.php',260],['blogs/inc/users/model','_group.class.php',470],['blogs/inc/widgets/model','_widget.class.php',757],['blogs/inc/collections/model','_blog.class.php',2327],['blogs/inc/settings/model','_abstractsettings.class.php',593],['blogs/inc/users/model','_user.class.php',2934],['blogs/inc/skins/model','_skin.class.php',348],['blogs/inc/comments/model','_comment.class.php',3470],['blogs/inc/users/model','_groupsettings.class.php',159],['blogs/inc/cron/model','_cronjob.class.php',207],['blogs/inc/items/model','_item.class.php',4867],['blogs/inc/slugs/model','_slug.class.php',265],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',129],['blogs/inc/files/model','_file.class.php',1739]], 266],
'load_from_request': ['load_from_request', 'Init filter params from Request params ', [['blogs/inc/items/model','_itemlistlight.class.php',336],['blogs/inc/chapters/model','_chapter.class.php',98],['blogs/inc/users/model','_userfield.class.php',179],['blogs/inc/generic/model','_genericelement.class.php',82],['blogs/inc/messaging/model','_message.class.php',89],['blogs/inc/sessions/model','_goalcat.class.php',55],['blogs/inc/users/model','_group.class.php',118],['blogs/inc/widgets/model','_widget.class.php',145],['blogs/inc/regional/model','_region.class.php',78],['blogs/inc/regional/model','_city.class.php',80],['blogs/inc/collections/model','_blog.class.php',300],['blogs/inc/users/model','_user.class.php',272],['blogs/inc/users/model','_userlist.class.php',253],['blogs/inc/generic/model','_genericcategory.class.php',80],['blogs/inc/tools/model','_emailaddress.class.php',99],['blogs/inc/skins/model','_skin.class.php',136],['blogs/inc/items/model','_itemtype.class.php',78],['blogs/inc/regional/model','_country.class.php',82],['blogs/inc/email_campaigns/model','_emailcampaign.class.php',186],['blogs/inc/cron/model','_cronjob.class.php',122],['blogs/inc/items/model','_item.class.php',522],['blogs/inc/files/model','_filetype.class.php',84],['blogs/inc/comments/model','_commentlist.class.php',266],['blogs/inc/sessions/model','_domain.class.php',63],['blogs/inc/users/model','_userfieldgroup.class.php',73],['blogs/inc/slugs/model','_slug.class.php',94],['blogs/inc/regional/model','_currency.class.php',74],['blogs/inc/messaging/model','_thread.class.php',160],['blogs/inc/maintenance/model','_backup.class.php',169],['blogs/inc/widgets/widgets','_coll_tag_cloud.widget.php',49],['blogs/inc/regional/model','_subregion.class.php',90],['blogs/inc/antispam/model','_iprange.class.php',95],['blogs/inc/sessions/model','_goal.class.php',110]], 79],
'list': ['list', '', [['blogs/rsc/js/bootstrap','typeahead.bundle.js',156]], 95],
'begin': ['begin', 'BEGIN A TRANSCATION ', [['blogs/inc/_core/model/db','_db.class.php',1547]], 101],
'debug_die': ['debug_die', 'Outputs Unexpected Error message. When in debug mode it also prints a backtrace. ', [['blogs/inc/_core','_misc.funcs.php',2535]], 216],
'date2mysql': ['date2mysql', 'Convert timestamp to MySQL/ISO format. ', [['blogs/inc/_core','_misc.funcs.php',1238]], 40],
'param': ['param', 'Sets a parameter with values from the request or to provided default, except if param is already set! ', [['blogs/inc/_core','_param.funcs.php',50]], 1906],
'message': ['message', 'Constructor ', [['blogs/inc/messaging/model','_message.class.php',65]], 16],
'send_mail_to_user': ['send_mail_to_user', 'Sends an email to User ', [['blogs/inc/_core','_misc.funcs.php',3538]], 13],
'get': ['get', '', [['blogs/plugins/tinymce_plugin/tiny_mce','tiny_mce_src.js',941],['blogs/plugins/tinymce_plugin/tiny_mce','tiny_mce_src.js',15011],['blogs/plugins/tinymce_plugin/tiny_mce/plugins/media/js','media.js',7],['blogs/inc/links/model','_linkowner.class.php',221],['blogs/inc/_core/model/db','_sql.class.php',64],['blogs/inc/plugins/model','_pluginsettings.class.php',58],['blogs/inc/collections/model','_blog.class.php',1822],['blogs/inc/settings/model','_generalsettings.class.php',383],['blogs/inc/settings/model','_abstractsettings.class.php',271],['blogs/inc/plugins/model','_pluginusersettings.class.php',58],['blogs/inc/users/model','_user.class.php',1126],['blogs/plugins/tinymce_plugin/tiny_mce','tiny_mce_gzip.js',38],['blogs/inc/users/model','_usersettings.class.php',151],['blogs/inc/comments/model','_comment.class.php',301],['blogs/inc/users/model','_groupsettings.class.php',124],['blogs/inc/cron/model','_cronjob.class.php',104],['blogs/inc/items/model','_item.class.php',5742],['blogs/inc/sessions/model','_session.class.php',397],['blogs/inc/links/model','_linkuser.class.php',141],['blogs/inc/links/model','_linkitem.class.php',155],['blogs/inc/slugs/model','_slug.class.php',68],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',574],['blogs/plugins/twitter_plugin/twitteroauth','twitteroauth.php',146],['blogs/inc/antispam/model','_iprange.class.php',69],['blogs/inc/links/model','_linkcomment.class.php',132],['blogs/inc/files/model','_file.class.php',532]], 2417],
'commit': ['commit', 'Commit current transaction ', [['blogs/inc/_core/model/db','_db.class.php',1591]], 114],
'load_class': ['load_class', 'Load class file ', [['blogs/inc/_core','_class4.funcs.php',28],['blogs/inc/_core','_class5.funcs.php',79]], 408],
'set_param': ['set_param', 'Set the value of a param (by force! :P) ', [['blogs/inc/_core','_param.funcs.php',1673],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',630]], 111],
'load_recipients': ['load_recipients', 'Load recipients of the current thread ', [['blogs/inc/messaging/model','_thread.class.php',449]], 5],
'nt_': ['nt_', 'No Translation. Does nothing. ', [['blogs/conf','_locales.php',15]], 204],
'dbinsert_contacts': ['dbinsert_contacts', 'Insert contacts into database ', [['blogs/inc/messaging/model','_message.class.php',281]], 2],
'load_list': ['load_list', 'Load a list of objects into the cache. ', [['blogs/inc/_core/model/dataobjects','_dataobjectcache.class.php',233]], 17],
'query': ['query', 'Run Query: GET DATA ROWS *** HEAVY *** ', [['blogs/inc/items/model','_itemlist.class.php',256],['blogs/inc/items/model','_itemlistlight.class.php',751],['blogs/inc/_core/model/db','_db.class.php',761],['blogs/inc/users/model','_userlist.class.php',474],['blogs/inc/_core/ui/results','_results.class.php',439],['blogs/inc/comments/model','_commentlist.class.php',515]], 972],
'quote': ['quote', 'Quote a msgid/msgstr, preferrable with single quotes. ', [['blogs/inc/locales','_pofile.class.php',267],['blogs/inc/_core/model/db','_db.class.php',503]], 791],
'param_check_not_empty': ['param_check_not_empty', '', [['blogs/inc/_core','_param.funcs.php',575]], 38],
'check_perm': ['check_perm', 'Check permission on a message ', [['blogs/inc/messaging/model','_message.class.php',467],['blogs/inc/users/model','_group.class.php',257],['blogs/inc/users/model','_user.class.php',2022],['blogs/inc/links/model','_linkuser.class.php',51],['blogs/inc/links/model','_linkitem.class.php',54],['blogs/inc/_core/model','_module.class.php',233],['blogs/inc/messaging/model','_thread.class.php',476],['blogs/inc/links/model','_linkcomment.class.php',53],['blogs/inc/sessions/model','_goal.class.php',92]], 967],
'dbinsert': ['dbinsert', 'Insert object into DB based on previously recorded changes. ', [['blogs/inc/chapters/model','_chapter.class.php',287],['blogs/inc/generic/model','_genericordered.class.php',101],['blogs/inc/users/model','_group.class.php',451],['blogs/inc/widgets/model','_widget.class.php',725],['blogs/inc/collections/model','_blog.class.php',2171],['blogs/inc/users/model','_user.class.php',2872],['blogs/inc/skins/model','_skin.class.php',370],['blogs/inc/comments/model','_comment.class.php',3511],['blogs/inc/items/model','_item.class.php',4685],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',210],['blogs/inc/files/model','_file.class.php',1698]], 93],
'dbupdate_last_contact_datetime': ['dbupdate_last_contact_datetime', 'Update last contact datetimes ', [['blogs/inc/messaging/model','_message.class.php',349]], 2],
'set': ['set', 'Set param value ', [['blogs/inc/users/model','_userfield.class.php',243],['blogs/inc/generic/model','_genericordered.class.php',75],['blogs/inc/users/model','_group.class.php',204],['blogs/inc/items/model','_itemlight.class.php',1258],['blogs/inc/plugins/model','_pluginsettings.class.php',70],['blogs/inc/widgets/model','_widget.class.php',321],['blogs/inc/regional/model','_region.class.php',102],['blogs/inc/regional/model','_city.class.php',110],['blogs/inc/collections/model','_blog.class.php',1102],['blogs/inc/settings/model','_abstractsettings.class.php',446],['blogs/inc/plugins/model','_pluginusersettings.class.php',82],['blogs/inc/users/model','_user.class.php',1861],['blogs/inc/generic/model','_genericcategory.class.php',100],['blogs/inc/tools/model','_emailaddress.class.php',85],['blogs/inc/users/model','_usersettings.class.php',187],['blogs/inc/regional/model','_country.class.php',106],['blogs/inc/comments/model','_comment.class.php',315],['blogs/inc/users/model','_groupsettings.class.php',140],['blogs/inc/cron/model','_cronjob.class.php',79],['blogs/inc/items/model','_item.class.php',4497],['blogs/inc/files/model','_filetype.class.php',149],['blogs/inc/users/model','_userfieldgroup.class.php',92],['blogs/inc/sessions/model','_session.class.php',420],['blogs/plugins','_calendar.plugin.php',530],['blogs/inc/slugs/model','_slug.class.php',80],['blogs/inc/regional/model','_currency.class.php',96],['blogs/inc/messaging/model','_thread.class.php',185],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',614],['blogs/inc/regional/model','_subregion.class.php',119],['blogs/inc/antispam/model','_iprange.class.php',81],['blogs/inc/sessions/model','_goal.class.php',199]], 1121],
'dbinsert_message': ['dbinsert_message', 'Insert message in existing thread ', [['blogs/inc/messaging/model','_message.class.php',204]], 1],
'locale_temp_switch': ['locale_temp_switch', 'Temporarily switch to another locale ', [['blogs/inc/locales','_locale.funcs.php',264],['blogs/inc/items/model','_itemlight.class.php',858]], 58],
'dataobject': ['dataobject', 'Constructor ', [['blogs/inc/_core/model/dataobjects','_dataobject.class.php',89]], 30],
'where': ['where', '', [['blogs/inc/_core/model/db','_sql.class.php',240]], 238],
'dbinsert_individual': ['dbinsert_individual', 'Insert new thread for each recipient ', [['blogs/inc/messaging/model','_message.class.php',180]], 2],
'rollback': ['rollback', 'Rollback current transaction ', [['blogs/inc/_core/model/db','_db.class.php',1621]], 38],
'count': ['count', '', [], 754],
'is_null': ['is_null', '', [], 251],
'array_diff': ['array_diff', '', [], 26],
'defined': ['defined', '', [], 874],
'array_keys': ['array_keys', '', [], 69],
'date': ['date', '', [], 361],
'implode': ['implode', '', [], 456]};
CLASS_DATA={
'thread': ['thread', 'Thread Class ', [['blogs/inc/messaging/model','_thread.class.php',29]], 30],
'sql': ['sql', 'SQL class: help constructing queries ', [['blogs/inc/_core/model/db','_sql.class.php',32]], 273],
'message': ['message', 'Message Class ', [['blogs/inc/messaging/model','_message.class.php',29]], 25],
'dataobject': ['dataobject', 'Data Object Base Class ', [['blogs/inc/_core/model/dataobjects','_dataobject.class.php',42]], 32]};
CONST_DATA={
'EVO_MAIN_INIT': ['EVO_MAIN_INIT', '', [['blogs/inc','_main.inc.php',55],['blogs/install','index.php',25],['blogs/install','debug.php',22]], 827]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Sat Jul  5 12:18:44 2014</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>

<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /blogs/inc/plugins/plugins.ctrl.php source</title>
    <link rel="stylesheet" href="../../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Sat Jul  5 12:18:44 2014 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../../';
subdir='blogs/inc/plugins';
filename='plugins.ctrl.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/blogs/inc/plugins/</a> -> <a href="plugins.ctrl.php.html">plugins.ctrl.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="plugins.ctrl.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="plugins.ctrl.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">/**</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment"> * This file implements the UI controller for plugins management.</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment"> *</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment"> * This file is part of the evoCore framework - {@link http://evocore.net/}</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment"> * See also {@link http://sourceforge.net/projects/evocms/}.</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment"> *</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment"> * @copyright (c)2003-2014 by Francois Planque - {@link http://fplanque.com/}</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment"> * Parts of this file are copyright (c)2004-2006 by Daniel HAHLER - {@link http://thequod.de/contact}.</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment"> *</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment"> * {@internal License choice</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment"> * - If you have received this file as part of a package, please find the license.txt file in</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment"> *   the same folder or the closest folder above for complete license terms.</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment"> * - If you have received this file individually (e-g: from http://evocms.cvs.sourceforge.net/)</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment"> *   then you must choose one of the following licenses before using the file:</span>
<a name="l16"><span class="linenum">  16</span></a>  <span class="comment"> *   - GNU General Public License 2 (GPL) - http://www.opensource.org/licenses/gpl-license.php</span>
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment"> *   - Mozilla Public License 1.1 (MPL) - http://www.opensource.org/licenses/mozilla1.1.php</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * }}</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * {@internal Open Source relicensing agreement:</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * Daniel HAHLER grants Francois PLANQUE the right to license</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * Daniel HAHLER's contributions to this file and the b2evolution project</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> * under any OSI approved OSS license (http://www.opensource.org/licenses/).</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> * }}</span>
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment"> *</span>
<a name="l26"><span class="linenum">  26</span></a>  <span class="comment"> * @package admin</span>
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment"> *</span>
<a name="l28"><span class="linenum">  28</span></a>  <span class="comment"> * {@internal Below is a list of authors who have contributed to design/coding of this file: }}</span>
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment"> * @author fplanque: Francois PLANQUE.</span>
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment"> * @author blueyed: Daniel HAHLER</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment"> *</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> * @version $Id: plugins.ctrl.php 6411 2014-04-07 15:17:33Z yura $</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> */</span>
<a name="l34"><span class="linenum">  34</span></a>  if( !<a class="phpfunction" onClick="logFunction('defined')" href="../../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('EVO_MAIN_INIT')" href="../../../_constants/EVO_MAIN_INIT.html" onMouseOver="constPopup(event,'EVO_MAIN_INIT')">EVO_MAIN_INIT</a>') ) die( 'Please, do not access this page directly.' );
<a name="l35"><span class="linenum">  35</span></a>  
<a name="l36"><span class="linenum">  36</span></a>  global <a class="var it230" onMouseOver="hilite(230)" onMouseOut="lolite()" onClick="logVariable('dispatcher')" href="../../../_variables/dispatcher.html">$dispatcher</a>;
<a name="l37"><span class="linenum">  37</span></a>  
<a name="l38"><span class="linenum">  38</span></a>  
<a name="l39"><span class="linenum">  39</span></a>  <span class="comment">// Check permission to display:</span>
<a name="l40"><span class="linenum">  40</span></a>  <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'options', 'view', true );
<a name="l41"><span class="linenum">  41</span></a>  
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment">// Memorize this as the last &quot;tab&quot; used in the Blog Settings:</span>
<a name="l43"><span class="linenum">  43</span></a>  <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('UserSettings')" href="../../../_variables/UserSettings.html">$UserSettings</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'pref_glob_settings_tab', <a class="var it1636" onMouseOver="hilite(1636)" onMouseOut="lolite()" onClick="logVariable('ctrl')" href="../../../_variables/ctrl.html">$ctrl</a> );
<a name="l44"><span class="linenum">  44</span></a>  <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('UserSettings')" href="../../../_variables/UserSettings.html">$UserSettings</a>-&gt;<a class="function" onClick="logFunction('dbupdate')" href="../../../_functions/dbupdate.html" onMouseOver="funcPopup(event,'dbupdate')">dbupdate</a>();
<a name="l45"><span class="linenum">  45</span></a>  
<a name="l46"><span class="linenum">  46</span></a>  
<a name="l47"><span class="linenum">  47</span></a>  <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('set_path')" href="../../../_functions/set_path.html" onMouseOver="funcPopup(event,'set_path')">set_path</a>( 'options', 'plugins' );
<a name="l48"><span class="linenum">  48</span></a>  
<a name="l49"><span class="linenum">  49</span></a>  <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = <a class="function" onClick="logFunction('param_action')" href="../../../_functions/param_action.html" onMouseOver="funcPopup(event,'param_action')">param_action</a>( 'list' );
<a name="l50"><span class="linenum">  50</span></a>  
<a name="l51"><span class="linenum">  51</span></a>  <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('UserSettings')" href="../../../_variables/UserSettings.html">$UserSettings</a>-&gt;<a class="function" onClick="logFunction('param_Request')" href="../../../_functions/param_request.html" onMouseOver="funcPopup(event,'param_request')">param_Request</a>( 'plugins_disp_avail', 'plugins_disp_avail', 'integer', 0 );
<a name="l52"><span class="linenum">  52</span></a>  
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment">/**</span>
<a name="l54"><span class="linenum">  54</span></a>  <span class="comment"> * @var Plugins_admin</span>
<a name="l55"><span class="linenum">  55</span></a>  <span class="comment"> */</span>
<a name="l56"><span class="linenum">  56</span></a>  <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a> = &amp; get_Plugins_admin();
<a name="l57"><span class="linenum">  57</span></a>  <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('restart')" href="../../../_functions/restart.html" onMouseOver="funcPopup(event,'restart')">restart</a>();
<a name="l58"><span class="linenum">  58</span></a>  
<a name="l59"><span class="linenum">  59</span></a>  <span class="comment">// Pre-walk list of plugins</span>
<a name="l60"><span class="linenum">  60</span></a>  while( <a class="var it133" onMouseOver="hilite(133)" onMouseOut="lolite()" onClick="logVariable('loop_Plugin')" href="../../../_variables/loop_Plugin.html">$loop_Plugin</a> = &amp; <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;get_next() )
<a name="l61"><span class="linenum">  61</span></a>  {
<a name="l62"><span class="linenum">  62</span></a>      if( <a class="var it133" onMouseOver="hilite(133)" onMouseOut="lolite()" onClick="logVariable('loop_Plugin')" href="../../../_variables/loop_Plugin.html">$loop_Plugin</a>-&gt;<a onClick="logVariable('status')" class="var it8981" onMouseOver="hilite(8981)" onMouseOut="lolite()" href="../../../_variables/status.html">status</a> == 'broken' &amp;&amp; ! isset( <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a onClick="logVariable('plugin_errors')" class="var it9135" onMouseOver="hilite(9135)" onMouseOut="lolite()" href="../../../_variables/plugin_errors.html">plugin_errors</a>[<a class="var it133" onMouseOver="hilite(133)" onMouseOut="lolite()" onClick="logVariable('loop_Plugin')" href="../../../_variables/loop_Plugin.html">$loop_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it8981" onMouseOver="hilite(8981)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>] ) )
<a name="l63"><span class="linenum">  63</span></a>      { // The plugin is not &quot;broken&quot; anymore (either the problem got fixed or it was &quot;broken&quot; from a canceled &quot;install_db_schema&quot; action)
<a name="l64"><span class="linenum">  64</span></a>  <span class="comment">        // TODO: set this to the previous status (dh)</span>
<a name="l65"><span class="linenum">  65</span></a>          <a class="var it16" onMouseOver="hilite(16)" onMouseOut="lolite()" onClick="logVariable('Plugins')" href="../../../_variables/Plugins.html">$Plugins</a>-&gt;<a class="function" onClick="logFunction('set_Plugin_status')" href="../../../_functions/set_plugin_status.html" onMouseOver="funcPopup(event,'set_plugin_status')">set_Plugin_status</a>( <a class="var it133" onMouseOver="hilite(133)" onMouseOut="lolite()" onClick="logVariable('loop_Plugin')" href="../../../_variables/loop_Plugin.html">$loop_Plugin</a>, 'disabled' );
<a name="l66"><span class="linenum">  66</span></a>      }
<a name="l67"><span class="linenum">  67</span></a>  }
<a name="l68"><span class="linenum">  68</span></a>  
<a name="l69"><span class="linenum">  69</span></a>  
<a name="l70"><span class="linenum">  70</span></a>  <span class="comment">/*</span>
<a name="l71"><span class="linenum">  71</span></a>  <span class="comment"> * Action Handling part I</span>
<a name="l72"><span class="linenum">  72</span></a>  <span class="comment"> * Actions that delegate to other actions (other than list):</span>
<a name="l73"><span class="linenum">  73</span></a>  <span class="comment"> */</span>
<a name="l74"><span class="linenum">  74</span></a>  switch( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> )
<a name="l75"><span class="linenum">  75</span></a>  {
<a name="l76"><span class="linenum">  76</span></a>      case 'del_settings_set':
<a name="l77"><span class="linenum">  77</span></a>  <span class="comment">        // Delete a set from an array type setting:</span>
<a name="l78"><span class="linenum">  78</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'plugin_ID', 'integer', true );
<a name="l79"><span class="linenum">  79</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'set_path' );
<a name="l80"><span class="linenum">  80</span></a>  
<a name="l81"><span class="linenum">  81</span></a>          <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a> = &amp; <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;get_by_ID(<a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a>);
<a name="l82"><span class="linenum">  82</span></a>  
<a name="l83"><span class="linenum">  83</span></a>          <a class="function" onClick="logFunction('load_funcs')" href="../../../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>('plugins/_plugin.funcs.php');
<a name="l84"><span class="linenum">  84</span></a>          <a class="function" onClick="logFunction('_set_setting_by_path')" href="../../../_functions/_set_setting_by_path.html" onMouseOver="funcPopup(event,'_set_setting_by_path')">_set_setting_by_path</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>, 'Settings', <a class="var it2373" onMouseOver="hilite(2373)" onMouseOut="lolite()" onClick="logVariable('set_path')" href="../../../_variables/set_path.html">$set_path</a>, NULL );
<a name="l85"><span class="linenum">  85</span></a>  
<a name="l86"><span class="linenum">  86</span></a>  <span class="comment">        // Don't delete from the db yet. It will be updated in the db when Save button is clicked. It works similar as the async pair of this action</span>
<a name="l87"><span class="linenum">  87</span></a>  <span class="comment">        #$edit_Plugin-&gt;Settings-&gt;dbupdate();</span>
<a name="l88"><span class="linenum">  88</span></a>  
<a name="l89"><span class="linenum">  89</span></a>          <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'edit_settings';
<a name="l90"><span class="linenum">  90</span></a>  
<a name="l91"><span class="linenum">  91</span></a>          break;
<a name="l92"><span class="linenum">  92</span></a>  
<a name="l93"><span class="linenum">  93</span></a>      case 'add_settings_set': // delegates to edit_settings
<a name="l94"><span class="linenum">  94</span></a>  <span class="comment">        // Add a new set to an array type setting:</span>
<a name="l95"><span class="linenum">  95</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'plugin_ID', 'integer', true );
<a name="l96"><span class="linenum">  96</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'set_path', 'string', '' );
<a name="l97"><span class="linenum">  97</span></a>  
<a name="l98"><span class="linenum">  98</span></a>          <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a> = &amp; <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;get_by_ID(<a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a>);
<a name="l99"><span class="linenum">  99</span></a>  
<a name="l100"><span class="linenum"> 100</span></a>          <a class="function" onClick="logFunction('load_funcs')" href="../../../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>('plugins/_plugin.funcs.php');
<a name="l101"><span class="linenum"> 101</span></a>          <a class="function" onClick="logFunction('_set_setting_by_path')" href="../../../_functions/_set_setting_by_path.html" onMouseOver="funcPopup(event,'_set_setting_by_path')">_set_setting_by_path</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>, 'Settings', <a class="var it2373" onMouseOver="hilite(2373)" onMouseOut="lolite()" onClick="logVariable('set_path')" href="../../../_variables/set_path.html">$set_path</a>, array() );
<a name="l102"><span class="linenum"> 102</span></a>  
<a name="l103"><span class="linenum"> 103</span></a>  <span class="comment">        // Don't update the db, before it is not filled. It will be saved when Save button is clicked.</span>
<a name="l104"><span class="linenum"> 104</span></a>  <span class="comment">        #$edit_Plugin-&gt;Settings-&gt;dbupdate();</span>
<a name="l105"><span class="linenum"> 105</span></a>  
<a name="l106"><span class="linenum"> 106</span></a>          <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'edit_settings';
<a name="l107"><span class="linenum"> 107</span></a>  
<a name="l108"><span class="linenum"> 108</span></a>          break;
<a name="l109"><span class="linenum"> 109</span></a>  }
<a name="l110"><span class="linenum"> 110</span></a>  
<a name="l111"><span class="linenum"> 111</span></a>  
<a name="l112"><span class="linenum"> 112</span></a>  <span class="comment">/*</span>
<a name="l113"><span class="linenum"> 113</span></a>  <span class="comment"> * Action Handling part II</span>
<a name="l114"><span class="linenum"> 114</span></a>  <span class="comment"> */</span>
<a name="l115"><span class="linenum"> 115</span></a>  switch( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> )
<a name="l116"><span class="linenum"> 116</span></a>  {
<a name="l117"><span class="linenum"> 117</span></a>      case 'disable_plugin':
<a name="l118"><span class="linenum"> 118</span></a>  <span class="comment">        // Disable a plugin, only if it is &quot;enabled&quot;</span>
<a name="l119"><span class="linenum"> 119</span></a>  
<a name="l120"><span class="linenum"> 120</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l121"><span class="linenum"> 121</span></a>          <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'plugin' );
<a name="l122"><span class="linenum"> 122</span></a>  
<a name="l123"><span class="linenum"> 123</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'options', 'edit', true );
<a name="l124"><span class="linenum"> 124</span></a>  
<a name="l125"><span class="linenum"> 125</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'plugin_ID', 'integer', true );
<a name="l126"><span class="linenum"> 126</span></a>  
<a name="l127"><span class="linenum"> 127</span></a>          <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'list';
<a name="l128"><span class="linenum"> 128</span></a>  
<a name="l129"><span class="linenum"> 129</span></a>          <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a> = &amp; <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;get_by_ID( <a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a> );
<a name="l130"><span class="linenum"> 130</span></a>  
<a name="l131"><span class="linenum"> 131</span></a>          if( empty(<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>) )
<a name="l132"><span class="linenum"> 132</span></a>          {
<a name="l133"><span class="linenum"> 133</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>( 'The plugin with ID %d could not be instantiated.' ), <a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a> ), 'error' );
<a name="l134"><span class="linenum"> 134</span></a>              break;
<a name="l135"><span class="linenum"> 135</span></a>          }
<a name="l136"><span class="linenum"> 136</span></a>          if( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('status')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/status.html">status</a> != 'enabled' )
<a name="l137"><span class="linenum"> 137</span></a>          {
<a name="l138"><span class="linenum"> 138</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>( 'The plugin with ID %d is already disabled.' ), <a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a> ), 'note' );
<a name="l139"><span class="linenum"> 139</span></a>              break;
<a name="l140"><span class="linenum"> 140</span></a>          }
<a name="l141"><span class="linenum"> 141</span></a>  
<a name="l142"><span class="linenum"> 142</span></a>  <span class="comment">        // Check dependencies</span>
<a name="l143"><span class="linenum"> 143</span></a>          <a class="var it2680" onMouseOver="hilite(2680)" onMouseOut="lolite()" onClick="logVariable('msgs')" href="../../../_variables/msgs.html">$msgs</a> = <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('validate_dependencies')" href="../../../_functions/validate_dependencies.html" onMouseOver="funcPopup(event,'validate_dependencies')">validate_dependencies</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>, 'disable' );
<a name="l144"><span class="linenum"> 144</span></a>          if( ! empty( <a class="var it2680" onMouseOver="hilite(2680)" onMouseOut="lolite()" onClick="logVariable('msgs')" href="../../../_variables/msgs.html">$msgs</a>['error'] ) )
<a name="l145"><span class="linenum"> 145</span></a>          {
<a name="l146"><span class="linenum"> 146</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>( 'The plugin cannot be disabled because of the following dependencies:' ).' &lt;ul&gt;&lt;li&gt;'.<a class="phpfunction" onClick="logFunction('implode')" href="../../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>('&lt;/li&gt;&lt;li&gt;', <a class="var it2680" onMouseOver="hilite(2680)" onMouseOut="lolite()" onClick="logVariable('msgs')" href="../../../_variables/msgs.html">$msgs</a>['error']).'&lt;/li&gt;&lt;/ul&gt;', 'error' );
<a name="l147"><span class="linenum"> 147</span></a>              break;
<a name="l148"><span class="linenum"> 148</span></a>          }
<a name="l149"><span class="linenum"> 149</span></a>  
<a name="l150"><span class="linenum"> 150</span></a>  <span class="comment">        // we call $Plugins(!) here: the Plugin gets disabled on the current page already and it should not get (un)registered on $admin_Plugins!</span>
<a name="l151"><span class="linenum"> 151</span></a>          <a class="var it16" onMouseOver="hilite(16)" onMouseOut="lolite()" onClick="logVariable('Plugins')" href="../../../_variables/Plugins.html">$Plugins</a>-&gt;<a class="function" onClick="logFunction('set_Plugin_status')" href="../../../_functions/set_plugin_status.html" onMouseOver="funcPopup(event,'set_plugin_status')">set_Plugin_status</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>, 'disabled' ); <span class="comment">// sets $edit_Plugin-&gt;status</span>
<a name="l152"><span class="linenum"> 152</span></a>  
<a name="l153"><span class="linenum"> 153</span></a>  <span class="comment">        // invalidate all PageCaches</span>
<a name="l154"><span class="linenum"> 154</span></a>          <a class="function" onClick="logFunction('invalidate_pagecaches')" href="../../../_functions/invalidate_pagecaches.html" onMouseOver="funcPopup(event,'invalidate_pagecaches')">invalidate_pagecaches</a>();
<a name="l155"><span class="linenum"> 155</span></a>  
<a name="l156"><span class="linenum"> 156</span></a>          <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <span class="comment">/* TRANS: plugin name, class name and ID */</span> sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Disabled &quot;%s&quot; <a class="function" onClick="logFunction('plugin')" href="../../../_functions/plugin.html" onMouseOver="funcPopup(event,'plugin')">plugin</a> (%s, #%d).'), <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('name')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a>, <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('classname')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a>, <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> ), 'success' );
<a name="l157"><span class="linenum"> 157</span></a>  
<a name="l158"><span class="linenum"> 158</span></a>  <span class="comment">        //save fadeout item</span>
<a name="l159"><span class="linenum"> 159</span></a>          <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>('fadeout_id', <a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a>);
<a name="l160"><span class="linenum"> 160</span></a>  
<a name="l161"><span class="linenum"> 161</span></a>  <span class="comment">        // Redirect so that a reload doesn't write to the DB twice:</span>
<a name="l162"><span class="linenum"> 162</span></a>          <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( '?ctrl=plugins', 303 ); <span class="comment">// Will EXIT</span>
<a name="l163"><span class="linenum"> 163</span></a>  <span class="comment">        // We have EXITed already at this point!!</span>
<a name="l164"><span class="linenum"> 164</span></a>  
<a name="l165"><span class="linenum"> 165</span></a>          break;
<a name="l166"><span class="linenum"> 166</span></a>  
<a name="l167"><span class="linenum"> 167</span></a>  
<a name="l168"><span class="linenum"> 168</span></a>      case 'enable_plugin':
<a name="l169"><span class="linenum"> 169</span></a>  <span class="comment">        // Try to enable a plugin, only if it is in state &quot;disabled&quot; or &quot;needs_config&quot;</span>
<a name="l170"><span class="linenum"> 170</span></a>  
<a name="l171"><span class="linenum"> 171</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l172"><span class="linenum"> 172</span></a>          <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'plugin' );
<a name="l173"><span class="linenum"> 173</span></a>  
<a name="l174"><span class="linenum"> 174</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'options', 'edit', true );
<a name="l175"><span class="linenum"> 175</span></a>  
<a name="l176"><span class="linenum"> 176</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'plugin_ID', 'integer', true );
<a name="l177"><span class="linenum"> 177</span></a>  
<a name="l178"><span class="linenum"> 178</span></a>          <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'list';
<a name="l179"><span class="linenum"> 179</span></a>  
<a name="l180"><span class="linenum"> 180</span></a>          <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a> = &amp; <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;get_by_ID( <a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a> );
<a name="l181"><span class="linenum"> 181</span></a>  
<a name="l182"><span class="linenum"> 182</span></a>          if( empty(<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>) )
<a name="l183"><span class="linenum"> 183</span></a>          {
<a name="l184"><span class="linenum"> 184</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>( 'The plugin with ID %d could not be instantiated.' ), <a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a> ), 'error' );
<a name="l185"><span class="linenum"> 185</span></a>              break;
<a name="l186"><span class="linenum"> 186</span></a>          }
<a name="l187"><span class="linenum"> 187</span></a>          if( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('status')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/status.html">status</a> == 'enabled' )
<a name="l188"><span class="linenum"> 188</span></a>          {
<a name="l189"><span class="linenum"> 189</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <span class="comment">/* TRANS: plugin name, class name and ID */</span> sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>( 'The &quot;%s&quot; <a class="function" onClick="logFunction('plugin')" href="../../../_functions/plugin.html" onMouseOver="funcPopup(event,'plugin')">plugin</a> (%s, #%d) is already enabled.' ), <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('name')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a>, <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('classname')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a>, <a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a> ), 'note' );
<a name="l190"><span class="linenum"> 190</span></a>              break;
<a name="l191"><span class="linenum"> 191</span></a>          }
<a name="l192"><span class="linenum"> 192</span></a>          if( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('status')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/status.html">status</a> == 'broken' )
<a name="l193"><span class="linenum"> 193</span></a>          {
<a name="l194"><span class="linenum"> 194</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>( 'The plugin is in a broken state. It cannot be enabled.' ), <a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a> ), 'error' );
<a name="l195"><span class="linenum"> 195</span></a>              break;
<a name="l196"><span class="linenum"> 196</span></a>          }
<a name="l197"><span class="linenum"> 197</span></a>  
<a name="l198"><span class="linenum"> 198</span></a>  <span class="comment">        // Check dependencies</span>
<a name="l199"><span class="linenum"> 199</span></a>          <a class="var it2680" onMouseOver="hilite(2680)" onMouseOut="lolite()" onClick="logVariable('msgs')" href="../../../_variables/msgs.html">$msgs</a> = <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('validate_dependencies')" href="../../../_functions/validate_dependencies.html" onMouseOver="funcPopup(event,'validate_dependencies')">validate_dependencies</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>, 'enable' );
<a name="l200"><span class="linenum"> 200</span></a>          if( ! empty( <a class="var it2680" onMouseOver="hilite(2680)" onMouseOut="lolite()" onClick="logVariable('msgs')" href="../../../_variables/msgs.html">$msgs</a>['error'] ) )
<a name="l201"><span class="linenum"> 201</span></a>          {
<a name="l202"><span class="linenum"> 202</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>( 'The plugin cannot be enabled because of the following dependencies:' ).' &lt;ul&gt;&lt;li&gt;'.<a class="phpfunction" onClick="logFunction('implode')" href="../../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>('&lt;/li&gt;&lt;li&gt;', <a class="var it2680" onMouseOver="hilite(2680)" onMouseOut="lolite()" onClick="logVariable('msgs')" href="../../../_variables/msgs.html">$msgs</a>['error']).'&lt;/li&gt;&lt;/ul&gt;' );
<a name="l203"><span class="linenum"> 203</span></a>              break;
<a name="l204"><span class="linenum"> 204</span></a>          }
<a name="l205"><span class="linenum"> 205</span></a>  
<a name="l206"><span class="linenum"> 206</span></a>          <a class="function" onClick="logFunction('load_funcs')" href="../../../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>('plugins/_plugin.funcs.php');
<a name="l207"><span class="linenum"> 207</span></a>          if( <a class="function" onClick="logFunction('install_plugin_db_schema_action')" href="../../../_functions/install_plugin_db_schema_action.html" onMouseOver="funcPopup(event,'install_plugin_db_schema_action')">install_plugin_db_schema_action</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a> ) )
<a name="l208"><span class="linenum"> 208</span></a>          { // Changes are done, or no changes
<a name="l209"><span class="linenum"> 209</span></a>              <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'list';
<a name="l210"><span class="linenum"> 210</span></a>          }
<a name="l211"><span class="linenum"> 211</span></a>          else
<a name="l212"><span class="linenum"> 212</span></a>          { // delta queries have to be confirmed in payload
<a name="l213"><span class="linenum"> 213</span></a>              <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'install_db_schema';
<a name="l214"><span class="linenum"> 214</span></a>              <a class="var it242" onMouseOver="hilite(242)" onMouseOut="lolite()" onClick="logVariable('next_action')" href="../../../_variables/next_action.html">$next_action</a> = 'enable_plugin';
<a name="l215"><span class="linenum"> 215</span></a>              break;
<a name="l216"><span class="linenum"> 216</span></a>          }
<a name="l217"><span class="linenum"> 217</span></a>  
<a name="l218"><span class="linenum"> 218</span></a>  <span class="comment">        // Try to enable plugin:</span>
<a name="l219"><span class="linenum"> 219</span></a>          <a class="var it3617" onMouseOver="hilite(3617)" onMouseOut="lolite()" onClick="logVariable('enable_return')" href="../../../_variables/enable_return.html">$enable_return</a> = <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a class="function" onClick="logFunction('BeforeEnable')" href="../../../_functions/beforeenable.html" onMouseOver="funcPopup(event,'beforeenable')">BeforeEnable</a>();
<a name="l220"><span class="linenum"> 220</span></a>          if( <a class="var it3617" onMouseOver="hilite(3617)" onMouseOut="lolite()" onClick="logVariable('enable_return')" href="../../../_variables/enable_return.html">$enable_return</a> === true )
<a name="l221"><span class="linenum"> 221</span></a>          {
<a name="l222"><span class="linenum"> 222</span></a>  <span class="comment">            // NOTE: we don't need to handle plug_version here, because it gets handled in Plugins::register() already.</span>
<a name="l223"><span class="linenum"> 223</span></a>  
<a name="l224"><span class="linenum"> 224</span></a>  <span class="comment">            // Detect new events:</span>
<a name="l225"><span class="linenum"> 225</span></a>              <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('save_events')" href="../../../_functions/save_events.html" onMouseOver="funcPopup(event,'save_events')">save_events</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>, array() );
<a name="l226"><span class="linenum"> 226</span></a>  
<a name="l227"><span class="linenum"> 227</span></a>  <span class="comment">            // we call $Plugins(!) here: the Plugin gets active on the current page already and it should not get (un)registered on $admin_Plugins!</span>
<a name="l228"><span class="linenum"> 228</span></a>              <a class="var it16" onMouseOver="hilite(16)" onMouseOut="lolite()" onClick="logVariable('Plugins')" href="../../../_variables/Plugins.html">$Plugins</a>-&gt;<a class="function" onClick="logFunction('set_Plugin_status')" href="../../../_functions/set_plugin_status.html" onMouseOver="funcPopup(event,'set_plugin_status')">set_Plugin_status</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>, 'enabled' ); <span class="comment">// sets $edit_Plugin-&gt;status</span>
<a name="l229"><span class="linenum"> 229</span></a>  
<a name="l230"><span class="linenum"> 230</span></a>  <span class="comment">            // invalidate all PageCaches</span>
<a name="l231"><span class="linenum"> 231</span></a>              <a class="function" onClick="logFunction('invalidate_pagecaches')" href="../../../_functions/invalidate_pagecaches.html" onMouseOver="funcPopup(event,'invalidate_pagecaches')">invalidate_pagecaches</a>();
<a name="l232"><span class="linenum"> 232</span></a>  
<a name="l233"><span class="linenum"> 233</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <span class="comment">/* TRANS: plugin name, class name and ID */</span> sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Enabled &quot;%s&quot; <a class="function" onClick="logFunction('plugin')" href="../../../_functions/plugin.html" onMouseOver="funcPopup(event,'plugin')">plugin</a> (%s, #%d).'), <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('name')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a>, <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('classname')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a>, <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> ), 'success' );
<a name="l234"><span class="linenum"> 234</span></a>          }
<a name="l235"><span class="linenum"> 235</span></a>          else
<a name="l236"><span class="linenum"> 236</span></a>          {
<a name="l237"><span class="linenum"> 237</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The plugin has not been enabled.').( empty(<a class="var it3617" onMouseOver="hilite(3617)" onMouseOut="lolite()" onClick="logVariable('enable_return')" href="../../../_variables/enable_return.html">$enable_return</a>) ? '' : '&lt;br /&gt;'.<a class="var it3617" onMouseOver="hilite(3617)" onMouseOut="lolite()" onClick="logVariable('enable_return')" href="../../../_variables/enable_return.html">$enable_return</a> ), 'error' );
<a name="l238"><span class="linenum"> 238</span></a>          }
<a name="l239"><span class="linenum"> 239</span></a>  
<a name="l240"><span class="linenum"> 240</span></a>  <span class="comment">        //save fadeout item</span>
<a name="l241"><span class="linenum"> 241</span></a>          <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>('fadeout_id', <a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a>);
<a name="l242"><span class="linenum"> 242</span></a>  
<a name="l243"><span class="linenum"> 243</span></a>  <span class="comment">        // Redirect so that a reload doesn't write to the DB twice:</span>
<a name="l244"><span class="linenum"> 244</span></a>          <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( '?ctrl=plugins', 303 ); <span class="comment">// Will EXIT</span>
<a name="l245"><span class="linenum"> 245</span></a>  <span class="comment">        // We have EXITed already at this point!!</span>
<a name="l246"><span class="linenum"> 246</span></a>  
<a name="l247"><span class="linenum"> 247</span></a>          break;
<a name="l248"><span class="linenum"> 248</span></a>  
<a name="l249"><span class="linenum"> 249</span></a>  
<a name="l250"><span class="linenum"> 250</span></a>      case 'reload_plugins':
<a name="l251"><span class="linenum"> 251</span></a>  <span class="comment">        // Register new events</span>
<a name="l252"><span class="linenum"> 252</span></a>  <span class="comment">        // Unregister obsolete events</span>
<a name="l253"><span class="linenum"> 253</span></a>  <span class="comment">        // Detect plugins with no code and try to have at least one plugin with the default code</span>
<a name="l254"><span class="linenum"> 254</span></a>  
<a name="l255"><span class="linenum"> 255</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l256"><span class="linenum"> 256</span></a>          <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'plugin' );
<a name="l257"><span class="linenum"> 257</span></a>  
<a name="l258"><span class="linenum"> 258</span></a>  <span class="comment">        // Check permission:</span>
<a name="l259"><span class="linenum"> 259</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'options', 'edit', true );
<a name="l260"><span class="linenum"> 260</span></a>  
<a name="l261"><span class="linenum"> 261</span></a>          if( <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('reload_plugins')" href="../../../_functions/reload_plugins.html" onMouseOver="funcPopup(event,'reload_plugins')">reload_plugins</a>() )
<a name="l262"><span class="linenum"> 262</span></a>          { // Plugins have been changed
<a name="l263"><span class="linenum"> 263</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Plugins have been reloaded.'), 'success' );
<a name="l264"><span class="linenum"> 264</span></a>          }
<a name="l265"><span class="linenum"> 265</span></a>          else
<a name="l266"><span class="linenum"> 266</span></a>          {
<a name="l267"><span class="linenum"> 267</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Plugins have not changed.'), 'note' );
<a name="l268"><span class="linenum"> 268</span></a>          }
<a name="l269"><span class="linenum"> 269</span></a>          <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'list';
<a name="l270"><span class="linenum"> 270</span></a>  
<a name="l271"><span class="linenum"> 271</span></a>  <span class="comment">        // Redirect so that a reload doesn't write to the DB twice:</span>
<a name="l272"><span class="linenum"> 272</span></a>          <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( '?ctrl=plugins', 303 ); <span class="comment">// Will EXIT</span>
<a name="l273"><span class="linenum"> 273</span></a>  <span class="comment">        // We have EXITed already at this point!!</span>
<a name="l274"><span class="linenum"> 274</span></a>          break;
<a name="l275"><span class="linenum"> 275</span></a>  
<a name="l276"><span class="linenum"> 276</span></a>  
<a name="l277"><span class="linenum"> 277</span></a>      case 'install':
<a name="l278"><span class="linenum"> 278</span></a>  <span class="comment">        // Install a plugin. This may be a two-step action, when DB changes have to be confirmed</span>
<a name="l279"><span class="linenum"> 279</span></a>          <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'list';
<a name="l280"><span class="linenum"> 280</span></a>  
<a name="l281"><span class="linenum"> 281</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l282"><span class="linenum"> 282</span></a>          <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'plugin' );
<a name="l283"><span class="linenum"> 283</span></a>  
<a name="l284"><span class="linenum"> 284</span></a>  <span class="comment">        // Check permission:</span>
<a name="l285"><span class="linenum"> 285</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'options', 'edit', true );
<a name="l286"><span class="linenum"> 286</span></a>  
<a name="l287"><span class="linenum"> 287</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'plugin', 'string', true );
<a name="l288"><span class="linenum"> 288</span></a>  
<a name="l289"><span class="linenum"> 289</span></a>          <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a> = &amp; <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('install')" href="../../../_functions/install.html" onMouseOver="funcPopup(event,'install')">install</a>( <a class="var it3618" onMouseOver="hilite(3618)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../../_variables/plugin.html">$plugin</a>, 'broken' ); <span class="comment">// &quot;broken&quot; by default, gets adjusted later</span>
<a name="l290"><span class="linenum"> 290</span></a>  
<a name="l291"><span class="linenum"> 291</span></a>          if( <a class="phpfunction" onClick="logFunction('is_string')" href="../../../_functions/is_string.html" onMouseOver="phpfuncPopup(event,'is_string')">is_string</a>(<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>) )
<a name="l292"><span class="linenum"> 292</span></a>          {
<a name="l293"><span class="linenum"> 293</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>, 'error' );
<a name="l294"><span class="linenum"> 294</span></a>              break;
<a name="l295"><span class="linenum"> 295</span></a>          }
<a name="l296"><span class="linenum"> 296</span></a>  
<a name="l297"><span class="linenum"> 297</span></a>  
<a name="l298"><span class="linenum"> 298</span></a>      case 'install_db_schema':
<a name="l299"><span class="linenum"> 299</span></a>  <span class="comment">        // we come here from the first step (&quot;install&quot;)</span>
<a name="l300"><span class="linenum"> 300</span></a>  
<a name="l301"><span class="linenum"> 301</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l302"><span class="linenum"> 302</span></a>          <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'plugin' );
<a name="l303"><span class="linenum"> 303</span></a>  
<a name="l304"><span class="linenum"> 304</span></a>  <span class="comment">        // Check permission:</span>
<a name="l305"><span class="linenum"> 305</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'options', 'edit', true );
<a name="l306"><span class="linenum"> 306</span></a>  
<a name="l307"><span class="linenum"> 307</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'plugin_ID', 'integer', 0 );
<a name="l308"><span class="linenum"> 308</span></a>  
<a name="l309"><span class="linenum"> 309</span></a>          if( <a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a> )
<a name="l310"><span class="linenum"> 310</span></a>          { // second step:
<a name="l311"><span class="linenum"> 311</span></a>              <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a> = &amp; <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;get_by_ID( <a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a> );
<a name="l312"><span class="linenum"> 312</span></a>  
<a name="l313"><span class="linenum"> 313</span></a>              if( ! <a class="phpfunction" onClick="logFunction('is_a')" href="../../../_functions/is_a.html" onMouseOver="phpfuncPopup(event,'is_a')">is_a</a>(<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>, 'Plugin') )
<a name="l314"><span class="linenum"> 314</span></a>              {
<a name="l315"><span class="linenum"> 315</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>( 'The plugin with ID %d could not be instantiated.' ), <a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a> ), 'error' );
<a name="l316"><span class="linenum"> 316</span></a>                  <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'list';
<a name="l317"><span class="linenum"> 317</span></a>                  break;
<a name="l318"><span class="linenum"> 318</span></a>              }
<a name="l319"><span class="linenum"> 319</span></a>          }
<a name="l320"><span class="linenum"> 320</span></a>  
<a name="l321"><span class="linenum"> 321</span></a>          <a class="function" onClick="logFunction('load_funcs')" href="../../../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>('plugins/_plugin.funcs.php');
<a name="l322"><span class="linenum"> 322</span></a>          if( <a class="function" onClick="logFunction('install_plugin_db_schema_action')" href="../../../_functions/install_plugin_db_schema_action.html" onMouseOver="funcPopup(event,'install_plugin_db_schema_action')">install_plugin_db_schema_action</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a> ) )
<a name="l323"><span class="linenum"> 323</span></a>          { // Changes are done, or no changes
<a name="l324"><span class="linenum"> 324</span></a>              <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'list';
<a name="l325"><span class="linenum"> 325</span></a>          }
<a name="l326"><span class="linenum"> 326</span></a>          else
<a name="l327"><span class="linenum"> 327</span></a>          { // delta queries have to be confirmed in payload
<a name="l328"><span class="linenum"> 328</span></a>              <a class="var it242" onMouseOver="hilite(242)" onMouseOut="lolite()" onClick="logVariable('next_action')" href="../../../_variables/next_action.html">$next_action</a> = 'install_db_schema';
<a name="l329"><span class="linenum"> 329</span></a>              break;
<a name="l330"><span class="linenum"> 330</span></a>          }
<a name="l331"><span class="linenum"> 331</span></a>  
<a name="l332"><span class="linenum"> 332</span></a>          <a class="var it232" onMouseOver="hilite(232)" onMouseOut="lolite()" onClick="logVariable('msg')" href="../../../_variables/msg.html">$msg</a> = sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Installed plugin &amp;laquo;%s&amp;raquo;.'), <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('classname')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a> );
<a name="l333"><span class="linenum"> 333</span></a>          if( (<a class="var it3619" onMouseOver="hilite(3619)" onMouseOut="lolite()" onClick="logVariable('edit_settings_url')" href="../../../_variables/edit_settings_url.html">$edit_settings_url</a> = <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a class="function" onClick="logFunction('get_edit_settings_url')" href="../../../_functions/get_edit_settings_url.html" onMouseOver="funcPopup(event,'get_edit_settings_url')">get_edit_settings_url</a>()) )
<a name="l334"><span class="linenum"> 334</span></a>          {
<a name="l335"><span class="linenum"> 335</span></a>              <a class="var it232" onMouseOver="hilite(232)" onMouseOut="lolite()" onClick="logVariable('msg')" href="../../../_variables/msg.html">$msg</a> .= ' &lt;a href=&quot;'.<a class="var it3619" onMouseOver="hilite(3619)" onMouseOut="lolite()" onClick="logVariable('edit_settings_url')" href="../../../_variables/edit_settings_url.html">$edit_settings_url</a>.'&quot;&gt;'.<a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Click here to configure').'&lt;/a&gt;.';
<a name="l336"><span class="linenum"> 336</span></a>          }
<a name="l337"><span class="linenum"> 337</span></a>          <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="var it232" onMouseOver="hilite(232)" onMouseOut="lolite()" onClick="logVariable('msg')" href="../../../_variables/msg.html">$msg</a>, 'success' );
<a name="l338"><span class="linenum"> 338</span></a>  
<a name="l339"><span class="linenum"> 339</span></a>  <span class="comment">        // Install completed:</span>
<a name="l340"><span class="linenum"> 340</span></a>          <a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../../_variables/r.html">$r</a> = <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('call_method')" href="../../../_functions/call_method.html" onMouseOver="funcPopup(event,'call_method')">call_method</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, 'AfterInstall', <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a> = array() );
<a name="l341"><span class="linenum"> 341</span></a>  
<a name="l342"><span class="linenum"> 342</span></a>  <span class="comment">        // invalidate all PageCaches</span>
<a name="l343"><span class="linenum"> 343</span></a>          <a class="function" onClick="logFunction('invalidate_pagecaches')" href="../../../_functions/invalidate_pagecaches.html" onMouseOver="funcPopup(event,'invalidate_pagecaches')">invalidate_pagecaches</a>();
<a name="l344"><span class="linenum"> 344</span></a>  
<a name="l345"><span class="linenum"> 345</span></a>  <span class="comment">        // Try to enable plugin:</span>
<a name="l346"><span class="linenum"> 346</span></a>          <a class="var it3617" onMouseOver="hilite(3617)" onMouseOut="lolite()" onClick="logVariable('enable_return')" href="../../../_variables/enable_return.html">$enable_return</a> = <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a class="function" onClick="logFunction('BeforeEnable')" href="../../../_functions/beforeenable.html" onMouseOver="funcPopup(event,'beforeenable')">BeforeEnable</a>();
<a name="l347"><span class="linenum"> 347</span></a>          if( <a class="var it3617" onMouseOver="hilite(3617)" onMouseOut="lolite()" onClick="logVariable('enable_return')" href="../../../_variables/enable_return.html">$enable_return</a> === true )
<a name="l348"><span class="linenum"> 348</span></a>          {
<a name="l349"><span class="linenum"> 349</span></a>              <a class="var it16" onMouseOver="hilite(16)" onMouseOut="lolite()" onClick="logVariable('Plugins')" href="../../../_variables/Plugins.html">$Plugins</a>-&gt;<a class="function" onClick="logFunction('set_Plugin_status')" href="../../../_functions/set_plugin_status.html" onMouseOver="funcPopup(event,'set_plugin_status')">set_Plugin_status</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>, 'enabled' );
<a name="l350"><span class="linenum"> 350</span></a>          }
<a name="l351"><span class="linenum"> 351</span></a>          else
<a name="l352"><span class="linenum"> 352</span></a>          {
<a name="l353"><span class="linenum"> 353</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The plugin has not been enabled.').( empty(<a class="var it3617" onMouseOver="hilite(3617)" onMouseOut="lolite()" onClick="logVariable('enable_return')" href="../../../_variables/enable_return.html">$enable_return</a>) ? '' : '&lt;br /&gt;'.<a class="var it3617" onMouseOver="hilite(3617)" onMouseOut="lolite()" onClick="logVariable('enable_return')" href="../../../_variables/enable_return.html">$enable_return</a> ), 'error' );
<a name="l354"><span class="linenum"> 354</span></a>              <a class="var it16" onMouseOver="hilite(16)" onMouseOut="lolite()" onClick="logVariable('Plugins')" href="../../../_variables/Plugins.html">$Plugins</a>-&gt;<a class="function" onClick="logFunction('set_Plugin_status')" href="../../../_functions/set_plugin_status.html" onMouseOver="funcPopup(event,'set_plugin_status')">set_Plugin_status</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>, 'disabled' ); <span class="comment">// does not unregister it</span>
<a name="l355"><span class="linenum"> 355</span></a>          }
<a name="l356"><span class="linenum"> 356</span></a>  
<a name="l357"><span class="linenum"> 357</span></a>          if( ! empty( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('install_dep_notes')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/install_dep_notes.html">install_dep_notes</a> ) )
<a name="l358"><span class="linenum"> 358</span></a>          { // Add notes from dependencies
<a name="l359"><span class="linenum"> 359</span></a>              foreach( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('install_dep_notes')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/install_dep_notes.html">install_dep_notes</a> as <a class="var it996" onMouseOver="hilite(996)" onMouseOut="lolite()" onClick="logVariable('note')" href="../../../_variables/note.html">$note</a> )
<a name="l360"><span class="linenum"> 360</span></a>              {
<a name="l361"><span class="linenum"> 361</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="var it996" onMouseOver="hilite(996)" onMouseOut="lolite()" onClick="logVariable('note')" href="../../../_variables/note.html">$note</a>, 'note' );
<a name="l362"><span class="linenum"> 362</span></a>              }
<a name="l363"><span class="linenum"> 363</span></a>          }
<a name="l364"><span class="linenum"> 364</span></a>  <span class="comment">        // Redirect so that a reload doesn't write to the DB twice:</span>
<a name="l365"><span class="linenum"> 365</span></a>          <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( '?ctrl=plugins', 303 ); <span class="comment">// Will EXIT</span>
<a name="l366"><span class="linenum"> 366</span></a>  <span class="comment">        // We have EXITed already at this point!!</span>
<a name="l367"><span class="linenum"> 367</span></a>          break;
<a name="l368"><span class="linenum"> 368</span></a>  
<a name="l369"><span class="linenum"> 369</span></a>  
<a name="l370"><span class="linenum"> 370</span></a>      case 'uninstall':
<a name="l371"><span class="linenum"> 371</span></a>  <span class="comment">        // Uninstall plugin:</span>
<a name="l372"><span class="linenum"> 372</span></a>  
<a name="l373"><span class="linenum"> 373</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l374"><span class="linenum"> 374</span></a>          <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'plugin' );
<a name="l375"><span class="linenum"> 375</span></a>  
<a name="l376"><span class="linenum"> 376</span></a>  <span class="comment">        // Check permission:</span>
<a name="l377"><span class="linenum"> 377</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'options', 'edit', true );
<a name="l378"><span class="linenum"> 378</span></a>  
<a name="l379"><span class="linenum"> 379</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'plugin_ID', 'integer', true );
<a name="l380"><span class="linenum"> 380</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'uninstall_confirmed_drop', 'integer', 0 );
<a name="l381"><span class="linenum"> 381</span></a>  
<a name="l382"><span class="linenum"> 382</span></a>          <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'list'; <span class="comment">// leave 'uninstall' by default</span>
<a name="l383"><span class="linenum"> 383</span></a>  
<a name="l384"><span class="linenum"> 384</span></a>          <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a> = &amp; <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;get_by_ID( <a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a> );
<a name="l385"><span class="linenum"> 385</span></a>  
<a name="l386"><span class="linenum"> 386</span></a>          if( empty(<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>) )
<a name="l387"><span class="linenum"> 387</span></a>          {
<a name="l388"><span class="linenum"> 388</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>( 'The plugin with ID %d could not be instantiated.' ), <a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a> ), 'error' );
<a name="l389"><span class="linenum"> 389</span></a>              break;
<a name="l390"><span class="linenum"> 390</span></a>          }
<a name="l391"><span class="linenum"> 391</span></a>  
<a name="l392"><span class="linenum"> 392</span></a>  <span class="comment">        // Check dependencies:</span>
<a name="l393"><span class="linenum"> 393</span></a>          <a class="var it2680" onMouseOver="hilite(2680)" onMouseOut="lolite()" onClick="logVariable('msgs')" href="../../../_variables/msgs.html">$msgs</a> = <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('validate_dependencies')" href="../../../_functions/validate_dependencies.html" onMouseOver="funcPopup(event,'validate_dependencies')">validate_dependencies</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>, 'disable' );
<a name="l394"><span class="linenum"> 394</span></a>          if( ! empty( <a class="var it2680" onMouseOver="hilite(2680)" onMouseOut="lolite()" onClick="logVariable('msgs')" href="../../../_variables/msgs.html">$msgs</a>['error'] ) )
<a name="l395"><span class="linenum"> 395</span></a>          {
<a name="l396"><span class="linenum"> 396</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>( 'The plugin cannot be uninstalled because of the following dependencies:' ).' &lt;ul&gt;&lt;li&gt;'.<a class="phpfunction" onClick="logFunction('implode')" href="../../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>('&lt;/li&gt;&lt;li&gt;', <a class="var it2680" onMouseOver="hilite(2680)" onMouseOut="lolite()" onClick="logVariable('msgs')" href="../../../_variables/msgs.html">$msgs</a>['error']).'&lt;/li&gt;&lt;/ul&gt;', 'error' );
<a name="l397"><span class="linenum"> 397</span></a>              break;
<a name="l398"><span class="linenum"> 398</span></a>          }
<a name="l399"><span class="linenum"> 399</span></a>          if( ! empty( <a class="var it2680" onMouseOver="hilite(2680)" onMouseOut="lolite()" onClick="logVariable('msgs')" href="../../../_variables/msgs.html">$msgs</a>['note'] ) )
<a name="l400"><span class="linenum"> 400</span></a>          { // just notes:
<a name="l401"><span class="linenum"> 401</span></a>              foreach( <a class="var it2680" onMouseOver="hilite(2680)" onMouseOut="lolite()" onClick="logVariable('msgs')" href="../../../_variables/msgs.html">$msgs</a>['note'] as <a class="var it996" onMouseOver="hilite(996)" onMouseOut="lolite()" onClick="logVariable('note')" href="../../../_variables/note.html">$note</a> )
<a name="l402"><span class="linenum"> 402</span></a>              {
<a name="l403"><span class="linenum"> 403</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="var it996" onMouseOver="hilite(996)" onMouseOut="lolite()" onClick="logVariable('note')" href="../../../_variables/note.html">$note</a>, 'note' );
<a name="l404"><span class="linenum"> 404</span></a>              }
<a name="l405"><span class="linenum"> 405</span></a>          }
<a name="l406"><span class="linenum"> 406</span></a>  
<a name="l407"><span class="linenum"> 407</span></a>  <span class="comment">        // Ask plugin:</span>
<a name="l408"><span class="linenum"> 408</span></a>          <a class="var it3621" onMouseOver="hilite(3621)" onMouseOut="lolite()" onClick="logVariable('uninstall_ok')" href="../../../_variables/uninstall_ok.html">$uninstall_ok</a> = <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('call_method')" href="../../../_functions/call_method.html" onMouseOver="funcPopup(event,'call_method')">call_method</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, 'BeforeUninstall', <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a> = array( 'unattended' =&gt; false ) );
<a name="l409"><span class="linenum"> 409</span></a>  
<a name="l410"><span class="linenum"> 410</span></a>          if( <a class="var it3621" onMouseOver="hilite(3621)" onMouseOut="lolite()" onClick="logVariable('uninstall_ok')" href="../../../_variables/uninstall_ok.html">$uninstall_ok</a> === false )
<a name="l411"><span class="linenum"> 411</span></a>          { // Plugin said &quot;NO&quot;:
<a name="l412"><span class="linenum"> 412</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Could not uninstall plugin #%d.'), <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> ), 'error' );
<a name="l413"><span class="linenum"> 413</span></a>              break;
<a name="l414"><span class="linenum"> 414</span></a>          }
<a name="l415"><span class="linenum"> 415</span></a>  
<a name="l416"><span class="linenum"> 416</span></a>  <span class="comment">        // See if we have (canonical) tables to drop:</span>
<a name="l417"><span class="linenum"> 417</span></a>          <a class="var it3622" onMouseOver="hilite(3622)" onMouseOut="lolite()" onClick="logVariable('uninstall_tables_to_drop')" href="../../../_variables/uninstall_tables_to_drop.html">$uninstall_tables_to_drop</a> = <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_col')" href="../../../_functions/get_col.html" onMouseOver="funcPopup(event,'get_col')">get_col</a>( 'SHOW TABLES LIKE &quot;'.<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a class="function" onClick="logFunction('get_sql_table')" href="../../../_functions/get_sql_table.html" onMouseOver="funcPopup(event,'get_sql_table')">get_sql_table</a>('%').'&quot;' );
<a name="l418"><span class="linenum"> 418</span></a>  
<a name="l419"><span class="linenum"> 419</span></a>          if( <a class="var it3621" onMouseOver="hilite(3621)" onMouseOut="lolite()" onClick="logVariable('uninstall_ok')" href="../../../_variables/uninstall_ok.html">$uninstall_ok</a> === true )
<a name="l420"><span class="linenum"> 420</span></a>          { // Plugin said &quot;YES&quot;:
<a name="l421"><span class="linenum"> 421</span></a>  <span class="comment">            // invalidate all PageCaches</span>
<a name="l422"><span class="linenum"> 422</span></a>              <a class="function" onClick="logFunction('invalidate_pagecaches')" href="../../../_functions/invalidate_pagecaches.html" onMouseOver="funcPopup(event,'invalidate_pagecaches')">invalidate_pagecaches</a>();
<a name="l423"><span class="linenum"> 423</span></a>  
<a name="l424"><span class="linenum"> 424</span></a>              if( <a class="var it3622" onMouseOver="hilite(3622)" onMouseOut="lolite()" onClick="logVariable('uninstall_tables_to_drop')" href="../../../_variables/uninstall_tables_to_drop.html">$uninstall_tables_to_drop</a> )
<a name="l425"><span class="linenum"> 425</span></a>              { // There are tables with the prefix for this plugin:
<a name="l426"><span class="linenum"> 426</span></a>                  if( <a class="var it3623" onMouseOver="hilite(3623)" onMouseOut="lolite()" onClick="logVariable('uninstall_confirmed_drop')" href="../../../_variables/uninstall_confirmed_drop.html">$uninstall_confirmed_drop</a> )
<a name="l427"><span class="linenum"> 427</span></a>                  { // Drop tables:
<a name="l428"><span class="linenum"> 428</span></a>                      <a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../_variables/sql.html">$sql</a> = 'DROP TABLE IF EXISTS '.<a class="phpfunction" onClick="logFunction('implode')" href="../../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( ', ', <a class="var it3622" onMouseOver="hilite(3622)" onMouseOut="lolite()" onClick="logVariable('uninstall_tables_to_drop')" href="../../../_variables/uninstall_tables_to_drop.html">$uninstall_tables_to_drop</a> );
<a name="l429"><span class="linenum"> 429</span></a>                      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( <a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../_variables/sql.html">$sql</a> );
<a name="l430"><span class="linenum"> 430</span></a>                      <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Dropped the <a class="function" onClick="logFunction('table')" href="../../../_functions/table.html" onMouseOver="funcPopup(event,'table')">table</a>(s) of the plugin.'), 'success' );
<a name="l431"><span class="linenum"> 431</span></a>                  }
<a name="l432"><span class="linenum"> 432</span></a>                  else
<a name="l433"><span class="linenum"> 433</span></a>                  {
<a name="l434"><span class="linenum"> 434</span></a>                      <a class="var it3621" onMouseOver="hilite(3621)" onMouseOut="lolite()" onClick="logVariable('uninstall_ok')" href="../../../_variables/uninstall_ok.html">$uninstall_ok</a> = false;
<a name="l435"><span class="linenum"> 435</span></a>                  }
<a name="l436"><span class="linenum"> 436</span></a>              }
<a name="l437"><span class="linenum"> 437</span></a>  
<a name="l438"><span class="linenum"> 438</span></a>              if( <a class="var it3621" onMouseOver="hilite(3621)" onMouseOut="lolite()" onClick="logVariable('uninstall_ok')" href="../../../_variables/uninstall_ok.html">$uninstall_ok</a> )
<a name="l439"><span class="linenum"> 439</span></a>              { // We either have no tables to drop or it has been confirmed:
<a name="l440"><span class="linenum"> 440</span></a>                  <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('uninstall')" href="../../../_functions/uninstall.html" onMouseOver="funcPopup(event,'uninstall')">uninstall</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> );
<a name="l441"><span class="linenum"> 441</span></a>  
<a name="l442"><span class="linenum"> 442</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <span class="comment">/* %s = plugin's classname, %d = plugin's ID */</span>
<a name="l443"><span class="linenum"> 443</span></a>                  sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The &amp;laquo;%s&amp;raquo; <a class="function" onClick="logFunction('plugin')" href="../../../_functions/plugin.html" onMouseOver="funcPopup(event,'plugin')">plugin</a> (#%d) has been uninstalled.'), <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('classname')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a>, <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> ), 'success' );
<a name="l444"><span class="linenum"> 444</span></a>  <span class="comment">                // Redirect so that a reload doesn't write to the DB twice:</span>
<a name="l445"><span class="linenum"> 445</span></a>                  <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( '?ctrl=plugins', 303 ); <span class="comment">// Will EXIT</span>
<a name="l446"><span class="linenum"> 446</span></a>  <span class="comment">                // We have EXITed already at this point!!</span>
<a name="l447"><span class="linenum"> 447</span></a>                  break;
<a name="l448"><span class="linenum"> 448</span></a>              }
<a name="l449"><span class="linenum"> 449</span></a>          }
<a name="l450"><span class="linenum"> 450</span></a>  
<a name="l451"><span class="linenum"> 451</span></a>  <span class="comment">        // $ok === NULL (or other): execute plugin event BeforeUninstallPayload() below</span>
<a name="l452"><span class="linenum"> 452</span></a>  <span class="comment">        // $ok === false: let the admin confirm DB table dropping below</span>
<a name="l453"><span class="linenum"> 453</span></a>          <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'uninstall';
<a name="l454"><span class="linenum"> 454</span></a>  
<a name="l455"><span class="linenum"> 455</span></a>          break;
<a name="l456"><span class="linenum"> 456</span></a>  
<a name="l457"><span class="linenum"> 457</span></a>  
<a name="l458"><span class="linenum"> 458</span></a>      case 'update_settings':
<a name="l459"><span class="linenum"> 459</span></a>  <span class="comment">        // Update plugin settings:</span>
<a name="l460"><span class="linenum"> 460</span></a>  
<a name="l461"><span class="linenum"> 461</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l462"><span class="linenum"> 462</span></a>          <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'plugin' );
<a name="l463"><span class="linenum"> 463</span></a>  
<a name="l464"><span class="linenum"> 464</span></a>  <span class="comment">        // Check permission:</span>
<a name="l465"><span class="linenum"> 465</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'options', 'edit', true );
<a name="l466"><span class="linenum"> 466</span></a>  
<a name="l467"><span class="linenum"> 467</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'plugin_ID', 'integer', true );
<a name="l468"><span class="linenum"> 468</span></a>  
<a name="l469"><span class="linenum"> 469</span></a>          <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a> = &amp; <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;get_by_ID( <a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a> );
<a name="l470"><span class="linenum"> 470</span></a>          if( empty(<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>) )
<a name="l471"><span class="linenum"> 471</span></a>          {
<a name="l472"><span class="linenum"> 472</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>( 'The plugin with ID %d could not be instantiated.' ), <a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a> ), 'error' );
<a name="l473"><span class="linenum"> 473</span></a>              <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'list';
<a name="l474"><span class="linenum"> 474</span></a>              break;
<a name="l475"><span class="linenum"> 475</span></a>          }
<a name="l476"><span class="linenum"> 476</span></a>  
<a name="l477"><span class="linenum"> 477</span></a>  <span class="comment">        // Params from/for form:</span>
<a name="l478"><span class="linenum"> 478</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'edited_plugin_name' );
<a name="l479"><span class="linenum"> 479</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'edited_plugin_shortdesc' );
<a name="l480"><span class="linenum"> 480</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'edited_plugin_code' );
<a name="l481"><span class="linenum"> 481</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'edited_plugin_priority' );
<a name="l482"><span class="linenum"> 482</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'edited_plugin_apply_rendering' );
<a name="l483"><span class="linenum"> 483</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'edited_plugin_displayed_events', 'array/string', array() );
<a name="l484"><span class="linenum"> 484</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'edited_plugin_events', 'array/integer', array() );
<a name="l485"><span class="linenum"> 485</span></a>  
<a name="l486"><span class="linenum"> 486</span></a>          <a class="var it3624" onMouseOver="hilite(3624)" onMouseOut="lolite()" onClick="logVariable('default_Plugin')" href="../../../_variables/default_Plugin.html">$default_Plugin</a> = &amp; <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('register')" href="../../../_functions/register.html" onMouseOver="funcPopup(event,'register')">register</a>(<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('classname')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a>);
<a name="l487"><span class="linenum"> 487</span></a>  
<a name="l488"><span class="linenum"> 488</span></a>  <span class="comment">        // Update plugin name:</span>
<a name="l489"><span class="linenum"> 489</span></a>  <span class="comment">        // (Only if changed to preserve initial localization feature and therefor also priorize NULL)</span>
<a name="l490"><span class="linenum"> 490</span></a>          if( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('name')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a> != <a class="var it3625" onMouseOver="hilite(3625)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_name')" href="../../../_variables/edited_plugin_name.html">$edited_plugin_name</a> )
<a name="l491"><span class="linenum"> 491</span></a>          {
<a name="l492"><span class="linenum"> 492</span></a>              <a class="var it3626" onMouseOver="hilite(3626)" onMouseOut="lolite()" onClick="logVariable('set_to')" href="../../../_variables/set_to.html">$set_to</a> = <a class="var it3625" onMouseOver="hilite(3625)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_name')" href="../../../_variables/edited_plugin_name.html">$edited_plugin_name</a> == <a class="var it3624" onMouseOver="hilite(3624)" onMouseOut="lolite()" onClick="logVariable('default_Plugin')" href="../../../_variables/default_Plugin.html">$default_Plugin</a>-&gt;<a onClick="logVariable('name')" class="var it8982" onMouseOver="hilite(8982)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a> ? NULL : <a class="var it3625" onMouseOver="hilite(3625)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_name')" href="../../../_variables/edited_plugin_name.html">$edited_plugin_name</a>;
<a name="l493"><span class="linenum"> 493</span></a>              <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('name')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a> = <a class="var it3625" onMouseOver="hilite(3625)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_name')" href="../../../_variables/edited_plugin_name.html">$edited_plugin_name</a>;
<a name="l494"><span class="linenum"> 494</span></a>              if( <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( '
<a name="l495"><span class="linenum"> 495</span></a>                  UPDATE T_plugins
<a name="l496"><span class="linenum"> 496</span></a>                       SET plug_name = '.<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>(<a class="var it3626" onMouseOver="hilite(3626)" onMouseOut="lolite()" onClick="logVariable('set_to')" href="../../../_variables/set_to.html">$set_to</a>).'
<a name="l497"><span class="linenum"> 497</span></a>                   WHERE plug_ID = '.<a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a> ) )
<a name="l498"><span class="linenum"> 498</span></a>              {
<a name="l499"><span class="linenum"> 499</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Plugin name updated.'), 'success' );
<a name="l500"><span class="linenum"> 500</span></a>              }
<a name="l501"><span class="linenum"> 501</span></a>          }
<a name="l502"><span class="linenum"> 502</span></a>  
<a name="l503"><span class="linenum"> 503</span></a>  <span class="comment">        // Update plugin shortdesc:</span>
<a name="l504"><span class="linenum"> 504</span></a>  <span class="comment">        // (Only if changed to preserve initial localization feature and therefor also priorize NULL)</span>
<a name="l505"><span class="linenum"> 505</span></a>          if( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('short_desc')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/short_desc.html">short_desc</a> != <a class="var it3627" onMouseOver="hilite(3627)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_shortdesc')" href="../../../_variables/edited_plugin_shortdesc.html">$edited_plugin_shortdesc</a> )
<a name="l506"><span class="linenum"> 506</span></a>          {
<a name="l507"><span class="linenum"> 507</span></a>              <a class="var it3626" onMouseOver="hilite(3626)" onMouseOut="lolite()" onClick="logVariable('set_to')" href="../../../_variables/set_to.html">$set_to</a> = <a class="var it3627" onMouseOver="hilite(3627)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_shortdesc')" href="../../../_variables/edited_plugin_shortdesc.html">$edited_plugin_shortdesc</a> == <a class="var it3624" onMouseOver="hilite(3624)" onMouseOut="lolite()" onClick="logVariable('default_Plugin')" href="../../../_variables/default_Plugin.html">$default_Plugin</a>-&gt;<a onClick="logVariable('short_desc')" class="var it8982" onMouseOver="hilite(8982)" onMouseOut="lolite()" href="../../../_variables/short_desc.html">short_desc</a> ? NULL : <a class="var it3627" onMouseOver="hilite(3627)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_shortdesc')" href="../../../_variables/edited_plugin_shortdesc.html">$edited_plugin_shortdesc</a>;
<a name="l508"><span class="linenum"> 508</span></a>              <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('short_desc')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/short_desc.html">short_desc</a> = <a class="var it3627" onMouseOver="hilite(3627)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_shortdesc')" href="../../../_variables/edited_plugin_shortdesc.html">$edited_plugin_shortdesc</a>;
<a name="l509"><span class="linenum"> 509</span></a>              if( <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( '
<a name="l510"><span class="linenum"> 510</span></a>                  UPDATE T_plugins
<a name="l511"><span class="linenum"> 511</span></a>                       SET plug_shortdesc = '.<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>(<a class="var it3626" onMouseOver="hilite(3626)" onMouseOut="lolite()" onClick="logVariable('set_to')" href="../../../_variables/set_to.html">$set_to</a>).'
<a name="l512"><span class="linenum"> 512</span></a>                   WHERE plug_ID = '.<a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a> ) )
<a name="l513"><span class="linenum"> 513</span></a>              {
<a name="l514"><span class="linenum"> 514</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Plugin description updated.'), 'success' );
<a name="l515"><span class="linenum"> 515</span></a>              }
<a name="l516"><span class="linenum"> 516</span></a>          }
<a name="l517"><span class="linenum"> 517</span></a>  
<a name="l518"><span class="linenum"> 518</span></a>  
<a name="l519"><span class="linenum"> 519</span></a>  <span class="comment">        // Plugin Events:</span>
<a name="l520"><span class="linenum"> 520</span></a>          <a class="var it3628" onMouseOver="hilite(3628)" onMouseOut="lolite()" onClick="logVariable('registered_events')" href="../../../_variables/registered_events.html">$registered_events</a> = <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('get_registered_events')" href="../../../_functions/get_registered_events.html" onMouseOver="funcPopup(event,'get_registered_events')">get_registered_events</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a> );
<a name="l521"><span class="linenum"> 521</span></a>  
<a name="l522"><span class="linenum"> 522</span></a>          <a class="var it3629" onMouseOver="hilite(3629)" onMouseOut="lolite()" onClick="logVariable('enable_events')" href="../../../_variables/enable_events.html">$enable_events</a> = array();
<a name="l523"><span class="linenum"> 523</span></a>          <a class="var it3630" onMouseOver="hilite(3630)" onMouseOut="lolite()" onClick="logVariable('disable_events')" href="../../../_variables/disable_events.html">$disable_events</a> = array();
<a name="l524"><span class="linenum"> 524</span></a>          foreach( <a class="var it3631" onMouseOver="hilite(3631)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_displayed_events')" href="../../../_variables/edited_plugin_displayed_events.html">$edited_plugin_displayed_events</a> as <a class="var it3632" onMouseOver="hilite(3632)" onMouseOut="lolite()" onClick="logVariable('l_event')" href="../../../_variables/l_event.html">$l_event</a> )
<a name="l525"><span class="linenum"> 525</span></a>          {
<a name="l526"><span class="linenum"> 526</span></a>              if( ! <a class="phpfunction" onClick="logFunction('in_array')" href="../../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>( <a class="var it3632" onMouseOver="hilite(3632)" onMouseOut="lolite()" onClick="logVariable('l_event')" href="../../../_variables/l_event.html">$l_event</a>, <a class="var it3628" onMouseOver="hilite(3628)" onMouseOut="lolite()" onClick="logVariable('registered_events')" href="../../../_variables/registered_events.html">$registered_events</a> ) )
<a name="l527"><span class="linenum"> 527</span></a>              { // unsupported event
<a name="l528"><span class="linenum"> 528</span></a>                  continue;
<a name="l529"><span class="linenum"> 529</span></a>              }
<a name="l530"><span class="linenum"> 530</span></a>              if( isset(<a class="var it3633" onMouseOver="hilite(3633)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_events')" href="../../../_variables/edited_plugin_events.html">$edited_plugin_events</a>[<a class="var it3632" onMouseOver="hilite(3632)" onMouseOut="lolite()" onClick="logVariable('l_event')" href="../../../_variables/l_event.html">$l_event</a>]) &amp;&amp; <a class="var it3633" onMouseOver="hilite(3633)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_events')" href="../../../_variables/edited_plugin_events.html">$edited_plugin_events</a>[<a class="var it3632" onMouseOver="hilite(3632)" onMouseOut="lolite()" onClick="logVariable('l_event')" href="../../../_variables/l_event.html">$l_event</a>] )
<a name="l531"><span class="linenum"> 531</span></a>              {
<a name="l532"><span class="linenum"> 532</span></a>                  <a class="var it3629" onMouseOver="hilite(3629)" onMouseOut="lolite()" onClick="logVariable('enable_events')" href="../../../_variables/enable_events.html">$enable_events</a>[] = <a class="var it3632" onMouseOver="hilite(3632)" onMouseOut="lolite()" onClick="logVariable('l_event')" href="../../../_variables/l_event.html">$l_event</a>; <span class="comment">// may be already there</span>
<a name="l533"><span class="linenum"> 533</span></a>              }
<a name="l534"><span class="linenum"> 534</span></a>              else
<a name="l535"><span class="linenum"> 535</span></a>              { // unset:
<a name="l536"><span class="linenum"> 536</span></a>                  <a class="var it3630" onMouseOver="hilite(3630)" onMouseOut="lolite()" onClick="logVariable('disable_events')" href="../../../_variables/disable_events.html">$disable_events</a>[] = <a class="var it3632" onMouseOver="hilite(3632)" onMouseOut="lolite()" onClick="logVariable('l_event')" href="../../../_variables/l_event.html">$l_event</a>;
<a name="l537"><span class="linenum"> 537</span></a>              }
<a name="l538"><span class="linenum"> 538</span></a>          }
<a name="l539"><span class="linenum"> 539</span></a>          if( <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('save_events')" href="../../../_functions/save_events.html" onMouseOver="funcPopup(event,'save_events')">save_events</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>, <a class="var it3629" onMouseOver="hilite(3629)" onMouseOut="lolite()" onClick="logVariable('enable_events')" href="../../../_variables/enable_events.html">$enable_events</a>, <a class="var it3630" onMouseOver="hilite(3630)" onMouseOut="lolite()" onClick="logVariable('disable_events')" href="../../../_variables/disable_events.html">$disable_events</a> ) )
<a name="l540"><span class="linenum"> 540</span></a>          {
<a name="l541"><span class="linenum"> 541</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Plugin events have been updated.'), 'success' );
<a name="l542"><span class="linenum"> 542</span></a>          }
<a name="l543"><span class="linenum"> 543</span></a>  
<a name="l544"><span class="linenum"> 544</span></a>  
<a name="l545"><span class="linenum"> 545</span></a>  <span class="comment">        // Plugin code</span>
<a name="l546"><span class="linenum"> 546</span></a>  <span class="comment">        // Check if a ping plugin has a code (which is required) (this has to go after event handling!):</span>
<a name="l547"><span class="linenum"> 547</span></a>          if( <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('has_event')" href="../../../_functions/has_event.html" onMouseOver="funcPopup(event,'has_event')">has_event</a>(<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, 'ItemSendPing')
<a name="l548"><span class="linenum"> 548</span></a>              &amp;&amp; empty(<a class="var it3634" onMouseOver="hilite(3634)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_code')" href="../../../_variables/edited_plugin_code.html">$edited_plugin_code</a>) )
<a name="l549"><span class="linenum"> 549</span></a>          {
<a name="l550"><span class="linenum"> 550</span></a>              <a class="function" onClick="logFunction('param_error')" href="../../../_functions/param_error.html" onMouseOver="funcPopup(event,'param_error')">param_error</a>( 'edited_plugin_code', sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('This ping plugin needs a non-empty code.'), <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('name')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a> ) );
<a name="l551"><span class="linenum"> 551</span></a>          }
<a name="l552"><span class="linenum"> 552</span></a>          else
<a name="l553"><span class="linenum"> 553</span></a>          {
<a name="l554"><span class="linenum"> 554</span></a>              <a class="var it3635" onMouseOver="hilite(3635)" onMouseOut="lolite()" onClick="logVariable('updated')" href="../../../_variables/updated.html">$updated</a> = <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('set_code')" href="../../../_functions/set_code.html" onMouseOver="funcPopup(event,'set_code')">set_code</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, <a class="var it3634" onMouseOver="hilite(3634)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_code')" href="../../../_variables/edited_plugin_code.html">$edited_plugin_code</a> );
<a name="l555"><span class="linenum"> 555</span></a>              if( <a class="phpfunction" onClick="logFunction('is_string')" href="../../../_functions/is_string.html" onMouseOver="phpfuncPopup(event,'is_string')">is_string</a>( <a class="var it3635" onMouseOver="hilite(3635)" onMouseOut="lolite()" onClick="logVariable('updated')" href="../../../_variables/updated.html">$updated</a> ) )
<a name="l556"><span class="linenum"> 556</span></a>              {
<a name="l557"><span class="linenum"> 557</span></a>                  <a class="function" onClick="logFunction('param_error')" href="../../../_functions/param_error.html" onMouseOver="funcPopup(event,'param_error')">param_error</a>( 'edited_plugin_code', <a class="var it3635" onMouseOver="hilite(3635)" onMouseOut="lolite()" onClick="logVariable('updated')" href="../../../_variables/updated.html">$updated</a> );
<a name="l558"><span class="linenum"> 558</span></a>                  <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'edit_settings';
<a name="l559"><span class="linenum"> 559</span></a>              }
<a name="l560"><span class="linenum"> 560</span></a>              elseif( <a class="var it3635" onMouseOver="hilite(3635)" onMouseOut="lolite()" onClick="logVariable('updated')" href="../../../_variables/updated.html">$updated</a> === 1 )
<a name="l561"><span class="linenum"> 561</span></a>              {
<a name="l562"><span class="linenum"> 562</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Plugin code updated.'), 'success' );
<a name="l563"><span class="linenum"> 563</span></a>              }
<a name="l564"><span class="linenum"> 564</span></a>          }
<a name="l565"><span class="linenum"> 565</span></a>  
<a name="l566"><span class="linenum"> 566</span></a>  
<a name="l567"><span class="linenum"> 567</span></a>  <span class="comment">        // Plugin priority</span>
<a name="l568"><span class="linenum"> 568</span></a>          if( <a class="function" onClick="logFunction('param_check_range')" href="../../../_functions/param_check_range.html" onMouseOver="funcPopup(event,'param_check_range')">param_check_range</a>( 'edited_plugin_priority', 0, 100, <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Plugin priority must be numeric (0-100).'), true ) )
<a name="l569"><span class="linenum"> 569</span></a>          {
<a name="l570"><span class="linenum"> 570</span></a>              <a class="var it3635" onMouseOver="hilite(3635)" onMouseOut="lolite()" onClick="logVariable('updated')" href="../../../_variables/updated.html">$updated</a> = <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('set_priority')" href="../../../_functions/set_priority.html" onMouseOver="funcPopup(event,'set_priority')">set_priority</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, <a class="var it3636" onMouseOver="hilite(3636)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_priority')" href="../../../_variables/edited_plugin_priority.html">$edited_plugin_priority</a> );
<a name="l571"><span class="linenum"> 571</span></a>              if( <a class="var it3635" onMouseOver="hilite(3635)" onMouseOut="lolite()" onClick="logVariable('updated')" href="../../../_variables/updated.html">$updated</a> === 1 )
<a name="l572"><span class="linenum"> 572</span></a>              {
<a name="l573"><span class="linenum"> 573</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Plugin priority updated.'), 'success' );
<a name="l574"><span class="linenum"> 574</span></a>              }
<a name="l575"><span class="linenum"> 575</span></a>          }
<a name="l576"><span class="linenum"> 576</span></a>          else
<a name="l577"><span class="linenum"> 577</span></a>          {
<a name="l578"><span class="linenum"> 578</span></a>              <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'edit_settings';
<a name="l579"><span class="linenum"> 579</span></a>          }
<a name="l580"><span class="linenum"> 580</span></a>  
<a name="l581"><span class="linenum"> 581</span></a>  <span class="comment">        // Plugin specific settings:</span>
<a name="l582"><span class="linenum"> 582</span></a>          if( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('Settings')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/Settings.html">Settings</a> )
<a name="l583"><span class="linenum"> 583</span></a>          {
<a name="l584"><span class="linenum"> 584</span></a>              <a class="function" onClick="logFunction('load_funcs')" href="../../../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>('plugins/_plugin.funcs.php');
<a name="l585"><span class="linenum"> 585</span></a>  
<a name="l586"><span class="linenum"> 586</span></a>  <span class="comment">            // Loop through settings for this plugin:</span>
<a name="l587"><span class="linenum"> 587</span></a>              foreach( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a class="function" onClick="logFunction('GetDefaultSettings')" href="../../../_functions/getdefaultsettings.html" onMouseOver="funcPopup(event,'getdefaultsettings')">GetDefaultSettings</a>( <a class="var it1500" onMouseOver="hilite(1500)" onMouseOut="lolite()" onClick="logVariable('dummy')" href="../../../_variables/dummy.html">$dummy</a> = array('for_editing' =&gt; true) ) as <a class="var it3637" onMouseOver="hilite(3637)" onMouseOut="lolite()" onClick="logVariable('set_name')" href="../../../_variables/set_name.html">$set_name</a> =&gt; <a class="var it3638" onMouseOver="hilite(3638)" onMouseOut="lolite()" onClick="logVariable('set_meta')" href="../../../_variables/set_meta.html">$set_meta</a> )
<a name="l588"><span class="linenum"> 588</span></a>              {
<a name="l589"><span class="linenum"> 589</span></a>                  <a class="function" onClick="logFunction('autoform_set_param_from_request')" href="../../../_functions/autoform_set_param_from_request.html" onMouseOver="funcPopup(event,'autoform_set_param_from_request')">autoform_set_param_from_request</a>( <a class="var it3637" onMouseOver="hilite(3637)" onMouseOut="lolite()" onClick="logVariable('set_name')" href="../../../_variables/set_name.html">$set_name</a>, <a class="var it3638" onMouseOver="hilite(3638)" onMouseOut="lolite()" onClick="logVariable('set_meta')" href="../../../_variables/set_meta.html">$set_meta</a>, <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>, 'Settings' );
<a name="l590"><span class="linenum"> 590</span></a>              }
<a name="l591"><span class="linenum"> 591</span></a>  
<a name="l592"><span class="linenum"> 592</span></a>  <span class="comment">            // Let the plugin handle custom fields:</span>
<a name="l593"><span class="linenum"> 593</span></a>  <span class="comment">            // We use call_method to keep track of this call, although calling the plugins PluginSettingsUpdateAction method directly _might_ work, too.</span>
<a name="l594"><span class="linenum"> 594</span></a>              <a class="var it3639" onMouseOver="hilite(3639)" onMouseOut="lolite()" onClick="logVariable('ok_to_update')" href="../../../_variables/ok_to_update.html">$ok_to_update</a> = <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('call_method')" href="../../../_functions/call_method.html" onMouseOver="funcPopup(event,'call_method')">call_method</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, 'PluginSettingsUpdateAction', <a class="var it352" onMouseOver="hilite(352)" onMouseOut="lolite()" onClick="logVariable('tmp_params')" href="../../../_variables/tmp_params.html">$tmp_params</a> = array() );
<a name="l595"><span class="linenum"> 595</span></a>  
<a name="l596"><span class="linenum"> 596</span></a>              if( <a class="var it3639" onMouseOver="hilite(3639)" onMouseOut="lolite()" onClick="logVariable('ok_to_update')" href="../../../_variables/ok_to_update.html">$ok_to_update</a> === false )
<a name="l597"><span class="linenum"> 597</span></a>              {    // Rollback settings: the plugin has said they should not get updated.
<a name="l598"><span class="linenum"> 598</span></a>                  <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('Settings')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/Settings.html">Settings</a>-&gt;<a class="phpfunction" onClick="logFunction('reset')" href="../../../_functions/reset.html" onMouseOver="phpfuncPopup(event,'reset')">reset</a>();
<a name="l599"><span class="linenum"> 599</span></a>              }
<a name="l600"><span class="linenum"> 600</span></a>              elseif( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('Settings')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/Settings.html">Settings</a>-&gt;<a class="function" onClick="logFunction('dbupdate')" href="../../../_functions/dbupdate.html" onMouseOver="funcPopup(event,'dbupdate')">dbupdate</a>() )
<a name="l601"><span class="linenum"> 601</span></a>              {
<a name="l602"><span class="linenum"> 602</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Plugin settings have been updated.'), 'success' );
<a name="l603"><span class="linenum"> 603</span></a>              }
<a name="l604"><span class="linenum"> 604</span></a>          }
<a name="l605"><span class="linenum"> 605</span></a>  
<a name="l606"><span class="linenum"> 606</span></a>  <span class="comment">        // Check if it can stay enabled, if it is</span>
<a name="l607"><span class="linenum"> 607</span></a>          if( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('status')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/status.html">status</a> == 'enabled' )
<a name="l608"><span class="linenum"> 608</span></a>          {
<a name="l609"><span class="linenum"> 609</span></a>              <a class="var it3617" onMouseOver="hilite(3617)" onMouseOut="lolite()" onClick="logVariable('enable_return')" href="../../../_variables/enable_return.html">$enable_return</a> = <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a class="function" onClick="logFunction('BeforeEnable')" href="../../../_functions/beforeenable.html" onMouseOver="funcPopup(event,'beforeenable')">BeforeEnable</a>();
<a name="l610"><span class="linenum"> 610</span></a>              if( <a class="var it3617" onMouseOver="hilite(3617)" onMouseOut="lolite()" onClick="logVariable('enable_return')" href="../../../_variables/enable_return.html">$enable_return</a> !== true )
<a name="l611"><span class="linenum"> 611</span></a>              {
<a name="l612"><span class="linenum"> 612</span></a>                  <a class="var it16" onMouseOver="hilite(16)" onMouseOut="lolite()" onClick="logVariable('Plugins')" href="../../../_variables/Plugins.html">$Plugins</a>-&gt;<a class="function" onClick="logFunction('set_Plugin_status')" href="../../../_functions/set_plugin_status.html" onMouseOver="funcPopup(event,'set_plugin_status')">set_Plugin_status</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>, 'needs_config' );
<a name="l613"><span class="linenum"> 613</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The plugin has been disabled.').( empty(<a class="var it3617" onMouseOver="hilite(3617)" onMouseOut="lolite()" onClick="logVariable('enable_return')" href="../../../_variables/enable_return.html">$enable_return</a>) ? '' : '&lt;br /&gt;'.<a class="var it3617" onMouseOver="hilite(3617)" onMouseOut="lolite()" onClick="logVariable('enable_return')" href="../../../_variables/enable_return.html">$enable_return</a> ), 'error' );
<a name="l614"><span class="linenum"> 614</span></a>              }
<a name="l615"><span class="linenum"> 615</span></a>          }
<a name="l616"><span class="linenum"> 616</span></a>  
<a name="l617"><span class="linenum"> 617</span></a>          if( ! <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('has_errors')" href="../../../_functions/has_errors.html" onMouseOver="funcPopup(event,'has_errors')">has_errors</a>() )
<a name="l618"><span class="linenum"> 618</span></a>          { // there were no errors, go back to list:
<a name="l619"><span class="linenum"> 619</span></a>  <span class="comment">            //save fadeout item</span>
<a name="l620"><span class="linenum"> 620</span></a>              <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>('fadeout_id', <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>);
<a name="l621"><span class="linenum"> 621</span></a>  
<a name="l622"><span class="linenum"> 622</span></a>  <span class="comment">            // Redirect so that a reload doesn't write to the DB twice:</span>
<a name="l623"><span class="linenum"> 623</span></a>              <a class="function" onClick="logFunction('header_redirect')" href="../../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( '?ctrl=plugins', 303 ); <span class="comment">// Will EXIT</span>
<a name="l624"><span class="linenum"> 624</span></a>  
<a name="l625"><span class="linenum"> 625</span></a>  <span class="comment">            // We have EXITed already at this point!!</span>
<a name="l626"><span class="linenum"> 626</span></a>          }
<a name="l627"><span class="linenum"> 627</span></a>  
<a name="l628"><span class="linenum"> 628</span></a>  <span class="comment">        // Redisplay so user can fix errors:</span>
<a name="l629"><span class="linenum"> 629</span></a>          <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'edit_settings';
<a name="l630"><span class="linenum"> 630</span></a>          break;
<a name="l631"><span class="linenum"> 631</span></a>  
<a name="l632"><span class="linenum"> 632</span></a>  
<a name="l633"><span class="linenum"> 633</span></a>      case 'edit_settings':
<a name="l634"><span class="linenum"> 634</span></a>  <span class="comment">        // Check permission:</span>
<a name="l635"><span class="linenum"> 635</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'options', 'view', true );
<a name="l636"><span class="linenum"> 636</span></a>  
<a name="l637"><span class="linenum"> 637</span></a>  <span class="comment">        // Edit plugin settings:</span>
<a name="l638"><span class="linenum"> 638</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'plugin_ID', 'integer', true );
<a name="l639"><span class="linenum"> 639</span></a>  
<a name="l640"><span class="linenum"> 640</span></a>          <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a> = &amp; <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;get_by_ID( <a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a> );
<a name="l641"><span class="linenum"> 641</span></a>  
<a name="l642"><span class="linenum"> 642</span></a>          if( ! <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a> )
<a name="l643"><span class="linenum"> 643</span></a>          {
<a name="l644"><span class="linenum"> 644</span></a>              <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'The plugin with ID '.<a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a>.' was not found.', array('plugins', 'error') );
<a name="l645"><span class="linenum"> 645</span></a>              <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'list';
<a name="l646"><span class="linenum"> 646</span></a>              break;
<a name="l647"><span class="linenum"> 647</span></a>          }
<a name="l648"><span class="linenum"> 648</span></a>  
<a name="l649"><span class="linenum"> 649</span></a>  <span class="comment">        // Detect new events, so they get displayed correctly in the &quot;Edit events&quot; fieldset:</span>
<a name="l650"><span class="linenum"> 650</span></a>          <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('save_events')" href="../../../_functions/save_events.html" onMouseOver="funcPopup(event,'save_events')">save_events</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>, array() );
<a name="l651"><span class="linenum"> 651</span></a>  
<a name="l652"><span class="linenum"> 652</span></a>  <span class="comment">        // Inform Plugin that it gets edited:</span>
<a name="l653"><span class="linenum"> 653</span></a>          <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('call_method')" href="../../../_functions/call_method.html" onMouseOver="funcPopup(event,'call_method')">call_method</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, 'PluginSettingsEditAction', <a class="var it352" onMouseOver="hilite(352)" onMouseOut="lolite()" onClick="logVariable('tmp_params')" href="../../../_variables/tmp_params.html">$tmp_params</a> = array() );
<a name="l654"><span class="linenum"> 654</span></a>  
<a name="l655"><span class="linenum"> 655</span></a>  <span class="comment">        // Params for form:</span>
<a name="l656"><span class="linenum"> 656</span></a>          <a class="var it3625" onMouseOver="hilite(3625)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_name')" href="../../../_variables/edited_plugin_name.html">$edited_plugin_name</a> = <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('name')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a>;
<a name="l657"><span class="linenum"> 657</span></a>          <a class="var it3627" onMouseOver="hilite(3627)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_shortdesc')" href="../../../_variables/edited_plugin_shortdesc.html">$edited_plugin_shortdesc</a> = <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('short_desc')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/short_desc.html">short_desc</a>;
<a name="l658"><span class="linenum"> 658</span></a>          <a class="var it3634" onMouseOver="hilite(3634)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_code')" href="../../../_variables/edited_plugin_code.html">$edited_plugin_code</a> = <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('code')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/code.html">code</a>;
<a name="l659"><span class="linenum"> 659</span></a>          <a class="var it3636" onMouseOver="hilite(3636)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_priority')" href="../../../_variables/edited_plugin_priority.html">$edited_plugin_priority</a> = <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('priority')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/priority.html">priority</a>;
<a name="l660"><span class="linenum"> 660</span></a>  
<a name="l661"><span class="linenum"> 661</span></a>          break;
<a name="l662"><span class="linenum"> 662</span></a>  
<a name="l663"><span class="linenum"> 663</span></a>  
<a name="l664"><span class="linenum"> 664</span></a>      case 'default_settings':
<a name="l665"><span class="linenum"> 665</span></a>  <span class="comment">        // Restore default settings</span>
<a name="l666"><span class="linenum"> 666</span></a>  
<a name="l667"><span class="linenum"> 667</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l668"><span class="linenum"> 668</span></a>          <a class="var it228" onMouseOver="hilite(228)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'plugin' );
<a name="l669"><span class="linenum"> 669</span></a>  
<a name="l670"><span class="linenum"> 670</span></a>  <span class="comment">        // Check permission:</span>
<a name="l671"><span class="linenum"> 671</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'options', 'edit', true );
<a name="l672"><span class="linenum"> 672</span></a>  
<a name="l673"><span class="linenum"> 673</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'plugin_ID', 'integer', true );
<a name="l674"><span class="linenum"> 674</span></a>  
<a name="l675"><span class="linenum"> 675</span></a>          <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a> = &amp; <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;get_by_ID( <a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a> );
<a name="l676"><span class="linenum"> 676</span></a>          if( !<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a> )
<a name="l677"><span class="linenum"> 677</span></a>          {
<a name="l678"><span class="linenum"> 678</span></a>              <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'The plugin with ID '.<a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a>.' was not found.', array('plugins', 'error') );
<a name="l679"><span class="linenum"> 679</span></a>              <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'list';
<a name="l680"><span class="linenum"> 680</span></a>              break;
<a name="l681"><span class="linenum"> 681</span></a>          }
<a name="l682"><span class="linenum"> 682</span></a>  
<a name="l683"><span class="linenum"> 683</span></a>  <span class="comment">        // this returns NULL for code as it's seen as a duplicate plugin</span>
<a name="l684"><span class="linenum"> 684</span></a>          <a class="var it3624" onMouseOver="hilite(3624)" onMouseOut="lolite()" onClick="logVariable('default_Plugin')" href="../../../_variables/default_Plugin.html">$default_Plugin</a> = &amp; <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('register')" href="../../../_functions/register.html" onMouseOver="funcPopup(event,'register')">register</a>(<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('classname')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a>);
<a name="l685"><span class="linenum"> 685</span></a>  
<a name="l686"><span class="linenum"> 686</span></a>  <span class="comment">        // grab a raw copy of the plugin</span>
<a name="l687"><span class="linenum"> 687</span></a>          <a class="var it3640" onMouseOver="hilite(3640)" onMouseOut="lolite()" onClick="logVariable('raw_Plugin')" href="../../../_variables/raw_Plugin.html">$raw_Plugin</a> = new <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;classname();
<a name="l688"><span class="linenum"> 688</span></a>  
<a name="l689"><span class="linenum"> 689</span></a>  <span class="comment">        // Params for/&quot;from&quot; form:</span>
<a name="l690"><span class="linenum"> 690</span></a>          <a class="var it3625" onMouseOver="hilite(3625)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_name')" href="../../../_variables/edited_plugin_name.html">$edited_plugin_name</a> = <a class="var it3624" onMouseOver="hilite(3624)" onMouseOut="lolite()" onClick="logVariable('default_Plugin')" href="../../../_variables/default_Plugin.html">$default_Plugin</a>-&gt;<a onClick="logVariable('name')" class="var it8982" onMouseOver="hilite(8982)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a>;
<a name="l691"><span class="linenum"> 691</span></a>          <a class="var it3627" onMouseOver="hilite(3627)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_shortdesc')" href="../../../_variables/edited_plugin_shortdesc.html">$edited_plugin_shortdesc</a> = <a class="var it3624" onMouseOver="hilite(3624)" onMouseOut="lolite()" onClick="logVariable('default_Plugin')" href="../../../_variables/default_Plugin.html">$default_Plugin</a>-&gt;<a onClick="logVariable('short_desc')" class="var it8982" onMouseOver="hilite(8982)" onMouseOut="lolite()" href="../../../_variables/short_desc.html">short_desc</a>;
<a name="l692"><span class="linenum"> 692</span></a>          <a class="var it3634" onMouseOver="hilite(3634)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_code')" href="../../../_variables/edited_plugin_code.html">$edited_plugin_code</a> = <a class="var it3640" onMouseOver="hilite(3640)" onMouseOut="lolite()" onClick="logVariable('raw_Plugin')" href="../../../_variables/raw_Plugin.html">$raw_Plugin</a>-&gt;<a onClick="logVariable('code')" class="var it9137" onMouseOver="hilite(9137)" onMouseOut="lolite()" href="../../../_variables/code.html">code</a>;
<a name="l693"><span class="linenum"> 693</span></a>          <a class="var it3636" onMouseOver="hilite(3636)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_priority')" href="../../../_variables/edited_plugin_priority.html">$edited_plugin_priority</a> = <a class="var it3624" onMouseOver="hilite(3624)" onMouseOut="lolite()" onClick="logVariable('default_Plugin')" href="../../../_variables/default_Plugin.html">$default_Plugin</a>-&gt;<a onClick="logVariable('priority')" class="var it8982" onMouseOver="hilite(8982)" onMouseOut="lolite()" href="../../../_variables/priority.html">priority</a>;
<a name="l694"><span class="linenum"> 694</span></a>  
<a name="l695"><span class="linenum"> 695</span></a>  <span class="comment">        // Name and short desc:</span>
<a name="l696"><span class="linenum"> 696</span></a>          <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( '
<a name="l697"><span class="linenum"> 697</span></a>                  UPDATE T_plugins
<a name="l698"><span class="linenum"> 698</span></a>                     SET plug_name = NULL,
<a name="l699"><span class="linenum"> 699</span></a>                         plug_shortdesc = NULL
<a name="l700"><span class="linenum"> 700</span></a>                   WHERE plug_ID = '.<a class="var it2372" onMouseOver="hilite(2372)" onMouseOut="lolite()" onClick="logVariable('plugin_ID')" href="../../../_variables/plugin_ID.html">$plugin_ID</a> );
<a name="l701"><span class="linenum"> 701</span></a>  
<a name="l702"><span class="linenum"> 702</span></a>  <span class="comment">        // Code:</span>
<a name="l703"><span class="linenum"> 703</span></a>          <a class="var it3635" onMouseOver="hilite(3635)" onMouseOut="lolite()" onClick="logVariable('updated')" href="../../../_variables/updated.html">$updated</a> = <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('set_code')" href="../../../_functions/set_code.html" onMouseOver="funcPopup(event,'set_code')">set_code</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, <a class="var it3634" onMouseOver="hilite(3634)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_code')" href="../../../_variables/edited_plugin_code.html">$edited_plugin_code</a> );
<a name="l704"><span class="linenum"> 704</span></a>          if( <a class="phpfunction" onClick="logFunction('is_string')" href="../../../_functions/is_string.html" onMouseOver="phpfuncPopup(event,'is_string')">is_string</a>( <a class="var it3635" onMouseOver="hilite(3635)" onMouseOut="lolite()" onClick="logVariable('updated')" href="../../../_variables/updated.html">$updated</a> ) )
<a name="l705"><span class="linenum"> 705</span></a>          { // error message
<a name="l706"><span class="linenum"> 706</span></a>              <a class="function" onClick="logFunction('param_error')" href="../../../_functions/param_error.html" onMouseOver="funcPopup(event,'param_error')">param_error</a>( 'edited_plugin_code', <a class="var it3635" onMouseOver="hilite(3635)" onMouseOut="lolite()" onClick="logVariable('updated')" href="../../../_variables/updated.html">$updated</a> );
<a name="l707"><span class="linenum"> 707</span></a>              <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'edit_settings';
<a name="l708"><span class="linenum"> 708</span></a>          }
<a name="l709"><span class="linenum"> 709</span></a>          elseif( <a class="var it3635" onMouseOver="hilite(3635)" onMouseOut="lolite()" onClick="logVariable('updated')" href="../../../_variables/updated.html">$updated</a> === 1 )
<a name="l710"><span class="linenum"> 710</span></a>          {
<a name="l711"><span class="linenum"> 711</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Plugin code updated.'), 'success' );
<a name="l712"><span class="linenum"> 712</span></a>          }
<a name="l713"><span class="linenum"> 713</span></a>  
<a name="l714"><span class="linenum"> 714</span></a>  <span class="comment">        // Priority:</span>
<a name="l715"><span class="linenum"> 715</span></a>          if( ! <a class="phpfunction" onClick="logFunction('preg_match')" href="../../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>( '~^1?\d?\d$~', <a class="var it3636" onMouseOver="hilite(3636)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_priority')" href="../../../_variables/edited_plugin_priority.html">$edited_plugin_priority</a> ) )
<a name="l716"><span class="linenum"> 716</span></a>          {
<a name="l717"><span class="linenum"> 717</span></a>              <a class="function" onClick="logFunction('param_error')" href="../../../_functions/param_error.html" onMouseOver="funcPopup(event,'param_error')">param_error</a>( 'edited_plugin_priority', <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Plugin priority must be numeric (0-100).') );
<a name="l718"><span class="linenum"> 718</span></a>          }
<a name="l719"><span class="linenum"> 719</span></a>          else
<a name="l720"><span class="linenum"> 720</span></a>          {
<a name="l721"><span class="linenum"> 721</span></a>              <a class="var it3635" onMouseOver="hilite(3635)" onMouseOut="lolite()" onClick="logVariable('updated')" href="../../../_variables/updated.html">$updated</a> = <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('set_priority')" href="../../../_functions/set_priority.html" onMouseOver="funcPopup(event,'set_priority')">set_priority</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, <a class="var it3636" onMouseOver="hilite(3636)" onMouseOut="lolite()" onClick="logVariable('edited_plugin_priority')" href="../../../_variables/edited_plugin_priority.html">$edited_plugin_priority</a> );
<a name="l722"><span class="linenum"> 722</span></a>              if( <a class="var it3635" onMouseOver="hilite(3635)" onMouseOut="lolite()" onClick="logVariable('updated')" href="../../../_variables/updated.html">$updated</a> === 1 )
<a name="l723"><span class="linenum"> 723</span></a>              {
<a name="l724"><span class="linenum"> 724</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Plugin priority updated.'), 'success' );
<a name="l725"><span class="linenum"> 725</span></a>              }
<a name="l726"><span class="linenum"> 726</span></a>          }
<a name="l727"><span class="linenum"> 727</span></a>  
<a name="l728"><span class="linenum"> 728</span></a>  <span class="comment">        // PluginSettings:</span>
<a name="l729"><span class="linenum"> 729</span></a>          if( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('Settings')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/Settings.html">Settings</a> )
<a name="l730"><span class="linenum"> 730</span></a>          {
<a name="l731"><span class="linenum"> 731</span></a>              if( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('Settings')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/Settings.html">Settings</a>-&gt;<a class="function" onClick="logFunction('restore_defaults')" href="../../../_functions/restore_defaults.html" onMouseOver="funcPopup(event,'restore_defaults')">restore_defaults</a>() )
<a name="l732"><span class="linenum"> 732</span></a>              {
<a name="l733"><span class="linenum"> 733</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Restored default values.'), 'success' );
<a name="l734"><span class="linenum"> 734</span></a>              }
<a name="l735"><span class="linenum"> 735</span></a>              else
<a name="l736"><span class="linenum"> 736</span></a>              {
<a name="l737"><span class="linenum"> 737</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Settings have not changed.'), 'note' );
<a name="l738"><span class="linenum"> 738</span></a>              }
<a name="l739"><span class="linenum"> 739</span></a>          }
<a name="l740"><span class="linenum"> 740</span></a>  
<a name="l741"><span class="linenum"> 741</span></a>  <span class="comment">        // Enable all events:</span>
<a name="l742"><span class="linenum"> 742</span></a>          if( <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('save_events')" href="../../../_functions/save_events.html" onMouseOver="funcPopup(event,'save_events')">save_events</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a> ) )
<a name="l743"><span class="linenum"> 743</span></a>          {
<a name="l744"><span class="linenum"> 744</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Plugin events have been updated.'), 'success' );
<a name="l745"><span class="linenum"> 745</span></a>          }
<a name="l746"><span class="linenum"> 746</span></a>  
<a name="l747"><span class="linenum"> 747</span></a>  <span class="comment">        // Check if it can stay enabled, if it is</span>
<a name="l748"><span class="linenum"> 748</span></a>          if( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('status')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/status.html">status</a> == 'enabled' )
<a name="l749"><span class="linenum"> 749</span></a>          {
<a name="l750"><span class="linenum"> 750</span></a>              <a class="var it3617" onMouseOver="hilite(3617)" onMouseOut="lolite()" onClick="logVariable('enable_return')" href="../../../_variables/enable_return.html">$enable_return</a> = <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a class="function" onClick="logFunction('BeforeEnable')" href="../../../_functions/beforeenable.html" onMouseOver="funcPopup(event,'beforeenable')">BeforeEnable</a>();
<a name="l751"><span class="linenum"> 751</span></a>              if( <a class="var it3617" onMouseOver="hilite(3617)" onMouseOut="lolite()" onClick="logVariable('enable_return')" href="../../../_variables/enable_return.html">$enable_return</a> !== true )
<a name="l752"><span class="linenum"> 752</span></a>              {
<a name="l753"><span class="linenum"> 753</span></a>                  <a class="var it16" onMouseOver="hilite(16)" onMouseOut="lolite()" onClick="logVariable('Plugins')" href="../../../_variables/Plugins.html">$Plugins</a>-&gt;<a class="function" onClick="logFunction('set_Plugin_status')" href="../../../_functions/set_plugin_status.html" onMouseOver="funcPopup(event,'set_plugin_status')">set_Plugin_status</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>, 'needs_config' );
<a name="l754"><span class="linenum"> 754</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The plugin has been disabled.').( empty(<a class="var it3617" onMouseOver="hilite(3617)" onMouseOut="lolite()" onClick="logVariable('enable_return')" href="../../../_variables/enable_return.html">$enable_return</a>) ? '' : '&lt;br /&gt;'.<a class="var it3617" onMouseOver="hilite(3617)" onMouseOut="lolite()" onClick="logVariable('enable_return')" href="../../../_variables/enable_return.html">$enable_return</a> ), 'error' );
<a name="l755"><span class="linenum"> 755</span></a>              }
<a name="l756"><span class="linenum"> 756</span></a>          }
<a name="l757"><span class="linenum"> 757</span></a>  
<a name="l758"><span class="linenum"> 758</span></a>  <span class="comment">        // blueyed&gt;&gt; IMHO it's good to see the new settings again. Perhaps we could use $action = 'list' for &quot;Settings have not changed&quot;?</span>
<a name="l759"><span class="linenum"> 759</span></a>          <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'edit_settings';
<a name="l760"><span class="linenum"> 760</span></a>  
<a name="l761"><span class="linenum"> 761</span></a>          break;
<a name="l762"><span class="linenum"> 762</span></a>  
<a name="l763"><span class="linenum"> 763</span></a>  
<a name="l764"><span class="linenum"> 764</span></a>      case 'info':
<a name="l765"><span class="linenum"> 765</span></a>      case 'disp_help':
<a name="l766"><span class="linenum"> 766</span></a>      case 'disp_help_plain': // just the help, without any payload
<a name="l767"><span class="linenum"> 767</span></a>  
<a name="l768"><span class="linenum"> 768</span></a>  <span class="comment">        // Check permission: (with plugins... you never know...)</span>
<a name="l769"><span class="linenum"> 769</span></a>          <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'options', 'view', true );
<a name="l770"><span class="linenum"> 770</span></a>  
<a name="l771"><span class="linenum"> 771</span></a>          <a class="function" onClick="logFunction('param')" href="../../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'plugin_class', 'string', true );
<a name="l772"><span class="linenum"> 772</span></a>  
<a name="l773"><span class="linenum"> 773</span></a>          if( ! ( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a> = &amp; <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;get_by_classname( <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('plugin_class')" href="../../../_variables/plugin_class.html">$plugin_class</a> ) ) )
<a name="l774"><span class="linenum"> 774</span></a>          {    // Plugin is not installed:
<a name="l775"><span class="linenum"> 775</span></a>              <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a> = &amp; <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('register')" href="../../../_functions/register.html" onMouseOver="funcPopup(event,'register')">register</a>( <a class="var it3641" onMouseOver="hilite(3641)" onMouseOut="lolite()" onClick="logVariable('plugin_class')" href="../../../_variables/plugin_class.html">$plugin_class</a> );
<a name="l776"><span class="linenum"> 776</span></a>  
<a name="l777"><span class="linenum"> 777</span></a>              if( <a class="phpfunction" onClick="logFunction('is_string')" href="../../../_functions/is_string.html" onMouseOver="phpfuncPopup(event,'is_string')">is_string</a>(<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>) )
<a name="l778"><span class="linenum"> 778</span></a>              {
<a name="l779"><span class="linenum"> 779</span></a>                  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>(<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>, 'error');
<a name="l780"><span class="linenum"> 780</span></a>                  <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a> = false;
<a name="l781"><span class="linenum"> 781</span></a>                  <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'list';
<a name="l782"><span class="linenum"> 782</span></a>              }
<a name="l783"><span class="linenum"> 783</span></a>              else
<a name="l784"><span class="linenum"> 784</span></a>              {
<a name="l785"><span class="linenum"> 785</span></a>                  <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('unregister')" href="../../../_functions/unregister.html" onMouseOver="funcPopup(event,'unregister')">unregister</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>, true <span class="comment">/* force */</span> );
<a name="l786"><span class="linenum"> 786</span></a>              }
<a name="l787"><span class="linenum"> 787</span></a>          }
<a name="l788"><span class="linenum"> 788</span></a>  
<a name="l789"><span class="linenum"> 789</span></a>          if( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('status')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/status.html">status</a> == 'broken' )
<a name="l790"><span class="linenum"> 790</span></a>          {
<a name="l791"><span class="linenum"> 791</span></a>              <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The requested plugin doesn\'t exist!'), 'error' );
<a name="l792"><span class="linenum"> 792</span></a>          }
<a name="l793"><span class="linenum"> 793</span></a>  
<a name="l794"><span class="linenum"> 794</span></a>          break;
<a name="l795"><span class="linenum"> 795</span></a>  
<a name="l796"><span class="linenum"> 796</span></a>  }
<a name="l797"><span class="linenum"> 797</span></a>  
<a name="l798"><span class="linenum"> 798</span></a>  
<a name="l799"><span class="linenum"> 799</span></a>  <span class="comment">// Extend titlearea for some actions and add JS:</span>
<a name="l800"><span class="linenum"> 800</span></a>  switch( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> )
<a name="l801"><span class="linenum"> 801</span></a>  {
<a name="l802"><span class="linenum"> 802</span></a>      case 'edit_settings':
<a name="l803"><span class="linenum"> 803</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('append_to_titlearea')" href="../../../_functions/append_to_titlearea.html" onMouseOver="funcPopup(event,'append_to_titlearea')">append_to_titlearea</a>( '&lt;a href=&quot;'.<a class="function" onClick="logFunction('regenerate_url')" href="../../../_functions/regenerate_url.html" onMouseOver="funcPopup(event,'regenerate_url')">regenerate_url</a>('', 'action=edit_settings&amp;amp;plugin_ID='.<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>).'&quot;&gt;'
<a name="l804"><span class="linenum"> 804</span></a>              .sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Edit plugin &amp;laquo;%s&amp;raquo; (ID %d)'), <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('name')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a>, <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> ).'&lt;/a&gt;' );
<a name="l805"><span class="linenum"> 805</span></a>          break;
<a name="l806"><span class="linenum"> 806</span></a>  
<a name="l807"><span class="linenum"> 807</span></a>      case 'disp_help_plain': // just the help, without any payload
<a name="l808"><span class="linenum"> 808</span></a>      case 'disp_help':
<a name="l809"><span class="linenum"> 809</span></a>          if( ! (<a class="var it3642" onMouseOver="hilite(3642)" onMouseOut="lolite()" onClick="logVariable('help_file')" href="../../../_variables/help_file.html">$help_file</a> = <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a class="function" onClick="logFunction('get_help_file')" href="../../../_functions/get_help_file.html" onMouseOver="funcPopup(event,'get_help_file')">get_help_file</a>()) )
<a name="l810"><span class="linenum"> 810</span></a>          {
<a name="l811"><span class="linenum"> 811</span></a>              <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = 'list';
<a name="l812"><span class="linenum"> 812</span></a>              break;
<a name="l813"><span class="linenum"> 813</span></a>          }
<a name="l814"><span class="linenum"> 814</span></a>  
<a name="l815"><span class="linenum"> 815</span></a>          if( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> == 'disp_help_plain' )
<a name="l816"><span class="linenum"> 816</span></a>          { // display it now and exit:
<a name="l817"><span class="linenum"> 817</span></a>              <a class="phpfunction" onClick="logFunction('readfile')" href="../../../_functions/readfile.html" onMouseOver="phpfuncPopup(event,'readfile')">readfile</a>(<a class="var it3642" onMouseOver="hilite(3642)" onMouseOut="lolite()" onClick="logVariable('help_file')" href="../../../_variables/help_file.html">$help_file</a>);
<a name="l818"><span class="linenum"> 818</span></a>              exit(0);
<a name="l819"><span class="linenum"> 819</span></a>          }
<a name="l820"><span class="linenum"> 820</span></a>  
<a name="l821"><span class="linenum"> 821</span></a>          <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> = sprintf( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Help for plugin &amp;laquo;%s&amp;raquo;'), '&lt;a href=&quot;'.<a class="var it230" onMouseOver="hilite(230)" onMouseOut="lolite()" onClick="logVariable('dispatcher')" href="../../../_variables/dispatcher.html">$dispatcher</a>.'?ctrl=plugins&amp;amp;action=edit_settings&amp;amp;plugin_ID='.<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>.'&quot;&gt;'.<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('name')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a>.'&lt;/a&gt;' );
<a name="l822"><span class="linenum"> 822</span></a>          if( ! empty(<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('help_url')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/help_url.html">help_url</a>) )
<a name="l823"><span class="linenum"> 823</span></a>          {
<a name="l824"><span class="linenum"> 824</span></a>              <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> .= ' '.<a class="function" onClick="logFunction('action_icon')" href="../../../_functions/action_icon.html" onMouseOver="funcPopup(event,'action_icon')">action_icon</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('External help page'), 'help', <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('help_url')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/help_url.html">help_url</a> );
<a name="l825"><span class="linenum"> 825</span></a>          }
<a name="l826"><span class="linenum"> 826</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('append_to_titlearea')" href="../../../_functions/append_to_titlearea.html" onMouseOver="funcPopup(event,'append_to_titlearea')">append_to_titlearea</a>( <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../../_variables/title.html">$title</a> );
<a name="l827"><span class="linenum"> 827</span></a>          break;
<a name="l828"><span class="linenum"> 828</span></a>  }
<a name="l829"><span class="linenum"> 829</span></a>  
<a name="l830"><span class="linenum"> 830</span></a>  
<a name="l831"><span class="linenum"> 831</span></a>  <span class="comment">// Display load error from Plugins::register() (if any):</span>
<a name="l832"><span class="linenum"> 832</span></a>  if( isset(<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>) &amp;&amp; <a class="phpfunction" onClick="logFunction('is_object')" href="../../../_functions/is_object.html" onMouseOver="phpfuncPopup(event,'is_object')">is_object</a>(<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>) &amp;&amp; isset( <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a onClick="logVariable('plugin_errors')" class="var it9135" onMouseOver="hilite(9135)" onMouseOut="lolite()" href="../../../_variables/plugin_errors.html">plugin_errors</a>[<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>] )
<a name="l833"><span class="linenum"> 833</span></a>          &amp;&amp; ! empty(<a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a onClick="logVariable('plugin_errors')" class="var it9135" onMouseOver="hilite(9135)" onMouseOut="lolite()" href="../../../_variables/plugin_errors.html">plugin_errors</a>[<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>]['register']) )
<a name="l834"><span class="linenum"> 834</span></a>  {
<a name="l835"><span class="linenum"> 835</span></a>      <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('get_icon')" href="../../../_functions/get_icon.html" onMouseOver="funcPopup(event,'get_icon')">get_icon</a>('warning').' '.<a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a onClick="logVariable('plugin_errors')" class="var it9135" onMouseOver="hilite(9135)" onMouseOut="lolite()" href="../../../_variables/plugin_errors.html">plugin_errors</a>[<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>]['register'], 'error' );
<a name="l836"><span class="linenum"> 836</span></a>  }
<a name="l837"><span class="linenum"> 837</span></a>  
<a name="l838"><span class="linenum"> 838</span></a>  
<a name="l839"><span class="linenum"> 839</span></a>  <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_init')" href="../../../_functions/breadcrumbpath_init.html" onMouseOver="funcPopup(event,'breadcrumbpath_init')">breadcrumbpath_init</a>( false );
<a name="l840"><span class="linenum"> 840</span></a>  <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('System'), '?ctrl=system',
<a name="l841"><span class="linenum"> 841</span></a>          <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Global settings are shared between all blogs; see Blog settings for more granular settings.') );
<a name="l842"><span class="linenum"> 842</span></a>  <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Plugin configuration'), '?ctrl=plugins' );
<a name="l843"><span class="linenum"> 843</span></a>  
<a name="l844"><span class="linenum"> 844</span></a>  <a class="function" onClick="logFunction('init_plugins_js')" href="../../../_functions/init_plugins_js.html" onMouseOver="funcPopup(event,'init_plugins_js')">init_plugins_js</a>( 'rsc_url', <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('get_template')" href="../../../_functions/get_template.html" onMouseOver="funcPopup(event,'get_template')">get_template</a>( 'tooltip_plugin' ) );
<a name="l845"><span class="linenum"> 845</span></a>  
<a name="l846"><span class="linenum"> 846</span></a>  <span class="comment">// Display &lt;html&gt;&lt;head&gt;...&lt;/head&gt; section! (Note: should be done early if actions do not redirect)</span>
<a name="l847"><span class="linenum"> 847</span></a>  <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_html_head')" href="../../../_functions/disp_html_head.html" onMouseOver="funcPopup(event,'disp_html_head')">disp_html_head</a>();
<a name="l848"><span class="linenum"> 848</span></a>  
<a name="l849"><span class="linenum"> 849</span></a>  <span class="comment">// Display title, menu, messages, etc. (Note: messages MUST be displayed AFTER the actions)</span>
<a name="l850"><span class="linenum"> 850</span></a>  <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_body_top')" href="../../../_functions/disp_body_top.html" onMouseOver="funcPopup(event,'disp_body_top')">disp_body_top</a>();
<a name="l851"><span class="linenum"> 851</span></a>  
<a name="l852"><span class="linenum"> 852</span></a>  <span class="comment">// Begin payload block:</span>
<a name="l853"><span class="linenum"> 853</span></a>  <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_payload_begin')" href="../../../_functions/disp_payload_begin.html" onMouseOver="funcPopup(event,'disp_payload_begin')">disp_payload_begin</a>();
<a name="l854"><span class="linenum"> 854</span></a>  
<a name="l855"><span class="linenum"> 855</span></a>  switch( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> )
<a name="l856"><span class="linenum"> 856</span></a>  {
<a name="l857"><span class="linenum"> 857</span></a>      case 'disp_help':
<a name="l858"><span class="linenum"> 858</span></a>  <span class="comment">        // Display plugin help:</span>
<a name="l859"><span class="linenum"> 859</span></a>          <a class="var it3643" onMouseOver="hilite(3643)" onMouseOut="lolite()" onClick="logVariable('help_file_body')" href="../../../_variables/help_file_body.html">$help_file_body</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( '', <a class="phpfunction" onClick="logFunction('file')" href="../../../_functions/file.html" onMouseOver="phpfuncPopup(event,'file')">file</a>(<a class="var it3642" onMouseOver="hilite(3642)" onMouseOut="lolite()" onClick="logVariable('help_file')" href="../../../_variables/help_file.html">$help_file</a>) );
<a name="l860"><span class="linenum"> 860</span></a>  
<a name="l861"><span class="linenum"> 861</span></a>  <span class="comment">        // Try to extract the BODY part:</span>
<a name="l862"><span class="linenum"> 862</span></a>          if( <a class="phpfunction" onClick="logFunction('preg_match')" href="../../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>( '~&lt;body.*?&gt;(.*)&lt;/body&gt;~is', <a class="var it3643" onMouseOver="hilite(3643)" onMouseOut="lolite()" onClick="logVariable('help_file_body')" href="../../../_variables/help_file_body.html">$help_file_body</a>, <a class="var it257" onMouseOver="hilite(257)" onMouseOut="lolite()" onClick="logVariable('match')" href="../../../_variables/match.html">$match</a> ) )
<a name="l863"><span class="linenum"> 863</span></a>          {
<a name="l864"><span class="linenum"> 864</span></a>              <a class="var it3643" onMouseOver="hilite(3643)" onMouseOut="lolite()" onClick="logVariable('help_file_body')" href="../../../_variables/help_file_body.html">$help_file_body</a> = <a class="var it257" onMouseOver="hilite(257)" onMouseOut="lolite()" onClick="logVariable('match')" href="../../../_variables/match.html">$match</a>[1];
<a name="l865"><span class="linenum"> 865</span></a>          }
<a name="l866"><span class="linenum"> 866</span></a>  
<a name="l867"><span class="linenum"> 867</span></a>          echo <a class="var it3643" onMouseOver="hilite(3643)" onMouseOut="lolite()" onClick="logVariable('help_file_body')" href="../../../_variables/help_file_body.html">$help_file_body</a>;
<a name="l868"><span class="linenum"> 868</span></a>          unset(<a class="var it3643" onMouseOver="hilite(3643)" onMouseOut="lolite()" onClick="logVariable('help_file_body')" href="../../../_variables/help_file_body.html">$help_file_body</a>);
<a name="l869"><span class="linenum"> 869</span></a>          break;
<a name="l870"><span class="linenum"> 870</span></a>  
<a name="l871"><span class="linenum"> 871</span></a>  
<a name="l872"><span class="linenum"> 872</span></a>      case 'install_db_schema':
<a name="l873"><span class="linenum"> 873</span></a>  <span class="comment">        // Payload for 'install_db_schema' action if DB layout changes have to be confirmed:</span>
<a name="l874"><span class="linenum"> 874</span></a>          ?&gt;
<a name="l875"><span class="linenum"> 875</span></a>  
<a name="l876"><span class="linenum"> 876</span></a>          &lt;div class=&quot;panelinfo&quot;&gt;
<a name="l877"><span class="linenum"> 877</span></a>  
<a name="l878"><span class="linenum"> 878</span></a>              &lt;?php
<a name="l879"><span class="linenum"> 879</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Form')" href="../../../_classes/form.html" onMouseOver="classPopup(event,'form')">Form</a>( NULL, 'install_db_deltas', 'get' );
<a name="l880"><span class="linenum"> 880</span></a>  
<a name="l881"><span class="linenum"> 881</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('global_icon')" href="../../../_functions/global_icon.html" onMouseOver="funcPopup(event,'global_icon')">global_icon</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Cancel installation!'), 'close', <a class="function" onClick="logFunction('regenerate_url')" href="../../../_functions/regenerate_url.html" onMouseOver="funcPopup(event,'regenerate_url')">regenerate_url</a>() );
<a name="l882"><span class="linenum"> 882</span></a>  
<a name="l883"><span class="linenum"> 883</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('begin_form')" href="../../../_functions/begin_form.html" onMouseOver="funcPopup(event,'begin_form')">begin_form</a>( 'fform', sprintf( <span class="comment">/* TRANS: %d is ID, %d name */</span> <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Finish setup for plugin #%d (%s)'), <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('name')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a> ) );
<a name="l884"><span class="linenum"> 884</span></a>  
<a name="l885"><span class="linenum"> 885</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('add_crumb')" href="../../../_functions/add_crumb.html" onMouseOver="funcPopup(event,'add_crumb')">add_crumb</a>( 'plugin' );
<a name="l886"><span class="linenum"> 886</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('hidden_ctrl')" href="../../../_functions/hidden_ctrl.html" onMouseOver="funcPopup(event,'hidden_ctrl')">hidden_ctrl</a>();
<a name="l887"><span class="linenum"> 887</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('hidden')" href="../../../_functions/hidden.html" onMouseOver="funcPopup(event,'hidden')">hidden</a>( 'action', <a class="var it242" onMouseOver="hilite(242)" onMouseOut="lolite()" onClick="logVariable('next_action')" href="../../../_variables/next_action.html">$next_action</a> );
<a name="l888"><span class="linenum"> 888</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('hidden')" href="../../../_functions/hidden.html" onMouseOver="funcPopup(event,'hidden')">hidden</a>( 'plugin_ID', <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> );
<a name="l889"><span class="linenum"> 889</span></a>  
<a name="l890"><span class="linenum"> 890</span></a>              echo '&lt;p&gt;'.<a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The plugin needs the following database changes.').'&lt;/p&gt;';
<a name="l891"><span class="linenum"> 891</span></a>  
<a name="l892"><span class="linenum"> 892</span></a>              if( ! empty(<a class="var it3644" onMouseOver="hilite(3644)" onMouseOut="lolite()" onClick="logVariable('install_db_deltas')" href="../../../_variables/install_db_deltas.html">$install_db_deltas</a>) )
<a name="l893"><span class="linenum"> 893</span></a>              {
<a name="l894"><span class="linenum"> 894</span></a>                  echo '&lt;p&gt;'.<a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The following database changes will be carried out. If you are not sure what this means, it will probably be alright.').'&lt;/p&gt;';
<a name="l895"><span class="linenum"> 895</span></a>  
<a name="l896"><span class="linenum"> 896</span></a>                  echo '&lt;ul&gt;';
<a name="l897"><span class="linenum"> 897</span></a>                  foreach( <a class="var it3644" onMouseOver="hilite(3644)" onMouseOut="lolite()" onClick="logVariable('install_db_deltas')" href="../../../_variables/install_db_deltas.html">$install_db_deltas</a> as <a class="var it3645" onMouseOver="hilite(3645)" onMouseOut="lolite()" onClick="logVariable('l_delta')" href="../../../_variables/l_delta.html">$l_delta</a> )
<a name="l898"><span class="linenum"> 898</span></a>                  {
<a name="l899"><span class="linenum"> 899</span></a>  <span class="comment">                    #echo '&lt;li&gt;&lt;code&gt;'.nl2br($l_delta).'&lt;/code&gt;&lt;/li&gt;';</span>
<a name="l900"><span class="linenum"> 900</span></a>                      echo '&lt;li&gt;&lt;pre&gt;'.<a class="phpfunction" onClick="logFunction('str_replace')" href="../../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>( &quot;\t&quot;, '  ', <a class="var it3645" onMouseOver="hilite(3645)" onMouseOut="lolite()" onClick="logVariable('l_delta')" href="../../../_variables/l_delta.html">$l_delta</a> ).'&lt;/pre&gt;&lt;/li&gt;';
<a name="l901"><span class="linenum"> 901</span></a>                  }
<a name="l902"><span class="linenum"> 902</span></a>                  echo '&lt;/ul&gt;';
<a name="l903"><span class="linenum"> 903</span></a>  
<a name="l904"><span class="linenum"> 904</span></a>                  <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('hidden')" href="../../../_functions/hidden.html" onMouseOver="funcPopup(event,'hidden')">hidden</a>( 'install_db_deltas_confirm_md5', md5(<a class="phpfunction" onClick="logFunction('implode')" href="../../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( '', <a class="var it3644" onMouseOver="hilite(3644)" onMouseOut="lolite()" onClick="logVariable('install_db_deltas')" href="../../../_variables/install_db_deltas.html">$install_db_deltas</a> )) );
<a name="l905"><span class="linenum"> 905</span></a>              }
<a name="l906"><span class="linenum"> 906</span></a>  
<a name="l907"><span class="linenum"> 907</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('submit')" href="../../../_functions/submit.html" onMouseOver="funcPopup(event,'submit')">submit</a>( array( '', <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Install!'), 'ActionButton' ) );
<a name="l908"><span class="linenum"> 908</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('end_form')" href="../../../_functions/end_form.html" onMouseOver="funcPopup(event,'end_form')">end_form</a>();
<a name="l909"><span class="linenum"> 909</span></a>              ?&gt;
<a name="l910"><span class="linenum"> 910</span></a>  
<a name="l911"><span class="linenum"> 911</span></a>          &lt;/div&gt;
<a name="l912"><span class="linenum"> 912</span></a>  
<a name="l913"><span class="linenum"> 913</span></a>          &lt;?php
<a name="l914"><span class="linenum"> 914</span></a>          break;
<a name="l915"><span class="linenum"> 915</span></a>  
<a name="l916"><span class="linenum"> 916</span></a>  
<a name="l917"><span class="linenum"> 917</span></a>      case 'uninstall': // We come here either if the plugin requested a call to <a class="function" onClick="logFunction('BeforeUninstallPayload')" href="../../../_functions/beforeuninstallpayload.html" onMouseOver="funcPopup(event,'beforeuninstallpayload')">BeforeUninstallPayload</a>() or if there are tables to be dropped {{{
<a name="l918"><span class="linenum"> 918</span></a>          ?&gt;
<a name="l919"><span class="linenum"> 919</span></a>  
<a name="l920"><span class="linenum"> 920</span></a>          &lt;div class=&quot;panelinfo&quot;&gt;
<a name="l921"><span class="linenum"> 921</span></a>  
<a name="l922"><span class="linenum"> 922</span></a>              &lt;?php
<a name="l923"><span class="linenum"> 923</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Form')" href="../../../_classes/form.html" onMouseOver="classPopup(event,'form')">Form</a>( '', 'uninstall_plugin', 'post' );
<a name="l924"><span class="linenum"> 924</span></a>  
<a name="l925"><span class="linenum"> 925</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('global_icon')" href="../../../_functions/global_icon.html" onMouseOver="funcPopup(event,'global_icon')">global_icon</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Cancel uninstall!'), 'close', <a class="function" onClick="logFunction('regenerate_url')" href="../../../_functions/regenerate_url.html" onMouseOver="funcPopup(event,'regenerate_url')">regenerate_url</a>() );
<a name="l926"><span class="linenum"> 926</span></a>  
<a name="l927"><span class="linenum"> 927</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('begin_form')" href="../../../_functions/begin_form.html" onMouseOver="funcPopup(event,'begin_form')">begin_form</a>( 'fform', sprintf( <span class="comment">/* TRANS: %d is ID, %d name */</span> <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Uninstall plugin #%d (%s)'), <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('name')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a> ) );
<a name="l928"><span class="linenum"> 928</span></a>  
<a name="l929"><span class="linenum"> 929</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('add_crumb')" href="../../../_functions/add_crumb.html" onMouseOver="funcPopup(event,'add_crumb')">add_crumb</a>( 'plugin' );
<a name="l930"><span class="linenum"> 930</span></a>  <span class="comment">            // We may need to use memorized params in the next page</span>
<a name="l931"><span class="linenum"> 931</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('hiddens_by_key')" href="../../../_functions/hiddens_by_key.html" onMouseOver="funcPopup(event,'hiddens_by_key')">hiddens_by_key</a>( <a class="function" onClick="logFunction('get_memorized')" href="../../../_functions/get_memorized.html" onMouseOver="funcPopup(event,'get_memorized')">get_memorized</a>( 'action,plugin_ID') );
<a name="l932"><span class="linenum"> 932</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('hidden')" href="../../../_functions/hidden.html" onMouseOver="funcPopup(event,'hidden')">hidden</a>( 'action', 'uninstall' );
<a name="l933"><span class="linenum"> 933</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('hidden')" href="../../../_functions/hidden.html" onMouseOver="funcPopup(event,'hidden')">hidden</a>( 'plugin_ID', <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> );
<a name="l934"><span class="linenum"> 934</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('hidden')" href="../../../_functions/hidden.html" onMouseOver="funcPopup(event,'hidden')">hidden</a>( 'uninstall_confirmed_drop', 1 );
<a name="l935"><span class="linenum"> 935</span></a>  
<a name="l936"><span class="linenum"> 936</span></a>              if( <a class="var it3622" onMouseOver="hilite(3622)" onMouseOut="lolite()" onClick="logVariable('uninstall_tables_to_drop')" href="../../../_variables/uninstall_tables_to_drop.html">$uninstall_tables_to_drop</a> )
<a name="l937"><span class="linenum"> 937</span></a>              {
<a name="l938"><span class="linenum"> 938</span></a>                  echo '&lt;p&gt;'.<a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Uninstalling this plugin will also delete its database tables:').'&lt;/p&gt;'
<a name="l939"><span class="linenum"> 939</span></a>                      .'&lt;ul&gt;'
<a name="l940"><span class="linenum"> 940</span></a>                      .'&lt;li&gt;'
<a name="l941"><span class="linenum"> 941</span></a>                      .<a class="phpfunction" onClick="logFunction('implode')" href="../../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( '&lt;/li&gt;&lt;li&gt;', <a class="var it3622" onMouseOver="hilite(3622)" onMouseOut="lolite()" onClick="logVariable('uninstall_tables_to_drop')" href="../../../_variables/uninstall_tables_to_drop.html">$uninstall_tables_to_drop</a> )
<a name="l942"><span class="linenum"> 942</span></a>                      .'&lt;/li&gt;'
<a name="l943"><span class="linenum"> 943</span></a>                      .'&lt;/ul&gt;';
<a name="l944"><span class="linenum"> 944</span></a>              }
<a name="l945"><span class="linenum"> 945</span></a>  
<a name="l946"><span class="linenum"> 946</span></a>              if( <a class="var it3621" onMouseOver="hilite(3621)" onMouseOut="lolite()" onClick="logVariable('uninstall_ok')" href="../../../_variables/uninstall_ok.html">$uninstall_ok</a> === NULL )
<a name="l947"><span class="linenum"> 947</span></a>              { // Plugin requested this:
<a name="l948"><span class="linenum"> 948</span></a>                  <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('call_method')" href="../../../_functions/call_method.html" onMouseOver="funcPopup(event,'call_method')">call_method</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>, 'BeforeUninstallPayload', <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../../_variables/params.html">$params</a> = array( 'Form' =&gt; &amp; <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a> ) );
<a name="l949"><span class="linenum"> 949</span></a>              }
<a name="l950"><span class="linenum"> 950</span></a>  
<a name="l951"><span class="linenum"> 951</span></a>              echo '&lt;p&gt;'.<a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('THIS CANNOT BE UNDONE!').'&lt;/p&gt;';
<a name="l952"><span class="linenum"> 952</span></a>  
<a name="l953"><span class="linenum"> 953</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('submit')" href="../../../_functions/submit.html" onMouseOver="funcPopup(event,'submit')">submit</a>( array( '', <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('I am sure!'), 'DeleteButton' ) );
<a name="l954"><span class="linenum"> 954</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('end_form')" href="../../../_functions/end_form.html" onMouseOver="funcPopup(event,'end_form')">end_form</a>();
<a name="l955"><span class="linenum"> 955</span></a>              ?&gt;
<a name="l956"><span class="linenum"> 956</span></a>  
<a name="l957"><span class="linenum"> 957</span></a>          &lt;/div&gt;
<a name="l958"><span class="linenum"> 958</span></a>  
<a name="l959"><span class="linenum"> 959</span></a>          &lt;?php // }}}
<a name="l960"><span class="linenum"> 960</span></a>          break;
<a name="l961"><span class="linenum"> 961</span></a>  
<a name="l962"><span class="linenum"> 962</span></a>  
<a name="l963"><span class="linenum"> 963</span></a>      case 'edit_settings':
<a name="l964"><span class="linenum"> 964</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'plugins/views/_plugin_settings.form.php' );
<a name="l965"><span class="linenum"> 965</span></a>          break;
<a name="l966"><span class="linenum"> 966</span></a>  
<a name="l967"><span class="linenum"> 967</span></a>  
<a name="l968"><span class="linenum"> 968</span></a>      case 'info':
<a name="l969"><span class="linenum"> 969</span></a>          if( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('status')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/status.html">status</a> == 'broken' )
<a name="l970"><span class="linenum"> 970</span></a>          {
<a name="l971"><span class="linenum"> 971</span></a>              break;
<a name="l972"><span class="linenum"> 972</span></a>          }
<a name="l973"><span class="linenum"> 973</span></a>  
<a name="l974"><span class="linenum"> 974</span></a>  <span class="comment">        // Display plugin info:</span>
<a name="l975"><span class="linenum"> 975</span></a>          <a class="function" onClick="logFunction('load_funcs')" href="../../../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>('plugins/_plugin.funcs.php');
<a name="l976"><span class="linenum"> 976</span></a>  
<a name="l977"><span class="linenum"> 977</span></a>          <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Form')" href="../../../_classes/form.html" onMouseOver="classPopup(event,'form')">Form</a>( <a class="var it976" onMouseOver="hilite(976)" onMouseOut="lolite()" onClick="logVariable('pagenow')" href="../../../_variables/pagenow.html">$pagenow</a> );
<a name="l978"><span class="linenum"> 978</span></a>  
<a name="l979"><span class="linenum"> 979</span></a>          if( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> &gt; 0 &amp;&amp; <a class="var it11" onMouseOver="hilite(11)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'options', 'edit', false ) )
<a name="l980"><span class="linenum"> 980</span></a>          { // Edit settings <a class="function" onClick="logFunction('button')" href="../../../_functions/button.html" onMouseOver="funcPopup(event,'button')">button</a> (if installed):
<a name="l981"><span class="linenum"> 981</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('global_icon')" href="../../../_functions/global_icon.html" onMouseOver="funcPopup(event,'global_icon')">global_icon</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Edit plugin settings!'), 'edit', <a class="var it346" onMouseOver="hilite(346)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../../_variables/admin_url.html">$admin_url</a>.'?ctrl=plugins&amp;amp;action=edit_settings&amp;amp;plugin_ID='.<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> );
<a name="l982"><span class="linenum"> 982</span></a>          }
<a name="l983"><span class="linenum"> 983</span></a>  
<a name="l984"><span class="linenum"> 984</span></a>  <span class="comment">        // Close button:</span>
<a name="l985"><span class="linenum"> 985</span></a>          <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('global_icon')" href="../../../_functions/global_icon.html" onMouseOver="funcPopup(event,'global_icon')">global_icon</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Close info!'), 'close', <a class="function" onClick="logFunction('regenerate_url')" href="../../../_functions/regenerate_url.html" onMouseOver="funcPopup(event,'regenerate_url')">regenerate_url</a>() );
<a name="l986"><span class="linenum"> 986</span></a>  
<a name="l987"><span class="linenum"> 987</span></a>          <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('begin_form')" href="../../../_functions/begin_form.html" onMouseOver="funcPopup(event,'begin_form')">begin_form</a>( 'fform', '&amp;nbsp;' );
<a name="l988"><span class="linenum"> 988</span></a>          <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('hidden')" href="../../../_functions/hidden.html" onMouseOver="funcPopup(event,'hidden')">hidden</a>( 'ctrl', 'plugins' );
<a name="l989"><span class="linenum"> 989</span></a>          <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('begin_fieldset')" href="../../../_functions/begin_fieldset.html" onMouseOver="funcPopup(event,'begin_fieldset')">begin_fieldset</a>('Plugin info', array('class' =&gt; 'fieldset'));
<a name="l990"><span class="linenum"> 990</span></a>          <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('info_field')" href="../../../_functions/info_field.html" onMouseOver="funcPopup(event,'info_field')">info_field</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Name'), <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('name')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/name.html">name</a> );
<a name="l991"><span class="linenum"> 991</span></a>          <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('info_field')" href="../../../_functions/info_field.html" onMouseOver="funcPopup(event,'info_field')">info_field</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Code'),
<a name="l992"><span class="linenum"> 992</span></a>                  ( empty(<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('code')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/code.html">code</a>) ? ' - ' : <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('code')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/code.html">code</a> ),
<a name="l993"><span class="linenum"> 993</span></a>                  array( 'note' =&gt; <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('This 32 character code uniquely identifies the functionality of this plugin. It is only necessary to call the plugin by code (SkinTag) or when using it as a Renderer.') ) );
<a name="l994"><span class="linenum"> 994</span></a>          <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('info_field')" href="../../../_functions/info_field.html" onMouseOver="funcPopup(event,'info_field')">info_field</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Short desc'), <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('short_desc')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/short_desc.html">short_desc</a> );
<a name="l995"><span class="linenum"> 995</span></a>          <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('info_field')" href="../../../_functions/info_field.html" onMouseOver="funcPopup(event,'info_field')">info_field</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Long desc'), <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('long_desc')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/long_desc.html">long_desc</a> );
<a name="l996"><span class="linenum"> 996</span></a>          if( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> &gt; 0 )
<a name="l997"><span class="linenum"> 997</span></a>          { // do not display ID for non registered Plugins
<a name="l998"><span class="linenum"> 998</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('info_field')" href="../../../_functions/info_field.html" onMouseOver="funcPopup(event,'info_field')">info_field</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('ID'), <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> );
<a name="l999"><span class="linenum"> 999</span></a>          }
<a name="l1000"><span class="linenum">1000</span></a>          <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('info_field')" href="../../../_functions/info_field.html" onMouseOver="funcPopup(event,'info_field')">info_field</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Version'), <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('version')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/version.html">version</a> );
<a name="l1001"><span class="linenum">1001</span></a>          <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('info_field')" href="../../../_functions/info_field.html" onMouseOver="funcPopup(event,'info_field')">info_field</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Classname'), <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('classname')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a> );
<a name="l1002"><span class="linenum">1002</span></a>          <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('info_field')" href="../../../_functions/info_field.html" onMouseOver="funcPopup(event,'info_field')">info_field</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('<span class="keyword">Class </span><a class="class" onClick="logClass('file')" href="../../../_classes/file.html" onMouseOver="classPopup(event,'file')">file</a>'), <a class="function" onClick="logFunction('rel_path_to_base')" href="../../../_functions/rel_path_to_base.html" onMouseOver="funcPopup(event,'rel_path_to_base')">rel_path_to_base</a>(<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('classfile_path')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/classfile_path.html">classfile_path</a> ) );
<a name="l1003"><span class="linenum">1003</span></a>  
<a name="l1004"><span class="linenum">1004</span></a>  <span class="comment">        // Help icons (to homepage and README.html), if available:</span>
<a name="l1005"><span class="linenum">1005</span></a>          <a class="var it3646" onMouseOver="hilite(3646)" onMouseOut="lolite()" onClick="logVariable('help_icons')" href="../../../_variables/help_icons.html">$help_icons</a> = array();
<a name="l1006"><span class="linenum">1006</span></a>          if( <a class="var it3647" onMouseOver="hilite(3647)" onMouseOut="lolite()" onClick="logVariable('help_www')" href="../../../_variables/help_www.html">$help_www</a> = <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a class="function" onClick="logFunction('get_help_link')" href="../../../_functions/get_help_link.html" onMouseOver="funcPopup(event,'get_help_link')">get_help_link</a>('<a class="var it251" onMouseOver="hilite(251)" onMouseOut="lolite()" onClick="logVariable('help_url')" href="../../../_variables/help_url.html">$help_url</a>') )
<a name="l1007"><span class="linenum">1007</span></a>          {
<a name="l1008"><span class="linenum">1008</span></a>              <a class="var it3646" onMouseOver="hilite(3646)" onMouseOut="lolite()" onClick="logVariable('help_icons')" href="../../../_variables/help_icons.html">$help_icons</a>[] = <a class="var it3647" onMouseOver="hilite(3647)" onMouseOut="lolite()" onClick="logVariable('help_www')" href="../../../_variables/help_www.html">$help_www</a>;
<a name="l1009"><span class="linenum">1009</span></a>          }
<a name="l1010"><span class="linenum">1010</span></a>          if( ! empty(<a class="var it3646" onMouseOver="hilite(3646)" onMouseOut="lolite()" onClick="logVariable('help_icons')" href="../../../_variables/help_icons.html">$help_icons</a>) )
<a name="l1011"><span class="linenum">1011</span></a>          {
<a name="l1012"><span class="linenum">1012</span></a>              <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('info_field')" href="../../../_functions/info_field.html" onMouseOver="funcPopup(event,'info_field')">info_field</a>( <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Help'), <a class="phpfunction" onClick="logFunction('implode')" href="../../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( ' ', <a class="var it3646" onMouseOver="hilite(3646)" onMouseOut="lolite()" onClick="logVariable('help_icons')" href="../../../_variables/help_icons.html">$help_icons</a> ) );
<a name="l1013"><span class="linenum">1013</span></a>          }
<a name="l1014"><span class="linenum">1014</span></a>  
<a name="l1015"><span class="linenum">1015</span></a>          <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('end_fieldset')" href="../../../_functions/end_fieldset.html" onMouseOver="funcPopup(event,'end_fieldset')">end_fieldset</a>();
<a name="l1016"><span class="linenum">1016</span></a>  
<a name="l1017"><span class="linenum">1017</span></a>          if( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('ID')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> &lt; 1 )
<a name="l1018"><span class="linenum">1018</span></a>          { // add &quot;Install NOW&quot; submit <a class="function" onClick="logFunction('button')" href="../../../_functions/button.html" onMouseOver="funcPopup(event,'button')">button</a> (if not already installed)
<a name="l1019"><span class="linenum">1019</span></a>              <a class="var it3648" onMouseOver="hilite(3648)" onMouseOut="lolite()" onClick="logVariable('registrations')" href="../../../_variables/registrations.html">$registrations</a> = <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('count_regs')" href="../../../_functions/count_regs.html" onMouseOver="funcPopup(event,'count_regs')">count_regs</a>(<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('classname')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a>);
<a name="l1020"><span class="linenum">1020</span></a>  
<a name="l1021"><span class="linenum">1021</span></a>              if( ! isset( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('number_of_installs')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/number_of_installs.html">number_of_installs</a> )
<a name="l1022"><span class="linenum">1022</span></a>                      || ( <a class="var it1968" onMouseOver="hilite(1968)" onMouseOut="lolite()" onClick="logVariable('admin_Plugins')" href="../../../_variables/admin_Plugins.html">$admin_Plugins</a>-&gt;<a class="function" onClick="logFunction('count_regs')" href="../../../_functions/count_regs.html" onMouseOver="funcPopup(event,'count_regs')">count_regs</a>(<a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('classname')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a>) &lt; <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('number_of_installs')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/number_of_installs.html">number_of_installs</a> ) )
<a name="l1023"><span class="linenum">1023</span></a>              { // number of installations are not limited or not reached yet
<a name="l1024"><span class="linenum">1024</span></a>                  <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('add_crumb')" href="../../../_functions/add_crumb.html" onMouseOver="funcPopup(event,'add_crumb')">add_crumb</a>('plugin');
<a name="l1025"><span class="linenum">1025</span></a>                  <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('hidden')" href="../../../_functions/hidden.html" onMouseOver="funcPopup(event,'hidden')">hidden</a>( 'action', 'install' );
<a name="l1026"><span class="linenum">1026</span></a>                  <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('hidden')" href="../../../_functions/hidden.html" onMouseOver="funcPopup(event,'hidden')">hidden</a>( 'plugin', <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a onClick="logVariable('classname')" class="var it9136" onMouseOver="hilite(9136)" onMouseOut="lolite()" href="../../../_variables/classname.html">classname</a> );
<a name="l1027"><span class="linenum">1027</span></a>  
<a name="l1028"><span class="linenum">1028</span></a>                  <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('begin_fieldset')" href="../../../_functions/begin_fieldset.html" onMouseOver="funcPopup(event,'begin_fieldset')">begin_fieldset</a>( '', array( 'class'=&gt;'fieldset center' ) );
<a name="l1029"><span class="linenum">1029</span></a>                  <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('submit')" href="../../../_functions/submit.html" onMouseOver="funcPopup(event,'submit')">submit</a>( array( '', <a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Install NOW!'), 'ActionButton' ) );
<a name="l1030"><span class="linenum">1030</span></a>                  <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('end_fieldset')" href="../../../_functions/end_fieldset.html" onMouseOver="funcPopup(event,'end_fieldset')">end_fieldset</a>();
<a name="l1031"><span class="linenum">1031</span></a>              }
<a name="l1032"><span class="linenum">1032</span></a>          }
<a name="l1033"><span class="linenum">1033</span></a>  
<a name="l1034"><span class="linenum">1034</span></a>          <a class="var it131" onMouseOver="hilite(131)" onMouseOut="lolite()" onClick="logVariable('Form')" href="../../../_variables/Form.html">$Form</a>-&gt;<a class="function" onClick="logFunction('end_form')" href="../../../_functions/end_form.html" onMouseOver="funcPopup(event,'end_form')">end_form</a>();
<a name="l1035"><span class="linenum">1035</span></a>          <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> = '';
<a name="l1036"><span class="linenum">1036</span></a>          break;
<a name="l1037"><span class="linenum">1037</span></a>  
<a name="l1038"><span class="linenum">1038</span></a>  }
<a name="l1039"><span class="linenum">1039</span></a>  
<a name="l1040"><span class="linenum">1040</span></a>  switch( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a> )
<a name="l1041"><span class="linenum">1041</span></a>  {
<a name="l1042"><span class="linenum">1042</span></a>      case 'list':
<a name="l1043"><span class="linenum">1043</span></a>  <span class="comment">        // Display VIEW:</span>
<a name="l1044"><span class="linenum">1044</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'plugins/views/_plugin_list.view.php' );
<a name="l1045"><span class="linenum">1045</span></a>          break;
<a name="l1046"><span class="linenum">1046</span></a>  
<a name="l1047"><span class="linenum">1047</span></a>      case 'list_available':
<a name="l1048"><span class="linenum">1048</span></a>  <span class="comment">        // Display VIEW:</span>
<a name="l1049"><span class="linenum">1049</span></a>          <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'plugins/views/_plugin_list_available.view.php' );
<a name="l1050"><span class="linenum">1050</span></a>          break;
<a name="l1051"><span class="linenum">1051</span></a>  }
<a name="l1052"><span class="linenum">1052</span></a>  
<a name="l1053"><span class="linenum">1053</span></a>  <span class="comment">// End payload block:</span>
<a name="l1054"><span class="linenum">1054</span></a>  <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_payload_end')" href="../../../_functions/disp_payload_end.html" onMouseOver="funcPopup(event,'disp_payload_end')">disp_payload_end</a>();
<a name="l1055"><span class="linenum">1055</span></a>  
<a name="l1056"><span class="linenum">1056</span></a>  <span class="comment">// Display body bottom, debug info and close &lt;/html&gt;:</span>
<a name="l1057"><span class="linenum">1057</span></a>  <a class="var it223" onMouseOver="hilite(223)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_global_footer')" href="../../../_functions/disp_global_footer.html" onMouseOver="funcPopup(event,'disp_global_footer')">disp_global_footer</a>();
<a name="l1058"><span class="linenum">1058</span></a>  
<a name="l1059"><span class="linenum">1059</span></a>  ?&gt;
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'get_registered_events': ['get_registered_events', 'Discover plugin events from its source file. ', [['blogs/inc/plugins/model','_plugins_admin.class.php',430]], 6],
'load_funcs': ['load_funcs', '', [['blogs/inc/_core','_misc.funcs.php',115]], 214],
'set_plugin_status': ['set_plugin_status', 'Sets the status of a Plugin in DB and registers it into the internal indices when "enabled". Otherwise it gets unregistered, but only when we\'re not in {@link Plugins_admin}, because we want to keep it in then in our indices. ', [['blogs/inc/plugins/model','_plugins.class.php',252]], 11],
'get_template': ['get_template', 'Those templates are used for example by the messaging screens. ', [['blogs/skins/bootstrap','_skin.class.php',123],['blogs/skins_adm/evo','_adminUI.class.php',144],['blogs/skins_adm','_adminUI_general.class.php',855],['blogs/skins_adm/chicago','_adminUI.class.php',167],['blogs/inc/skins/model','_skin.class.php',721],['blogs/skins_adm/bootstrap','_adminUI.class.php',181],['blogs/skins/pureforums','_skin.class.php',360],['blogs/inc/_core/ui','_menu.class.php',408]], 63],
'regenerate_url': ['regenerate_url', 'Regenerate current URL from parameters This may clean it up But it is also useful when generating static pages: you cannot rely on $_REQUEST[] ', [['blogs/inc/_core','_param.funcs.php',1743]], 456],
'unregister': ['unregister', 'Un-register a plugin, only if forced. ', [['blogs/inc/plugins/model','_plugins_admin.class.php',285],['blogs/inc/plugins/model','_plugins.class.php',595]], 6],
'breadcrumbpath_init': ['breadcrumbpath_init', 'Note: These are not real breadcrumbs. It\'s just "so to speak" for a hierarchical path. ', [['blogs/skins_adm','_adminUI_general.class.php',173]], 55],
'set_code': ['set_code', 'Set the code for a given Plugin ID. ', [['blogs/inc/plugins/model','_plugins_admin.class.php',908]], 3],
'restore_defaults': ['restore_defaults', 'Delete values for {@link $_defaults default settings} in DB. ', [['blogs/inc/settings/model','_abstractsettings.class.php',577]], 1],
'query': ['query', 'Run Query: GET DATA ROWS *** HEAVY *** ', [['blogs/inc/items/model','_itemlist.class.php',256],['blogs/inc/items/model','_itemlistlight.class.php',751],['blogs/inc/_core/model/db','_db.class.php',761],['blogs/inc/users/model','_userlist.class.php',474],['blogs/inc/_core/ui/results','_results.class.php',439],['blogs/inc/comments/model','_commentlist.class.php',515]], 972],
'get_sql_table': ['get_sql_table', 'Get canonical name for database tables a plugin uses, by adding an unique prefix for your plugin instance. ', [['blogs/inc/plugins','_plugin.class.php',2868]], 15],
'validate_dependencies': ['validate_dependencies', 'Validate dependencies of a Plugin. ', [['blogs/inc/plugins/model','_plugins_admin.class.php',1163]], 3],
'add_crumb': ['add_crumb', 'Add a crumb to the current form ', [['blogs/inc/_core/ui/forms','_form.class.php',2705]], 142],
'quote': ['quote', 'Quote a msgid/msgstr, preferrable with single quotes. ', [['blogs/inc/locales','_pofile.class.php',267],['blogs/inc/_core/model/db','_db.class.php',503]], 791],
'disp_global_footer': ['disp_global_footer', 'Display body bottom, debug info and close </html> ', [['blogs/skins_adm','_adminUI_general.class.php',577]], 58],
'button': ['button', 'Builds a button. ', [['blogs/inc/_core/ui/forms','_form.class.php',2592]], 29],
'disp_html_head': ['disp_html_head', 'Display doctype + <head>...</head> section ', [['blogs/skins_adm','_adminUI_general.class.php',492]], 58],
'init_plugins_js': ['init_plugins_js', 'Registers headlines required to display a bubbletip to the right of plugin help icon. ', [['blogs/inc/_core','_template.funcs.php',1274]], 6],
'get_edit_settings_url': ['get_edit_settings_url', 'Get an URL to edit the Plugin\'s settings (if the user has permission). ', [['blogs/inc/plugins','_plugin.class.php',3140]], 3],
'set_priority': ['set_priority', 'Set the priority for a given Plugin ID. ', [['blogs/inc/plugins/model','_plugins_admin.class.php',1012]], 2],
'check_perm': ['check_perm', 'Check permission on a message ', [['blogs/inc/messaging/model','_message.class.php',467],['blogs/inc/users/model','_group.class.php',257],['blogs/inc/users/model','_user.class.php',2022],['blogs/inc/links/model','_linkuser.class.php',51],['blogs/inc/links/model','_linkitem.class.php',54],['blogs/inc/_core/model','_module.class.php',233],['blogs/inc/messaging/model','_thread.class.php',476],['blogs/inc/links/model','_linkcomment.class.php',53],['blogs/inc/sessions/model','_goal.class.php',92]], 967],
'beforeenable': ['beforeenable', 'Check ping service URL and plugin code. ', [['blogs/plugins','_generic_ping.plugin.php',121],['blogs/plugins/twitter_plugin','_twitter.plugin.php',104],['blogs/plugins/watermark_plugin','_watermark.plugin.php',149],['blogs/plugins','_captcha_qstn.plugin.php',129],['blogs/inc/plugins','_plugin.class.php',1022],['blogs/plugins/geoip_plugin','_geoip.plugin.php',127],['blogs/plugins/basic_antispam_plugin','_basic_antispam.plugin.php',149]], 5],
'set_path': ['set_path', 'Set the full selected path. ', [['blogs/skins_adm','_adminUI_general.class.php',1350]], 77],
'uninstall': ['uninstall', '', [['blogs/inc/plugins/model','_plugins_admin.class.php',651]], 1],
'has_errors': ['has_errors', 'Has error message in current object ', [['blogs/inc/_core/model','_messages.class.php',313]], 47],
'restart': ['restart', 'Reset the iterator ', [['blogs/inc/files/model','_filelist.class.php',709],['blogs/inc/_core/ui/results','_results.class.php',397],['blogs/plugins','_archives.plugin.php',582],['blogs/inc/plugins/model','_plugins.class.php',769]], 27],
'breadcrumbpath_add': ['breadcrumbpath_add', 'Note: These are not real breadcrumbs. It\'s just "so to speak" for a hierarchical path. ', [['blogs/skins_adm','_adminUI_general.class.php',212]], 234],
'set': ['set', 'Set param value ', [['blogs/inc/users/model','_userfield.class.php',243],['blogs/inc/generic/model','_genericordered.class.php',75],['blogs/inc/users/model','_group.class.php',204],['blogs/inc/items/model','_itemlight.class.php',1258],['blogs/inc/plugins/model','_pluginsettings.class.php',70],['blogs/inc/widgets/model','_widget.class.php',321],['blogs/inc/regional/model','_region.class.php',102],['blogs/inc/regional/model','_city.class.php',110],['blogs/inc/collections/model','_blog.class.php',1102],['blogs/inc/settings/model','_abstractsettings.class.php',446],['blogs/inc/plugins/model','_pluginusersettings.class.php',82],['blogs/inc/users/model','_user.class.php',1861],['blogs/inc/generic/model','_genericcategory.class.php',100],['blogs/inc/tools/model','_emailaddress.class.php',85],['blogs/inc/users/model','_usersettings.class.php',187],['blogs/inc/regional/model','_country.class.php',106],['blogs/inc/comments/model','_comment.class.php',315],['blogs/inc/users/model','_groupsettings.class.php',140],['blogs/inc/cron/model','_cronjob.class.php',79],['blogs/inc/items/model','_item.class.php',4497],['blogs/inc/files/model','_filetype.class.php',149],['blogs/inc/users/model','_userfieldgroup.class.php',92],['blogs/inc/sessions/model','_session.class.php',420],['blogs/plugins','_calendar.plugin.php',530],['blogs/inc/slugs/model','_slug.class.php',80],['blogs/inc/regional/model','_currency.class.php',96],['blogs/inc/messaging/model','_thread.class.php',185],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',614],['blogs/inc/regional/model','_subregion.class.php',119],['blogs/inc/antispam/model','_iprange.class.php',81],['blogs/inc/sessions/model','_goal.class.php',199]], 1121],
'hidden_ctrl': ['hidden_ctrl', 'Add the "ctrl" param, used in the backoffice, as a hidden field. ', [['blogs/inc/_core/ui/forms','_form.class.php',2722]], 62],
'get_help_file': ['get_help_file', 'Get the help file for a Plugin ID. README.LOCALE.html will take precedence above the general (english) README.html. ', [['blogs/inc/plugins','_plugin.class.php',3081]], 1],
'get_memorized': ['get_memorized', 'Construct an array of memorized params which are not in the ignore list ', [['blogs/inc/_core','_param.funcs.php',1705]], 66],
'info_field': ['info_field', 'Builds an info field. An info field is a fieldset containing a label div and an info div. ', [['blogs/inc/_core/ui/forms','_form.class.php',2357]], 70],
'disp_payload_begin': ['disp_payload_begin', 'Display the start of a payload block ', [['blogs/skins_adm','_adminUI_general.class.php',600],['blogs/skins_adm/bootstrap','_adminUI.class.php',552]], 91],
'get_help_link': ['get_help_link', 'Get a link to a help page (with icon). ', [['blogs/inc/plugins','_plugin.class.php',3004]], 10],
'submit': ['submit', 'Builds a submit input tag ', [['blogs/inc/_core/ui/forms','_form.class.php',2832]], 46],
'hidden': ['hidden', 'Builds an hidden input tag, overwriting any previous hidden values (except for "foo[]"). ', [['blogs/inc/_core/ui/forms','_form.class.php',2657]], 600],
'header_redirect': ['header_redirect', 'Sends HTTP header to redirect to the previous location (which can be given as function parameter, GET parameter (redirect_to), is taken from {@link Hit::$referer} or {@link $baseurl}). ', [['blogs/inc/_core','_template.funcs.php',110]], 373],
't_': ['t_', 'TRANSLATE! ', [['blogs/inc/locales','_locale.funcs.php',48],['blogs/inc/locales','_locale.funcs.php',240],['blogs/inc/skins/model','_skin.class.php',672],['blogs/inc/_core/model','_module.class.php',79],['blogs/rsc/js','blog_widgets.js',422],['blogs/inc/plugins','_plugin.class.php',2617]], 10201],
'invalidate_pagecaches': ['invalidate_pagecaches', 'Invalidate all page caches. This function should be processed every time, when some users or global settings was modified, and this modification has an imortant influence for the front office display. Modifications that requires to invalidate all page caches: - installing/removing/reloading/enabling/disabling plugins - editing user settings like allow profile pics, new users can register, user settings>display ', [['blogs/inc/_core','_misc.funcs.php',5463]], 10],
'reload_plugins': ['reload_plugins', 'Reload all plugins to detect changes - Register new events - Unregister obsolete events - Detect plugins with no code and try to have at least one plugin with the default code ', [['blogs/inc/plugins/model','_plugins_admin.class.php',858]], 2],
'call_method': ['call_method', 'Call a method on a Plugin. ', [['blogs/inc/plugins/model','_plugins.class.php',1172]], 24],
'disp_view': ['disp_view', 'Display a view ', [['blogs/skins_adm','_adminUI_general.class.php',681]], 209],
'get_icon': ['get_icon', 'Get properties of an icon. ', [['blogs/inc/_core','_misc.funcs.php',3989],['blogs/inc/files/model','_filetype.class.php',174],['blogs/inc/files/model','_file.class.php',955]], 313],
'install_plugin_db_schema_action': ['install_plugin_db_schema_action', 'Helper function to do the action part of DB schema upgrades for "enable" and "install" actions. ', [['blogs/inc/plugins','_plugin.funcs.php',1063]], 3],
'install': ['install', 'Install current skin to DB ', [['blogs/inc/skins/model','_skin.class.php',95]], 3],
'count_regs': ['count_regs', 'Count # of registrations of same plugin. ', [['blogs/inc/plugins/model','_plugins_admin.class.php',305],['blogs/inc/plugins/model','_plugins.class.php',2103]], 6],
'action_icon': ['action_icon', 'Create IMG tag for an action icon. ', [['blogs/inc/_core','_misc.funcs.php',3844],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',811]], 235],
'param_error': ['param_error', 'Add an error for a variable, either to the Form\'s field and/or the global {@link $Messages} object. ', [['blogs/inc/_core','_param.funcs.php',1519]], 132],
'assert_received_crumb': ['assert_received_crumb', 'Assert that we received a valid crumb for the object we want to act on. ', [['blogs/inc/sessions/model','_session.class.php',582]], 256],
'disp_payload_end': ['disp_payload_end', 'Display the end of a payload block ', [['blogs/skins_adm','_adminUI_general.class.php',651]], 91],
'autoform_set_param_from_request': ['autoform_set_param_from_request', 'Set Plugin settings from params. ', [['blogs/inc/plugins','_plugin.funcs.php',638]], 5],
'_set_setting_by_path': ['_set_setting_by_path', '', [['blogs/inc/plugins','_plugin.funcs.php',466]], 5],
'get_col': ['get_col', 'Function to get 1 column from the cached result set based on X index see docs for usage and info ', [['blogs/inc/_core/model/db','_db.class.php',1041]], 88],
'rel_path_to_base': ['rel_path_to_base', 'Return the path without the leading {@link $basepath}, or if not below {@link $basepath}, just the basename of it. ', [['blogs/inc/files/model','_file.funcs.php',722]], 26],
'param_action': ['param_action', 'Get the action from params. ', [['blogs/inc/_core','_param.funcs.php',478]], 54],
'save_events': ['save_events', 'Save the events that the plugin provides into DB, while removing obsolete entries (that the plugin does not register anymore). ', [['blogs/inc/plugins/model','_plugins_admin.class.php',731]], 5],
'plugin': ['plugin', 'Constructor. ', [['blogs/inc/plugins','_plugin.class.php',286]], 32],
'begin_fieldset': ['begin_fieldset', 'Builds a fieldset tag. This is a "fieldset" element by default, but a "th" element for table layout. ', [['blogs/inc/_core/ui/forms','_form.class.php',586]], 273],
'global_icon': ['global_icon', 'Registers a global action icon ', [['blogs/inc/_core/ui','_uiwidget.class.php',89]], 152],
'beforeuninstallpayload': ['beforeuninstallpayload', 'Event handler: Gets invoked to display the payload before uninstalling the plugin. ', [['blogs/inc/plugins','_plugin.class.php',1005]], 1],
'end_fieldset': ['end_fieldset', 'Ends a fieldset. ', [['blogs/inc/_core/ui/forms','_form.class.php',650]], 273],
'end_form': ['end_form', 'Ends the form, optionally displays buttons and closes all open fieldsets. ', [['blogs/inc/_core/ui/forms','_form.class.php',1617]], 184],
'dbupdate': ['dbupdate', 'Update the DB based on previously recorded changes ', [['blogs/inc/chapters/model','_chapter.class.php',317],['blogs/inc/collections/model','_collsettings.class.php',260],['blogs/inc/users/model','_group.class.php',470],['blogs/inc/widgets/model','_widget.class.php',757],['blogs/inc/collections/model','_blog.class.php',2327],['blogs/inc/settings/model','_abstractsettings.class.php',593],['blogs/inc/users/model','_user.class.php',2934],['blogs/inc/skins/model','_skin.class.php',348],['blogs/inc/comments/model','_comment.class.php',3470],['blogs/inc/users/model','_groupsettings.class.php',159],['blogs/inc/cron/model','_cronjob.class.php',207],['blogs/inc/items/model','_item.class.php',4867],['blogs/inc/slugs/model','_slug.class.php',265],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',129],['blogs/inc/files/model','_file.class.php',1739]], 266],
'table': ['table', 'Constructor ', [['blogs/inc/_core/ui','_uiwidget.class.php',302]], 16],
'register': ['register', '', [['blogs/plugins/tinymce_plugin/tiny_mce','tiny_mce_src.js',15015]], 16],
'param_check_range': ['param_check_range', 'Checks if the param is a decimal number (no float, e.g. 3.14) in a given range. ', [['blogs/inc/_core','_param.funcs.php',701]], 4],
'begin_form': ['begin_form', 'Builds the form field ', [['blogs/inc/_core/ui/forms','_form.class.php',1499]], 172],
'param_request': ['param_request', 'Get a param from Request and save it to Settings, or default to previously saved user setting. ', [['blogs/inc/settings/model','_abstractsettings.class.php',734],['blogs/inc/users/model','_usersettings.class.php',236]], 13],
'append_to_titlearea': ['append_to_titlearea', 'Append a string at the end of the existing titlearea. ', [['blogs/skins_adm','_adminUI_general.class.php',372]], 7],
'add': ['add', 'Add object to cache, handling our own indices. ', [['blogs/inc/collections/model','_blogcache.class.php',69],['blogs/inc/users/model','_usercache.class.php',231],['blogs/inc/files/model','_filelist.class.php',392],['blogs/inc/_core/model','_log.class.php',124],['blogs/inc/_core/model','_log.class.php',593],['blogs/inc/files/model','_filetypecache.class.php',57],['blogs/inc/_ext/pclzip','pclzip.lib.php',455],['blogs/inc/_core/model/dataobjects','_dataobjectcache.class.php',356],['blogs/inc/users/model','_groupsettings.class.php',103],['blogs/inc/links/model','_linkcache.class.php',101],['blogs/inc/skins/model','_skincache.class.php',62],['blogs/inc/generic/model','_genericcategorycache.class.php',113],['blogs/inc/_core/model','_messages.class.php',121]], 2022],
'getdefaultsettings': ['getdefaultsettings', 'Get the settings that the plugin can use. ', [['blogs/plugins','_generic_ping.plugin.php',76],['blogs/plugins','_autolinks.plugin.php',81],['blogs/plugins','_google_maps.plugin.php',70],['blogs/plugins','_auto_p.plugin.php',63],['blogs/plugins/adsense_plugin','_adsense.plugin.php',44],['blogs/plugins/watermark_plugin','_watermark.plugin.php',45],['blogs/plugins','_captcha_qstn.plugin.php',59],['blogs/plugins/tinymce_plugin','_tinymce.plugin.php',57],['blogs/plugins','_smilies.plugin.php',68],['blogs/plugins/test_plugin','_test.plugin.php',85],['blogs/plugins/code_highlight_plugin','_code_highlight.plugin.php',131],['blogs/inc/plugins','_plugin.class.php',341],['blogs/plugins/geoip_plugin','_geoip.plugin.php',91],['blogs/plugins','skeleton.plugin.php',67],['blogs/plugins/basic_antispam_plugin','_basic_antispam.plugin.php',69]], 3],
'disp_body_top': ['disp_body_top', 'Dsiplay the top of the HTML <body>... ', [['blogs/skins_adm','_adminUI_general.class.php',515]], 58],
'param': ['param', 'Sets a parameter with values from the request or to provided default, except if param is already set! ', [['blogs/inc/_core','_param.funcs.php',50]], 1906],
'has_event': ['has_event', 'Has a plugin a specific event registered and enabled? ', [['blogs/inc/plugins/model','_plugins.class.php',1706]], 4],
'hiddens_by_key': ['hiddens_by_key', 'Builds a list of hidden inputs from an array where the keys are the field names. ', [['blogs/inc/_core/ui/forms','_form.class.php',2756]], 49],
'file': ['file', '', [], 70],
'preg_match': ['preg_match', '', [], 363],
'is_object': ['is_object', '', [], 57],
'str_replace': ['str_replace', '', [], 403],
'reset': ['reset', '', [], 55],
'in_array': ['in_array', '', [], 335],
'implode': ['implode', '', [], 456],
'is_string': ['is_string', '', [], 58],
'is_a': ['is_a', '', [], 42],
'defined': ['defined', '', [], 874],
'readfile': ['readfile', '', [], 9]};
CLASS_DATA={
'file': ['file', 'Represents a file or folder on disk. Optionnaly stores meta data from DB. ', [['blogs/inc/files/model','_file.class.php',44]], 78],
'form': ['form', 'Form class ', [['blogs/inc/_core/ui/forms','_form.class.php',53]], 181]};
CONST_DATA={
'EVO_MAIN_INIT': ['EVO_MAIN_INIT', '', [['blogs/inc','_main.inc.php',55],['blogs/install','index.php',25],['blogs/install','debug.php',22]], 827]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Sat Jul  5 12:18:44 2014</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>

<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /blogs/install/_functions_install.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Sat Jul  5 12:18:44 2014 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='blogs/install';
filename='_functions_install.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/blogs/install/</a> -> <a href="_functions_install.php.html">_functions_install.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="_functions_install.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="_functions_install.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">/**</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment"> * This file implements support functions for the installer</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment"> *</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment"> * b2evolution - {@link http://b2evolution.net/}</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment"> * Released under GNU GPL License - {@link http://b2evolution.net/about/license.html}</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment"> * @copyright (c)2003-2014 by Francois Planque - {@link http://fplanque.com/}</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment"> *</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment"> * @package install</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment"> */</span>
<a name="l11"><span class="linenum">  11</span></a>  if( !<a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('EVO_MAIN_INIT')" href="../../_constants/EVO_MAIN_INIT.html" onMouseOver="constPopup(event,'EVO_MAIN_INIT')">EVO_MAIN_INIT</a>') ) die( 'Please, do not access this page directly.' );
<a name="l12"><span class="linenum">  12</span></a>  
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment">/**</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment"> * Open a block</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment"> */</span>
<a name="l16"><span class="linenum">  16</span></a>  function <a class="function" onClick="logFunction('block_open')" href="../../_functions/block_open.html" onMouseOver="funcPopup(event,'block_open')">block_open</a>()
<a name="l17"><span class="linenum">  17</span></a>  {
<a name="l18"><span class="linenum">  18</span></a>      global <a class="var it6539" onMouseOver="hilite(6539)" onMouseOut="lolite()" onClick="logVariable('block_status')" href="../../_variables/block_status.html">$block_status</a>;
<a name="l19"><span class="linenum">  19</span></a>      if( isset(<a class="var it6539" onMouseOver="hilite(6539)" onMouseOut="lolite()" onClick="logVariable('block_status')" href="../../_variables/block_status.html">$block_status</a>) &amp;&amp; <a class="var it6539" onMouseOver="hilite(6539)" onMouseOut="lolite()" onClick="logVariable('block_status')" href="../../_variables/block_status.html">$block_status</a> == 'open' )
<a name="l20"><span class="linenum">  20</span></a>      {
<a name="l21"><span class="linenum">  21</span></a>          return;
<a name="l22"><span class="linenum">  22</span></a>      }
<a name="l23"><span class="linenum">  23</span></a>      <a class="var it6539" onMouseOver="hilite(6539)" onMouseOut="lolite()" onClick="logVariable('block_status')" href="../../_variables/block_status.html">$block_status</a> = 'open';
<a name="l24"><span class="linenum">  24</span></a>      echo '&lt;div class=&quot;block1&quot;&gt;&lt;div class=&quot;block2&quot;&gt;&lt;div class=&quot;block3&quot;&gt;';
<a name="l25"><span class="linenum">  25</span></a>  }
<a name="l26"><span class="linenum">  26</span></a>  
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment">/**</span>
<a name="l28"><span class="linenum">  28</span></a>  <span class="comment"> * Close a block</span>
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment"> */</span>
<a name="l30"><span class="linenum">  30</span></a>  function <a class="function" onClick="logFunction('block_close')" href="../../_functions/block_close.html" onMouseOver="funcPopup(event,'block_close')">block_close</a>()
<a name="l31"><span class="linenum">  31</span></a>  {
<a name="l32"><span class="linenum">  32</span></a>      global <a class="var it6539" onMouseOver="hilite(6539)" onMouseOut="lolite()" onClick="logVariable('block_status')" href="../../_variables/block_status.html">$block_status</a>;
<a name="l33"><span class="linenum">  33</span></a>      if( !isset(<a class="var it6539" onMouseOver="hilite(6539)" onMouseOut="lolite()" onClick="logVariable('block_status')" href="../../_variables/block_status.html">$block_status</a>) || <a class="var it6539" onMouseOver="hilite(6539)" onMouseOut="lolite()" onClick="logVariable('block_status')" href="../../_variables/block_status.html">$block_status</a> == 'closed' )
<a name="l34"><span class="linenum">  34</span></a>      {
<a name="l35"><span class="linenum">  35</span></a>          return;
<a name="l36"><span class="linenum">  36</span></a>      }
<a name="l37"><span class="linenum">  37</span></a>      <a class="var it6539" onMouseOver="hilite(6539)" onMouseOut="lolite()" onClick="logVariable('block_status')" href="../../_variables/block_status.html">$block_status</a> = 'closed';
<a name="l38"><span class="linenum">  38</span></a>      echo '&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;';
<a name="l39"><span class="linenum">  39</span></a>  }
<a name="l40"><span class="linenum">  40</span></a>  
<a name="l41"><span class="linenum">  41</span></a>  <span class="comment">/**</span>
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment"> * Language selector</span>
<a name="l43"><span class="linenum">  43</span></a>  <span class="comment"> */</span>
<a name="l44"><span class="linenum">  44</span></a>  function <a class="function" onClick="logFunction('display_locale_selector')" href="../../_functions/display_locale_selector.html" onMouseOver="funcPopup(event,'display_locale_selector')">display_locale_selector</a>()
<a name="l45"><span class="linenum">  45</span></a>  {
<a name="l46"><span class="linenum">  46</span></a>      global <a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('locales')" href="../../_variables/locales.html">$locales</a>, <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a>, <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a>;
<a name="l47"><span class="linenum">  47</span></a>  
<a name="l48"><span class="linenum">  48</span></a>      static <a class="var it6540" onMouseOver="hilite(6540)" onMouseOut="lolite()" onClick="logVariable('selector_already_displayed')" href="../../_variables/selector_already_displayed.html">$selector_already_displayed</a> = false;
<a name="l49"><span class="linenum">  49</span></a>  
<a name="l50"><span class="linenum">  50</span></a>      if( <a class="var it6540" onMouseOver="hilite(6540)" onMouseOut="lolite()" onClick="logVariable('selector_already_displayed')" href="../../_variables/selector_already_displayed.html">$selector_already_displayed</a> )
<a name="l51"><span class="linenum">  51</span></a>      {
<a name="l52"><span class="linenum">  52</span></a>          return;
<a name="l53"><span class="linenum">  53</span></a>      }
<a name="l54"><span class="linenum">  54</span></a>      <a class="var it6540" onMouseOver="hilite(6540)" onMouseOut="lolite()" onClick="logVariable('selector_already_displayed')" href="../../_variables/selector_already_displayed.html">$selector_already_displayed</a> = true;
<a name="l55"><span class="linenum">  55</span></a>      <a class="function" onClick="logFunction('block_open')" href="../../_functions/block_open.html" onMouseOver="funcPopup(event,'block_open')">block_open</a>();
<a name="l56"><span class="linenum">  56</span></a>      ?&gt;
<a name="l57"><span class="linenum">  57</span></a>      &lt;h2&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Language / Locale')?&gt;&lt;/h2&gt;
<a name="l58"><span class="linenum">  58</span></a>      &lt;form action=&quot;index.php&quot; method=&quot;get&quot;&gt;
<a name="l59"><span class="linenum">  59</span></a>      &lt;?php
<a name="l60"><span class="linenum">  60</span></a>      echo '&lt;div class=&quot;floatright&quot;&gt;&lt;a href=&quot;index.php?action=localeinfo&amp;amp;locale='.<a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a>.'&quot;&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('More languages').' &amp;raquo;&lt;/a&gt;&lt;/div&gt;';
<a name="l61"><span class="linenum">  61</span></a>  
<a name="l62"><span class="linenum">  62</span></a>      <a class="function" onClick="logFunction('locale_flag')" href="../../_functions/locale_flag.html" onMouseOver="funcPopup(event,'locale_flag')">locale_flag</a>( <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a>, 'w16px', 'flag', '', true, <span class="comment">/* Do not rely on $baseurl/$rsc_url here: */</span> '../rsc/flags' );
<a name="l63"><span class="linenum">  63</span></a>      echo '&lt;select name=&quot;locale&quot; onchange=&quot;this.form.<a class="function" onClick="logFunction('submit')" href="../../_functions/submit.html" onMouseOver="funcPopup(event,'submit')">submit</a>()&quot;&gt;';
<a name="l64"><span class="linenum">  64</span></a>      foreach( <a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('locales')" href="../../_variables/locales.html">$locales</a> as <a class="var it2800" onMouseOver="hilite(2800)" onMouseOut="lolite()" onClick="logVariable('lkey')" href="../../_variables/lkey.html">$lkey</a> =&gt; <a class="var it6541" onMouseOver="hilite(6541)" onMouseOut="lolite()" onClick="logVariable('lvalue')" href="../../_variables/lvalue.html">$lvalue</a> )
<a name="l65"><span class="linenum">  65</span></a>      {
<a name="l66"><span class="linenum">  66</span></a>          echo '&lt;option';
<a name="l67"><span class="linenum">  67</span></a>          if( <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a> == <a class="var it2800" onMouseOver="hilite(2800)" onMouseOut="lolite()" onClick="logVariable('lkey')" href="../../_variables/lkey.html">$lkey</a> ) echo ' selected=&quot;selected&quot;';
<a name="l68"><span class="linenum">  68</span></a>          echo ' value=&quot;'.<a class="var it2800" onMouseOver="hilite(2800)" onMouseOut="lolite()" onClick="logVariable('lkey')" href="../../_variables/lkey.html">$lkey</a>.'&quot;&gt;';
<a name="l69"><span class="linenum">  69</span></a>          echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>( <a class="var it6541" onMouseOver="hilite(6541)" onMouseOut="lolite()" onClick="logVariable('lvalue')" href="../../_variables/lvalue.html">$lvalue</a>['name'] );
<a name="l70"><span class="linenum">  70</span></a>          echo '&lt;/option&gt;';
<a name="l71"><span class="linenum">  71</span></a>      }
<a name="l72"><span class="linenum">  72</span></a>      ?&gt;
<a name="l73"><span class="linenum">  73</span></a>      &lt;/select&gt;
<a name="l74"><span class="linenum">  74</span></a>      &lt;noscript&gt;
<a name="l75"><span class="linenum">  75</span></a>          &lt;input type=&quot;submit&quot; value=&quot;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Select as default language/locale'); ?&gt;&quot; /&gt;
<a name="l76"><span class="linenum">  76</span></a>      &lt;/noscript&gt;
<a name="l77"><span class="linenum">  77</span></a>      &lt;/form&gt;
<a name="l78"><span class="linenum">  78</span></a>      &lt;?php
<a name="l79"><span class="linenum">  79</span></a>      <a class="function" onClick="logFunction('block_close')" href="../../_functions/block_close.html" onMouseOver="funcPopup(event,'block_close')">block_close</a>();
<a name="l80"><span class="linenum">  80</span></a>  }
<a name="l81"><span class="linenum">  81</span></a>  
<a name="l82"><span class="linenum">  82</span></a>  <span class="comment">/**</span>
<a name="l83"><span class="linenum">  83</span></a>  <span class="comment"> * Base config recap</span>
<a name="l84"><span class="linenum">  84</span></a>  <span class="comment"> */</span>
<a name="l85"><span class="linenum">  85</span></a>  function <a class="function" onClick="logFunction('display_base_config_recap')" href="../../_functions/display_base_config_recap.html" onMouseOver="funcPopup(event,'display_base_config_recap')">display_base_config_recap</a>()
<a name="l86"><span class="linenum">  86</span></a>  {
<a name="l87"><span class="linenum">  87</span></a>      global <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a>, <a class="var it5433" onMouseOver="hilite(5433)" onMouseOut="lolite()" onClick="logVariable('conf_db_user')" href="../../_variables/conf_db_user.html">$conf_db_user</a>, <a class="var it5434" onMouseOver="hilite(5434)" onMouseOut="lolite()" onClick="logVariable('conf_db_password')" href="../../_variables/conf_db_password.html">$conf_db_password</a>, <a class="var it5435" onMouseOver="hilite(5435)" onMouseOut="lolite()" onClick="logVariable('conf_db_name')" href="../../_variables/conf_db_name.html">$conf_db_name</a>, <a class="var it5436" onMouseOver="hilite(5436)" onMouseOut="lolite()" onClick="logVariable('conf_db_host')" href="../../_variables/conf_db_host.html">$conf_db_host</a>, <a class="var it1750" onMouseOver="hilite(1750)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../../_variables/db_config.html">$db_config</a>, <a class="var it748" onMouseOver="hilite(748)" onMouseOut="lolite()" onClick="logVariable('tableprefix')" href="../../_variables/tableprefix.html">$tableprefix</a>, <a class="var it153" onMouseOver="hilite(153)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../_variables/baseurl.html">$baseurl</a>, <a class="var it1751" onMouseOver="hilite(1751)" onMouseOut="lolite()" onClick="logVariable('admin_email')" href="../../_variables/admin_email.html">$admin_email</a>;
<a name="l88"><span class="linenum">  88</span></a>  
<a name="l89"><span class="linenum">  89</span></a>      static <a class="var it6542" onMouseOver="hilite(6542)" onMouseOut="lolite()" onClick="logVariable('base_config_recap_already_displayed')" href="../../_variables/base_config_recap_already_displayed.html">$base_config_recap_already_displayed</a> = false;
<a name="l90"><span class="linenum">  90</span></a>  
<a name="l91"><span class="linenum">  91</span></a>      if( <a class="var it6542" onMouseOver="hilite(6542)" onMouseOut="lolite()" onClick="logVariable('base_config_recap_already_displayed')" href="../../_variables/base_config_recap_already_displayed.html">$base_config_recap_already_displayed</a> )
<a name="l92"><span class="linenum">  92</span></a>      {
<a name="l93"><span class="linenum">  93</span></a>          return;
<a name="l94"><span class="linenum">  94</span></a>      }
<a name="l95"><span class="linenum">  95</span></a>      <a class="var it6542" onMouseOver="hilite(6542)" onMouseOut="lolite()" onClick="logVariable('base_config_recap_already_displayed')" href="../../_variables/base_config_recap_already_displayed.html">$base_config_recap_already_displayed</a> = true;
<a name="l96"><span class="linenum">  96</span></a>  
<a name="l97"><span class="linenum">  97</span></a>      <a class="function" onClick="logFunction('block_open')" href="../../_functions/block_open.html" onMouseOver="funcPopup(event,'block_open')">block_open</a>();
<a name="l98"><span class="linenum">  98</span></a>      ?&gt;
<a name="l99"><span class="linenum">  99</span></a>      &lt;h2&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Base config recap...')?&gt;&lt;/h2&gt;
<a name="l100"><span class="linenum"> 100</span></a>  
<a name="l101"><span class="linenum"> 101</span></a>      &lt;p&gt;&lt;?php printf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('If you don\'t see correct settings here, STOP before going any further, and &lt;a %s&gt;update your base configuration&lt;/a&gt;.'), 'href=&quot;index.php?action=start&amp;amp;locale='.<a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a>.'&quot;' ) ?&gt;&lt;/p&gt;
<a name="l102"><span class="linenum"> 102</span></a>  
<a name="l103"><span class="linenum"> 103</span></a>      &lt;?php
<a name="l104"><span class="linenum"> 104</span></a>      if( !isset(<a class="var it5433" onMouseOver="hilite(5433)" onMouseOut="lolite()" onClick="logVariable('conf_db_user')" href="../../_variables/conf_db_user.html">$conf_db_user</a>) ) <a class="var it5433" onMouseOver="hilite(5433)" onMouseOut="lolite()" onClick="logVariable('conf_db_user')" href="../../_variables/conf_db_user.html">$conf_db_user</a> = <a class="var it1750" onMouseOver="hilite(1750)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../../_variables/db_config.html">$db_config</a>['user'];
<a name="l105"><span class="linenum"> 105</span></a>      if( !isset(<a class="var it5434" onMouseOver="hilite(5434)" onMouseOut="lolite()" onClick="logVariable('conf_db_password')" href="../../_variables/conf_db_password.html">$conf_db_password</a>) ) <a class="var it5434" onMouseOver="hilite(5434)" onMouseOut="lolite()" onClick="logVariable('conf_db_password')" href="../../_variables/conf_db_password.html">$conf_db_password</a> = <a class="var it1750" onMouseOver="hilite(1750)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../../_variables/db_config.html">$db_config</a>['password'];
<a name="l106"><span class="linenum"> 106</span></a>      if( !isset(<a class="var it5435" onMouseOver="hilite(5435)" onMouseOut="lolite()" onClick="logVariable('conf_db_name')" href="../../_variables/conf_db_name.html">$conf_db_name</a>) ) <a class="var it5435" onMouseOver="hilite(5435)" onMouseOut="lolite()" onClick="logVariable('conf_db_name')" href="../../_variables/conf_db_name.html">$conf_db_name</a> = <a class="var it1750" onMouseOver="hilite(1750)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../../_variables/db_config.html">$db_config</a>['name'];
<a name="l107"><span class="linenum"> 107</span></a>      if( !isset(<a class="var it5436" onMouseOver="hilite(5436)" onMouseOut="lolite()" onClick="logVariable('conf_db_host')" href="../../_variables/conf_db_host.html">$conf_db_host</a>) ) <a class="var it5436" onMouseOver="hilite(5436)" onMouseOut="lolite()" onClick="logVariable('conf_db_host')" href="../../_variables/conf_db_host.html">$conf_db_host</a> = isset(<a class="var it1750" onMouseOver="hilite(1750)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../../_variables/db_config.html">$db_config</a>['host']) ? <a class="var it1750" onMouseOver="hilite(1750)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../../_variables/db_config.html">$db_config</a>['host'] : 'localhost';
<a name="l108"><span class="linenum"> 108</span></a>  
<a name="l109"><span class="linenum"> 109</span></a>      echo '&lt;pre&gt;',
<a name="l110"><span class="linenum"> 110</span></a>      <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('MySQL Username').': '.<a class="var it5433" onMouseOver="hilite(5433)" onMouseOut="lolite()" onClick="logVariable('conf_db_user')" href="../../_variables/conf_db_user.html">$conf_db_user</a>.&quot;\n&quot;.
<a name="l111"><span class="linenum"> 111</span></a>      <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('MySQL Password').': '.((<a class="var it5434" onMouseOver="hilite(5434)" onMouseOut="lolite()" onClick="logVariable('conf_db_password')" href="../../_variables/conf_db_password.html">$conf_db_password</a> != 'demopass' ? <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('(Set, but not shown for security reasons)') : 'demopass') ).&quot;\n&quot;.
<a name="l112"><span class="linenum"> 112</span></a>      <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('MySQL Database name').': '.<a class="var it5435" onMouseOver="hilite(5435)" onMouseOut="lolite()" onClick="logVariable('conf_db_name')" href="../../_variables/conf_db_name.html">$conf_db_name</a>.&quot;\n&quot;.
<a name="l113"><span class="linenum"> 113</span></a>      <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('MySQL Host/Server').': '.<a class="var it5436" onMouseOver="hilite(5436)" onMouseOut="lolite()" onClick="logVariable('conf_db_host')" href="../../_variables/conf_db_host.html">$conf_db_host</a>.&quot;\n&quot;.
<a name="l114"><span class="linenum"> 114</span></a>      <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('MySQL tables prefix').': '.<a class="var it748" onMouseOver="hilite(748)" onMouseOut="lolite()" onClick="logVariable('tableprefix')" href="../../_variables/tableprefix.html">$tableprefix</a>.&quot;\n\n&quot;.
<a name="l115"><span class="linenum"> 115</span></a>      <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Base URL').': '.<a class="var it153" onMouseOver="hilite(153)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../_variables/baseurl.html">$baseurl</a>.&quot;\n\n&quot;.
<a name="l116"><span class="linenum"> 116</span></a>      <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Admin email').': '.<a class="var it1751" onMouseOver="hilite(1751)" onMouseOut="lolite()" onClick="logVariable('admin_email')" href="../../_variables/admin_email.html">$admin_email</a>.
<a name="l117"><span class="linenum"> 117</span></a>      '&lt;/pre&gt;';
<a name="l118"><span class="linenum"> 118</span></a>      <a class="function" onClick="logFunction('block_close')" href="../../_functions/block_close.html" onMouseOver="funcPopup(event,'block_close')">block_close</a>();
<a name="l119"><span class="linenum"> 119</span></a>  }
<a name="l120"><span class="linenum"> 120</span></a>  
<a name="l121"><span class="linenum"> 121</span></a>  
<a name="l122"><span class="linenum"> 122</span></a>  <span class="comment">/**</span>
<a name="l123"><span class="linenum"> 123</span></a>  <span class="comment"> * Install new DB.</span>
<a name="l124"><span class="linenum"> 124</span></a>  <span class="comment"> */</span>
<a name="l125"><span class="linenum"> 125</span></a>  function <a class="function" onClick="logFunction('install_newdb')" href="../../_functions/install_newdb.html" onMouseOver="funcPopup(event,'install_newdb')">install_newdb</a>()
<a name="l126"><span class="linenum"> 126</span></a>  {
<a name="l127"><span class="linenum"> 127</span></a>      global <a class="var it4135" onMouseOver="hilite(4135)" onMouseOut="lolite()" onClick="logVariable('new_db_version')" href="../../_variables/new_db_version.html">$new_db_version</a>, <a class="var it346" onMouseOver="hilite(346)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../_variables/admin_url.html">$admin_url</a>, <a class="var it4809" onMouseOver="hilite(4809)" onMouseOut="lolite()" onClick="logVariable('random_password')" href="../../_variables/random_password.html">$random_password</a>;
<a name="l128"><span class="linenum"> 128</span></a>  
<a name="l129"><span class="linenum"> 129</span></a>      <span class="comment">/*</span>
<a name="l130"><span class="linenum"> 130</span></a>  <span class="comment">     * -----------------------------------------------------------------------------------</span>
<a name="l131"><span class="linenum"> 131</span></a>  <span class="comment">     * NEW DB: Create a plain new db structure + sample contents</span>
<a name="l132"><span class="linenum"> 132</span></a>  <span class="comment">     * -----------------------------------------------------------------------------------</span>
<a name="l133"><span class="linenum"> 133</span></a>  <span class="comment">     */</span>
<a name="l134"><span class="linenum"> 134</span></a>      require_once <a class="phpfunction" onClick="logFunction('dirname')" href="../../_functions/dirname.html" onMouseOver="phpfuncPopup(event,'dirname')">dirname</a>(__FILE__).'/_functions_create.php';
<a name="l135"><span class="linenum"> 135</span></a>  
<a name="l136"><span class="linenum"> 136</span></a>      if( <a class="var it5443" onMouseOver="hilite(5443)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../../_variables/old_db_version.html">$old_db_version</a> = <a class="function" onClick="logFunction('get_db_version')" href="../../_functions/get_db_version.html" onMouseOver="funcPopup(event,'get_db_version')">get_db_version</a>() )
<a name="l137"><span class="linenum"> 137</span></a>      {
<a name="l138"><span class="linenum"> 138</span></a>          echo '&lt;p&gt;&lt;strong&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('OOPS! It seems b2evolution is already installed!').'&lt;/strong&gt;&lt;/p&gt;';
<a name="l139"><span class="linenum"> 139</span></a>  
<a name="l140"><span class="linenum"> 140</span></a>          if( <a class="var it5443" onMouseOver="hilite(5443)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../../_variables/old_db_version.html">$old_db_version</a> &lt; <a class="var it4135" onMouseOver="hilite(4135)" onMouseOut="lolite()" onClick="logVariable('new_db_version')" href="../../_variables/new_db_version.html">$new_db_version</a> )
<a name="l141"><span class="linenum"> 141</span></a>          {
<a name="l142"><span class="linenum"> 142</span></a>              echo '&lt;p&gt;'.sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Would you like to &lt;a %s&gt;upgrade your existing installation now&lt;/a&gt;?'), 'href=&quot;?action=evoupgrade&quot;' ).'&lt;/p&gt;';
<a name="l143"><span class="linenum"> 143</span></a>          }
<a name="l144"><span class="linenum"> 144</span></a>  
<a name="l145"><span class="linenum"> 145</span></a>          return;
<a name="l146"><span class="linenum"> 146</span></a>      }
<a name="l147"><span class="linenum"> 147</span></a>  
<a name="l148"><span class="linenum"> 148</span></a>      <a class="var it6543" onMouseOver="hilite(6543)" onMouseOut="lolite()" onClick="logVariable('installer_version')" href="../../_variables/installer_version.html">$installer_version</a> = <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'installer_version', 'integer', 0 );
<a name="l149"><span class="linenum"> 149</span></a>      if( <a class="var it6543" onMouseOver="hilite(6543)" onMouseOut="lolite()" onClick="logVariable('installer_version')" href="../../_variables/installer_version.html">$installer_version</a> &gt;= 10 )
<a name="l150"><span class="linenum"> 150</span></a>      {
<a name="l151"><span class="linenum"> 151</span></a>          <a class="var it6544" onMouseOver="hilite(6544)" onMouseOut="lolite()" onClick="logVariable('create_sample_contents')" href="../../_variables/create_sample_contents.html">$create_sample_contents</a> = <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'create_sample_contents', 'integer', 0 );
<a name="l152"><span class="linenum"> 152</span></a>      }
<a name="l153"><span class="linenum"> 153</span></a>      else
<a name="l154"><span class="linenum"> 154</span></a>      {    // OLD INSTALLER call. Probably an automated script calling.
<a name="l155"><span class="linenum"> 155</span></a>  <span class="comment">        // Let's force the sample contents since they haven't been explicitly disabled</span>
<a name="l156"><span class="linenum"> 156</span></a>          <a class="var it6544" onMouseOver="hilite(6544)" onMouseOut="lolite()" onClick="logVariable('create_sample_contents')" href="../../_variables/create_sample_contents.html">$create_sample_contents</a> = 1;
<a name="l157"><span class="linenum"> 157</span></a>      }
<a name="l158"><span class="linenum"> 158</span></a>  
<a name="l159"><span class="linenum"> 159</span></a>      <span class="comment">/**</span>
<a name="l160"><span class="linenum"> 160</span></a>  <span class="comment">     * 1 - If current installation is local, test or intranet</span>
<a name="l161"><span class="linenum"> 161</span></a>  <span class="comment">     *     Used to turn off gravatar and all ping plugins</span>
<a name="l162"><span class="linenum"> 162</span></a>  <span class="comment">     *</span>
<a name="l163"><span class="linenum"> 163</span></a>  <span class="comment">     * @var integer</span>
<a name="l164"><span class="linenum"> 164</span></a>  <span class="comment">     */</span>
<a name="l165"><span class="linenum"> 165</span></a>      <a class="var it4834" onMouseOver="hilite(4834)" onMouseOut="lolite()" onClick="logVariable('local_installation')" href="../../_variables/local_installation.html">$local_installation</a> = <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'local_installation', 'integer', 0 );
<a name="l166"><span class="linenum"> 166</span></a>  
<a name="l167"><span class="linenum"> 167</span></a>      echo '&lt;h2&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Creating b2evolution tables...').'&lt;/h2&gt;';
<a name="l168"><span class="linenum"> 168</span></a>      <a class="function" onClick="logFunction('evo_flush')" href="../../_functions/evo_flush.html" onMouseOver="funcPopup(event,'evo_flush')">evo_flush</a>();
<a name="l169"><span class="linenum"> 169</span></a>      <a class="function" onClick="logFunction('create_tables')" href="../../_functions/create_tables.html" onMouseOver="funcPopup(event,'create_tables')">create_tables</a>();
<a name="l170"><span class="linenum"> 170</span></a>  
<a name="l171"><span class="linenum"> 171</span></a>      echo '&lt;h2&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Creating minimum default data...').'&lt;/h2&gt;';
<a name="l172"><span class="linenum"> 172</span></a>      <a class="function" onClick="logFunction('evo_flush')" href="../../_functions/evo_flush.html" onMouseOver="funcPopup(event,'evo_flush')">evo_flush</a>();
<a name="l173"><span class="linenum"> 173</span></a>      <a class="function" onClick="logFunction('create_default_data')" href="../../_functions/create_default_data.html" onMouseOver="funcPopup(event,'create_default_data')">create_default_data</a>();
<a name="l174"><span class="linenum"> 174</span></a>  
<a name="l175"><span class="linenum"> 175</span></a>      if( <a class="var it6544" onMouseOver="hilite(6544)" onMouseOut="lolite()" onClick="logVariable('create_sample_contents')" href="../../_variables/create_sample_contents.html">$create_sample_contents</a> )
<a name="l176"><span class="linenum"> 176</span></a>      {
<a name="l177"><span class="linenum"> 177</span></a>          global <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../_variables/Settings.html">$Settings</a>, <a class="var it2140" onMouseOver="hilite(2140)" onMouseOut="lolite()" onClick="logVariable('test_install_all_features')" href="../../_variables/test_install_all_features.html">$test_install_all_features</a>;
<a name="l178"><span class="linenum"> 178</span></a>  
<a name="l179"><span class="linenum"> 179</span></a>          echo '&lt;h2&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Installing sample contents...').'&lt;/h2&gt;';
<a name="l180"><span class="linenum"> 180</span></a>          <a class="function" onClick="logFunction('evo_flush')" href="../../_functions/evo_flush.html" onMouseOver="funcPopup(event,'evo_flush')">evo_flush</a>();
<a name="l181"><span class="linenum"> 181</span></a>  
<a name="l182"><span class="linenum"> 182</span></a>  <span class="comment">        // We're gonna need some environment in order to create the demo contents...</span>
<a name="l183"><span class="linenum"> 183</span></a>          <a class="function" onClick="logFunction('load_class')" href="../../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( 'settings/model/_generalsettings.class.php', 'GeneralSettings' );
<a name="l184"><span class="linenum"> 184</span></a>          <a class="function" onClick="logFunction('load_class')" href="../../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( 'users/model/_usersettings.class.php', 'UserSettings' );
<a name="l185"><span class="linenum"> 185</span></a>          <span class="comment">/**</span>
<a name="l186"><span class="linenum"> 186</span></a>  <span class="comment">         * @var GeneralSettings</span>
<a name="l187"><span class="linenum"> 187</span></a>  <span class="comment">         */</span>
<a name="l188"><span class="linenum"> 188</span></a>          <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../_variables/Settings.html">$Settings</a> = <span class="keyword">new </span><a class="class" onClick="logClass('GeneralSettings')" href="../../_classes/generalsettings.html" onMouseOver="classPopup(event,'generalsettings')">GeneralSettings</a>();
<a name="l189"><span class="linenum"> 189</span></a>  
<a name="l190"><span class="linenum"> 190</span></a>          if( <a class="var it2140" onMouseOver="hilite(2140)" onMouseOut="lolite()" onClick="logVariable('test_install_all_features')" href="../../_variables/test_install_all_features.html">$test_install_all_features</a> )
<a name="l191"><span class="linenum"> 191</span></a>          {    // Set manual ordering of categories
<a name="l192"><span class="linenum"> 192</span></a>              <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../_variables/Settings.html">$Settings</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'chapter_ordering', 'manual' );
<a name="l193"><span class="linenum"> 193</span></a>              <a class="var it10" onMouseOver="hilite(10)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../_variables/Settings.html">$Settings</a>-&gt;<a class="function" onClick="logFunction('dbupdate')" href="../../_functions/dbupdate.html" onMouseOver="funcPopup(event,'dbupdate')">dbupdate</a>();
<a name="l194"><span class="linenum"> 194</span></a>          }
<a name="l195"><span class="linenum"> 195</span></a>  
<a name="l196"><span class="linenum"> 196</span></a>          <span class="comment">/**</span>
<a name="l197"><span class="linenum"> 197</span></a>  <span class="comment">         * @var UserCache</span>
<a name="l198"><span class="linenum"> 198</span></a>  <span class="comment">         */</span>
<a name="l199"><span class="linenum"> 199</span></a>          <a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('UserCache')" href="../../_variables/UserCache.html">$UserCache</a> = &amp; get_UserCache();
<a name="l200"><span class="linenum"> 200</span></a>  <span class="comment">        // Create $current_User object.</span>
<a name="l201"><span class="linenum"> 201</span></a>  <span class="comment">        // (Assigning by reference does not work with &quot;global&quot; keyword (PHP 5.2.8))</span>
<a name="l202"><span class="linenum"> 202</span></a>          <a class="var it542" onMouseOver="hilite(542)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../_variables/GLOBALS.html">$GLOBALS</a>['current_User'] = &amp; <a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('UserCache')" href="../../_variables/UserCache.html">$UserCache</a>-&gt;get_by_ID( 1 );
<a name="l203"><span class="linenum"> 203</span></a>  
<a name="l204"><span class="linenum"> 204</span></a>          <a class="function" onClick="logFunction('create_demo_contents')" href="../../_functions/create_demo_contents.html" onMouseOver="funcPopup(event,'create_demo_contents')">create_demo_contents</a>();
<a name="l205"><span class="linenum"> 205</span></a>      }
<a name="l206"><span class="linenum"> 206</span></a>  
<a name="l207"><span class="linenum"> 207</span></a>      <a class="function" onClick="logFunction('track_step')" href="../../_functions/track_step.html" onMouseOver="funcPopup(event,'track_step')">track_step</a>( 'install-success' );
<a name="l208"><span class="linenum"> 208</span></a>      echo '&lt;h2&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Installation successful!').'&lt;/h2&gt;';
<a name="l209"><span class="linenum"> 209</span></a>  
<a name="l210"><span class="linenum"> 210</span></a>      echo '&lt;p&gt;&lt;strong&gt;';
<a name="l211"><span class="linenum"> 211</span></a>      printf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Now you can &lt;a %s&gt;log in&lt;/a&gt; with the following credentials:'), 'href=&quot;'.<a class="var it346" onMouseOver="hilite(346)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../_variables/admin_url.html">$admin_url</a>.'&quot;' );
<a name="l212"><span class="linenum"> 212</span></a>      echo '&lt;/strong&gt;&lt;/p&gt;';
<a name="l213"><span class="linenum"> 213</span></a>  
<a name="l214"><span class="linenum"> 214</span></a>      echo '&lt;table&gt;';
<a name="l215"><span class="linenum"> 215</span></a>      echo '&lt;tr&gt;&lt;td&gt;', <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>( 'Login' ), ': &amp;nbsp;&lt;/td&gt;&lt;td&gt;&lt;strong&gt;&lt;evo:password&gt;admin&lt;/evo:password&gt;&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;';
<a name="l216"><span class="linenum"> 216</span></a>      printf( '&lt;tr&gt;&lt;td&gt;%s: &amp;nbsp;&lt;/td&gt;&lt;td&gt;&lt;strong&gt;&lt;evo:password&gt;%s&lt;/evo:password&gt;&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;', <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>( 'Password' ), <a class="var it4809" onMouseOver="hilite(4809)" onMouseOut="lolite()" onClick="logVariable('random_password')" href="../../_variables/random_password.html">$random_password</a> );
<a name="l217"><span class="linenum"> 217</span></a>      echo '&lt;/table&gt;';
<a name="l218"><span class="linenum"> 218</span></a>  
<a name="l219"><span class="linenum"> 219</span></a>      echo '&lt;p&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Note that password carefully! It is a &lt;em&gt;random&lt;/em&gt; password that is given to you when you install b2evolution. If you lose it, you will have to delete the database tables and re-install anew.').'&lt;/p&gt;';
<a name="l220"><span class="linenum"> 220</span></a>  }
<a name="l221"><span class="linenum"> 221</span></a>  
<a name="l222"><span class="linenum"> 222</span></a>  
<a name="l223"><span class="linenum"> 223</span></a>  <span class="comment">/**</span>
<a name="l224"><span class="linenum"> 224</span></a>  <span class="comment"> * Begin install task.</span>
<a name="l225"><span class="linenum"> 225</span></a>  <span class="comment"> * This will offer other display methods in the future</span>
<a name="l226"><span class="linenum"> 226</span></a>  <span class="comment"> */</span>
<a name="l227"><span class="linenum"> 227</span></a>  function <a class="function" onClick="logFunction('task_begin')" href="../../_functions/task_begin.html" onMouseOver="funcPopup(event,'task_begin')">task_begin</a>( <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a> )
<a name="l228"><span class="linenum"> 228</span></a>  {
<a name="l229"><span class="linenum"> 229</span></a>      echo <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a>.&quot;\n&quot;;
<a name="l230"><span class="linenum"> 230</span></a>      <a class="function" onClick="logFunction('evo_flush')" href="../../_functions/evo_flush.html" onMouseOver="funcPopup(event,'evo_flush')">evo_flush</a>();
<a name="l231"><span class="linenum"> 231</span></a>  }
<a name="l232"><span class="linenum"> 232</span></a>  
<a name="l233"><span class="linenum"> 233</span></a>  
<a name="l234"><span class="linenum"> 234</span></a>  <span class="comment">/**</span>
<a name="l235"><span class="linenum"> 235</span></a>  <span class="comment"> * End install task.</span>
<a name="l236"><span class="linenum"> 236</span></a>  <span class="comment"> * This will offer other display methods in the future</span>
<a name="l237"><span class="linenum"> 237</span></a>  <span class="comment"> */</span>
<a name="l238"><span class="linenum"> 238</span></a>  function <a class="function" onClick="logFunction('task_end')" href="../../_functions/task_end.html" onMouseOver="funcPopup(event,'task_end')">task_end</a>()
<a name="l239"><span class="linenum"> 239</span></a>  {
<a name="l240"><span class="linenum"> 240</span></a>      echo &quot;OK.&lt;br /&gt;\n&quot;;
<a name="l241"><span class="linenum"> 241</span></a>  }
<a name="l242"><span class="linenum"> 242</span></a>  
<a name="l243"><span class="linenum"> 243</span></a>  
<a name="l244"><span class="linenum"> 244</span></a>  function <a class="function" onClick="logFunction('get_db_version')" href="../../_functions/get_db_version.html" onMouseOver="funcPopup(event,'get_db_version')">get_db_version</a>()
<a name="l245"><span class="linenum"> 245</span></a>  {
<a name="l246"><span class="linenum"> 246</span></a>      global <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l247"><span class="linenum"> 247</span></a>  
<a name="l248"><span class="linenum"> 248</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('save_error_state')" href="../../_functions/save_error_state.html" onMouseOver="funcPopup(event,'save_error_state')">save_error_state</a>();
<a name="l249"><span class="linenum"> 249</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('halt_on_error')" class="var it8966" onMouseOver="hilite(8966)" onMouseOut="lolite()" href="../../_variables/halt_on_error.html">halt_on_error</a> = false;
<a name="l250"><span class="linenum"> 250</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('show_errors')" class="var it8966" onMouseOver="hilite(8966)" onMouseOut="lolite()" href="../../_variables/show_errors.html">show_errors</a> = false;
<a name="l251"><span class="linenum"> 251</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('log_errors')" class="var it8966" onMouseOver="hilite(8966)" onMouseOut="lolite()" href="../../_variables/log_errors.html">log_errors</a> = false;
<a name="l252"><span class="linenum"> 252</span></a>  
<a name="l253"><span class="linenum"> 253</span></a>      <a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> = NULL;
<a name="l254"><span class="linenum"> 254</span></a>  
<a name="l255"><span class="linenum"> 255</span></a>      if( <a class="function" onClick="logFunction('db_col_exists')" href="../../_functions/db_col_exists.html" onMouseOver="funcPopup(event,'db_col_exists')">db_col_exists</a>( 'T_settings', 'set_name' ) )
<a name="l256"><span class="linenum"> 256</span></a>      { // we have <span class="keyword">new </span><a class="class" onClick="logClass('table')" href="../../_classes/table.html" onMouseOver="classPopup(event,'table')">table</a> <a class="function" onClick="logFunction('format')" href="../../_functions/format.html" onMouseOver="funcPopup(event,'format')">format</a> (since 0.9)
<a name="l257"><span class="linenum"> 257</span></a>          <a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> = <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_var')" href="../../_functions/get_var.html" onMouseOver="funcPopup(event,'get_var')">get_var</a>( 'SELECT set_value FROM T_settings WHERE set_name = &quot;db_version&quot;' );
<a name="l258"><span class="linenum"> 258</span></a>      }
<a name="l259"><span class="linenum"> 259</span></a>      else
<a name="l260"><span class="linenum"> 260</span></a>      {
<a name="l261"><span class="linenum"> 261</span></a>          <a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> = <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_var')" href="../../_functions/get_var.html" onMouseOver="funcPopup(event,'get_var')">get_var</a>( 'SELECT db_version FROM T_settings' );
<a name="l262"><span class="linenum"> 262</span></a>      }
<a name="l263"><span class="linenum"> 263</span></a>  
<a name="l264"><span class="linenum"> 264</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('restore_error_state')" href="../../_functions/restore_error_state.html" onMouseOver="funcPopup(event,'restore_error_state')">restore_error_state</a>();
<a name="l265"><span class="linenum"> 265</span></a>  
<a name="l266"><span class="linenum"> 266</span></a>      return <a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a>;
<a name="l267"><span class="linenum"> 267</span></a>  }
<a name="l268"><span class="linenum"> 268</span></a>  
<a name="l269"><span class="linenum"> 269</span></a>  
<a name="l270"><span class="linenum"> 270</span></a>  <span class="comment">/**</span>
<a name="l271"><span class="linenum"> 271</span></a>  <span class="comment"> * Get default locale from db</span>
<a name="l272"><span class="linenum"> 272</span></a>  <span class="comment"> */</span>
<a name="l273"><span class="linenum"> 273</span></a>  function <a class="function" onClick="logFunction('get_default_locale_from_db')" href="../../_functions/get_default_locale_from_db.html" onMouseOver="funcPopup(event,'get_default_locale_from_db')">get_default_locale_from_db</a>()
<a name="l274"><span class="linenum"> 274</span></a>  {
<a name="l275"><span class="linenum"> 275</span></a>      global <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l276"><span class="linenum"> 276</span></a>  
<a name="l277"><span class="linenum"> 277</span></a>      if( empty( <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a> ) )
<a name="l278"><span class="linenum"> 278</span></a>      { // DB doesn't exists yet
<a name="l279"><span class="linenum"> 279</span></a>          return NULL;
<a name="l280"><span class="linenum"> 280</span></a>      }
<a name="l281"><span class="linenum"> 281</span></a>  
<a name="l282"><span class="linenum"> 282</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('save_error_state')" href="../../_functions/save_error_state.html" onMouseOver="funcPopup(event,'save_error_state')">save_error_state</a>();
<a name="l283"><span class="linenum"> 283</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('halt_on_error')" class="var it8966" onMouseOver="hilite(8966)" onMouseOut="lolite()" href="../../_variables/halt_on_error.html">halt_on_error</a> = false;
<a name="l284"><span class="linenum"> 284</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('show_errors')" class="var it8966" onMouseOver="hilite(8966)" onMouseOut="lolite()" href="../../_variables/show_errors.html">show_errors</a> = false;
<a name="l285"><span class="linenum"> 285</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('log_errors')" class="var it8966" onMouseOver="hilite(8966)" onMouseOut="lolite()" href="../../_variables/log_errors.html">log_errors</a> = false;
<a name="l286"><span class="linenum"> 286</span></a>  
<a name="l287"><span class="linenum"> 287</span></a>      <a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> = NULL;
<a name="l288"><span class="linenum"> 288</span></a>  
<a name="l289"><span class="linenum"> 289</span></a>      if( <a class="function" onClick="logFunction('db_col_exists')" href="../../_functions/db_col_exists.html" onMouseOver="funcPopup(event,'db_col_exists')">db_col_exists</a>( 'T_settings', 'set_name' ) )
<a name="l290"><span class="linenum"> 290</span></a>      {
<a name="l291"><span class="linenum"> 291</span></a>          <a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> = <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_var')" href="../../_functions/get_var.html" onMouseOver="funcPopup(event,'get_var')">get_var</a>( 'SELECT set_value FROM T_settings WHERE set_name = &quot;default_locale&quot;' );
<a name="l292"><span class="linenum"> 292</span></a>      }
<a name="l293"><span class="linenum"> 293</span></a>  
<a name="l294"><span class="linenum"> 294</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('restore_error_state')" href="../../_functions/restore_error_state.html" onMouseOver="funcPopup(event,'restore_error_state')">restore_error_state</a>();
<a name="l295"><span class="linenum"> 295</span></a>  
<a name="l296"><span class="linenum"> 296</span></a>      return <a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a>;
<a name="l297"><span class="linenum"> 297</span></a>  }
<a name="l298"><span class="linenum"> 298</span></a>  
<a name="l299"><span class="linenum"> 299</span></a>  
<a name="l300"><span class="linenum"> 300</span></a>  <span class="comment">/**</span>
<a name="l301"><span class="linenum"> 301</span></a>  <span class="comment"> * @return boolean Does a given column name exist in DB?</span>
<a name="l302"><span class="linenum"> 302</span></a>  <span class="comment"> */</span>
<a name="l303"><span class="linenum"> 303</span></a>  function <a class="function" onClick="logFunction('db_col_exists')" href="../../_functions/db_col_exists.html" onMouseOver="funcPopup(event,'db_col_exists')">db_col_exists</a>( <a class="var it944" onMouseOver="hilite(944)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>, <a class="var it5985" onMouseOver="hilite(5985)" onMouseOut="lolite()" onClick="logVariable('col_name')" href="../../_variables/col_name.html">$col_name</a> )
<a name="l304"><span class="linenum"> 304</span></a>  {
<a name="l305"><span class="linenum"> 305</span></a>      global <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l306"><span class="linenum"> 306</span></a>  
<a name="l307"><span class="linenum"> 307</span></a>      <a class="var it5985" onMouseOver="hilite(5985)" onMouseOut="lolite()" onClick="logVariable('col_name')" href="../../_variables/col_name.html">$col_name</a> = <a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it5985" onMouseOver="hilite(5985)" onMouseOut="lolite()" onClick="logVariable('col_name')" href="../../_variables/col_name.html">$col_name</a>);
<a name="l308"><span class="linenum"> 308</span></a>  
<a name="l309"><span class="linenum"> 309</span></a>      <a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> = false;
<a name="l310"><span class="linenum"> 310</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('save_error_state')" href="../../_functions/save_error_state.html" onMouseOver="funcPopup(event,'save_error_state')">save_error_state</a>();
<a name="l311"><span class="linenum"> 311</span></a>      foreach( <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_results')" href="../../_functions/get_results.html" onMouseOver="funcPopup(event,'get_results')">get_results</a>('SHOW COLUMNS FROM '.<a class="var it944" onMouseOver="hilite(944)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>) as <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a> )
<a name="l312"><span class="linenum"> 312</span></a>      {
<a name="l313"><span class="linenum"> 313</span></a>          if( <a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>-&gt;<a onClick="logVariable('Field')" class="var it8964" onMouseOver="hilite(8964)" onMouseOut="lolite()" href="../../_variables/Field.html">Field</a>) == <a class="var it5985" onMouseOver="hilite(5985)" onMouseOut="lolite()" onClick="logVariable('col_name')" href="../../_variables/col_name.html">$col_name</a> )
<a name="l314"><span class="linenum"> 314</span></a>          {
<a name="l315"><span class="linenum"> 315</span></a>              <a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> = true;
<a name="l316"><span class="linenum"> 316</span></a>              break;
<a name="l317"><span class="linenum"> 317</span></a>          }
<a name="l318"><span class="linenum"> 318</span></a>      }
<a name="l319"><span class="linenum"> 319</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('restore_error_state')" href="../../_functions/restore_error_state.html" onMouseOver="funcPopup(event,'restore_error_state')">restore_error_state</a>();
<a name="l320"><span class="linenum"> 320</span></a>  
<a name="l321"><span class="linenum"> 321</span></a>      return <a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a>;
<a name="l322"><span class="linenum"> 322</span></a>  }
<a name="l323"><span class="linenum"> 323</span></a>  
<a name="l324"><span class="linenum"> 324</span></a>  
<a name="l325"><span class="linenum"> 325</span></a>  <span class="comment">/**</span>
<a name="l326"><span class="linenum"> 326</span></a>  <span class="comment"> * Clean up extra quotes in comments</span>
<a name="l327"><span class="linenum"> 327</span></a>  <span class="comment"> */</span>
<a name="l328"><span class="linenum"> 328</span></a>  function <a class="function" onClick="logFunction('cleanup_comment_quotes')" href="../../_functions/cleanup_comment_quotes.html" onMouseOver="funcPopup(event,'cleanup_comment_quotes')">cleanup_comment_quotes</a>()
<a name="l329"><span class="linenum"> 329</span></a>  {
<a name="l330"><span class="linenum"> 330</span></a>      global <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l331"><span class="linenum"> 331</span></a>  
<a name="l332"><span class="linenum"> 332</span></a>      <a class="function" onClick="logFunction('task_begin')" href="../../_functions/task_begin.html" onMouseOver="funcPopup(event,'task_begin')">task_begin</a>( 'Checking for extra quote escaping in comments... ' );
<a name="l333"><span class="linenum"> 333</span></a>      <a class="var it1660" onMouseOver="hilite(1660)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../_variables/query.html">$query</a> = &quot;SELECT comment_ID, comment_content
<a name="l334"><span class="linenum"> 334</span></a>                              FROM T_comments
<a name="l335"><span class="linenum"> 335</span></a>                           WHERE comment_content LIKE '%\\\\\\\\\'%'
<a name="l336"><span class="linenum"> 336</span></a>                                   OR comment_content LIKE '%\\\\\\\\\&quot;%' &quot;;
<a name="l337"><span class="linenum"> 337</span></a>      <span class="comment">/* FP: the above looks overkill, but MySQL is really full of surprises...</span>
<a name="l338"><span class="linenum"> 338</span></a>  <span class="comment">                    tested on 4.0.14-nt */</span>
<a name="l339"><span class="linenum"> 339</span></a>  <span class="comment">    // echo $query;</span>
<a name="l340"><span class="linenum"> 340</span></a>      <a class="var it48" onMouseOver="hilite(48)" onMouseOut="lolite()" onClick="logVariable('rows')" href="../../_variables/rows.html">$rows</a> = <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_results')" href="../../_functions/get_results.html" onMouseOver="funcPopup(event,'get_results')">get_results</a>( <a class="var it1660" onMouseOver="hilite(1660)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../_variables/query.html">$query</a>, <a class="constant" onClick="logConstant('ARRAY_A')" href="../../_constants/ARRAY_A.html" onMouseOver="constPopup(event,'ARRAY_A')">ARRAY_A</a> );
<a name="l341"><span class="linenum"> 341</span></a>      if( <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('num_rows')" class="var it8966" onMouseOver="hilite(8966)" onMouseOut="lolite()" href="../../_variables/num_rows.html">num_rows</a> )
<a name="l342"><span class="linenum"> 342</span></a>      {
<a name="l343"><span class="linenum"> 343</span></a>          echo 'Updating '.<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('num_rows')" class="var it8966" onMouseOver="hilite(8966)" onMouseOut="lolite()" href="../../_variables/num_rows.html">num_rows</a>.' comments... ';
<a name="l344"><span class="linenum"> 344</span></a>          foreach( <a class="var it48" onMouseOver="hilite(48)" onMouseOut="lolite()" onClick="logVariable('rows')" href="../../_variables/rows.html">$rows</a> as <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a> )
<a name="l345"><span class="linenum"> 345</span></a>          {
<a name="l346"><span class="linenum"> 346</span></a>              <a class="var it1660" onMouseOver="hilite(1660)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../_variables/query.html">$query</a> = &quot;UPDATE T_comments
<a name="l347"><span class="linenum"> 347</span></a>                                  SET comment_content = &quot;.<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="phpfunction" onClick="logFunction('stripslashes')" href="../../_functions/stripslashes.html" onMouseOver="phpfuncPopup(event,'stripslashes')">stripslashes</a>( <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>['comment_content'] ) ).&quot;
<a name="l348"><span class="linenum"> 348</span></a>                                  WHERE comment_ID = &quot;.<a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('row')" href="../../_variables/row.html">$row</a>['comment_ID'];
<a name="l349"><span class="linenum"> 349</span></a>  <span class="comment">            // echo '&lt;br /&gt;'.$query;</span>
<a name="l350"><span class="linenum"> 350</span></a>              <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( <a class="var it1660" onMouseOver="hilite(1660)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../_variables/query.html">$query</a> );
<a name="l351"><span class="linenum"> 351</span></a>          }
<a name="l352"><span class="linenum"> 352</span></a>      }
<a name="l353"><span class="linenum"> 353</span></a>      <a class="function" onClick="logFunction('task_end')" href="../../_functions/task_end.html" onMouseOver="funcPopup(event,'task_end')">task_end</a>();
<a name="l354"><span class="linenum"> 354</span></a>  
<a name="l355"><span class="linenum"> 355</span></a>  }
<a name="l356"><span class="linenum"> 356</span></a>  
<a name="l357"><span class="linenum"> 357</span></a>  
<a name="l358"><span class="linenum"> 358</span></a>  <span class="comment">/**</span>
<a name="l359"><span class="linenum"> 359</span></a>  <span class="comment"> * Validate install requirements.</span>
<a name="l360"><span class="linenum"> 360</span></a>  <span class="comment"> *</span>
<a name="l361"><span class="linenum"> 361</span></a>  <span class="comment"> * @return array List of errors, empty array if ok.</span>
<a name="l362"><span class="linenum"> 362</span></a>  <span class="comment"> */</span>
<a name="l363"><span class="linenum"> 363</span></a>  function <a class="function" onClick="logFunction('install_validate_requirements')" href="../../_functions/install_validate_requirements.html" onMouseOver="funcPopup(event,'install_validate_requirements')">install_validate_requirements</a>()
<a name="l364"><span class="linenum"> 364</span></a>  {
<a name="l365"><span class="linenum"> 365</span></a>      <a class="var it1334" onMouseOver="hilite(1334)" onMouseOut="lolite()" onClick="logVariable('errors')" href="../../_variables/errors.html">$errors</a> = array();
<a name="l366"><span class="linenum"> 366</span></a>  
<a name="l367"><span class="linenum"> 367</span></a>      return <a class="var it1334" onMouseOver="hilite(1334)" onMouseOut="lolite()" onClick="logVariable('errors')" href="../../_variables/errors.html">$errors</a>;
<a name="l368"><span class="linenum"> 368</span></a>  }
<a name="l369"><span class="linenum"> 369</span></a>  
<a name="l370"><span class="linenum"> 370</span></a>  
<a name="l371"><span class="linenum"> 371</span></a>  <span class="comment">/**</span>
<a name="l372"><span class="linenum"> 372</span></a>  <span class="comment"> * Insert default locales into T_locales.</span>
<a name="l373"><span class="linenum"> 373</span></a>  <span class="comment"> */</span>
<a name="l374"><span class="linenum"> 374</span></a>  function <a class="function" onClick="logFunction('create_default_locales')" href="../../_functions/create_default_locales.html" onMouseOver="funcPopup(event,'create_default_locales')">create_default_locales</a>()
<a name="l375"><span class="linenum"> 375</span></a>  {
<a name="l376"><span class="linenum"> 376</span></a>      <a class="function" onClick="logFunction('task_begin')" href="../../_functions/task_begin.html" onMouseOver="funcPopup(event,'task_begin')">task_begin</a>( 'Activating default locales... ' );
<a name="l377"><span class="linenum"> 377</span></a>      <a class="function" onClick="logFunction('locale_insert_default')" href="../../_functions/locale_insert_default.html" onMouseOver="funcPopup(event,'locale_insert_default')">locale_insert_default</a>();
<a name="l378"><span class="linenum"> 378</span></a>      <a class="function" onClick="logFunction('task_end')" href="../../_functions/task_end.html" onMouseOver="funcPopup(event,'task_end')">task_end</a>();
<a name="l379"><span class="linenum"> 379</span></a>  }
<a name="l380"><span class="linenum"> 380</span></a>  
<a name="l381"><span class="linenum"> 381</span></a>  
<a name="l382"><span class="linenum"> 382</span></a>  <span class="comment">/**</span>
<a name="l383"><span class="linenum"> 383</span></a>  <span class="comment"> * Insert default settings into T_settings.</span>
<a name="l384"><span class="linenum"> 384</span></a>  <span class="comment"> *</span>
<a name="l385"><span class="linenum"> 385</span></a>  <span class="comment"> * It only writes those to DB, that get overridden (passed as array), or have</span>
<a name="l386"><span class="linenum"> 386</span></a>  <span class="comment"> * no default in {@link _generalsettings.class.php} / {@link GeneralSettings::default}.</span>
<a name="l387"><span class="linenum"> 387</span></a>  <span class="comment"> *</span>
<a name="l388"><span class="linenum"> 388</span></a>  <span class="comment"> * @param array associative array (settings name =&gt; value to use), allows</span>
<a name="l389"><span class="linenum"> 389</span></a>  <span class="comment"> *              overriding of defaults</span>
<a name="l390"><span class="linenum"> 390</span></a>  <span class="comment"> */</span>
<a name="l391"><span class="linenum"> 391</span></a>  function <a class="function" onClick="logFunction('create_default_settings')" href="../../_functions/create_default_settings.html" onMouseOver="funcPopup(event,'create_default_settings')">create_default_settings</a>( <a class="var it3653" onMouseOver="hilite(3653)" onMouseOut="lolite()" onClick="logVariable('override')" href="../../_variables/override.html">$override</a> = array() )
<a name="l392"><span class="linenum"> 392</span></a>  {
<a name="l393"><span class="linenum"> 393</span></a>      global <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>, <a class="var it4135" onMouseOver="hilite(4135)" onMouseOut="lolite()" onClick="logVariable('new_db_version')" href="../../_variables/new_db_version.html">$new_db_version</a>, <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a>;
<a name="l394"><span class="linenum"> 394</span></a>      global <a class="var it4802" onMouseOver="hilite(4802)" onMouseOut="lolite()" onClick="logVariable('Group_Admins')" href="../../_variables/Group_Admins.html">$Group_Admins</a>, <a class="var it4803" onMouseOver="hilite(4803)" onMouseOut="lolite()" onClick="logVariable('Group_Privileged')" href="../../_variables/Group_Privileged.html">$Group_Privileged</a>, <a class="var it4804" onMouseOver="hilite(4804)" onMouseOut="lolite()" onClick="logVariable('Group_Bloggers')" href="../../_variables/Group_Bloggers.html">$Group_Bloggers</a>, <a class="var it4805" onMouseOver="hilite(4805)" onMouseOut="lolite()" onClick="logVariable('Group_Users')" href="../../_variables/Group_Users.html">$Group_Users</a>, <a class="var it4806" onMouseOver="hilite(4806)" onMouseOut="lolite()" onClick="logVariable('Group_Suspect')" href="../../_variables/Group_Suspect.html">$Group_Suspect</a>, <a class="var it4807" onMouseOver="hilite(4807)" onMouseOut="lolite()" onClick="logVariable('Group_Spam')" href="../../_variables/Group_Spam.html">$Group_Spam</a>;
<a name="l395"><span class="linenum"> 395</span></a>      global <a class="var it2140" onMouseOver="hilite(2140)" onMouseOut="lolite()" onClick="logVariable('test_install_all_features')" href="../../_variables/test_install_all_features.html">$test_install_all_features</a>, <a class="var it6544" onMouseOver="hilite(6544)" onMouseOut="lolite()" onClick="logVariable('create_sample_contents')" href="../../_variables/create_sample_contents.html">$create_sample_contents</a>, <a class="var it4834" onMouseOver="hilite(4834)" onMouseOut="lolite()" onClick="logVariable('local_installation')" href="../../_variables/local_installation.html">$local_installation</a>;
<a name="l396"><span class="linenum"> 396</span></a>  
<a name="l397"><span class="linenum"> 397</span></a>      <a class="var it2413" onMouseOver="hilite(2413)" onMouseOut="lolite()" onClick="logVariable('defaults')" href="../../_variables/defaults.html">$defaults</a> = array(
<a name="l398"><span class="linenum"> 398</span></a>          'db_version' =&gt; <a class="var it4135" onMouseOver="hilite(4135)" onMouseOut="lolite()" onClick="logVariable('new_db_version')" href="../../_variables/new_db_version.html">$new_db_version</a>,
<a name="l399"><span class="linenum"> 399</span></a>          'default_locale' =&gt; <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a>,
<a name="l400"><span class="linenum"> 400</span></a>          'newusers_grp_ID' =&gt; <a class="var it4805" onMouseOver="hilite(4805)" onMouseOut="lolite()" onClick="logVariable('Group_Users')" href="../../_variables/Group_Users.html">$Group_Users</a>-&gt;<a onClick="logVariable('ID')" class="var it9077" onMouseOver="hilite(9077)" onMouseOut="lolite()" href="../../_variables/ID.html">ID</a>,
<a name="l401"><span class="linenum"> 401</span></a>          'default_blog_ID' =&gt; 1,
<a name="l402"><span class="linenum"> 402</span></a>          'evocache_foldername' =&gt; '_evocache',
<a name="l403"><span class="linenum"> 403</span></a>      );
<a name="l404"><span class="linenum"> 404</span></a>      if( <a class="var it2140" onMouseOver="hilite(2140)" onMouseOut="lolite()" onClick="logVariable('test_install_all_features')" href="../../_variables/test_install_all_features.html">$test_install_all_features</a> )
<a name="l405"><span class="linenum"> 405</span></a>      {
<a name="l406"><span class="linenum"> 406</span></a>          <a class="var it2413" onMouseOver="hilite(2413)" onMouseOut="lolite()" onClick="logVariable('defaults')" href="../../_variables/defaults.html">$defaults</a>['gender_colored'] = 1;
<a name="l407"><span class="linenum"> 407</span></a>          <a class="var it2413" onMouseOver="hilite(2413)" onMouseOut="lolite()" onClick="logVariable('defaults')" href="../../_variables/defaults.html">$defaults</a>['newusers_canregister'] = 1;
<a name="l408"><span class="linenum"> 408</span></a>          <a class="var it2413" onMouseOver="hilite(2413)" onMouseOut="lolite()" onClick="logVariable('defaults')" href="../../_variables/defaults.html">$defaults</a>['registration_require_country'] = 1;
<a name="l409"><span class="linenum"> 409</span></a>          <a class="var it2413" onMouseOver="hilite(2413)" onMouseOut="lolite()" onClick="logVariable('defaults')" href="../../_variables/defaults.html">$defaults</a>['registration_require_gender'] = 'required';
<a name="l410"><span class="linenum"> 410</span></a>          <a class="var it2413" onMouseOver="hilite(2413)" onMouseOut="lolite()" onClick="logVariable('defaults')" href="../../_variables/defaults.html">$defaults</a>['location_country'] = 'required';
<a name="l411"><span class="linenum"> 411</span></a>          <a class="var it2413" onMouseOver="hilite(2413)" onMouseOut="lolite()" onClick="logVariable('defaults')" href="../../_variables/defaults.html">$defaults</a>['location_region'] = 'required';
<a name="l412"><span class="linenum"> 412</span></a>          <a class="var it2413" onMouseOver="hilite(2413)" onMouseOut="lolite()" onClick="logVariable('defaults')" href="../../_variables/defaults.html">$defaults</a>['location_subregion'] = 'required';
<a name="l413"><span class="linenum"> 413</span></a>          <a class="var it2413" onMouseOver="hilite(2413)" onMouseOut="lolite()" onClick="logVariable('defaults')" href="../../_variables/defaults.html">$defaults</a>['location_city'] = 'required';
<a name="l414"><span class="linenum"> 414</span></a>      }
<a name="l415"><span class="linenum"> 415</span></a>      if( <a class="var it6544" onMouseOver="hilite(6544)" onMouseOut="lolite()" onClick="logVariable('create_sample_contents')" href="../../_variables/create_sample_contents.html">$create_sample_contents</a> )
<a name="l416"><span class="linenum"> 416</span></a>      {
<a name="l417"><span class="linenum"> 417</span></a>          <a class="var it2413" onMouseOver="hilite(2413)" onMouseOut="lolite()" onClick="logVariable('defaults')" href="../../_variables/defaults.html">$defaults</a>['info_blog_ID'] = '3';
<a name="l418"><span class="linenum"> 418</span></a>      }
<a name="l419"><span class="linenum"> 419</span></a>      if( !empty( <a class="var it4806" onMouseOver="hilite(4806)" onMouseOut="lolite()" onClick="logVariable('Group_Suspect')" href="../../_variables/Group_Suspect.html">$Group_Suspect</a> ) )
<a name="l420"><span class="linenum"> 420</span></a>      { // Set default antispam suspicious group
<a name="l421"><span class="linenum"> 421</span></a>          <a class="var it2413" onMouseOver="hilite(2413)" onMouseOut="lolite()" onClick="logVariable('defaults')" href="../../_variables/defaults.html">$defaults</a>['antispam_suspicious_group'] = <a class="var it4806" onMouseOver="hilite(4806)" onMouseOut="lolite()" onClick="logVariable('Group_Suspect')" href="../../_variables/Group_Suspect.html">$Group_Suspect</a>-&gt;<a onClick="logVariable('ID')" class="var it9078" onMouseOver="hilite(9078)" onMouseOut="lolite()" href="../../_variables/ID.html">ID</a>;
<a name="l422"><span class="linenum"> 422</span></a>      }
<a name="l423"><span class="linenum"> 423</span></a>      <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('antispam_trust_groups')" href="../../_variables/antispam_trust_groups.html">$antispam_trust_groups</a> = array();
<a name="l424"><span class="linenum"> 424</span></a>      if( !empty( <a class="var it4802" onMouseOver="hilite(4802)" onMouseOut="lolite()" onClick="logVariable('Group_Admins')" href="../../_variables/Group_Admins.html">$Group_Admins</a> ) )
<a name="l425"><span class="linenum"> 425</span></a>      {
<a name="l426"><span class="linenum"> 426</span></a>          <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('antispam_trust_groups')" href="../../_variables/antispam_trust_groups.html">$antispam_trust_groups</a>[] = <a class="var it4802" onMouseOver="hilite(4802)" onMouseOut="lolite()" onClick="logVariable('Group_Admins')" href="../../_variables/Group_Admins.html">$Group_Admins</a>-&gt;<a onClick="logVariable('ID')" class="var it9074" onMouseOver="hilite(9074)" onMouseOut="lolite()" href="../../_variables/ID.html">ID</a>;
<a name="l427"><span class="linenum"> 427</span></a>      }
<a name="l428"><span class="linenum"> 428</span></a>      if( !empty( <a class="var it4803" onMouseOver="hilite(4803)" onMouseOut="lolite()" onClick="logVariable('Group_Privileged')" href="../../_variables/Group_Privileged.html">$Group_Privileged</a> ) )
<a name="l429"><span class="linenum"> 429</span></a>      {
<a name="l430"><span class="linenum"> 430</span></a>          <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('antispam_trust_groups')" href="../../_variables/antispam_trust_groups.html">$antispam_trust_groups</a>[] = <a class="var it4803" onMouseOver="hilite(4803)" onMouseOut="lolite()" onClick="logVariable('Group_Privileged')" href="../../_variables/Group_Privileged.html">$Group_Privileged</a>-&gt;<a onClick="logVariable('ID')" class="var it9075" onMouseOver="hilite(9075)" onMouseOut="lolite()" href="../../_variables/ID.html">ID</a>;
<a name="l431"><span class="linenum"> 431</span></a>      }
<a name="l432"><span class="linenum"> 432</span></a>      if( !empty( <a class="var it4804" onMouseOver="hilite(4804)" onMouseOut="lolite()" onClick="logVariable('Group_Bloggers')" href="../../_variables/Group_Bloggers.html">$Group_Bloggers</a> ) )
<a name="l433"><span class="linenum"> 433</span></a>      {
<a name="l434"><span class="linenum"> 434</span></a>          <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('antispam_trust_groups')" href="../../_variables/antispam_trust_groups.html">$antispam_trust_groups</a>[] = <a class="var it4804" onMouseOver="hilite(4804)" onMouseOut="lolite()" onClick="logVariable('Group_Bloggers')" href="../../_variables/Group_Bloggers.html">$Group_Bloggers</a>-&gt;<a onClick="logVariable('ID')" class="var it9076" onMouseOver="hilite(9076)" onMouseOut="lolite()" href="../../_variables/ID.html">ID</a>;
<a name="l435"><span class="linenum"> 435</span></a>      }
<a name="l436"><span class="linenum"> 436</span></a>      if( !empty( <a class="var it4807" onMouseOver="hilite(4807)" onMouseOut="lolite()" onClick="logVariable('Group_Spam')" href="../../_variables/Group_Spam.html">$Group_Spam</a> ) )
<a name="l437"><span class="linenum"> 437</span></a>      {
<a name="l438"><span class="linenum"> 438</span></a>          <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('antispam_trust_groups')" href="../../_variables/antispam_trust_groups.html">$antispam_trust_groups</a>[] = <a class="var it4807" onMouseOver="hilite(4807)" onMouseOut="lolite()" onClick="logVariable('Group_Spam')" href="../../_variables/Group_Spam.html">$Group_Spam</a>-&gt;<a onClick="logVariable('ID')" class="var it9082" onMouseOver="hilite(9082)" onMouseOut="lolite()" href="../../_variables/ID.html">ID</a>;
<a name="l439"><span class="linenum"> 439</span></a>      }
<a name="l440"><span class="linenum"> 440</span></a>      if( <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>( <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('antispam_trust_groups')" href="../../_variables/antispam_trust_groups.html">$antispam_trust_groups</a> ) &gt; 0 )
<a name="l441"><span class="linenum"> 441</span></a>      { // Set default antispam trust group
<a name="l442"><span class="linenum"> 442</span></a>          <a class="var it2413" onMouseOver="hilite(2413)" onMouseOut="lolite()" onClick="logVariable('defaults')" href="../../_variables/defaults.html">$defaults</a>['antispam_trust_groups'] = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( ',', <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('antispam_trust_groups')" href="../../_variables/antispam_trust_groups.html">$antispam_trust_groups</a> );
<a name="l443"><span class="linenum"> 443</span></a>      }
<a name="l444"><span class="linenum"> 444</span></a>      if( <a class="var it4834" onMouseOver="hilite(4834)" onMouseOut="lolite()" onClick="logVariable('local_installation')" href="../../_variables/local_installation.html">$local_installation</a> )
<a name="l445"><span class="linenum"> 445</span></a>      { // Current installation is local
<a name="l446"><span class="linenum"> 446</span></a>  <span class="comment">        // Turn off gravatar and use 'Default gravatars' = 'Gravatar'</span>
<a name="l447"><span class="linenum"> 447</span></a>          <a class="var it2413" onMouseOver="hilite(2413)" onMouseOut="lolite()" onClick="logVariable('defaults')" href="../../_variables/defaults.html">$defaults</a>['use_gravatar'] = 0;
<a name="l448"><span class="linenum"> 448</span></a>          <a class="var it2413" onMouseOver="hilite(2413)" onMouseOut="lolite()" onClick="logVariable('defaults')" href="../../_variables/defaults.html">$defaults</a>['default_gravatar'] = '';
<a name="l449"><span class="linenum"> 449</span></a>      }
<a name="l450"><span class="linenum"> 450</span></a>  
<a name="l451"><span class="linenum"> 451</span></a>      <a class="var it5294" onMouseOver="hilite(5294)" onMouseOut="lolite()" onClick="logVariable('settings')" href="../../_variables/settings.html">$settings</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it2413" onMouseOver="hilite(2413)" onMouseOut="lolite()" onClick="logVariable('defaults')" href="../../_variables/defaults.html">$defaults</a>), <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>(<a class="var it3653" onMouseOver="hilite(3653)" onMouseOut="lolite()" onClick="logVariable('override')" href="../../_variables/override.html">$override</a>) );
<a name="l452"><span class="linenum"> 452</span></a>      <a class="var it5294" onMouseOver="hilite(5294)" onMouseOut="lolite()" onClick="logVariable('settings')" href="../../_variables/settings.html">$settings</a> = <a class="phpfunction" onClick="logFunction('array_unique')" href="../../_functions/array_unique.html" onMouseOver="phpfuncPopup(event,'array_unique')">array_unique</a>( <a class="var it5294" onMouseOver="hilite(5294)" onMouseOut="lolite()" onClick="logVariable('settings')" href="../../_variables/settings.html">$settings</a> );
<a name="l453"><span class="linenum"> 453</span></a>      <a class="var it6545" onMouseOver="hilite(6545)" onMouseOut="lolite()" onClick="logVariable('insertvalues')" href="../../_variables/insertvalues.html">$insertvalues</a> = array();
<a name="l454"><span class="linenum"> 454</span></a>      foreach( <a class="var it5294" onMouseOver="hilite(5294)" onMouseOut="lolite()" onClick="logVariable('settings')" href="../../_variables/settings.html">$settings</a> as <a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a> )
<a name="l455"><span class="linenum"> 455</span></a>      {
<a name="l456"><span class="linenum"> 456</span></a>          if( isset(<a class="var it3653" onMouseOver="hilite(3653)" onMouseOut="lolite()" onClick="logVariable('override')" href="../../_variables/override.html">$override</a>[<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>]) )
<a name="l457"><span class="linenum"> 457</span></a>          {
<a name="l458"><span class="linenum"> 458</span></a>              <a class="var it6545" onMouseOver="hilite(6545)" onMouseOut="lolite()" onClick="logVariable('insertvalues')" href="../../_variables/insertvalues.html">$insertvalues</a>[] = '('.<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>(<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>).', '.<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>(<a class="var it3653" onMouseOver="hilite(3653)" onMouseOut="lolite()" onClick="logVariable('override')" href="../../_variables/override.html">$override</a>[<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>]).')';
<a name="l459"><span class="linenum"> 459</span></a>          }
<a name="l460"><span class="linenum"> 460</span></a>          else
<a name="l461"><span class="linenum"> 461</span></a>          {
<a name="l462"><span class="linenum"> 462</span></a>              <a class="var it6545" onMouseOver="hilite(6545)" onMouseOut="lolite()" onClick="logVariable('insertvalues')" href="../../_variables/insertvalues.html">$insertvalues</a>[] = '('.<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>(<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>).', '.<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>(<a class="var it2413" onMouseOver="hilite(2413)" onMouseOut="lolite()" onClick="logVariable('defaults')" href="../../_variables/defaults.html">$defaults</a>[<a class="var it134" onMouseOver="hilite(134)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>]).')';
<a name="l463"><span class="linenum"> 463</span></a>          }
<a name="l464"><span class="linenum"> 464</span></a>      }
<a name="l465"><span class="linenum"> 465</span></a>  
<a name="l466"><span class="linenum"> 466</span></a>      <a class="function" onClick="logFunction('task_begin')" href="../../_functions/task_begin.html" onMouseOver="funcPopup(event,'task_begin')">task_begin</a>( 'Creating default settings'.( <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it3653" onMouseOver="hilite(3653)" onMouseOut="lolite()" onClick="logVariable('override')" href="../../_variables/override.html">$override</a>) ? ' (with '.<a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it3653" onMouseOver="hilite(3653)" onMouseOut="lolite()" onClick="logVariable('override')" href="../../_variables/override.html">$override</a>).' existing values)' : '' ).'... ' );
<a name="l467"><span class="linenum"> 467</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>(
<a name="l468"><span class="linenum"> 468</span></a>          &quot;INSERT INTO T_settings (set_name, set_value)
<a name="l469"><span class="linenum"> 469</span></a>          VALUES &quot;.<a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( ', ', <a class="var it6545" onMouseOver="hilite(6545)" onMouseOut="lolite()" onClick="logVariable('insertvalues')" href="../../_variables/insertvalues.html">$insertvalues</a> ) );
<a name="l470"><span class="linenum"> 470</span></a>      <a class="function" onClick="logFunction('task_end')" href="../../_functions/task_end.html" onMouseOver="funcPopup(event,'task_end')">task_end</a>();
<a name="l471"><span class="linenum"> 471</span></a>  }
<a name="l472"><span class="linenum"> 472</span></a>  
<a name="l473"><span class="linenum"> 473</span></a>  
<a name="l474"><span class="linenum"> 474</span></a>  <span class="comment">/**</span>
<a name="l475"><span class="linenum"> 475</span></a>  <span class="comment"> * Install basic skins.</span>
<a name="l476"><span class="linenum"> 476</span></a>  <span class="comment"> */</span>
<a name="l477"><span class="linenum"> 477</span></a>  function <a class="function" onClick="logFunction('install_basic_skins')" href="../../_functions/install_basic_skins.html" onMouseOver="funcPopup(event,'install_basic_skins')">install_basic_skins</a>( <a class="var it6546" onMouseOver="hilite(6546)" onMouseOut="lolite()" onClick="logVariable('install_mobile_skins')" href="../../_variables/install_mobile_skins.html">$install_mobile_skins</a> = true )
<a name="l478"><span class="linenum"> 478</span></a>  {
<a name="l479"><span class="linenum"> 479</span></a>      <a class="function" onClick="logFunction('load_funcs')" href="../../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>( 'skins/_skin.funcs.php' );
<a name="l480"><span class="linenum"> 480</span></a>  
<a name="l481"><span class="linenum"> 481</span></a>      <a class="function" onClick="logFunction('task_begin')" href="../../_functions/task_begin.html" onMouseOver="funcPopup(event,'task_begin')">task_begin</a>( 'Installing default skins... ' );
<a name="l482"><span class="linenum"> 482</span></a>  
<a name="l483"><span class="linenum"> 483</span></a>  <span class="comment">    // Note: Skin #1 will we used by Blog A</span>
<a name="l484"><span class="linenum"> 484</span></a>      skin_install( 'evopress' );
<a name="l485"><span class="linenum"> 485</span></a>  
<a name="l486"><span class="linenum"> 486</span></a>  <span class="comment">    // Note: Skin #2 will we used by Blog B</span>
<a name="l487"><span class="linenum"> 487</span></a>      skin_install( 'evocamp' );
<a name="l488"><span class="linenum"> 488</span></a>  
<a name="l489"><span class="linenum"> 489</span></a>  <span class="comment">    // Note: Skin #3 will we used by Linkblog</span>
<a name="l490"><span class="linenum"> 490</span></a>      skin_install( 'miami_blue' );
<a name="l491"><span class="linenum"> 491</span></a>  
<a name="l492"><span class="linenum"> 492</span></a>  <span class="comment">    // Note: Skin #4 will we used by Photos</span>
<a name="l493"><span class="linenum"> 493</span></a>      skin_install( 'photoalbums' );
<a name="l494"><span class="linenum"> 494</span></a>  
<a name="l495"><span class="linenum"> 495</span></a>  <span class="comment">    // Note: Skin #5 will we used by Forums</span>
<a name="l496"><span class="linenum"> 496</span></a>      skin_install( 'pureforums' );
<a name="l497"><span class="linenum"> 497</span></a>  
<a name="l498"><span class="linenum"> 498</span></a>  <span class="comment">    // Note: Skin #6 will we used by Manual</span>
<a name="l499"><span class="linenum"> 499</span></a>      skin_install( 'manual' );
<a name="l500"><span class="linenum"> 500</span></a>  
<a name="l501"><span class="linenum"> 501</span></a>      skin_install( 'asevo' );
<a name="l502"><span class="linenum"> 502</span></a>      skin_install( 'bootstrap' );
<a name="l503"><span class="linenum"> 503</span></a>      skin_install( 'custom' );
<a name="l504"><span class="linenum"> 504</span></a>      skin_install( 'dating_mood' );
<a name="l505"><span class="linenum"> 505</span></a>      skin_install( 'forums' );
<a name="l506"><span class="linenum"> 506</span></a>      skin_install( 'glossyblue' );
<a name="l507"><span class="linenum"> 507</span></a>      skin_install( 'intense' );
<a name="l508"><span class="linenum"> 508</span></a>      skin_install( 'natural_pink' );
<a name="l509"><span class="linenum"> 509</span></a>      skin_install( 'nifty_corners' );
<a name="l510"><span class="linenum"> 510</span></a>      skin_install( 'photoblog' );
<a name="l511"><span class="linenum"> 511</span></a>      skin_install( 'pixelgreen' );
<a name="l512"><span class="linenum"> 512</span></a>      skin_install( 'pluralism' );
<a name="l513"><span class="linenum"> 513</span></a>      skin_install( 'terrafirma' );
<a name="l514"><span class="linenum"> 514</span></a>      if( <a class="var it6546" onMouseOver="hilite(6546)" onMouseOut="lolite()" onClick="logVariable('install_mobile_skins')" href="../../_variables/install_mobile_skins.html">$install_mobile_skins</a> )
<a name="l515"><span class="linenum"> 515</span></a>      {
<a name="l516"><span class="linenum"> 516</span></a>          skin_install( 'touch' );
<a name="l517"><span class="linenum"> 517</span></a>      }
<a name="l518"><span class="linenum"> 518</span></a>      skin_install( 'vastitude' );
<a name="l519"><span class="linenum"> 519</span></a>      skin_install( '_atom' );
<a name="l520"><span class="linenum"> 520</span></a>      skin_install( '_rss2' );
<a name="l521"><span class="linenum"> 521</span></a>  
<a name="l522"><span class="linenum"> 522</span></a>      <a class="function" onClick="logFunction('task_end')" href="../../_functions/task_end.html" onMouseOver="funcPopup(event,'task_end')">task_end</a>();
<a name="l523"><span class="linenum"> 523</span></a>  }
<a name="l524"><span class="linenum"> 524</span></a>  
<a name="l525"><span class="linenum"> 525</span></a>  
<a name="l526"><span class="linenum"> 526</span></a>  <span class="comment">/**</span>
<a name="l527"><span class="linenum"> 527</span></a>  <span class="comment"> * Install basic plugins.</span>
<a name="l528"><span class="linenum"> 528</span></a>  <span class="comment"> *</span>
<a name="l529"><span class="linenum"> 529</span></a>  <span class="comment"> * This gets called separately on fresh installs.</span>
<a name="l530"><span class="linenum"> 530</span></a>  <span class="comment"> *</span>
<a name="l531"><span class="linenum"> 531</span></a>  <span class="comment"> * {@internal</span>
<a name="l532"><span class="linenum"> 532</span></a>  <span class="comment"> * NOTE: this won't call the &quot;AfterInstall&quot; method on the plugin nor install its DB schema.</span>
<a name="l533"><span class="linenum"> 533</span></a>  <span class="comment"> *       This get done in the plugins controller, on manually installing a plugin.</span>
<a name="l534"><span class="linenum"> 534</span></a>  <span class="comment"> *</span>
<a name="l535"><span class="linenum"> 535</span></a>  <span class="comment"> * If you change the plugins here, please also adjust {@link InstallUnitTestCase::basic_plugins}.</span>
<a name="l536"><span class="linenum"> 536</span></a>  <span class="comment"> * }}</span>
<a name="l537"><span class="linenum"> 537</span></a>  <span class="comment"> *</span>
<a name="l538"><span class="linenum"> 538</span></a>  <span class="comment"> * @param integer Old DB version, so that only new plugins gets installed</span>
<a name="l539"><span class="linenum"> 539</span></a>  <span class="comment"> */</span>
<a name="l540"><span class="linenum"> 540</span></a>  function <a class="function" onClick="logFunction('install_basic_plugins')" href="../../_functions/install_basic_plugins.html" onMouseOver="funcPopup(event,'install_basic_plugins')">install_basic_plugins</a>( <a class="var it5443" onMouseOver="hilite(5443)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../../_variables/old_db_version.html">$old_db_version</a> = 0 )
<a name="l541"><span class="linenum"> 541</span></a>  {
<a name="l542"><span class="linenum"> 542</span></a>      <span class="comment">/**</span>
<a name="l543"><span class="linenum"> 543</span></a>  <span class="comment">     * @var Plugins_admin</span>
<a name="l544"><span class="linenum"> 544</span></a>  <span class="comment">     */</span>
<a name="l545"><span class="linenum"> 545</span></a>      global <a class="var it39" onMouseOver="hilite(39)" onMouseOut="lolite()" onClick="logVariable('Plugins_admin')" href="../../_variables/Plugins_admin.html">$Plugins_admin</a>, <a class="var it2140" onMouseOver="hilite(2140)" onMouseOut="lolite()" onClick="logVariable('test_install_all_features')" href="../../_variables/test_install_all_features.html">$test_install_all_features</a>;
<a name="l546"><span class="linenum"> 546</span></a>  
<a name="l547"><span class="linenum"> 547</span></a>      <a class="var it39" onMouseOver="hilite(39)" onMouseOut="lolite()" onClick="logVariable('Plugins_admin')" href="../../_variables/Plugins_admin.html">$Plugins_admin</a> = &amp; get_Plugins_admin();
<a name="l548"><span class="linenum"> 548</span></a>  
<a name="l549"><span class="linenum"> 549</span></a>  <span class="comment">    // Create global $Plugins instance, which is required during installation of basic plugins,</span>
<a name="l550"><span class="linenum"> 550</span></a>  <span class="comment">    // not only for the ones getting installed, but also during e.g. count_regs(), which instantiates</span>
<a name="l551"><span class="linenum"> 551</span></a>  <span class="comment">    // each plugin (which may then use (User)Settings in PluginInit (through Plugin::__get)).</span>
<a name="l552"><span class="linenum"> 552</span></a>      <a class="var it542" onMouseOver="hilite(542)" onMouseOut="lolite()" onClick="logVariable('GLOBALS')" href="../../_variables/GLOBALS.html">$GLOBALS</a>['Plugins'] = &amp; <a class="var it39" onMouseOver="hilite(39)" onMouseOut="lolite()" onClick="logVariable('Plugins_admin')" href="../../_variables/Plugins_admin.html">$Plugins_admin</a>;
<a name="l553"><span class="linenum"> 553</span></a>  
<a name="l554"><span class="linenum"> 554</span></a>      if( <a class="var it5443" onMouseOver="hilite(5443)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../../_variables/old_db_version.html">$old_db_version</a> &lt; 9100 )
<a name="l555"><span class="linenum"> 555</span></a>      {
<a name="l556"><span class="linenum"> 556</span></a>  <span class="comment">        // Toolbars:</span>
<a name="l557"><span class="linenum"> 557</span></a>          <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'quicktags_plugin' );
<a name="l558"><span class="linenum"> 558</span></a>          <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'shortcodes_plugin' );
<a name="l559"><span class="linenum"> 559</span></a>  <span class="comment">        // Renderers:</span>
<a name="l560"><span class="linenum"> 560</span></a>          <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'auto_p_plugin' );
<a name="l561"><span class="linenum"> 561</span></a>          <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'autolinks_plugin' );
<a name="l562"><span class="linenum"> 562</span></a>          <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'texturize_plugin' );
<a name="l563"><span class="linenum"> 563</span></a>  
<a name="l564"><span class="linenum"> 564</span></a>  <span class="comment">        // SkinTags:</span>
<a name="l565"><span class="linenum"> 565</span></a>          <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'calendar_plugin' );
<a name="l566"><span class="linenum"> 566</span></a>          <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'archives_plugin' );
<a name="l567"><span class="linenum"> 567</span></a>      }
<a name="l568"><span class="linenum"> 568</span></a>  
<a name="l569"><span class="linenum"> 569</span></a>      if( <a class="var it5443" onMouseOver="hilite(5443)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../../_variables/old_db_version.html">$old_db_version</a> &lt; 9290 )
<a name="l570"><span class="linenum"> 570</span></a>      {
<a name="l571"><span class="linenum"> 571</span></a>          <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'smilies_plugin' );
<a name="l572"><span class="linenum"> 572</span></a>          <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'videoplug_plugin' );
<a name="l573"><span class="linenum"> 573</span></a>      }
<a name="l574"><span class="linenum"> 574</span></a>  
<a name="l575"><span class="linenum"> 575</span></a>      if( <a class="var it5443" onMouseOver="hilite(5443)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../../_variables/old_db_version.html">$old_db_version</a> &lt; 9330 )
<a name="l576"><span class="linenum"> 576</span></a>      { // Upgrade to 1.9-beta
<a name="l577"><span class="linenum"> 577</span></a>          <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'ping_b2evonet_plugin' );
<a name="l578"><span class="linenum"> 578</span></a>          <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'ping_pingomatic_plugin' );
<a name="l579"><span class="linenum"> 579</span></a>      }
<a name="l580"><span class="linenum"> 580</span></a>  
<a name="l581"><span class="linenum"> 581</span></a>      if( <a class="var it5443" onMouseOver="hilite(5443)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../../_variables/old_db_version.html">$old_db_version</a> &lt; 9930 )
<a name="l582"><span class="linenum"> 582</span></a>      { // Upgrade to 3.1.0
<a name="l583"><span class="linenum"> 583</span></a>          <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'tinymce_plugin' );
<a name="l584"><span class="linenum"> 584</span></a>      }
<a name="l585"><span class="linenum"> 585</span></a>  
<a name="l586"><span class="linenum"> 586</span></a>      if( <a class="var it5443" onMouseOver="hilite(5443)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../../_variables/old_db_version.html">$old_db_version</a> &lt; 9940 )
<a name="l587"><span class="linenum"> 587</span></a>      { // Upgrade to 3.2.0
<a name="l588"><span class="linenum"> 588</span></a>          <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'twitter_plugin' );
<a name="l589"><span class="linenum"> 589</span></a>      }
<a name="l590"><span class="linenum"> 590</span></a>  
<a name="l591"><span class="linenum"> 591</span></a>      if( <a class="var it5443" onMouseOver="hilite(5443)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../../_variables/old_db_version.html">$old_db_version</a> &lt; 10300 )
<a name="l592"><span class="linenum"> 592</span></a>      { // Upgrade to 5.0.0
<a name="l593"><span class="linenum"> 593</span></a>          <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'flowplayer_plugin' );
<a name="l594"><span class="linenum"> 594</span></a>  
<a name="l595"><span class="linenum"> 595</span></a>          if( <a class="var it2140" onMouseOver="hilite(2140)" onMouseOut="lolite()" onClick="logVariable('test_install_all_features')" href="../../_variables/test_install_all_features.html">$test_install_all_features</a> )
<a name="l596"><span class="linenum"> 596</span></a>          {
<a name="l597"><span class="linenum"> 597</span></a>              <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'google_maps_plugin' );
<a name="l598"><span class="linenum"> 598</span></a>          }
<a name="l599"><span class="linenum"> 599</span></a>      }
<a name="l600"><span class="linenum"> 600</span></a>  
<a name="l601"><span class="linenum"> 601</span></a>      if( <a class="var it5443" onMouseOver="hilite(5443)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../../_variables/old_db_version.html">$old_db_version</a> &lt; 11000 )
<a name="l602"><span class="linenum"> 602</span></a>      { // Upgrade to 5.0.0-alpha-4
<a name="l603"><span class="linenum"> 603</span></a>          <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'captcha_qstn_plugin' );
<a name="l604"><span class="linenum"> 604</span></a>      }
<a name="l605"><span class="linenum"> 605</span></a>  
<a name="l606"><span class="linenum"> 606</span></a>      if( <a class="var it5443" onMouseOver="hilite(5443)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../../_variables/old_db_version.html">$old_db_version</a> &lt; 11100 )
<a name="l607"><span class="linenum"> 607</span></a>      { // Upgrade to 5.0.1-alpha-5
<a name="l608"><span class="linenum"> 608</span></a>          <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'bbcode_plugin', <a class="var it2140" onMouseOver="hilite(2140)" onMouseOut="lolite()" onClick="logVariable('test_install_all_features')" href="../../_variables/test_install_all_features.html">$test_install_all_features</a> );
<a name="l609"><span class="linenum"> 609</span></a>          <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'star_plugin', <a class="var it2140" onMouseOver="hilite(2140)" onMouseOut="lolite()" onClick="logVariable('test_install_all_features')" href="../../_variables/test_install_all_features.html">$test_install_all_features</a> );
<a name="l610"><span class="linenum"> 610</span></a>          <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'prism_plugin', <a class="var it2140" onMouseOver="hilite(2140)" onMouseOut="lolite()" onClick="logVariable('test_install_all_features')" href="../../_variables/test_install_all_features.html">$test_install_all_features</a> );
<a name="l611"><span class="linenum"> 611</span></a>          <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'code_highlight_plugin', <a class="var it2140" onMouseOver="hilite(2140)" onMouseOut="lolite()" onClick="logVariable('test_install_all_features')" href="../../_variables/test_install_all_features.html">$test_install_all_features</a> );
<a name="l612"><span class="linenum"> 612</span></a>          <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'markdown_plugin' );
<a name="l613"><span class="linenum"> 613</span></a>          <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( 'infodots_plugin', <a class="var it2140" onMouseOver="hilite(2140)" onMouseOut="lolite()" onClick="logVariable('test_install_all_features')" href="../../_variables/test_install_all_features.html">$test_install_all_features</a> );
<a name="l614"><span class="linenum"> 614</span></a>      }
<a name="l615"><span class="linenum"> 615</span></a>  }
<a name="l616"><span class="linenum"> 616</span></a>  
<a name="l617"><span class="linenum"> 617</span></a>  
<a name="l618"><span class="linenum"> 618</span></a>  <span class="comment">/**</span>
<a name="l619"><span class="linenum"> 619</span></a>  <span class="comment"> * Install plugin</span>
<a name="l620"><span class="linenum"> 620</span></a>  <span class="comment"> *</span>
<a name="l621"><span class="linenum"> 621</span></a>  <span class="comment"> * @param string Plugin name</span>
<a name="l622"><span class="linenum"> 622</span></a>  <span class="comment"> * @param boolean TRUE - to activate plugin</span>
<a name="l623"><span class="linenum"> 623</span></a>  <span class="comment"> * @return true on success</span>
<a name="l624"><span class="linenum"> 624</span></a>  <span class="comment"> */</span>
<a name="l625"><span class="linenum"> 625</span></a>  function <a class="function" onClick="logFunction('install_plugin')" href="../../_functions/install_plugin.html" onMouseOver="funcPopup(event,'install_plugin')">install_plugin</a>( <a class="var it3618" onMouseOver="hilite(3618)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../_variables/plugin.html">$plugin</a>, <a class="var it6547" onMouseOver="hilite(6547)" onMouseOut="lolite()" onClick="logVariable('activate')" href="../../_variables/activate.html">$activate</a> = true )
<a name="l626"><span class="linenum"> 626</span></a>  {
<a name="l627"><span class="linenum"> 627</span></a>      <span class="comment">/**</span>
<a name="l628"><span class="linenum"> 628</span></a>  <span class="comment">     * @var Plugins_admin</span>
<a name="l629"><span class="linenum"> 629</span></a>  <span class="comment">     */</span>
<a name="l630"><span class="linenum"> 630</span></a>      global <a class="var it39" onMouseOver="hilite(39)" onMouseOut="lolite()" onClick="logVariable('Plugins_admin')" href="../../_variables/Plugins_admin.html">$Plugins_admin</a>;
<a name="l631"><span class="linenum"> 631</span></a>  
<a name="l632"><span class="linenum"> 632</span></a>      <a class="function" onClick="logFunction('task_begin')" href="../../_functions/task_begin.html" onMouseOver="funcPopup(event,'task_begin')">task_begin</a>( 'Installing plugin: '.<a class="var it3618" onMouseOver="hilite(3618)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../_variables/plugin.html">$plugin</a>.'... ' );
<a name="l633"><span class="linenum"> 633</span></a>      <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../_variables/edit_Plugin.html">$edit_Plugin</a> = &amp; <a class="var it39" onMouseOver="hilite(39)" onMouseOut="lolite()" onClick="logVariable('Plugins_admin')" href="../../_variables/Plugins_admin.html">$Plugins_admin</a>-&gt;<a class="function" onClick="logFunction('install')" href="../../_functions/install.html" onMouseOver="funcPopup(event,'install')">install</a>( <a class="var it3618" onMouseOver="hilite(3618)" onMouseOut="lolite()" onClick="logVariable('plugin')" href="../../_variables/plugin.html">$plugin</a>, 'broken' ); <span class="comment">// &quot;broken&quot; by default, gets adjusted later</span>
<a name="l634"><span class="linenum"> 634</span></a>      if( ! <a class="phpfunction" onClick="logFunction('is_a')" href="../../_functions/is_a.html" onMouseOver="phpfuncPopup(event,'is_a')">is_a</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../_variables/edit_Plugin.html">$edit_Plugin</a>, 'Plugin' ) )
<a name="l635"><span class="linenum"> 635</span></a>      {
<a name="l636"><span class="linenum"> 636</span></a>          echo <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../_variables/edit_Plugin.html">$edit_Plugin</a>.&quot;&lt;br /&gt;\n&quot;;
<a name="l637"><span class="linenum"> 637</span></a>          return false;
<a name="l638"><span class="linenum"> 638</span></a>      }
<a name="l639"><span class="linenum"> 639</span></a>  
<a name="l640"><span class="linenum"> 640</span></a>      <a class="function" onClick="logFunction('load_funcs')" href="../../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>('plugins/_plugin.funcs.php');
<a name="l641"><span class="linenum"> 641</span></a>      <a class="function" onClick="logFunction('install_plugin_db_schema_action')" href="../../_functions/install_plugin_db_schema_action.html" onMouseOver="funcPopup(event,'install_plugin_db_schema_action')">install_plugin_db_schema_action</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../_variables/edit_Plugin.html">$edit_Plugin</a>, true );
<a name="l642"><span class="linenum"> 642</span></a>  
<a name="l643"><span class="linenum"> 643</span></a>      if( <a class="var it6547" onMouseOver="hilite(6547)" onMouseOut="lolite()" onClick="logVariable('activate')" href="../../_variables/activate.html">$activate</a> )
<a name="l644"><span class="linenum"> 644</span></a>      {    // Try to enable plugin:
<a name="l645"><span class="linenum"> 645</span></a>          <a class="var it3617" onMouseOver="hilite(3617)" onMouseOut="lolite()" onClick="logVariable('enable_return')" href="../../_variables/enable_return.html">$enable_return</a> = <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../_variables/edit_Plugin.html">$edit_Plugin</a>-&gt;<a class="function" onClick="logFunction('BeforeEnable')" href="../../_functions/beforeenable.html" onMouseOver="funcPopup(event,'beforeenable')">BeforeEnable</a>();
<a name="l646"><span class="linenum"> 646</span></a>          if( <a class="var it3617" onMouseOver="hilite(3617)" onMouseOut="lolite()" onClick="logVariable('enable_return')" href="../../_variables/enable_return.html">$enable_return</a> !== true )
<a name="l647"><span class="linenum"> 647</span></a>          {
<a name="l648"><span class="linenum"> 648</span></a>              <a class="var it39" onMouseOver="hilite(39)" onMouseOut="lolite()" onClick="logVariable('Plugins_admin')" href="../../_variables/Plugins_admin.html">$Plugins_admin</a>-&gt;<a class="function" onClick="logFunction('set_Plugin_status')" href="../../_functions/set_plugin_status.html" onMouseOver="funcPopup(event,'set_plugin_status')">set_Plugin_status</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../_variables/edit_Plugin.html">$edit_Plugin</a>, 'disabled' ); <span class="comment">// does not unregister it</span>
<a name="l649"><span class="linenum"> 649</span></a>              echo <a class="var it3617" onMouseOver="hilite(3617)" onMouseOut="lolite()" onClick="logVariable('enable_return')" href="../../_variables/enable_return.html">$enable_return</a>.&quot;&lt;br /&gt;\n&quot;;
<a name="l650"><span class="linenum"> 650</span></a>              return false;
<a name="l651"><span class="linenum"> 651</span></a>          }
<a name="l652"><span class="linenum"> 652</span></a>  
<a name="l653"><span class="linenum"> 653</span></a>          <a class="var it39" onMouseOver="hilite(39)" onMouseOut="lolite()" onClick="logVariable('Plugins_admin')" href="../../_variables/Plugins_admin.html">$Plugins_admin</a>-&gt;<a class="function" onClick="logFunction('set_Plugin_status')" href="../../_functions/set_plugin_status.html" onMouseOver="funcPopup(event,'set_plugin_status')">set_Plugin_status</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../_variables/edit_Plugin.html">$edit_Plugin</a>, 'enabled' );
<a name="l654"><span class="linenum"> 654</span></a>      }
<a name="l655"><span class="linenum"> 655</span></a>      else
<a name="l656"><span class="linenum"> 656</span></a>      {    // Set plugin status as disable
<a name="l657"><span class="linenum"> 657</span></a>          <a class="var it39" onMouseOver="hilite(39)" onMouseOut="lolite()" onClick="logVariable('Plugins_admin')" href="../../_variables/Plugins_admin.html">$Plugins_admin</a>-&gt;<a class="function" onClick="logFunction('set_Plugin_status')" href="../../_functions/set_plugin_status.html" onMouseOver="funcPopup(event,'set_plugin_status')">set_Plugin_status</a>( <a class="var it2371" onMouseOver="hilite(2371)" onMouseOut="lolite()" onClick="logVariable('edit_Plugin')" href="../../_variables/edit_Plugin.html">$edit_Plugin</a>, 'disabled' );
<a name="l658"><span class="linenum"> 658</span></a>      }
<a name="l659"><span class="linenum"> 659</span></a>  
<a name="l660"><span class="linenum"> 660</span></a>      <a class="function" onClick="logFunction('task_end')" href="../../_functions/task_end.html" onMouseOver="funcPopup(event,'task_end')">task_end</a>();
<a name="l661"><span class="linenum"> 661</span></a>      return true;
<a name="l662"><span class="linenum"> 662</span></a>  }
<a name="l663"><span class="linenum"> 663</span></a>  
<a name="l664"><span class="linenum"> 664</span></a>  
<a name="l665"><span class="linenum"> 665</span></a>  <span class="comment">/**</span>
<a name="l666"><span class="linenum"> 666</span></a>  <span class="comment"> * Install basic widgets.</span>
<a name="l667"><span class="linenum"> 667</span></a>  <span class="comment"> */</span>
<a name="l668"><span class="linenum"> 668</span></a>  function <a class="function" onClick="logFunction('install_basic_widgets')" href="../../_functions/install_basic_widgets.html" onMouseOver="funcPopup(event,'install_basic_widgets')">install_basic_widgets</a>( <a class="var it5443" onMouseOver="hilite(5443)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../../_variables/old_db_version.html">$old_db_version</a> = 0 )
<a name="l669"><span class="linenum"> 669</span></a>  {
<a name="l670"><span class="linenum"> 670</span></a>      <span class="comment">/**</span>
<a name="l671"><span class="linenum"> 671</span></a>  <span class="comment">    * @var DB</span>
<a name="l672"><span class="linenum"> 672</span></a>  <span class="comment">    */</span>
<a name="l673"><span class="linenum"> 673</span></a>      global <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l674"><span class="linenum"> 674</span></a>  
<a name="l675"><span class="linenum"> 675</span></a>      <a class="function" onClick="logFunction('load_funcs')" href="../../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>( 'widgets/_widgets.funcs.php' );
<a name="l676"><span class="linenum"> 676</span></a>  
<a name="l677"><span class="linenum"> 677</span></a>      if( <a class="var it5443" onMouseOver="hilite(5443)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../../_variables/old_db_version.html">$old_db_version</a> &lt; 11010 )
<a name="l678"><span class="linenum"> 678</span></a>      {
<a name="l679"><span class="linenum"> 679</span></a>          <a class="var it4361" onMouseOver="hilite(4361)" onMouseOut="lolite()" onClick="logVariable('blog_ids')" href="../../_variables/blog_ids.html">$blog_ids</a> = <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_assoc')" href="../../_functions/get_assoc.html" onMouseOver="funcPopup(event,'get_assoc')">get_assoc</a>( 'SELECT blog_ID, &quot;std&quot; FROM T_blogs' );
<a name="l680"><span class="linenum"> 680</span></a>      }
<a name="l681"><span class="linenum"> 681</span></a>      else
<a name="l682"><span class="linenum"> 682</span></a>      {
<a name="l683"><span class="linenum"> 683</span></a>          <a class="var it4361" onMouseOver="hilite(4361)" onMouseOut="lolite()" onClick="logVariable('blog_ids')" href="../../_variables/blog_ids.html">$blog_ids</a> = <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_assoc')" href="../../_functions/get_assoc.html" onMouseOver="funcPopup(event,'get_assoc')">get_assoc</a>( 'SELECT blog_ID, blog_type FROM T_blogs' );
<a name="l684"><span class="linenum"> 684</span></a>      }
<a name="l685"><span class="linenum"> 685</span></a>  
<a name="l686"><span class="linenum"> 686</span></a>      foreach( <a class="var it4361" onMouseOver="hilite(4361)" onMouseOut="lolite()" onClick="logVariable('blog_ids')" href="../../_variables/blog_ids.html">$blog_ids</a> as <a class="var it1913" onMouseOver="hilite(1913)" onMouseOut="lolite()" onClick="logVariable('blog_id')" href="../../_variables/blog_id.html">$blog_id</a> =&gt; <a class="var it4056" onMouseOver="hilite(4056)" onMouseOut="lolite()" onClick="logVariable('blog_type')" href="../../_variables/blog_type.html">$blog_type</a> )
<a name="l687"><span class="linenum"> 687</span></a>      {
<a name="l688"><span class="linenum"> 688</span></a>          <a class="function" onClick="logFunction('task_begin')" href="../../_functions/task_begin.html" onMouseOver="funcPopup(event,'task_begin')">task_begin</a>( 'Installing default widgets for blog #'.<a class="var it1913" onMouseOver="hilite(1913)" onMouseOut="lolite()" onClick="logVariable('blog_id')" href="../../_variables/blog_id.html">$blog_id</a>.'... ' );
<a name="l689"><span class="linenum"> 689</span></a>          <a class="function" onClick="logFunction('insert_basic_widgets')" href="../../_functions/insert_basic_widgets.html" onMouseOver="funcPopup(event,'insert_basic_widgets')">insert_basic_widgets</a>( <a class="var it1913" onMouseOver="hilite(1913)" onMouseOut="lolite()" onClick="logVariable('blog_id')" href="../../_variables/blog_id.html">$blog_id</a>, true, <a class="var it4056" onMouseOver="hilite(4056)" onMouseOut="lolite()" onClick="logVariable('blog_type')" href="../../_variables/blog_type.html">$blog_type</a> );
<a name="l690"><span class="linenum"> 690</span></a>          <a class="function" onClick="logFunction('task_end')" href="../../_functions/task_end.html" onMouseOver="funcPopup(event,'task_end')">task_end</a>();
<a name="l691"><span class="linenum"> 691</span></a>      }
<a name="l692"><span class="linenum"> 692</span></a>  
<a name="l693"><span class="linenum"> 693</span></a>  }
<a name="l694"><span class="linenum"> 694</span></a>  
<a name="l695"><span class="linenum"> 695</span></a>  
<a name="l696"><span class="linenum"> 696</span></a>  
<a name="l697"><span class="linenum"> 697</span></a>  function <a class="function" onClick="logFunction('advanced_properties')" href="../../_functions/advanced_properties.html" onMouseOver="funcPopup(event,'advanced_properties')">advanced_properties</a>()
<a name="l698"><span class="linenum"> 698</span></a>  {
<a name="l699"><span class="linenum"> 699</span></a>      <span class="comment">/*</span>
<a name="l700"><span class="linenum"> 700</span></a>  <span class="comment">// file_path needs to be case sensitive on unix</span>
<a name="l701"><span class="linenum"> 701</span></a>  <span class="comment">// Note: it should be ok on windows too if we take care of updating the db on case renames</span>
<a name="l702"><span class="linenum"> 702</span></a>  <span class="comment">ALTER TABLE `T_files` CHANGE `file_path` `file_path` VARCHAR( 255 ) CHARACTER SET latin1 COLLATE latin1_bin NOT NULL</span>
<a name="l703"><span class="linenum"> 703</span></a>  <span class="comment">or</span>
<a name="l704"><span class="linenum"> 704</span></a>  <span class="comment">ALTER TABLE `T_files` CHANGE `file_path` `file_path` VARCHAR( 255 ) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL</span>
<a name="l705"><span class="linenum"> 705</span></a>  <span class="comment">    */</span>
<a name="l706"><span class="linenum"> 706</span></a>  }
<a name="l707"><span class="linenum"> 707</span></a>  
<a name="l708"><span class="linenum"> 708</span></a>  
<a name="l709"><span class="linenum"> 709</span></a>  <span class="comment">/**</span>
<a name="l710"><span class="linenum"> 710</span></a>  <span class="comment"> * Create relations</span>
<a name="l711"><span class="linenum"> 711</span></a>  <span class="comment"> *</span>
<a name="l712"><span class="linenum"> 712</span></a>  <span class="comment"> * @todo NOT UP TO DATE AT ALL :( -- update field names before activating this</span>
<a name="l713"><span class="linenum"> 713</span></a>  <span class="comment"> */</span>
<a name="l714"><span class="linenum"> 714</span></a>  function <a class="function" onClick="logFunction('create_relations')" href="../../_functions/create_relations.html" onMouseOver="funcPopup(event,'create_relations')">create_relations</a>()
<a name="l715"><span class="linenum"> 715</span></a>  {
<a name="l716"><span class="linenum"> 716</span></a>      global <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l717"><span class="linenum"> 717</span></a>  
<a name="l718"><span class="linenum"> 718</span></a>      <a class="function" onClick="logFunction('task_begin')" href="../../_functions/task_begin.html" onMouseOver="funcPopup(event,'task_begin')">task_begin</a>( 'Creating relations... ' );
<a name="l719"><span class="linenum"> 719</span></a>  
<a name="l720"><span class="linenum"> 720</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'alter table T_coll_user_perms
<a name="l721"><span class="linenum"> 721</span></a>                                  add constraint FK_bloguser_blog_ID
<a name="l722"><span class="linenum"> 722</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (bloguser_blog_ID)
<a name="l723"><span class="linenum"> 723</span></a>                                              references T_blogs (blog_ID)
<a name="l724"><span class="linenum"> 724</span></a>                                              on delete restrict
<a name="l725"><span class="linenum"> 725</span></a>                                              on update restrict' );
<a name="l726"><span class="linenum"> 726</span></a>  
<a name="l727"><span class="linenum"> 727</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'alter table T_coll_user_perms
<a name="l728"><span class="linenum"> 728</span></a>                                  add constraint FK_bloguser_user_ID
<a name="l729"><span class="linenum"> 729</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (bloguser_user_ID)
<a name="l730"><span class="linenum"> 730</span></a>                                              references T_users (user_ID)
<a name="l731"><span class="linenum"> 731</span></a>                                              on delete restrict
<a name="l732"><span class="linenum"> 732</span></a>                                              on update restrict' );
<a name="l733"><span class="linenum"> 733</span></a>  
<a name="l734"><span class="linenum"> 734</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'alter table T_categories
<a name="l735"><span class="linenum"> 735</span></a>                                  add constraint FK_cat_blog_ID
<a name="l736"><span class="linenum"> 736</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (cat_blog_ID)
<a name="l737"><span class="linenum"> 737</span></a>                                              references T_blogs (blog_ID)
<a name="l738"><span class="linenum"> 738</span></a>                                              on delete restrict
<a name="l739"><span class="linenum"> 739</span></a>                                              on update restrict,
<a name="l740"><span class="linenum"> 740</span></a>                                  add constraint FK_cat_parent_ID
<a name="l741"><span class="linenum"> 741</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (cat_parent_ID)
<a name="l742"><span class="linenum"> 742</span></a>                                              references T_categories (cat_ID)
<a name="l743"><span class="linenum"> 743</span></a>                                              on delete restrict
<a name="l744"><span class="linenum"> 744</span></a>                                              on update restrict' );
<a name="l745"><span class="linenum"> 745</span></a>  
<a name="l746"><span class="linenum"> 746</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'alter table T_comments
<a name="l747"><span class="linenum"> 747</span></a>                                  add constraint FK_comment_item_ID
<a name="l748"><span class="linenum"> 748</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (comment_item_ID)
<a name="l749"><span class="linenum"> 749</span></a>                                              references T_items__item (post_ID)
<a name="l750"><span class="linenum"> 750</span></a>                                              on delete restrict
<a name="l751"><span class="linenum"> 751</span></a>                                              on update restrict' );
<a name="l752"><span class="linenum"> 752</span></a>  
<a name="l753"><span class="linenum"> 753</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'alter table T_postcats
<a name="l754"><span class="linenum"> 754</span></a>                                  add constraint FK_postcat_cat_ID
<a name="l755"><span class="linenum"> 755</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (postcat_cat_ID)
<a name="l756"><span class="linenum"> 756</span></a>                                              references T_categories (cat_ID)
<a name="l757"><span class="linenum"> 757</span></a>                                              on delete restrict
<a name="l758"><span class="linenum"> 758</span></a>                                              on update restrict,
<a name="l759"><span class="linenum"> 759</span></a>                                  add constraint FK_postcat_post_ID
<a name="l760"><span class="linenum"> 760</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (postcat_post_ID)
<a name="l761"><span class="linenum"> 761</span></a>                                              references T_items__item (post_ID)
<a name="l762"><span class="linenum"> 762</span></a>                                              on delete restrict
<a name="l763"><span class="linenum"> 763</span></a>                                              on update restrict' );
<a name="l764"><span class="linenum"> 764</span></a>  
<a name="l765"><span class="linenum"> 765</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'alter table T_items__item
<a name="l766"><span class="linenum"> 766</span></a>                                  add constraint FK_post_assigned_user_ID
<a name="l767"><span class="linenum"> 767</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (post_assigned_user_ID)
<a name="l768"><span class="linenum"> 768</span></a>                                              references T_users (user_ID)
<a name="l769"><span class="linenum"> 769</span></a>                                              on delete restrict
<a name="l770"><span class="linenum"> 770</span></a>                                              on update restrict,
<a name="l771"><span class="linenum"> 771</span></a>                                  add constraint FK_post_lastedit_user_ID
<a name="l772"><span class="linenum"> 772</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (post_lastedit_user_ID)
<a name="l773"><span class="linenum"> 773</span></a>                                              references T_users (user_ID)
<a name="l774"><span class="linenum"> 774</span></a>                                              on delete restrict
<a name="l775"><span class="linenum"> 775</span></a>                                              on update restrict,
<a name="l776"><span class="linenum"> 776</span></a>                                  add constraint FK_post_creator_user_ID
<a name="l777"><span class="linenum"> 777</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (post_creator_user_ID)
<a name="l778"><span class="linenum"> 778</span></a>                                              references T_users (user_ID)
<a name="l779"><span class="linenum"> 779</span></a>                                              on delete restrict
<a name="l780"><span class="linenum"> 780</span></a>                                              on update restrict,
<a name="l781"><span class="linenum"> 781</span></a>                                  add constraint FK_post_main_cat_ID
<a name="l782"><span class="linenum"> 782</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (post_main_cat_ID)
<a name="l783"><span class="linenum"> 783</span></a>                                              references T_categories (cat_ID)
<a name="l784"><span class="linenum"> 784</span></a>                                              on delete restrict
<a name="l785"><span class="linenum"> 785</span></a>                                              on update restrict,
<a name="l786"><span class="linenum"> 786</span></a>                                  add constraint FK_post_parent_ID
<a name="l787"><span class="linenum"> 787</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (post_parent_ID)
<a name="l788"><span class="linenum"> 788</span></a>                                              references T_items__item (post_ID)
<a name="l789"><span class="linenum"> 789</span></a>                                              on delete restrict
<a name="l790"><span class="linenum"> 790</span></a>                                              on update restrict,
<a name="l791"><span class="linenum"> 791</span></a>                                  add constraint FK_post_pst_ID
<a name="l792"><span class="linenum"> 792</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (post_pst_ID)
<a name="l793"><span class="linenum"> 793</span></a>                                              references T_items__status (pst_ID)
<a name="l794"><span class="linenum"> 794</span></a>                                              on delete restrict
<a name="l795"><span class="linenum"> 795</span></a>                                              on update restrict,
<a name="l796"><span class="linenum"> 796</span></a>                                  add constraint FK_post_ptyp_ID
<a name="l797"><span class="linenum"> 797</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (post_ptyp_ID)
<a name="l798"><span class="linenum"> 798</span></a>                                              references T_items__type (ptyp_ID)
<a name="l799"><span class="linenum"> 799</span></a>                                              on delete restrict
<a name="l800"><span class="linenum"> 800</span></a>                                              on update restrict' );
<a name="l801"><span class="linenum"> 801</span></a>  
<a name="l802"><span class="linenum"> 802</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'alter table T_links
<a name="l803"><span class="linenum"> 803</span></a>                                  add constraint FK_link_creator_user_ID
<a name="l804"><span class="linenum"> 804</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (link_creator_user_ID)
<a name="l805"><span class="linenum"> 805</span></a>                                              references T_users (user_ID)
<a name="l806"><span class="linenum"> 806</span></a>                                              on delete restrict
<a name="l807"><span class="linenum"> 807</span></a>                                              on update restrict' );
<a name="l808"><span class="linenum"> 808</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'alter table T_links
<a name="l809"><span class="linenum"> 809</span></a>                                  add constraint FK_link_lastedit_user_ID
<a name="l810"><span class="linenum"> 810</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (link_lastedit_user_ID)
<a name="l811"><span class="linenum"> 811</span></a>                                              references T_users (user_ID)
<a name="l812"><span class="linenum"> 812</span></a>                                              on delete restrict
<a name="l813"><span class="linenum"> 813</span></a>                                              on update restrict' );
<a name="l814"><span class="linenum"> 814</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'alter table T_links
<a name="l815"><span class="linenum"> 815</span></a>                                  add constraint FK_link_file_ID
<a name="l816"><span class="linenum"> 816</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (link_file_ID)
<a name="l817"><span class="linenum"> 817</span></a>                                              references T_files (file_ID)
<a name="l818"><span class="linenum"> 818</span></a>                                              on delete restrict
<a name="l819"><span class="linenum"> 819</span></a>                                              on update restrict' );
<a name="l820"><span class="linenum"> 820</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'alter table T_links
<a name="l821"><span class="linenum"> 821</span></a>                                  add constraint FK_link_itm_ID
<a name="l822"><span class="linenum"> 822</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (link_itm_ID)
<a name="l823"><span class="linenum"> 823</span></a>                                              references T_items__item (post_ID)
<a name="l824"><span class="linenum"> 824</span></a>                                              on delete restrict
<a name="l825"><span class="linenum"> 825</span></a>                                              on update restrict' );
<a name="l826"><span class="linenum"> 826</span></a>  
<a name="l827"><span class="linenum"> 827</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'alter table T_pluginsettings
<a name="l828"><span class="linenum"> 828</span></a>                    add constraint FK_pset_plug_ID
<a name="l829"><span class="linenum"> 829</span></a>                          foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (pset_plug_ID)
<a name="l830"><span class="linenum"> 830</span></a>                          references T_plugins (plug_ID)
<a name="l831"><span class="linenum"> 831</span></a>                          on delete restrict
<a name="l832"><span class="linenum"> 832</span></a>                          on update restrict' );
<a name="l833"><span class="linenum"> 833</span></a>  
<a name="l834"><span class="linenum"> 834</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'alter table T_pluginusersettings
<a name="l835"><span class="linenum"> 835</span></a>                    add constraint FK_puset_plug_ID
<a name="l836"><span class="linenum"> 836</span></a>                          foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (puset_plug_ID)
<a name="l837"><span class="linenum"> 837</span></a>                          references T_plugins (plug_ID)
<a name="l838"><span class="linenum"> 838</span></a>                          on delete restrict
<a name="l839"><span class="linenum"> 839</span></a>                          on update restrict' );
<a name="l840"><span class="linenum"> 840</span></a>  
<a name="l841"><span class="linenum"> 841</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'alter table T_pluginevents
<a name="l842"><span class="linenum"> 842</span></a>                    add constraint FK_pevt_plug_ID
<a name="l843"><span class="linenum"> 843</span></a>                          foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (pevt_plug_ID)
<a name="l844"><span class="linenum"> 844</span></a>                          references T_plugins (plug_ID)
<a name="l845"><span class="linenum"> 845</span></a>                          on delete restrict
<a name="l846"><span class="linenum"> 846</span></a>                          on update restrict' );
<a name="l847"><span class="linenum"> 847</span></a>  
<a name="l848"><span class="linenum"> 848</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'alter table T_users
<a name="l849"><span class="linenum"> 849</span></a>                                  add constraint FK_user_grp_ID
<a name="l850"><span class="linenum"> 850</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (user_grp_ID)
<a name="l851"><span class="linenum"> 851</span></a>                                              references T_groups (grp_ID)
<a name="l852"><span class="linenum"> 852</span></a>                                              on delete restrict
<a name="l853"><span class="linenum"> 853</span></a>                                              on update restrict' );
<a name="l854"><span class="linenum"> 854</span></a>  
<a name="l855"><span class="linenum"> 855</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'alter table T_users__usersettings
<a name="l856"><span class="linenum"> 856</span></a>                                  add constraint FK_uset_user_ID
<a name="l857"><span class="linenum"> 857</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (uset_user_ID)
<a name="l858"><span class="linenum"> 858</span></a>                                              references T_users (user_ID)
<a name="l859"><span class="linenum"> 859</span></a>                                              on delete restrict
<a name="l860"><span class="linenum"> 860</span></a>                                              on update restrict' );
<a name="l861"><span class="linenum"> 861</span></a>  
<a name="l862"><span class="linenum"> 862</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'alter table T_subscriptions
<a name="l863"><span class="linenum"> 863</span></a>                                  add constraint FK_sub_coll_ID
<a name="l864"><span class="linenum"> 864</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (sub_coll_ID)
<a name="l865"><span class="linenum"> 865</span></a>                                              references T_blogs (blog_ID)
<a name="l866"><span class="linenum"> 866</span></a>                                              on delete restrict
<a name="l867"><span class="linenum"> 867</span></a>                                              on update restrict' );
<a name="l868"><span class="linenum"> 868</span></a>  
<a name="l869"><span class="linenum"> 869</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'alter table T_subscriptions
<a name="l870"><span class="linenum"> 870</span></a>                                  add constraint FK_sub_user_ID
<a name="l871"><span class="linenum"> 871</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (sub_user_ID)
<a name="l872"><span class="linenum"> 872</span></a>                                              references T_users (user_ID)
<a name="l873"><span class="linenum"> 873</span></a>                                              on delete restrict
<a name="l874"><span class="linenum"> 874</span></a>                                              on update restrict' );
<a name="l875"><span class="linenum"> 875</span></a>  
<a name="l876"><span class="linenum"> 876</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'alter table T_slug
<a name="l877"><span class="linenum"> 877</span></a>                                  add constraint FK_slug_itm_ID
<a name="l878"><span class="linenum"> 878</span></a>                                              foreign <a class="phpfunction" onClick="logFunction('key')" href="../../_functions/key.html" onMouseOver="phpfuncPopup(event,'key')">key</a> (slug_itm_ID)
<a name="l879"><span class="linenum"> 879</span></a>                                              references T_items__item (post_ID)
<a name="l880"><span class="linenum"> 880</span></a>                                              on delete restrict
<a name="l881"><span class="linenum"> 881</span></a>                                              on update restrict' );
<a name="l882"><span class="linenum"> 882</span></a>  
<a name="l883"><span class="linenum"> 883</span></a>      <a class="function" onClick="logFunction('task_end')" href="../../_functions/task_end.html" onMouseOver="funcPopup(event,'task_end')">task_end</a>();
<a name="l884"><span class="linenum"> 884</span></a>  }
<a name="l885"><span class="linenum"> 885</span></a>  
<a name="l886"><span class="linenum"> 886</span></a>  
<a name="l887"><span class="linenum"> 887</span></a>  <span class="comment">/**</span>
<a name="l888"><span class="linenum"> 888</span></a>  <span class="comment"> * Loads the b2evo database scheme.</span>
<a name="l889"><span class="linenum"> 889</span></a>  <span class="comment"> *</span>
<a name="l890"><span class="linenum"> 890</span></a>  <span class="comment"> * This gets updated through {@link db_delta()} which generates the queries needed to get</span>
<a name="l891"><span class="linenum"> 891</span></a>  <span class="comment"> * to this scheme.</span>
<a name="l892"><span class="linenum"> 892</span></a>  <span class="comment"> *</span>
<a name="l893"><span class="linenum"> 893</span></a>  <span class="comment"> * Please see {@link db_delta()} for things to take care of.</span>
<a name="l894"><span class="linenum"> 894</span></a>  <span class="comment"> */</span>
<a name="l895"><span class="linenum"> 895</span></a>  function <a class="function" onClick="logFunction('load_db_schema')" href="../../_functions/load_db_schema.html" onMouseOver="funcPopup(event,'load_db_schema')">load_db_schema</a>()
<a name="l896"><span class="linenum"> 896</span></a>  {
<a name="l897"><span class="linenum"> 897</span></a>      global <a class="var it4003" onMouseOver="hilite(4003)" onMouseOut="lolite()" onClick="logVariable('schema_queries')" href="../../_variables/schema_queries.html">$schema_queries</a>;
<a name="l898"><span class="linenum"> 898</span></a>      global <a class="var it5426" onMouseOver="hilite(5426)" onMouseOut="lolite()" onClick="logVariable('modules')" href="../../_variables/modules.html">$modules</a>, <a class="var it246" onMouseOver="hilite(246)" onMouseOut="lolite()" onClick="logVariable('inc_path')" href="../../_variables/inc_path.html">$inc_path</a>;
<a name="l899"><span class="linenum"> 899</span></a>  
<a name="l900"><span class="linenum"> 900</span></a>      global <a class="var it4002" onMouseOver="hilite(4002)" onMouseOut="lolite()" onClick="logVariable('db_storage_charset')" href="../../_variables/db_storage_charset.html">$db_storage_charset</a>, <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>;
<a name="l901"><span class="linenum"> 901</span></a>      if( empty(<a class="var it4002" onMouseOver="hilite(4002)" onMouseOut="lolite()" onClick="logVariable('db_storage_charset')" href="../../_variables/db_storage_charset.html">$db_storage_charset</a>) )
<a name="l902"><span class="linenum"> 902</span></a>      {    // If no specific charset has been requested for datstorage, use the one of the current connection (optimize for speed - no conversions)
<a name="l903"><span class="linenum"> 903</span></a>          <a class="var it4002" onMouseOver="hilite(4002)" onMouseOut="lolite()" onClick="logVariable('db_storage_charset')" href="../../_variables/db_storage_charset.html">$db_storage_charset</a> = <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('connection_charset')" class="var it8966" onMouseOver="hilite(8966)" onMouseOut="lolite()" href="../../_variables/connection_charset.html">connection_charset</a>;
<a name="l904"><span class="linenum"> 904</span></a>      }
<a name="l905"><span class="linenum"> 905</span></a>  <span class="comment">    //pre_dump( 'db_storage_charset', $db_storage_charset );</span>
<a name="l906"><span class="linenum"> 906</span></a>  
<a name="l907"><span class="linenum"> 907</span></a>  <span class="comment">    // Load modules:</span>
<a name="l908"><span class="linenum"> 908</span></a>      foreach( <a class="var it5426" onMouseOver="hilite(5426)" onMouseOut="lolite()" onClick="logVariable('modules')" href="../../_variables/modules.html">$modules</a> as <a class="var it5427" onMouseOver="hilite(5427)" onMouseOut="lolite()" onClick="logVariable('module')" href="../../_variables/module.html">$module</a> )
<a name="l909"><span class="linenum"> 909</span></a>      {
<a name="l910"><span class="linenum"> 910</span></a>          echo 'Loading module: '.<a class="var it5427" onMouseOver="hilite(5427)" onMouseOut="lolite()" onClick="logVariable('module')" href="../../_variables/module.html">$module</a>.'/model/_'.<a class="var it5427" onMouseOver="hilite(5427)" onMouseOut="lolite()" onClick="logVariable('module')" href="../../_variables/module.html">$module</a>.'.install.php&lt;br /&gt;';
<a name="l911"><span class="linenum"> 911</span></a>          require_once <a class="var it246" onMouseOver="hilite(246)" onMouseOut="lolite()" onClick="logVariable('inc_path')" href="../../_variables/inc_path.html">$inc_path</a>.<a class="var it5427" onMouseOver="hilite(5427)" onMouseOut="lolite()" onClick="logVariable('module')" href="../../_variables/module.html">$module</a>.'/model/_'.<a class="var it5427" onMouseOver="hilite(5427)" onMouseOut="lolite()" onClick="logVariable('module')" href="../../_variables/module.html">$module</a>.'.install.php';
<a name="l912"><span class="linenum"> 912</span></a>      }
<a name="l913"><span class="linenum"> 913</span></a>  
<a name="l914"><span class="linenum"> 914</span></a>  }
<a name="l915"><span class="linenum"> 915</span></a>  
<a name="l916"><span class="linenum"> 916</span></a>  
<a name="l917"><span class="linenum"> 917</span></a>  <span class="comment">/**</span>
<a name="l918"><span class="linenum"> 918</span></a>  <span class="comment"> * Install htaccess: Check if it works with the webserver, then install it for real.</span>
<a name="l919"><span class="linenum"> 919</span></a>  <span class="comment"> *</span>
<a name="l920"><span class="linenum"> 920</span></a>  <span class="comment"> * @return boolean TRUE if no errors</span>
<a name="l921"><span class="linenum"> 921</span></a>  <span class="comment"> */</span>
<a name="l922"><span class="linenum"> 922</span></a>  function <a class="function" onClick="logFunction('install_htaccess')" href="../../_functions/install_htaccess.html" onMouseOver="funcPopup(event,'install_htaccess')">install_htaccess</a>( <a class="var it6548" onMouseOver="hilite(6548)" onMouseOut="lolite()" onClick="logVariable('upgrade')" href="../../_variables/upgrade.html">$upgrade</a> = false )
<a name="l923"><span class="linenum"> 923</span></a>  {
<a name="l924"><span class="linenum"> 924</span></a>      echo '&lt;p&gt;Preparing to install .htaccess ... ';
<a name="l925"><span class="linenum"> 925</span></a>  
<a name="l926"><span class="linenum"> 926</span></a>      <a class="var it2626" onMouseOver="hilite(2626)" onMouseOut="lolite()" onClick="logVariable('server')" href="../../_variables/server.html">$server</a> = isset(<a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['SERVER_SOFTWARE']) ? <a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['SERVER_SOFTWARE'] : '';
<a name="l927"><span class="linenum"> 927</span></a>      if( !empty(<a class="var it2626" onMouseOver="hilite(2626)" onMouseOut="lolite()" onClick="logVariable('server')" href="../../_variables/server.html">$server</a>) &amp;&amp; <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>('~(Nginx|Lighttpd|Microsoft-IIS)~i', <a class="var it2626" onMouseOver="hilite(2626)" onMouseOut="lolite()" onClick="logVariable('server')" href="../../_variables/server.html">$server</a>) )
<a name="l928"><span class="linenum"> 928</span></a>      {    // Skip installation if this is not an Apache server
<a name="l929"><span class="linenum"> 929</span></a>          echo '&lt;br /&gt;&lt;b&gt;.htaccess is not needed (not an Apache server)&lt;/b&gt;&lt;/p&gt;';
<a name="l930"><span class="linenum"> 930</span></a>          return true;
<a name="l931"><span class="linenum"> 931</span></a>      }
<a name="l932"><span class="linenum"> 932</span></a>  
<a name="l933"><span class="linenum"> 933</span></a>      <a class="var it350" onMouseOver="hilite(350)" onMouseOut="lolite()" onClick="logVariable('error_message')" href="../../_variables/error_message.html">$error_message</a> = <a class="function" onClick="logFunction('do_install_htaccess')" href="../../_functions/do_install_htaccess.html" onMouseOver="funcPopup(event,'do_install_htaccess')">do_install_htaccess</a>( <a class="var it6548" onMouseOver="hilite(6548)" onMouseOut="lolite()" onClick="logVariable('upgrade')" href="../../_variables/upgrade.html">$upgrade</a> );
<a name="l934"><span class="linenum"> 934</span></a>  
<a name="l935"><span class="linenum"> 935</span></a>      if( <a class="var it350" onMouseOver="hilite(350)" onMouseOut="lolite()" onClick="logVariable('error_message')" href="../../_variables/error_message.html">$error_message</a> )
<a name="l936"><span class="linenum"> 936</span></a>      {
<a name="l937"><span class="linenum"> 937</span></a>          <a class="var it6549" onMouseOver="hilite(6549)" onMouseOut="lolite()" onClick="logVariable('htignore')" href="../../_variables/htignore.html">$htignore</a> = <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'htignore', 'integer', 0 );
<a name="l938"><span class="linenum"> 938</span></a>  
<a name="l939"><span class="linenum"> 939</span></a>          echo 'ERROR!&lt;br/&gt;&lt;b&gt;'.<a class="var it350" onMouseOver="hilite(350)" onMouseOut="lolite()" onClick="logVariable('error_message')" href="../../_variables/error_message.html">$error_message</a>.'&lt;/b&gt;';
<a name="l940"><span class="linenum"> 940</span></a>  
<a name="l941"><span class="linenum"> 941</span></a>          if( <a class="var it6549" onMouseOver="hilite(6549)" onMouseOut="lolite()" onClick="logVariable('htignore')" href="../../_variables/htignore.html">$htignore</a> )
<a name="l942"><span class="linenum"> 942</span></a>          {    // Ignore errors with .htaccess file
<a name="l943"><span class="linenum"> 943</span></a>              return true;
<a name="l944"><span class="linenum"> 944</span></a>          }
<a name="l945"><span class="linenum"> 945</span></a>          else
<a name="l946"><span class="linenum"> 946</span></a>          {    // Some errors are existing with .htaccess file, Display a link to ignore the errors and continue instalation
<a name="l947"><span class="linenum"> 947</span></a>              echo '&lt;p style=&quot;text-align:center;font-size:150%;font-weight:bold;margin-top:10px&quot;&gt;&lt;a href=&quot;'.<a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['REQUEST_URI'].'&amp;htignore=1&quot;&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Continue installation &amp;raquo;').'&lt;/a&gt;&lt;/p&gt;';
<a name="l948"><span class="linenum"> 948</span></a>              return false;
<a name="l949"><span class="linenum"> 949</span></a>          }
<a name="l950"><span class="linenum"> 950</span></a>      }
<a name="l951"><span class="linenum"> 951</span></a>      echo '&lt;/p&gt;';
<a name="l952"><span class="linenum"> 952</span></a>  
<a name="l953"><span class="linenum"> 953</span></a>      return true;
<a name="l954"><span class="linenum"> 954</span></a>  }
<a name="l955"><span class="linenum"> 955</span></a>  
<a name="l956"><span class="linenum"> 956</span></a>  <span class="comment">/**</span>
<a name="l957"><span class="linenum"> 957</span></a>  <span class="comment"> * This does the actual file manipulations for installing .htaccess</span>
<a name="l958"><span class="linenum"> 958</span></a>  <span class="comment"> * This will verify that the provided sample.htaccess does not crash apache in a test folder before installing it for real.</span>
<a name="l959"><span class="linenum"> 959</span></a>  <span class="comment"> *</span>
<a name="l960"><span class="linenum"> 960</span></a>  <span class="comment"> * @param boolean are we upgrading (vs installing)?</span>
<a name="l961"><span class="linenum"> 961</span></a>  <span class="comment"> * @return mixed</span>
<a name="l962"><span class="linenum"> 962</span></a>  <span class="comment"> */</span>
<a name="l963"><span class="linenum"> 963</span></a>  function <a class="function" onClick="logFunction('do_install_htaccess')" href="../../_functions/do_install_htaccess.html" onMouseOver="funcPopup(event,'do_install_htaccess')">do_install_htaccess</a>( <a class="var it6548" onMouseOver="hilite(6548)" onMouseOut="lolite()" onClick="logVariable('upgrade')" href="../../_variables/upgrade.html">$upgrade</a> = false )
<a name="l964"><span class="linenum"> 964</span></a>  {
<a name="l965"><span class="linenum"> 965</span></a>      global <a class="var it153" onMouseOver="hilite(153)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../_variables/baseurl.html">$baseurl</a>;
<a name="l966"><span class="linenum"> 966</span></a>      global <a class="var it1877" onMouseOver="hilite(1877)" onMouseOut="lolite()" onClick="logVariable('basepath')" href="../../_variables/basepath.html">$basepath</a>;
<a name="l967"><span class="linenum"> 967</span></a>  
<a name="l968"><span class="linenum"> 968</span></a>      if( @<a class="phpfunction" onClick="logFunction('file_exists')" href="../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>(<a class="var it1877" onMouseOver="hilite(1877)" onMouseOut="lolite()" onClick="logVariable('basepath')" href="../../_variables/basepath.html">$basepath</a>.'.htaccess') )
<a name="l969"><span class="linenum"> 969</span></a>      {
<a name="l970"><span class="linenum"> 970</span></a>          if( <a class="var it6548" onMouseOver="hilite(6548)" onMouseOut="lolite()" onClick="logVariable('upgrade')" href="../../_variables/upgrade.html">$upgrade</a> )
<a name="l971"><span class="linenum"> 971</span></a>          {
<a name="l972"><span class="linenum"> 972</span></a>              echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Already installed.');
<a name="l973"><span class="linenum"> 973</span></a>              return ''; <span class="comment">// all is well :)</span>
<a name="l974"><span class="linenum"> 974</span></a>          }
<a name="l975"><span class="linenum"> 975</span></a>  
<a name="l976"><span class="linenum"> 976</span></a>          if( @<a class="phpfunction" onClick="logFunction('file_exists')" href="../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>( <a class="var it1877" onMouseOver="hilite(1877)" onMouseOut="lolite()" onClick="logVariable('basepath')" href="../../_variables/basepath.html">$basepath</a>.'sample.htaccess' ) )
<a name="l977"><span class="linenum"> 977</span></a>          {
<a name="l978"><span class="linenum"> 978</span></a>              <a class="var it6550" onMouseOver="hilite(6550)" onMouseOut="lolite()" onClick="logVariable('content_htaccess')" href="../../_variables/content_htaccess.html">$content_htaccess</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>( <a class="phpfunction" onClick="logFunction('file_get_contents')" href="../../_functions/file_get_contents.html" onMouseOver="phpfuncPopup(event,'file_get_contents')">file_get_contents</a>( <a class="var it1877" onMouseOver="hilite(1877)" onMouseOut="lolite()" onClick="logVariable('basepath')" href="../../_variables/basepath.html">$basepath</a>.'.htaccess' ) );
<a name="l979"><span class="linenum"> 979</span></a>              <a class="var it6551" onMouseOver="hilite(6551)" onMouseOut="lolite()" onClick="logVariable('content_sample_htaccess')" href="../../_variables/content_sample_htaccess.html">$content_sample_htaccess</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>( <a class="phpfunction" onClick="logFunction('file_get_contents')" href="../../_functions/file_get_contents.html" onMouseOver="phpfuncPopup(event,'file_get_contents')">file_get_contents</a>( <a class="var it1877" onMouseOver="hilite(1877)" onMouseOut="lolite()" onClick="logVariable('basepath')" href="../../_variables/basepath.html">$basepath</a>.'sample.htaccess' ) );
<a name="l980"><span class="linenum"> 980</span></a>  
<a name="l981"><span class="linenum"> 981</span></a>              if( <a class="var it6550" onMouseOver="hilite(6550)" onMouseOut="lolite()" onClick="logVariable('content_htaccess')" href="../../_variables/content_htaccess.html">$content_htaccess</a> != <a class="var it6551" onMouseOver="hilite(6551)" onMouseOut="lolite()" onClick="logVariable('content_sample_htaccess')" href="../../_variables/content_sample_htaccess.html">$content_sample_htaccess</a> )
<a name="l982"><span class="linenum"> 982</span></a>              {    // The .htaccess file has content that different from a sample file
<a name="l983"><span class="linenum"> 983</span></a>                  <a class="var it350" onMouseOver="hilite(350)" onMouseOut="lolite()" onClick="logVariable('error_message')" href="../../_variables/error_message.html">$error_message</a> = '&lt;p class=&quot;red&quot;&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('There is already a file called .htaccess at the blog root. If you don\'t specifically need this file, it is recommended that you delete it or rename it to old.htaccess before you continue. This will allow b2evolution to create a new .htaccess file that is optimized for best results.').'&lt;/p&gt;';
<a name="l984"><span class="linenum"> 984</span></a>                  <a class="var it350" onMouseOver="hilite(350)" onMouseOut="lolite()" onClick="logVariable('error_message')" href="../../_variables/error_message.html">$error_message</a> .= <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Here are the contents of the current .htaccess file:');
<a name="l985"><span class="linenum"> 985</span></a>                  <a class="var it350" onMouseOver="hilite(350)" onMouseOut="lolite()" onClick="logVariable('error_message')" href="../../_variables/error_message.html">$error_message</a> .= '&lt;div style=&quot;overflow:auto&quot;&gt;&lt;pre&gt;'.<a class="function" onClick="logFunction('evo_htmlspecialchars')" href="../../_functions/evo_htmlspecialchars.html" onMouseOver="funcPopup(event,'evo_htmlspecialchars')">evo_htmlspecialchars</a>( <a class="var it6550" onMouseOver="hilite(6550)" onMouseOut="lolite()" onClick="logVariable('content_htaccess')" href="../../_variables/content_htaccess.html">$content_htaccess</a> ).'&lt;/pre&gt;&lt;/div&gt;&lt;br /&gt;';
<a name="l986"><span class="linenum"> 986</span></a>                  <a class="var it350" onMouseOver="hilite(350)" onMouseOut="lolite()" onClick="logVariable('error_message')" href="../../_variables/error_message.html">$error_message</a> .= sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Again, we recommend you remove this file before continuing. If you chose to keep it, b2evolution will probably still work, but for optimization you should follow &lt;a %s&gt;these instructions&lt;/a&gt;.'), 'href=&quot;'.<a class="function" onClick="logFunction('get_manual_url')" href="../../_functions/get_manual_url.html" onMouseOver="funcPopup(event,'get_manual_url')">get_manual_url</a>( 'htaccess-file' ).'&quot; target=&quot;_blank&quot;' );
<a name="l987"><span class="linenum"> 987</span></a>                  return <a class="var it350" onMouseOver="hilite(350)" onMouseOut="lolite()" onClick="logVariable('error_message')" href="../../_variables/error_message.html">$error_message</a>;
<a name="l988"><span class="linenum"> 988</span></a>              }
<a name="l989"><span class="linenum"> 989</span></a>              else
<a name="l990"><span class="linenum"> 990</span></a>              {
<a name="l991"><span class="linenum"> 991</span></a>                  echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Already installed.');
<a name="l992"><span class="linenum"> 992</span></a>                  return '';
<a name="l993"><span class="linenum"> 993</span></a>              }
<a name="l994"><span class="linenum"> 994</span></a>          }
<a name="l995"><span class="linenum"> 995</span></a>      }
<a name="l996"><span class="linenum"> 996</span></a>  
<a name="l997"><span class="linenum"> 997</span></a>  <span class="comment">    // Make sure we have a sample file to start with:</span>
<a name="l998"><span class="linenum"> 998</span></a>      if( ! @<a class="phpfunction" onClick="logFunction('file_exists')" href="../../_functions/file_exists.html" onMouseOver="phpfuncPopup(event,'file_exists')">file_exists</a>( <a class="var it1877" onMouseOver="hilite(1877)" onMouseOut="lolite()" onClick="logVariable('basepath')" href="../../_variables/basepath.html">$basepath</a>.'sample.htaccess' ) )
<a name="l999"><span class="linenum"> 999</span></a>      {
<a name="l1000"><span class="linenum">1000</span></a>          return 'Cannot find file [ sample.htaccess ] in your base url folder.';
<a name="l1001"><span class="linenum">1001</span></a>      }
<a name="l1002"><span class="linenum">1002</span></a>  
<a name="l1003"><span class="linenum">1003</span></a>  <span class="comment">    // Try to copy that file to the test folder:</span>
<a name="l1004"><span class="linenum">1004</span></a>      if( ! @<a class="phpfunction" onClick="logFunction('copy')" href="../../_functions/copy.html" onMouseOver="phpfuncPopup(event,'copy')">copy</a>( <a class="var it1877" onMouseOver="hilite(1877)" onMouseOut="lolite()" onClick="logVariable('basepath')" href="../../_variables/basepath.html">$basepath</a>.'sample.htaccess', <a class="var it1877" onMouseOver="hilite(1877)" onMouseOut="lolite()" onClick="logVariable('basepath')" href="../../_variables/basepath.html">$basepath</a>.'install/test/.htaccess' ) )
<a name="l1005"><span class="linenum">1005</span></a>      {
<a name="l1006"><span class="linenum">1006</span></a>          return 'Failed to copy files!';
<a name="l1007"><span class="linenum">1007</span></a>      }
<a name="l1008"><span class="linenum">1008</span></a>  
<a name="l1009"><span class="linenum">1009</span></a>  <span class="comment">    // Make sure .htaccess does not crash in the test folder:</span>
<a name="l1010"><span class="linenum">1010</span></a>      <a class="function" onClick="logFunction('load_funcs')" href="../../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>('_core/_url.funcs.php');
<a name="l1011"><span class="linenum">1011</span></a>      <a class="var it2470" onMouseOver="hilite(2470)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a> = array();
<a name="l1012"><span class="linenum">1012</span></a>      if( ! <a class="var it6552" onMouseOver="hilite(6552)" onMouseOut="lolite()" onClick="logVariable('remote_page')" href="../../_variables/remote_page.html">$remote_page</a> = <a class="function" onClick="logFunction('fetch_remote_page')" href="../../_functions/fetch_remote_page.html" onMouseOver="funcPopup(event,'fetch_remote_page')">fetch_remote_page</a>( <a class="var it153" onMouseOver="hilite(153)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../_variables/baseurl.html">$baseurl</a>.'install/test/', <a class="var it2470" onMouseOver="hilite(2470)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a> ) )
<a name="l1013"><span class="linenum">1013</span></a>      {
<a name="l1014"><span class="linenum">1014</span></a>          return <a class="var it2470" onMouseOver="hilite(2470)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../_variables/info.html">$info</a>['error'];
<a name="l1015"><span class="linenum">1015</span></a>      }
<a name="l1016"><span class="linenum">1016</span></a>      if( <a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>( <a class="var it6552" onMouseOver="hilite(6552)" onMouseOut="lolite()" onClick="logVariable('remote_page')" href="../../_variables/remote_page.html">$remote_page</a>, 0, 16 ) != 'Test successful.' )
<a name="l1017"><span class="linenum">1017</span></a>      {
<a name="l1018"><span class="linenum">1018</span></a>          return 'install/test/index.html was not found as expected.';
<a name="l1019"><span class="linenum">1019</span></a>      }
<a name="l1020"><span class="linenum">1020</span></a>  
<a name="l1021"><span class="linenum">1021</span></a>  <span class="comment">    // Now we consider it's safe, copy .htaccess to its real location:</span>
<a name="l1022"><span class="linenum">1022</span></a>      if( ! @<a class="phpfunction" onClick="logFunction('copy')" href="../../_functions/copy.html" onMouseOver="phpfuncPopup(event,'copy')">copy</a>( <a class="var it1877" onMouseOver="hilite(1877)" onMouseOut="lolite()" onClick="logVariable('basepath')" href="../../_variables/basepath.html">$basepath</a>.'sample.htaccess', <a class="var it1877" onMouseOver="hilite(1877)" onMouseOut="lolite()" onClick="logVariable('basepath')" href="../../_variables/basepath.html">$basepath</a>.'.htaccess' ) )
<a name="l1023"><span class="linenum">1023</span></a>      {
<a name="l1024"><span class="linenum">1024</span></a>          return 'Test was successful, but failed to copy .htaccess into baseurl directory!';
<a name="l1025"><span class="linenum">1025</span></a>      }
<a name="l1026"><span class="linenum">1026</span></a>  
<a name="l1027"><span class="linenum">1027</span></a>      echo 'Install successful.';
<a name="l1028"><span class="linenum">1028</span></a>      return '';
<a name="l1029"><span class="linenum">1029</span></a>  }
<a name="l1030"><span class="linenum">1030</span></a>  
<a name="l1031"><span class="linenum">1031</span></a>  
<a name="l1032"><span class="linenum">1032</span></a>  <span class="comment">/**</span>
<a name="l1033"><span class="linenum">1033</span></a>  <span class="comment"> * Return antispam SQL query.</span>
<a name="l1034"><span class="linenum">1034</span></a>  <span class="comment"> * This is obfuscated because some hosting companies prevent uploading PHP files</span>
<a name="l1035"><span class="linenum">1035</span></a>  <span class="comment"> * containing &quot;spam&quot; strings.</span>
<a name="l1036"><span class="linenum">1036</span></a>  <span class="comment"> *</span>
<a name="l1037"><span class="linenum">1037</span></a>  <span class="comment"> * @return string;</span>
<a name="l1038"><span class="linenum">1038</span></a>  <span class="comment"> */</span>
<a name="l1039"><span class="linenum">1039</span></a>  function <a class="function" onClick="logFunction('get_antispam_query')" href="../../_functions/get_antispam_query.html" onMouseOver="funcPopup(event,'get_antispam_query')">get_antispam_query</a>()
<a name="l1040"><span class="linenum">1040</span></a>  {
<a name="l1041"><span class="linenum">1041</span></a>  <span class="comment">    //used base64_encode() for getting this code</span>
<a name="l1042"><span class="linenum">1042</span></a>      <a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> = <a class="phpfunction" onClick="logFunction('base64_decode')" href="../../_functions/base64_decode.html" onMouseOver="phpfuncPopup(event,'base64_decode')">base64_decode</a>('SU5TRVJUIElOVE8gVF9hbnRpc3BhbShhc3BtX3N0cmluZykgVkFMVUVTICgnb25saW5lLWNhc2lubycpLCAoJ3BlbmlzLWVubGFyZ2VtZW50JyksICgnb3JkZXItdmlhZ3JhJyksICgnb3JkZXItcGhlbnRlcm1pbmUnKSwgKCdvcmRlci14ZW5pY2FsJyksICgnb3JkZXItcHJvcGhlY2lhJyksICgnc2V4eS1saW5nZXJpZScpLCAoJy1wb3JuLScpLCAoJy1hZHVsdC0nKSwgKCctdGl0cy0nKSwgKCdidXktcGhlbnRlcm1pbmUnKSwgKCdvcmRlci1jaGVhcC1waWxscycpLCAoJ2J1eS14ZW5hZHJpbmUnKSwgKCdwYXJpcy1oaWx0b24nKSwgKCdwYXJpc2hpbHRvbicpLCAoJ2NhbWdpcmxzJyksICgnYWR1bHQtbW9kZWxzJyk=');
<a name="l1043"><span class="linenum">1043</span></a>  <span class="comment">    // pre_dump($r);</span>
<a name="l1044"><span class="linenum">1044</span></a>      return <a class="var it65" onMouseOver="hilite(65)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a>;
<a name="l1045"><span class="linenum">1045</span></a>  }
<a name="l1046"><span class="linenum">1046</span></a>  
<a name="l1047"><span class="linenum">1047</span></a>  <span class="comment">/**</span>
<a name="l1048"><span class="linenum">1048</span></a>  <span class="comment"> * We use the following tracking to determine the installer reliability (% of failed vs successful installs).</span>
<a name="l1049"><span class="linenum">1049</span></a>  <span class="comment"> */</span>
<a name="l1050"><span class="linenum">1050</span></a>  function <a class="function" onClick="logFunction('track_step')" href="../../_functions/track_step.html" onMouseOver="funcPopup(event,'track_step')">track_step</a>( <a class="var it2969" onMouseOver="hilite(2969)" onMouseOut="lolite()" onClick="logVariable('current_step')" href="../../_variables/current_step.html">$current_step</a> )
<a name="l1051"><span class="linenum">1051</span></a>  {
<a name="l1052"><span class="linenum">1052</span></a>  <span class="comment">    // echo 'Tracking '.$current_step;</span>
<a name="l1053"><span class="linenum">1053</span></a>      echo '&lt;img src=&quot;http://b2evolution.net/htsrv/track.php?key='.<a class="var it2969" onMouseOver="hilite(2969)" onMouseOut="lolite()" onClick="logVariable('current_step')" href="../../_variables/current_step.html">$current_step</a>.'&quot; alt=&quot;&quot; /&gt;';
<a name="l1054"><span class="linenum">1054</span></a>  }
<a name="l1055"><span class="linenum">1055</span></a>  
<a name="l1056"><span class="linenum">1056</span></a>  
<a name="l1057"><span class="linenum">1057</span></a>  
<a name="l1058"><span class="linenum">1058</span></a>  ?&gt;
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'set_plugin_status': ['set_plugin_status', 'Sets the status of a Plugin in DB and registers it into the internal indices when "enabled". Otherwise it gets unregistered, but only when we\'re not in {@link Plugins_admin}, because we want to keep it in then in our indices. ', [['blogs/inc/plugins/model','_plugins.class.php',252]], 11],
'evo_flush': ['evo_flush', 'Flush the output buffer ', [['blogs/inc/_core','_misc.funcs.php',6282]], 156],
'load_class': ['load_class', 'Load class file ', [['blogs/inc/_core','_class4.funcs.php',28],['blogs/inc/_core','_class5.funcs.php',79]], 408],
'load_funcs': ['load_funcs', '', [['blogs/inc/_core','_misc.funcs.php',115]], 214],
'install_basic_widgets': ['install_basic_widgets', 'Install basic widgets. ', [['blogs/install','_functions_install.php',665]], 2],
'display_locale_selector': ['display_locale_selector', 'Language selector ', [['blogs/install','_functions_install.php',41]], 4],
'save_error_state': ['save_error_state', 'Save the vars responsible for error handling. This can be chained. ', [['blogs/inc/_core/model/db','_db.class.php',725]], 7],
'quote': ['quote', 'Quote a msgid/msgstr, preferrable with single quotes. ', [['blogs/inc/locales','_pofile.class.php',267],['blogs/inc/_core/model/db','_db.class.php',503]], 791],
'query': ['query', 'Run Query: GET DATA ROWS *** HEAVY *** ', [['blogs/inc/items/model','_itemlist.class.php',256],['blogs/inc/items/model','_itemlistlight.class.php',751],['blogs/inc/_core/model/db','_db.class.php',761],['blogs/inc/users/model','_userlist.class.php',474],['blogs/inc/_core/ui/results','_results.class.php',439],['blogs/inc/comments/model','_commentlist.class.php',515]], 972],
'do_install_htaccess': ['do_install_htaccess', 'This does the actual file manipulations for installing .htaccess This will verify that the provided sample.htaccess does not crash apache in a test folder before installing it for real. ', [['blogs/install','_functions_install.php',956]], 1],
'set': ['set', 'Set param value ', [['blogs/inc/users/model','_userfield.class.php',243],['blogs/inc/generic/model','_genericordered.class.php',75],['blogs/inc/users/model','_group.class.php',204],['blogs/inc/items/model','_itemlight.class.php',1258],['blogs/inc/plugins/model','_pluginsettings.class.php',70],['blogs/inc/widgets/model','_widget.class.php',321],['blogs/inc/regional/model','_region.class.php',102],['blogs/inc/regional/model','_city.class.php',110],['blogs/inc/collections/model','_blog.class.php',1102],['blogs/inc/settings/model','_abstractsettings.class.php',446],['blogs/inc/plugins/model','_pluginusersettings.class.php',82],['blogs/inc/users/model','_user.class.php',1861],['blogs/inc/generic/model','_genericcategory.class.php',100],['blogs/inc/tools/model','_emailaddress.class.php',85],['blogs/inc/users/model','_usersettings.class.php',187],['blogs/inc/regional/model','_country.class.php',106],['blogs/inc/comments/model','_comment.class.php',315],['blogs/inc/users/model','_groupsettings.class.php',140],['blogs/inc/cron/model','_cronjob.class.php',79],['blogs/inc/items/model','_item.class.php',4497],['blogs/inc/files/model','_filetype.class.php',149],['blogs/inc/users/model','_userfieldgroup.class.php',92],['blogs/inc/sessions/model','_session.class.php',420],['blogs/plugins','_calendar.plugin.php',530],['blogs/inc/slugs/model','_slug.class.php',80],['blogs/inc/regional/model','_currency.class.php',96],['blogs/inc/messaging/model','_thread.class.php',185],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',614],['blogs/inc/regional/model','_subregion.class.php',119],['blogs/inc/antispam/model','_iprange.class.php',81],['blogs/inc/sessions/model','_goal.class.php',199]], 1121],
'block_close': ['block_close', 'Close a block ', [['blogs/install','_functions_install.php',27]], 6],
'beforeenable': ['beforeenable', 'Check ping service URL and plugin code. ', [['blogs/plugins','_generic_ping.plugin.php',121],['blogs/plugins/twitter_plugin','_twitter.plugin.php',104],['blogs/plugins/watermark_plugin','_watermark.plugin.php',149],['blogs/plugins','_captcha_qstn.plugin.php',129],['blogs/inc/plugins','_plugin.class.php',1022],['blogs/plugins/geoip_plugin','_geoip.plugin.php',127],['blogs/plugins/basic_antispam_plugin','_basic_antispam.plugin.php',149]], 5],
'install_htaccess': ['install_htaccess', 'Install htaccess: Check if it works with the webserver, then install it for real. ', [['blogs/install','_functions_install.php',917]], 2],
'track_step': ['track_step', 'We use the following tracking to determine the installer reliability (% of failed vs successful installs). ', [['blogs/install','_functions_install.php',1047]], 6],
'fetch_remote_page': ['fetch_remote_page', 'Fetch remote page ', [['blogs/inc/_core','_url.funcs.php',260]], 4],
'load_db_schema': ['load_db_schema', 'Loads the b2evo database scheme. ', [['blogs/install','_functions_install.php',887]], 3],
'install_basic_plugins': ['install_basic_plugins', 'Install basic plugins. ', [['blogs/install','_functions_install.php',526]], 2],
'submit': ['submit', 'Builds a submit input tag ', [['blogs/inc/_core/ui/forms','_form.class.php',2832]], 46],
'create_default_settings': ['create_default_settings', 'Insert default settings into T_settings. ', [['blogs/install','_functions_install.php',382]], 2],
'advanced_properties': ['advanced_properties', '', [['blogs/install','_functions_install.php',697]], 0],
'create_default_locales': ['create_default_locales', 'Insert default locales into T_locales. ', [['blogs/install','_functions_install.php',371]], 1],
'install_basic_skins': ['install_basic_skins', 'Install basic skins. ', [['blogs/install','_functions_install.php',474]], 2],
'evo_htmlspecialchars': ['evo_htmlspecialchars', 'Wrapper function for htmlspecialchars to use the $evo_charset as default charset ', [['blogs/inc/_core','_misc.funcs.php',759]], 138],
'block_open': ['block_open', 'Open a block ', [['blogs/install','_functions_install.php',13]], 8],
'get_assoc': ['get_assoc', 'Function to get the second column from the cached result indexed by the first column ', [['blogs/inc/_core/model/db','_db.class.php',1066]], 49],
'create_demo_contents': ['create_demo_contents', 'This is called only for fresh installs and fills the tables with demo/tutorial things. ', [['blogs/install','_functions_create.php',1213],['blogs/inc/_core/model','_module.class.php',110]], 1],
'get_results': ['get_results', 'Return the the query as a result set - see docs for more details ', [['blogs/inc/_core/model/db','_db.class.php',1092]], 140],
'db_col_exists': ['db_col_exists', '', [['blogs/install','_functions_install.php',303]], 8],
'get_default_locale_from_db': ['get_default_locale_from_db', 'Get default locale from db ', [['blogs/install','_functions_install.php',270]], 1],
'install_newdb': ['install_newdb', 'Install new DB. ', [['blogs/install','_functions_install.php',122]], 1],
'cleanup_comment_quotes': ['cleanup_comment_quotes', 'Clean up extra quotes in comments ', [['blogs/install','_functions_install.php',325]], 1],
't_': ['t_', 'TRANSLATE! ', [['blogs/inc/locales','_locale.funcs.php',48],['blogs/inc/locales','_locale.funcs.php',240],['blogs/inc/skins/model','_skin.class.php',672],['blogs/inc/_core/model','_module.class.php',79],['blogs/rsc/js','blog_widgets.js',422],['blogs/inc/plugins','_plugin.class.php',2617]], 10201],
'get_var': ['get_var', 'Get one variable from the DB - see docs for more detail ', [['blogs/inc/_core/model/db','_db.class.php',961]], 137],
'create_relations': ['create_relations', 'Create relations ', [['blogs/install','_functions_install.php',709]], 0],
'task_end': ['task_end', 'End install task. This will offer other display methods in the future ', [['blogs/install','_functions_install.php',234]], 314],
'get_antispam_query': ['get_antispam_query', 'Return antispam SQL query. This is obfuscated because some hosting companies prevent uploading PHP files containing "spam" strings. ', [['blogs/install','_functions_install.php',1032]], 2],
'task_begin': ['task_begin', 'Begin install task. This will offer other display methods in the future ', [['blogs/install','_functions_install.php',223]], 314],
'restore_error_state': ['restore_error_state', 'Call this after {@link save_halt_on_error()} to restore the previous error state. This can be chained. ', [['blogs/inc/_core/model/db','_db.class.php',741]], 7],
'install_plugin': ['install_plugin', 'Install plugin ', [['blogs/install','_functions_install.php',618]], 22],
'get_manual_url': ['get_manual_url', 'Get the manual url for the given topic ', [['blogs/inc/_core','_misc.funcs.php',4671]], 21],
'install_plugin_db_schema_action': ['install_plugin_db_schema_action', 'Helper function to do the action part of DB schema upgrades for "enable" and "install" actions. ', [['blogs/inc/plugins','_plugin.funcs.php',1063]], 3],
'install': ['install', 'Install current skin to DB ', [['blogs/inc/skins/model','_skin.class.php',95]], 3],
'format': ['format', 'Format a diff. ', [['blogs/inc/_core/model','_diff.class.php',813],['blogs/inc/_core/model','_diff.class.php',976]], 29],
'locale_flag': ['locale_flag', 'Template function: Display locale flag ', [['blogs/inc/locales','_locale.funcs.php',494],['blogs/inc/items/model','_itemlight.class.php',827]], 8],
'dbupdate': ['dbupdate', 'Update the DB based on previously recorded changes ', [['blogs/inc/chapters/model','_chapter.class.php',317],['blogs/inc/collections/model','_collsettings.class.php',260],['blogs/inc/users/model','_group.class.php',470],['blogs/inc/widgets/model','_widget.class.php',757],['blogs/inc/collections/model','_blog.class.php',2327],['blogs/inc/settings/model','_abstractsettings.class.php',593],['blogs/inc/users/model','_user.class.php',2934],['blogs/inc/skins/model','_skin.class.php',348],['blogs/inc/comments/model','_comment.class.php',3470],['blogs/inc/users/model','_groupsettings.class.php',159],['blogs/inc/cron/model','_cronjob.class.php',207],['blogs/inc/items/model','_item.class.php',4867],['blogs/inc/slugs/model','_slug.class.php',265],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',129],['blogs/inc/files/model','_file.class.php',1739]], 266],
'get_db_version': ['get_db_version', '', [['blogs/install','_functions_install.php',244]], 4],
'display_base_config_recap': ['display_base_config_recap', 'Base config recap ', [['blogs/install','_functions_install.php',82]], 2],
'create_default_data': ['create_default_data', 'Insert all default data: ', [['blogs/install','_functions_create.php',64]], 1],
'insert_basic_widgets': ['insert_basic_widgets', '', [['blogs/inc/widgets','_widgets.funcs.php',33]], 3],
'install_validate_requirements': ['install_validate_requirements', 'Validate install requirements. ', [['blogs/install','_functions_install.php',358]], 1],
'param': ['param', 'Sets a parameter with values from the request or to provided default, except if param is already set! ', [['blogs/inc/_core','_param.funcs.php',50]], 1906],
'locale_insert_default': ['locale_insert_default', 'Insert default locales into T_locales. ', [['blogs/inc/locales','_locale.funcs.php',1365]], 2],
'create_tables': ['create_tables', 'Used for fresh install ', [['blogs/install','_functions_create.php',47]], 1],
'dirname': ['dirname', '', [], 186],
'preg_match': ['preg_match', '', [], 363],
'file_get_contents': ['file_get_contents', '', [], 25],
'strtolower': ['strtolower', '', [], 168],
'file_exists': ['file_exists', '', [], 121],
'implode': ['implode', '', [], 456],
'array_keys': ['array_keys', '', [], 69],
'base64_decode': ['base64_decode', '', [], 9],
'stripslashes': ['stripslashes', '', [], 8],
'defined': ['defined', '', [], 874],
'substr': ['substr', '', [], 657],
'trim': ['trim', '', [], 351],
'copy': ['copy', '', [], 14],
'count': ['count', '', [], 754],
'is_a': ['is_a', '', [], 42],
'array_merge': ['array_merge', '', [], 500],
'array_unique': ['array_unique', '', [], 30],
'key': ['key', '', [], 154]};
CLASS_DATA={
'generalsettings': ['generalsettings', 'Class to handle the global settings. ', [['blogs/inc/settings/model','_generalsettings.class.php',38]], 5],
'table': ['table', 'Class Table ', [['blogs/inc/_core/ui','_uiwidget.class.php',248]], 9]};
CONST_DATA={
'EVO_MAIN_INIT': ['EVO_MAIN_INIT', '', [['blogs/inc','_main.inc.php',55],['blogs/install','index.php',25],['blogs/install','debug.php',22]], 827],
'ARRAY_A': ['ARRAY_A', '', [['blogs/inc/_core/model/db','_db.class.php',70]], 31]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Sat Jul  5 12:18:44 2014</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>

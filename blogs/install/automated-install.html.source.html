<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /blogs/install/automated-install.html source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Sat Jul  5 12:18:44 2014 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='blogs/install';
filename='automated-install.html.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/blogs/install/</a> -> <a href="automated-install.html.html">automated-install.html</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="automated-install.html.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="automated-install.html.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
<a name="l2"><span class="linenum">   2</span></a>  &lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
<a name="l3"><span class="linenum">   3</span></a>  &lt;head&gt;
<a name="l4"><span class="linenum">   4</span></a>  &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=iso-8859-1&quot; /&gt;
<a name="l5"><span class="linenum">   5</span></a>      &lt;title&gt;b2evolution Automated Install&lt;/title&gt;
<a name="l6"><span class="linenum">   6</span></a>  &lt;/head&gt;
<a name="l7"><span class="linenum">   7</span></a>  &lt;body&gt;
<a name="l8"><span class="linenum">   8</span></a>      &lt;h1&gt;b2evolution Automated Install/Upgrade&lt;/h1&gt;
<a name="l9"><span class="linenum">   9</span></a>      &lt;h2&gt;Purpose&lt;/h2&gt;
<a name="l10"><span class="linenum">  10</span></a>      &lt;p&gt;This document describes how you can most easily automate the installation of the &lt;a href=&quot;http://b2evolution.net/&quot;&gt;b2evolution&lt;/a&gt; blog software of a hosting account.&lt;/p&gt;
<a name="l11"><span class="linenum">  11</span></a>      &lt;p&gt;This document also addresses automated upgrade of b2evolution.&lt;/p&gt;
<a name="l12"><span class="linenum">  12</span></a>      &lt;h2&gt;Intended audience&lt;/h2&gt;
<a name="l13"><span class="linenum">  13</span></a>      &lt;ul&gt;
<a name="l14"><span class="linenum">  14</span></a>          &lt;li&gt;Web hosting providers&lt;/li&gt;
<a name="l15"><span class="linenum">  15</span></a>          &lt;li&gt;Web hosting tool providers&lt;/li&gt;
<a name="l16"><span class="linenum">  16</span></a>      &lt;/ul&gt;
<a name="l17"><span class="linenum">  17</span></a>      &lt;h2&gt;Operating environment&lt;/h2&gt;
<a name="l18"><span class="linenum">  18</span></a>      &lt;p&gt;b2evolution is a PHP + MySQL web application. At this point we strongly recommend the use of PHP 5 as well as MySQL 5 although b2evolution can work perfectly fine on PHP 4.3 and MySQL 4.0.&lt;/p&gt;
<a name="l19"><span class="linenum">  19</span></a>      &lt;p&gt;Please see our &lt;a href=&quot;http://manual.b2evolution.net/System_requirements&quot;&gt;System Requirements page&lt;/a&gt; for details.&lt;/p&gt;
<a name="l20"><span class="linenum">  20</span></a>      &lt;h2&gt;Basics&lt;/h2&gt;
<a name="l21"><span class="linenum">  21</span></a>      &lt;p&gt;Automated installation of web applications such as b2evolution typically involves these steps:&lt;/p&gt;
<a name="l22"><span class="linenum">  22</span></a>      &lt;ol&gt;
<a name="l23"><span class="linenum">  23</span></a>          &lt;li&gt;Place the application files in the destination directory.&lt;/li&gt;
<a name="l24"><span class="linenum">  24</span></a>          &lt;li&gt;Create a MySQL User, Database and privileges of the user on the database.&lt;/li&gt;
<a name="l25"><span class="linenum">  25</span></a>          &lt;li&gt;Write/update a configuration file with the database login information.&lt;/li&gt;
<a name="l26"><span class="linenum">  26</span></a>          &lt;li&gt;Run the install/setup script of the application.&lt;/li&gt;
<a name="l27"><span class="linenum">  27</span></a>          &lt;li&gt;Delete the installer.&lt;/li&gt;
<a name="l28"><span class="linenum">  28</span></a>      &lt;/ol&gt;
<a name="l29"><span class="linenum">  29</span></a>      &lt;h1&gt;Recommended Auto Install procedure&lt;/h1&gt;
<a name="l30"><span class="linenum">  30</span></a>      &lt;h2&gt;1. Place the application files in the destination directory&lt;/h2&gt;
<a name="l31"><span class="linenum">  31</span></a>      &lt;p&gt;We recommend you prompt the user for a directory to install b2evolution into. If he provides an empty directory, b2evolution would be installed in his web root. Let's pretend the user chose to install into www/myblog/ .&lt;/p&gt;
<a name="l32"><span class="linenum">  32</span></a>      &lt;p&gt;Once the destination directory selected/created, you need to copy all the contents of the /blogs/ directory as provided in the b2evolution package into the destination directory www/myblog/ . &lt;strong&gt;You should not copy the package info files such as the /doc/ directory.&lt;/strong&gt;&lt;/p&gt;
<a name="l33"><span class="linenum">  33</span></a>      &lt;h3&gt;File permissions&lt;/h3&gt;
<a name="l34"><span class="linenum">  34</span></a>      &lt;p&gt;You should make sure that the contents of the www/myblog/media/ directory are writable by PHP. This is the place where the user can upload pictures to insert in his blog posts, etc.&lt;/p&gt;
<a name="l35"><span class="linenum">  35</span></a>      &lt;h2&gt;2. Create a MySQL database&lt;/h2&gt;
<a name="l36"><span class="linenum">  36</span></a>      &lt;p&gt;You will need to provide b2evolution with a database where it will create its own tables.&lt;/p&gt;
<a name="l37"><span class="linenum">  37</span></a>      &lt;h2&gt;3. Write the configuration file&lt;/h2&gt;
<a name="l38"><span class="linenum">  38</span></a>      &lt;p&gt;At this point, you need to write/update the basic configuration file you previously copied to www/myblog/conf/_basic_conf.php .&lt;/p&gt;
<a name="l39"><span class="linenum">  39</span></a>      &lt;p&gt;You need to update the following lines with the database login info:&lt;/p&gt;
<a name="l40"><span class="linenum">  40</span></a>      &lt;pre&gt;<a class="var it1750" onMouseOver="hilite(1750)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../../_variables/db_config.html">$db_config</a> = array(
<a name="l41"><span class="linenum">  41</span></a>   'user'          =&amp;gt; 'demouser',     // your MySQL username
<a name="l42"><span class="linenum">  42</span></a>   'password'      =&amp;gt; 'demopass',     // ...and password
<a name="l43"><span class="linenum">  43</span></a>   'name'          =&amp;gt; 'b2evolution',  // the name of the database
<a name="l44"><span class="linenum">  44</span></a>   'host'          =&amp;gt; 'localhost',    // MySQL Server (typically 'localhost')
<a name="l45"><span class="linenum">  45</span></a>   );
<a name="l46"><span class="linenum">  46</span></a>  &lt;/pre&gt;
<a name="l47"><span class="linenum">  47</span></a>      &lt;p&gt;Then, you should update the user's e-mail address on this line:&lt;br&gt;
<a name="l48"><span class="linenum">  48</span></a>      &lt;/p&gt;
<a name="l49"><span class="linenum">  49</span></a>      &lt;pre&gt;<a class="var it1751" onMouseOver="hilite(1751)" onMouseOut="lolite()" onClick="logVariable('admin_email')" href="../../_variables/admin_email.html">$admin_email</a> = 'postmaster@localhost';&lt;/pre&gt;
<a name="l50"><span class="linenum">  50</span></a>      &lt;p&gt;and you need to tell b2evolution that the configuration has been done by replacing&lt;/p&gt;
<a name="l51"><span class="linenum">  51</span></a>      &lt;pre&gt;<a class="var it1752" onMouseOver="hilite(1752)" onMouseOut="lolite()" onClick="logVariable('config_is_done')" href="../../_variables/config_is_done.html">$config_is_done</a> = 0;&lt;/pre&gt;
<a name="l52"><span class="linenum">  52</span></a>      &lt;p&gt;with&lt;/p&gt;
<a name="l53"><span class="linenum">  53</span></a>      &lt;pre&gt;<a class="var it1752" onMouseOver="hilite(1752)" onMouseOut="lolite()" onClick="logVariable('config_is_done')" href="../../_variables/config_is_done.html">$config_is_done</a> = 1;&lt;/pre&gt;
<a name="l54"><span class="linenum">  54</span></a>      &lt;h2&gt;4. Run the install script&lt;/h2&gt;
<a name="l55"><span class="linenum">  55</span></a>      &lt;p&gt;At this point you can call b2evolution's install script through an HTTP GET <a class="function" onClick="logFunction('request')" href="../../_functions/request.html" onMouseOver="funcPopup(event,'request')">request</a> (wget, cURL, etc..) of this form:&lt;/p&gt;
<a name="l56"><span class="linenum">  56</span></a>      &lt;pre&gt;http://example.com/myblogs/install/index.php?locale=en-US&amp;amp;action=newdb&amp;amp;create_sample_contents=1&lt;/pre&gt;
<a name="l57"><span class="linenum">  57</span></a>      &lt;h3&gt;New in b2evo 2.0.2:&lt;/h3&gt;
<a name="l58"><span class="linenum">  58</span></a>      &lt;p&gt;You can detect that installation has been successful by parsing the output and locating the string &amp;lt;evo:password&amp;gt; .&lt;/p&gt;
<a name="l59"><span class="linenum">  59</span></a>      &lt;p&gt;Furthermore, you can parse out the password that has been created for the user by parsing it out between &amp;lt;evo:password&amp;gt; and &amp;lt;/evo:password&amp;gt;. Example:&lt;/p&gt;
<a name="l60"><span class="linenum">  60</span></a>      &lt;pre&gt;&amp;lt;evo:password&amp;gt;testpwd&amp;lt;/evo:password&amp;gt;&lt;/pre&gt;
<a name="l61"><span class="linenum">  61</span></a>      &lt;h2&gt;5. Delete the install folder&lt;/h2&gt;
<a name="l62"><span class="linenum">  62</span></a>      &lt;p&gt;At this point, the www/myblog/install/ folder is no longer needed. We recommend you delete it, both to save space and improve security.&lt;/p&gt;
<a name="l63"><span class="linenum">  63</span></a>      &lt;p&gt;Note: when upgrading, you will need a &lt;strong&gt;new&lt;/strong&gt; install folder. So there is really no point in keeping it.&lt;/p&gt;
<a name="l64"><span class="linenum">  64</span></a>      &lt;h1&gt;Recommended Auto Upgrade procedure&lt;/h1&gt;
<a name="l65"><span class="linenum">  65</span></a>      &lt;p&gt;Any newer version of b2evolution can upgrade its database from any older version. It will also refuse to update if for some reason you try to &amp;quot;downgrade&amp;quot; it.&lt;/p&gt;
<a name="l66"><span class="linenum">  66</span></a>      &lt;h2&gt;0. Detecting which version of b2evolution is installed&lt;/h2&gt;
<a name="l67"><span class="linenum">  67</span></a>      &lt;p&gt;Open the file www/myblog/conf/_application.php and parse out the line that says:&lt;/p&gt;
<a name="l68"><span class="linenum">  68</span></a>      &lt;pre&gt;<a class="var it461" onMouseOver="hilite(461)" onMouseOut="lolite()" onClick="logVariable('app_version')" href="../../_variables/app_version.html">$app_version</a> = '2.0.2-alpha';&lt;/pre&gt;
<a name="l69"><span class="linenum">  69</span></a>      &lt;p&gt;You can safely ignore the part after the hyphen (-). The version &lt;strong&gt;number&lt;/strong&gt; will always change when a new version is released.&lt;/p&gt;
<a name="l70"><span class="linenum">  70</span></a>      &lt;p&gt;You can compare this version number with the new one you have available.&lt;/p&gt;
<a name="l71"><span class="linenum">  71</span></a>      &lt;p&gt;Note: if using PHP, you can use <a class="phpfunction" onClick="logFunction('version_compare')" href="../../_functions/version_compare.html" onMouseOver="phpfuncPopup(event,'version_compare')">version_compare</a>() which does all the work for you.&lt;/p&gt;
<a name="l72"><span class="linenum">  72</span></a>      &lt;h2&gt;1. Getting confirmation that the user wants to upgrade&lt;/h2&gt;
<a name="l73"><span class="linenum">  73</span></a>      &lt;p&gt;You should warn the user that any customizations he may have added to his existing b2evolution may not work properly with the new version. This especially applies to custom skins, custom plugins and custom locales (translations).&lt;/p&gt;
<a name="l74"><span class="linenum">  74</span></a>      &lt;p&gt;Optionally, you may want to provide checkboxes for the following:&lt;/p&gt;
<a name="l75"><span class="linenum">  75</span></a>      &lt;ul&gt;
<a name="l76"><span class="linenum">  76</span></a>          &lt;li&gt;Reset skins&lt;/li&gt;
<a name="l77"><span class="linenum">  77</span></a>          &lt;li&gt;Reset plugins&lt;/li&gt;
<a name="l78"><span class="linenum">  78</span></a>          &lt;li&gt;Reset locales (translations)&lt;/li&gt;
<a name="l79"><span class="linenum">  79</span></a>      &lt;/ul&gt;
<a name="l80"><span class="linenum">  80</span></a>      &lt;h2&gt;2. Replacing the files&lt;/h2&gt;
<a name="l81"><span class="linenum">  81</span></a>      &lt;p&gt;Delete all files &amp;amp; folders from the &lt;strong&gt;www/myblog/&lt;/strong&gt; except:&lt;/p&gt;
<a name="l82"><span class="linenum">  82</span></a>      &lt;ul&gt;
<a name="l83"><span class="linenum">  83</span></a>          &lt;li&gt; &lt;strong&gt;www/myblog/media/&lt;/strong&gt; (where the user has uploaded his content files).&lt;/li&gt;
<a name="l84"><span class="linenum">  84</span></a>          &lt;li&gt;If the user hasn't requested a reset of these, also keep:
<a name="l85"><span class="linenum">  85</span></a>              &lt;ul&gt;
<a name="l86"><span class="linenum">  86</span></a>                  &lt;li&gt;&lt;strong&gt;www/myblog/skins&lt;/strong&gt;/&lt;/li&gt;
<a name="l87"><span class="linenum">  87</span></a>                  &lt;li&gt;&lt;strong&gt;www/myblog/plugins/&lt;/strong&gt;&lt;/li&gt;
<a name="l88"><span class="linenum">  88</span></a>                  &lt;li&gt;&lt;strong&gt;www/myblog/locales/&lt;/strong&gt;&lt;/li&gt;
<a name="l89"><span class="linenum">  89</span></a>              &lt;/ul&gt;
<a name="l90"><span class="linenum">  90</span></a>          &lt;/li&gt;
<a name="l91"><span class="linenum">  91</span></a>          &lt;li&gt;&lt;strong&gt;www/conf/_basic_config.php&lt;/strong&gt; (no need to rewrite that one)&lt;/li&gt;
<a name="l92"><span class="linenum">  92</span></a>      &lt;/ul&gt;
<a name="l93"><span class="linenum">  93</span></a>      &lt;p&gt;&lt;strong&gt;Warning: if the user has installed into the root folder, you may not want to delete &amp;quot;all files &amp;amp; folders&amp;quot;!&lt;/strong&gt; In this case, the folders you should delete are:&lt;/p&gt;
<a name="l94"><span class="linenum">  94</span></a>      &lt;ul&gt;
<a name="l95"><span class="linenum">  95</span></a>          &lt;li&gt;www/cron/&lt;/li&gt;
<a name="l96"><span class="linenum">  96</span></a>          &lt;li&gt;www/htsrv/&lt;/li&gt;
<a name="l97"><span class="linenum">  97</span></a>          &lt;li&gt;www/inc/&lt;/li&gt;
<a name="l98"><span class="linenum">  98</span></a>          &lt;li&gt;www/install/ (if it's still there)&lt;/li&gt;
<a name="l99"><span class="linenum">  99</span></a>          &lt;li&gt;www/locales/ (if requested)&lt;/li&gt;
<a name="l100"><span class="linenum"> 100</span></a>          &lt;li&gt;www/plugins/ (if requested)&lt;/li&gt;
<a name="l101"><span class="linenum"> 101</span></a>          &lt;li&gt;www/rsc/&lt;/li&gt;
<a name="l102"><span class="linenum"> 102</span></a>          &lt;li&gt;www/skins/ (if requested)&lt;/li&gt;
<a name="l103"><span class="linenum"> 103</span></a>          &lt;li&gt;www/skins_adm/&lt;/li&gt;
<a name="l104"><span class="linenum"> 104</span></a>          &lt;li&gt;www/xmlsrv/&lt;/li&gt;
<a name="l105"><span class="linenum"> 105</span></a>      &lt;/ul&gt;
<a name="l106"><span class="linenum"> 106</span></a>      &lt;p&gt;After than copy all files from the new b2evolution's /blogs/ folder, &lt;strong&gt;except /blogs/media/ and /blogs/conf/_basic_config.php &lt;/strong&gt;.&lt;/p&gt;
<a name="l107"><span class="linenum"> 107</span></a>      &lt;h2&gt;3. Upgrading the database&lt;/h2&gt;
<a name="l108"><span class="linenum"> 108</span></a>      &lt;p&gt;At this point you can call b2evolution's install script through an HTTP GET <a class="function" onClick="logFunction('request')" href="../../_functions/request.html" onMouseOver="funcPopup(event,'request')">request</a> (wget, cURL, etc..) of this form:&lt;/p&gt;
<a name="l109"><span class="linenum"> 109</span></a>      &lt;pre&gt;http://example.com/myblogs/install/index.php?locale=en-US&amp;amp;action=evoupgrade
<a name="l110"><span class="linenum"> 110</span></a>  &lt;/pre&gt;
<a name="l111"><span class="linenum"> 111</span></a>      &lt;h2&gt;4. Delete the install folder&lt;/h2&gt;
<a name="l112"><span class="linenum"> 112</span></a>      &lt;p&gt;At this point, the www/myblog/install/ folder is no longer needed. We recommend you delete it, both to save space and improve security.&lt;/p&gt;
<a name="l113"><span class="linenum"> 113</span></a>      &lt;p&gt;Note: when upgrading again, you will need a &lt;strong&gt;new&lt;/strong&gt; install folder. So there is really no point in keeping it.&lt;/p&gt;
<a name="l114"><span class="linenum"> 114</span></a>      &lt;h1&gt;&lt;/h1&gt;
<a name="l115"><span class="linenum"> 115</span></a>  &lt;/body&gt;
<a name="l116"><span class="linenum"> 116</span></a>  &lt;/html&gt;
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'request': ['request', 'Open a connection, send request, read header and body. ', [['blogs/inc/_ext/phpsvnclient','phpsvnclient.php',975]], 8],
'version_compare': ['version_compare', '', [], 83]};
CLASS_DATA={
};
CONST_DATA={
};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Sat Jul  5 12:18:44 2014</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>

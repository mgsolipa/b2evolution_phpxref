<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /blogs/install/index.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Sat Jul  5 12:18:44 2014 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='blogs/install';
filename='index.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/blogs/install/</a> -> <a href="index.php.html">index.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="index.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="index.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">/**</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment"> * This is the main install menu</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment"> *</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment"> * IF YOU ARE READING THIS IN YOUR WEB BROWSER, IT MEANS THAT PHP IS NOT PROPERLY INSTALLED</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment"> * ON YOUR WEB SERVER. IF YOU DON'T KNOW WHAT THIS MEANS, CONTACT YOUR SERVER ADMINISTRATOR</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment"> * OR YOUR HOSTING COMPANY.</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment"> *</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment"> * b2evolution - {@link http://b2evolution.net/}</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment"> * Released under GNU GPL License - {@link http://b2evolution.net/about/license.html}</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment"> * @copyright (c)2003-2014 by Francois Planque - {@link http://fplanque.com/}</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment"> *</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment"> * @package install</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment"> */</span>
<a name="l15"><span class="linenum">  15</span></a>  
<a name="l16"><span class="linenum">  16</span></a>  <span class="comment">// Turn off the output buffering to do the correct work of the function flush()</span>
<a name="l17"><span class="linenum">  17</span></a>  @<a class="phpfunction" onClick="logFunction('ini_set')" href="../../_functions/ini_set.html" onMouseOver="phpfuncPopup(event,'ini_set')">ini_set</a>( 'output_buffering', 'off' );
<a name="l18"><span class="linenum">  18</span></a>  
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment">/**</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * include config and default functions:</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> */</span>
<a name="l22"><span class="linenum">  22</span></a>  require_once <a class="phpfunction" onClick="logFunction('dirname')" href="../../_functions/dirname.html" onMouseOver="phpfuncPopup(event,'dirname')">dirname</a>(__FILE__).'/../conf/_config.php';
<a name="l23"><span class="linenum">  23</span></a>  
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment">// Make the includes believe they are being called in the right place...</span>
<a name="l25"><span class="linenum">  25</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>( '<a class="constant" onClick="logConstant('EVO_MAIN_INIT')" href="../../_constants/EVO_MAIN_INIT.html" onMouseOver="constPopup(event,'EVO_MAIN_INIT')">EVO_MAIN_INIT</a>', true );
<a name="l26"><span class="linenum">  26</span></a>  
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment">/**</span>
<a name="l28"><span class="linenum">  28</span></a>  <span class="comment"> * Define that we're in the install process.</span>
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment"> */</span>
<a name="l30"><span class="linenum">  30</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>( '<a class="constant" onClick="logConstant('EVO_IS_INSTALLING')" href="../../_constants/EVO_IS_INSTALLING.html" onMouseOver="constPopup(event,'EVO_IS_INSTALLING')">EVO_IS_INSTALLING</a>', true );
<a name="l31"><span class="linenum">  31</span></a>  
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment">// Force to display errors during install/upgrade, even when not in debug mode</span>
<a name="l33"><span class="linenum">  33</span></a>  <a class="var it2004" onMouseOver="hilite(2004)" onMouseOut="lolite()" onClick="logVariable('display_errors_on_production')" href="../../_variables/display_errors_on_production.html">$display_errors_on_production</a> = true;
<a name="l34"><span class="linenum">  34</span></a>  
<a name="l35"><span class="linenum">  35</span></a>  <a class="var it3765" onMouseOver="hilite(3765)" onMouseOut="lolite()" onClick="logVariable('script_start_time')" href="../../_variables/script_start_time.html">$script_start_time</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l36"><span class="linenum">  36</span></a>  <a class="var it13" onMouseOver="hilite(13)" onMouseOut="lolite()" onClick="logVariable('localtimenow')" href="../../_variables/localtimenow.html">$localtimenow</a> = <a class="var it3765" onMouseOver="hilite(3765)" onMouseOut="lolite()" onClick="logVariable('script_start_time')" href="../../_variables/script_start_time.html">$script_start_time</a>; <span class="comment">// used e.g. for post_datemodified (sample posts)</span>
<a name="l37"><span class="linenum">  37</span></a>  
<a name="l38"><span class="linenum">  38</span></a>  if( ! <a class="var it1752" onMouseOver="hilite(1752)" onMouseOut="lolite()" onClick="logVariable('config_is_done')" href="../../_variables/config_is_done.html">$config_is_done</a> )
<a name="l39"><span class="linenum">  39</span></a>  {    // Base config is not done yet, try to guess some values needed for correct display:
<a name="l40"><span class="linenum">  40</span></a>      <a class="var it566" onMouseOver="hilite(566)" onMouseOut="lolite()" onClick="logVariable('rsc_url')" href="../../_variables/rsc_url.html">$rsc_url</a> = '../rsc/';
<a name="l41"><span class="linenum">  41</span></a>  }
<a name="l42"><span class="linenum">  42</span></a>  
<a name="l43"><span class="linenum">  43</span></a>  require_once <a class="var it246" onMouseOver="hilite(246)" onMouseOut="lolite()" onClick="logVariable('inc_path')" href="../../_variables/inc_path.html">$inc_path</a>.'_core/_class'.<a class="phpfunction" onClick="logFunction('floor')" href="../../_functions/floor.html" onMouseOver="phpfuncPopup(event,'floor')">floor</a>(PHP_VERSION).'.funcs.php';
<a name="l44"><span class="linenum">  44</span></a>  require_once <a class="var it246" onMouseOver="hilite(246)" onMouseOut="lolite()" onClick="logVariable('inc_path')" href="../../_variables/inc_path.html">$inc_path</a>.'_core/_misc.funcs.php';
<a name="l45"><span class="linenum">  45</span></a>  
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment">/**</span>
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment"> * Load locale related functions</span>
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment"> */</span>
<a name="l49"><span class="linenum">  49</span></a>  require_once <a class="var it246" onMouseOver="hilite(246)" onMouseOut="lolite()" onClick="logVariable('inc_path')" href="../../_variables/inc_path.html">$inc_path</a>.'locales/_locale.funcs.php';
<a name="l50"><span class="linenum">  50</span></a>  
<a name="l51"><span class="linenum">  51</span></a>  <a class="function" onClick="logFunction('load_class')" href="../../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( '_core/model/_log.class.php', 'Log');
<a name="l52"><span class="linenum">  52</span></a>  <a class="var it123" onMouseOver="hilite(123)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../_variables/Debuglog.html">$Debuglog</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Log')" href="../../_classes/log.html" onMouseOver="classPopup(event,'log')">Log</a>();
<a name="l53"><span class="linenum">  53</span></a>  <a class="function" onClick="logFunction('load_class')" href="../../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( '_core/model/_messages.class.php', 'Messages');
<a name="l54"><span class="linenum">  54</span></a>  <a class="var it14" onMouseOver="hilite(14)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Messages')" href="../../_classes/messages.html" onMouseOver="classPopup(event,'messages')">Messages</a>();
<a name="l55"><span class="linenum">  55</span></a>  
<a name="l56"><span class="linenum">  56</span></a>  <span class="comment">/**</span>
<a name="l57"><span class="linenum">  57</span></a>  <span class="comment"> * Load modules.</span>
<a name="l58"><span class="linenum">  58</span></a>  <span class="comment"> *</span>
<a name="l59"><span class="linenum">  59</span></a>  <span class="comment"> * This initializes table name aliases and is required before trying to connect to the DB.</span>
<a name="l60"><span class="linenum">  60</span></a>  <span class="comment"> */</span>
<a name="l61"><span class="linenum">  61</span></a>  <a class="function" onClick="logFunction('load_class')" href="../../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( '_core/model/_module.class.php', 'Module' );
<a name="l62"><span class="linenum">  62</span></a>  foreach( <a class="var it5426" onMouseOver="hilite(5426)" onMouseOut="lolite()" onClick="logVariable('modules')" href="../../_variables/modules.html">$modules</a> as <a class="var it5427" onMouseOver="hilite(5427)" onMouseOut="lolite()" onClick="logVariable('module')" href="../../_variables/module.html">$module</a> )
<a name="l63"><span class="linenum">  63</span></a>  {
<a name="l64"><span class="linenum">  64</span></a>      require_once <a class="var it246" onMouseOver="hilite(246)" onMouseOut="lolite()" onClick="logVariable('inc_path')" href="../../_variables/inc_path.html">$inc_path</a>.<a class="var it5427" onMouseOver="hilite(5427)" onMouseOut="lolite()" onClick="logVariable('module')" href="../../_variables/module.html">$module</a>.'/_'.<a class="var it5427" onMouseOver="hilite(5427)" onMouseOut="lolite()" onClick="logVariable('module')" href="../../_variables/module.html">$module</a>.'.init.php';
<a name="l65"><span class="linenum">  65</span></a>  }
<a name="l66"><span class="linenum">  66</span></a>  
<a name="l67"><span class="linenum">  67</span></a>  <span class="comment">// fp&gt; TODO: we may want to try to get the base init into here somehow</span>
<a name="l68"><span class="linenum">  68</span></a>  <span class="comment">// $require_base_config = false;</span>
<a name="l69"><span class="linenum">  69</span></a>  
<a name="l70"><span class="linenum">  70</span></a>  require_once <a class="var it1882" onMouseOver="hilite(1882)" onMouseOut="lolite()" onClick="logVariable('conf_path')" href="../../_variables/conf_path.html">$conf_path</a>.'_upgrade.php';
<a name="l71"><span class="linenum">  71</span></a>  <span class="comment">// no longer exists: require_once $inc_path.'_vars.inc.php';</span>
<a name="l72"><span class="linenum">  72</span></a>  <a class="function" onClick="logFunction('load_class')" href="../../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( '/_core/model/db/_db.class.php', 'DB' );
<a name="l73"><span class="linenum">  73</span></a>  <span class="comment">//load_funcs('collections/model/_blog.funcs.php');</span>
<a name="l74"><span class="linenum">  74</span></a>  <span class="comment">//load_funcs('collections/model/_category.funcs.php');</span>
<a name="l75"><span class="linenum">  75</span></a>  <span class="comment">//load_class( 'items/model/_item.class.php', 'Item' );</span>
<a name="l76"><span class="linenum">  76</span></a>  <span class="comment">//load_funcs('items/model/_item.funcs.php');</span>
<a name="l77"><span class="linenum">  77</span></a>  <span class="comment">//load_funcs('users/model/_user.funcs.php');</span>
<a name="l78"><span class="linenum">  78</span></a>  <span class="comment">//load_funcs( '_core/ui/forms/_form.funcs.php' );</span>
<a name="l79"><span class="linenum">  79</span></a>  <a class="function" onClick="logFunction('load_class')" href="../../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( '_core/model/_timer.class.php', 'Timer' );
<a name="l80"><span class="linenum">  80</span></a>  <span class="comment">//load_class( 'plugins/model/_plugins.class.php', 'Plugins' );</span>
<a name="l81"><span class="linenum">  81</span></a>  <a class="function" onClick="logFunction('load_funcs')" href="../../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>( '_core/_url.funcs.php' );
<a name="l82"><span class="linenum">  82</span></a>  
<a name="l83"><span class="linenum">  83</span></a>  
<a name="l84"><span class="linenum">  84</span></a>  require_once <a class="phpfunction" onClick="logFunction('dirname')" href="../../_functions/dirname.html" onMouseOver="phpfuncPopup(event,'dirname')">dirname</a>(__FILE__).'/_functions_install.php';
<a name="l85"><span class="linenum">  85</span></a>  
<a name="l86"><span class="linenum">  86</span></a>  <a class="var it146" onMouseOver="hilite(146)" onMouseOut="lolite()" onClick="logVariable('Timer')" href="../../_variables/Timer.html">$Timer</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Timer')" href="../../_classes/timer.html" onMouseOver="classPopup(event,'timer')">Timer</a>('main');
<a name="l87"><span class="linenum">  87</span></a>  
<a name="l88"><span class="linenum">  88</span></a>  <a class="function" onClick="logFunction('load_funcs')" href="../../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>('_core/_param.funcs.php');
<a name="l89"><span class="linenum">  89</span></a>  
<a name="l90"><span class="linenum">  90</span></a>  <span class="comment">// Let the modules load/register what they need:</span>
<a name="l91"><span class="linenum">  91</span></a>  <a class="function" onClick="logFunction('modules_call_method')" href="../../_functions/modules_call_method.html" onMouseOver="funcPopup(event,'modules_call_method')">modules_call_method</a>( 'init' );
<a name="l92"><span class="linenum">  92</span></a>  
<a name="l93"><span class="linenum">  93</span></a>  
<a name="l94"><span class="linenum">  94</span></a>  <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'action', 'string', 'default' );
<a name="l95"><span class="linenum">  95</span></a>  <span class="comment">// check if we should try to connect to db if config is not done</span>
<a name="l96"><span class="linenum">  96</span></a>  switch( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> )
<a name="l97"><span class="linenum">  97</span></a>  {
<a name="l98"><span class="linenum">  98</span></a>      case 'evoupgrade':
<a name="l99"><span class="linenum">  99</span></a>      case 'auto_upgrade':
<a name="l100"><span class="linenum"> 100</span></a>      case 'svn_upgrade':
<a name="l101"><span class="linenum"> 101</span></a>      case 'newdb':
<a name="l102"><span class="linenum"> 102</span></a>      case 'cafelogupgrade':
<a name="l103"><span class="linenum"> 103</span></a>      case 'deletedb':
<a name="l104"><span class="linenum"> 104</span></a>      case 'menu':
<a name="l105"><span class="linenum"> 105</span></a>      case 'localeinfo':
<a name="l106"><span class="linenum"> 106</span></a>      case 'utf8upgrade':
<a name="l107"><span class="linenum"> 107</span></a>          <a class="var it5428" onMouseOver="hilite(5428)" onMouseOut="lolite()" onClick="logVariable('try_db_connect')" href="../../_variables/try_db_connect.html">$try_db_connect</a> = true;
<a name="l108"><span class="linenum"> 108</span></a>          break;
<a name="l109"><span class="linenum"> 109</span></a>      case 'start':
<a name="l110"><span class="linenum"> 110</span></a>      case 'conf':
<a name="l111"><span class="linenum"> 111</span></a>      case 'default':
<a name="l112"><span class="linenum"> 112</span></a>          <a class="var it5428" onMouseOver="hilite(5428)" onMouseOut="lolite()" onClick="logVariable('try_db_connect')" href="../../_variables/try_db_connect.html">$try_db_connect</a> = false;
<a name="l113"><span class="linenum"> 113</span></a>          break;
<a name="l114"><span class="linenum"> 114</span></a>      default:
<a name="l115"><span class="linenum"> 115</span></a>  <span class="comment">        // set a valid action</span>
<a name="l116"><span class="linenum"> 116</span></a>          <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> = 'default';
<a name="l117"><span class="linenum"> 117</span></a>          <a class="var it5428" onMouseOver="hilite(5428)" onMouseOut="lolite()" onClick="logVariable('try_db_connect')" href="../../_variables/try_db_connect.html">$try_db_connect</a> = false;
<a name="l118"><span class="linenum"> 118</span></a>          break;
<a name="l119"><span class="linenum"> 119</span></a>  }
<a name="l120"><span class="linenum"> 120</span></a>  
<a name="l121"><span class="linenum"> 121</span></a>  <a class="var it2430" onMouseOver="hilite(2430)" onMouseOut="lolite()" onClick="logVariable('timestamp')" href="../../_variables/timestamp.html">$timestamp</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() - 120; <span class="comment">// We start dates 2 minutes ago because their dates increase 1 second at a time and we want everything to be visible when the user watches the blogs right after install :P</span>
<a name="l122"><span class="linenum"> 122</span></a>  
<a name="l123"><span class="linenum"> 123</span></a>  <span class="comment">// Load all available locale defintions:</span>
<a name="l124"><span class="linenum"> 124</span></a>  <a class="function" onClick="logFunction('locales_load_available_defs')" href="../../_functions/locales_load_available_defs.html" onMouseOver="funcPopup(event,'locales_load_available_defs')">locales_load_available_defs</a>();
<a name="l125"><span class="linenum"> 125</span></a>  <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'locale', 'string' );
<a name="l126"><span class="linenum"> 126</span></a>  <a class="var it5429" onMouseOver="hilite(5429)" onMouseOut="lolite()" onClick="logVariable('use_locale_from_request')" href="../../_variables/use_locale_from_request.html">$use_locale_from_request</a> = false;
<a name="l127"><span class="linenum"> 127</span></a>  if( <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>( '/[a-z]{2}-[A-Z]{2}(-.{1,14})?/', <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('locale')" href="../../_variables/locale.html">$locale</a> ) )
<a name="l128"><span class="linenum"> 128</span></a>  {
<a name="l129"><span class="linenum"> 129</span></a>      <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a> = <a class="var it22" onMouseOver="hilite(22)" onMouseOut="lolite()" onClick="logVariable('locale')" href="../../_variables/locale.html">$locale</a>;
<a name="l130"><span class="linenum"> 130</span></a>      <a class="var it5429" onMouseOver="hilite(5429)" onMouseOut="lolite()" onClick="logVariable('use_locale_from_request')" href="../../_variables/use_locale_from_request.html">$use_locale_from_request</a> = true;
<a name="l131"><span class="linenum"> 131</span></a>  }
<a name="l132"><span class="linenum"> 132</span></a>  if( ! empty( <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a> ) &amp;&amp; ! empty( <a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('locales')" href="../../_variables/locales.html">$locales</a> ) &amp;&amp; isset( <a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('locales')" href="../../_variables/locales.html">$locales</a>[ <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a> ] ) )
<a name="l133"><span class="linenum"> 133</span></a>  { // Set correct charset, The main using is for DB connection
<a name="l134"><span class="linenum"> 134</span></a>      <a class="var it694" onMouseOver="hilite(694)" onMouseOut="lolite()" onClick="logVariable('evo_charset')" href="../../_variables/evo_charset.html">$evo_charset</a> = <a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('locales')" href="../../_variables/locales.html">$locales</a>[ <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a> ]['charset'];
<a name="l135"><span class="linenum"> 135</span></a>  }
<a name="l136"><span class="linenum"> 136</span></a>  
<a name="l137"><span class="linenum"> 137</span></a>  if( <a class="var it1752" onMouseOver="hilite(1752)" onMouseOut="lolite()" onClick="logVariable('config_is_done')" href="../../_variables/config_is_done.html">$config_is_done</a> || <a class="var it5428" onMouseOver="hilite(5428)" onMouseOut="lolite()" onClick="logVariable('try_db_connect')" href="../../_variables/try_db_connect.html">$try_db_connect</a> )
<a name="l138"><span class="linenum"> 138</span></a>  { // Connect to DB:
<a name="l139"><span class="linenum"> 139</span></a>  
<a name="l140"><span class="linenum"> 140</span></a>      <a class="var it5430" onMouseOver="hilite(5430)" onMouseOut="lolite()" onClick="logVariable('tmp_evoconf_db')" href="../../_variables/tmp_evoconf_db.html">$tmp_evoconf_db</a> = <a class="var it1750" onMouseOver="hilite(1750)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../../_variables/db_config.html">$db_config</a>;
<a name="l141"><span class="linenum"> 141</span></a>  
<a name="l142"><span class="linenum"> 142</span></a>  <span class="comment">    // We want a friendly message if we can't connect:</span>
<a name="l143"><span class="linenum"> 143</span></a>      <a class="var it5430" onMouseOver="hilite(5430)" onMouseOut="lolite()" onClick="logVariable('tmp_evoconf_db')" href="../../_variables/tmp_evoconf_db.html">$tmp_evoconf_db</a>['halt_on_error'] = false;
<a name="l144"><span class="linenum"> 144</span></a>      <a class="var it5430" onMouseOver="hilite(5430)" onMouseOut="lolite()" onClick="logVariable('tmp_evoconf_db')" href="../../_variables/tmp_evoconf_db.html">$tmp_evoconf_db</a>['show_errors'] = false;
<a name="l145"><span class="linenum"> 145</span></a>  
<a name="l146"><span class="linenum"> 146</span></a>  <span class="comment">    // Make sure we use the proper charset:</span>
<a name="l147"><span class="linenum"> 147</span></a>      <a class="var it5430" onMouseOver="hilite(5430)" onMouseOut="lolite()" onClick="logVariable('tmp_evoconf_db')" href="../../_variables/tmp_evoconf_db.html">$tmp_evoconf_db</a>['connection_charset'] = <a class="var it694" onMouseOver="hilite(694)" onMouseOut="lolite()" onClick="logVariable('evo_charset')" href="../../_variables/evo_charset.html">$evo_charset</a>;
<a name="l148"><span class="linenum"> 148</span></a>  
<a name="l149"><span class="linenum"> 149</span></a>  <span class="comment">    // CONNECT TO DB:</span>
<a name="l150"><span class="linenum"> 150</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a> = <span class="keyword">new </span><a class="class" onClick="logClass('DB')" href="../../_classes/db.html" onMouseOver="classPopup(event,'db')">DB</a>( <a class="var it5430" onMouseOver="hilite(5430)" onMouseOut="lolite()" onClick="logVariable('tmp_evoconf_db')" href="../../_variables/tmp_evoconf_db.html">$tmp_evoconf_db</a> );
<a name="l151"><span class="linenum"> 151</span></a>      unset(<a class="var it5430" onMouseOver="hilite(5430)" onMouseOut="lolite()" onClick="logVariable('tmp_evoconf_db')" href="../../_variables/tmp_evoconf_db.html">$tmp_evoconf_db</a>);
<a name="l152"><span class="linenum"> 152</span></a>  
<a name="l153"><span class="linenum"> 153</span></a>      if( !<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('error')" class="var it8966" onMouseOver="hilite(8966)" onMouseOut="lolite()" href="../../_variables/error.html">error</a> )
<a name="l154"><span class="linenum"> 154</span></a>      { // restart conf
<a name="l155"><span class="linenum"> 155</span></a>          <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('halt_on_error')" class="var it8966" onMouseOver="hilite(8966)" onMouseOut="lolite()" href="../../_variables/halt_on_error.html">halt_on_error</a> = true;  <span class="comment">// From now on, halt on errors.</span>
<a name="l156"><span class="linenum"> 156</span></a>          <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('show_errors')" class="var it8966" onMouseOver="hilite(8966)" onMouseOut="lolite()" href="../../_variables/show_errors.html">show_errors</a> = true;    <span class="comment">// From now on, show errors (they're helpful in case of errors!).</span>
<a name="l157"><span class="linenum"> 157</span></a>  
<a name="l158"><span class="linenum"> 158</span></a>  <span class="comment">        // Check MySQL version</span>
<a name="l159"><span class="linenum"> 159</span></a>          <a class="var it3929" onMouseOver="hilite(3929)" onMouseOut="lolite()" onClick="logVariable('mysql_version')" href="../../_variables/mysql_version.html">$mysql_version</a> = <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_version')" href="../../_functions/get_version.html" onMouseOver="funcPopup(event,'get_version')">get_version</a>();
<a name="l160"><span class="linenum"> 160</span></a>          foreach( <a class="var it2137" onMouseOver="hilite(2137)" onMouseOut="lolite()" onClick="logVariable('required_mysql_version')" href="../../_variables/required_mysql_version.html">$required_mysql_version</a> as <a class="var it963" onMouseOver="hilite(963)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> =&gt; <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> )
<a name="l161"><span class="linenum"> 161</span></a>          { // check required MySQL version for the whole application and for each module
<a name="l162"><span class="linenum"> 162</span></a>              if( <a class="phpfunction" onClick="logFunction('version_compare')" href="../../_functions/version_compare.html" onMouseOver="phpfuncPopup(event,'version_compare')">version_compare</a>( <a class="var it3929" onMouseOver="hilite(3929)" onMouseOut="lolite()" onClick="logVariable('mysql_version')" href="../../_variables/mysql_version.html">$mysql_version</a>, <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>, '&lt;' ) )
<a name="l163"><span class="linenum"> 163</span></a>              {
<a name="l164"><span class="linenum"> 164</span></a>                  if( <a class="var it963" onMouseOver="hilite(963)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a> == 'application' )
<a name="l165"><span class="linenum"> 165</span></a>                  {
<a name="l166"><span class="linenum"> 166</span></a>                      <a class="var it350" onMouseOver="hilite(350)" onMouseOut="lolite()" onClick="logVariable('error_message')" href="../../_variables/error_message.html">$error_message</a> = sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The minimum requirement for this version of b2evolution is %s version %s but you are trying to use version %s!'), 'MySQL', <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>, <a class="var it3929" onMouseOver="hilite(3929)" onMouseOut="lolite()" onClick="logVariable('mysql_version')" href="../../_variables/mysql_version.html">$mysql_version</a> );
<a name="l167"><span class="linenum"> 167</span></a>                  }
<a name="l168"><span class="linenum"> 168</span></a>                  else
<a name="l169"><span class="linenum"> 169</span></a>                  {
<a name="l170"><span class="linenum"> 170</span></a>                      <a class="var it350" onMouseOver="hilite(350)" onMouseOut="lolite()" onClick="logVariable('error_message')" href="../../_variables/error_message.html">$error_message</a> = sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The minimum requirement for %s module is %s version %s but you are trying to use version %s!'), <a class="var it963" onMouseOver="hilite(963)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../_variables/key.html">$key</a>, 'MySQL', <a class="var it161" onMouseOver="hilite(161)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>, <a class="var it3929" onMouseOver="hilite(3929)" onMouseOut="lolite()" onClick="logVariable('mysql_version')" href="../../_variables/mysql_version.html">$mysql_version</a> );
<a name="l171"><span class="linenum"> 171</span></a>                  }
<a name="l172"><span class="linenum"> 172</span></a>                  die( '&lt;h1&gt;Insufficient Requirements&lt;/h1&gt;&lt;div class=&quot;error&quot;&gt;&lt;p class=&quot;error&quot;&gt;&lt;strong&gt;'.<a class="var it350" onMouseOver="hilite(350)" onMouseOut="lolite()" onClick="logVariable('error_message')" href="../../_variables/error_message.html">$error_message</a>.'&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;');
<a name="l173"><span class="linenum"> 173</span></a>              }
<a name="l174"><span class="linenum"> 174</span></a>          }
<a name="l175"><span class="linenum"> 175</span></a>      }
<a name="l176"><span class="linenum"> 176</span></a>  }
<a name="l177"><span class="linenum"> 177</span></a>  
<a name="l178"><span class="linenum"> 178</span></a>  if( ! <a class="var it5429" onMouseOver="hilite(5429)" onMouseOut="lolite()" onClick="logVariable('use_locale_from_request')" href="../../_variables/use_locale_from_request.html">$use_locale_from_request</a> )
<a name="l179"><span class="linenum"> 179</span></a>  { // detect language
<a name="l180"><span class="linenum"> 180</span></a>  <span class="comment">    // try to check if db already exists and default locale is set on it</span>
<a name="l181"><span class="linenum"> 181</span></a>      <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a> = <a class="function" onClick="logFunction('get_default_locale_from_db')" href="../../_functions/get_default_locale_from_db.html" onMouseOver="funcPopup(event,'get_default_locale_from_db')">get_default_locale_from_db</a>();
<a name="l182"><span class="linenum"> 182</span></a>      if( empty( <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a> ) )
<a name="l183"><span class="linenum"> 183</span></a>      { // db doesn't exists yet
<a name="l184"><span class="linenum"> 184</span></a>          <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a> = <a class="function" onClick="logFunction('locale_from_httpaccept')" href="../../_functions/locale_from_httpaccept.html" onMouseOver="funcPopup(event,'locale_from_httpaccept')">locale_from_httpaccept</a>();
<a name="l185"><span class="linenum"> 185</span></a>      }
<a name="l186"><span class="linenum"> 186</span></a>  <span class="comment">    // echo 'detected locale: ' . $default_locale. '&lt;br /&gt;';</span>
<a name="l187"><span class="linenum"> 187</span></a>      if( isset( <a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('locales')" href="../../_variables/locales.html">$locales</a>[ <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a> ] ) &amp;&amp; <a class="var it694" onMouseOver="hilite(694)" onMouseOut="lolite()" onClick="logVariable('evo_charset')" href="../../_variables/evo_charset.html">$evo_charset</a> != <a class="var it1619" onMouseOver="hilite(1619)" onMouseOut="lolite()" onClick="logVariable('locales')" href="../../_variables/locales.html">$locales</a>[ <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a> ]['charset'] )
<a name="l188"><span class="linenum"> 188</span></a>      { // Redirect to install page with correct defined locale in order to avoid broken chars, e.g. when db locale has utf8 encoding and default locale - latin1
<a name="l189"><span class="linenum"> 189</span></a>          <a class="function" onClick="logFunction('header_redirect')" href="../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( 'index.php?locale='.<a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a> );
<a name="l190"><span class="linenum"> 190</span></a>  <span class="comment">        // Exit here.</span>
<a name="l191"><span class="linenum"> 191</span></a>      }
<a name="l192"><span class="linenum"> 192</span></a>  }
<a name="l193"><span class="linenum"> 193</span></a>  <span class="comment">// Activate default locale:</span>
<a name="l194"><span class="linenum"> 194</span></a>  if( ! <a class="function" onClick="logFunction('locale_activate')" href="../../_functions/locale_activate.html" onMouseOver="funcPopup(event,'locale_activate')">locale_activate</a>( <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a> ) )
<a name="l195"><span class="linenum"> 195</span></a>  {    // Could not activate <a class="function" onClick="logFunction('locale')" href="../../_functions/locale.html" onMouseOver="funcPopup(event,'locale')">locale</a> (non-existent?), fallback to en-US:
<a name="l196"><span class="linenum"> 196</span></a>      <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a> = 'en-US';
<a name="l197"><span class="linenum"> 197</span></a>      <a class="function" onClick="logFunction('locale_activate')" href="../../_functions/locale_activate.html" onMouseOver="funcPopup(event,'locale_activate')">locale_activate</a>( 'en-US' );
<a name="l198"><span class="linenum"> 198</span></a>  }
<a name="l199"><span class="linenum"> 199</span></a>  
<a name="l200"><span class="linenum"> 200</span></a>  <a class="function" onClick="logFunction('init_charsets')" href="../../_functions/init_charsets.html" onMouseOver="funcPopup(event,'init_charsets')">init_charsets</a>( <a class="var it1626" onMouseOver="hilite(1626)" onMouseOut="lolite()" onClick="logVariable('current_charset')" href="../../_variables/current_charset.html">$current_charset</a> );
<a name="l201"><span class="linenum"> 201</span></a>  
<a name="l202"><span class="linenum"> 202</span></a>  switch( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> )
<a name="l203"><span class="linenum"> 203</span></a>  {
<a name="l204"><span class="linenum"> 204</span></a>      case 'evoupgrade':
<a name="l205"><span class="linenum"> 205</span></a>      case 'auto_upgrade':
<a name="l206"><span class="linenum"> 206</span></a>      case 'svn_upgrade':
<a name="l207"><span class="linenum"> 207</span></a>          <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Upgrade from a previous version');
<a name="l208"><span class="linenum"> 208</span></a>          break;
<a name="l209"><span class="linenum"> 209</span></a>  
<a name="l210"><span class="linenum"> 210</span></a>      case 'newdb':
<a name="l211"><span class="linenum"> 211</span></a>          <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('New Install');
<a name="l212"><span class="linenum"> 212</span></a>          break;
<a name="l213"><span class="linenum"> 213</span></a>  
<a name="l214"><span class="linenum"> 214</span></a>      case 'cafelogupgrade':
<a name="l215"><span class="linenum"> 215</span></a>          <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Upgrade from Cafelog/b2');
<a name="l216"><span class="linenum"> 216</span></a>          break;
<a name="l217"><span class="linenum"> 217</span></a>  
<a name="l218"><span class="linenum"> 218</span></a>      case 'deletedb':
<a name="l219"><span class="linenum"> 219</span></a>          <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Delete b2evolution tables');
<a name="l220"><span class="linenum"> 220</span></a>          break;
<a name="l221"><span class="linenum"> 221</span></a>  
<a name="l222"><span class="linenum"> 222</span></a>      case 'utf8upgrade':
<a name="l223"><span class="linenum"> 223</span></a>          <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Upgrade your DB to UTF-8');
<a name="l224"><span class="linenum"> 224</span></a>          break;
<a name="l225"><span class="linenum"> 225</span></a>  
<a name="l226"><span class="linenum"> 226</span></a>      case 'start':
<a name="l227"><span class="linenum"> 227</span></a>          <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a> = <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Base configuration');
<a name="l228"><span class="linenum"> 228</span></a>          break;
<a name="l229"><span class="linenum"> 229</span></a>  
<a name="l230"><span class="linenum"> 230</span></a>      case 'conf':
<a name="l231"><span class="linenum"> 231</span></a>          <a class="var it1752" onMouseOver="hilite(1752)" onMouseOut="lolite()" onClick="logVariable('config_is_done')" href="../../_variables/config_is_done.html">$config_is_done</a> = 0;
<a name="l232"><span class="linenum"> 232</span></a>      case 'menu':
<a name="l233"><span class="linenum"> 233</span></a>      case 'localeinfo':
<a name="l234"><span class="linenum"> 234</span></a>      case 'default':
<a name="l235"><span class="linenum"> 235</span></a>          <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a> = '';
<a name="l236"><span class="linenum"> 236</span></a>          break;
<a name="l237"><span class="linenum"> 237</span></a>  }
<a name="l238"><span class="linenum"> 238</span></a>  
<a name="l239"><span class="linenum"> 239</span></a>  <span class="comment">// Add CSS:</span>
<a name="l240"><span class="linenum"> 240</span></a>  <a class="function" onClick="logFunction('require_css')" href="../../_functions/require_css.html" onMouseOver="funcPopup(event,'require_css')">require_css</a>( 'basic_styles.css', 'rsc_url' ); <span class="comment">// the REAL basic styles</span>
<a name="l241"><span class="linenum"> 241</span></a>  <a class="function" onClick="logFunction('require_css')" href="../../_functions/require_css.html" onMouseOver="funcPopup(event,'require_css')">require_css</a>( 'basic.css', 'rsc_url' ); <span class="comment">// Basic styles</span>
<a name="l242"><span class="linenum"> 242</span></a>  <a class="function" onClick="logFunction('require_css')" href="../../_functions/require_css.html" onMouseOver="funcPopup(event,'require_css')">require_css</a>( 'evo_distrib_2.css', 'rsc_url' );
<a name="l243"><span class="linenum"> 243</span></a>  
<a name="l244"><span class="linenum"> 244</span></a>  <a class="phpfunction" onClick="logFunction('header')" href="../../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>('Content-Type: text/html; charset='.<a class="var it616" onMouseOver="hilite(616)" onMouseOut="lolite()" onClick="logVariable('io_charset')" href="../../_variables/io_charset.html">$io_charset</a>);
<a name="l245"><span class="linenum"> 245</span></a>  <a class="phpfunction" onClick="logFunction('header')" href="../../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>('Cache-Control: no-cache'); <span class="comment">// no request to this page should get cached!</span>
<a name="l246"><span class="linenum"> 246</span></a>  ?&gt;
<a name="l247"><span class="linenum"> 247</span></a>  &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
<a name="l248"><span class="linenum"> 248</span></a>  &lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xml:lang=&quot;&lt;?php <a class="function" onClick="logFunction('locale_lang')" href="../../_functions/locale_lang.html" onMouseOver="funcPopup(event,'locale_lang')">locale_lang</a>() ?&gt;&quot; lang=&quot;&lt;?php <a class="function" onClick="logFunction('locale_lang')" href="../../_functions/locale_lang.html" onMouseOver="funcPopup(event,'locale_lang')">locale_lang</a>() ?&gt;&quot;&gt;&lt;!-- InstanceBegin template=&quot;/Templates/evo_distrib_2.dwt&quot; codeOutsideHTMLIsLocked=&quot;false&quot; --&gt;
<a name="l249"><span class="linenum"> 249</span></a>  &lt;head&gt;
<a name="l250"><span class="linenum"> 250</span></a>      &lt;!-- InstanceBeginEditable name=&quot;doctitle&quot; --&gt;
<a name="l251"><span class="linenum"> 251</span></a>      &lt;title&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('b2evo installer').( <a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a> ? ': '.<a class="var it79" onMouseOver="hilite(79)" onMouseOut="lolite()" onClick="logVariable('title')" href="../../_variables/title.html">$title</a> : '' ) ?&gt;&lt;/title&gt;
<a name="l252"><span class="linenum"> 252</span></a>      &lt;!-- InstanceEndEditable --&gt;
<a name="l253"><span class="linenum"> 253</span></a>      &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=&lt;?php echo <a class="var it616" onMouseOver="hilite(616)" onMouseOut="lolite()" onClick="logVariable('io_charset')" href="../../_variables/io_charset.html">$io_charset</a>; ?&gt;&quot; /&gt;
<a name="l254"><span class="linenum"> 254</span></a>      &lt;meta name=&quot;viewport&quot; content=&quot;width = 750&quot; /&gt;
<a name="l255"><span class="linenum"> 255</span></a>      &lt;meta name=&quot;robots&quot; content=&quot;noindex, follow&quot; /&gt;
<a name="l256"><span class="linenum"> 256</span></a>      &lt;?php <a class="function" onClick="logFunction('include_headlines')" href="../../_functions/include_headlines.html" onMouseOver="funcPopup(event,'include_headlines')">include_headlines</a>() <span class="comment">/* Add javascript and css files included by plugins and skin */</span> ?&gt;
<a name="l257"><span class="linenum"> 257</span></a>      &lt;!-- InstanceBeginEditable name=&quot;head&quot; --&gt;&lt;!-- InstanceEndEditable --&gt;
<a name="l258"><span class="linenum"> 258</span></a>      &lt;!-- InstanceParam name=&quot;lang&quot; type=&quot;text&quot; value=&quot;&amp;lt;?php <a class="function" onClick="logFunction('locale_lang')" href="../../_functions/locale_lang.html" onMouseOver="funcPopup(event,'locale_lang')">locale_lang</a>() ?&amp;gt;&quot; --&gt;
<a name="l259"><span class="linenum"> 259</span></a>  &lt;/head&gt;
<a name="l260"><span class="linenum"> 260</span></a>  
<a name="l261"><span class="linenum"> 261</span></a>  &lt;body&gt;
<a name="l262"><span class="linenum"> 262</span></a>      &lt;!-- InstanceBeginEditable name=&quot;BodyHead&quot; --&gt;&lt;!-- InstanceEndEditable --&gt;
<a name="l263"><span class="linenum"> 263</span></a>  
<a name="l264"><span class="linenum"> 264</span></a>      &lt;div class=&quot;wrapper1&quot;&gt;
<a name="l265"><span class="linenum"> 265</span></a>      &lt;div class=&quot;wrapper2&quot;&gt;
<a name="l266"><span class="linenum"> 266</span></a>          &lt;span class=&quot;version_top&quot;&gt;&lt;!-- InstanceBeginEditable name=&quot;Version&quot; --&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Installer for version ').' '. <a class="var it461" onMouseOver="hilite(461)" onMouseOut="lolite()" onClick="logVariable('app_version')" href="../../_variables/app_version.html">$app_version</a> ?&gt;&lt;!-- InstanceEndEditable --&gt;&lt;/span&gt;
<a name="l267"><span class="linenum"> 267</span></a>  
<a name="l268"><span class="linenum"> 268</span></a>          &lt;a href=&quot;http://b2evolution.net/&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;../rsc/img/distrib/b2evolution-logo.gif&quot; alt=&quot;b2evolution&quot; width=&quot;237&quot; height=&quot;92&quot; /&gt;&lt;/a&gt;
<a name="l269"><span class="linenum"> 269</span></a>  
<a name="l270"><span class="linenum"> 270</span></a>          &lt;div class=&quot;menu_top&quot;&gt;&lt;!-- InstanceBeginEditable name=&quot;MenuTop&quot; --&gt;
<a name="l271"><span class="linenum"> 271</span></a>              &lt;span class=&quot;floatright&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('After install') ?&gt;: &lt;a href=&quot;../index.php&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Blogs') ?&gt;&lt;/a&gt; &amp;middot;
<a name="l272"><span class="linenum"> 272</span></a>              &lt;a href=&quot;../&lt;?php echo <a class="var it230" onMouseOver="hilite(230)" onMouseOut="lolite()" onClick="logVariable('dispatcher')" href="../../_variables/dispatcher.html">$dispatcher</a> ?&gt;&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Admin') ?&gt;&lt;/a&gt;
<a name="l273"><span class="linenum"> 273</span></a>              &lt;/span&gt;
<a name="l274"><span class="linenum"> 274</span></a>          &lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Current installation') ?&gt;:
<a name="l275"><span class="linenum"> 275</span></a>          &lt;a href=&quot;index.php?locale=&lt;?php echo <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a> ?&gt;&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Install menu') ?&gt;&lt;/a&gt; &amp;middot;
<a name="l276"><span class="linenum"> 276</span></a>          &lt;a href=&quot;phpinfo.php&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('PHP info') ?&gt;&lt;/a&gt;
<a name="l277"><span class="linenum"> 277</span></a>          &lt;!-- InstanceEndEditable --&gt;&lt;/div&gt;
<a name="l278"><span class="linenum"> 278</span></a>  
<a name="l279"><span class="linenum"> 279</span></a>          &lt;!-- InstanceBeginEditable name=&quot;Main&quot; --&gt;
<a name="l280"><span class="linenum"> 280</span></a>  
<a name="l281"><span class="linenum"> 281</span></a>  &lt;?php
<a name="l282"><span class="linenum"> 282</span></a>  
<a name="l283"><span class="linenum"> 283</span></a>  <a class="function" onClick="logFunction('block_open')" href="../../_functions/block_open.html" onMouseOver="funcPopup(event,'block_open')">block_open</a>();
<a name="l284"><span class="linenum"> 284</span></a>  
<a name="l285"><span class="linenum"> 285</span></a>  <span class="comment">// echo $action;</span>
<a name="l286"><span class="linenum"> 286</span></a>  <a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('date_timezone')" href="../../_variables/date_timezone.html">$date_timezone</a> = <a class="phpfunction" onClick="logFunction('ini_get')" href="../../_functions/ini_get.html" onMouseOver="phpfuncPopup(event,'ini_get')">ini_get</a>( &quot;date.timezone&quot; );
<a name="l287"><span class="linenum"> 287</span></a>  if( empty( <a class="var it2008" onMouseOver="hilite(2008)" onMouseOut="lolite()" onClick="logVariable('date_timezone')" href="../../_variables/date_timezone.html">$date_timezone</a> ) &amp;&amp; empty( <a class="var it2009" onMouseOver="hilite(2009)" onMouseOut="lolite()" onClick="logVariable('date_default_timezone')" href="../../_variables/date_default_timezone.html">$date_default_timezone</a> ) )
<a name="l288"><span class="linenum"> 288</span></a>  { // The default timezone is not set, display a warning
<a name="l289"><span class="linenum"> 289</span></a>      echo '&lt;div class=&quot;error&quot;&gt;&lt;p class=&quot;error&quot;&gt;'.sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>(&quot;No default time zone is set. Please open PHP.ini and set the value of 'date.timezone' (Example: date.timezone = Europe/Paris) or open /conf/_advanced.php and set the value of %s (Example: %s)&quot;), '<a class="var it2009" onMouseOver="hilite(2009)" onMouseOut="lolite()" onClick="logVariable('date_default_timezone')" href="../../_variables/date_default_timezone.html">$date_default_timezone</a>', '<a class="var it2009" onMouseOver="hilite(2009)" onMouseOut="lolite()" onClick="logVariable('date_default_timezone')" href="../../_variables/date_default_timezone.html">$date_default_timezone</a> = \'Europe/Paris\';' ).'&lt;/p&gt;&lt;/div&gt;';
<a name="l290"><span class="linenum"> 290</span></a>  }
<a name="l291"><span class="linenum"> 291</span></a>  
<a name="l292"><span class="linenum"> 292</span></a>  if( ( <a class="var it1752" onMouseOver="hilite(1752)" onMouseOut="lolite()" onClick="logVariable('config_is_done')" href="../../_variables/config_is_done.html">$config_is_done</a> || <a class="var it5428" onMouseOver="hilite(5428)" onMouseOut="lolite()" onClick="logVariable('try_db_connect')" href="../../_variables/try_db_connect.html">$try_db_connect</a> ) &amp;&amp; ( <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('error')" class="var it8966" onMouseOver="hilite(8966)" onMouseOut="lolite()" href="../../_variables/error.html">error</a> ) )
<a name="l293"><span class="linenum"> 293</span></a>  { // DB connect was unsuccessful, restart conf
<a name="l294"><span class="linenum"> 294</span></a>      echo '&lt;div class=&quot;error&quot;&gt;&lt;p class=&quot;error&quot;&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Check your database config settings below and update them if necessary...').'&lt;/p&gt;&lt;/div&gt;';
<a name="l295"><span class="linenum"> 295</span></a>      <a class="function" onClick="logFunction('display_base_config_recap')" href="../../_functions/display_base_config_recap.html" onMouseOver="funcPopup(event,'display_base_config_recap')">display_base_config_recap</a>();
<a name="l296"><span class="linenum"> 296</span></a>      <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> = 'start';
<a name="l297"><span class="linenum"> 297</span></a>  }
<a name="l298"><span class="linenum"> 298</span></a>  
<a name="l299"><span class="linenum"> 299</span></a>  <span class="comment">// Check other dependencies:</span>
<a name="l300"><span class="linenum"> 300</span></a>  <span class="comment">// TODO: Non-install/upgrade-actions should be allowed (e.g. &quot;deletedb&quot;)</span>
<a name="l301"><span class="linenum"> 301</span></a>  if( <a class="var it5431" onMouseOver="hilite(5431)" onMouseOut="lolite()" onClick="logVariable('req_errors')" href="../../_variables/req_errors.html">$req_errors</a> = <a class="function" onClick="logFunction('install_validate_requirements')" href="../../_functions/install_validate_requirements.html" onMouseOver="funcPopup(event,'install_validate_requirements')">install_validate_requirements</a>() )
<a name="l302"><span class="linenum"> 302</span></a>  {
<a name="l303"><span class="linenum"> 303</span></a>      echo '&lt;div class=&quot;error&quot;&gt;';
<a name="l304"><span class="linenum"> 304</span></a>      echo '&lt;p class=&quot;error&quot;&gt;&lt;strong&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('b2evolution cannot be installed, because of the following errors:').'&lt;/strong&gt;&lt;/p&gt;';
<a name="l305"><span class="linenum"> 305</span></a>      echo '&lt;ul class=&quot;error&quot;&gt;&lt;li&gt;'.<a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( '&lt;/li&gt;&lt;li&gt;', <a class="var it5431" onMouseOver="hilite(5431)" onMouseOut="lolite()" onClick="logVariable('req_errors')" href="../../_variables/req_errors.html">$req_errors</a> ).'&lt;/li&gt;&lt;/ul&gt;';
<a name="l306"><span class="linenum"> 306</span></a>      echo '&lt;/div&gt;';
<a name="l307"><span class="linenum"> 307</span></a>      die;
<a name="l308"><span class="linenum"> 308</span></a>  }
<a name="l309"><span class="linenum"> 309</span></a>  
<a name="l310"><span class="linenum"> 310</span></a>  switch( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> )
<a name="l311"><span class="linenum"> 311</span></a>  {
<a name="l312"><span class="linenum"> 312</span></a>      case 'conf':
<a name="l313"><span class="linenum"> 313</span></a>          <span class="comment">/*</span>
<a name="l314"><span class="linenum"> 314</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l315"><span class="linenum"> 315</span></a>  <span class="comment">         * Write conf file:</span>
<a name="l316"><span class="linenum"> 316</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l317"><span class="linenum"> 317</span></a>  <span class="comment">         */</span>
<a name="l318"><span class="linenum"> 318</span></a>          <a class="function" onClick="logFunction('display_locale_selector')" href="../../_functions/display_locale_selector.html" onMouseOver="funcPopup(event,'display_locale_selector')">display_locale_selector</a>();
<a name="l319"><span class="linenum"> 319</span></a>  
<a name="l320"><span class="linenum"> 320</span></a>          <a class="function" onClick="logFunction('block_open')" href="../../_functions/block_open.html" onMouseOver="funcPopup(event,'block_open')">block_open</a>();
<a name="l321"><span class="linenum"> 321</span></a>  
<a name="l322"><span class="linenum"> 322</span></a>          <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_db_user', 'string', true );
<a name="l323"><span class="linenum"> 323</span></a>          <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_db_password', 'raw', true );
<a name="l324"><span class="linenum"> 324</span></a>          <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_db_name', 'string', true );
<a name="l325"><span class="linenum"> 325</span></a>          <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_db_host', 'string', true );
<a name="l326"><span class="linenum"> 326</span></a>          <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_db_tableprefix', 'string', <a class="var it748" onMouseOver="hilite(748)" onMouseOut="lolite()" onClick="logVariable('tableprefix')" href="../../_variables/tableprefix.html">$tableprefix</a> );
<a name="l327"><span class="linenum"> 327</span></a>          <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_baseurl', 'string', true );
<a name="l328"><span class="linenum"> 328</span></a>          <a class="var it5432" onMouseOver="hilite(5432)" onMouseOut="lolite()" onClick="logVariable('conf_baseurl')" href="../../_variables/conf_baseurl.html">$conf_baseurl</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>( '#(/)?$#', '', <a class="var it5432" onMouseOver="hilite(5432)" onMouseOut="lolite()" onClick="logVariable('conf_baseurl')" href="../../_variables/conf_baseurl.html">$conf_baseurl</a> ).'/'; <span class="comment">// force trailing slash</span>
<a name="l329"><span class="linenum"> 329</span></a>          <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_admin_email', 'string', true );
<a name="l330"><span class="linenum"> 330</span></a>  
<a name="l331"><span class="linenum"> 331</span></a>  <span class="comment">        // Connect to DB:</span>
<a name="l332"><span class="linenum"> 332</span></a>          <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a> = <span class="keyword">new </span><a class="class" onClick="logClass('DB')" href="../../_classes/db.html" onMouseOver="classPopup(event,'db')">DB</a>( array(
<a name="l333"><span class="linenum"> 333</span></a>              'user' =&gt; <a class="var it5433" onMouseOver="hilite(5433)" onMouseOut="lolite()" onClick="logVariable('conf_db_user')" href="../../_variables/conf_db_user.html">$conf_db_user</a>,
<a name="l334"><span class="linenum"> 334</span></a>              'password' =&gt; <a class="var it5434" onMouseOver="hilite(5434)" onMouseOut="lolite()" onClick="logVariable('conf_db_password')" href="../../_variables/conf_db_password.html">$conf_db_password</a>,
<a name="l335"><span class="linenum"> 335</span></a>              'name' =&gt; <a class="var it5435" onMouseOver="hilite(5435)" onMouseOut="lolite()" onClick="logVariable('conf_db_name')" href="../../_variables/conf_db_name.html">$conf_db_name</a>,
<a name="l336"><span class="linenum"> 336</span></a>              'host' =&gt; <a class="var it5436" onMouseOver="hilite(5436)" onMouseOut="lolite()" onClick="logVariable('conf_db_host')" href="../../_variables/conf_db_host.html">$conf_db_host</a>,
<a name="l337"><span class="linenum"> 337</span></a>              'aliases' =&gt; <a class="var it1750" onMouseOver="hilite(1750)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../../_variables/db_config.html">$db_config</a>['aliases'],
<a name="l338"><span class="linenum"> 338</span></a>              'use_transactions' =&gt; <a class="var it1750" onMouseOver="hilite(1750)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../../_variables/db_config.html">$db_config</a>['use_transactions'],
<a name="l339"><span class="linenum"> 339</span></a>              'table_options' =&gt; <a class="var it1750" onMouseOver="hilite(1750)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../../_variables/db_config.html">$db_config</a>['table_options'],
<a name="l340"><span class="linenum"> 340</span></a>              'connection_charset' =&gt; empty( <a class="var it1750" onMouseOver="hilite(1750)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../../_variables/db_config.html">$db_config</a>['connection_charset'] ) ? <a class="class" onClick="logClass('DB')" href="../../_classes/db.html" onMouseOver="classPopup(event,'db')">DB</a>::<a class="function" onClick="logFunction('php_to_mysql_charmap')" href="../../_functions/php_to_mysql_charmap.html" onMouseOver="funcPopup(event,'php_to_mysql_charmap')">php_to_mysql_charmap</a>( <a class="var it694" onMouseOver="hilite(694)" onMouseOut="lolite()" onClick="logVariable('evo_charset')" href="../../_variables/evo_charset.html">$evo_charset</a> ) : <a class="var it1750" onMouseOver="hilite(1750)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../../_variables/db_config.html">$db_config</a>['connection_charset'],
<a name="l341"><span class="linenum"> 341</span></a>              'halt_on_error' =&gt; false ) );
<a name="l342"><span class="linenum"> 342</span></a>          if( <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('error')" class="var it8966" onMouseOver="hilite(8966)" onMouseOut="lolite()" href="../../_variables/error.html">error</a> )
<a name="l343"><span class="linenum"> 343</span></a>          { // restart conf
<a name="l344"><span class="linenum"> 344</span></a>              echo '&lt;p class=&quot;error&quot;&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('It seems that the database config settings you entered don\'t work. Please check them carefully and try again...').'&lt;/p&gt;';
<a name="l345"><span class="linenum"> 345</span></a>              <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> = 'start';
<a name="l346"><span class="linenum"> 346</span></a>          }
<a name="l347"><span class="linenum"> 347</span></a>          else
<a name="l348"><span class="linenum"> 348</span></a>          {
<a name="l349"><span class="linenum"> 349</span></a>              <a class="var it5437" onMouseOver="hilite(5437)" onMouseOut="lolite()" onClick="logVariable('conf_template_filepath')" href="../../_variables/conf_template_filepath.html">$conf_template_filepath</a> = <a class="var it1882" onMouseOver="hilite(1882)" onMouseOut="lolite()" onClick="logVariable('conf_path')" href="../../_variables/conf_path.html">$conf_path</a>.'_basic_config.template.php';
<a name="l350"><span class="linenum"> 350</span></a>              <a class="var it5438" onMouseOver="hilite(5438)" onMouseOut="lolite()" onClick="logVariable('conf_filepath')" href="../../_variables/conf_filepath.html">$conf_filepath</a> = <a class="var it1882" onMouseOver="hilite(1882)" onMouseOut="lolite()" onClick="logVariable('conf_path')" href="../../_variables/conf_path.html">$conf_path</a>.'_basic_config.php';
<a name="l351"><span class="linenum"> 351</span></a>  
<a name="l352"><span class="linenum"> 352</span></a>  <span class="comment">            // Read original:</span>
<a name="l353"><span class="linenum"> 353</span></a>              <a class="var it5439" onMouseOver="hilite(5439)" onMouseOut="lolite()" onClick="logVariable('file_loaded')" href="../../_variables/file_loaded.html">$file_loaded</a> = @<a class="phpfunction" onClick="logFunction('file')" href="../../_functions/file.html" onMouseOver="phpfuncPopup(event,'file')">file</a>( <a class="var it5437" onMouseOver="hilite(5437)" onMouseOut="lolite()" onClick="logVariable('conf_template_filepath')" href="../../_variables/conf_template_filepath.html">$conf_template_filepath</a> );
<a name="l354"><span class="linenum"> 354</span></a>  
<a name="l355"><span class="linenum"> 355</span></a>              if( empty( <a class="var it5439" onMouseOver="hilite(5439)" onMouseOut="lolite()" onClick="logVariable('file_loaded')" href="../../_variables/file_loaded.html">$file_loaded</a> ) )
<a name="l356"><span class="linenum"> 356</span></a>              { // This should actually never happen, just in case...
<a name="l357"><span class="linenum"> 357</span></a>                  echo '&lt;div class=&quot;error&quot;&gt;&lt;p class=&quot;error&quot;&gt;'.sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Could not load original conf file [%s]. Is it missing?'), <a class="var it5438" onMouseOver="hilite(5438)" onMouseOut="lolite()" onClick="logVariable('conf_filepath')" href="../../_variables/conf_filepath.html">$conf_filepath</a> ).'&lt;/p&gt;&lt;/div&gt;';
<a name="l358"><span class="linenum"> 358</span></a>                  break;
<a name="l359"><span class="linenum"> 359</span></a>              }
<a name="l360"><span class="linenum"> 360</span></a>  
<a name="l361"><span class="linenum"> 361</span></a>  <span class="comment">            // File loaded...</span>
<a name="l362"><span class="linenum"> 362</span></a>              <a class="var it5440" onMouseOver="hilite(5440)" onMouseOut="lolite()" onClick="logVariable('conf')" href="../../_variables/conf.html">$conf</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( '', <a class="var it5439" onMouseOver="hilite(5439)" onMouseOut="lolite()" onClick="logVariable('file_loaded')" href="../../_variables/file_loaded.html">$file_loaded</a> );
<a name="l363"><span class="linenum"> 363</span></a>  <span class="comment">            // Update conf:</span>
<a name="l364"><span class="linenum"> 364</span></a>              <a class="var it5440" onMouseOver="hilite(5440)" onMouseOut="lolite()" onClick="logVariable('conf')" href="../../_variables/conf.html">$conf</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>(
<a name="l365"><span class="linenum"> 365</span></a>                  array(
<a name="l366"><span class="linenum"> 366</span></a>                      '#\<a class="var it1750" onMouseOver="hilite(1750)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../../_variables/db_config.html">$db_config</a>\s*=\s*array\(
<a name="l367"><span class="linenum"> 367</span></a>                          \s*[\'&quot;]user[\'&quot;]\s*=&gt;\s*[\'&quot;].*?[\'&quot;],     ([^\n\r]*\r?\n)
<a name="l368"><span class="linenum"> 368</span></a>                          \s*[\'&quot;]password[\'&quot;]\s*=&gt;\s*[\'&quot;].*?[\'&quot;], ([^\n\r]*\r?\n)
<a name="l369"><span class="linenum"> 369</span></a>                          \s*[\'&quot;]name[\'&quot;]\s*=&gt;\s*[\'&quot;].*?[\'&quot;],     ([^\n\r]*\r?\n)
<a name="l370"><span class="linenum"> 370</span></a>                          \s*[\'&quot;]host[\'&quot;]\s*=&gt;\s*[\'&quot;].*?[\'&quot;],     ([^\n\r]*\r?\n)
<a name="l371"><span class="linenum"> 371</span></a>  <span class="comment">                        #ixs',</span>
<a name="l372"><span class="linenum"> 372</span></a>                      &quot;#tableprefix\s*=\s*'.*?';<span class="comment">#&quot;,</span>
<a name="l373"><span class="linenum"> 373</span></a>                      &quot;#baseurl\s*=\s*'.*?';<span class="comment">#&quot;,</span>
<a name="l374"><span class="linenum"> 374</span></a>                      &quot;#admin_email\s*=\s*'.*?';<span class="comment">#&quot;,</span>
<a name="l375"><span class="linenum"> 375</span></a>                      &quot;#config_is_done\s*=.*?;<span class="comment">#&quot;,</span>
<a name="l376"><span class="linenum"> 376</span></a>                  ),
<a name="l377"><span class="linenum"> 377</span></a>                  array(
<a name="l378"><span class="linenum"> 378</span></a>                      &quot;\<a class="var it1750" onMouseOver="hilite(1750)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../../_variables/db_config.html">$db_config</a> = array(\n&quot;
<a name="l379"><span class="linenum"> 379</span></a>                          .&quot;\t'user'     =&gt; '&quot;.<a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>( array( &quot;'&quot;, &quot;\$&quot; ), array( &quot;\'&quot;, &quot;\\$&quot; ), <a class="var it5433" onMouseOver="hilite(5433)" onMouseOut="lolite()" onClick="logVariable('conf_db_user')" href="../../_variables/conf_db_user.html">$conf_db_user</a> ).&quot;',\<a class="var it108" onMouseOver="hilite(108)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../_variables/1.html">$1</a>&quot;
<a name="l380"><span class="linenum"> 380</span></a>                          .&quot;\t'password' =&gt; '&quot;.<a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>( array( &quot;'&quot;, &quot;\$&quot; ), array( &quot;\'&quot;, &quot;\\$&quot; ), <a class="var it5434" onMouseOver="hilite(5434)" onMouseOut="lolite()" onClick="logVariable('conf_db_password')" href="../../_variables/conf_db_password.html">$conf_db_password</a> ).&quot;',\<a class="var it341" onMouseOver="hilite(341)" onMouseOut="lolite()" onClick="logVariable('2')" href="../../_variables/2.html">$2</a>&quot;
<a name="l381"><span class="linenum"> 381</span></a>                          .&quot;\t'name'     =&gt; '&quot;.<a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>( array( &quot;'&quot;, &quot;\$&quot; ), array( &quot;\'&quot;, &quot;\\$&quot; ), <a class="var it5435" onMouseOver="hilite(5435)" onMouseOut="lolite()" onClick="logVariable('conf_db_name')" href="../../_variables/conf_db_name.html">$conf_db_name</a> ).&quot;',\<a class="var it1399" onMouseOver="hilite(1399)" onMouseOut="lolite()" onClick="logVariable('3')" href="../../_variables/3.html">$3</a>&quot;
<a name="l382"><span class="linenum"> 382</span></a>                          .&quot;\t'host'     =&gt; '&quot;.<a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>( array( &quot;'&quot;, &quot;\$&quot; ), array( &quot;\'&quot;, &quot;\\$&quot; ), <a class="var it5436" onMouseOver="hilite(5436)" onMouseOut="lolite()" onClick="logVariable('conf_db_host')" href="../../_variables/conf_db_host.html">$conf_db_host</a> ).&quot;',\<a class="var it698" onMouseOver="hilite(698)" onMouseOut="lolite()" onClick="logVariable('4')" href="../../_variables/4.html">$4</a>&quot;,
<a name="l383"><span class="linenum"> 383</span></a>                      &quot;tableprefix = '&quot;.<a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>( &quot;'&quot;, &quot;\'&quot;, <a class="var it5441" onMouseOver="hilite(5441)" onMouseOut="lolite()" onClick="logVariable('conf_db_tableprefix')" href="../../_variables/conf_db_tableprefix.html">$conf_db_tableprefix</a> ).&quot;';&quot;,
<a name="l384"><span class="linenum"> 384</span></a>                      &quot;baseurl = '&quot;.<a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>( &quot;'&quot;, &quot;\'&quot;, <a class="var it5432" onMouseOver="hilite(5432)" onMouseOut="lolite()" onClick="logVariable('conf_baseurl')" href="../../_variables/conf_baseurl.html">$conf_baseurl</a> ).&quot;';&quot;,
<a name="l385"><span class="linenum"> 385</span></a>                      &quot;admin_email = '&quot;.<a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>( &quot;'&quot;, &quot;\'&quot;, <a class="var it5442" onMouseOver="hilite(5442)" onMouseOut="lolite()" onClick="logVariable('conf_admin_email')" href="../../_variables/conf_admin_email.html">$conf_admin_email</a> ).&quot;';&quot;,
<a name="l386"><span class="linenum"> 386</span></a>                      'config_is_done = 1;',
<a name="l387"><span class="linenum"> 387</span></a>                  ), <a class="var it5440" onMouseOver="hilite(5440)" onMouseOut="lolite()" onClick="logVariable('conf')" href="../../_variables/conf.html">$conf</a> );
<a name="l388"><span class="linenum"> 388</span></a>  
<a name="l389"><span class="linenum"> 389</span></a>  <span class="comment">            // Write new contents:</span>
<a name="l390"><span class="linenum"> 390</span></a>              if( <a class="function" onClick="logFunction('save_to_file')" href="../../_functions/save_to_file.html" onMouseOver="funcPopup(event,'save_to_file')">save_to_file</a>( <a class="var it5440" onMouseOver="hilite(5440)" onMouseOut="lolite()" onClick="logVariable('conf')" href="../../_variables/conf.html">$conf</a>, <a class="var it5438" onMouseOver="hilite(5438)" onMouseOut="lolite()" onClick="logVariable('conf_filepath')" href="../../_variables/conf_filepath.html">$conf_filepath</a>, 'w' ) )
<a name="l391"><span class="linenum"> 391</span></a>              {
<a name="l392"><span class="linenum"> 392</span></a>                  printf( '&lt;p&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Your configuration file [%s] has been successfully created.').'&lt;/p&gt;', <a class="var it5438" onMouseOver="hilite(5438)" onMouseOut="lolite()" onClick="logVariable('conf_filepath')" href="../../_variables/conf_filepath.html">$conf_filepath</a> );
<a name="l393"><span class="linenum"> 393</span></a>  
<a name="l394"><span class="linenum"> 394</span></a>                  <a class="var it748" onMouseOver="hilite(748)" onMouseOut="lolite()" onClick="logVariable('tableprefix')" href="../../_variables/tableprefix.html">$tableprefix</a> = <a class="var it5441" onMouseOver="hilite(5441)" onMouseOut="lolite()" onClick="logVariable('conf_db_tableprefix')" href="../../_variables/conf_db_tableprefix.html">$conf_db_tableprefix</a>;
<a name="l395"><span class="linenum"> 395</span></a>                  <a class="var it153" onMouseOver="hilite(153)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../_variables/baseurl.html">$baseurl</a> = <a class="var it5432" onMouseOver="hilite(5432)" onMouseOut="lolite()" onClick="logVariable('conf_baseurl')" href="../../_variables/conf_baseurl.html">$conf_baseurl</a>;
<a name="l396"><span class="linenum"> 396</span></a>                  <a class="var it1751" onMouseOver="hilite(1751)" onMouseOut="lolite()" onClick="logVariable('admin_email')" href="../../_variables/admin_email.html">$admin_email</a> = <a class="var it5442" onMouseOver="hilite(5442)" onMouseOut="lolite()" onClick="logVariable('conf_admin_email')" href="../../_variables/conf_admin_email.html">$conf_admin_email</a>;
<a name="l397"><span class="linenum"> 397</span></a>                  <a class="var it1752" onMouseOver="hilite(1752)" onMouseOut="lolite()" onClick="logVariable('config_is_done')" href="../../_variables/config_is_done.html">$config_is_done</a> = 1;
<a name="l398"><span class="linenum"> 398</span></a>                  <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> = 'menu';
<a name="l399"><span class="linenum"> 399</span></a>              }
<a name="l400"><span class="linenum"> 400</span></a>              else
<a name="l401"><span class="linenum"> 401</span></a>              {
<a name="l402"><span class="linenum"> 402</span></a>                  ?&gt;
<a name="l403"><span class="linenum"> 403</span></a>                  &lt;h1&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Config file update') ?&gt;&lt;/h1&gt;
<a name="l404"><span class="linenum"> 404</span></a>                  &lt;p&gt;&lt;strong&gt;&lt;?php printf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('We cannot automatically create or update your config file [%s]!'), <a class="var it5438" onMouseOver="hilite(5438)" onMouseOut="lolite()" onClick="logVariable('conf_filepath')" href="../../_variables/conf_filepath.html">$conf_filepath</a> ); ?&gt;&lt;/strong&gt;&lt;/p&gt;
<a name="l405"><span class="linenum"> 405</span></a>                  &lt;p&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('There are two ways to deal with this:') ?&gt;&lt;/p&gt;
<a name="l406"><span class="linenum"> 406</span></a>                  &lt;ul&gt;
<a name="l407"><span class="linenum"> 407</span></a>                      &lt;li&gt;&lt;strong&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('You can allow the installer to create the config file by changing permissions for the /conf directory:') ?&gt;&lt;/strong&gt;
<a name="l408"><span class="linenum"> 408</span></a>                          &lt;ol&gt;
<a name="l409"><span class="linenum"> 409</span></a>                              &lt;li&gt;&lt;?php printf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Make sure there is no existing and potentially locked configuration file named &lt;code&gt;%s&lt;/code&gt;. If so, please delete it.'), <a class="var it5438" onMouseOver="hilite(5438)" onMouseOut="lolite()" onClick="logVariable('conf_filepath')" href="../../_variables/conf_filepath.html">$conf_filepath</a> ); ?&gt;&lt;/li&gt;
<a name="l410"><span class="linenum"> 410</span></a>                              &lt;li&gt;&lt;?php printf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('&lt;code&gt;chmod 777 %s&lt;/code&gt;. If needed, see the &lt;a %s&gt;online manual about permissions&lt;/a&gt;.'), <a class="var it1882" onMouseOver="hilite(1882)" onMouseOut="lolite()" onClick="logVariable('conf_path')" href="../../_variables/conf_path.html">$conf_path</a>, 'href=&quot;'.<a class="function" onClick="logFunction('get_manual_url')" href="../../_functions/get_manual_url.html" onMouseOver="funcPopup(event,'get_manual_url')">get_manual_url</a>( 'directory-and-file-permissions' ).'&quot; target=&quot;_blank&quot;' ); ?&gt;&lt;/li&gt;
<a name="l411"><span class="linenum"> 411</span></a>                              &lt;li&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Come back to this page and refresh/reload.') ?&gt;&lt;/li&gt;
<a name="l412"><span class="linenum"> 412</span></a>                          &lt;/ol&gt;
<a name="l413"><span class="linenum"> 413</span></a>                          &lt;br /&gt;
<a name="l414"><span class="linenum"> 414</span></a>                      &lt;/li&gt;
<a name="l415"><span class="linenum"> 415</span></a>                      &lt;li&gt;&lt;strong&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Alternatively, you can update the config file manually:') ?&gt;&lt;/strong&gt;
<a name="l416"><span class="linenum"> 416</span></a>                          &lt;ol&gt;
<a name="l417"><span class="linenum"> 417</span></a>                              &lt;li&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Create a new text file with a text editor.') ?&gt;&lt;/li&gt;
<a name="l418"><span class="linenum"> 418</span></a>                              &lt;li&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Copy the contents from the box below.') ?&gt;&lt;/li&gt;
<a name="l419"><span class="linenum"> 419</span></a>                              &lt;li&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Paste them into your local text editor. &lt;strong&gt;ATTENTION: make sure there is ABSOLUTELY NO WHITESPACE after the final &lt;code&gt;?&amp;gt;&lt;/code&gt; in the file.&lt;/strong&gt; Any space, tab, newline or blank line at the end of the conf file may prevent cookies from being set when you try to log in later.') ?&gt;&lt;/li&gt;
<a name="l420"><span class="linenum"> 420</span></a>                              &lt;li&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Save the file locally under the name &lt;code&gt;_basic_config.php&lt;/code&gt;') ?&gt;&lt;/li&gt;
<a name="l421"><span class="linenum"> 421</span></a>                              &lt;li&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Upload the file to your server, into the &lt;code&gt;/_conf&lt;/code&gt; folder.') ?&gt;&lt;/li&gt;
<a name="l422"><span class="linenum"> 422</span></a>                              &lt;li&gt;&lt;?php printf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('&lt;a %s&gt;Call the installer from scratch&lt;/a&gt;.'), 'href=&quot;index.php?locale='.<a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a>.'&quot;') ?&gt;&lt;/li&gt;
<a name="l423"><span class="linenum"> 423</span></a>                          &lt;/ol&gt;
<a name="l424"><span class="linenum"> 424</span></a>                      &lt;/li&gt;
<a name="l425"><span class="linenum"> 425</span></a>                  &lt;/ul&gt;
<a name="l426"><span class="linenum"> 426</span></a>                  &lt;p&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('This is how your _basic_config.php should look like:') ?&gt;&lt;/p&gt;
<a name="l427"><span class="linenum"> 427</span></a>                  &lt;blockquote&gt;
<a name="l428"><span class="linenum"> 428</span></a>                  &lt;pre&gt;&lt;?php
<a name="l429"><span class="linenum"> 429</span></a>                      echo <a class="function" onClick="logFunction('evo_htmlspecialchars')" href="../../_functions/evo_htmlspecialchars.html" onMouseOver="funcPopup(event,'evo_htmlspecialchars')">evo_htmlspecialchars</a>( <a class="var it5440" onMouseOver="hilite(5440)" onMouseOut="lolite()" onClick="logVariable('conf')" href="../../_variables/conf.html">$conf</a> );
<a name="l430"><span class="linenum"> 430</span></a>                  ?&gt;&lt;/pre&gt;
<a name="l431"><span class="linenum"> 431</span></a>                  &lt;/blockquote&gt;
<a name="l432"><span class="linenum"> 432</span></a>                  &lt;?php
<a name="l433"><span class="linenum"> 433</span></a>                  break;
<a name="l434"><span class="linenum"> 434</span></a>              }
<a name="l435"><span class="linenum"> 435</span></a>          }
<a name="l436"><span class="linenum"> 436</span></a>  <span class="comment">        // ATTENTION: we continue here...</span>
<a name="l437"><span class="linenum"> 437</span></a>  
<a name="l438"><span class="linenum"> 438</span></a>      case 'start':
<a name="l439"><span class="linenum"> 439</span></a>      case 'default':
<a name="l440"><span class="linenum"> 440</span></a>          <span class="comment">/*</span>
<a name="l441"><span class="linenum"> 441</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l442"><span class="linenum"> 442</span></a>  <span class="comment">         * Start of install procedure:</span>
<a name="l443"><span class="linenum"> 443</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l444"><span class="linenum"> 444</span></a>  <span class="comment">         */</span>
<a name="l445"><span class="linenum"> 445</span></a>          if( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> == 'start' || !<a class="var it1752" onMouseOver="hilite(1752)" onMouseOut="lolite()" onClick="logVariable('config_is_done')" href="../../_variables/config_is_done.html">$config_is_done</a> )
<a name="l446"><span class="linenum"> 446</span></a>          {
<a name="l447"><span class="linenum"> 447</span></a>              <a class="function" onClick="logFunction('track_step')" href="../../_functions/track_step.html" onMouseOver="funcPopup(event,'track_step')">track_step</a>( 'installer-startdb' );
<a name="l448"><span class="linenum"> 448</span></a>  
<a name="l449"><span class="linenum"> 449</span></a>              <a class="function" onClick="logFunction('display_locale_selector')" href="../../_functions/display_locale_selector.html" onMouseOver="funcPopup(event,'display_locale_selector')">display_locale_selector</a>();
<a name="l450"><span class="linenum"> 450</span></a>  
<a name="l451"><span class="linenum"> 451</span></a>              <a class="function" onClick="logFunction('block_open')" href="../../_functions/block_open.html" onMouseOver="funcPopup(event,'block_open')">block_open</a>();
<a name="l452"><span class="linenum"> 452</span></a>  
<a name="l453"><span class="linenum"> 453</span></a>              echo '&lt;h1&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Base configuration').'&lt;/h1&gt;';
<a name="l454"><span class="linenum"> 454</span></a>  
<a name="l455"><span class="linenum"> 455</span></a>              if( <a class="var it1752" onMouseOver="hilite(1752)" onMouseOut="lolite()" onClick="logVariable('config_is_done')" href="../../_variables/config_is_done.html">$config_is_done</a> &amp;&amp; <a class="var it312" onMouseOver="hilite(312)" onMouseOut="lolite()" onClick="logVariable('allow_evodb_reset')" href="../../_variables/allow_evodb_reset.html">$allow_evodb_reset</a> != 1 )
<a name="l456"><span class="linenum"> 456</span></a>              {
<a name="l457"><span class="linenum"> 457</span></a>                  echo '&lt;p&gt;&lt;strong&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Resetting the base configuration is currently disabled for security reasons.').'&lt;/strong&gt;&lt;/p&gt;';
<a name="l458"><span class="linenum"> 458</span></a>                  echo '&lt;p&gt;'.sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('To enable it, please go to the %s file and change: %s to %s'), '/conf/_basic_config.php', '&lt;pre&gt;<a class="var it312" onMouseOver="hilite(312)" onMouseOut="lolite()" onClick="logVariable('allow_evodb_reset')" href="../../_variables/allow_evodb_reset.html">$allow_evodb_reset</a> = 0;&lt;/pre&gt;', '&lt;pre&gt;<a class="var it312" onMouseOver="hilite(312)" onMouseOut="lolite()" onClick="logVariable('allow_evodb_reset')" href="../../_variables/allow_evodb_reset.html">$allow_evodb_reset</a> = 1;&lt;/pre&gt;' ).'&lt;/p&gt;';
<a name="l459"><span class="linenum"> 459</span></a>                  echo '&lt;p&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Then reload this page and a reset option will appear.').'&lt;/p&gt;';
<a name="l460"><span class="linenum"> 460</span></a>                  <a class="function" onClick="logFunction('block_close')" href="../../_functions/block_close.html" onMouseOver="funcPopup(event,'block_close')">block_close</a>();
<a name="l461"><span class="linenum"> 461</span></a>                  break;
<a name="l462"><span class="linenum"> 462</span></a>              }
<a name="l463"><span class="linenum"> 463</span></a>              else
<a name="l464"><span class="linenum"> 464</span></a>              {
<a name="l465"><span class="linenum"> 465</span></a>  
<a name="l466"><span class="linenum"> 466</span></a>  <span class="comment">            // Set default params if not provided otherwise:</span>
<a name="l467"><span class="linenum"> 467</span></a>              <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_db_user', 'string', <a class="var it1750" onMouseOver="hilite(1750)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../../_variables/db_config.html">$db_config</a>['user'] );
<a name="l468"><span class="linenum"> 468</span></a>              <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_db_password', 'raw', <a class="var it1750" onMouseOver="hilite(1750)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../../_variables/db_config.html">$db_config</a>['password'] );
<a name="l469"><span class="linenum"> 469</span></a>              <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_db_name', 'string', <a class="var it1750" onMouseOver="hilite(1750)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../../_variables/db_config.html">$db_config</a>['name'] );
<a name="l470"><span class="linenum"> 470</span></a>              <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_db_host', 'string', <a class="var it1750" onMouseOver="hilite(1750)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../../_variables/db_config.html">$db_config</a>['host'] );
<a name="l471"><span class="linenum"> 471</span></a>              <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_db_tableprefix', 'string', <a class="var it748" onMouseOver="hilite(748)" onMouseOut="lolite()" onClick="logVariable('tableprefix')" href="../../_variables/tableprefix.html">$tableprefix</a> );
<a name="l472"><span class="linenum"> 472</span></a>  <span class="comment">            // Guess baseurl:</span>
<a name="l473"><span class="linenum"> 473</span></a>  <span class="comment">            // TODO: dh&gt; IMHO HTTP_HOST would be a better default, because it's what the user accesses for install.</span>
<a name="l474"><span class="linenum"> 474</span></a>  <span class="comment">            //       fp, please change it, if it's ok. SERVER_NAME might get used if HTTP_HOST is not given, but that shouldn't be the case normally.</span>
<a name="l475"><span class="linenum"> 475</span></a>  <span class="comment">            // fp&gt; ok for change and test after first 3.x-stable release</span>
<a name="l476"><span class="linenum"> 476</span></a>              <a class="var it153" onMouseOver="hilite(153)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../_variables/baseurl.html">$baseurl</a> = 'http://'.( isset( <a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['SERVER_NAME'] ) ? <a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['SERVER_NAME'] : 'yourserver.com' );
<a name="l477"><span class="linenum"> 477</span></a>              if( isset( <a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['SERVER_PORT'] ) &amp;&amp; ( <a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['SERVER_PORT'] != '80' ) )
<a name="l478"><span class="linenum"> 478</span></a>                  <a class="var it153" onMouseOver="hilite(153)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../_variables/baseurl.html">$baseurl</a> .= ':'.<a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['SERVER_PORT'];
<a name="l479"><span class="linenum"> 479</span></a>  
<a name="l480"><span class="linenum"> 480</span></a>  <span class="comment">            // ############ Get ReqPath &amp; ReqURI ##############</span>
<a name="l481"><span class="linenum"> 481</span></a>              <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it2886" onMouseOver="hilite(2886)" onMouseOut="lolite()" onClick="logVariable('ReqPath')" href="../../_variables/ReqPath.html">$ReqPath</a>,<a class="var it136" onMouseOver="hilite(136)" onMouseOut="lolite()" onClick="logVariable('ReqURI')" href="../../_variables/ReqURI.html">$ReqURI</a>) = <a class="function" onClick="logFunction('get_ReqURI')" href="../../_functions/get_requri.html" onMouseOver="funcPopup(event,'get_requri')">get_ReqURI</a>();
<a name="l482"><span class="linenum"> 482</span></a>  
<a name="l483"><span class="linenum"> 483</span></a>              <a class="var it153" onMouseOver="hilite(153)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../_variables/baseurl.html">$baseurl</a> .= <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>( '#/<a class="function" onClick="logFunction('install')" href="../../_functions/install.html" onMouseOver="funcPopup(event,'install')">install</a>(/(index.php)?)?$#', '', <a class="var it2886" onMouseOver="hilite(2886)" onMouseOut="lolite()" onClick="logVariable('ReqPath')" href="../../_variables/ReqPath.html">$ReqPath</a> ).'/';
<a name="l484"><span class="linenum"> 484</span></a>  
<a name="l485"><span class="linenum"> 485</span></a>              <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_baseurl', 'string', <a class="var it153" onMouseOver="hilite(153)" onMouseOut="lolite()" onClick="logVariable('baseurl')" href="../../_variables/baseurl.html">$baseurl</a> );
<a name="l486"><span class="linenum"> 486</span></a>              <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'conf_admin_email', 'string', <a class="var it1751" onMouseOver="hilite(1751)" onMouseOut="lolite()" onClick="logVariable('admin_email')" href="../../_variables/admin_email.html">$admin_email</a> );
<a name="l487"><span class="linenum"> 487</span></a>  
<a name="l488"><span class="linenum"> 488</span></a>              ?&gt;
<a name="l489"><span class="linenum"> 489</span></a>  
<a name="l490"><span class="linenum"> 490</span></a>              &lt;p&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The basic configuration <a class="phpfunction" onClick="logFunction('file')" href="../../_functions/file.html" onMouseOver="phpfuncPopup(event,'file')">file</a> (&lt;code&gt;/conf/_basic_config.php&lt;/code&gt;) has not been created yet. You can do automatically generate it by filling out the form below.') ?&gt;&lt;/p&gt;
<a name="l491"><span class="linenum"> 491</span></a>  
<a name="l492"><span class="linenum"> 492</span></a>              &lt;p&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('This is the minimum info we need to set up b2evolution on this server:') ?&gt;&lt;/p&gt;
<a name="l493"><span class="linenum"> 493</span></a>  
<a name="l494"><span class="linenum"> 494</span></a>              &lt;form class=&quot;fform&quot; name=&quot;form&quot; action=&quot;index.php&quot; method=&quot;post&quot;&gt;
<a name="l495"><span class="linenum"> 495</span></a>                  &lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;conf&quot; /&gt;
<a name="l496"><span class="linenum"> 496</span></a>                  &lt;input type=&quot;hidden&quot; name=&quot;locale&quot; value=&quot;&lt;?php echo <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a>; ?&gt;&quot; /&gt;
<a name="l497"><span class="linenum"> 497</span></a>  
<a name="l498"><span class="linenum"> 498</span></a>                  &lt;fieldset&gt;
<a name="l499"><span class="linenum"> 499</span></a>                      &lt;legend&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Database you want to install into') ?&gt;&lt;/legend&gt;
<a name="l500"><span class="linenum"> 500</span></a>                      &lt;p class=&quot;note&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('b2evolution stores blog posts, comments, user permissions, etc. in a MySQL database. You must create this database prior to installing b2evolution and provide the access parameters to this database below. If you are not familiar with this, you can ask your hosting provider to create the database for you.') ?&gt;&lt;/p&gt;
<a name="l501"><span class="linenum"> 501</span></a>                      &lt;?php
<a name="l502"><span class="linenum"> 502</span></a>                          <a class="function" onClick="logFunction('form_text')" href="../../_functions/form_text.html" onMouseOver="funcPopup(event,'form_text')">form_text</a>( 'conf_db_host', <a class="var it5436" onMouseOver="hilite(5436)" onMouseOut="lolite()" onClick="logVariable('conf_db_host')" href="../../_variables/conf_db_host.html">$conf_db_host</a>, 16, <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('MySQL Host/Server'), sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Typically looks like &quot;localhost&quot; or &quot;sql-6&quot; or &quot;sql-8.yourhost.net&quot;...' ) ), 120 );
<a name="l503"><span class="linenum"> 503</span></a>                          <a class="function" onClick="logFunction('form_text')" href="../../_functions/form_text.html" onMouseOver="funcPopup(event,'form_text')">form_text</a>( 'conf_db_name', <a class="var it5435" onMouseOver="hilite(5435)" onMouseOut="lolite()" onClick="logVariable('conf_db_name')" href="../../_variables/conf_db_name.html">$conf_db_name</a>, 16, <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('MySQL Database'), sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Name of the MySQL database you have created on the server' ) ), 100);
<a name="l504"><span class="linenum"> 504</span></a>                          <a class="function" onClick="logFunction('form_text')" href="../../_functions/form_text.html" onMouseOver="funcPopup(event,'form_text')">form_text</a>( 'conf_db_user', <a class="var it5433" onMouseOver="hilite(5433)" onMouseOut="lolite()" onClick="logVariable('conf_db_user')" href="../../_variables/conf_db_user.html">$conf_db_user</a>, 16, <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('MySQL Username'), sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Used by b2evolution to access the MySQL database' ) ), 100 );
<a name="l505"><span class="linenum"> 505</span></a>                          <a class="function" onClick="logFunction('form_text')" href="../../_functions/form_text.html" onMouseOver="funcPopup(event,'form_text')">form_text</a>( 'conf_db_password', <a class="var it5434" onMouseOver="hilite(5434)" onMouseOut="lolite()" onClick="logVariable('conf_db_password')" href="../../_variables/conf_db_password.html">$conf_db_password</a>, 16, <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('MySQL Password'), sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Used by b2evolution to access the MySQL database' ) ), 100 ); <span class="comment">// no need to hyde this. nobody installs b2evolution from a public place</span>
<a name="l506"><span class="linenum"> 506</span></a>  <span class="comment">                        // Too confusing for (most) newbies.    form_text( 'conf_db_tableprefix', $conf_db_tableprefix, 16, T_('MySQL tables prefix'), sprintf( T_('All DB tables will be prefixed with this. You need to change this only if you want to have multiple b2evo installations in the same DB.' ) ), 30 );</span>
<a name="l507"><span class="linenum"> 507</span></a>                      ?&gt;
<a name="l508"><span class="linenum"> 508</span></a>                  &lt;/fieldset&gt;
<a name="l509"><span class="linenum"> 509</span></a>  
<a name="l510"><span class="linenum"> 510</span></a>                  &lt;fieldset&gt;
<a name="l511"><span class="linenum"> 511</span></a>                      &lt;legend&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Additional settings') ?&gt;&lt;/legend&gt;
<a name="l512"><span class="linenum"> 512</span></a>                      &lt;?php
<a name="l513"><span class="linenum"> 513</span></a>                          <a class="function" onClick="logFunction('form_text')" href="../../_functions/form_text.html" onMouseOver="funcPopup(event,'form_text')">form_text</a>( 'conf_baseurl', <a class="var it5432" onMouseOver="hilite(5432)" onMouseOut="lolite()" onClick="logVariable('conf_baseurl')" href="../../_variables/conf_baseurl.html">$conf_baseurl</a>, 50, <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Base URL'), sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('This is where b2evo and your blogs reside by default. CHECK THIS CAREFULLY or not much will work. If you want to test b2evolution on your local machine, in order for login cookies to work, you MUST use http://&lt;strong&gt;localhost&lt;/strong&gt;/path... Do NOT use your machine\'s name!' ) ), 120 );
<a name="l514"><span class="linenum"> 514</span></a>  
<a name="l515"><span class="linenum"> 515</span></a>                          <a class="function" onClick="logFunction('form_text')" href="../../_functions/form_text.html" onMouseOver="funcPopup(event,'form_text')">form_text</a>( 'conf_admin_email', <a class="var it5442" onMouseOver="hilite(5442)" onMouseOut="lolite()" onClick="logVariable('conf_admin_email')" href="../../_variables/conf_admin_email.html">$conf_admin_email</a>, 50, <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Your email'), sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('This is used to create your admin account. You will receive notifications for comments on your blog, etc.' ) ), 80 );
<a name="l516"><span class="linenum"> 516</span></a>                      ?&gt;
<a name="l517"><span class="linenum"> 517</span></a>                  &lt;/fieldset&gt;
<a name="l518"><span class="linenum"> 518</span></a>  
<a name="l519"><span class="linenum"> 519</span></a>                  &lt;fieldset&gt;
<a name="l520"><span class="linenum"> 520</span></a>                      &lt;fieldset&gt;
<a name="l521"><span class="linenum"> 521</span></a>                          &lt;div class=&quot;input&quot;&gt;
<a name="l522"><span class="linenum"> 522</span></a>                              &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Update config file') ?&gt;&quot; class=&quot;search&quot; /&gt;
<a name="l523"><span class="linenum"> 523</span></a>                              &lt;input type=&quot;reset&quot; value=&quot;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Reset') ?&gt;&quot; class=&quot;search&quot; /&gt;
<a name="l524"><span class="linenum"> 524</span></a>                          &lt;/div&gt;
<a name="l525"><span class="linenum"> 525</span></a>                      &lt;/fieldset&gt;
<a name="l526"><span class="linenum"> 526</span></a>                  &lt;/fieldset&gt;
<a name="l527"><span class="linenum"> 527</span></a>  
<a name="l528"><span class="linenum"> 528</span></a>              &lt;/form&gt;
<a name="l529"><span class="linenum"> 529</span></a>  
<a name="l530"><span class="linenum"> 530</span></a>              &lt;?php
<a name="l531"><span class="linenum"> 531</span></a>              break;
<a name="l532"><span class="linenum"> 532</span></a>              }
<a name="l533"><span class="linenum"> 533</span></a>          }
<a name="l534"><span class="linenum"> 534</span></a>  <span class="comment">        // if config was already done, move on to main menu:</span>
<a name="l535"><span class="linenum"> 535</span></a>  
<a name="l536"><span class="linenum"> 536</span></a>      case 'menu':
<a name="l537"><span class="linenum"> 537</span></a>          <span class="comment">/*</span>
<a name="l538"><span class="linenum"> 538</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l539"><span class="linenum"> 539</span></a>  <span class="comment">         * Menu</span>
<a name="l540"><span class="linenum"> 540</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l541"><span class="linenum"> 541</span></a>  <span class="comment">         */</span>
<a name="l542"><span class="linenum"> 542</span></a>          <a class="function" onClick="logFunction('track_step')" href="../../_functions/track_step.html" onMouseOver="funcPopup(event,'track_step')">track_step</a>( 'installer-menu' );
<a name="l543"><span class="linenum"> 543</span></a>  
<a name="l544"><span class="linenum"> 544</span></a>          <a class="function" onClick="logFunction('display_locale_selector')" href="../../_functions/display_locale_selector.html" onMouseOver="funcPopup(event,'display_locale_selector')">display_locale_selector</a>();
<a name="l545"><span class="linenum"> 545</span></a>  
<a name="l546"><span class="linenum"> 546</span></a>          <a class="function" onClick="logFunction('block_open')" href="../../_functions/block_open.html" onMouseOver="funcPopup(event,'block_open')">block_open</a>();
<a name="l547"><span class="linenum"> 547</span></a>          ?&gt;
<a name="l548"><span class="linenum"> 548</span></a>          &lt;h1&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('How would you like your b2evolution installed?') ?&gt;&lt;/h1&gt;
<a name="l549"><span class="linenum"> 549</span></a>  
<a name="l550"><span class="linenum"> 550</span></a>          &lt;?php
<a name="l551"><span class="linenum"> 551</span></a>              <a class="var it5443" onMouseOver="hilite(5443)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../../_variables/old_db_version.html">$old_db_version</a> = <a class="function" onClick="logFunction('get_db_version')" href="../../_functions/get_db_version.html" onMouseOver="funcPopup(event,'get_db_version')">get_db_version</a>();
<a name="l552"><span class="linenum"> 552</span></a>          ?&gt;
<a name="l553"><span class="linenum"> 553</span></a>  
<a name="l554"><span class="linenum"> 554</span></a>          &lt;form action=&quot;index.php&quot; method=&quot;get&quot;&gt;
<a name="l555"><span class="linenum"> 555</span></a>              &lt;input type=&quot;hidden&quot; name=&quot;locale&quot; value=&quot;&lt;?php echo <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a> ?&gt;&quot; /&gt;
<a name="l556"><span class="linenum"> 556</span></a>              &lt;input type=&quot;hidden&quot; name=&quot;confirmed&quot; value=&quot;0&quot; /&gt;
<a name="l557"><span class="linenum"> 557</span></a>              &lt;input type=&quot;hidden&quot; name=&quot;installer_version&quot; value=&quot;10&quot; /&gt;
<a name="l558"><span class="linenum"> 558</span></a>  
<a name="l559"><span class="linenum"> 559</span></a>              &lt;p&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The installation can be done in different ways. Choose one:')?&gt;&lt;/p&gt;
<a name="l560"><span class="linenum"> 560</span></a>  
<a name="l561"><span class="linenum"> 561</span></a>              &lt;p&gt;&lt;input type=&quot;radio&quot; name=&quot;action&quot; id=&quot;newdb&quot; value=&quot;newdb&quot;
<a name="l562"><span class="linenum"> 562</span></a>                  &lt;?php
<a name="l563"><span class="linenum"> 563</span></a>  <span class="comment">                    // fp&gt; change the above to 'newdbsettings' for an additional settings screen.</span>
<a name="l564"><span class="linenum"> 564</span></a>                      if( <a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it5443" onMouseOver="hilite(5443)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../../_variables/old_db_version.html">$old_db_version</a>) )
<a name="l565"><span class="linenum"> 565</span></a>                      {
<a name="l566"><span class="linenum"> 566</span></a>                          echo 'checked=&quot;checked&quot;';
<a name="l567"><span class="linenum"> 567</span></a>                      }
<a name="l568"><span class="linenum"> 568</span></a>                  ?&gt;
<a name="l569"><span class="linenum"> 569</span></a>                  /&gt;
<a name="l570"><span class="linenum"> 570</span></a>                  &lt;label for=&quot;newdb&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('&lt;strong&gt;New Install&lt;/strong&gt;: Install b2evolution database tables.')?&gt;&lt;/label&gt;&lt;/p&gt;
<a name="l571"><span class="linenum"> 571</span></a>              &lt;p style=&quot;margin-left: 2em;&quot;&gt;
<a name="l572"><span class="linenum"> 572</span></a>                  &lt;input type=&quot;checkbox&quot; name=&quot;create_sample_contents&quot; id=&quot;create_sample_contents&quot; value=&quot;1&quot; checked=&quot;checked&quot; /&gt;
<a name="l573"><span class="linenum"> 573</span></a>                  &lt;label for=&quot;create_sample_contents&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Also install sample blogs &amp;amp; sample contents. The sample posts explain several features of b2evolution. This is highly recommended for new users.')?&gt;&lt;/label&gt;
<a name="l574"><span class="linenum"> 574</span></a>                  &lt;br /&gt;
<a name="l575"><span class="linenum"> 575</span></a>                  &lt;?php
<a name="l576"><span class="linenum"> 576</span></a>  <span class="comment">                    // Pre-check if current installation is local</span>
<a name="l577"><span class="linenum"> 577</span></a>                      <a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('is_local')" href="../../_variables/is_local.html">$is_local</a> = <a class="phpfunction" onClick="logFunction('php_sapi_name')" href="../../_functions/php_sapi_name.html" onMouseOver="phpfuncPopup(event,'php_sapi_name')">php_sapi_name</a>() != 'cli' &amp;&amp; // NOT php CLI mode
<a name="l578"><span class="linenum"> 578</span></a>                          ( <a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['SERVER_ADDR'] == '127.0.0.1' ||
<a name="l579"><span class="linenum"> 579</span></a>                              <a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['SERVER_ADDR'] == '::1' || // IPv6 address of 127.0.0.1
<a name="l580"><span class="linenum"> 580</span></a>                              <a class="var it4136" onMouseOver="hilite(4136)" onMouseOut="lolite()" onClick="logVariable('basehost')" href="../../_variables/basehost.html">$basehost</a> == 'localhost' ||
<a name="l581"><span class="linenum"> 581</span></a>                              <a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['REMOTE_ADDR'] == '127.0.0.1' ||
<a name="l582"><span class="linenum"> 582</span></a>                              <a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../_variables/_SERVER.html">$_SERVER</a>['REMOTE_ADDR'] == '::1' );
<a name="l583"><span class="linenum"> 583</span></a>                  ?&gt;
<a name="l584"><span class="linenum"> 584</span></a>                  &lt;input type=&quot;checkbox&quot; name=&quot;local_installation&quot; id=&quot;local_installation&quot; value=&quot;1&quot;&lt;?php echo <a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('is_local')" href="../../_variables/is_local.html">$is_local</a> ? ' checked=&quot;checked&quot;' : ''; ?&gt; /&gt;
<a name="l585"><span class="linenum"> 585</span></a>                  &lt;label for=&quot;local_installation&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('This is a local / test / intranet installation.')?&gt;&lt;/label&gt;
<a name="l586"><span class="linenum"> 586</span></a>                  &lt;?php
<a name="l587"><span class="linenum"> 587</span></a>                      if( <a class="var it2140" onMouseOver="hilite(2140)" onMouseOut="lolite()" onClick="logVariable('test_install_all_features')" href="../../_variables/test_install_all_features.html">$test_install_all_features</a> )
<a name="l588"><span class="linenum"> 588</span></a>                      {    // Checkbox to install all features
<a name="l589"><span class="linenum"> 589</span></a>                  ?&gt;
<a name="l590"><span class="linenum"> 590</span></a>                  &lt;br /&gt;
<a name="l591"><span class="linenum"> 591</span></a>                  &lt;input type=&quot;checkbox&quot; name=&quot;install_all_features&quot; id=&quot;install_all_features&quot; value=&quot;1&quot; /&gt;
<a name="l592"><span class="linenum"> 592</span></a>                  &lt;label for=&quot;install_all_features&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Also install all test features.')?&gt;&lt;/label&gt;
<a name="l593"><span class="linenum"> 593</span></a>                  &lt;?php } ?&gt;
<a name="l594"><span class="linenum"> 594</span></a>              &lt;/p&gt;
<a name="l595"><span class="linenum"> 595</span></a>  
<a name="l596"><span class="linenum"> 596</span></a>              &lt;p&gt;&lt;input type=&quot;radio&quot; name=&quot;action&quot; id=&quot;evoupgrade&quot; value=&quot;evoupgrade&quot;
<a name="l597"><span class="linenum"> 597</span></a>                  &lt;?php if( !<a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it5443" onMouseOver="hilite(5443)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../../_variables/old_db_version.html">$old_db_version</a>) &amp;&amp; <a class="var it5443" onMouseOver="hilite(5443)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../../_variables/old_db_version.html">$old_db_version</a> &lt; <a class="var it4135" onMouseOver="hilite(4135)" onMouseOut="lolite()" onClick="logVariable('new_db_version')" href="../../_variables/new_db_version.html">$new_db_version</a> )
<a name="l598"><span class="linenum"> 598</span></a>                      {
<a name="l599"><span class="linenum"> 599</span></a>                          echo 'checked=&quot;checked&quot;';
<a name="l600"><span class="linenum"> 600</span></a>                      }
<a name="l601"><span class="linenum"> 601</span></a>                  ?&gt;
<a name="l602"><span class="linenum"> 602</span></a>                  /&gt;
<a name="l603"><span class="linenum"> 603</span></a>                  &lt;label for=&quot;evoupgrade&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('&lt;strong&gt;Upgrade from a previous version of b2evolution&lt;/strong&gt;: Upgrade your b2evolution database tables in order to make them compatible with the current version. &lt;strong&gt;WARNING:&lt;/strong&gt; If you have modified your database, this operation may fail. Make sure you have a backup.') ?&gt;&lt;/label&gt;&lt;/p&gt;
<a name="l604"><span class="linenum"> 604</span></a>  
<a name="l605"><span class="linenum"> 605</span></a>              &lt;?php
<a name="l606"><span class="linenum"> 606</span></a>                  if( <a class="var it312" onMouseOver="hilite(312)" onMouseOut="lolite()" onClick="logVariable('allow_evodb_reset')" href="../../_variables/allow_evodb_reset.html">$allow_evodb_reset</a> == 1 )
<a name="l607"><span class="linenum"> 607</span></a>                  {
<a name="l608"><span class="linenum"> 608</span></a>                      ?&gt;
<a name="l609"><span class="linenum"> 609</span></a>                      &lt;p&gt;&lt;input type=&quot;radio&quot; name=&quot;action&quot; id=&quot;deletedb&quot; value=&quot;deletedb&quot; /&gt;
<a name="l610"><span class="linenum"> 610</span></a>                      &lt;label for=&quot;deletedb&quot;&gt;&lt;strong&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Delete b2evolution tables &amp;amp; cache files')?&gt;&lt;/strong&gt;:
<a name="l611"><span class="linenum"> 611</span></a>                      &lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('If you have installed b2evolution tables before and wish to start anew, you must delete the b2evolution tables before you can start a new installation. &lt;strong&gt;WARNING: All your b2evolution tables and data will be lost!!!&lt;/strong&gt; Any non-b2evolution tables will remain untouched though.')?&gt;&lt;/label&gt;&lt;/p&gt;
<a name="l612"><span class="linenum"> 612</span></a>  
<a name="l613"><span class="linenum"> 613</span></a>                      &lt;p&gt;&lt;input type=&quot;radio&quot; name=&quot;action&quot; id=&quot;start&quot; value=&quot;start&quot; /&gt;
<a name="l614"><span class="linenum"> 614</span></a>                      &lt;label for=&quot;start&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('&lt;strong&gt;Change your base configuration&lt;/strong&gt; (see recap below): You only want to do this in rare occasions where you may have moved your b2evolution files or database to a different location...')?&gt;&lt;/label&gt;&lt;/p&gt;
<a name="l615"><span class="linenum"> 615</span></a>                      &lt;?php
<a name="l616"><span class="linenum"> 616</span></a>                  }
<a name="l617"><span class="linenum"> 617</span></a>              ?&gt;
<a name="l618"><span class="linenum"> 618</span></a>                      &lt;p&gt;&lt;input type=&quot;radio&quot; name=&quot;action&quot; id=&quot;utf8upgrade&quot; value=&quot;utf8upgrade&quot; /&gt;
<a name="l619"><span class="linenum"> 619</span></a>                      &lt;label for=&quot;utf8upgrade&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('&lt;strong&gt;Upgrade your DB to UTF-8&lt;/strong&gt;: all the b2evolution tables in your b2evolution MySQL database will be converted to UTF-8 instead of their current charset.')?&gt;&lt;/label&gt;&lt;/p&gt;
<a name="l620"><span class="linenum"> 620</span></a>              &lt;?php
<a name="l621"><span class="linenum"> 621</span></a>  
<a name="l622"><span class="linenum"> 622</span></a>  
<a name="l623"><span class="linenum"> 623</span></a>              if( <a class="var it312" onMouseOver="hilite(312)" onMouseOut="lolite()" onClick="logVariable('allow_evodb_reset')" href="../../_variables/allow_evodb_reset.html">$allow_evodb_reset</a> != 1 )
<a name="l624"><span class="linenum"> 624</span></a>              {
<a name="l625"><span class="linenum"> 625</span></a>                  echo '&lt;div class=&quot;floatright&quot;&gt;&lt;a href=&quot;index.php?action=deletedb&amp;amp;locale='.<a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a>.'&quot;&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Need to start anew?').' &amp;raquo;&lt;/a&gt;&lt;/div&gt;';
<a name="l626"><span class="linenum"> 626</span></a>              }
<a name="l627"><span class="linenum"> 627</span></a>              ?&gt;
<a name="l628"><span class="linenum"> 628</span></a>  
<a name="l629"><span class="linenum"> 629</span></a>              &lt;p&gt;
<a name="l630"><span class="linenum"> 630</span></a>              &lt;input type=&quot;submit&quot; value=&quot;&amp;nbsp; &lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('GO!')?&gt; &amp;nbsp;&quot;
<a name="l631"><span class="linenum"> 631</span></a>                  onclick=&quot;var dc = document.getElementById( 'deletedb' ); if( dc &amp;&amp; dc.checked ) { if ( confirm( '&lt;?php
<a name="l632"><span class="linenum"> 632</span></a>                      printf( <span class="comment">/* TRANS: %s gets replaced by app name, usually &quot;b2evolution&quot; */</span> <a class="function" onClick="logFunction('TS_')" href="../../_functions/ts_.html" onMouseOver="funcPopup(event,'ts_')">TS_</a>( 'Are you sure you want to delete your existing %s tables?\nDo you have a backup?' ), <a class="var it137" onMouseOver="hilite(137)" onMouseOut="lolite()" onClick="logVariable('app_name')" href="../../_variables/app_name.html">$app_name</a> );
<a name="l633"><span class="linenum"> 633</span></a>                      ?&gt;' ) ) { this.form.confirmed.value = 1; return true; } else return false; }&quot; /&gt;
<a name="l634"><span class="linenum"> 634</span></a>              &lt;/p&gt;
<a name="l635"><span class="linenum"> 635</span></a>              &lt;/form&gt;
<a name="l636"><span class="linenum"> 636</span></a>          &lt;?php
<a name="l637"><span class="linenum"> 637</span></a>  
<a name="l638"><span class="linenum"> 638</span></a>          <a class="function" onClick="logFunction('block_close')" href="../../_functions/block_close.html" onMouseOver="funcPopup(event,'block_close')">block_close</a>();
<a name="l639"><span class="linenum"> 639</span></a>  
<a name="l640"><span class="linenum"> 640</span></a>          <a class="function" onClick="logFunction('display_base_config_recap')" href="../../_functions/display_base_config_recap.html" onMouseOver="funcPopup(event,'display_base_config_recap')">display_base_config_recap</a>();
<a name="l641"><span class="linenum"> 641</span></a>          break;
<a name="l642"><span class="linenum"> 642</span></a>  
<a name="l643"><span class="linenum"> 643</span></a>      case 'localeinfo':
<a name="l644"><span class="linenum"> 644</span></a>  <span class="comment">        // Info about getting additional locales.</span>
<a name="l645"><span class="linenum"> 645</span></a>          <a class="function" onClick="logFunction('display_locale_selector')" href="../../_functions/display_locale_selector.html" onMouseOver="funcPopup(event,'display_locale_selector')">display_locale_selector</a>();
<a name="l646"><span class="linenum"> 646</span></a>  
<a name="l647"><span class="linenum"> 647</span></a>          <a class="function" onClick="logFunction('block_open')" href="../../_functions/block_open.html" onMouseOver="funcPopup(event,'block_open')">block_open</a>();
<a name="l648"><span class="linenum"> 648</span></a>  
<a name="l649"><span class="linenum"> 649</span></a>  <span class="comment">        // Note: Do NOT make these strings translatable. We are not in the desired language anyways!</span>
<a name="l650"><span class="linenum"> 650</span></a>          ?&gt;
<a name="l651"><span class="linenum"> 651</span></a>          &lt;h2&gt;What if your language is not in the list above?&lt;/h2&gt;
<a name="l652"><span class="linenum"> 652</span></a>          &lt;ol&gt;
<a name="l653"><span class="linenum"> 653</span></a>              &lt;li&gt;Go to the &lt;a href=&quot;http://b2evolution.net/downloads/language-packs.html&quot; target=&quot;_blank&quot;&gt;language packs section on b2evolution.net&lt;/a&gt;.&lt;/li&gt;
<a name="l654"><span class="linenum"> 654</span></a>              &lt;li&gt;Select the version of b2evolution you're trying to install. If it's not available select the closest <a class="function" onClick="logFunction('match')" href="../../_functions/match.html" onMouseOver="funcPopup(event,'match')">match</a> (in most cases this should work).&lt;/li&gt;
<a name="l655"><span class="linenum"> 655</span></a>              &lt;li&gt;Find your language and click the &quot;Download&quot; link.&lt;/li&gt;
<a name="l656"><span class="linenum"> 656</span></a>              &lt;li&gt;Unzip the contents of the downloaded ZIP file.&lt;/li&gt;
<a name="l657"><span class="linenum"> 657</span></a>              &lt;li&gt;Upload the new folder (for example es_ES) into the /locales folder on your server. (The /locales folder already contains a few locales such as de_DE, ru_RU, etc.)&lt;/li&gt;
<a name="l658"><span class="linenum"> 658</span></a>              &lt;li&gt;Reload this page. The new locale should now appear in the list at the top of this screen. If it doesn't, it means the language pack you installed is not compatible with this version of b2evolution.&lt;/li&gt;
<a name="l659"><span class="linenum"> 659</span></a>          &lt;/ol&gt;
<a name="l660"><span class="linenum"> 660</span></a>  
<a name="l661"><span class="linenum"> 661</span></a>          &lt;h3&gt;What if there is no language pack to download?&lt;/h3&gt;
<a name="l662"><span class="linenum"> 662</span></a>          &lt;p&gt;Nobody has contributed a language pack in your language yet. You could help by providing a translation for your language.&lt;/p&gt;
<a name="l663"><span class="linenum"> 663</span></a>          &lt;p&gt;For now, you will have to install b2evolution with a supported language.&lt;/p&gt;
<a name="l664"><span class="linenum"> 664</span></a>          &lt;p&gt;Once you get familiar with b2evolution you will be able to &lt;a href=&quot;&lt;?php echo <a class="function" onClick="logFunction('get_manual_url')" href="../../_functions/get_manual_url.html" onMouseOver="funcPopup(event,'get_manual_url')">get_manual_url</a>( 'localization' ); ?&gt;&quot; target=&quot;_blank&quot;&gt;create your own language pack&lt;/a&gt; fairly easily.&lt;/p&gt;
<a name="l665"><span class="linenum"> 665</span></a>          &lt;p&gt;&lt;a href=&quot;index.php?locale=&lt;?php echo <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a> ?&gt;&quot;&gt;&amp;laquo; &lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Back to install menu') ?&gt;&lt;/a&gt;&lt;/p&gt;
<a name="l666"><span class="linenum"> 666</span></a>          &lt;?php
<a name="l667"><span class="linenum"> 667</span></a>          break;
<a name="l668"><span class="linenum"> 668</span></a>  
<a name="l669"><span class="linenum"> 669</span></a>      case 'newdbsettings':
<a name="l670"><span class="linenum"> 670</span></a>          <span class="comment">/*</span>
<a name="l671"><span class="linenum"> 671</span></a>  <span class="comment">         * fp&gt; TODO: Add a screen for additionnal settings:</span>
<a name="l672"><span class="linenum"> 672</span></a>  <span class="comment">         * - create_sample_contents : to be moved away from main screen</span>
<a name="l673"><span class="linenum"> 673</span></a>  <span class="comment">         * - admin_email: to be moved out of conf file</span>
<a name="l674"><span class="linenum"> 674</span></a>  <span class="comment">         * - storage_charset: offer option to FORCE storing data in UTF-8 even if current locale doesn't require it (must be supported by MySQL) -- recommended for multilingual blogs</span>
<a name="l675"><span class="linenum"> 675</span></a>  <span class="comment">         * - evo_charset: offer option to FORCE handling data internally in UTF-8 even if current locale doesn't require it (requires mbstring) -- not recommended in most situations</span>
<a name="l676"><span class="linenum"> 676</span></a>  <span class="comment">         */</span>
<a name="l677"><span class="linenum"> 677</span></a>  
<a name="l678"><span class="linenum"> 678</span></a>  
<a name="l679"><span class="linenum"> 679</span></a>      case 'newdb':
<a name="l680"><span class="linenum"> 680</span></a>          <span class="comment">/*</span>
<a name="l681"><span class="linenum"> 681</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l682"><span class="linenum"> 682</span></a>  <span class="comment">         * NEW DB: install a new b2evolution database.</span>
<a name="l683"><span class="linenum"> 683</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l684"><span class="linenum"> 684</span></a>  <span class="comment">         * Note: auto installers should kick in directly at this step and provide all required params.</span>
<a name="l685"><span class="linenum"> 685</span></a>  <span class="comment">         */</span>
<a name="l686"><span class="linenum"> 686</span></a>          <a class="function" onClick="logFunction('track_step')" href="../../_functions/track_step.html" onMouseOver="funcPopup(event,'track_step')">track_step</a>( 'install-start' );
<a name="l687"><span class="linenum"> 687</span></a>  
<a name="l688"><span class="linenum"> 688</span></a>          <a class="var it2140" onMouseOver="hilite(2140)" onMouseOut="lolite()" onClick="logVariable('test_install_all_features')" href="../../_variables/test_install_all_features.html">$test_install_all_features</a> = <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'install_all_features', 'boolean', false );
<a name="l689"><span class="linenum"> 689</span></a>  
<a name="l690"><span class="linenum"> 690</span></a>  <span class="comment">        // fp&gt; TODO: this test should probably be made more generic and applied to upgrade too.</span>
<a name="l691"><span class="linenum"> 691</span></a>          <a class="var it5445" onMouseOver="hilite(5445)" onMouseOut="lolite()" onClick="logVariable('expected_connection_charset')" href="../../_variables/expected_connection_charset.html">$expected_connection_charset</a> = <a class="class" onClick="logClass('DB')" href="../../_classes/db.html" onMouseOver="classPopup(event,'db')">DB</a>::<a class="function" onClick="logFunction('php_to_mysql_charmap')" href="../../_functions/php_to_mysql_charmap.html" onMouseOver="funcPopup(event,'php_to_mysql_charmap')">php_to_mysql_charmap</a>(<a class="var it694" onMouseOver="hilite(694)" onMouseOut="lolite()" onClick="logVariable('evo_charset')" href="../../_variables/evo_charset.html">$evo_charset</a>);
<a name="l692"><span class="linenum"> 692</span></a>          if( <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('connection_charset')" class="var it8966" onMouseOver="hilite(8966)" onMouseOut="lolite()" href="../../_variables/connection_charset.html">connection_charset</a> != <a class="var it5445" onMouseOver="hilite(5445)" onMouseOut="lolite()" onClick="logVariable('expected_connection_charset')" href="../../_variables/expected_connection_charset.html">$expected_connection_charset</a> )
<a name="l693"><span class="linenum"> 693</span></a>          {
<a name="l694"><span class="linenum"> 694</span></a>              echo '&lt;div class=&quot;error&quot;&gt;&lt;p class=&quot;error&quot;&gt;'.sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('In order to install b2evolution with the %s locale, your MySQL needs to support the %s connection charset.').' (SET NAMES %s)',
<a name="l695"><span class="linenum"> 695</span></a>                  <a class="var it2774" onMouseOver="hilite(2774)" onMouseOut="lolite()" onClick="logVariable('current_locale')" href="../../_variables/current_locale.html">$current_locale</a>, <a class="var it694" onMouseOver="hilite(694)" onMouseOut="lolite()" onClick="logVariable('evo_charset')" href="../../_variables/evo_charset.html">$evo_charset</a>, <a class="var it5445" onMouseOver="hilite(5445)" onMouseOut="lolite()" onClick="logVariable('expected_connection_charset')" href="../../_variables/expected_connection_charset.html">$expected_connection_charset</a> ).'&lt;/p&gt;&lt;/div&gt;';
<a name="l696"><span class="linenum"> 696</span></a>  <span class="comment">            // sam2kb&gt; TODO: If something is not supported we can display a message saying &quot;do this and that, enable extension X etc. etc... or switch to a better hosting&quot;.</span>
<a name="l697"><span class="linenum"> 697</span></a>              break;
<a name="l698"><span class="linenum"> 698</span></a>          }
<a name="l699"><span class="linenum"> 699</span></a>  
<a name="l700"><span class="linenum"> 700</span></a>          if( <a class="var it5443" onMouseOver="hilite(5443)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../../_variables/old_db_version.html">$old_db_version</a> = <a class="function" onClick="logFunction('get_db_version')" href="../../_functions/get_db_version.html" onMouseOver="funcPopup(event,'get_db_version')">get_db_version</a>() )
<a name="l701"><span class="linenum"> 701</span></a>          {
<a name="l702"><span class="linenum"> 702</span></a>              echo '&lt;p&gt;&lt;strong&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('OOPS! It seems b2evolution is already installed!').'&lt;/strong&gt;&lt;/p&gt;';
<a name="l703"><span class="linenum"> 703</span></a>  
<a name="l704"><span class="linenum"> 704</span></a>              if( <a class="var it5443" onMouseOver="hilite(5443)" onMouseOut="lolite()" onClick="logVariable('old_db_version')" href="../../_variables/old_db_version.html">$old_db_version</a> &lt; <a class="var it4135" onMouseOver="hilite(4135)" onMouseOut="lolite()" onClick="logVariable('new_db_version')" href="../../_variables/new_db_version.html">$new_db_version</a> )
<a name="l705"><span class="linenum"> 705</span></a>              {
<a name="l706"><span class="linenum"> 706</span></a>                  echo '&lt;p&gt;'.sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Would you like to &lt;a %s&gt;upgrade your existing installation now&lt;/a&gt;?'), 'href=&quot;?action=evoupgrade&quot;' ).'&lt;/p&gt;';
<a name="l707"><span class="linenum"> 707</span></a>              }
<a name="l708"><span class="linenum"> 708</span></a>  
<a name="l709"><span class="linenum"> 709</span></a>              break;
<a name="l710"><span class="linenum"> 710</span></a>          }
<a name="l711"><span class="linenum"> 711</span></a>  
<a name="l712"><span class="linenum"> 712</span></a>          echo '&lt;h2&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Installing b2evolution...').'&lt;/h2&gt;';
<a name="l713"><span class="linenum"> 713</span></a>  
<a name="l714"><span class="linenum"> 714</span></a>          echo '&lt;h2&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Checking files...').'&lt;/h2&gt;';
<a name="l715"><span class="linenum"> 715</span></a>          <a class="function" onClick="logFunction('evo_flush')" href="../../_functions/evo_flush.html" onMouseOver="funcPopup(event,'evo_flush')">evo_flush</a>();
<a name="l716"><span class="linenum"> 716</span></a>  <span class="comment">        // Check for .htaccess:</span>
<a name="l717"><span class="linenum"> 717</span></a>          if( !<a class="function" onClick="logFunction('install_htaccess')" href="../../_functions/install_htaccess.html" onMouseOver="funcPopup(event,'install_htaccess')">install_htaccess</a>( false ) )
<a name="l718"><span class="linenum"> 718</span></a>          {    // Exit installation here because the .htaccess file has the some errors
<a name="l719"><span class="linenum"> 719</span></a>              break;
<a name="l720"><span class="linenum"> 720</span></a>          }
<a name="l721"><span class="linenum"> 721</span></a>  
<a name="l722"><span class="linenum"> 722</span></a>  <span class="comment">        // Here's the meat!</span>
<a name="l723"><span class="linenum"> 723</span></a>          <a class="function" onClick="logFunction('install_newdb')" href="../../_functions/install_newdb.html" onMouseOver="funcPopup(event,'install_newdb')">install_newdb</a>();
<a name="l724"><span class="linenum"> 724</span></a>          break;
<a name="l725"><span class="linenum"> 725</span></a>  
<a name="l726"><span class="linenum"> 726</span></a>  
<a name="l727"><span class="linenum"> 727</span></a>      case 'evoupgrade':
<a name="l728"><span class="linenum"> 728</span></a>      case 'auto_upgrade':
<a name="l729"><span class="linenum"> 729</span></a>      case 'svn_upgrade':
<a name="l730"><span class="linenum"> 730</span></a>          <span class="comment">/*</span>
<a name="l731"><span class="linenum"> 731</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l732"><span class="linenum"> 732</span></a>  <span class="comment">         * EVO UPGRADE: Upgrade data from existing b2evolution database</span>
<a name="l733"><span class="linenum"> 733</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l734"><span class="linenum"> 734</span></a>  <span class="comment">         */</span>
<a name="l735"><span class="linenum"> 735</span></a>          <a class="function" onClick="logFunction('track_step')" href="../../_functions/track_step.html" onMouseOver="funcPopup(event,'track_step')">track_step</a>( 'upgrade-start' );
<a name="l736"><span class="linenum"> 736</span></a>  
<a name="l737"><span class="linenum"> 737</span></a>          require_once( <a class="phpfunction" onClick="logFunction('dirname')" href="../../_functions/dirname.html" onMouseOver="phpfuncPopup(event,'dirname')">dirname</a>(__FILE__). '/_functions_evoupgrade.php' );
<a name="l738"><span class="linenum"> 738</span></a>  
<a name="l739"><span class="linenum"> 739</span></a>          echo '&lt;h2&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Upgrading b2evolution...').'&lt;/h2&gt;';
<a name="l740"><span class="linenum"> 740</span></a>  
<a name="l741"><span class="linenum"> 741</span></a>          echo '&lt;h2&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Checking files...').'&lt;/h2&gt;';
<a name="l742"><span class="linenum"> 742</span></a>          <a class="function" onClick="logFunction('evo_flush')" href="../../_functions/evo_flush.html" onMouseOver="funcPopup(event,'evo_flush')">evo_flush</a>();
<a name="l743"><span class="linenum"> 743</span></a>  <span class="comment">        // Check for .htaccess:</span>
<a name="l744"><span class="linenum"> 744</span></a>          if( !<a class="function" onClick="logFunction('install_htaccess')" href="../../_functions/install_htaccess.html" onMouseOver="funcPopup(event,'install_htaccess')">install_htaccess</a>( true ) )
<a name="l745"><span class="linenum"> 745</span></a>          {    // Exit installation here because the .htaccess file has the some errors
<a name="l746"><span class="linenum"> 746</span></a>              break;
<a name="l747"><span class="linenum"> 747</span></a>          }
<a name="l748"><span class="linenum"> 748</span></a>  
<a name="l749"><span class="linenum"> 749</span></a>  <span class="comment">        // Try to obtain some serious time to do some serious processing (5 minutes)</span>
<a name="l750"><span class="linenum"> 750</span></a>  <span class="comment">        // NOte: this must NOT be in upgrade_b2evo_tables(), otherwise it will mess with the longer setting used by the auto upgrade feature.</span>
<a name="l751"><span class="linenum"> 751</span></a>          if( <a class="function" onClick="logFunction('set_max_execution_time')" href="../../_functions/set_max_execution_time.html" onMouseOver="funcPopup(event,'set_max_execution_time')">set_max_execution_time</a>(300) === false )
<a name="l752"><span class="linenum"> 752</span></a>          { // max_execution_time ini setting could not be changed for this script, display a warning
<a name="l753"><span class="linenum"> 753</span></a>              <a class="var it5446" onMouseOver="hilite(5446)" onMouseOut="lolite()" onClick="logVariable('manual_url')" href="../../_variables/manual_url.html">$manual_url</a> = 'href=&quot;'.<a class="function" onClick="logFunction('get_manual_url')" href="../../_functions/get_manual_url.html" onMouseOver="funcPopup(event,'get_manual_url')">get_manual_url</a>( 'blank-or-partial-page' ).'&quot; target = &quot;_blank&quot;';
<a name="l754"><span class="linenum"> 754</span></a>              echo '&lt;div class=&quot;orange&quot;&gt;'.sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('WARNING: the max_execution_time is set to %s seconds in php.ini and cannot be increased automatically. This may lead to a PHP &lt;a %s&gt;timeout causing the upgrade to fail&lt;/a&gt;. If so please post a screenshot to the &lt;a %s&gt;forums&lt;/a&gt;.'), <a class="phpfunction" onClick="logFunction('ini_get')" href="../../_functions/ini_get.html" onMouseOver="phpfuncPopup(event,'ini_get')">ini_get</a>( 'max_execution_time' ), <a class="var it5446" onMouseOver="hilite(5446)" onMouseOut="lolite()" onClick="logVariable('manual_url')" href="../../_variables/manual_url.html">$manual_url</a>, 'href=&quot;http://forums.b2evolution.net/&quot;' ).'&lt;/div&gt;';
<a name="l755"><span class="linenum"> 755</span></a>          }
<a name="l756"><span class="linenum"> 756</span></a>  
<a name="l757"><span class="linenum"> 757</span></a>          echo '&lt;h2&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Upgrading data in existing b2evolution database...').'&lt;/h2&gt;';
<a name="l758"><span class="linenum"> 758</span></a>          <a class="function" onClick="logFunction('evo_flush')" href="../../_functions/evo_flush.html" onMouseOver="funcPopup(event,'evo_flush')">evo_flush</a>();
<a name="l759"><span class="linenum"> 759</span></a>  
<a name="l760"><span class="linenum"> 760</span></a>          <a class="var it5447" onMouseOver="hilite(5447)" onMouseOut="lolite()" onClick="logVariable('not_evoupgrade')" href="../../_variables/not_evoupgrade.html">$not_evoupgrade</a> = ( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> !== 'evoupgrade' );
<a name="l761"><span class="linenum"> 761</span></a>          if( <a class="function" onClick="logFunction('upgrade_b2evo_tables')" href="../../_functions/upgrade_b2evo_tables.html" onMouseOver="funcPopup(event,'upgrade_b2evo_tables')">upgrade_b2evo_tables</a>( <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> ) )
<a name="l762"><span class="linenum"> 762</span></a>          {
<a name="l763"><span class="linenum"> 763</span></a>              if( <a class="var it5447" onMouseOver="hilite(5447)" onMouseOut="lolite()" onClick="logVariable('not_evoupgrade')" href="../../_variables/not_evoupgrade.html">$not_evoupgrade</a> )
<a name="l764"><span class="linenum"> 764</span></a>              { // After successful auto_upgrade or svn_upgrade we must remove files/folder based on the upgrade_policy.conf
<a name="l765"><span class="linenum"> 765</span></a>                  <a class="function" onClick="logFunction('remove_after_upgrade')" href="../../_functions/remove_after_upgrade.html" onMouseOver="funcPopup(event,'remove_after_upgrade')">remove_after_upgrade</a>();
<a name="l766"><span class="linenum"> 766</span></a>  <span class="comment">                // disable maintenance mode at the end of the upgrade script</span>
<a name="l767"><span class="linenum"> 767</span></a>                  <a class="function" onClick="logFunction('switch_maintenance_mode')" href="../../_functions/switch_maintenance_mode.html" onMouseOver="funcPopup(event,'switch_maintenance_mode')">switch_maintenance_mode</a>( false, 'upgrade' );
<a name="l768"><span class="linenum"> 768</span></a>              }
<a name="l769"><span class="linenum"> 769</span></a>              ?&gt;
<a name="l770"><span class="linenum"> 770</span></a>              &lt;p&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Upgrade completed successfully!')?&gt;&lt;/p&gt;
<a name="l771"><span class="linenum"> 771</span></a>              &lt;p&gt;&lt;?php printf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Now you can &lt;a %s&gt;log in&lt;/a&gt; with your usual %s username and password.'), 'href=&quot;'.<a class="var it346" onMouseOver="hilite(346)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../_variables/admin_url.html">$admin_url</a>.'&quot;', 'b2evolution')?&gt;&lt;/p&gt;
<a name="l772"><span class="linenum"> 772</span></a>              &lt;?php
<a name="l773"><span class="linenum"> 773</span></a>          }
<a name="l774"><span class="linenum"> 774</span></a>          else
<a name="l775"><span class="linenum"> 775</span></a>          {
<a name="l776"><span class="linenum"> 776</span></a>              if( <a class="var it5447" onMouseOver="hilite(5447)" onMouseOut="lolite()" onClick="logVariable('not_evoupgrade')" href="../../_variables/not_evoupgrade.html">$not_evoupgrade</a> )
<a name="l777"><span class="linenum"> 777</span></a>              { // disable maintenance mode at the end of the upgrade script
<a name="l778"><span class="linenum"> 778</span></a>                  <a class="function" onClick="logFunction('switch_maintenance_mode')" href="../../_functions/switch_maintenance_mode.html" onMouseOver="funcPopup(event,'switch_maintenance_mode')">switch_maintenance_mode</a>( false, 'upgrade' );
<a name="l779"><span class="linenum"> 779</span></a>              }
<a name="l780"><span class="linenum"> 780</span></a>              ?&gt;
<a name="l781"><span class="linenum"> 781</span></a>              &lt;p class=&quot;red&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Upgrade failed!')?&gt;&lt;/p&gt;
<a name="l782"><span class="linenum"> 782</span></a>              &lt;?php
<a name="l783"><span class="linenum"> 783</span></a>          }
<a name="l784"><span class="linenum"> 784</span></a>  
<a name="l785"><span class="linenum"> 785</span></a>          break;
<a name="l786"><span class="linenum"> 786</span></a>  
<a name="l787"><span class="linenum"> 787</span></a>  
<a name="l788"><span class="linenum"> 788</span></a>      case 'deletedb':
<a name="l789"><span class="linenum"> 789</span></a>          <span class="comment">/*</span>
<a name="l790"><span class="linenum"> 790</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l791"><span class="linenum"> 791</span></a>  <span class="comment">         * DELETE DB: Delete the db structure!!! (Everything will be lost)</span>
<a name="l792"><span class="linenum"> 792</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l793"><span class="linenum"> 793</span></a>  <span class="comment">         */</span>
<a name="l794"><span class="linenum"> 794</span></a>          require_once( <a class="phpfunction" onClick="logFunction('dirname')" href="../../_functions/dirname.html" onMouseOver="phpfuncPopup(event,'dirname')">dirname</a>(__FILE__). '/_functions_delete.php' );
<a name="l795"><span class="linenum"> 795</span></a>  
<a name="l796"><span class="linenum"> 796</span></a>          echo '&lt;h2&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Deleting b2evolution tables from the datatase...').'&lt;/h2&gt;';
<a name="l797"><span class="linenum"> 797</span></a>          <a class="function" onClick="logFunction('evo_flush')" href="../../_functions/evo_flush.html" onMouseOver="funcPopup(event,'evo_flush')">evo_flush</a>();
<a name="l798"><span class="linenum"> 798</span></a>  
<a name="l799"><span class="linenum"> 799</span></a>          if( <a class="var it312" onMouseOver="hilite(312)" onMouseOut="lolite()" onClick="logVariable('allow_evodb_reset')" href="../../_variables/allow_evodb_reset.html">$allow_evodb_reset</a> != 1 )
<a name="l800"><span class="linenum"> 800</span></a>          {
<a name="l801"><span class="linenum"> 801</span></a>              echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('If you have installed b2evolution tables before and wish to start anew, you must delete the b2evolution tables before you can start a new installation. b2evolution can delete its own tables for you, but for obvious security reasons, this feature is disabled by default.');
<a name="l802"><span class="linenum"> 802</span></a>              echo '&lt;p&gt;'.sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('To enable it, please go to the %s file and change: %s to %s'), '/conf/_basic_config.php', '&lt;pre&gt;<a class="var it312" onMouseOver="hilite(312)" onMouseOut="lolite()" onClick="logVariable('allow_evodb_reset')" href="../../_variables/allow_evodb_reset.html">$allow_evodb_reset</a> = 0;&lt;/pre&gt;', '&lt;pre&gt;<a class="var it312" onMouseOver="hilite(312)" onMouseOut="lolite()" onClick="logVariable('allow_evodb_reset')" href="../../_variables/allow_evodb_reset.html">$allow_evodb_reset</a> = 1;&lt;/pre&gt;' ).'&lt;/p&gt;';
<a name="l803"><span class="linenum"> 803</span></a>              echo '&lt;p&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Then reload this page and a reset option will appear.').'&lt;/p&gt;';
<a name="l804"><span class="linenum"> 804</span></a>              echo '&lt;p&gt;&lt;a href=&quot;index.php?locale='.<a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a>.'&quot;&gt;&amp;laquo; '.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Back to install menu').'&lt;/a&gt;&lt;/p&gt;';
<a name="l805"><span class="linenum"> 805</span></a>  
<a name="l806"><span class="linenum"> 806</span></a>              break;
<a name="l807"><span class="linenum"> 807</span></a>          }
<a name="l808"><span class="linenum"> 808</span></a>  
<a name="l809"><span class="linenum"> 809</span></a>          if( ! <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>('confirmed', 'integer', 1) )
<a name="l810"><span class="linenum"> 810</span></a>          {
<a name="l811"><span class="linenum"> 811</span></a>              ?&gt;
<a name="l812"><span class="linenum"> 812</span></a>              &lt;p&gt;
<a name="l813"><span class="linenum"> 813</span></a>              &lt;?php
<a name="l814"><span class="linenum"> 814</span></a>              echo <a class="phpfunction" onClick="logFunction('nl2br')" href="../../_functions/nl2br.html" onMouseOver="phpfuncPopup(event,'nl2br')">nl2br</a>( <a class="function" onClick="logFunction('evo_htmlspecialchars')" href="../../_functions/evo_htmlspecialchars.html" onMouseOver="funcPopup(event,'evo_htmlspecialchars')">evo_htmlspecialchars</a>( sprintf( <span class="comment">/* TRANS: %s gets replaced by app name, usually &quot;b2evolution&quot; */</span> <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>( &quot;Are you sure you want to delete your existing %s tables?\nDo you have a backup?&quot; ), <a class="var it137" onMouseOver="hilite(137)" onMouseOut="lolite()" onClick="logVariable('app_name')" href="../../_variables/app_name.html">$app_name</a> ) ) );
<a name="l815"><span class="linenum"> 815</span></a>              ?&gt;
<a name="l816"><span class="linenum"> 816</span></a>              &lt;/p&gt;
<a name="l817"><span class="linenum"> 817</span></a>              &lt;p&gt;
<a name="l818"><span class="linenum"> 818</span></a>              &lt;form class=&quot;inline&quot; name=&quot;form&quot; action=&quot;index.php&quot; method=&quot;post&quot;&gt;
<a name="l819"><span class="linenum"> 819</span></a>                  &lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;deletedb&quot; /&gt;
<a name="l820"><span class="linenum"> 820</span></a>                  &lt;input type=&quot;hidden&quot; name=&quot;confirmed&quot; value=&quot;1&quot; /&gt;
<a name="l821"><span class="linenum"> 821</span></a>                  &lt;input type=&quot;hidden&quot; name=&quot;locale&quot; value=&quot;&lt;?php echo <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a>; ?&gt;&quot; /&gt;
<a name="l822"><span class="linenum"> 822</span></a>                  &lt;input type=&quot;submit&quot; value=&quot;&amp;nbsp; &lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('I am sure!')?&gt; &amp;nbsp;&quot; /&gt;
<a name="l823"><span class="linenum"> 823</span></a>              &lt;/form&gt;
<a name="l824"><span class="linenum"> 824</span></a>  
<a name="l825"><span class="linenum"> 825</span></a>              &lt;form class=&quot;inline&quot; name=&quot;form&quot; action=&quot;index.php&quot; method=&quot;get&quot;&gt;
<a name="l826"><span class="linenum"> 826</span></a>                  &lt;input type=&quot;hidden&quot; name=&quot;locale&quot; value=&quot;&lt;?php echo <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a>; ?&gt;&quot; /&gt;
<a name="l827"><span class="linenum"> 827</span></a>                  &lt;input type=&quot;submit&quot; value=&quot;&amp;nbsp; &lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('CANCEL')?&gt; &amp;nbsp;&quot; /&gt;
<a name="l828"><span class="linenum"> 828</span></a>              &lt;/form&gt;
<a name="l829"><span class="linenum"> 829</span></a>              &lt;/p&gt;
<a name="l830"><span class="linenum"> 830</span></a>              &lt;?php
<a name="l831"><span class="linenum"> 831</span></a>              break;
<a name="l832"><span class="linenum"> 832</span></a>          }
<a name="l833"><span class="linenum"> 833</span></a>  
<a name="l834"><span class="linenum"> 834</span></a>  <span class="comment">        // Uninstall Plugins</span>
<a name="l835"><span class="linenum"> 835</span></a>  <span class="comment">        // TODO: fp&gt;&gt; I don't trust the plugins to uninstall themselves correctly. There will be tons of lousy poorly written plugins. All I trust them to do is to crash the uninstall procedure. We want a hardcore brute force uninsall! and most users &quot;may NOT want&quot; to even think about &quot;ma-nu-al-ly&quot; removing something from their DB.</span>
<a name="l836"><span class="linenum"> 836</span></a>          <span class="comment">/*</span>
<a name="l837"><span class="linenum"> 837</span></a>  <span class="comment">                $DB-&gt;show_errors = $DB-&gt;halt_on_error = false;</span>
<a name="l838"><span class="linenum"> 838</span></a>  <span class="comment">                $Plugins = new Plugins();</span>
<a name="l839"><span class="linenum"> 839</span></a>  <span class="comment">                $DB-&gt;show_errors = $DB-&gt;halt_on_error = true;</span>
<a name="l840"><span class="linenum"> 840</span></a>  <span class="comment">                $at_least_one_failed = false;</span>
<a name="l841"><span class="linenum"> 841</span></a>  <span class="comment">                foreach( $Plugins-&gt;get_list_by_event( 'Uninstall' ) as $l_Plugin )</span>
<a name="l842"><span class="linenum"> 842</span></a>  <span class="comment">                {</span>
<a name="l843"><span class="linenum"> 843</span></a>  <span class="comment">                    $success = $Plugins-&gt;call_method( $l_Plugin-&gt;ID, 'Uninstall', $params = array( 'unattended' =&gt; true ) );</span>
<a name="l844"><span class="linenum"> 844</span></a>  <span class="comment">                    if( $success === false )</span>
<a name="l845"><span class="linenum"> 845</span></a>  <span class="comment">                    {</span>
<a name="l846"><span class="linenum"> 846</span></a>  <span class="comment">                        echo &quot;Failed un-installing plugin $l_Plugin-&gt;classname (ID $l_Plugin-&gt;ID)...&lt;br /&gt;\n&quot;;</span>
<a name="l847"><span class="linenum"> 847</span></a>  <span class="comment">                        $at_least_one_failed = false;</span>
<a name="l848"><span class="linenum"> 848</span></a>  <span class="comment">                    }</span>
<a name="l849"><span class="linenum"> 849</span></a>  <span class="comment">                    else</span>
<a name="l850"><span class="linenum"> 850</span></a>  <span class="comment">                    {</span>
<a name="l851"><span class="linenum"> 851</span></a>  <span class="comment">                        echo &quot;Uninstalled plugin $l_Plugin-&gt;classname (ID $l_Plugin-&gt;ID)...&lt;br /&gt;\n&quot;;</span>
<a name="l852"><span class="linenum"> 852</span></a>  <span class="comment">                    }</span>
<a name="l853"><span class="linenum"> 853</span></a>  <span class="comment">                }</span>
<a name="l854"><span class="linenum"> 854</span></a>  <span class="comment">                if( $at_least_one_failed )</span>
<a name="l855"><span class="linenum"> 855</span></a>  <span class="comment">                {</span>
<a name="l856"><span class="linenum"> 856</span></a>  <span class="comment">                    echo &quot;You may want to manually remove left files or DB tables from the failed plugin(s).&lt;br /&gt;\n&quot;;</span>
<a name="l857"><span class="linenum"> 857</span></a>  <span class="comment">                }</span>
<a name="l858"><span class="linenum"> 858</span></a>  <span class="comment">                $DB-&gt;show_errors = $DB-&gt;halt_on_error = true;</span>
<a name="l859"><span class="linenum"> 859</span></a>  <span class="comment">        */</span>
<a name="l860"><span class="linenum"> 860</span></a>  
<a name="l861"><span class="linenum"> 861</span></a>  <span class="comment">        /* REMOVE PAGE CACHE */</span>
<a name="l862"><span class="linenum"> 862</span></a>          <a class="function" onClick="logFunction('load_class')" href="../../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( '_core/model/_pagecache.class.php', 'PageCache' );
<a name="l863"><span class="linenum"> 863</span></a>  
<a name="l864"><span class="linenum"> 864</span></a>  <span class="comment">        // Remove general page cache</span>
<a name="l865"><span class="linenum"> 865</span></a>          <a class="var it551" onMouseOver="hilite(551)" onMouseOut="lolite()" onClick="logVariable('PageCache')" href="../../_variables/PageCache.html">$PageCache</a> = <span class="keyword">new </span><a class="class" onClick="logClass('PageCache')" href="../../_classes/pagecache.html" onMouseOver="classPopup(event,'pagecache')">PageCache</a>( NULL );
<a name="l866"><span class="linenum"> 866</span></a>          <a class="var it551" onMouseOver="hilite(551)" onMouseOut="lolite()" onClick="logVariable('PageCache')" href="../../_variables/PageCache.html">$PageCache</a>-&gt;<a class="function" onClick="logFunction('cache_delete')" href="../../_functions/cache_delete.html" onMouseOver="funcPopup(event,'cache_delete')">cache_delete</a>();
<a name="l867"><span class="linenum"> 867</span></a>  
<a name="l868"><span class="linenum"> 868</span></a>  <span class="comment">        // Skip if T_blogs table is already deleted. Note that db_delete() will not throw any errors on missing tables.</span>
<a name="l869"><span class="linenum"> 869</span></a>          if( <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'SHOW TABLES LIKE &quot;T_blogs&quot;' ) )
<a name="l870"><span class="linenum"> 870</span></a>          { // Get all blogs
<a name="l871"><span class="linenum"> 871</span></a>              <a class="var it5448" onMouseOver="hilite(5448)" onMouseOut="lolite()" onClick="logVariable('blogs_SQL')" href="../../_variables/blogs_SQL.html">$blogs_SQL</a> = <span class="keyword">new </span><a class="class" onClick="logClass('SQL')" href="../../_classes/sql.html" onMouseOver="classPopup(event,'sql')">SQL</a>();
<a name="l872"><span class="linenum"> 872</span></a>              <a class="var it5448" onMouseOver="hilite(5448)" onMouseOut="lolite()" onClick="logVariable('blogs_SQL')" href="../../_variables/blogs_SQL.html">$blogs_SQL</a>-&gt;<a class="function" onClick="logFunction('SELECT')" href="../../_functions/select.html" onMouseOver="funcPopup(event,'select')">SELECT</a>( 'blog_ID' );
<a name="l873"><span class="linenum"> 873</span></a>              <a class="var it5448" onMouseOver="hilite(5448)" onMouseOut="lolite()" onClick="logVariable('blogs_SQL')" href="../../_variables/blogs_SQL.html">$blogs_SQL</a>-&gt;<a class="function" onClick="logFunction('FROM')" href="../../_functions/from.html" onMouseOver="funcPopup(event,'from')">FROM</a>( 'T_blogs' );
<a name="l874"><span class="linenum"> 874</span></a>              <a class="var it5449" onMouseOver="hilite(5449)" onMouseOut="lolite()" onClick="logVariable('blogs')" href="../../_variables/blogs.html">$blogs</a> = <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_col')" href="../../_functions/get_col.html" onMouseOver="funcPopup(event,'get_col')">get_col</a>( <a class="var it5448" onMouseOver="hilite(5448)" onMouseOut="lolite()" onClick="logVariable('blogs_SQL')" href="../../_variables/blogs_SQL.html">$blogs_SQL</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>() );
<a name="l875"><span class="linenum"> 875</span></a>  
<a name="l876"><span class="linenum"> 876</span></a>              <a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('BlogCache')" href="../../_variables/BlogCache.html">$BlogCache</a> = &amp; get_BlogCache( 'blog_ID' );
<a name="l877"><span class="linenum"> 877</span></a>              foreach( <a class="var it5449" onMouseOver="hilite(5449)" onMouseOut="lolite()" onClick="logVariable('blogs')" href="../../_variables/blogs.html">$blogs</a> as <a class="var it326" onMouseOver="hilite(326)" onMouseOut="lolite()" onClick="logVariable('blog_ID')" href="../../_variables/blog_ID.html">$blog_ID</a> )
<a name="l878"><span class="linenum"> 878</span></a>              {
<a name="l879"><span class="linenum"> 879</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../_variables/Blog.html">$Blog</a> = <a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('BlogCache')" href="../../_variables/BlogCache.html">$BlogCache</a>-&gt;get_by_ID( <a class="var it326" onMouseOver="hilite(326)" onMouseOut="lolite()" onClick="logVariable('blog_ID')" href="../../_variables/blog_ID.html">$blog_ID</a> );
<a name="l880"><span class="linenum"> 880</span></a>  
<a name="l881"><span class="linenum"> 881</span></a>  <span class="comment">                // Remove page cache of current blog</span>
<a name="l882"><span class="linenum"> 882</span></a>                  <a class="var it551" onMouseOver="hilite(551)" onMouseOut="lolite()" onClick="logVariable('PageCache')" href="../../_variables/PageCache.html">$PageCache</a> = <span class="keyword">new </span><a class="class" onClick="logClass('PageCache')" href="../../_classes/pagecache.html" onMouseOver="classPopup(event,'pagecache')">PageCache</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../_variables/Blog.html">$Blog</a> );
<a name="l883"><span class="linenum"> 883</span></a>                  <a class="var it551" onMouseOver="hilite(551)" onMouseOut="lolite()" onClick="logVariable('PageCache')" href="../../_variables/PageCache.html">$PageCache</a>-&gt;<a class="function" onClick="logFunction('cache_delete')" href="../../_functions/cache_delete.html" onMouseOver="funcPopup(event,'cache_delete')">cache_delete</a>();
<a name="l884"><span class="linenum"> 884</span></a>              }
<a name="l885"><span class="linenum"> 885</span></a>          }
<a name="l886"><span class="linenum"> 886</span></a>  
<a name="l887"><span class="linenum"> 887</span></a>  <span class="comment">        /* REMOVE DATABASE */</span>
<a name="l888"><span class="linenum"> 888</span></a>          <a class="function" onClick="logFunction('db_delete')" href="../../_functions/db_delete.html" onMouseOver="funcPopup(event,'db_delete')">db_delete</a>();
<a name="l889"><span class="linenum"> 889</span></a>          ?&gt;
<a name="l890"><span class="linenum"> 890</span></a>          &lt;p&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Reset done!')?&gt;&lt;/p&gt;
<a name="l891"><span class="linenum"> 891</span></a>          &lt;p&gt;&lt;a href=&quot;index.php?locale=&lt;?php echo <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a> ?&gt;&quot;&gt;&amp;laquo; &lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Back to install menu') ?&gt;&lt;/a&gt;&lt;/p&gt;
<a name="l892"><span class="linenum"> 892</span></a>          &lt;?php
<a name="l893"><span class="linenum"> 893</span></a>          break;
<a name="l894"><span class="linenum"> 894</span></a>  
<a name="l895"><span class="linenum"> 895</span></a>  
<a name="l896"><span class="linenum"> 896</span></a>      case 'utf8upgrade':
<a name="l897"><span class="linenum"> 897</span></a>          <span class="comment">/*</span>
<a name="l898"><span class="linenum"> 898</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l899"><span class="linenum"> 899</span></a>  <span class="comment">         * UPGRADE DB to UTF-8: all DB tables will be converted to UTF-8</span>
<a name="l900"><span class="linenum"> 900</span></a>  <span class="comment">         * -----------------------------------------------------------------------------------</span>
<a name="l901"><span class="linenum"> 901</span></a>  <span class="comment">         */</span>
<a name="l902"><span class="linenum"> 902</span></a>  
<a name="l903"><span class="linenum"> 903</span></a>          <a class="function" onClick="logFunction('load_funcs')" href="../../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>('_core/model/db/_upgrade.funcs.php');
<a name="l904"><span class="linenum"> 904</span></a>  
<a name="l905"><span class="linenum"> 905</span></a>          echo '&lt;h2&gt;'.<a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Upgrading all tables in b2evolution MySQL database to UTF-8...').'&lt;/h2&gt;';
<a name="l906"><span class="linenum"> 906</span></a>          <a class="function" onClick="logFunction('evo_flush')" href="../../_functions/evo_flush.html" onMouseOver="funcPopup(event,'evo_flush')">evo_flush</a>();
<a name="l907"><span class="linenum"> 907</span></a>  
<a name="l908"><span class="linenum"> 908</span></a>  <span class="comment">        // Load db schema to be able to check the original charset definition</span>
<a name="l909"><span class="linenum"> 909</span></a>          <a class="function" onClick="logFunction('load_db_schema')" href="../../_functions/load_db_schema.html" onMouseOver="funcPopup(event,'load_db_schema')">load_db_schema</a>();
<a name="l910"><span class="linenum"> 910</span></a>  
<a name="l911"><span class="linenum"> 911</span></a>          <a class="var it5450" onMouseOver="hilite(5450)" onMouseOut="lolite()" onClick="logVariable('db_tables')" href="../../_variables/db_tables.html">$db_tables</a> = <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_col')" href="../../_functions/get_col.html" onMouseOver="funcPopup(event,'get_col')">get_col</a>( 'SHOW TABLES FROM `'.<a class="var it1750" onMouseOver="hilite(1750)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../../_variables/db_config.html">$db_config</a>['name'].'` LIKE &quot;'.<a class="var it748" onMouseOver="hilite(748)" onMouseOut="lolite()" onClick="logVariable('tableprefix')" href="../../_variables/tableprefix.html">$tableprefix</a>.'%&quot;' );
<a name="l912"><span class="linenum"> 912</span></a>          foreach( <a class="var it5450" onMouseOver="hilite(5450)" onMouseOut="lolite()" onClick="logVariable('db_tables')" href="../../_variables/db_tables.html">$db_tables</a> as <a class="var it944" onMouseOver="hilite(944)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> )
<a name="l913"><span class="linenum"> 913</span></a>          { // Convert all tables charset to utf8
<a name="l914"><span class="linenum"> 914</span></a>              echo &quot;Converting <a class="var it944" onMouseOver="hilite(944)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a>...&quot;;
<a name="l915"><span class="linenum"> 915</span></a>              <a class="function" onClick="logFunction('evo_flush')" href="../../_functions/evo_flush.html" onMouseOver="funcPopup(event,'evo_flush')">evo_flush</a>();
<a name="l916"><span class="linenum"> 916</span></a>              <a class="function" onClick="logFunction('convert_table_to_utf8')" href="../../_functions/convert_table_to_utf8.html" onMouseOver="funcPopup(event,'convert_table_to_utf8')">convert_table_to_utf8</a>( <a class="var it944" onMouseOver="hilite(944)" onMouseOut="lolite()" onClick="logVariable('table')" href="../../_variables/table.html">$table</a> );
<a name="l917"><span class="linenum"> 917</span></a>              echo &quot; OK&lt;br /&gt;\n&quot;;
<a name="l918"><span class="linenum"> 918</span></a>          }
<a name="l919"><span class="linenum"> 919</span></a>  
<a name="l920"><span class="linenum"> 920</span></a>          echo &quot;Changing default charset of DB...&lt;br /&gt;\n&quot;;
<a name="l921"><span class="linenum"> 921</span></a>          <a class="function" onClick="logFunction('evo_flush')" href="../../_functions/evo_flush.html" onMouseOver="funcPopup(event,'evo_flush')">evo_flush</a>();
<a name="l922"><span class="linenum"> 922</span></a>          <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'ALTER DATABASE `'.<a class="var it1750" onMouseOver="hilite(1750)" onMouseOut="lolite()" onClick="logVariable('db_config')" href="../../_variables/db_config.html">$db_config</a>['name'].'` CHARACTER SET utf8 COLLATE utf8_general_ci' );
<a name="l923"><span class="linenum"> 923</span></a>  
<a name="l924"><span class="linenum"> 924</span></a>          ?&gt;
<a name="l925"><span class="linenum"> 925</span></a>          &lt;p&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Upgrading done!')?&gt;&lt;/p&gt;
<a name="l926"><span class="linenum"> 926</span></a>          &lt;p&gt;&lt;a href=&quot;index.php?locale=&lt;?php echo <a class="var it2782" onMouseOver="hilite(2782)" onMouseOut="lolite()" onClick="logVariable('default_locale')" href="../../_variables/default_locale.html">$default_locale</a> ?&gt;&quot;&gt;&amp;laquo; &lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Back to install menu') ?&gt;&lt;/a&gt;&lt;/p&gt;
<a name="l927"><span class="linenum"> 927</span></a>          &lt;?php
<a name="l928"><span class="linenum"> 928</span></a>          break;
<a name="l929"><span class="linenum"> 929</span></a>  }
<a name="l930"><span class="linenum"> 930</span></a>  
<a name="l931"><span class="linenum"> 931</span></a>  <a class="function" onClick="logFunction('block_close')" href="../../_functions/block_close.html" onMouseOver="funcPopup(event,'block_close')">block_close</a>();
<a name="l932"><span class="linenum"> 932</span></a>  ?&gt;
<a name="l933"><span class="linenum"> 933</span></a>  
<a name="l934"><span class="linenum"> 934</span></a>  &lt;!-- InstanceEndEditable --&gt;
<a name="l935"><span class="linenum"> 935</span></a>      &lt;/div&gt;
<a name="l936"><span class="linenum"> 936</span></a>  
<a name="l937"><span class="linenum"> 937</span></a>      &lt;div class=&quot;body_fade_out&quot;&gt;
<a name="l938"><span class="linenum"> 938</span></a>  
<a name="l939"><span class="linenum"> 939</span></a>      &lt;div class=&quot;menu_bottom&quot;&gt;&lt;!-- InstanceBeginEditable name=&quot;MenuBottom&quot; --&gt;
<a name="l940"><span class="linenum"> 940</span></a>              &lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Online resources') ?&gt;: &lt;a href=&quot;http://b2evolution.net/&quot; target=&quot;_blank&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Official website') ?&gt;&lt;/a&gt; &amp;bull; &lt;a href=&quot;http://b2evolution.net/about/recommended-hosting-lamp-best-choices.php&quot; target=&quot;_blank&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Find a host') ?&gt;&lt;/a&gt; &amp;bull; &lt;a href=&quot;&lt;?php echo <a class="function" onClick="logFunction('get_manual_url')" href="../../_functions/get_manual_url.html" onMouseOver="funcPopup(event,'get_manual_url')">get_manual_url</a>( NULL ); ?&gt;&quot; target=&quot;_blank&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Manual') ?&gt;&lt;/a&gt; &amp;bull; &lt;a href=&quot;http://forums.b2evolution.net/&quot; target=&quot;_blank&quot;&gt;&lt;?php echo <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Forums') ?&gt;&lt;/a&gt;
<a name="l941"><span class="linenum"> 941</span></a>          &lt;!-- InstanceEndEditable --&gt;&lt;/div&gt;
<a name="l942"><span class="linenum"> 942</span></a>  
<a name="l943"><span class="linenum"> 943</span></a>      &lt;div class=&quot;copyright&quot;&gt;&lt;!-- InstanceBeginEditable name=&quot;CopyrightTail&quot; --&gt;Copyright &amp;copy; 2003-2014 by Fran&amp;ccedil;ois Planque &amp;amp; others &amp;middot; &lt;a href=&quot;http://b2evolution.net/about/license.html&quot; target=&quot;_blank&quot;&gt;GNU GPL license&lt;/a&gt; &amp;middot; &lt;a href=&quot;http://b2evolution.net/contact/&quot; target=&quot;_blank&quot;&gt;Contact&lt;/a&gt;
<a name="l944"><span class="linenum"> 944</span></a>          &lt;!-- InstanceEndEditable --&gt;&lt;/div&gt;
<a name="l945"><span class="linenum"> 945</span></a>  
<a name="l946"><span class="linenum"> 946</span></a>      &lt;/div&gt;
<a name="l947"><span class="linenum"> 947</span></a>      &lt;/div&gt;
<a name="l948"><span class="linenum"> 948</span></a>  
<a name="l949"><span class="linenum"> 949</span></a>      &lt;!-- InstanceBeginEditable name=&quot;BodyFoot&quot; --&gt;
<a name="l950"><span class="linenum"> 950</span></a>      &lt;?php
<a name="l951"><span class="linenum"> 951</span></a>  <span class="comment">        // We need to manually call debug_info since there is no shutdown function registered during the install process.</span>
<a name="l952"><span class="linenum"> 952</span></a>  <span class="comment">        // debug_info( true ); // force output of debug info</span>
<a name="l953"><span class="linenum"> 953</span></a>  
<a name="l954"><span class="linenum"> 954</span></a>  <span class="comment">        // The following comments get checked in the automatic install script of demo.b2evolution.net:</span>
<a name="l955"><span class="linenum"> 955</span></a>  ?&gt;
<a name="l956"><span class="linenum"> 956</span></a>  &lt;!-- b2evo-install-action:&lt;?php echo <a class="var it225" onMouseOver="hilite(225)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> ?&gt; --&gt;
<a name="l957"><span class="linenum"> 957</span></a>  &lt;!-- b2evo-install-end --&gt;
<a name="l958"><span class="linenum"> 958</span></a>      &lt;!-- InstanceEndEditable --&gt;
<a name="l959"><span class="linenum"> 959</span></a>  &lt;/body&gt;
<a name="l960"><span class="linenum"> 960</span></a>  &lt;!-- InstanceEnd --&gt;&lt;/html&gt;
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'get_version': ['get_version', 'version 1 ', [['blogs/plugins/twitter_plugin/twitteroauth','oauth.php',555],['blogs/inc/_core/model/db','_db.class.php',695]], 7],
'convert_table_to_utf8': ['convert_table_to_utf8', 'Convert table character set to utf8 Those columns where the charset or the collation is explicitly defined will be skipped ( those won\'t be converted ) ', [['blogs/inc/_core/model/db','_upgrade.funcs.php',1690]], 1],
'load_class': ['load_class', 'Load class file ', [['blogs/inc/_core','_class4.funcs.php',28],['blogs/inc/_core','_class5.funcs.php',79]], 408],
'evo_flush': ['evo_flush', 'Flush the output buffer ', [['blogs/inc/_core','_misc.funcs.php',6282]], 156],
'load_funcs': ['load_funcs', '', [['blogs/inc/_core','_misc.funcs.php',115]], 214],
'get': ['get', '', [['blogs/plugins/tinymce_plugin/tiny_mce','tiny_mce_src.js',941],['blogs/plugins/tinymce_plugin/tiny_mce','tiny_mce_src.js',15011],['blogs/plugins/tinymce_plugin/tiny_mce/plugins/media/js','media.js',7],['blogs/inc/links/model','_linkowner.class.php',221],['blogs/inc/_core/model/db','_sql.class.php',64],['blogs/inc/plugins/model','_pluginsettings.class.php',58],['blogs/inc/collections/model','_blog.class.php',1822],['blogs/inc/settings/model','_generalsettings.class.php',383],['blogs/inc/settings/model','_abstractsettings.class.php',271],['blogs/inc/plugins/model','_pluginusersettings.class.php',58],['blogs/inc/users/model','_user.class.php',1126],['blogs/plugins/tinymce_plugin/tiny_mce','tiny_mce_gzip.js',38],['blogs/inc/users/model','_usersettings.class.php',151],['blogs/inc/comments/model','_comment.class.php',301],['blogs/inc/users/model','_groupsettings.class.php',124],['blogs/inc/cron/model','_cronjob.class.php',104],['blogs/inc/items/model','_item.class.php',5742],['blogs/inc/sessions/model','_session.class.php',397],['blogs/inc/links/model','_linkuser.class.php',141],['blogs/inc/links/model','_linkitem.class.php',155],['blogs/inc/slugs/model','_slug.class.php',68],['blogs/inc/_core/model/dataobjects','_dataobject.class.php',574],['blogs/plugins/twitter_plugin/twitteroauth','twitteroauth.php',146],['blogs/inc/antispam/model','_iprange.class.php',69],['blogs/inc/links/model','_linkcomment.class.php',132],['blogs/inc/files/model','_file.class.php',532]], 2417],
'display_locale_selector': ['display_locale_selector', 'Language selector ', [['blogs/install','_functions_install.php',41]], 4],
'save_to_file': ['save_to_file', 'Save text data to file, create target file if it doesn\'t exist ', [['blogs/inc/_core','_misc.funcs.php',6213]], 12],
'locale_lang': ['locale_lang', 'Displays/Returns the current locale. (for backward compatibility) ', [['blogs/inc/locales','_locale.funcs.php',366]], 34],
'query': ['query', 'Run Query: GET DATA ROWS *** HEAVY *** ', [['blogs/inc/items/model','_itemlist.class.php',256],['blogs/inc/items/model','_itemlistlight.class.php',751],['blogs/inc/_core/model/db','_db.class.php',761],['blogs/inc/users/model','_userlist.class.php',474],['blogs/inc/_core/ui/results','_results.class.php',439],['blogs/inc/comments/model','_commentlist.class.php',515]], 972],
'form_text': ['form_text', 'Builds a text (or password) input field. ', [['blogs/inc/_core/ui/forms','_form.funcs.php',39]], 10],
'ts_': ['ts_', 'Translate and escape single quotes. ', [['blogs/inc/locales','_locale.funcs.php',247],['blogs/inc/skins/model','_skin.class.php',703],['blogs/inc/plugins','_plugin.class.php',2665]], 242],
'locales_load_available_defs': ['locales_load_available_defs', 'Load available locale definitions ', [['blogs/inc/locales','_locale.funcs.php',1175]], 5],
'upgrade_b2evo_tables': ['upgrade_b2evo_tables', 'upgrade_b2evo_tables(-) ', [['blogs/install','_functions_evoupgrade.php',289],['blogs/inc/_core/model','_module.class.php',103]], 1],
'modules_call_method': ['modules_call_method', 'Call a method for all modules in a row ', [['blogs/inc/_core','_misc.funcs.php',49]], 26],
'block_close': ['block_close', 'Close a block ', [['blogs/install','_functions_install.php',27]], 6],
'install_htaccess': ['install_htaccess', 'Install htaccess: Check if it works with the webserver, then install it for real. ', [['blogs/install','_functions_install.php',917]], 2],
'track_step': ['track_step', 'We use the following tracking to determine the installer reliability (% of failed vs successful installs). ', [['blogs/install','_functions_install.php',1047]], 6],
'load_db_schema': ['load_db_schema', 'Loads the b2evo database scheme. ', [['blogs/install','_functions_install.php',887]], 3],
'set_max_execution_time': ['set_max_execution_time', 'Set max execution time ', [['blogs/inc/_core','_misc.funcs.php',5658]], 20],
'include_headlines': ['include_headlines', 'Outputs the collected HTML HEAD lines. ', [['blogs/inc/_core','_template.funcs.php',1567]], 14],
'header_redirect': ['header_redirect', 'Sends HTTP header to redirect to the previous location (which can be given as function parameter, GET parameter (redirect_to), is taken from {@link Hit::$referer} or {@link $baseurl}). ', [['blogs/inc/_core','_template.funcs.php',110]], 373],
'evo_htmlspecialchars': ['evo_htmlspecialchars', 'Wrapper function for htmlspecialchars to use the $evo_charset as default charset ', [['blogs/inc/_core','_misc.funcs.php',759]], 138],
'locale': ['locale', 'Template function: display locale for item ', [['blogs/inc/items/model','_itemlight.class.php',818]], 9],
'remove_after_upgrade': ['remove_after_upgrade', 'Remove files/folders after upgrade, See file upgrade_policy.conf ', [['blogs/inc/maintenance/model','_maintenance.funcs.php',669]], 1],
'block_open': ['block_open', 'Open a block ', [['blogs/install','_functions_install.php',13]], 8],
'select': ['select', 'Set SELECT clause ', [['blogs/inc/_core/model/db','_sql.class.php',194],['blogs/inc/_core/model/db','_db.class.php',466],['blogs/inc/_core/ui/forms','_form.class.php',1820]], 461],
'locale_activate': ['locale_activate', 'Activate a locale. ', [['blogs/inc/locales','_locale.funcs.php',314]], 17],
'get_requri': ['get_requri', 'Get $ReqPath, $ReqURI ', [['blogs/inc/_core','_misc.funcs.php',5496]], 2],
'install_newdb': ['install_newdb', 'Install new DB. ', [['blogs/install','_functions_install.php',122]], 1],
'get_default_locale_from_db': ['get_default_locale_from_db', 'Get default locale from db ', [['blogs/install','_functions_install.php',270]], 1],
't_': ['t_', 'TRANSLATE! ', [['blogs/inc/locales','_locale.funcs.php',48],['blogs/inc/locales','_locale.funcs.php',240],['blogs/inc/skins/model','_skin.class.php',672],['blogs/inc/_core/model','_module.class.php',79],['blogs/rsc/js','blog_widgets.js',422],['blogs/inc/plugins','_plugin.class.php',2617]], 10201],
'get_col': ['get_col', 'Function to get 1 column from the cached result set based on X index see docs for usage and info ', [['blogs/inc/_core/model/db','_db.class.php',1041]], 88],
'require_css': ['require_css', 'Memorize that a specific css that file will be required by the current page. All requested files will be included in the page head only once (when headlines is called) ', [['blogs/inc/_core','_template.funcs.php',947]], 236],
'from': ['from', '', [['blogs/inc/_core/model/db','_sql.class.php',219]], 380],
'cache_delete': ['cache_delete', 'Delete all cache files ', [['blogs/inc/_core/model','_pagecache.class.php',211]], 5],
'php_to_mysql_charmap': ['php_to_mysql_charmap', 'Convert a PHP charset to its MySQL equivalent. ', [['blogs/inc/_core/model/db','_db.class.php',1647]], 3],
'locale_from_httpaccept': ['locale_from_httpaccept', 'Detect language from HTTP_ACCEPT_LANGUAGE ', [['blogs/inc/locales','_locale.funcs.php',596]], 2],
'get_manual_url': ['get_manual_url', 'Get the manual url for the given topic ', [['blogs/inc/_core','_misc.funcs.php',4671]], 21],
'install': ['install', 'Install current skin to DB ', [['blogs/inc/skins/model','_skin.class.php',95]], 3],
'match': ['match', '', [['blogs/plugins/tinymce_plugin/tiny_mce','tiny_mce_src.js',15692]], 153],
'get_db_version': ['get_db_version', '', [['blogs/install','_functions_install.php',244]], 4],
'display_base_config_recap': ['display_base_config_recap', 'Base config recap ', [['blogs/install','_functions_install.php',82]], 2],
'switch_maintenance_mode': ['switch_maintenance_mode', 'Enable/disable maintenance mode ', [['blogs/inc/maintenance/model','_maintenance.funcs.php',95]], 6],
'install_validate_requirements': ['install_validate_requirements', 'Validate install requirements. ', [['blogs/install','_functions_install.php',358]], 1],
'db_delete': ['db_delete', 'db_delete(-) ', [['blogs/install','_functions_delete.php',13]], 1],
'param': ['param', 'Sets a parameter with values from the request or to provided default, except if param is already set! ', [['blogs/inc/_core','_param.funcs.php',50]], 1906],
'init_charsets': ['init_charsets', 'Init charset handling between Input/Output ($io_charset) and the internal handling ($evo_charset). ', [['blogs/inc/locales','_locale.funcs.php',1081]], 12],
'list': ['list', '', [['blogs/rsc/js/bootstrap','typeahead.bundle.js',156]], 95],
'define': ['define', '', [], 203],
'time': ['time', '', [], 57],
'file': ['file', '', [], 70],
'implode': ['implode', '', [], 456],
'preg_match': ['preg_match', '', [], 363],
'nl2br': ['nl2br', '', [], 17],
'ini_set': ['ini_set', '', [], 29],
'dirname': ['dirname', '', [], 186],
'header': ['header', '', [], 85],
'is_null': ['is_null', '', [], 251],
'php_sapi_name': ['php_sapi_name', '', [], 1],
'floor': ['floor', '', [], 79],
'preg_replace': ['preg_replace', '', [], 281],
'version_compare': ['version_compare', '', [], 83],
'str_replace': ['str_replace', '', [], 403],
'ini_get': ['ini_get', '', [], 38]};
CLASS_DATA={
'log': ['log', 'Log class. Logs notes and errors. ', [['blogs/inc/_core/model','_log.class.php',41]], 9],
'timer': ['timer', 'This is a simple class to allow timing/profiling of code portions. ', [['blogs/inc/_core/model','_timer.class.php',41]], 7],
'sql': ['sql', 'SQL class: help constructing queries ', [['blogs/inc/_core/model/db','_sql.class.php',32]], 273],
'db': ['db', 'The Main Class ', [['blogs/inc/_core/model/db','_db.class.php',74]], 8],
'pagecache': ['pagecache', 'Page Cache. ', [['blogs/inc/_core/model','_pagecache.class.php',31]], 15],
'messages': ['messages', 'Messages class. For displaying notes, successful actions & errors. ', [['blogs/inc/_core/model','_messages.class.php',41]], 4]};
CONST_DATA={
'EVO_IS_INSTALLING': ['EVO_IS_INSTALLING', '', [['blogs/install','index.php',30]], 5],
'EVO_MAIN_INIT': ['EVO_MAIN_INIT', '', [['blogs/inc','_main.inc.php',55],['blogs/install','index.php',25],['blogs/install','debug.php',22]], 827]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Sat Jul  5 12:18:44 2014</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>

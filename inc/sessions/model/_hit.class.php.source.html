<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /inc/sessions/model/_hit.class.php source</title>
    <link rel="stylesheet" href="../../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Sat Nov 21 22:13:19 2015 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../../';
subdir='inc/sessions/model';
filename='_hit.class.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/inc/sessions/model/</a> -> <a href="_hit.class.php.html">_hit.class.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="_hit.class.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="_hit.class.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">/**</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment"> * This file implements the Hit class.</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment"> *</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment"> * This file is part of the evoCore framework - {@link http://evocore.net/}</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment"> * See also {@link https://github.com/b2evolution/b2evolution}.</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment"> *</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment"> * @license GNU GPL v2 - {@link http://b2evolution.net/about/gnu-gpl-license}</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment"> *</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment"> * @copyright (c)2003-2015 by Francois Planque - {@link http://fplanque.com/}</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment"> * Parts of this file are copyright (c)2004-2006 by Daniel HAHLER - {@link http://thequod.de/contact}.</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment"> *</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment"> * @todo dh&gt; Lazily handle properties through getters (and do not detect/do much in the constructor)!</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment"> *</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment"> * @package evocore</span>
<a name="l16"><span class="linenum">  16</span></a>  <span class="comment"> *</span>
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment"> */</span>
<a name="l18"><span class="linenum">  18</span></a>  if( !<a class="phpfunction" onClick="logFunction('defined')" href="../../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('EVO_MAIN_INIT')" href="../../../_constants/EVO_MAIN_INIT.html" onMouseOver="constPopup(event,'EVO_MAIN_INIT')">EVO_MAIN_INIT</a>') ) die( 'Please, do not access this page directly.' );
<a name="l19"><span class="linenum">  19</span></a>  
<a name="l20"><span class="linenum">  20</span></a>  
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment">/**</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> * A hit to a blog.</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> *</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> * @package evocore</span>
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment"> */</span>
<a name="l26"><span class="linenum">  26</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('Hit')" href="../../../_classes/hit.html" onMouseOver="classPopup(event,'hit')">Hit</a>
<a name="l27"><span class="linenum">  27</span></a>  {
<a name="l28"><span class="linenum">  28</span></a>      <span class="comment">/**</span>
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment">     * ID in DB, gets set when {@link log()} was called and the hit was logged.</span>
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment">     */</span>
<a name="l31"><span class="linenum">  31</span></a>      var <a class="var it139" onMouseOver="hilite(139)" onMouseOut="lolite()" onClick="logVariable('ID')" href="../../../_variables/ID.html">$ID</a>;
<a name="l32"><span class="linenum">  32</span></a>  
<a name="l33"><span class="linenum">  33</span></a>      <span class="comment">/**</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment">     * Is the hit already logged?</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment">     * @var boolean</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment">     */</span>
<a name="l37"><span class="linenum">  37</span></a>      var <a class="var it4626" onMouseOver="hilite(4626)" onMouseOut="lolite()" onClick="logVariable('logged')" href="../../../_variables/logged.html">$logged</a> = false;
<a name="l38"><span class="linenum">  38</span></a>  
<a name="l39"><span class="linenum">  39</span></a>      <span class="comment">/**</span>
<a name="l40"><span class="linenum">  40</span></a>  <span class="comment">     * The referer/referrer.</span>
<a name="l41"><span class="linenum">  41</span></a>  <span class="comment">     *</span>
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment">     * @var string</span>
<a name="l43"><span class="linenum">  43</span></a>  <span class="comment">     */</span>
<a name="l44"><span class="linenum">  44</span></a>      var <a class="var it4627" onMouseOver="hilite(4627)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../../_variables/referer.html">$referer</a>;
<a name="l45"><span class="linenum">  45</span></a>  
<a name="l46"><span class="linenum">  46</span></a>  
<a name="l47"><span class="linenum">  47</span></a>      <span class="comment">/**</span>
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment">     * The type of hit.</span>
<a name="l49"><span class="linenum">  49</span></a>  <span class="comment">     *</span>
<a name="l50"><span class="linenum">  50</span></a>  <span class="comment">     * 'standard'|'rss'|'admin'|'ajax'|'service'</span>
<a name="l51"><span class="linenum">  51</span></a>  <span class="comment">     *</span>
<a name="l52"><span class="linenum">  52</span></a>  <span class="comment">     * @var string</span>
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment">     */</span>
<a name="l54"><span class="linenum">  54</span></a>      var <a class="var it4628" onMouseOver="hilite(4628)" onMouseOut="lolite()" onClick="logVariable('hit_type')" href="../../../_variables/hit_type.html">$hit_type</a>;
<a name="l55"><span class="linenum">  55</span></a>  
<a name="l56"><span class="linenum">  56</span></a>      <span class="comment">/**</span>
<a name="l57"><span class="linenum">  57</span></a>  <span class="comment">     * The type of referer.</span>
<a name="l58"><span class="linenum">  58</span></a>  <span class="comment">     *</span>
<a name="l59"><span class="linenum">  59</span></a>  <span class="comment">     * Note: &quot;spam&quot; referers do not get logged.</span>
<a name="l60"><span class="linenum">  60</span></a>  <span class="comment">     * 'search'|'special'|'referer'|'direct'|'spam'|'self'</span>
<a name="l61"><span class="linenum">  61</span></a>  <span class="comment">     *</span>
<a name="l62"><span class="linenum">  62</span></a>  <span class="comment">     * @var string</span>
<a name="l63"><span class="linenum">  63</span></a>  <span class="comment">     */</span>
<a name="l64"><span class="linenum">  64</span></a>      var <a class="var it4629" onMouseOver="hilite(4629)" onMouseOut="lolite()" onClick="logVariable('referer_type')" href="../../../_variables/referer_type.html">$referer_type</a>;
<a name="l65"><span class="linenum">  65</span></a>  
<a name="l66"><span class="linenum">  66</span></a>  
<a name="l67"><span class="linenum">  67</span></a>      <span class="comment">/**</span>
<a name="l68"><span class="linenum">  68</span></a>  <span class="comment">     * The dom_type of the referer's base domain in T_basedomains</span>
<a name="l69"><span class="linenum">  69</span></a>  <span class="comment">     * 'unknown'|'normal'|'searcheng'|'aggregator'|'email'</span>
<a name="l70"><span class="linenum">  70</span></a>  <span class="comment">     * @var string</span>
<a name="l71"><span class="linenum">  71</span></a>  <span class="comment">     */</span>
<a name="l72"><span class="linenum">  72</span></a>      var <a class="var it3537" onMouseOver="hilite(3537)" onMouseOut="lolite()" onClick="logVariable('dom_type')" href="../../../_variables/dom_type.html">$dom_type</a> = 'unknown';
<a name="l73"><span class="linenum">  73</span></a>      <span class="comment">/**</span>
<a name="l74"><span class="linenum">  74</span></a>  <span class="comment">     * The ID of the referer's base domain in T_basedomains</span>
<a name="l75"><span class="linenum">  75</span></a>  <span class="comment">     *</span>
<a name="l76"><span class="linenum">  76</span></a>  <span class="comment">     * @var integer</span>
<a name="l77"><span class="linenum">  77</span></a>  <span class="comment">     */</span>
<a name="l78"><span class="linenum">  78</span></a>      var <a class="var it4630" onMouseOver="hilite(4630)" onMouseOut="lolite()" onClick="logVariable('referer_domain_ID')" href="../../../_variables/referer_domain_ID.html">$referer_domain_ID</a>;
<a name="l79"><span class="linenum">  79</span></a>  
<a name="l80"><span class="linenum">  80</span></a>      <span class="comment">/**</span>
<a name="l81"><span class="linenum">  81</span></a>  <span class="comment">     * Is this a reload?</span>
<a name="l82"><span class="linenum">  82</span></a>  <span class="comment">     * This gets lazy-filled by {@link is_new_view()}.</span>
<a name="l83"><span class="linenum">  83</span></a>  <span class="comment">     * @var boolean</span>
<a name="l84"><span class="linenum">  84</span></a>  <span class="comment">     * @access protected</span>
<a name="l85"><span class="linenum">  85</span></a>  <span class="comment">     */</span>
<a name="l86"><span class="linenum">  86</span></a>      var <a class="var it4631" onMouseOver="hilite(4631)" onMouseOut="lolite()" onClick="logVariable('_is_new_view')" href="../../../_variables/_is_new_view.html">$_is_new_view</a>;
<a name="l87"><span class="linenum">  87</span></a>  
<a name="l88"><span class="linenum">  88</span></a>      <span class="comment">/**</span>
<a name="l89"><span class="linenum">  89</span></a>  <span class="comment">     * Ignore this hit?</span>
<a name="l90"><span class="linenum">  90</span></a>  <span class="comment">     * @var boolean</span>
<a name="l91"><span class="linenum">  91</span></a>  <span class="comment">     */</span>
<a name="l92"><span class="linenum">  92</span></a>      var <a class="var it1007" onMouseOver="hilite(1007)" onMouseOut="lolite()" onClick="logVariable('ignore')" href="../../../_variables/ignore.html">$ignore</a> = false;
<a name="l93"><span class="linenum">  93</span></a>  
<a name="l94"><span class="linenum">  94</span></a>      <span class="comment">/**</span>
<a name="l95"><span class="linenum">  95</span></a>  <span class="comment">     * Remote address (IP).</span>
<a name="l96"><span class="linenum">  96</span></a>  <span class="comment">     * @var string</span>
<a name="l97"><span class="linenum">  97</span></a>  <span class="comment">     */</span>
<a name="l98"><span class="linenum">  98</span></a>      var <a class="var it522" onMouseOver="hilite(522)" onMouseOut="lolite()" onClick="logVariable('IP')" href="../../../_variables/IP.html">$IP</a>;
<a name="l99"><span class="linenum">  99</span></a>  
<a name="l100"><span class="linenum"> 100</span></a>      <span class="comment">/**</span>
<a name="l101"><span class="linenum"> 101</span></a>  <span class="comment">     * The user agent.</span>
<a name="l102"><span class="linenum"> 102</span></a>  <span class="comment">     * @see Hit::get_user_agent()</span>
<a name="l103"><span class="linenum"> 103</span></a>  <span class="comment">     * @access protected</span>
<a name="l104"><span class="linenum"> 104</span></a>  <span class="comment">     * @var string</span>
<a name="l105"><span class="linenum"> 105</span></a>  <span class="comment">     */</span>
<a name="l106"><span class="linenum"> 106</span></a>      var <a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('user_agent')" href="../../../_variables/user_agent.html">$user_agent</a>;
<a name="l107"><span class="linenum"> 107</span></a>  
<a name="l108"><span class="linenum"> 108</span></a>      <span class="comment">/**</span>
<a name="l109"><span class="linenum"> 109</span></a>  <span class="comment">     * The user agent ID, eg 1000</span>
<a name="l110"><span class="linenum"> 110</span></a>  <span class="comment">     * @see Hit::get_agent_ID()</span>
<a name="l111"><span class="linenum"> 111</span></a>  <span class="comment">     * @access protected</span>
<a name="l112"><span class="linenum"> 112</span></a>  <span class="comment">     * @var integer</span>
<a name="l113"><span class="linenum"> 113</span></a>  <span class="comment">     */</span>
<a name="l114"><span class="linenum"> 114</span></a>      var <a class="var it4632" onMouseOver="hilite(4632)" onMouseOut="lolite()" onClick="logVariable('agent_ID')" href="../../../_variables/agent_ID.html">$agent_ID</a>;
<a name="l115"><span class="linenum"> 115</span></a>  
<a name="l116"><span class="linenum"> 116</span></a>      <span class="comment">/**</span>
<a name="l117"><span class="linenum"> 117</span></a>  <span class="comment">     * The user agent name, eg &quot;safari&quot;</span>
<a name="l118"><span class="linenum"> 118</span></a>  <span class="comment">     * @see Hit::get_agent_name()</span>
<a name="l119"><span class="linenum"> 119</span></a>  <span class="comment">     * @access protected</span>
<a name="l120"><span class="linenum"> 120</span></a>  <span class="comment">     * @var string</span>
<a name="l121"><span class="linenum"> 121</span></a>  <span class="comment">     */</span>
<a name="l122"><span class="linenum"> 122</span></a>      var <a class="var it4633" onMouseOver="hilite(4633)" onMouseOut="lolite()" onClick="logVariable('agent_name')" href="../../../_variables/agent_name.html">$agent_name</a>;
<a name="l123"><span class="linenum"> 123</span></a>  
<a name="l124"><span class="linenum"> 124</span></a>      <span class="comment">/**</span>
<a name="l125"><span class="linenum"> 125</span></a>  <span class="comment">     * The user agent platform. Either &quot;win&quot;, &quot;mac&quot; or &quot;linux&quot;.</span>
<a name="l126"><span class="linenum"> 126</span></a>  <span class="comment">     * @see Hit::get_agent_platform()</span>
<a name="l127"><span class="linenum"> 127</span></a>  <span class="comment">     * @access protected</span>
<a name="l128"><span class="linenum"> 128</span></a>  <span class="comment">     * @var string</span>
<a name="l129"><span class="linenum"> 129</span></a>  <span class="comment">     */</span>
<a name="l130"><span class="linenum"> 130</span></a>      var <a class="var it4634" onMouseOver="hilite(4634)" onMouseOut="lolite()" onClick="logVariable('agent_platform')" href="../../../_variables/agent_platform.html">$agent_platform</a>;
<a name="l131"><span class="linenum"> 131</span></a>  
<a name="l132"><span class="linenum"> 132</span></a>  
<a name="l133"><span class="linenum"> 133</span></a>      <span class="comment">/**</span>
<a name="l134"><span class="linenum"> 134</span></a>  <span class="comment">     * The user's remote host.</span>
<a name="l135"><span class="linenum"> 135</span></a>  <span class="comment">     * Use {@link get_remote_host()} to access it (lazy filled).</span>
<a name="l136"><span class="linenum"> 136</span></a>  <span class="comment">     * @var string</span>
<a name="l137"><span class="linenum"> 137</span></a>  <span class="comment">     * @access protected</span>
<a name="l138"><span class="linenum"> 138</span></a>  <span class="comment">     */</span>
<a name="l139"><span class="linenum"> 139</span></a>      var <a class="var it4635" onMouseOver="hilite(4635)" onMouseOut="lolite()" onClick="logVariable('_remoteHost')" href="../../../_variables/_remoteHost.html">$_remoteHost</a>;
<a name="l140"><span class="linenum"> 140</span></a>  
<a name="l141"><span class="linenum"> 141</span></a>      <span class="comment">/**</span>
<a name="l142"><span class="linenum"> 142</span></a>  <span class="comment">     * The user agent type.</span>
<a name="l143"><span class="linenum"> 143</span></a>  <span class="comment">     *</span>
<a name="l144"><span class="linenum"> 144</span></a>  <span class="comment">     * 'rss'|'robot'|'browser'|'unknown'</span>
<a name="l145"><span class="linenum"> 145</span></a>  <span class="comment">     *</span>
<a name="l146"><span class="linenum"> 146</span></a>  <span class="comment">     * @see Hit::get_agent_type()</span>
<a name="l147"><span class="linenum"> 147</span></a>  <span class="comment">     * @access protected</span>
<a name="l148"><span class="linenum"> 148</span></a>  <span class="comment">     * @var string</span>
<a name="l149"><span class="linenum"> 149</span></a>  <span class="comment">     */</span>
<a name="l150"><span class="linenum"> 150</span></a>      var <a class="var it4636" onMouseOver="hilite(4636)" onMouseOut="lolite()" onClick="logVariable('agent_type')" href="../../../_variables/agent_type.html">$agent_type</a>;
<a name="l151"><span class="linenum"> 151</span></a>  
<a name="l152"><span class="linenum"> 152</span></a>      <span class="comment">/**</span>
<a name="l153"><span class="linenum"> 153</span></a>  <span class="comment">     * Array of 2 letter ISO country codes</span>
<a name="l154"><span class="linenum"> 154</span></a>  <span class="comment">     * This gets lazy-filled by {@link get_country_codes()}.</span>
<a name="l155"><span class="linenum"> 155</span></a>  <span class="comment">     * @var array</span>
<a name="l156"><span class="linenum"> 156</span></a>  <span class="comment">     * @access protected</span>
<a name="l157"><span class="linenum"> 157</span></a>  <span class="comment">     */</span>
<a name="l158"><span class="linenum"> 158</span></a>      var <a class="var it4637" onMouseOver="hilite(4637)" onMouseOut="lolite()" onClick="logVariable('country_codes')" href="../../../_variables/country_codes.html">$country_codes</a>;
<a name="l159"><span class="linenum"> 159</span></a>  
<a name="l160"><span class="linenum"> 160</span></a>      <span class="comment">/**</span>
<a name="l161"><span class="linenum"> 161</span></a>  <span class="comment">     * Array of known search engines in format( searchEngineName =&gt; URL )</span>
<a name="l162"><span class="linenum"> 162</span></a>  <span class="comment">     * This gets lazy-filled by {@link get_search_engine_names()}.</span>
<a name="l163"><span class="linenum"> 163</span></a>  <span class="comment">     * @var array</span>
<a name="l164"><span class="linenum"> 164</span></a>  <span class="comment">     * @access protected</span>
<a name="l165"><span class="linenum"> 165</span></a>  <span class="comment">     */</span>
<a name="l166"><span class="linenum"> 166</span></a>      var <a class="var it4638" onMouseOver="hilite(4638)" onMouseOut="lolite()" onClick="logVariable('search_engine_names')" href="../../../_variables/search_engine_names.html">$search_engine_names</a>;
<a name="l167"><span class="linenum"> 167</span></a>  
<a name="l168"><span class="linenum"> 168</span></a>      <span class="comment">/**</span>
<a name="l169"><span class="linenum"> 169</span></a>  <span class="comment">     * Extracted from search referers:</span>
<a name="l170"><span class="linenum"> 170</span></a>  <span class="comment">     */</span>
<a name="l171"><span class="linenum"> 171</span></a>      var <a class="var it4639" onMouseOver="hilite(4639)" onMouseOut="lolite()" onClick="logVariable('_search_params_tried')" href="../../../_variables/_search_params_tried.html">$_search_params_tried</a> = false;
<a name="l172"><span class="linenum"> 172</span></a>      var <a class="var it4640" onMouseOver="hilite(4640)" onMouseOut="lolite()" onClick="logVariable('_keyphrase')" href="../../../_variables/_keyphrase.html">$_keyphrase</a> = NULL;
<a name="l173"><span class="linenum"> 173</span></a>      var <a class="var it4641" onMouseOver="hilite(4641)" onMouseOut="lolite()" onClick="logVariable('_serprank')" href="../../../_variables/_serprank.html">$_serprank</a> = NULL;
<a name="l174"><span class="linenum"> 174</span></a>      var <a class="var it4642" onMouseOver="hilite(4642)" onMouseOut="lolite()" onClick="logVariable('_search_engine')" href="../../../_variables/_search_engine.html">$_search_engine</a> = NULL;
<a name="l175"><span class="linenum"> 175</span></a>  
<a name="l176"><span class="linenum"> 176</span></a>      <span class="comment">/**</span>
<a name="l177"><span class="linenum"> 177</span></a>  <span class="comment">     * Session ID</span>
<a name="l178"><span class="linenum"> 178</span></a>  <span class="comment">     */</span>
<a name="l179"><span class="linenum"> 179</span></a>      var <a class="var it4643" onMouseOver="hilite(4643)" onMouseOut="lolite()" onClick="logVariable('session_id')" href="../../../_variables/session_id.html">$session_id</a>;
<a name="l180"><span class="linenum"> 180</span></a>  
<a name="l181"><span class="linenum"> 181</span></a>      <span class="comment">/**</span>
<a name="l182"><span class="linenum"> 182</span></a>  <span class="comment">     * Hit time</span>
<a name="l183"><span class="linenum"> 183</span></a>  <span class="comment">     */</span>
<a name="l184"><span class="linenum"> 184</span></a>      var <a class="var it4644" onMouseOver="hilite(4644)" onMouseOut="lolite()" onClick="logVariable('hit_time')" href="../../../_variables/hit_time.html">$hit_time</a>;
<a name="l185"><span class="linenum"> 185</span></a>  
<a name="l186"><span class="linenum"> 186</span></a>      <span class="comment">/**</span>
<a name="l187"><span class="linenum"> 187</span></a>  <span class="comment">     * Hit_response_code</span>
<a name="l188"><span class="linenum"> 188</span></a>  <span class="comment">     */</span>
<a name="l189"><span class="linenum"> 189</span></a>      var <a class="var it4645" onMouseOver="hilite(4645)" onMouseOut="lolite()" onClick="logVariable('hit_response_code')" href="../../../_variables/hit_response_code.html">$hit_response_code</a> = 200;
<a name="l190"><span class="linenum"> 190</span></a>  
<a name="l191"><span class="linenum"> 191</span></a>      <span class="comment">/**</span>
<a name="l192"><span class="linenum"> 192</span></a>  <span class="comment">     * Hit action</span>
<a name="l193"><span class="linenum"> 193</span></a>  <span class="comment">     */</span>
<a name="l194"><span class="linenum"> 194</span></a>      var <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a>;
<a name="l195"><span class="linenum"> 195</span></a>  
<a name="l196"><span class="linenum"> 196</span></a>      <span class="comment">/**</span>
<a name="l197"><span class="linenum"> 197</span></a>  <span class="comment">     * Test mode</span>
<a name="l198"><span class="linenum"> 198</span></a>  <span class="comment">     * The mode used by geneartion of a fake statisctics. In this case test_mode = 1</span>
<a name="l199"><span class="linenum"> 199</span></a>  <span class="comment">     * fp&gt;vitaliy what is this for?</span>
<a name="l200"><span class="linenum"> 200</span></a>  <span class="comment">     * Test what &amp; when?</span>
<a name="l201"><span class="linenum"> 201</span></a>  <span class="comment">     *</span>
<a name="l202"><span class="linenum"> 202</span></a>  <span class="comment">     */</span>
<a name="l203"><span class="linenum"> 203</span></a>      var <a class="var it4646" onMouseOver="hilite(4646)" onMouseOut="lolite()" onClick="logVariable('test_mode')" href="../../../_variables/test_mode.html">$test_mode</a>;
<a name="l204"><span class="linenum"> 204</span></a>  
<a name="l205"><span class="linenum"> 205</span></a>      <span class="comment">/**</span>
<a name="l206"><span class="linenum"> 206</span></a>  <span class="comment">     * Test rss mode</span>
<a name="l207"><span class="linenum"> 207</span></a>  <span class="comment">     * fp&gt;vitaliy what is this for?</span>
<a name="l208"><span class="linenum"> 208</span></a>  <span class="comment">     * Test_rss is used for geneartion of fake statistics. In the normal mode</span>
<a name="l209"><span class="linenum"> 209</span></a>  <span class="comment">     * Hit class determines rss hit using $Skin-&gt;type == 'feed'. In the test mode</span>
<a name="l210"><span class="linenum"> 210</span></a>  <span class="comment">     * skin type doesn't change and that is why the new variable was needed to emulate</span>
<a name="l211"><span class="linenum"> 211</span></a>  <span class="comment">     * skin type.</span>
<a name="l212"><span class="linenum"> 212</span></a>  <span class="comment">     */</span>
<a name="l213"><span class="linenum"> 213</span></a>      var <a class="var it4647" onMouseOver="hilite(4647)" onMouseOut="lolite()" onClick="logVariable('test_rss')" href="../../../_variables/test_rss.html">$test_rss</a>;
<a name="l214"><span class="linenum"> 214</span></a>  
<a name="l215"><span class="linenum"> 215</span></a>      <span class="comment">/**</span>
<a name="l216"><span class="linenum"> 216</span></a>  <span class="comment">     * Test URI</span>
<a name="l217"><span class="linenum"> 217</span></a>  <span class="comment">     */</span>
<a name="l218"><span class="linenum"> 218</span></a>      var <a class="var it4648" onMouseOver="hilite(4648)" onMouseOut="lolite()" onClick="logVariable('test_uri')" href="../../../_variables/test_uri.html">$test_uri</a>;
<a name="l219"><span class="linenum"> 219</span></a>  
<a name="l220"><span class="linenum"> 220</span></a>      <span class="comment">/**</span>
<a name="l221"><span class="linenum"> 221</span></a>  <span class="comment">     * Browser version</span>
<a name="l222"><span class="linenum"> 222</span></a>  <span class="comment">     * @var integer</span>
<a name="l223"><span class="linenum"> 223</span></a>  <span class="comment">     */</span>
<a name="l224"><span class="linenum"> 224</span></a>      var <a class="var it4649" onMouseOver="hilite(4649)" onMouseOut="lolite()" onClick="logVariable('browser_version')" href="../../../_variables/browser_version.html">$browser_version</a>;
<a name="l225"><span class="linenum"> 225</span></a>  
<a name="l226"><span class="linenum"> 226</span></a>      <span class="comment">/**</span>
<a name="l227"><span class="linenum"> 227</span></a>  <span class="comment">     * Constructor</span>
<a name="l228"><span class="linenum"> 228</span></a>  <span class="comment">     *</span>
<a name="l229"><span class="linenum"> 229</span></a>  <span class="comment">     * This may INSERT a basedomain and a useragent but NOT the HIT itself!</span>
<a name="l230"><span class="linenum"> 230</span></a>  <span class="comment">     */</span>
<a name="l231"><span class="linenum"> 231</span></a>  	function <a class="function" onClick="logFunction('Hit')" href="../../../_functions/hit.html" onMouseOver="funcPopup(event,'hit')">Hit</a>( <a class="var it4627" onMouseOver="hilite(4627)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../../_variables/referer.html">$referer</a> = NULL, <a class="var it522" onMouseOver="hilite(522)" onMouseOut="lolite()" onClick="logVariable('IP')" href="../../../_variables/IP.html">$IP</a> = NULL, <a class="var it4643" onMouseOver="hilite(4643)" onMouseOut="lolite()" onClick="logVariable('session_id')" href="../../../_variables/session_id.html">$session_id</a>= NULL, <a class="var it4644" onMouseOver="hilite(4644)" onMouseOut="lolite()" onClick="logVariable('hit_time')" href="../../../_variables/hit_time.html">$hit_time</a> = NULL, <a class="var it4646" onMouseOver="hilite(4646)" onMouseOut="lolite()" onClick="logVariable('test_mode')" href="../../../_variables/test_mode.html">$test_mode</a> = NULL , <a class="var it4648" onMouseOver="hilite(4648)" onMouseOut="lolite()" onClick="logVariable('test_uri')" href="../../../_variables/test_uri.html">$test_uri</a> = NULL, <a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('user_agent')" href="../../../_variables/user_agent.html">$user_agent</a> = NULL, <a class="var it4650" onMouseOver="hilite(4650)" onMouseOut="lolite()" onClick="logVariable('test_admin')" href="../../../_variables/test_admin.html">$test_admin</a> = NULL, <a class="var it4647" onMouseOver="hilite(4647)" onMouseOut="lolite()" onClick="logVariable('test_rss')" href="../../../_variables/test_rss.html">$test_rss</a> = NULL)
<a name="l232"><span class="linenum"> 232</span></a>      {
<a name="l233"><span class="linenum"> 233</span></a>          global <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('debug')" href="../../../_variables/debug.html">$debug</a>;
<a name="l234"><span class="linenum"> 234</span></a>  
<a name="l235"><span class="linenum"> 235</span></a>          if( isset(<a class="var it522" onMouseOver="hilite(522)" onMouseOut="lolite()" onClick="logVariable('IP')" href="../../../_variables/IP.html">$IP</a>) )
<a name="l236"><span class="linenum"> 236</span></a>          {
<a name="l237"><span class="linenum"> 237</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('IP')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/IP.html">IP</a> = <a class="var it522" onMouseOver="hilite(522)" onMouseOut="lolite()" onClick="logVariable('IP')" href="../../../_variables/IP.html">$IP</a>;
<a name="l238"><span class="linenum"> 238</span></a>          }
<a name="l239"><span class="linenum"> 239</span></a>          else
<a name="l240"><span class="linenum"> 240</span></a>          {    // Get the first IP in the list of REMOTE_ADDR and HTTP_X_FORWARDED_FOR
<a name="l241"><span class="linenum"> 241</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('IP')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/IP.html">IP</a> = <a class="function" onClick="logFunction('get_ip_list')" href="../../../_functions/get_ip_list.html" onMouseOver="funcPopup(event,'get_ip_list')">get_ip_list</a>( true );
<a name="l242"><span class="linenum"> 242</span></a>          }
<a name="l243"><span class="linenum"> 243</span></a>  
<a name="l244"><span class="linenum"> 244</span></a>          if (!empty(<a class="var it4643" onMouseOver="hilite(4643)" onMouseOut="lolite()" onClick="logVariable('session_id')" href="../../../_variables/session_id.html">$session_id</a>))
<a name="l245"><span class="linenum"> 245</span></a>          {
<a name="l246"><span class="linenum"> 246</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('session_id')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/session_id.html">session_id</a> = <a class="var it4643" onMouseOver="hilite(4643)" onMouseOut="lolite()" onClick="logVariable('session_id')" href="../../../_variables/session_id.html">$session_id</a>;
<a name="l247"><span class="linenum"> 247</span></a>          }
<a name="l248"><span class="linenum"> 248</span></a>  
<a name="l249"><span class="linenum"> 249</span></a>          if (!empty(<a class="var it4644" onMouseOver="hilite(4644)" onMouseOut="lolite()" onClick="logVariable('hit_time')" href="../../../_variables/hit_time.html">$hit_time</a>))
<a name="l250"><span class="linenum"> 250</span></a>          {
<a name="l251"><span class="linenum"> 251</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hit_time')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/hit_time.html">hit_time</a> = <a class="var it4644" onMouseOver="hilite(4644)" onMouseOut="lolite()" onClick="logVariable('hit_time')" href="../../../_variables/hit_time.html">$hit_time</a>;
<a name="l252"><span class="linenum"> 252</span></a>          }
<a name="l253"><span class="linenum"> 253</span></a>  
<a name="l254"><span class="linenum"> 254</span></a>          if (!empty(<a class="var it4646" onMouseOver="hilite(4646)" onMouseOut="lolite()" onClick="logVariable('test_mode')" href="../../../_variables/test_mode.html">$test_mode</a>))
<a name="l255"><span class="linenum"> 255</span></a>          {
<a name="l256"><span class="linenum"> 256</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('test_mode')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/test_mode.html">test_mode</a> = <a class="var it4646" onMouseOver="hilite(4646)" onMouseOut="lolite()" onClick="logVariable('test_mode')" href="../../../_variables/test_mode.html">$test_mode</a>;
<a name="l257"><span class="linenum"> 257</span></a>          }
<a name="l258"><span class="linenum"> 258</span></a>  
<a name="l259"><span class="linenum"> 259</span></a>          if (!empty(<a class="var it4648" onMouseOver="hilite(4648)" onMouseOut="lolite()" onClick="logVariable('test_uri')" href="../../../_variables/test_uri.html">$test_uri</a>))
<a name="l260"><span class="linenum"> 260</span></a>          {
<a name="l261"><span class="linenum"> 261</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('test_uri')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/test_uri.html">test_uri</a> = <a class="var it4648" onMouseOver="hilite(4648)" onMouseOut="lolite()" onClick="logVariable('test_uri')" href="../../../_variables/test_uri.html">$test_uri</a>;
<a name="l262"><span class="linenum"> 262</span></a>          }
<a name="l263"><span class="linenum"> 263</span></a>  
<a name="l264"><span class="linenum"> 264</span></a>          if (!empty(<a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('user_agent')" href="../../../_variables/user_agent.html">$user_agent</a>))
<a name="l265"><span class="linenum"> 265</span></a>          {
<a name="l266"><span class="linenum"> 266</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('user_agent')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/user_agent.html">user_agent</a> = <a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('user_agent')" href="../../../_variables/user_agent.html">$user_agent</a>;
<a name="l267"><span class="linenum"> 267</span></a>          }
<a name="l268"><span class="linenum"> 268</span></a>  
<a name="l269"><span class="linenum"> 269</span></a>          if (!empty(<a class="var it4650" onMouseOver="hilite(4650)" onMouseOut="lolite()" onClick="logVariable('test_admin')" href="../../../_variables/test_admin.html">$test_admin</a>))
<a name="l270"><span class="linenum"> 270</span></a>          {
<a name="l271"><span class="linenum"> 271</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('test_admin')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/test_admin.html">test_admin</a> = <a class="var it4650" onMouseOver="hilite(4650)" onMouseOut="lolite()" onClick="logVariable('test_admin')" href="../../../_variables/test_admin.html">$test_admin</a>;
<a name="l272"><span class="linenum"> 272</span></a>          }
<a name="l273"><span class="linenum"> 273</span></a>  
<a name="l274"><span class="linenum"> 274</span></a>          if (!empty(<a class="var it4647" onMouseOver="hilite(4647)" onMouseOut="lolite()" onClick="logVariable('test_rss')" href="../../../_variables/test_rss.html">$test_rss</a>))
<a name="l275"><span class="linenum"> 275</span></a>          {
<a name="l276"><span class="linenum"> 276</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('test_rss')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/test_rss.html">test_rss</a> = <a class="var it4647" onMouseOver="hilite(4647)" onMouseOut="lolite()" onClick="logVariable('test_rss')" href="../../../_variables/test_rss.html">$test_rss</a>;
<a name="l277"><span class="linenum"> 277</span></a>          }
<a name="l278"><span class="linenum"> 278</span></a>  
<a name="l279"><span class="linenum"> 279</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hit_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/hit_type.html">hit_type</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_hit_type')" href="../../../_functions/get_hit_type.html" onMouseOver="funcPopup(event,'get_hit_type')">get_hit_type</a>();
<a name="l280"><span class="linenum"> 280</span></a>  
<a name="l281"><span class="linenum"> 281</span></a>  <span class="comment">        // Check the REFERER and determine referer_type:</span>
<a name="l282"><span class="linenum"> 282</span></a>  <span class="comment">        // TODO: dh&gt; move this out of here, too, only if &quot;antispam_block_spam_referers&quot; is true,</span>
<a name="l283"><span class="linenum"> 283</span></a>  <span class="comment">        //           do something about it (here or somewhere else, but early).</span>
<a name="l284"><span class="linenum"> 284</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('detect_referer')" href="../../../_functions/detect_referer.html" onMouseOver="funcPopup(event,'detect_referer')">detect_referer</a>( <a class="var it4627" onMouseOver="hilite(4627)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../../_variables/referer.html">$referer</a> ); <span class="comment">// May EXIT if we are set up to block referer spam.</span>
<a name="l285"><span class="linenum"> 285</span></a>  
<a name="l286"><span class="linenum"> 286</span></a>          if( <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('debug')" href="../../../_variables/debug.html">$debug</a> )
<a name="l287"><span class="linenum"> 287</span></a>          {
<a name="l288"><span class="linenum"> 288</span></a>              global <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>;
<a name="l289"><span class="linenum"> 289</span></a>              <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit: IP: '.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('IP')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/IP.html">IP</a>, 'request' );
<a name="l290"><span class="linenum"> 290</span></a>              <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit: UserAgent: '.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_user_agent')" href="../../../_functions/get_user_agent.html" onMouseOver="funcPopup(event,'get_user_agent')">get_user_agent</a>(), 'request' );
<a name="l291"><span class="linenum"> 291</span></a>              <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit: Referer: '.<a class="phpfunction" onClick="logFunction('var_export')" href="../../../_functions/var_export.html" onMouseOver="phpfuncPopup(event,'var_export')">var_export</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer.html">referer</a>, true).'; type='.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_type.html">referer_type</a>, 'request' );
<a name="l292"><span class="linenum"> 292</span></a>              <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit: Remote Host: '.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_remote_host')" href="../../../_functions/get_remote_host.html" onMouseOver="funcPopup(event,'get_remote_host')">get_remote_host</a>( false ), 'request' );
<a name="l293"><span class="linenum"> 293</span></a>          }
<a name="l294"><span class="linenum"> 294</span></a>      }
<a name="l295"><span class="linenum"> 295</span></a>  
<a name="l296"><span class="linenum"> 296</span></a>  
<a name="l297"><span class="linenum"> 297</span></a>      <span class="comment">/**</span>
<a name="l298"><span class="linenum"> 298</span></a>  <span class="comment">     * Detect admin page</span>
<a name="l299"><span class="linenum"> 299</span></a>  <span class="comment">     */</span>
<a name="l300"><span class="linenum"> 300</span></a>  	function <a class="function" onClick="logFunction('detect_admin_page')" href="../../../_functions/detect_admin_page.html" onMouseOver="funcPopup(event,'detect_admin_page')">detect_admin_page</a>()
<a name="l301"><span class="linenum"> 301</span></a>      {
<a name="l302"><span class="linenum"> 302</span></a>          global <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>;
<a name="l303"><span class="linenum"> 303</span></a>          if (empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('test_mode')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/test_mode.html">test_mode</a>) || (!empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('test_mode')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/test_mode.html">test_mode</a>) &amp;&amp; !empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('test_admin')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/test_admin.html">test_admin</a>)))
<a name="l304"><span class="linenum"> 304</span></a>          {
<a name="l305"><span class="linenum"> 305</span></a>              if( <a class="function" onClick="logFunction('is_admin_page')" href="../../../_functions/is_admin_page.html" onMouseOver="funcPopup(event,'is_admin_page')">is_admin_page</a>() )
<a name="l306"><span class="linenum"> 306</span></a>              {    // We are inside of admin, this supersedes 'direct' access
<a name="l307"><span class="linenum"> 307</span></a>  <span class="comment">                // NOTE: this is not really a referer type but more a hit type</span>
<a name="l308"><span class="linenum"> 308</span></a>  <span class="comment">                // $Debuglog-&gt;add( 'Hit: Referer is admin page.', 'request' );</span>
<a name="l309"><span class="linenum"> 309</span></a>  <span class="comment">                //$this-&gt;referer_type = 'admin';</span>
<a name="l310"><span class="linenum"> 310</span></a>                  return true;
<a name="l311"><span class="linenum"> 311</span></a>              }
<a name="l312"><span class="linenum"> 312</span></a>          }
<a name="l313"><span class="linenum"> 313</span></a>          return false;
<a name="l314"><span class="linenum"> 314</span></a>      }
<a name="l315"><span class="linenum"> 315</span></a>  
<a name="l316"><span class="linenum"> 316</span></a>  
<a name="l317"><span class="linenum"> 317</span></a>      <span class="comment">/**</span>
<a name="l318"><span class="linenum"> 318</span></a>  <span class="comment">     * Get HTTP referrer/referer.</span>
<a name="l319"><span class="linenum"> 319</span></a>  <span class="comment">     *</span>
<a name="l320"><span class="linenum"> 320</span></a>  <span class="comment">     * Due to potential non-thread safety with getenv() (fallback), we'd better do this early.</span>
<a name="l321"><span class="linenum"> 321</span></a>  <span class="comment">     *</span>
<a name="l322"><span class="linenum"> 322</span></a>  <span class="comment">     * @return string</span>
<a name="l323"><span class="linenum"> 323</span></a>  <span class="comment">     */</span>
<a name="l324"><span class="linenum"> 324</span></a>  	function <a class="function" onClick="logFunction('get_referer')" href="../../../_functions/get_referer.html" onMouseOver="funcPopup(event,'get_referer')">get_referer</a>()
<a name="l325"><span class="linenum"> 325</span></a>      {
<a name="l326"><span class="linenum"> 326</span></a>          global <a class="var it4651" onMouseOver="hilite(4651)" onMouseOut="lolite()" onClick="logVariable('HTTP_REFERER')" href="../../../_variables/HTTP_REFERER.html">$HTTP_REFERER</a>; <span class="comment">// might be set by PHP (give highest priority)</span>
<a name="l327"><span class="linenum"> 327</span></a>  
<a name="l328"><span class="linenum"> 328</span></a>          <a class="var it4627" onMouseOver="hilite(4627)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../../_variables/referer.html">$referer</a> = NULL;
<a name="l329"><span class="linenum"> 329</span></a>          if( isset( <a class="var it4651" onMouseOver="hilite(4651)" onMouseOut="lolite()" onClick="logVariable('HTTP_REFERER')" href="../../../_variables/HTTP_REFERER.html">$HTTP_REFERER</a> ) )
<a name="l330"><span class="linenum"> 330</span></a>          { // Referer provided by PHP:
<a name="l331"><span class="linenum"> 331</span></a>              <a class="var it4627" onMouseOver="hilite(4627)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../../_variables/referer.html">$referer</a> = <a class="var it4651" onMouseOver="hilite(4651)" onMouseOut="lolite()" onClick="logVariable('HTTP_REFERER')" href="../../../_variables/HTTP_REFERER.html">$HTTP_REFERER</a>;
<a name="l332"><span class="linenum"> 332</span></a>          }
<a name="l333"><span class="linenum"> 333</span></a>          else
<a name="l334"><span class="linenum"> 334</span></a>          {
<a name="l335"><span class="linenum"> 335</span></a>              if( isset(<a class="var it142" onMouseOver="hilite(142)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../../_variables/_SERVER.html">$_SERVER</a>['HTTP_REFERER']) )
<a name="l336"><span class="linenum"> 336</span></a>              {
<a name="l337"><span class="linenum"> 337</span></a>                  <a class="var it4627" onMouseOver="hilite(4627)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../../_variables/referer.html">$referer</a> = <a class="var it142" onMouseOver="hilite(142)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../../_variables/_SERVER.html">$_SERVER</a>['HTTP_REFERER'];
<a name="l338"><span class="linenum"> 338</span></a>              }
<a name="l339"><span class="linenum"> 339</span></a>              else
<a name="l340"><span class="linenum"> 340</span></a>              { // Fallback <a class="function" onClick="logFunction('method')" href="../../../_functions/method.html" onMouseOver="funcPopup(event,'method')">method</a> (not thread safe :[[ ) - this function does not work in ISAPI mode.
<a name="l341"><span class="linenum"> 341</span></a>                  <a class="var it4627" onMouseOver="hilite(4627)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../../_variables/referer.html">$referer</a> = <a class="phpfunction" onClick="logFunction('getenv')" href="../../../_functions/getenv.html" onMouseOver="phpfuncPopup(event,'getenv')">getenv</a>('HTTP_REFERER');
<a name="l342"><span class="linenum"> 342</span></a>              }
<a name="l343"><span class="linenum"> 343</span></a>          }
<a name="l344"><span class="linenum"> 344</span></a>          return <a class="var it4627" onMouseOver="hilite(4627)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../../_variables/referer.html">$referer</a>;
<a name="l345"><span class="linenum"> 345</span></a>      }
<a name="l346"><span class="linenum"> 346</span></a>  
<a name="l347"><span class="linenum"> 347</span></a>  
<a name="l348"><span class="linenum"> 348</span></a>      <span class="comment">/**</span>
<a name="l349"><span class="linenum"> 349</span></a>  <span class="comment">     * Get &amp; Analyze referer</span>
<a name="l350"><span class="linenum"> 350</span></a>  <span class="comment">     *</span>
<a name="l351"><span class="linenum"> 351</span></a>  <span class="comment">     * Due to potential non-thread safety with getenv() (fallback), we'd better do this early.</span>
<a name="l352"><span class="linenum"> 352</span></a>  <span class="comment">     *</span>
<a name="l353"><span class="linenum"> 353</span></a>  <span class="comment">     * referer_type: enum('search', 'blacklist', 'referer', 'direct'); 'spam' gets used internally</span>
<a name="l354"><span class="linenum"> 354</span></a>  <span class="comment">     */</span>
<a name="l355"><span class="linenum"> 355</span></a>  	function <a class="function" onClick="logFunction('detect_referer')" href="../../../_functions/detect_referer.html" onMouseOver="funcPopup(event,'detect_referer')">detect_referer</a>( <a class="var it4627" onMouseOver="hilite(4627)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../../_variables/referer.html">$referer</a> = NULL )
<a name="l356"><span class="linenum"> 356</span></a>      {
<a name="l357"><span class="linenum"> 357</span></a>          global <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>, <a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('debug')" href="../../../_variables/debug.html">$debug</a>;
<a name="l358"><span class="linenum"> 358</span></a>          global <a class="var it4652" onMouseOver="hilite(4652)" onMouseOut="lolite()" onClick="logVariable('self_referer_list')" href="../../../_variables/self_referer_list.html">$self_referer_list</a>, <a class="var it4653" onMouseOver="hilite(4653)" onMouseOut="lolite()" onClick="logVariable('SpecialList')" href="../../../_variables/SpecialList.html">$SpecialList</a>;  <span class="comment">// used to detect $referer_type</span>
<a name="l359"><span class="linenum"> 359</span></a>          global <a class="var it1107" onMouseOver="hilite(1107)" onMouseOut="lolite()" onClick="logVariable('skins_path')" href="../../../_variables/skins_path.html">$skins_path</a>, <a class="var it2259" onMouseOver="hilite(2259)" onMouseOut="lolite()" onClick="logVariable('siteskins_path')" href="../../../_variables/siteskins_path.html">$siteskins_path</a>;
<a name="l360"><span class="linenum"> 360</span></a>          global <a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../../_variables/Settings.html">$Settings</a>;
<a name="l361"><span class="linenum"> 361</span></a>  
<a name="l362"><span class="linenum"> 362</span></a>          if( isset(<a class="var it4627" onMouseOver="hilite(4627)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../../_variables/referer.html">$referer</a>) )
<a name="l363"><span class="linenum"> 363</span></a>          {
<a name="l364"><span class="linenum"> 364</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer.html">referer</a> = <a class="var it4627" onMouseOver="hilite(4627)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../../_variables/referer.html">$referer</a>;
<a name="l365"><span class="linenum"> 365</span></a>          }
<a name="l366"><span class="linenum"> 366</span></a>          else
<a name="l367"><span class="linenum"> 367</span></a>          {    // Get referer from HTTP request
<a name="l368"><span class="linenum"> 368</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer.html">referer</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_referer')" href="../../../_functions/get_referer.html" onMouseOver="funcPopup(event,'get_referer')">get_referer</a>();
<a name="l369"><span class="linenum"> 369</span></a>          }
<a name="l370"><span class="linenum"> 370</span></a>  
<a name="l371"><span class="linenum"> 371</span></a>  
<a name="l372"><span class="linenum"> 372</span></a>          if( empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer.html">referer</a>) )
<a name="l373"><span class="linenum"> 373</span></a>          {    // NO referer
<a name="l374"><span class="linenum"> 374</span></a>  <span class="comment">            // This type may be superseeded and set to 'admin'</span>
<a name="l375"><span class="linenum"> 375</span></a>              if( ! <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('detect_admin_page')" href="../../../_functions/detect_admin_page.html" onMouseOver="funcPopup(event,'detect_admin_page')">detect_admin_page</a>() )
<a name="l376"><span class="linenum"> 376</span></a>              {    // Not an admin page:
<a name="l377"><span class="linenum"> 377</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_type.html">referer_type</a> = 'direct';
<a name="l378"><span class="linenum"> 378</span></a>              }
<a name="l379"><span class="linenum"> 379</span></a>              else
<a name="l380"><span class="linenum"> 380</span></a>              {
<a name="l381"><span class="linenum"> 381</span></a>                  if (empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hit_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/hit_type.html">hit_type</a>))
<a name="l382"><span class="linenum"> 382</span></a>                  {
<a name="l383"><span class="linenum"> 383</span></a>                      <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hit_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/hit_type.html">hit_type</a> = 'admin';
<a name="l384"><span class="linenum"> 384</span></a>                  }
<a name="l385"><span class="linenum"> 385</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_type.html">referer_type</a> = 'direct';
<a name="l386"><span class="linenum"> 386</span></a>              }
<a name="l387"><span class="linenum"> 387</span></a>              return;
<a name="l388"><span class="linenum"> 388</span></a>          }
<a name="l389"><span class="linenum"> 389</span></a>  
<a name="l390"><span class="linenum"> 390</span></a>  
<a name="l391"><span class="linenum"> 391</span></a>  <span class="comment">        // ANALYZE referer...</span>
<a name="l392"><span class="linenum"> 392</span></a>  
<a name="l393"><span class="linenum"> 393</span></a>  
<a name="l394"><span class="linenum"> 394</span></a>  <span class="comment">        // Check self referer list, see {@link $self_referer_list}</span>
<a name="l395"><span class="linenum"> 395</span></a>  <span class="comment">        // fplanque: we log these (again), because if we didn't we woudln't detect</span>
<a name="l396"><span class="linenum"> 396</span></a>  <span class="comment">        // reloads on these... and that would be a problem!</span>
<a name="l397"><span class="linenum"> 397</span></a>          foreach( <a class="var it4652" onMouseOver="hilite(4652)" onMouseOut="lolite()" onClick="logVariable('self_referer_list')" href="../../../_variables/self_referer_list.html">$self_referer_list</a> as <a class="var it4654" onMouseOver="hilite(4654)" onMouseOut="lolite()" onClick="logVariable('self_referer')" href="../../../_variables/self_referer.html">$self_referer</a> )
<a name="l398"><span class="linenum"> 398</span></a>          {
<a name="l399"><span class="linenum"> 399</span></a>              <a class="var it2669" onMouseOver="hilite(2669)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../../../_variables/pos.html">$pos</a> = <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer.html">referer</a>, <a class="var it4654" onMouseOver="hilite(4654)" onMouseOut="lolite()" onClick="logVariable('self_referer')" href="../../../_variables/self_referer.html">$self_referer</a> );
<a name="l400"><span class="linenum"> 400</span></a>  <span class="comment">            // If not starting within in the first 12 chars it's probably an url param as in &amp;url=http://this_blog.com</span>
<a name="l401"><span class="linenum"> 401</span></a>              if( <a class="var it2669" onMouseOver="hilite(2669)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../../../_variables/pos.html">$pos</a> !== false &amp;&amp; <a class="var it2669" onMouseOver="hilite(2669)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../../../_variables/pos.html">$pos</a> &lt;= 12
<a name="l402"><span class="linenum"> 402</span></a>                  &amp;&amp; ! (<a class="var it463" onMouseOver="hilite(463)" onMouseOut="lolite()" onClick="logVariable('debug')" href="../../../_variables/debug.html">$debug</a> &amp;&amp; <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer.html">referer</a>, '/search.html' ) ) ) // search simulation
<a name="l403"><span class="linenum"> 403</span></a>              {
<a name="l404"><span class="linenum"> 404</span></a>  <span class="comment">                // This type may be superseeded by admin page</span>
<a name="l405"><span class="linenum"> 405</span></a>                  if( ! <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('detect_admin_page')" href="../../../_functions/detect_admin_page.html" onMouseOver="funcPopup(event,'detect_admin_page')">detect_admin_page</a>() )
<a name="l406"><span class="linenum"> 406</span></a>                  {    // Not an admin page:
<a name="l407"><span class="linenum"> 407</span></a>                      <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit: <a class="function" onClick="logFunction('detect_referer')" href="../../../_functions/detect_referer.html" onMouseOver="funcPopup(event,'detect_referer')">detect_referer</a>(): self referer ('.<a class="var it4654" onMouseOver="hilite(4654)" onMouseOut="lolite()" onClick="logVariable('self_referer')" href="../../../_variables/self_referer.html">$self_referer</a>.')', 'request' );
<a name="l408"><span class="linenum"> 408</span></a>                      <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_type.html">referer_type</a> = 'self';
<a name="l409"><span class="linenum"> 409</span></a>                  }
<a name="l410"><span class="linenum"> 410</span></a>                  else
<a name="l411"><span class="linenum"> 411</span></a>                  {
<a name="l412"><span class="linenum"> 412</span></a>                      if (empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hit_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/hit_type.html">hit_type</a>))
<a name="l413"><span class="linenum"> 413</span></a>                      {
<a name="l414"><span class="linenum"> 414</span></a>                          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hit_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/hit_type.html">hit_type</a> = 'admin';
<a name="l415"><span class="linenum"> 415</span></a>                      }
<a name="l416"><span class="linenum"> 416</span></a>                      <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_type.html">referer_type</a> = 'self';
<a name="l417"><span class="linenum"> 417</span></a>                  }
<a name="l418"><span class="linenum"> 418</span></a>                  return;
<a name="l419"><span class="linenum"> 419</span></a>              }
<a name="l420"><span class="linenum"> 420</span></a>          }
<a name="l421"><span class="linenum"> 421</span></a>  
<a name="l422"><span class="linenum"> 422</span></a>  
<a name="l423"><span class="linenum"> 423</span></a>  <span class="comment">        // Check Special list, see {@link $SpecialList}</span>
<a name="l424"><span class="linenum"> 424</span></a>  <span class="comment">        // NOTE: This is NOT the antispam!!</span>
<a name="l425"><span class="linenum"> 425</span></a>  <span class="comment">        // fplanque: we log these (again), because if we didn't we woudln't detect</span>
<a name="l426"><span class="linenum"> 426</span></a>  <span class="comment">        // reloads on these... and that would be a problem!</span>
<a name="l427"><span class="linenum"> 427</span></a>          foreach( <a class="var it4653" onMouseOver="hilite(4653)" onMouseOut="lolite()" onClick="logVariable('SpecialList')" href="../../../_variables/SpecialList.html">$SpecialList</a> as <a class="var it4655" onMouseOver="hilite(4655)" onMouseOut="lolite()" onClick="logVariable('lSpeciallist')" href="../../../_variables/lSpeciallist.html">$lSpeciallist</a> )
<a name="l428"><span class="linenum"> 428</span></a>          {
<a name="l429"><span class="linenum"> 429</span></a>              <a class="var it2669" onMouseOver="hilite(2669)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../../../_variables/pos.html">$pos</a> = <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer.html">referer</a>, <a class="var it4655" onMouseOver="hilite(4655)" onMouseOut="lolite()" onClick="logVariable('lSpeciallist')" href="../../../_variables/lSpeciallist.html">$lSpeciallist</a> );
<a name="l430"><span class="linenum"> 430</span></a>  <span class="comment">            // If not starting within in the first 12 chars it's probably an url param as in &amp;url=http://this_blog.com</span>
<a name="l431"><span class="linenum"> 431</span></a>              if( <a class="var it2669" onMouseOver="hilite(2669)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../../../_variables/pos.html">$pos</a> !== false &amp;&amp; <a class="var it2669" onMouseOver="hilite(2669)" onMouseOut="lolite()" onClick="logVariable('pos')" href="../../../_variables/pos.html">$pos</a> &lt;= 12 )
<a name="l432"><span class="linenum"> 432</span></a>              {
<a name="l433"><span class="linenum"> 433</span></a>  <span class="comment">                // This type may be superseeded by admin page</span>
<a name="l434"><span class="linenum"> 434</span></a>  <span class="comment">                // fp&gt; 2009-05-10: because of the 12 char limit above the following is probably no longer needed. Please enable it back if anyone has a problem with admin being detected as blacklist</span>
<a name="l435"><span class="linenum"> 435</span></a>  <span class="comment">                // if( ! $this-&gt;detect_admin_page() )</span>
<a name="l436"><span class="linenum"> 436</span></a>                  {    // Not an admin page:
<a name="l437"><span class="linenum"> 437</span></a>                      <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit: <a class="function" onClick="logFunction('detect_referer')" href="../../../_functions/detect_referer.html" onMouseOver="funcPopup(event,'detect_referer')">detect_referer</a>(): blacklist ('.<a class="var it4655" onMouseOver="hilite(4655)" onMouseOut="lolite()" onClick="logVariable('lSpeciallist')" href="../../../_variables/lSpeciallist.html">$lSpeciallist</a>.')', 'request' );
<a name="l438"><span class="linenum"> 438</span></a>                      <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_type.html">referer_type</a> = 'special';
<a name="l439"><span class="linenum"> 439</span></a>                  }
<a name="l440"><span class="linenum"> 440</span></a>                  return;
<a name="l441"><span class="linenum"> 441</span></a>              }
<a name="l442"><span class="linenum"> 442</span></a>          }
<a name="l443"><span class="linenum"> 443</span></a>  
<a name="l444"><span class="linenum"> 444</span></a>  
<a name="l445"><span class="linenum"> 445</span></a>  <span class="comment">        // Check if the referer is valid and does not match the antispam blacklist:</span>
<a name="l446"><span class="linenum"> 446</span></a>  <span class="comment">        // NOTE: requests to admin pages should not arrive here, because they should be matched above through $self_referer_list!</span>
<a name="l447"><span class="linenum"> 447</span></a>          <a class="function" onClick="logFunction('load_funcs')" href="../../../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>('_core/_url.funcs.php');
<a name="l448"><span class="linenum"> 448</span></a>          if( <a class="var it281" onMouseOver="hilite(281)" onMouseOut="lolite()" onClick="logVariable('error')" href="../../../_variables/error.html">$error</a> = <a class="function" onClick="logFunction('validate_url')" href="../../../_functions/validate_url.html" onMouseOver="funcPopup(event,'validate_url')">validate_url</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer.html">referer</a>, 'commenting' ) )
<a name="l449"><span class="linenum"> 449</span></a>          { // This is most probably referer spam!!
<a name="l450"><span class="linenum"> 450</span></a>              <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit: <a class="function" onClick="logFunction('detect_referer')" href="../../../_functions/detect_referer.html" onMouseOver="funcPopup(event,'detect_referer')">detect_referer</a>(): '.<a class="var it281" onMouseOver="hilite(281)" onMouseOut="lolite()" onClick="logVariable('error')" href="../../../_variables/error.html">$error</a>.' (SPAM)', 'hit');
<a name="l451"><span class="linenum"> 451</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_type.html">referer_type</a> = 'spam';
<a name="l452"><span class="linenum"> 452</span></a>  
<a name="l453"><span class="linenum"> 453</span></a>              if( <a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../../_variables/Settings.html">$Settings</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>('antispam_block_spam_referers') )
<a name="l454"><span class="linenum"> 454</span></a>              { // In order to preserve server resources, we're going to stop processing immediatly (no logging)!!
<a name="l455"><span class="linenum"> 455</span></a>                  require <a class="var it2259" onMouseOver="hilite(2259)" onMouseOut="lolite()" onClick="logVariable('siteskins_path')" href="../../../_variables/siteskins_path.html">$siteskins_path</a>.'_403_referer_spam.main.php';    <span class="comment">// error &amp; exit</span>
<a name="l456"><span class="linenum"> 456</span></a>                  exit(0); <span class="comment">// just in case.</span>
<a name="l457"><span class="linenum"> 457</span></a>  <span class="comment">                // THIS IS THE END!!</span>
<a name="l458"><span class="linenum"> 458</span></a>              }
<a name="l459"><span class="linenum"> 459</span></a>  
<a name="l460"><span class="linenum"> 460</span></a>              return; <span class="comment">// type &quot;spam&quot;</span>
<a name="l461"><span class="linenum"> 461</span></a>          }
<a name="l462"><span class="linenum"> 462</span></a>  
<a name="l463"><span class="linenum"> 463</span></a>  
<a name="l464"><span class="linenum"> 464</span></a>  <span class="comment">        // Is the referer a search engine?</span>
<a name="l465"><span class="linenum"> 465</span></a>          if( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('is_search_referer')" href="../../../_functions/is_search_referer.html" onMouseOver="funcPopup(event,'is_search_referer')">is_search_referer</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer.html">referer</a>) )
<a name="l466"><span class="linenum"> 466</span></a>          {
<a name="l467"><span class="linenum"> 467</span></a>              <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit: <a class="function" onClick="logFunction('detect_referer')" href="../../../_functions/detect_referer.html" onMouseOver="funcPopup(event,'detect_referer')">detect_referer</a>(): search engine', 'request' );
<a name="l468"><span class="linenum"> 468</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_type.html">referer_type</a> = 'search';
<a name="l469"><span class="linenum"> 469</span></a>              return;
<a name="l470"><span class="linenum"> 470</span></a>          }
<a name="l471"><span class="linenum"> 471</span></a>  
<a name="l472"><span class="linenum"> 472</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_type.html">referer_type</a> = 'referer';
<a name="l473"><span class="linenum"> 473</span></a>      }
<a name="l474"><span class="linenum"> 474</span></a>  
<a name="l475"><span class="linenum"> 475</span></a>  
<a name="l476"><span class="linenum"> 476</span></a>      <span class="comment">/**</span>
<a name="l477"><span class="linenum"> 477</span></a>  <span class="comment">     * Get referer_domain_ID (ID of the referer in T_basedomains).</span>
<a name="l478"><span class="linenum"> 478</span></a>  <span class="comment">     *</span>
<a name="l479"><span class="linenum"> 479</span></a>  <span class="comment">     * @return integer (may be NULL, but should never).</span>
<a name="l480"><span class="linenum"> 480</span></a>  <span class="comment">     */</span>
<a name="l481"><span class="linenum"> 481</span></a>  	function <a class="function" onClick="logFunction('get_referer_domain_ID')" href="../../../_functions/get_referer_domain_id.html" onMouseOver="funcPopup(event,'get_referer_domain_id')">get_referer_domain_ID</a>()
<a name="l482"><span class="linenum"> 482</span></a>      {
<a name="l483"><span class="linenum"> 483</span></a>          if( ! isset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_domain_ID')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_domain_ID.html">referer_domain_ID</a>) )
<a name="l484"><span class="linenum"> 484</span></a>          {
<a name="l485"><span class="linenum"> 485</span></a>              global <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l486"><span class="linenum"> 486</span></a>  <span class="comment">            // Check if we know the base domain:</span>
<a name="l487"><span class="linenum"> 487</span></a>              <a class="var it4656" onMouseOver="hilite(4656)" onMouseOut="lolite()" onClick="logVariable('referer_basedomain')" href="../../../_variables/referer_basedomain.html">$referer_basedomain</a> = <a class="function" onClick="logFunction('get_base_domain')" href="../../../_functions/get_base_domain.html" onMouseOver="funcPopup(event,'get_base_domain')">get_base_domain</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer.html">referer</a>);
<a name="l488"><span class="linenum"> 488</span></a>              if( <a class="var it4656" onMouseOver="hilite(4656)" onMouseOut="lolite()" onClick="logVariable('referer_basedomain')" href="../../../_variables/referer_basedomain.html">$referer_basedomain</a> )
<a name="l489"><span class="linenum"> 489</span></a>              {    // This referer has a base domain
<a name="l490"><span class="linenum"> 490</span></a>  <span class="comment">                // Check if we have met it before:</span>
<a name="l491"><span class="linenum"> 491</span></a>                  <a class="var it4657" onMouseOver="hilite(4657)" onMouseOut="lolite()" onClick="logVariable('hit_basedomain')" href="../../../_variables/hit_basedomain.html">$hit_basedomain</a> = <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_row')" href="../../../_functions/get_row.html" onMouseOver="funcPopup(event,'get_row')">get_row</a>( '
<a name="l492"><span class="linenum"> 492</span></a>                      SELECT dom_ID
<a name="l493"><span class="linenum"> 493</span></a>                          FROM T_basedomains
<a name="l494"><span class="linenum"> 494</span></a>                       WHERE dom_name = '.<a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>(<a class="var it4656" onMouseOver="hilite(4656)" onMouseOut="lolite()" onClick="logVariable('referer_basedomain')" href="../../../_variables/referer_basedomain.html">$referer_basedomain</a>) );
<a name="l495"><span class="linenum"> 495</span></a>                  if( !empty( <a class="var it4657" onMouseOver="hilite(4657)" onMouseOut="lolite()" onClick="logVariable('hit_basedomain')" href="../../../_variables/hit_basedomain.html">$hit_basedomain</a>-&gt;<a onClick="logVariable('dom_ID')" class="var it10877" onMouseOver="hilite(10877)" onMouseOut="lolite()" href="../../../_variables/dom_ID.html">dom_ID</a> ) )
<a name="l496"><span class="linenum"> 496</span></a>                  {    // This basedomain has visited before:
<a name="l497"><span class="linenum"> 497</span></a>                      <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_domain_ID')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_domain_ID.html">referer_domain_ID</a> = <a class="var it4657" onMouseOver="hilite(4657)" onMouseOut="lolite()" onClick="logVariable('hit_basedomain')" href="../../../_variables/hit_basedomain.html">$hit_basedomain</a>-&gt;<a onClick="logVariable('dom_ID')" class="var it10877" onMouseOver="hilite(10877)" onMouseOut="lolite()" href="../../../_variables/dom_ID.html">dom_ID</a>;
<a name="l498"><span class="linenum"> 498</span></a>  <span class="comment">                    // fp&gt; The blacklist handling that was here made no sense.</span>
<a name="l499"><span class="linenum"> 499</span></a>                  }
<a name="l500"><span class="linenum"> 500</span></a>                  else
<a name="l501"><span class="linenum"> 501</span></a>                  {    // This is the first time this base domain visits:
<a name="l502"><span class="linenum"> 502</span></a>  
<a name="l503"><span class="linenum"> 503</span></a>  <span class="comment">                    // The INSERT below can fail, probably if we get two simultaneous hits (seen in the demo logfiles)</span>
<a name="l504"><span class="linenum"> 504</span></a>                      if (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_type.html">agent_type</a> == 'robot' || <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hit_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/hit_type.html">hit_type</a> == 'rss')
<a name="l505"><span class="linenum"> 505</span></a>                      {
<a name="l506"><span class="linenum"> 506</span></a>                          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('dom_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/dom_type.html">dom_type</a> = 'aggregator';
<a name="l507"><span class="linenum"> 507</span></a>                      }
<a name="l508"><span class="linenum"> 508</span></a>                      elseif(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_type.html">referer_type</a> == 'search')
<a name="l509"><span class="linenum"> 509</span></a>                      {
<a name="l510"><span class="linenum"> 510</span></a>                          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('dom_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/dom_type.html">dom_type</a> = 'searcheng';
<a name="l511"><span class="linenum"> 511</span></a>                      }
<a name="l512"><span class="linenum"> 512</span></a>                      elseif(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_type.html">referer_type</a> == 'referer' || <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_type.html">referer_type</a> == 'self')
<a name="l513"><span class="linenum"> 513</span></a>                      {
<a name="l514"><span class="linenum"> 514</span></a>                          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('dom_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/dom_type.html">dom_type</a> = 'normal';
<a name="l515"><span class="linenum"> 515</span></a>                      }
<a name="l516"><span class="linenum"> 516</span></a>  
<a name="l517"><span class="linenum"> 517</span></a>  
<a name="l518"><span class="linenum"> 518</span></a>                      <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('save_error_state')" href="../../../_functions/save_error_state.html" onMouseOver="funcPopup(event,'save_error_state')">save_error_state</a>();
<a name="l519"><span class="linenum"> 519</span></a>  
<a name="l520"><span class="linenum"> 520</span></a>                      if( <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( '
<a name="l521"><span class="linenum"> 521</span></a>                          INSERT INTO T_basedomains( dom_name, dom_type)
<a name="l522"><span class="linenum"> 522</span></a>                              VALUES( '.<a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>(<a class="var it4656" onMouseOver="hilite(4656)" onMouseOut="lolite()" onClick="logVariable('referer_basedomain')" href="../../../_variables/referer_basedomain.html">$referer_basedomain</a>).', '.<a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('dom_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/dom_type.html">dom_type</a>).' )' ) )
<a name="l523"><span class="linenum"> 523</span></a>                      { // INSERTed ok:
<a name="l524"><span class="linenum"> 524</span></a>                          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_domain_ID')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_domain_ID.html">referer_domain_ID</a> = <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('insert_id')" class="var it10754" onMouseOver="hilite(10754)" onMouseOut="lolite()" href="../../../_variables/insert_id.html">insert_id</a>;
<a name="l525"><span class="linenum"> 525</span></a>                      }
<a name="l526"><span class="linenum"> 526</span></a>                      else
<a name="l527"><span class="linenum"> 527</span></a>                      { // INSERT failed: see, try to select again (may become/stay NULL)
<a name="l528"><span class="linenum"> 528</span></a>                          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_domain_ID')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_domain_ID.html">referer_domain_ID</a> = <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_var')" href="../../../_functions/get_var.html" onMouseOver="funcPopup(event,'get_var')">get_var</a>( '
<a name="l529"><span class="linenum"> 529</span></a>                              SELECT dom_ID
<a name="l530"><span class="linenum"> 530</span></a>                                  FROM T_basedomains
<a name="l531"><span class="linenum"> 531</span></a>                               WHERE dom_name = '.<a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>(<a class="var it4656" onMouseOver="hilite(4656)" onMouseOut="lolite()" onClick="logVariable('referer_basedomain')" href="../../../_variables/referer_basedomain.html">$referer_basedomain</a>) );
<a name="l532"><span class="linenum"> 532</span></a>                      }
<a name="l533"><span class="linenum"> 533</span></a>  
<a name="l534"><span class="linenum"> 534</span></a>                      <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('restore_error_state')" href="../../../_functions/restore_error_state.html" onMouseOver="funcPopup(event,'restore_error_state')">restore_error_state</a>();
<a name="l535"><span class="linenum"> 535</span></a>                  }
<a name="l536"><span class="linenum"> 536</span></a>              }
<a name="l537"><span class="linenum"> 537</span></a>          }
<a name="l538"><span class="linenum"> 538</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_domain_ID')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_domain_ID.html">referer_domain_ID</a>;
<a name="l539"><span class="linenum"> 539</span></a>      }
<a name="l540"><span class="linenum"> 540</span></a>  
<a name="l541"><span class="linenum"> 541</span></a>  
<a name="l542"><span class="linenum"> 542</span></a>      <span class="comment">/**</span>
<a name="l543"><span class="linenum"> 543</span></a>  <span class="comment">     * Set {@link $user_agent} and detect the browser.</span>
<a name="l544"><span class="linenum"> 544</span></a>  <span class="comment">     * This function also sets {@link $agent_type}.</span>
<a name="l545"><span class="linenum"> 545</span></a>  <span class="comment">     */</span>
<a name="l546"><span class="linenum"> 546</span></a>  	function <a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>()
<a name="l547"><span class="linenum"> 547</span></a>      {
<a name="l548"><span class="linenum"> 548</span></a>          if( isset( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_type.html">agent_type</a> ) )
<a name="l549"><span class="linenum"> 549</span></a>          { // already detected.
<a name="l550"><span class="linenum"> 550</span></a>              return;
<a name="l551"><span class="linenum"> 551</span></a>          }
<a name="l552"><span class="linenum"> 552</span></a>  
<a name="l553"><span class="linenum"> 553</span></a>          global <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>, <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>;
<a name="l554"><span class="linenum"> 554</span></a>          global <a class="var it4658" onMouseOver="hilite(4658)" onMouseOut="lolite()" onClick="logVariable('user_agents')" href="../../../_variables/user_agents.html">$user_agents</a>;
<a name="l555"><span class="linenum"> 555</span></a>          global <a class="var it47" onMouseOver="hilite(47)" onMouseOut="lolite()" onClick="logVariable('Skin')" href="../../../_variables/Skin.html">$Skin</a>; <span class="comment">// to detect agent_type (gets set in /xmlsrv/atom.php for example)</span>
<a name="l556"><span class="linenum"> 556</span></a>  
<a name="l557"><span class="linenum"> 557</span></a>  
<a name="l558"><span class="linenum"> 558</span></a>  <span class="comment">        // Init is_* members.</span>
<a name="l559"><span class="linenum"> 559</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_lynx')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_lynx.html">is_lynx</a> = false;
<a name="l560"><span class="linenum"> 560</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_firefox')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_firefox.html">is_firefox</a> = false;
<a name="l561"><span class="linenum"> 561</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_gecko')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_gecko.html">is_gecko</a> = false;
<a name="l562"><span class="linenum"> 562</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_IE')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_IE.html">is_IE</a> = false;
<a name="l563"><span class="linenum"> 563</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_winIE')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_winIE.html">is_winIE</a> = false;
<a name="l564"><span class="linenum"> 564</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_macIE')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_macIE.html">is_macIE</a> = false;
<a name="l565"><span class="linenum"> 565</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_chrome')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_chrome.html">is_chrome</a> = false;
<a name="l566"><span class="linenum"> 566</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_safari')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_safari.html">is_safari</a> = false;
<a name="l567"><span class="linenum"> 567</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_opera')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_opera.html">is_opera</a> = false;
<a name="l568"><span class="linenum"> 568</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_NS4')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_NS4.html">is_NS4</a> = false;
<a name="l569"><span class="linenum"> 569</span></a>  
<a name="l570"><span class="linenum"> 570</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_ID')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_ID.html">agent_ID</a> = NULL;
<a name="l571"><span class="linenum"> 571</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_type.html">agent_type</a> = 'unknown';
<a name="l572"><span class="linenum"> 572</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_name')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_name.html">agent_name</a> = '';
<a name="l573"><span class="linenum"> 573</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_platform')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_platform.html">agent_platform</a> = '';
<a name="l574"><span class="linenum"> 574</span></a>  
<a name="l575"><span class="linenum"> 575</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('browser_version')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/browser_version.html">browser_version</a> = 0;
<a name="l576"><span class="linenum"> 576</span></a>  
<a name="l577"><span class="linenum"> 577</span></a>          <a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('user_agent')" href="../../../_variables/user_agent.html">$user_agent</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_user_agent')" href="../../../_functions/get_user_agent.html" onMouseOver="funcPopup(event,'get_user_agent')">get_user_agent</a>();
<a name="l578"><span class="linenum"> 578</span></a>  
<a name="l579"><span class="linenum"> 579</span></a>          if( ! empty( <a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('user_agent')" href="../../../_variables/user_agent.html">$user_agent</a> ) )
<a name="l580"><span class="linenum"> 580</span></a>          { // detect browser
<a name="l581"><span class="linenum"> 581</span></a>              if( <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('user_agent')" href="../../../_variables/user_agent.html">$user_agent</a>, 'Win' ) !== false )
<a name="l582"><span class="linenum"> 582</span></a>              {
<a name="l583"><span class="linenum"> 583</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_platform')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_platform.html">agent_platform</a> = 'win';
<a name="l584"><span class="linenum"> 584</span></a>              }
<a name="l585"><span class="linenum"> 585</span></a>              elseif( <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('user_agent')" href="../../../_variables/user_agent.html">$user_agent</a>, 'Mac' ) !== false )
<a name="l586"><span class="linenum"> 586</span></a>              {
<a name="l587"><span class="linenum"> 587</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_platform')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_platform.html">agent_platform</a> = 'mac';
<a name="l588"><span class="linenum"> 588</span></a>              }
<a name="l589"><span class="linenum"> 589</span></a>              elseif( <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('user_agent')" href="../../../_variables/user_agent.html">$user_agent</a>, 'Linux' ) !== false )
<a name="l590"><span class="linenum"> 590</span></a>              {
<a name="l591"><span class="linenum"> 591</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_platform')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_platform.html">agent_platform</a> = 'linux';
<a name="l592"><span class="linenum"> 592</span></a>              }
<a name="l593"><span class="linenum"> 593</span></a>              elseif( <a class="var it4669" onMouseOver="hilite(4669)" onMouseOut="lolite()" onClick="logVariable('browscap')" href="../../../_variables/browscap.html">$browscap</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_browser_caps')" href="../../../_functions/get_browser_caps.html" onMouseOver="funcPopup(event,'get_browser_caps')">get_browser_caps</a>() )
<a name="l594"><span class="linenum"> 594</span></a>              {
<a name="l595"><span class="linenum"> 595</span></a>                  <a class="var it4670" onMouseOver="hilite(4670)" onMouseOut="lolite()" onClick="logVariable('platform')" href="../../../_variables/platform.html">$platform</a> = isset( <a class="var it4669" onMouseOver="hilite(4669)" onMouseOut="lolite()" onClick="logVariable('browscap')" href="../../../_variables/browscap.html">$browscap</a>-&gt;<a onClick="logVariable('platform')" class="var it10878" onMouseOver="hilite(10878)" onMouseOut="lolite()" href="../../../_variables/platform.html">platform</a>) ? <a class="var it4669" onMouseOver="hilite(4669)" onMouseOut="lolite()" onClick="logVariable('browscap')" href="../../../_variables/browscap.html">$browscap</a>-&gt;<a onClick="logVariable('platform')" class="var it10878" onMouseOver="hilite(10878)" onMouseOut="lolite()" href="../../../_variables/platform.html">platform</a> : '';
<a name="l596"><span class="linenum"> 596</span></a>  
<a name="l597"><span class="linenum"> 597</span></a>                  <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit:<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>(): Trying to detect platform using browscap', 'request' );
<a name="l598"><span class="linenum"> 598</span></a>                  <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit:<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>(): Raw platform string: &quot;'.<a class="var it4670" onMouseOver="hilite(4670)" onMouseOut="lolite()" onClick="logVariable('platform')" href="../../../_variables/platform.html">$platform</a>.'&quot;', 'request' );
<a name="l599"><span class="linenum"> 599</span></a>  
<a name="l600"><span class="linenum"> 600</span></a>                  <a class="var it4670" onMouseOver="hilite(4670)" onMouseOut="lolite()" onClick="logVariable('platform')" href="../../../_variables/platform.html">$platform</a> = <a class="phpfunction" onClick="logFunction('strtolower')" href="../../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>( <a class="var it4670" onMouseOver="hilite(4670)" onMouseOut="lolite()" onClick="logVariable('platform')" href="../../../_variables/platform.html">$platform</a> );
<a name="l601"><span class="linenum"> 601</span></a>                  if( <a class="var it4670" onMouseOver="hilite(4670)" onMouseOut="lolite()" onClick="logVariable('platform')" href="../../../_variables/platform.html">$platform</a> == 'linux' || <a class="phpfunction" onClick="logFunction('in_array')" href="../../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>( <a class="phpfunction" onClick="logFunction('substr')" href="../../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>( <a class="var it4670" onMouseOver="hilite(4670)" onMouseOut="lolite()" onClick="logVariable('platform')" href="../../../_variables/platform.html">$platform</a>, 0, 3 ), array( 'win', 'mac' ) ) )
<a name="l602"><span class="linenum"> 602</span></a>                  {
<a name="l603"><span class="linenum"> 603</span></a>                      <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_platform')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_platform.html">agent_platform</a> = <a class="var it4670" onMouseOver="hilite(4670)" onMouseOut="lolite()" onClick="logVariable('platform')" href="../../../_variables/platform.html">$platform</a>;
<a name="l604"><span class="linenum"> 604</span></a>                  }
<a name="l605"><span class="linenum"> 605</span></a>              }
<a name="l606"><span class="linenum"> 606</span></a>  
<a name="l607"><span class="linenum"> 607</span></a>              if( <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('user_agent')" href="../../../_variables/user_agent.html">$user_agent</a>, 'Lynx' ) !== false )
<a name="l608"><span class="linenum"> 608</span></a>              {
<a name="l609"><span class="linenum"> 609</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_lynx')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_lynx.html">is_lynx</a> = 1;
<a name="l610"><span class="linenum"> 610</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_name')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_name.html">agent_name</a> = 'lynx';
<a name="l611"><span class="linenum"> 611</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_type.html">agent_type</a> = 'browser';
<a name="l612"><span class="linenum"> 612</span></a>              }
<a name="l613"><span class="linenum"> 613</span></a>              elseif( <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('user_agent')" href="../../../_variables/user_agent.html">$user_agent</a>, 'Firefox/' ) !== false )
<a name="l614"><span class="linenum"> 614</span></a>              {
<a name="l615"><span class="linenum"> 615</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_firefox')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_firefox.html">is_firefox</a> = 1;
<a name="l616"><span class="linenum"> 616</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_name')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_name.html">agent_name</a> = 'firefox';
<a name="l617"><span class="linenum"> 617</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_type.html">agent_type</a> = 'browser';
<a name="l618"><span class="linenum"> 618</span></a>              }
<a name="l619"><span class="linenum"> 619</span></a>              elseif( <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('user_agent')" href="../../../_variables/user_agent.html">$user_agent</a>, 'Gecko/' ) !== false )    // We don't want to see Safari as Gecko
<a name="l620"><span class="linenum"> 620</span></a>              { // Tblue&gt; Note: Gecko is only a rendering engine, not a real browser!
<a name="l621"><span class="linenum"> 621</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_gecko')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_gecko.html">is_gecko</a> = 1;
<a name="l622"><span class="linenum"> 622</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_name')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_name.html">agent_name</a> = 'gecko';
<a name="l623"><span class="linenum"> 623</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_type.html">agent_type</a> = 'browser';
<a name="l624"><span class="linenum"> 624</span></a>              }
<a name="l625"><span class="linenum"> 625</span></a>              elseif( <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('user_agent')" href="../../../_variables/user_agent.html">$user_agent</a>, 'MSIE' ) !== false )
<a name="l626"><span class="linenum"> 626</span></a>              {
<a name="l627"><span class="linenum"> 627</span></a>                  if( <a class="phpfunction" onClick="logFunction('preg_match')" href="../../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>( '/MSIE (\d+)\./', <a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('user_agent')" href="../../../_variables/user_agent.html">$user_agent</a>, <a class="var it4649" onMouseOver="hilite(4649)" onMouseOut="lolite()" onClick="logVariable('browser_version')" href="../../../_variables/browser_version.html">$browser_version</a> ) )
<a name="l628"><span class="linenum"> 628</span></a>                  { // Detect version of IE browser
<a name="l629"><span class="linenum"> 629</span></a>                      <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('browser_version')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/browser_version.html">browser_version</a> = (int)<a class="var it4649" onMouseOver="hilite(4649)" onMouseOut="lolite()" onClick="logVariable('browser_version')" href="../../../_variables/browser_version.html">$browser_version</a>[1];
<a name="l630"><span class="linenum"> 630</span></a>                  }
<a name="l631"><span class="linenum"> 631</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_IE')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_IE.html">is_IE</a> = true;
<a name="l632"><span class="linenum"> 632</span></a>                  if( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_platform')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_platform.html">agent_platform</a> == 'win' )
<a name="l633"><span class="linenum"> 633</span></a>                  { // Win IE
<a name="l634"><span class="linenum"> 634</span></a>                      <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_winIE')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_winIE.html">is_winIE</a> = 1;
<a name="l635"><span class="linenum"> 635</span></a>                  }
<a name="l636"><span class="linenum"> 636</span></a>                  if( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_platform')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_platform.html">agent_platform</a> == 'mac' )
<a name="l637"><span class="linenum"> 637</span></a>                  { // Mac IE
<a name="l638"><span class="linenum"> 638</span></a>                      <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_macIE')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_macIE.html">is_macIE</a> = 1;
<a name="l639"><span class="linenum"> 639</span></a>                  }
<a name="l640"><span class="linenum"> 640</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_name')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_name.html">agent_name</a> = 'msie';
<a name="l641"><span class="linenum"> 641</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_type.html">agent_type</a> = 'browser';
<a name="l642"><span class="linenum"> 642</span></a>              }
<a name="l643"><span class="linenum"> 643</span></a>              elseif( <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('user_agent')" href="../../../_variables/user_agent.html">$user_agent</a>, 'Chrome/' ) !== false )
<a name="l644"><span class="linenum"> 644</span></a>              {
<a name="l645"><span class="linenum"> 645</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_chrome')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_chrome.html">is_chrome</a> = true;
<a name="l646"><span class="linenum"> 646</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_name')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_name.html">agent_name</a> = 'chrome';
<a name="l647"><span class="linenum"> 647</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_type.html">agent_type</a> = 'browser';
<a name="l648"><span class="linenum"> 648</span></a>              }
<a name="l649"><span class="linenum"> 649</span></a>              elseif( <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('user_agent')" href="../../../_variables/user_agent.html">$user_agent</a>, 'Safari/' ) !== false )
<a name="l650"><span class="linenum"> 650</span></a>              {
<a name="l651"><span class="linenum"> 651</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_safari')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_safari.html">is_safari</a> = true;
<a name="l652"><span class="linenum"> 652</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_name')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_name.html">agent_name</a> = 'safari';
<a name="l653"><span class="linenum"> 653</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_type.html">agent_type</a> = 'browser';
<a name="l654"><span class="linenum"> 654</span></a>              }
<a name="l655"><span class="linenum"> 655</span></a>              elseif( <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('user_agent')" href="../../../_variables/user_agent.html">$user_agent</a>, 'Opera' ) !== false )
<a name="l656"><span class="linenum"> 656</span></a>              {
<a name="l657"><span class="linenum"> 657</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_opera')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_opera.html">is_opera</a> = 1;
<a name="l658"><span class="linenum"> 658</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_name')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_name.html">agent_name</a> = 'opera';
<a name="l659"><span class="linenum"> 659</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_type.html">agent_type</a> = 'browser';
<a name="l660"><span class="linenum"> 660</span></a>              }
<a name="l661"><span class="linenum"> 661</span></a>              elseif( <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('user_agent')" href="../../../_variables/user_agent.html">$user_agent</a>, 'Nav' ) !== false || <a class="phpfunction" onClick="logFunction('preg_match')" href="../../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>( '/Mozilla\/4\./', <a class="var it743" onMouseOver="hilite(743)" onMouseOut="lolite()" onClick="logVariable('user_agent')" href="../../../_variables/user_agent.html">$user_agent</a> ) )
<a name="l662"><span class="linenum"> 662</span></a>              {
<a name="l663"><span class="linenum"> 663</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_NS4')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_NS4.html">is_NS4</a> = 1;
<a name="l664"><span class="linenum"> 664</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_name')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_name.html">agent_name</a> = 'nav4';
<a name="l665"><span class="linenum"> 665</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_type.html">agent_type</a> = 'browser';
<a name="l666"><span class="linenum"> 666</span></a>              }
<a name="l667"><span class="linenum"> 667</span></a>          }
<a name="l668"><span class="linenum"> 668</span></a>  
<a name="l669"><span class="linenum"> 669</span></a>          <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit:<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>(): Agent name: '.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_name')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_name.html">agent_name</a>, 'request' );
<a name="l670"><span class="linenum"> 670</span></a>          <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit:<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>(): Agent platform: '.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_platform')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_platform.html">agent_platform</a>, 'request' );
<a name="l671"><span class="linenum"> 671</span></a>  
<a name="l672"><span class="linenum"> 672</span></a>  
<a name="l673"><span class="linenum"> 673</span></a>  <span class="comment">        // Lookup robots</span>
<a name="l674"><span class="linenum"> 674</span></a>          <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('match')" href="../../../_variables/match.html">$match</a> = false;
<a name="l675"><span class="linenum"> 675</span></a>          foreach( <a class="var it4658" onMouseOver="hilite(4658)" onMouseOut="lolite()" onClick="logVariable('user_agents')" href="../../../_variables/user_agents.html">$user_agents</a> as <a class="var it4632" onMouseOver="hilite(4632)" onMouseOut="lolite()" onClick="logVariable('agent_ID')" href="../../../_variables/agent_ID.html">$agent_ID</a> =&gt; <a class="var it4671" onMouseOver="hilite(4671)" onMouseOut="lolite()" onClick="logVariable('lUserAgent')" href="../../../_variables/lUserAgent.html">$lUserAgent</a> )
<a name="l676"><span class="linenum"> 676</span></a>          {
<a name="l677"><span class="linenum"> 677</span></a>              if( <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('user_agent')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/user_agent.html">user_agent</a>, <a class="var it4671" onMouseOver="hilite(4671)" onMouseOut="lolite()" onClick="logVariable('lUserAgent')" href="../../../_variables/lUserAgent.html">$lUserAgent</a>[1] ) !== false )
<a name="l678"><span class="linenum"> 678</span></a>              {
<a name="l679"><span class="linenum"> 679</span></a>                  <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit:<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>(): '.<a class="var it4671" onMouseOver="hilite(4671)" onMouseOut="lolite()" onClick="logVariable('lUserAgent')" href="../../../_variables/lUserAgent.html">$lUserAgent</a>[0], 'request' );
<a name="l680"><span class="linenum"> 680</span></a>                  <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit:<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>(): Agent ID: '.<a class="var it4632" onMouseOver="hilite(4632)" onMouseOut="lolite()" onClick="logVariable('agent_ID')" href="../../../_variables/agent_ID.html">$agent_ID</a>, 'request' );
<a name="l681"><span class="linenum"> 681</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_type.html">agent_type</a> = ( <a class="var it4671" onMouseOver="hilite(4671)" onMouseOut="lolite()" onClick="logVariable('lUserAgent')" href="../../../_variables/lUserAgent.html">$lUserAgent</a>[0] == 'robot' ) ? 'robot' : 'browser';
<a name="l682"><span class="linenum"> 682</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_ID')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_ID.html">agent_ID</a> = <a class="var it4632" onMouseOver="hilite(4632)" onMouseOut="lolite()" onClick="logVariable('agent_ID')" href="../../../_variables/agent_ID.html">$agent_ID</a>;
<a name="l683"><span class="linenum"> 683</span></a>                  <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('match')" href="../../../_variables/match.html">$match</a> = true;
<a name="l684"><span class="linenum"> 684</span></a>                  break;
<a name="l685"><span class="linenum"> 685</span></a>              }
<a name="l686"><span class="linenum"> 686</span></a>          }
<a name="l687"><span class="linenum"> 687</span></a>  
<a name="l688"><span class="linenum"> 688</span></a>          if( ! <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('match')" href="../../../_variables/match.html">$match</a> &amp;&amp; ( <a class="var it4669" onMouseOver="hilite(4669)" onMouseOut="lolite()" onClick="logVariable('browscap')" href="../../../_variables/browscap.html">$browscap</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_browser_caps')" href="../../../_functions/get_browser_caps.html" onMouseOver="funcPopup(event,'get_browser_caps')">get_browser_caps</a>() ) &amp;&amp;
<a name="l689"><span class="linenum"> 689</span></a>              isset( <a class="var it4669" onMouseOver="hilite(4669)" onMouseOut="lolite()" onClick="logVariable('browscap')" href="../../../_variables/browscap.html">$browscap</a>-&gt;<a onClick="logVariable('crawler')" class="var it10878" onMouseOver="hilite(10878)" onMouseOut="lolite()" href="../../../_variables/crawler.html">crawler</a> ) &amp;&amp; <a class="var it4669" onMouseOver="hilite(4669)" onMouseOut="lolite()" onClick="logVariable('browscap')" href="../../../_variables/browscap.html">$browscap</a>-&gt;<a onClick="logVariable('crawler')" class="var it10878" onMouseOver="hilite(10878)" onMouseOut="lolite()" href="../../../_variables/crawler.html">crawler</a> )
<a name="l690"><span class="linenum"> 690</span></a>          {
<a name="l691"><span class="linenum"> 691</span></a>              <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit:<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>(): robot (through browscap)', 'request' );
<a name="l692"><span class="linenum"> 692</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_type.html">agent_type</a> = 'robot';
<a name="l693"><span class="linenum"> 693</span></a>          }
<a name="l694"><span class="linenum"> 694</span></a>  
<a name="l695"><span class="linenum"> 695</span></a>      }
<a name="l696"><span class="linenum"> 696</span></a>  
<a name="l697"><span class="linenum"> 697</span></a>  
<a name="l698"><span class="linenum"> 698</span></a>      <span class="comment">/**</span>
<a name="l699"><span class="linenum"> 699</span></a>  <span class="comment">     * Get browser capabilities through {@link get_browser()}.</span>
<a name="l700"><span class="linenum"> 700</span></a>  <span class="comment">     *</span>
<a name="l701"><span class="linenum"> 701</span></a>  <span class="comment">     * @return false|object The return value of get_browser().</span>
<a name="l702"><span class="linenum"> 702</span></a>  <span class="comment">     */</span>
<a name="l703"><span class="linenum"> 703</span></a>  	function <a class="function" onClick="logFunction('get_browser_caps')" href="../../../_functions/get_browser_caps.html" onMouseOver="funcPopup(event,'get_browser_caps')">get_browser_caps</a>()
<a name="l704"><span class="linenum"> 704</span></a>      {
<a name="l705"><span class="linenum"> 705</span></a>          static <a class="var it4673" onMouseOver="hilite(4673)" onMouseOut="lolite()" onClick="logVariable('caps')" href="../../../_variables/caps.html">$caps</a> = NULL;
<a name="l706"><span class="linenum"> 706</span></a>  
<a name="l707"><span class="linenum"> 707</span></a>          if( <a class="var it4673" onMouseOver="hilite(4673)" onMouseOut="lolite()" onClick="logVariable('caps')" href="../../../_variables/caps.html">$caps</a> === NULL )
<a name="l708"><span class="linenum"> 708</span></a>          {
<a name="l709"><span class="linenum"> 709</span></a>              <a class="var it4673" onMouseOver="hilite(4673)" onMouseOut="lolite()" onClick="logVariable('caps')" href="../../../_variables/caps.html">$caps</a> = @<a class="phpfunction" onClick="logFunction('get_browser')" href="../../../_functions/get_browser.html" onMouseOver="phpfuncPopup(event,'get_browser')">get_browser</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_user_agent')" href="../../../_functions/get_user_agent.html" onMouseOver="funcPopup(event,'get_user_agent')">get_user_agent</a>() );
<a name="l710"><span class="linenum"> 710</span></a>          }
<a name="l711"><span class="linenum"> 711</span></a>  
<a name="l712"><span class="linenum"> 712</span></a>          return <a class="var it4673" onMouseOver="hilite(4673)" onMouseOut="lolite()" onClick="logVariable('caps')" href="../../../_variables/caps.html">$caps</a>;
<a name="l713"><span class="linenum"> 713</span></a>      }
<a name="l714"><span class="linenum"> 714</span></a>  
<a name="l715"><span class="linenum"> 715</span></a>  
<a name="l716"><span class="linenum"> 716</span></a>      <span class="comment">/**</span>
<a name="l717"><span class="linenum"> 717</span></a>  <span class="comment">     * Log a hit on a blog page / rss feed.</span>
<a name="l718"><span class="linenum"> 718</span></a>  <span class="comment">     *</span>
<a name="l719"><span class="linenum"> 719</span></a>  <span class="comment">     * This function should be called at the end of the page, otherwise if the page</span>
<a name="l720"><span class="linenum"> 720</span></a>  <span class="comment">     * is displaying previous hits, it may display the current one too.</span>
<a name="l721"><span class="linenum"> 721</span></a>  <span class="comment">     *</span>
<a name="l722"><span class="linenum"> 722</span></a>  <span class="comment">     * The hit will not be logged in special occasions, see {@link $ignore} and {@link is_good_hit()}.</span>
<a name="l723"><span class="linenum"> 723</span></a>  <span class="comment">     *</span>
<a name="l724"><span class="linenum"> 724</span></a>  <span class="comment">     * It will call {@link Hitlist::dbprune()} to do the automatic pruning of old hits in case</span>
<a name="l725"><span class="linenum"> 725</span></a>  <span class="comment">     * of auto_prune_stats_mode == &quot;page&quot;.</span>
<a name="l726"><span class="linenum"> 726</span></a>  <span class="comment">     *</span>
<a name="l727"><span class="linenum"> 727</span></a>  <span class="comment">     * @param boolean Hit saving in the database can be delayed or not because of the hit_ID is required</span>
<a name="l728"><span class="linenum"> 728</span></a>  <span class="comment">     *</span>
<a name="l729"><span class="linenum"> 729</span></a>  <span class="comment">     * @return boolean true if the hit gets logged; false if not</span>
<a name="l730"><span class="linenum"> 730</span></a>  <span class="comment">     */</span>
<a name="l731"><span class="linenum"> 731</span></a>  	function <a class="function" onClick="logFunction('log')" href="../../../_functions/log.html" onMouseOver="funcPopup(event,'log')">log</a>( <a class="var it4674" onMouseOver="hilite(4674)" onMouseOut="lolite()" onClick="logVariable('delayed')" href="../../../_variables/delayed.html">$delayed</a> = false )
<a name="l732"><span class="linenum"> 732</span></a>      {
<a name="l733"><span class="linenum"> 733</span></a>          global <a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('Plugins')" href="../../../_variables/Plugins.html">$Plugins</a>;
<a name="l734"><span class="linenum"> 734</span></a>  
<a name="l735"><span class="linenum"> 735</span></a>          if( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('logged')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/logged.html">logged</a> )
<a name="l736"><span class="linenum"> 736</span></a>          {    // Already logged, don't log twice:
<a name="l737"><span class="linenum"> 737</span></a>              return false;
<a name="l738"><span class="linenum"> 738</span></a>          }
<a name="l739"><span class="linenum"> 739</span></a>  
<a name="l740"><span class="linenum"> 740</span></a>  <span class="comment">        // Remember we have already attempted to log:</span>
<a name="l741"><span class="linenum"> 741</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('logged')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/logged.html">logged</a> = true;
<a name="l742"><span class="linenum"> 742</span></a>  
<a name="l743"><span class="linenum"> 743</span></a>  <span class="comment">        // Check if this hit should be logged:</span>
<a name="l744"><span class="linenum"> 744</span></a>          if( ! <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('should_be_logged')" href="../../../_functions/should_be_logged.html" onMouseOver="funcPopup(event,'should_be_logged')">should_be_logged</a>() )
<a name="l745"><span class="linenum"> 745</span></a>          {
<a name="l746"><span class="linenum"> 746</span></a>              return false;
<a name="l747"><span class="linenum"> 747</span></a>          }
<a name="l748"><span class="linenum"> 748</span></a>  
<a name="l749"><span class="linenum"> 749</span></a>          if( <a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('Plugins')" href="../../../_variables/Plugins.html">$Plugins</a>-&gt;<a class="function" onClick="logFunction('trigger_event_first_true')" href="../../../_functions/trigger_event_first_true.html" onMouseOver="funcPopup(event,'trigger_event_first_true')">trigger_event_first_true</a>('AppendHitLog', array( 'Hit' =&gt; &amp;<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a> ) ) )
<a name="l750"><span class="linenum"> 750</span></a>          {    // Plugin has handled recording
<a name="l751"><span class="linenum"> 751</span></a>              return true;
<a name="l752"><span class="linenum"> 752</span></a>          }
<a name="l753"><span class="linenum"> 753</span></a>  
<a name="l754"><span class="linenum"> 754</span></a>  <span class="comment">        // Check if this hit should STILL be logged after plugin call:</span>
<a name="l755"><span class="linenum"> 755</span></a>          if( ! <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('should_be_logged')" href="../../../_functions/should_be_logged.html" onMouseOver="funcPopup(event,'should_be_logged')">should_be_logged</a>() )
<a name="l756"><span class="linenum"> 756</span></a>          {
<a name="l757"><span class="linenum"> 757</span></a>              return false;
<a name="l758"><span class="linenum"> 758</span></a>          }
<a name="l759"><span class="linenum"> 759</span></a>  
<a name="l760"><span class="linenum"> 760</span></a>  <span class="comment">        // Record the HIT now:</span>
<a name="l761"><span class="linenum"> 761</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('record_the_hit')" href="../../../_functions/record_the_hit.html" onMouseOver="funcPopup(event,'record_the_hit')">record_the_hit</a>( <a class="var it4674" onMouseOver="hilite(4674)" onMouseOut="lolite()" onClick="logVariable('delayed')" href="../../../_variables/delayed.html">$delayed</a> );
<a name="l762"><span class="linenum"> 762</span></a>  
<a name="l763"><span class="linenum"> 763</span></a>          return true;
<a name="l764"><span class="linenum"> 764</span></a>      }
<a name="l765"><span class="linenum"> 765</span></a>  
<a name="l766"><span class="linenum"> 766</span></a>  
<a name="l767"><span class="linenum"> 767</span></a>      <span class="comment">/**</span>
<a name="l768"><span class="linenum"> 768</span></a>  <span class="comment">     * Tell if a HIT should be logged:</span>
<a name="l769"><span class="linenum"> 769</span></a>  <span class="comment">     *</span>
<a name="l770"><span class="linenum"> 770</span></a>  <span class="comment">     * @return boolean</span>
<a name="l771"><span class="linenum"> 771</span></a>  <span class="comment">     */</span>
<a name="l772"><span class="linenum"> 772</span></a>  	function <a class="function" onClick="logFunction('should_be_logged')" href="../../../_functions/should_be_logged.html" onMouseOver="funcPopup(event,'should_be_logged')">should_be_logged</a>()
<a name="l773"><span class="linenum"> 773</span></a>      {
<a name="l774"><span class="linenum"> 774</span></a>          global <a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../../_variables/Settings.html">$Settings</a>, <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>, <a class="var it488" onMouseOver="hilite(488)" onMouseOut="lolite()" onClick="logVariable('is_admin_page')" href="../../../_variables/is_admin_page.html">$is_admin_page</a>;
<a name="l775"><span class="linenum"> 775</span></a>  
<a name="l776"><span class="linenum"> 776</span></a>          if( <a class="var it488" onMouseOver="hilite(488)" onMouseOut="lolite()" onClick="logVariable('is_admin_page')" href="../../../_variables/is_admin_page.html">$is_admin_page</a> &amp;&amp; ! <a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../../_variables/Settings.html">$Settings</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>('log_admin_hits') &amp;&amp; empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('test_mode')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/test_mode.html">test_mode</a>))
<a name="l777"><span class="linenum"> 777</span></a>          {    // We don't want to log admin hits:
<a name="l778"><span class="linenum"> 778</span></a>              <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit: Hit NOT logged, (Admin page logging is disabled)', 'request' );
<a name="l779"><span class="linenum"> 779</span></a>              return false;
<a name="l780"><span class="linenum"> 780</span></a>          }
<a name="l781"><span class="linenum"> 781</span></a>  
<a name="l782"><span class="linenum"> 782</span></a>          if( ! <a class="var it488" onMouseOver="hilite(488)" onMouseOut="lolite()" onClick="logVariable('is_admin_page')" href="../../../_variables/is_admin_page.html">$is_admin_page</a> &amp;&amp; ! <a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../../_variables/Settings.html">$Settings</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>('log_public_hits') )
<a name="l783"><span class="linenum"> 783</span></a>          {    // We don't want to log public hits:
<a name="l784"><span class="linenum"> 784</span></a>              <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit: Hit NOT logged, (Public page logging is disabled)', 'request' );
<a name="l785"><span class="linenum"> 785</span></a>              return false;
<a name="l786"><span class="linenum"> 786</span></a>          }
<a name="l787"><span class="linenum"> 787</span></a>  
<a name="l788"><span class="linenum"> 788</span></a>          if( (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_type.html">referer_type</a> == 'spam' &amp;&amp; ! <a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../../_variables/Settings.html">$Settings</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>('log_spam_hits')) &amp;&amp; empty(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('test_mode')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/test_mode.html">test_mode</a>) )
<a name="l789"><span class="linenum"> 789</span></a>          {    // We don't want to log referer spam hits:
<a name="l790"><span class="linenum"> 790</span></a>              <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit: Hit NOT logged, (Referer spam)', 'request' );
<a name="l791"><span class="linenum"> 791</span></a>              return false;
<a name="l792"><span class="linenum"> 792</span></a>          }
<a name="l793"><span class="linenum"> 793</span></a>  
<a name="l794"><span class="linenum"> 794</span></a>          return true;
<a name="l795"><span class="linenum"> 795</span></a>      }
<a name="l796"><span class="linenum"> 796</span></a>  
<a name="l797"><span class="linenum"> 797</span></a>  
<a name="l798"><span class="linenum"> 798</span></a>      <span class="comment">/**</span>
<a name="l799"><span class="linenum"> 799</span></a>  <span class="comment">     * This records the hit. You should not call this directly, but {@link Hit::log()} instead!</span>
<a name="l800"><span class="linenum"> 800</span></a>  <span class="comment">     *</span>
<a name="l801"><span class="linenum"> 801</span></a>  <span class="comment">     * However, if a Plugin registers the {@link Plugin::AppendHitLog() AppendHitLog event}, it</span>
<a name="l802"><span class="linenum"> 802</span></a>  <span class="comment">     * could be necessary to call this as a shutdown function.</span>
<a name="l803"><span class="linenum"> 803</span></a>  <span class="comment">     *</span>
<a name="l804"><span class="linenum"> 804</span></a>  <span class="comment">     * @param boolean Hit saving in the database can be delayed or not because of the hit_ID is required</span>
<a name="l805"><span class="linenum"> 805</span></a>  <span class="comment">     */</span>
<a name="l806"><span class="linenum"> 806</span></a>  	function <a class="function" onClick="logFunction('record_the_hit')" href="../../../_functions/record_the_hit.html" onMouseOver="funcPopup(event,'record_the_hit')">record_the_hit</a>( <a class="var it4674" onMouseOver="hilite(4674)" onMouseOut="lolite()" onClick="logVariable('delayed')" href="../../../_variables/delayed.html">$delayed</a> = false )
<a name="l807"><span class="linenum"> 807</span></a>      {
<a name="l808"><span class="linenum"> 808</span></a>          global <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>, <a class="var it478" onMouseOver="hilite(478)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>, <a class="var it477" onMouseOver="hilite(477)" onMouseOut="lolite()" onClick="logVariable('ReqURI')" href="../../../_variables/ReqURI.html">$ReqURI</a>, <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>, <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a>, <a class="var it317" onMouseOver="hilite(317)" onMouseOut="lolite()" onClick="logVariable('localtimenow')" href="../../../_variables/localtimenow.html">$localtimenow</a>, <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>, <a class="var it45" onMouseOver="hilite(45)" onMouseOut="lolite()" onClick="logVariable('disp')" href="../../../_variables/disp.html">$disp</a>, <a class="var it499" onMouseOver="hilite(499)" onMouseOut="lolite()" onClick="logVariable('ctrl')" href="../../../_variables/ctrl.html">$ctrl</a>, <a class="var it613" onMouseOver="hilite(613)" onMouseOut="lolite()" onClick="logVariable('http_response_code')" href="../../../_variables/http_response_code.html">$http_response_code</a>;
<a name="l809"><span class="linenum"> 809</span></a>  
<a name="l810"><span class="linenum"> 810</span></a>  <span class="comment">        // To log current display and controller the global variables $disp and $ctrl are used. They can be setup while calling of some controller</span>
<a name="l811"><span class="linenum"> 811</span></a>  <span class="comment">        // or while forming a page. In case if these variables aren't setup, NULL is recorded to the DB.</span>
<a name="l812"><span class="linenum"> 812</span></a>          <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit: Recording the hit.', 'request' );
<a name="l813"><span class="linenum"> 813</span></a>  
<a name="l814"><span class="linenum"> 814</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('action')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/action.html">action</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_action')" href="../../../_functions/get_action.html" onMouseOver="funcPopup(event,'get_action')">get_action</a>();
<a name="l815"><span class="linenum"> 815</span></a>  
<a name="l816"><span class="linenum"> 816</span></a>          if( empty( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('test_uri')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/test_uri.html">test_uri</a> ) )
<a name="l817"><span class="linenum"> 817</span></a>          {
<a name="l818"><span class="linenum"> 818</span></a>              if( ! empty( <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a> ) )
<a name="l819"><span class="linenum"> 819</span></a>              {
<a name="l820"><span class="linenum"> 820</span></a>                  <a class="var it141" onMouseOver="hilite(141)" onMouseOut="lolite()" onClick="logVariable('blog_ID')" href="../../../_variables/blog_ID.html">$blog_ID</a> = <a class="var it46" onMouseOver="hilite(46)" onMouseOut="lolite()" onClick="logVariable('Blog')" href="../../../_variables/Blog.html">$Blog</a>-&gt;<a onClick="logVariable('ID')" class="var it10696" onMouseOver="hilite(10696)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>;
<a name="l821"><span class="linenum"> 821</span></a>              }
<a name="l822"><span class="linenum"> 822</span></a>              elseif( ! empty( <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a> ) )
<a name="l823"><span class="linenum"> 823</span></a>              {
<a name="l824"><span class="linenum"> 824</span></a>                  if( ! <a class="phpfunction" onClick="logFunction('is_numeric')" href="../../../_functions/is_numeric.html" onMouseOver="phpfuncPopup(event,'is_numeric')">is_numeric</a>( <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a> ) )
<a name="l825"><span class="linenum"> 825</span></a>                  { // this can be anything given by URL param &quot;blog&quot;! (because it's called on shutdown)
<a name="l826"><span class="linenum"> 826</span></a>  <span class="comment">                  // see todo in param().</span>
<a name="l827"><span class="linenum"> 827</span></a>                      <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a> = NULL;
<a name="l828"><span class="linenum"> 828</span></a>                  }
<a name="l829"><span class="linenum"> 829</span></a>                  <a class="var it141" onMouseOver="hilite(141)" onMouseOut="lolite()" onClick="logVariable('blog_ID')" href="../../../_variables/blog_ID.html">$blog_ID</a> = <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../../_variables/blog.html">$blog</a>;
<a name="l830"><span class="linenum"> 830</span></a>              }
<a name="l831"><span class="linenum"> 831</span></a>              else
<a name="l832"><span class="linenum"> 832</span></a>              {
<a name="l833"><span class="linenum"> 833</span></a>                  <a class="var it141" onMouseOver="hilite(141)" onMouseOut="lolite()" onClick="logVariable('blog_ID')" href="../../../_variables/blog_ID.html">$blog_ID</a> = NULL;
<a name="l834"><span class="linenum"> 834</span></a>              }
<a name="l835"><span class="linenum"> 835</span></a>          }
<a name="l836"><span class="linenum"> 836</span></a>          else
<a name="l837"><span class="linenum"> 837</span></a>          {
<a name="l838"><span class="linenum"> 838</span></a>              <a class="var it141" onMouseOver="hilite(141)" onMouseOut="lolite()" onClick="logVariable('blog_ID')" href="../../../_variables/blog_ID.html">$blog_ID</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('test_uri')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/test_uri.html">test_uri</a>['blog_id'];
<a name="l839"><span class="linenum"> 839</span></a>              <a class="var it477" onMouseOver="hilite(477)" onMouseOut="lolite()" onClick="logVariable('ReqURI')" href="../../../_variables/ReqURI.html">$ReqURI</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('test_uri')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/test_uri.html">test_uri</a>['link'];
<a name="l840"><span class="linenum"> 840</span></a>          }
<a name="l841"><span class="linenum"> 841</span></a>  
<a name="l842"><span class="linenum"> 842</span></a>          <a class="var it4675" onMouseOver="hilite(4675)" onMouseOut="lolite()" onClick="logVariable('hit_uri')" href="../../../_variables/hit_uri.html">$hit_uri</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>( <a class="var it477" onMouseOver="hilite(477)" onMouseOut="lolite()" onClick="logVariable('ReqURI')" href="../../../_variables/ReqURI.html">$ReqURI</a>, 0, 250 ); <span class="comment">// VARCHAR(250) and likely to be longer</span>
<a name="l843"><span class="linenum"> 843</span></a>          <a class="var it4676" onMouseOver="hilite(4676)" onMouseOut="lolite()" onClick="logVariable('hit_referer')" href="../../../_variables/hit_referer.html">$hit_referer</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer.html">referer</a>, 0, 250 ); <span class="comment">// VARCHAR(250) and likely to be longer</span>
<a name="l844"><span class="linenum"> 844</span></a>  
<a name="l845"><span class="linenum"> 845</span></a>  <span class="comment">        // Extract the keyphrase from search referers:</span>
<a name="l846"><span class="linenum"> 846</span></a>          <a class="var it4677" onMouseOver="hilite(4677)" onMouseOut="lolite()" onClick="logVariable('keyphrase')" href="../../../_variables/keyphrase.html">$keyphrase</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_keyphrase')" href="../../../_functions/get_keyphrase.html" onMouseOver="funcPopup(event,'get_keyphrase')">get_keyphrase</a>();
<a name="l847"><span class="linenum"> 847</span></a>  
<a name="l848"><span class="linenum"> 848</span></a>          <a class="var it4678" onMouseOver="hilite(4678)" onMouseOut="lolite()" onClick="logVariable('keyp_ID')" href="../../../_variables/keyp_ID.html">$keyp_ID</a> = NULL;
<a name="l849"><span class="linenum"> 849</span></a>  
<a name="l850"><span class="linenum"> 850</span></a>          if ( empty( <a class="var it4677" onMouseOver="hilite(4677)" onMouseOut="lolite()" onClick="logVariable('keyphrase')" href="../../../_variables/keyphrase.html">$keyphrase</a> ) )
<a name="l851"><span class="linenum"> 851</span></a>          {    // No search hit
<a name="l852"><span class="linenum"> 852</span></a>              if ( ! empty( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('test_mode')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/test_mode.html">test_mode</a> ) &amp;&amp; ! empty( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('test_uri')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/test_uri.html">test_uri</a>['s'] ) )
<a name="l853"><span class="linenum"> 853</span></a>              {
<a name="l854"><span class="linenum"> 854</span></a>                  <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('s')" href="../../../_variables/s.html">$s</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('test_uri')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/test_uri.html">test_uri</a>['s'];
<a name="l855"><span class="linenum"> 855</span></a>              }
<a name="l856"><span class="linenum"> 856</span></a>              else
<a name="l857"><span class="linenum"> 857</span></a>              {
<a name="l858"><span class="linenum"> 858</span></a>                  <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('s')" href="../../../_variables/s.html">$s</a> = <a class="function" onClick="logFunction('get_param')" href="../../../_functions/get_param.html" onMouseOver="funcPopup(event,'get_param')">get_param</a>( 's' );
<a name="l859"><span class="linenum"> 859</span></a>              }
<a name="l860"><span class="linenum"> 860</span></a>              if( ! empty( <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('s')" href="../../../_variables/s.html">$s</a> ) &amp;&amp; ! empty( <a class="var it141" onMouseOver="hilite(141)" onMouseOut="lolite()" onClick="logVariable('blog_ID')" href="../../../_variables/blog_ID.html">$blog_ID</a> ) )
<a name="l861"><span class="linenum"> 861</span></a>              { // Record Internal Search:
<a name="l862"><span class="linenum"> 862</span></a>                  <a class="var it4677" onMouseOver="hilite(4677)" onMouseOut="lolite()" onClick="logVariable('keyphrase')" href="../../../_variables/keyphrase.html">$keyphrase</a>  = <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('s')" href="../../../_variables/s.html">$s</a>;
<a name="l863"><span class="linenum"> 863</span></a>              }
<a name="l864"><span class="linenum"> 864</span></a>          }
<a name="l865"><span class="linenum"> 865</span></a>  
<a name="l866"><span class="linenum"> 866</span></a>  <span class="comment">        // Extract the serprank from search referers:</span>
<a name="l867"><span class="linenum"> 867</span></a>          <a class="var it4679" onMouseOver="hilite(4679)" onMouseOut="lolite()" onClick="logVariable('serprank')" href="../../../_variables/serprank.html">$serprank</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_serprank')" href="../../../_functions/get_serprank.html" onMouseOver="funcPopup(event,'get_serprank')">get_serprank</a>();
<a name="l868"><span class="linenum"> 868</span></a>  
<a name="l869"><span class="linenum"> 869</span></a>          if( ! empty( <a class="var it613" onMouseOver="hilite(613)" onMouseOut="lolite()" onClick="logVariable('http_response_code')" href="../../../_variables/http_response_code.html">$http_response_code</a> ) )
<a name="l870"><span class="linenum"> 870</span></a>          { //  in some cases <a class="var it613" onMouseOver="hilite(613)" onMouseOut="lolite()" onClick="logVariable('http_response_code')" href="../../../_variables/http_response_code.html">$http_response_code</a> not set and we can use value by default
<a name="l871"><span class="linenum"> 871</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hit_response_code')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/hit_response_code.html">hit_response_code</a> = <a class="var it613" onMouseOver="hilite(613)" onMouseOut="lolite()" onClick="logVariable('http_response_code')" href="../../../_variables/http_response_code.html">$http_response_code</a>;
<a name="l872"><span class="linenum"> 872</span></a>          }
<a name="l873"><span class="linenum"> 873</span></a>  
<a name="l874"><span class="linenum"> 874</span></a>          if( empty( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hit_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/hit_type.html">hit_type</a> ) )
<a name="l875"><span class="linenum"> 875</span></a>          {
<a name="l876"><span class="linenum"> 876</span></a>              global <a class="var it47" onMouseOver="hilite(47)" onMouseOut="lolite()" onClick="logVariable('Skin')" href="../../../_variables/Skin.html">$Skin</a>;
<a name="l877"><span class="linenum"> 877</span></a>  
<a name="l878"><span class="linenum"> 878</span></a>              if( ( isset( <a class="var it47" onMouseOver="hilite(47)" onMouseOut="lolite()" onClick="logVariable('Skin')" href="../../../_variables/Skin.html">$Skin</a> ) &amp;&amp; <a class="var it47" onMouseOver="hilite(47)" onMouseOut="lolite()" onClick="logVariable('Skin')" href="../../../_variables/Skin.html">$Skin</a>-&gt;<a onClick="logVariable('type')" class="var it10676" onMouseOver="hilite(10676)" onMouseOut="lolite()" href="../../../_variables/type.html">type</a> == 'feed' ) || ! empty( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('test_rss')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/test_rss.html">test_rss</a> ) )
<a name="l879"><span class="linenum"> 879</span></a>              {
<a name="l880"><span class="linenum"> 880</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hit_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/hit_type.html">hit_type</a> = 'rss';
<a name="l881"><span class="linenum"> 881</span></a>              }
<a name="l882"><span class="linenum"> 882</span></a>              else
<a name="l883"><span class="linenum"> 883</span></a>              {
<a name="l884"><span class="linenum"> 884</span></a>                  if( isset( <a class="var it142" onMouseOver="hilite(142)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../../_variables/_SERVER.html">$_SERVER</a>['HTTP_X_REQUESTED_WITH'] ) &amp;&amp; ( <a class="phpfunction" onClick="logFunction('strtolower')" href="../../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>( <a class="var it142" onMouseOver="hilite(142)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../../_variables/_SERVER.html">$_SERVER</a>['HTTP_X_REQUESTED_WITH'] ) == 'xmlhttprequest' ) )
<a name="l885"><span class="linenum"> 885</span></a>                  {
<a name="l886"><span class="linenum"> 886</span></a>                      <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hit_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/hit_type.html">hit_type</a> = 'ajax';
<a name="l887"><span class="linenum"> 887</span></a>                  }
<a name="l888"><span class="linenum"> 888</span></a>                  else
<a name="l889"><span class="linenum"> 889</span></a>                  {
<a name="l890"><span class="linenum"> 890</span></a>                      <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hit_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/hit_type.html">hit_type</a> = 'standard';
<a name="l891"><span class="linenum"> 891</span></a>                  }
<a name="l892"><span class="linenum"> 892</span></a>              }
<a name="l893"><span class="linenum"> 893</span></a>          }
<a name="l894"><span class="linenum"> 894</span></a>  
<a name="l895"><span class="linenum"> 895</span></a>  <span class="comment">        // Insert a hit into DB table:</span>
<a name="l896"><span class="linenum"> 896</span></a>          <a class="var it4680" onMouseOver="hilite(4680)" onMouseOut="lolite()" onClick="logVariable('sql_insert_fields')" href="../../../_variables/sql_insert_fields.html">$sql_insert_fields</a> = array(
<a name="l897"><span class="linenum"> 897</span></a>                  'hit_datetime'          =&gt; 'FROM_UNIXTIME( '.<a class="var it317" onMouseOver="hilite(317)" onMouseOut="lolite()" onClick="logVariable('localtimenow')" href="../../../_variables/localtimenow.html">$localtimenow</a>.' )',
<a name="l898"><span class="linenum"> 898</span></a>                  'hit_uri'               =&gt; <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="var it4675" onMouseOver="hilite(4675)" onMouseOut="lolite()" onClick="logVariable('hit_uri')" href="../../../_variables/hit_uri.html">$hit_uri</a> ),
<a name="l899"><span class="linenum"> 899</span></a>                  'hit_disp'              =&gt; <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="var it45" onMouseOver="hilite(45)" onMouseOut="lolite()" onClick="logVariable('disp')" href="../../../_variables/disp.html">$disp</a> ),
<a name="l900"><span class="linenum"> 900</span></a>                  'hit_ctrl'              =&gt; <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="var it499" onMouseOver="hilite(499)" onMouseOut="lolite()" onClick="logVariable('ctrl')" href="../../../_variables/ctrl.html">$ctrl</a> ),
<a name="l901"><span class="linenum"> 901</span></a>                  'hit_action'            =&gt; <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('action')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/action.html">action</a> ),
<a name="l902"><span class="linenum"> 902</span></a>                  'hit_type'              =&gt; <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hit_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/hit_type.html">hit_type</a> ),
<a name="l903"><span class="linenum"> 903</span></a>                  'hit_referer_type'      =&gt; <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_type.html">referer_type</a> ),
<a name="l904"><span class="linenum"> 904</span></a>                  'hit_referer'           =&gt; <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="var it4676" onMouseOver="hilite(4676)" onMouseOut="lolite()" onClick="logVariable('hit_referer')" href="../../../_variables/hit_referer.html">$hit_referer</a> ),
<a name="l905"><span class="linenum"> 905</span></a>                  'hit_referer_dom_ID'    =&gt; <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_referer_domain_ID')" href="../../../_functions/get_referer_domain_id.html" onMouseOver="funcPopup(event,'get_referer_domain_id')">get_referer_domain_ID</a>() ),
<a name="l906"><span class="linenum"> 906</span></a>                  'hit_keyphrase_keyp_ID' =&gt; <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="var it4678" onMouseOver="hilite(4678)" onMouseOut="lolite()" onClick="logVariable('keyp_ID')" href="../../../_variables/keyp_ID.html">$keyp_ID</a> ),
<a name="l907"><span class="linenum"> 907</span></a>                  'hit_keyphrase'         =&gt; <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="var it4677" onMouseOver="hilite(4677)" onMouseOut="lolite()" onClick="logVariable('keyphrase')" href="../../../_variables/keyphrase.html">$keyphrase</a> ),
<a name="l908"><span class="linenum"> 908</span></a>                  'hit_serprank'          =&gt; <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="var it4679" onMouseOver="hilite(4679)" onMouseOut="lolite()" onClick="logVariable('serprank')" href="../../../_variables/serprank.html">$serprank</a> ),
<a name="l909"><span class="linenum"> 909</span></a>                  'hit_coll_ID'           =&gt; <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="var it141" onMouseOver="hilite(141)" onMouseOut="lolite()" onClick="logVariable('blog_ID')" href="../../../_variables/blog_ID.html">$blog_ID</a> ),
<a name="l910"><span class="linenum"> 910</span></a>                  'hit_remote_addr'       =&gt; <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('IP')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/IP.html">IP</a> ),
<a name="l911"><span class="linenum"> 911</span></a>                  'hit_agent_type'        =&gt; <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_agent_type')" href="../../../_functions/get_agent_type.html" onMouseOver="funcPopup(event,'get_agent_type')">get_agent_type</a>() ),
<a name="l912"><span class="linenum"> 912</span></a>                  'hit_agent_ID'          =&gt; <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_agent_ID')" href="../../../_functions/get_agent_id.html" onMouseOver="funcPopup(event,'get_agent_id')">get_agent_ID</a>() ),
<a name="l913"><span class="linenum"> 913</span></a>                  'hit_response_code'     =&gt; <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hit_response_code')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/hit_response_code.html">hit_response_code</a> )
<a name="l914"><span class="linenum"> 914</span></a>              );
<a name="l915"><span class="linenum"> 915</span></a>  
<a name="l916"><span class="linenum"> 916</span></a>          if( empty( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('test_mode')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/test_mode.html">test_mode</a> ) )
<a name="l917"><span class="linenum"> 917</span></a>          { // Normal mode
<a name="l918"><span class="linenum"> 918</span></a>              <a class="var it4680" onMouseOver="hilite(4680)" onMouseOut="lolite()" onClick="logVariable('sql_insert_fields')" href="../../../_variables/sql_insert_fields.html">$sql_insert_fields</a>['hit_sess_ID']  = <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="var it478" onMouseOver="hilite(478)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a onClick="logVariable('ID')" class="var it10685" onMouseOver="hilite(10685)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> );
<a name="l919"><span class="linenum"> 919</span></a>          }
<a name="l920"><span class="linenum"> 920</span></a>          else
<a name="l921"><span class="linenum"> 921</span></a>          { // Test mode
<a name="l922"><span class="linenum"> 922</span></a>              <a class="var it4680" onMouseOver="hilite(4680)" onMouseOut="lolite()" onClick="logVariable('sql_insert_fields')" href="../../../_variables/sql_insert_fields.html">$sql_insert_fields</a>['hit_sess_ID']  = <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('session_id')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/session_id.html">session_id</a> );
<a name="l923"><span class="linenum"> 923</span></a>              <a class="var it4680" onMouseOver="hilite(4680)" onMouseOut="lolite()" onClick="logVariable('sql_insert_fields')" href="../../../_variables/sql_insert_fields.html">$sql_insert_fields</a>['hit_datetime'] = 'FROM_UNIXTIME( '.<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hit_time')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/hit_time.html">hit_time</a>.' )';
<a name="l924"><span class="linenum"> 924</span></a>              <a class="var it4680" onMouseOver="hilite(4680)" onMouseOut="lolite()" onClick="logVariable('sql_insert_fields')" href="../../../_variables/sql_insert_fields.html">$sql_insert_fields</a>['hit_disp']     = <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( isset( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('test_uri')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/test_uri.html">test_uri</a>['disp'] ) ? <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('test_uri')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/test_uri.html">test_uri</a>['disp'] : NULL );
<a name="l925"><span class="linenum"> 925</span></a>              <a class="var it4680" onMouseOver="hilite(4680)" onMouseOut="lolite()" onClick="logVariable('sql_insert_fields')" href="../../../_variables/sql_insert_fields.html">$sql_insert_fields</a>['hit_ctrl']     = <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( isset( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('test_uri')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/test_uri.html">test_uri</a>['ctrl'] ) ? <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('test_uri')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/test_uri.html">test_uri</a>['ctrl'] : NULL );
<a name="l926"><span class="linenum"> 926</span></a>              <a class="var it4680" onMouseOver="hilite(4680)" onMouseOut="lolite()" onClick="logVariable('sql_insert_fields')" href="../../../_variables/sql_insert_fields.html">$sql_insert_fields</a>['hit_action']   = 'NULL';
<a name="l927"><span class="linenum"> 927</span></a>          }
<a name="l928"><span class="linenum"> 928</span></a>  
<a name="l929"><span class="linenum"> 929</span></a>          <a class="var it344" onMouseOver="hilite(344)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../_variables/sql.html">$sql</a> = <a class="var it4674" onMouseOver="hilite(4674)" onMouseOut="lolite()" onClick="logVariable('delayed')" href="../../../_variables/delayed.html">$delayed</a> ? 'INSERT DELAYED INTO' : 'INSERT INTO';
<a name="l930"><span class="linenum"> 930</span></a>          <a class="var it344" onMouseOver="hilite(344)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../_variables/sql.html">$sql</a> = <a class="var it344" onMouseOver="hilite(344)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../_variables/sql.html">$sql</a>.' T_hitlog ( '.<a class="phpfunction" onClick="logFunction('implode')" href="../../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( ', ', <a class="phpfunction" onClick="logFunction('array_keys')" href="../../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>( <a class="var it4680" onMouseOver="hilite(4680)" onMouseOut="lolite()" onClick="logVariable('sql_insert_fields')" href="../../../_variables/sql_insert_fields.html">$sql_insert_fields</a> ) ).' )'.
<a name="l931"><span class="linenum"> 931</span></a>                              ' VALUES ( '.<a class="phpfunction" onClick="logFunction('implode')" href="../../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( ', ', <a class="var it4680" onMouseOver="hilite(4680)" onMouseOut="lolite()" onClick="logVariable('sql_insert_fields')" href="../../../_variables/sql_insert_fields.html">$sql_insert_fields</a> ).' )';
<a name="l932"><span class="linenum"> 932</span></a>  
<a name="l933"><span class="linenum"> 933</span></a>          <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( <a class="var it344" onMouseOver="hilite(344)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../_variables/sql.html">$sql</a>, 'Record the hit' );
<a name="l934"><span class="linenum"> 934</span></a>          <a class="var it4681" onMouseOver="hilite(4681)" onMouseOut="lolite()" onClick="logVariable('hit_ID')" href="../../../_variables/hit_ID.html">$hit_ID</a> = <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('insert_id')" class="var it10754" onMouseOver="hilite(10754)" onMouseOut="lolite()" href="../../../_variables/insert_id.html">insert_id</a>;
<a name="l935"><span class="linenum"> 935</span></a>  
<a name="l936"><span class="linenum"> 936</span></a>          if( ! empty( <a class="var it4677" onMouseOver="hilite(4677)" onMouseOut="lolite()" onClick="logVariable('keyphrase')" href="../../../_variables/keyphrase.html">$keyphrase</a> ) )
<a name="l937"><span class="linenum"> 937</span></a>          {
<a name="l938"><span class="linenum"> 938</span></a>              <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('commit')" href="../../../_functions/commit.html" onMouseOver="funcPopup(event,'commit')">commit</a>();
<a name="l939"><span class="linenum"> 939</span></a>          }
<a name="l940"><span class="linenum"> 940</span></a>  
<a name="l941"><span class="linenum"> 941</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('ID')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a> = <a class="var it4681" onMouseOver="hilite(4681)" onMouseOut="lolite()" onClick="logVariable('hit_ID')" href="../../../_variables/hit_ID.html">$hit_ID</a>;
<a name="l942"><span class="linenum"> 942</span></a>      }
<a name="l943"><span class="linenum"> 943</span></a>  
<a name="l944"><span class="linenum"> 944</span></a>  
<a name="l945"><span class="linenum"> 945</span></a>      <span class="comment">/**</span>
<a name="l946"><span class="linenum"> 946</span></a>  <span class="comment">     * Get hit type from the uri</span>
<a name="l947"><span class="linenum"> 947</span></a>  <span class="comment">     * @return mixed Hit type</span>
<a name="l948"><span class="linenum"> 948</span></a>  <span class="comment">     */</span>
<a name="l949"><span class="linenum"> 949</span></a>  	function <a class="function" onClick="logFunction('get_hit_type')" href="../../../_functions/get_hit_type.html" onMouseOver="funcPopup(event,'get_hit_type')">get_hit_type</a>()
<a name="l950"><span class="linenum"> 950</span></a>      {
<a name="l951"><span class="linenum"> 951</span></a>          global <a class="var it477" onMouseOver="hilite(477)" onMouseOut="lolite()" onClick="logVariable('ReqURI')" href="../../../_variables/ReqURI.html">$ReqURI</a>;
<a name="l952"><span class="linenum"> 952</span></a>          if( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hit_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/hit_type.html">hit_type</a> )
<a name="l953"><span class="linenum"> 953</span></a>          {
<a name="l954"><span class="linenum"> 954</span></a>              return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hit_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/hit_type.html">hit_type</a>;
<a name="l955"><span class="linenum"> 955</span></a>          }
<a name="l956"><span class="linenum"> 956</span></a>  
<a name="l957"><span class="linenum"> 957</span></a>          <a class="var it4682" onMouseOver="hilite(4682)" onMouseOut="lolite()" onClick="logVariable('ajax_array')" href="../../../_variables/ajax_array.html">$ajax_array</a> = array('<a class="filename" href="../../../htsrv/async.php.html">htsrv/async.php</a>', '<a class="filename" href="../../../htsrv/anon_async.php.html">htsrv/anon_async.php</a>');
<a name="l958"><span class="linenum"> 958</span></a>  
<a name="l959"><span class="linenum"> 959</span></a>          foreach (<a class="var it4682" onMouseOver="hilite(4682)" onMouseOut="lolite()" onClick="logVariable('ajax_array')" href="../../../_variables/ajax_array.html">$ajax_array</a> as <a class="var it4683" onMouseOver="hilite(4683)" onMouseOut="lolite()" onClick="logVariable('ajax')" href="../../../_variables/ajax.html">$ajax</a>)
<a name="l960"><span class="linenum"> 960</span></a>          {
<a name="l961"><span class="linenum"> 961</span></a>              if (<a class="phpfunction" onClick="logFunction('strstr')" href="../../../_functions/strstr.html" onMouseOver="phpfuncPopup(event,'strstr')">strstr</a>(<a class="var it477" onMouseOver="hilite(477)" onMouseOut="lolite()" onClick="logVariable('ReqURI')" href="../../../_variables/ReqURI.html">$ReqURI</a>,<a class="var it4683" onMouseOver="hilite(4683)" onMouseOut="lolite()" onClick="logVariable('ajax')" href="../../../_variables/ajax.html">$ajax</a>))
<a name="l962"><span class="linenum"> 962</span></a>              {
<a name="l963"><span class="linenum"> 963</span></a>                  return 'ajax';
<a name="l964"><span class="linenum"> 964</span></a>              }
<a name="l965"><span class="linenum"> 965</span></a>          }
<a name="l966"><span class="linenum"> 966</span></a>  
<a name="l967"><span class="linenum"> 967</span></a>          if (<a class="phpfunction" onClick="logFunction('strstr')" href="../../../_functions/strstr.html" onMouseOver="phpfuncPopup(event,'strstr')">strstr</a>(<a class="var it477" onMouseOver="hilite(477)" onMouseOut="lolite()" onClick="logVariable('ReqURI')" href="../../../_variables/ReqURI.html">$ReqURI</a>,'htsrv/'))
<a name="l968"><span class="linenum"> 968</span></a>          {
<a name="l969"><span class="linenum"> 969</span></a>              return 'service';
<a name="l970"><span class="linenum"> 970</span></a>          }
<a name="l971"><span class="linenum"> 971</span></a>          else
<a name="l972"><span class="linenum"> 972</span></a>          {
<a name="l973"><span class="linenum"> 973</span></a>              return NULL;
<a name="l974"><span class="linenum"> 974</span></a>          }
<a name="l975"><span class="linenum"> 975</span></a>      }
<a name="l976"><span class="linenum"> 976</span></a>  
<a name="l977"><span class="linenum"> 977</span></a>      <span class="comment">/**</span>
<a name="l978"><span class="linenum"> 978</span></a>  <span class="comment">     * Get hit action</span>
<a name="l979"><span class="linenum"> 979</span></a>  <span class="comment">     * @return mixed Hit action</span>
<a name="l980"><span class="linenum"> 980</span></a>  <span class="comment">     */</span>
<a name="l981"><span class="linenum"> 981</span></a>  	function <a class="function" onClick="logFunction('get_action')" href="../../../_functions/get_action.html" onMouseOver="funcPopup(event,'get_action')">get_action</a>()
<a name="l982"><span class="linenum"> 982</span></a>      {
<a name="l983"><span class="linenum"> 983</span></a>          global <a class="var it477" onMouseOver="hilite(477)" onMouseOut="lolite()" onClick="logVariable('ReqURI')" href="../../../_variables/ReqURI.html">$ReqURI</a>, <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a>;
<a name="l984"><span class="linenum"> 984</span></a>          if( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('action')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/action.html">action</a> )
<a name="l985"><span class="linenum"> 985</span></a>          {
<a name="l986"><span class="linenum"> 986</span></a>              return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('action')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/action.html">action</a>;
<a name="l987"><span class="linenum"> 987</span></a>          }
<a name="l988"><span class="linenum"> 988</span></a>  
<a name="l989"><span class="linenum"> 989</span></a>          if (<a class="phpfunction" onClick="logFunction('strstr')" href="../../../_functions/strstr.html" onMouseOver="phpfuncPopup(event,'strstr')">strstr</a>(<a class="var it477" onMouseOver="hilite(477)" onMouseOut="lolite()" onClick="logVariable('ReqURI')" href="../../../_variables/ReqURI.html">$ReqURI</a>,'<a class="filename" href="../../../htsrv/getfile.php.html">htsrv/getfile.php</a>'))
<a name="l990"><span class="linenum"> 990</span></a>          { // special case
<a name="l991"><span class="linenum"> 991</span></a>              return 'getfile';
<a name="l992"><span class="linenum"> 992</span></a>          }
<a name="l993"><span class="linenum"> 993</span></a>          if (!empty (<a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a>))
<a name="l994"><span class="linenum"> 994</span></a>          {
<a name="l995"><span class="linenum"> 995</span></a>              return <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../../_variables/action.html">$action</a>;
<a name="l996"><span class="linenum"> 996</span></a>          }
<a name="l997"><span class="linenum"> 997</span></a>          else
<a name="l998"><span class="linenum"> 998</span></a>          {
<a name="l999"><span class="linenum"> 999</span></a>              return NULL;
<a name="l1000"><span class="linenum">1000</span></a>          }
<a name="l1001"><span class="linenum">1001</span></a>      }
<a name="l1002"><span class="linenum">1002</span></a>  
<a name="l1003"><span class="linenum">1003</span></a>  
<a name="l1004"><span class="linenum">1004</span></a>  
<a name="l1005"><span class="linenum">1005</span></a>      <span class="comment">/**</span>
<a name="l1006"><span class="linenum">1006</span></a>  <span class="comment">     * Get the keyphrase from the referer</span>
<a name="l1007"><span class="linenum">1007</span></a>  <span class="comment">     */</span>
<a name="l1008"><span class="linenum">1008</span></a>  	function <a class="function" onClick="logFunction('get_keyphrase')" href="../../../_functions/get_keyphrase.html" onMouseOver="funcPopup(event,'get_keyphrase')">get_keyphrase</a>()
<a name="l1009"><span class="linenum">1009</span></a>      {
<a name="l1010"><span class="linenum">1010</span></a>          if( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_search_params_tried')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_search_params_tried.html">_search_params_tried</a> )
<a name="l1011"><span class="linenum">1011</span></a>          {
<a name="l1012"><span class="linenum">1012</span></a>              return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_keyphrase')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_keyphrase.html">_keyphrase</a>;
<a name="l1013"><span class="linenum">1013</span></a>          }
<a name="l1014"><span class="linenum">1014</span></a>  
<a name="l1015"><span class="linenum">1015</span></a>          if( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_type.html">referer_type</a> == 'search' )
<a name="l1016"><span class="linenum">1016</span></a>          {
<a name="l1017"><span class="linenum">1017</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('extract_params_from_referer')" href="../../../_functions/extract_params_from_referer.html" onMouseOver="funcPopup(event,'extract_params_from_referer')">extract_params_from_referer</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer.html">referer</a> );
<a name="l1018"><span class="linenum">1018</span></a>          }
<a name="l1019"><span class="linenum">1019</span></a>  
<a name="l1020"><span class="linenum">1020</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_keyphrase')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_keyphrase.html">_keyphrase</a>;
<a name="l1021"><span class="linenum">1021</span></a>      }
<a name="l1022"><span class="linenum">1022</span></a>  
<a name="l1023"><span class="linenum">1023</span></a>  
<a name="l1024"><span class="linenum">1024</span></a>      <span class="comment">/**</span>
<a name="l1025"><span class="linenum">1025</span></a>  <span class="comment">     * Get the serprank from the referer</span>
<a name="l1026"><span class="linenum">1026</span></a>  <span class="comment">     */</span>
<a name="l1027"><span class="linenum">1027</span></a>  	function <a class="function" onClick="logFunction('get_serprank')" href="../../../_functions/get_serprank.html" onMouseOver="funcPopup(event,'get_serprank')">get_serprank</a>()
<a name="l1028"><span class="linenum">1028</span></a>      {
<a name="l1029"><span class="linenum">1029</span></a>          if( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_search_params_tried')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_search_params_tried.html">_search_params_tried</a> )
<a name="l1030"><span class="linenum">1030</span></a>          {
<a name="l1031"><span class="linenum">1031</span></a>              return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_serprank')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_serprank.html">_serprank</a>;
<a name="l1032"><span class="linenum">1032</span></a>          }
<a name="l1033"><span class="linenum">1033</span></a>  
<a name="l1034"><span class="linenum">1034</span></a>          if( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_type.html">referer_type</a> == 'search' )
<a name="l1035"><span class="linenum">1035</span></a>          {
<a name="l1036"><span class="linenum">1036</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('extract_params_from_referer')" href="../../../_functions/extract_params_from_referer.html" onMouseOver="funcPopup(event,'extract_params_from_referer')">extract_params_from_referer</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer.html">referer</a> );
<a name="l1037"><span class="linenum">1037</span></a>          }
<a name="l1038"><span class="linenum">1038</span></a>  
<a name="l1039"><span class="linenum">1039</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_serprank')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_serprank.html">_serprank</a>;
<a name="l1040"><span class="linenum">1040</span></a>      }
<a name="l1041"><span class="linenum">1041</span></a>  
<a name="l1042"><span class="linenum">1042</span></a>  
<a name="l1043"><span class="linenum">1043</span></a>      <span class="comment">/**</span>
<a name="l1044"><span class="linenum">1044</span></a>  <span class="comment">     * Get name of search engine</span>
<a name="l1045"><span class="linenum">1045</span></a>  <span class="comment">     */</span>
<a name="l1046"><span class="linenum">1046</span></a>  	function <a class="function" onClick="logFunction('get_search_engine')" href="../../../_functions/get_search_engine.html" onMouseOver="funcPopup(event,'get_search_engine')">get_search_engine</a>()
<a name="l1047"><span class="linenum">1047</span></a>      {
<a name="l1048"><span class="linenum">1048</span></a>          if( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_search_params_tried')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_search_params_tried.html">_search_params_tried</a> )
<a name="l1049"><span class="linenum">1049</span></a>          {
<a name="l1050"><span class="linenum">1050</span></a>              return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_search_engine')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_search_engine.html">_search_engine</a>;
<a name="l1051"><span class="linenum">1051</span></a>          }
<a name="l1052"><span class="linenum">1052</span></a>  
<a name="l1053"><span class="linenum">1053</span></a>          if( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_type.html">referer_type</a> == 'search' )
<a name="l1054"><span class="linenum">1054</span></a>          {
<a name="l1055"><span class="linenum">1055</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('extract_params_from_referer')" href="../../../_functions/extract_params_from_referer.html" onMouseOver="funcPopup(event,'extract_params_from_referer')">extract_params_from_referer</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer.html">referer</a> );
<a name="l1056"><span class="linenum">1056</span></a>          }
<a name="l1057"><span class="linenum">1057</span></a>  
<a name="l1058"><span class="linenum">1058</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_search_engine')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_search_engine.html">_search_engine</a>;
<a name="l1059"><span class="linenum">1059</span></a>      }
<a name="l1060"><span class="linenum">1060</span></a>  
<a name="l1061"><span class="linenum">1061</span></a>  
<a name="l1062"><span class="linenum">1062</span></a>      <span class="comment">/**</span>
<a name="l1063"><span class="linenum">1063</span></a>  <span class="comment">     * Get the User agent's signature.</span>
<a name="l1064"><span class="linenum">1064</span></a>  <span class="comment">     *</span>
<a name="l1065"><span class="linenum">1065</span></a>  <span class="comment">     * @return string False, if not provided or empty, if it included tags.</span>
<a name="l1066"><span class="linenum">1066</span></a>  <span class="comment">     */</span>
<a name="l1067"><span class="linenum">1067</span></a>  	function <a class="function" onClick="logFunction('get_user_agent')" href="../../../_functions/get_user_agent.html" onMouseOver="funcPopup(event,'get_user_agent')">get_user_agent</a>()
<a name="l1068"><span class="linenum">1068</span></a>      {
<a name="l1069"><span class="linenum">1069</span></a>          if( ! isset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('user_agent')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/user_agent.html">user_agent</a>) )
<a name="l1070"><span class="linenum">1070</span></a>          {
<a name="l1071"><span class="linenum">1071</span></a>              global <a class="var it4684" onMouseOver="hilite(4684)" onMouseOut="lolite()" onClick="logVariable('HTTP_USER_AGENT')" href="../../../_variables/HTTP_USER_AGENT.html">$HTTP_USER_AGENT</a>; <span class="comment">// might be set by PHP, give highest priority</span>
<a name="l1072"><span class="linenum">1072</span></a>  
<a name="l1073"><span class="linenum">1073</span></a>              if( isset(<a class="var it4684" onMouseOver="hilite(4684)" onMouseOut="lolite()" onClick="logVariable('HTTP_USER_AGENT')" href="../../../_variables/HTTP_USER_AGENT.html">$HTTP_USER_AGENT</a>) )
<a name="l1074"><span class="linenum">1074</span></a>              {
<a name="l1075"><span class="linenum">1075</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('user_agent')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/user_agent.html">user_agent</a> = <a class="var it4684" onMouseOver="hilite(4684)" onMouseOut="lolite()" onClick="logVariable('HTTP_USER_AGENT')" href="../../../_variables/HTTP_USER_AGENT.html">$HTTP_USER_AGENT</a>;
<a name="l1076"><span class="linenum">1076</span></a>              }
<a name="l1077"><span class="linenum">1077</span></a>              elseif( isset(<a class="var it142" onMouseOver="hilite(142)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../../_variables/_SERVER.html">$_SERVER</a>['HTTP_USER_AGENT']) )
<a name="l1078"><span class="linenum">1078</span></a>              {
<a name="l1079"><span class="linenum">1079</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('user_agent')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/user_agent.html">user_agent</a> = <a class="var it142" onMouseOver="hilite(142)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../../_variables/_SERVER.html">$_SERVER</a>['HTTP_USER_AGENT'];
<a name="l1080"><span class="linenum">1080</span></a>              }
<a name="l1081"><span class="linenum">1081</span></a>              else
<a name="l1082"><span class="linenum">1082</span></a>              {
<a name="l1083"><span class="linenum">1083</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('user_agent')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/user_agent.html">user_agent</a> = false;
<a name="l1084"><span class="linenum">1084</span></a>              }
<a name="l1085"><span class="linenum">1085</span></a>  
<a name="l1086"><span class="linenum">1086</span></a>              if( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('user_agent')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/user_agent.html">user_agent</a> != <a class="phpfunction" onClick="logFunction('strip_tags')" href="../../../_functions/strip_tags.html" onMouseOver="phpfuncPopup(event,'strip_tags')">strip_tags</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('user_agent')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/user_agent.html">user_agent</a>) )
<a name="l1087"><span class="linenum">1087</span></a>              { // then they have tried something funky, putting HTML or PHP into the user agent
<a name="l1088"><span class="linenum">1088</span></a>                  global <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>;
<a name="l1089"><span class="linenum">1089</span></a>                  <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit: <a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>(): '.<a class="function" onClick="logFunction('T_')" href="../../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('bad char in User Agent'), 'hit');
<a name="l1090"><span class="linenum">1090</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('user_agent')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/user_agent.html">user_agent</a> = '';
<a name="l1091"><span class="linenum">1091</span></a>              }
<a name="l1092"><span class="linenum">1092</span></a>              else
<a name="l1093"><span class="linenum">1093</span></a>              {
<a name="l1094"><span class="linenum">1094</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('user_agent')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/user_agent.html">user_agent</a> = <a class="phpfunction" onClick="logFunction('substr')" href="../../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('user_agent')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/user_agent.html">user_agent</a>, 0, 250 );
<a name="l1095"><span class="linenum">1095</span></a>              }
<a name="l1096"><span class="linenum">1096</span></a>          }
<a name="l1097"><span class="linenum">1097</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('user_agent')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/user_agent.html">user_agent</a>;
<a name="l1098"><span class="linenum">1098</span></a>      }
<a name="l1099"><span class="linenum">1099</span></a>  
<a name="l1100"><span class="linenum">1100</span></a>  
<a name="l1101"><span class="linenum">1101</span></a>      <span class="comment">/**</span>
<a name="l1102"><span class="linenum">1102</span></a>  <span class="comment">     * Get the User agent's ID.</span>
<a name="l1103"><span class="linenum">1103</span></a>  <span class="comment">     *</span>
<a name="l1104"><span class="linenum">1104</span></a>  <span class="comment">     * @return integer</span>
<a name="l1105"><span class="linenum">1105</span></a>  <span class="comment">     */</span>
<a name="l1106"><span class="linenum">1106</span></a>  	function <a class="function" onClick="logFunction('get_agent_ID')" href="../../../_functions/get_agent_id.html" onMouseOver="funcPopup(event,'get_agent_id')">get_agent_ID</a>()
<a name="l1107"><span class="linenum">1107</span></a>      {
<a name="l1108"><span class="linenum">1108</span></a>          if( ! isset( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_ID')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_ID.html">agent_ID</a> ) )
<a name="l1109"><span class="linenum">1109</span></a>          {
<a name="l1110"><span class="linenum">1110</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>();
<a name="l1111"><span class="linenum">1111</span></a>          }
<a name="l1112"><span class="linenum">1112</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_ID')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_ID.html">agent_ID</a>;
<a name="l1113"><span class="linenum">1113</span></a>      }
<a name="l1114"><span class="linenum">1114</span></a>  
<a name="l1115"><span class="linenum">1115</span></a>  
<a name="l1116"><span class="linenum">1116</span></a>      <span class="comment">/**</span>
<a name="l1117"><span class="linenum">1117</span></a>  <span class="comment">     * Get the User agent's name.</span>
<a name="l1118"><span class="linenum">1118</span></a>  <span class="comment">     *</span>
<a name="l1119"><span class="linenum">1119</span></a>  <span class="comment">     * @return string</span>
<a name="l1120"><span class="linenum">1120</span></a>  <span class="comment">     */</span>
<a name="l1121"><span class="linenum">1121</span></a>  	function <a class="function" onClick="logFunction('get_agent_name')" href="../../../_functions/get_agent_name.html" onMouseOver="funcPopup(event,'get_agent_name')">get_agent_name</a>()
<a name="l1122"><span class="linenum">1122</span></a>      {
<a name="l1123"><span class="linenum">1123</span></a>          if( ! isset( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_name')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_name.html">agent_name</a> ) )
<a name="l1124"><span class="linenum">1124</span></a>          {
<a name="l1125"><span class="linenum">1125</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>();
<a name="l1126"><span class="linenum">1126</span></a>          }
<a name="l1127"><span class="linenum">1127</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_name')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_name.html">agent_name</a>;
<a name="l1128"><span class="linenum">1128</span></a>      }
<a name="l1129"><span class="linenum">1129</span></a>  
<a name="l1130"><span class="linenum">1130</span></a>  
<a name="l1131"><span class="linenum">1131</span></a>      <span class="comment">/**</span>
<a name="l1132"><span class="linenum">1132</span></a>  <span class="comment">     * Get the User agent's platform.</span>
<a name="l1133"><span class="linenum">1133</span></a>  <span class="comment">     *</span>
<a name="l1134"><span class="linenum">1134</span></a>  <span class="comment">     * @return string</span>
<a name="l1135"><span class="linenum">1135</span></a>  <span class="comment">     */</span>
<a name="l1136"><span class="linenum">1136</span></a>  	function <a class="function" onClick="logFunction('get_agent_platform')" href="../../../_functions/get_agent_platform.html" onMouseOver="funcPopup(event,'get_agent_platform')">get_agent_platform</a>()
<a name="l1137"><span class="linenum">1137</span></a>      {
<a name="l1138"><span class="linenum">1138</span></a>          if( ! isset( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_platform')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_platform.html">agent_platform</a> ) )
<a name="l1139"><span class="linenum">1139</span></a>          {
<a name="l1140"><span class="linenum">1140</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>();
<a name="l1141"><span class="linenum">1141</span></a>          }
<a name="l1142"><span class="linenum">1142</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_platform')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_platform.html">agent_platform</a>;
<a name="l1143"><span class="linenum">1143</span></a>      }
<a name="l1144"><span class="linenum">1144</span></a>  
<a name="l1145"><span class="linenum">1145</span></a>  
<a name="l1146"><span class="linenum">1146</span></a>      <span class="comment">/**</span>
<a name="l1147"><span class="linenum">1147</span></a>  <span class="comment">     * Get the User agent's type.</span>
<a name="l1148"><span class="linenum">1148</span></a>  <span class="comment">     *</span>
<a name="l1149"><span class="linenum">1149</span></a>  <span class="comment">     * @return string</span>
<a name="l1150"><span class="linenum">1150</span></a>  <span class="comment">     */</span>
<a name="l1151"><span class="linenum">1151</span></a>  	function <a class="function" onClick="logFunction('get_agent_type')" href="../../../_functions/get_agent_type.html" onMouseOver="funcPopup(event,'get_agent_type')">get_agent_type</a>()
<a name="l1152"><span class="linenum">1152</span></a>      {
<a name="l1153"><span class="linenum">1153</span></a>          if( ! isset( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_type.html">agent_type</a> ) )
<a name="l1154"><span class="linenum">1154</span></a>          {
<a name="l1155"><span class="linenum">1155</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>();
<a name="l1156"><span class="linenum">1156</span></a>          }
<a name="l1157"><span class="linenum">1157</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('agent_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/agent_type.html">agent_type</a>;
<a name="l1158"><span class="linenum">1158</span></a>      }
<a name="l1159"><span class="linenum">1159</span></a>  
<a name="l1160"><span class="linenum">1160</span></a>  
<a name="l1161"><span class="linenum">1161</span></a>      <span class="comment">/**</span>
<a name="l1162"><span class="linenum">1162</span></a>  <span class="comment">     * Get the remote hostname.</span>
<a name="l1163"><span class="linenum">1163</span></a>  <span class="comment">     *</span>
<a name="l1164"><span class="linenum">1164</span></a>  <span class="comment">     * @return string</span>
<a name="l1165"><span class="linenum">1165</span></a>  <span class="comment">     */</span>
<a name="l1166"><span class="linenum">1166</span></a>  	function <a class="function" onClick="logFunction('get_remote_host')" href="../../../_functions/get_remote_host.html" onMouseOver="funcPopup(event,'get_remote_host')">get_remote_host</a>( <a class="var it4685" onMouseOver="hilite(4685)" onMouseOut="lolite()" onClick="logVariable('allow_nslookup')" href="../../../_variables/allow_nslookup.html">$allow_nslookup</a> = false )
<a name="l1167"><span class="linenum">1167</span></a>      {
<a name="l1168"><span class="linenum">1168</span></a>          global <a class="var it610" onMouseOver="hilite(610)" onMouseOut="lolite()" onClick="logVariable('Timer')" href="../../../_variables/Timer.html">$Timer</a>;
<a name="l1169"><span class="linenum">1169</span></a>  
<a name="l1170"><span class="linenum">1170</span></a>          <a class="var it610" onMouseOver="hilite(610)" onMouseOut="lolite()" onClick="logVariable('Timer')" href="../../../_variables/Timer.html">$Timer</a>-&gt;<a class="function" onClick="logFunction('resume')" href="../../../_functions/resume.html" onMouseOver="funcPopup(event,'resume')">resume</a>( '<a class="class" onClick="logClass('Hit')" href="../../../_classes/hit.html" onMouseOver="classPopup(event,'hit')">Hit</a>::get_remote_host' );
<a name="l1171"><span class="linenum">1171</span></a>  
<a name="l1172"><span class="linenum">1172</span></a>          if( <a class="phpfunction" onClick="logFunction('is_null')" href="../../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_remoteHost')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_remoteHost.html">_remoteHost</a>) )
<a name="l1173"><span class="linenum">1173</span></a>          {
<a name="l1174"><span class="linenum">1174</span></a>              if( isset( <a class="var it142" onMouseOver="hilite(142)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../../_variables/_SERVER.html">$_SERVER</a>['REMOTE_HOST'] ) )
<a name="l1175"><span class="linenum">1175</span></a>              {
<a name="l1176"><span class="linenum">1176</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_remoteHost')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_remoteHost.html">_remoteHost</a> = <a class="var it142" onMouseOver="hilite(142)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../../_variables/_SERVER.html">$_SERVER</a>['REMOTE_HOST'];
<a name="l1177"><span class="linenum">1177</span></a>              }
<a name="l1178"><span class="linenum">1178</span></a>              elseif( <a class="var it4685" onMouseOver="hilite(4685)" onMouseOut="lolite()" onClick="logVariable('allow_nslookup')" href="../../../_variables/allow_nslookup.html">$allow_nslookup</a> )
<a name="l1179"><span class="linenum">1179</span></a>              { // We allowed reverse DNS lookup:
<a name="l1180"><span class="linenum">1180</span></a>  <span class="comment">                // This can be terribly time consuming (4/5 seconds!) when there is no reverse dns available!</span>
<a name="l1181"><span class="linenum">1181</span></a>  <span class="comment">                // This is the case on many intranets and many users' first time installs!!!</span>
<a name="l1182"><span class="linenum">1182</span></a>  <span class="comment">                // Some people end up considering evocore is very slow just because of this line!</span>
<a name="l1183"><span class="linenum">1183</span></a>  <span class="comment">                // This cannot be enabled by default.</span>
<a name="l1184"><span class="linenum">1184</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_remoteHost')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_remoteHost.html">_remoteHost</a> = @<a class="phpfunction" onClick="logFunction('gethostbyaddr')" href="../../../_functions/gethostbyaddr.html" onMouseOver="phpfuncPopup(event,'gethostbyaddr')">gethostbyaddr</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('IP')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/IP.html">IP</a>);
<a name="l1185"><span class="linenum">1185</span></a>              }
<a name="l1186"><span class="linenum">1186</span></a>              else
<a name="l1187"><span class="linenum">1187</span></a>              {
<a name="l1188"><span class="linenum">1188</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_remoteHost')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_remoteHost.html">_remoteHost</a> = '';
<a name="l1189"><span class="linenum">1189</span></a>              }
<a name="l1190"><span class="linenum">1190</span></a>          }
<a name="l1191"><span class="linenum">1191</span></a>  
<a name="l1192"><span class="linenum">1192</span></a>          <a class="var it610" onMouseOver="hilite(610)" onMouseOut="lolite()" onClick="logVariable('Timer')" href="../../../_variables/Timer.html">$Timer</a>-&gt;<a class="function" onClick="logFunction('pause')" href="../../../_functions/pause.html" onMouseOver="funcPopup(event,'pause')">pause</a>( '<a class="class" onClick="logClass('Hit')" href="../../../_classes/hit.html" onMouseOver="classPopup(event,'hit')">Hit</a>::get_remote_host' );
<a name="l1193"><span class="linenum">1193</span></a>  
<a name="l1194"><span class="linenum">1194</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_remoteHost')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_remoteHost.html">_remoteHost</a>;
<a name="l1195"><span class="linenum">1195</span></a>      }
<a name="l1196"><span class="linenum">1196</span></a>  
<a name="l1197"><span class="linenum">1197</span></a>  
<a name="l1198"><span class="linenum">1198</span></a>  	function <a class="function" onClick="logFunction('get_param_from_string')" href="../../../_functions/get_param_from_string.html" onMouseOver="funcPopup(event,'get_param_from_string')">get_param_from_string</a>( <a class="var it85" onMouseOver="hilite(85)" onMouseOut="lolite()" onClick="logVariable('string')" href="../../../_variables/string.html">$string</a>, <a class="var it307" onMouseOver="hilite(307)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../../_variables/param.html">$param</a> )
<a name="l1199"><span class="linenum">1199</span></a>      {
<a name="l1200"><span class="linenum">1200</span></a>  <span class="comment">        // Make sure the string does not start with &quot;?&quot;, otherwise parse_str adds the question mark to the first param</span>
<a name="l1201"><span class="linenum">1201</span></a>          <a class="var it85" onMouseOver="hilite(85)" onMouseOut="lolite()" onClick="logVariable('string')" href="../../../_variables/string.html">$string</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>( '~^\?~', '', <a class="var it85" onMouseOver="hilite(85)" onMouseOut="lolite()" onClick="logVariable('string')" href="../../../_variables/string.html">$string</a> );
<a name="l1202"><span class="linenum">1202</span></a>  
<a name="l1203"><span class="linenum">1203</span></a>          <a class="phpfunction" onClick="logFunction('parse_str')" href="../../../_functions/parse_str.html" onMouseOver="phpfuncPopup(event,'parse_str')">parse_str</a>(<a class="var it85" onMouseOver="hilite(85)" onMouseOut="lolite()" onClick="logVariable('string')" href="../../../_variables/string.html">$string</a>, <a class="var it940" onMouseOver="hilite(940)" onMouseOut="lolite()" onClick="logVariable('array')" href="../../../_variables/array.html">$array</a>);
<a name="l1204"><span class="linenum">1204</span></a>  
<a name="l1205"><span class="linenum">1205</span></a>          <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../_variables/value.html">$value</a> = NULL;
<a name="l1206"><span class="linenum">1206</span></a>          if( isset(<a class="var it940" onMouseOver="hilite(940)" onMouseOut="lolite()" onClick="logVariable('array')" href="../../../_variables/array.html">$array</a>[<a class="var it307" onMouseOver="hilite(307)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../../_variables/param.html">$param</a>]) &amp;&amp; <a class="phpfunction" onClick="logFunction('trim')" href="../../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="var it940" onMouseOver="hilite(940)" onMouseOut="lolite()" onClick="logVariable('array')" href="../../../_variables/array.html">$array</a>[<a class="var it307" onMouseOver="hilite(307)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../../_variables/param.html">$param</a>]) != '' )
<a name="l1207"><span class="linenum">1207</span></a>          {
<a name="l1208"><span class="linenum">1208</span></a>              <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../_variables/value.html">$value</a> = <a class="var it940" onMouseOver="hilite(940)" onMouseOut="lolite()" onClick="logVariable('array')" href="../../../_variables/array.html">$array</a>[<a class="var it307" onMouseOver="hilite(307)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../../_variables/param.html">$param</a>];
<a name="l1209"><span class="linenum">1209</span></a>          }
<a name="l1210"><span class="linenum">1210</span></a>          return <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../_variables/value.html">$value</a>;
<a name="l1211"><span class="linenum">1211</span></a>      }
<a name="l1212"><span class="linenum">1212</span></a>  
<a name="l1213"><span class="linenum">1213</span></a>  
<a name="l1214"><span class="linenum">1214</span></a>      <span class="comment">/**</span>
<a name="l1215"><span class="linenum">1215</span></a>  <span class="comment">     * Get array of 2 letter ISO country codes</span>
<a name="l1216"><span class="linenum">1216</span></a>  <span class="comment">     *</span>
<a name="l1217"><span class="linenum">1217</span></a>  <span class="comment">     * @return array</span>
<a name="l1218"><span class="linenum">1218</span></a>  <span class="comment">     */</span>
<a name="l1219"><span class="linenum">1219</span></a>  	function <a class="function" onClick="logFunction('get_country_codes')" href="../../../_functions/get_country_codes.html" onMouseOver="funcPopup(event,'get_country_codes')">get_country_codes</a>()
<a name="l1220"><span class="linenum">1220</span></a>      {
<a name="l1221"><span class="linenum">1221</span></a>          global <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>;
<a name="l1222"><span class="linenum">1222</span></a>  
<a name="l1223"><span class="linenum">1223</span></a>          if( <a class="phpfunction" onClick="logFunction('is_null')" href="../../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('country_codes')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/country_codes.html">country_codes</a> ) )
<a name="l1224"><span class="linenum">1224</span></a>          {
<a name="l1225"><span class="linenum">1225</span></a>  <span class="comment">            // sam2kb&gt; Save one DB query on every page load</span>
<a name="l1226"><span class="linenum">1226</span></a>  <span class="comment">            // $this-&gt;country_codes = $DB-&gt;get_col('SELECT ctry_code FROM T_regional__country', 0, 'get 2 letter ISO country codes' );</span>
<a name="l1227"><span class="linenum">1227</span></a>  
<a name="l1228"><span class="linenum">1228</span></a>              <a class="var it4686" onMouseOver="hilite(4686)" onMouseOut="lolite()" onClick="logVariable('countries')" href="../../../_variables/countries.html">$countries</a> = 'ad, ae, af, ag, ai, al, am, an, ao, aq, ar, as, at, au, aw, ax, az, ba, bb, bd, be, bf, bg, bh, bi,
<a name="l1229"><span class="linenum">1229</span></a>                              bj, bl, bm, bn, bo, br, bs, bt, bv, bw, by, bz, ca, cc, cd, cf, cg, ch, ci, ck, cl, cm, cn, co, cr,
<a name="l1230"><span class="linenum">1230</span></a>                              cu, cv, cx, cy, cz, de, dj, dk, dm, do, dz, ec, ee, eg, eh, er, es, et, fi, fj, fk, fm, fo, fr, ga,
<a name="l1231"><span class="linenum">1231</span></a>                              gb, gd, ge, gf, gg, gh, gi, gl, gm, gn, gp, gq, gr, gs, gt, gu, gw, gy, hk, hm, hn, hr, ht, hu, id,
<a name="l1232"><span class="linenum">1232</span></a>                              ie, il, im, in, io, iq, ir, is, it, je, jm, jo, jp, ke, kg, kh, ki, km, kn, kp, kr, kw, ky, kz, la,
<a name="l1233"><span class="linenum">1233</span></a>                              lb, lc, li, lk, lr, ls, lt, lu, lv, ly, ma, mc, md, me, mf, mg, mh, mk, ml, mm, mn, mo, mp, mq, mr,
<a name="l1234"><span class="linenum">1234</span></a>                              ms, mt, mu, mv, mw, mx, my, mz, na, nc, ne, nf, ng, ni, nl, no, np, nr, nu, nz, om, pa, pe, pf, pg,
<a name="l1235"><span class="linenum">1235</span></a>                              ph, pk, pl, pm, pn, pr, ps, pt, pw, py, qa, re, ro, rs, ru, rw, sa, sb, sc, sd, se, sg, sh, si, sj,
<a name="l1236"><span class="linenum">1236</span></a>                              sk, sl, sm, sn, so, sr, st, sv, sy, sz, tc, td, tf, tg, th, tj, tk, tl, tm, tn, to, tr, tt, tv, tw,
<a name="l1237"><span class="linenum">1237</span></a>                              tz, ua, ug, um, us, uy, uz, va, vc, ve, vg, vi, vn, vu, wf, ws, ye, yt, za, zm, zw';
<a name="l1238"><span class="linenum">1238</span></a>  
<a name="l1239"><span class="linenum">1239</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('country_codes')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/country_codes.html">country_codes</a> = <a class="phpfunction" onClick="logFunction('array_map')" href="../../../_functions/array_map.html" onMouseOver="phpfuncPopup(event,'array_map')">array_map</a>( 'trim', <a class="phpfunction" onClick="logFunction('explode')" href="../../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(',', <a class="var it4686" onMouseOver="hilite(4686)" onMouseOut="lolite()" onClick="logVariable('countries')" href="../../../_variables/countries.html">$countries</a>) );
<a name="l1240"><span class="linenum">1240</span></a>          }
<a name="l1241"><span class="linenum">1241</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('country_codes')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/country_codes.html">country_codes</a>;
<a name="l1242"><span class="linenum">1242</span></a>      }
<a name="l1243"><span class="linenum">1243</span></a>  
<a name="l1244"><span class="linenum">1244</span></a>  
<a name="l1245"><span class="linenum">1245</span></a>      <span class="comment">/**</span>
<a name="l1246"><span class="linenum">1246</span></a>  <span class="comment">     * @return array Array of ( searchEngineName =&gt; URL )</span>
<a name="l1247"><span class="linenum">1247</span></a>  <span class="comment">     */</span>
<a name="l1248"><span class="linenum">1248</span></a>  	function <a class="function" onClick="logFunction('get_search_engine_names')" href="../../../_functions/get_search_engine_names.html" onMouseOver="funcPopup(event,'get_search_engine_names')">get_search_engine_names</a>()
<a name="l1249"><span class="linenum">1249</span></a>      {
<a name="l1250"><span class="linenum">1250</span></a>          global <a class="var it4297" onMouseOver="hilite(4297)" onMouseOut="lolite()" onClick="logVariable('search_engine_params')" href="../../../_variables/search_engine_params.html">$search_engine_params</a>;
<a name="l1251"><span class="linenum">1251</span></a>  
<a name="l1252"><span class="linenum">1252</span></a>          if( <a class="phpfunction" onClick="logFunction('is_null')" href="../../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('search_engine_names')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/search_engine_names.html">search_engine_names</a> ) )
<a name="l1253"><span class="linenum">1253</span></a>          {
<a name="l1254"><span class="linenum">1254</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('search_engine_names')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/search_engine_names.html">search_engine_names</a> = array();
<a name="l1255"><span class="linenum">1255</span></a>              foreach( <a class="var it4297" onMouseOver="hilite(4297)" onMouseOut="lolite()" onClick="logVariable('search_engine_params')" href="../../../_variables/search_engine_params.html">$search_engine_params</a> as <a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../../_variables/url.html">$url</a> =&gt; <a class="var it1133" onMouseOver="hilite(1133)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a> )
<a name="l1256"><span class="linenum">1256</span></a>              {
<a name="l1257"><span class="linenum">1257</span></a>                  if( !isset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('search_engine_names')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/search_engine_names.html">search_engine_names</a>[<a class="var it1133" onMouseOver="hilite(1133)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a>[0]]) )
<a name="l1258"><span class="linenum">1258</span></a>                  {    // Do not overwrite existing keys
<a name="l1259"><span class="linenum">1259</span></a>                      <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('search_engine_names')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/search_engine_names.html">search_engine_names</a>[<a class="var it1133" onMouseOver="hilite(1133)" onMouseOut="lolite()" onClick="logVariable('info')" href="../../../_variables/info.html">$info</a>[0]] = <a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../../_variables/url.html">$url</a>;
<a name="l1260"><span class="linenum">1260</span></a>                  }
<a name="l1261"><span class="linenum">1261</span></a>              }
<a name="l1262"><span class="linenum">1262</span></a>          }
<a name="l1263"><span class="linenum">1263</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('search_engine_names')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/search_engine_names.html">search_engine_names</a>;
<a name="l1264"><span class="linenum">1264</span></a>      }
<a name="l1265"><span class="linenum">1265</span></a>  
<a name="l1266"><span class="linenum">1266</span></a>  
<a name="l1267"><span class="linenum">1267</span></a>      <span class="comment">/**</span>
<a name="l1268"><span class="linenum">1268</span></a>  <span class="comment">     * Reduce URL to more minimal form.  2 letter country codes are</span>
<a name="l1269"><span class="linenum">1269</span></a>  <span class="comment">     * replaced by '{}', while other parts are simply removed.</span>
<a name="l1270"><span class="linenum">1270</span></a>  <span class="comment">     *</span>
<a name="l1271"><span class="linenum">1271</span></a>  <span class="comment">     * Examples:</span>
<a name="l1272"><span class="linenum">1272</span></a>  <span class="comment">     *   www.example.com -&gt; example.com</span>
<a name="l1273"><span class="linenum">1273</span></a>  <span class="comment">     *   search.example.com -&gt; example.com</span>
<a name="l1274"><span class="linenum">1274</span></a>  <span class="comment">     *   m.example.com -&gt; example.com</span>
<a name="l1275"><span class="linenum">1275</span></a>  <span class="comment">     *   de.example.com -&gt; {}.example.com</span>
<a name="l1276"><span class="linenum">1276</span></a>  <span class="comment">     *   example.de -&gt; example.{}</span>
<a name="l1277"><span class="linenum">1277</span></a>  <span class="comment">     *   example.co.uk -&gt; example.{}</span>
<a name="l1278"><span class="linenum">1278</span></a>  <span class="comment">     *</span>
<a name="l1279"><span class="linenum">1279</span></a>  <span class="comment">     * @param string $url</span>
<a name="l1280"><span class="linenum">1280</span></a>  <span class="comment">     * @return string</span>
<a name="l1281"><span class="linenum">1281</span></a>  <span class="comment">     */</span>
<a name="l1282"><span class="linenum">1282</span></a>  	function <a class="function" onClick="logFunction('get_lossy_url')" href="../../../_functions/get_lossy_url.html" onMouseOver="funcPopup(event,'get_lossy_url')">get_lossy_url</a>( <a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../../_variables/url.html">$url</a> )
<a name="l1283"><span class="linenum">1283</span></a>      {
<a name="l1284"><span class="linenum">1284</span></a>          static <a class="var it4686" onMouseOver="hilite(4686)" onMouseOut="lolite()" onClick="logVariable('countries')" href="../../../_variables/countries.html">$countries</a>;
<a name="l1285"><span class="linenum">1285</span></a>  
<a name="l1286"><span class="linenum">1286</span></a>          if( !isset(<a class="var it4686" onMouseOver="hilite(4686)" onMouseOut="lolite()" onClick="logVariable('countries')" href="../../../_variables/countries.html">$countries</a>) )
<a name="l1287"><span class="linenum">1287</span></a>          {    // Load 2 letter ISO country codes
<a name="l1288"><span class="linenum">1288</span></a>              <a class="var it4686" onMouseOver="hilite(4686)" onMouseOut="lolite()" onClick="logVariable('countries')" href="../../../_variables/countries.html">$countries</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( '|', <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_country_codes')" href="../../../_functions/get_country_codes.html" onMouseOver="funcPopup(event,'get_country_codes')">get_country_codes</a>() );
<a name="l1289"><span class="linenum">1289</span></a>          }
<a name="l1290"><span class="linenum">1290</span></a>  
<a name="l1291"><span class="linenum">1291</span></a>  <span class="comment">        // Add not ISO 3166-1 country code top level domains</span>
<a name="l1292"><span class="linenum">1292</span></a>          <a class="var it4687" onMouseOver="hilite(4687)" onMouseOut="lolite()" onClick="logVariable('other_ccTLDs')" href="../../../_variables/other_ccTLDs.html">$other_ccTLDs</a> = ', uk, eu';
<a name="l1293"><span class="linenum">1293</span></a>  
<a name="l1294"><span class="linenum">1294</span></a>          return <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>(
<a name="l1295"><span class="linenum">1295</span></a>              array(
<a name="l1296"><span class="linenum">1296</span></a>                  '/^(w+[0-9]*|search)\./',
<a name="l1297"><span class="linenum">1297</span></a>                  '/(^|\.)m\./',
<a name="l1298"><span class="linenum">1298</span></a>                  '/(\.(com|org|net|co|it|edu))?\.('.<a class="var it4686" onMouseOver="hilite(4686)" onMouseOut="lolite()" onClick="logVariable('countries')" href="../../../_variables/countries.html">$countries</a>.<a class="var it4687" onMouseOver="hilite(4687)" onMouseOut="lolite()" onClick="logVariable('other_ccTLDs')" href="../../../_variables/other_ccTLDs.html">$other_ccTLDs</a>.')(\/|$)/',
<a name="l1299"><span class="linenum">1299</span></a>                  '/^('.<a class="var it4686" onMouseOver="hilite(4686)" onMouseOut="lolite()" onClick="logVariable('countries')" href="../../../_variables/countries.html">$countries</a>.<a class="var it4687" onMouseOver="hilite(4687)" onMouseOut="lolite()" onClick="logVariable('other_ccTLDs')" href="../../../_variables/other_ccTLDs.html">$other_ccTLDs</a>.')\./',
<a name="l1300"><span class="linenum">1300</span></a>              ),
<a name="l1301"><span class="linenum">1301</span></a>              array(
<a name="l1302"><span class="linenum">1302</span></a>                  '',
<a name="l1303"><span class="linenum">1303</span></a>                  '<a class="var it102" onMouseOver="hilite(102)" onMouseOut="lolite()" onClick="logVariable('1')" href="../../../_variables/1.html">$1</a>',
<a name="l1304"><span class="linenum">1304</span></a>                  '.{}<a class="var it4688" onMouseOver="hilite(4688)" onMouseOut="lolite()" onClick="logVariable('4')" href="../../../_variables/4.html">$4</a>',
<a name="l1305"><span class="linenum">1305</span></a>                  '{}.',
<a name="l1306"><span class="linenum">1306</span></a>              ),
<a name="l1307"><span class="linenum">1307</span></a>              <a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../../_variables/url.html">$url</a>);
<a name="l1308"><span class="linenum">1308</span></a>      }
<a name="l1309"><span class="linenum">1309</span></a>  
<a name="l1310"><span class="linenum">1310</span></a>  
<a name="l1311"><span class="linenum">1311</span></a>      <span class="comment">/**</span>
<a name="l1312"><span class="linenum">1312</span></a>  <span class="comment">     * Determine if a hit is a new view (not reloaded or from a robot).</span>
<a name="l1313"><span class="linenum">1313</span></a>  <span class="comment">     *</span>
<a name="l1314"><span class="linenum">1314</span></a>  <span class="comment">     * 'Reloaded' means: visited before from the same user (in a session) or from same IP/user_agent in the</span>
<a name="l1315"><span class="linenum">1315</span></a>  <span class="comment">     * last {@link $Settings reloadpage_timeout} seconds.</span>
<a name="l1316"><span class="linenum">1316</span></a>  <span class="comment">     *</span>
<a name="l1317"><span class="linenum">1317</span></a>  <span class="comment">     * This gets queried by the Item objects before incrementing its view count (if the Item gets viewed</span>
<a name="l1318"><span class="linenum">1318</span></a>  <span class="comment">     * in total ({@link $dispmore})).</span>
<a name="l1319"><span class="linenum">1319</span></a>  <span class="comment">     *</span>
<a name="l1320"><span class="linenum">1320</span></a>  <span class="comment">     * @todo fplanque&gt;&gt; if this is only useful to display who's online or view counts, provide option to disable all those resource consuming gadgets. (Those gadgets should be plugins actually, and they should enable this query only if needed)</span>
<a name="l1321"><span class="linenum">1321</span></a>  <span class="comment">     *        blueyed&gt;&gt; Move functionality to Plugin (with a hook in Item::content())?!</span>
<a name="l1322"><span class="linenum">1322</span></a>  <span class="comment">     * @return boolean</span>
<a name="l1323"><span class="linenum">1323</span></a>  <span class="comment">     */</span>
<a name="l1324"><span class="linenum">1324</span></a>  	function <a class="function" onClick="logFunction('is_new_view')" href="../../../_functions/is_new_view.html" onMouseOver="funcPopup(event,'is_new_view')">is_new_view</a>()
<a name="l1325"><span class="linenum">1325</span></a>      {
<a name="l1326"><span class="linenum">1326</span></a>          if( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_agent_type')" href="../../../_functions/get_agent_type.html" onMouseOver="funcPopup(event,'get_agent_type')">get_agent_type</a>() == 'robot' )
<a name="l1327"><span class="linenum">1327</span></a>          {    // Robot requests are not considered as (new) views:
<a name="l1328"><span class="linenum">1328</span></a>              return false;
<a name="l1329"><span class="linenum">1329</span></a>          }
<a name="l1330"><span class="linenum">1330</span></a>  
<a name="l1331"><span class="linenum">1331</span></a>          if( ! isset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_is_new_view')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_is_new_view.html">_is_new_view</a>) )
<a name="l1332"><span class="linenum">1332</span></a>          {
<a name="l1333"><span class="linenum">1333</span></a>              global <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>;
<a name="l1334"><span class="linenum">1334</span></a>              global <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>, <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>, <a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../../_variables/Settings.html">$Settings</a>, <a class="var it477" onMouseOver="hilite(477)" onMouseOut="lolite()" onClick="logVariable('ReqURI')" href="../../../_variables/ReqURI.html">$ReqURI</a>, <a class="var it317" onMouseOver="hilite(317)" onMouseOut="lolite()" onClick="logVariable('localtimenow')" href="../../../_variables/localtimenow.html">$localtimenow</a>;
<a name="l1335"><span class="linenum">1335</span></a>              global <a class="var it478" onMouseOver="hilite(478)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>;
<a name="l1336"><span class="linenum">1336</span></a>  
<a name="l1337"><span class="linenum">1337</span></a>  <span class="comment">            // Restrict to current user if logged in:</span>
<a name="l1338"><span class="linenum">1338</span></a>              if( ! empty(<a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../../_variables/current_User.html">$current_User</a>-&gt;<a onClick="logVariable('ID')" class="var it10675" onMouseOver="hilite(10675)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>) )
<a name="l1339"><span class="linenum">1339</span></a>              { // select by user ID: one user counts really just once. May be even faster than the anonymous query below..!?
<a name="l1340"><span class="linenum">1340</span></a>                  <a class="var it344" onMouseOver="hilite(344)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../_variables/sql.html">$sql</a> = &quot;
<a name="l1341"><span class="linenum">1341</span></a>                      SELECT SQL_NO_CACHE hit_ID FROM T_hitlog
<a name="l1342"><span class="linenum">1342</span></a>                       WHERE hit_sess_ID = &quot;.<a class="var it478" onMouseOver="hilite(478)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../../_variables/Session.html">$Session</a>-&gt;<a onClick="logVariable('ID')" class="var it10685" onMouseOver="hilite(10685)" onMouseOut="lolite()" href="../../../_variables/ID.html">ID</a>.&quot;
<a name="l1343"><span class="linenum">1343</span></a>                           AND hit_uri = '&quot;.<a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('escape')" href="../../../_functions/escape.html" onMouseOver="funcPopup(event,'escape')">escape</a>( <a class="phpfunction" onClick="logFunction('substr')" href="../../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it477" onMouseOver="hilite(477)" onMouseOut="lolite()" onClick="logVariable('ReqURI')" href="../../../_variables/ReqURI.html">$ReqURI</a>, 0, 250) ).&quot;'
<a name="l1344"><span class="linenum">1344</span></a>                       LIMIT 1&quot;;
<a name="l1345"><span class="linenum">1345</span></a>              }
<a name="l1346"><span class="linenum">1346</span></a>              else
<a name="l1347"><span class="linenum">1347</span></a>              { // select by remote_addr/hit_agent_type:
<a name="l1348"><span class="linenum">1348</span></a>                  <a class="var it344" onMouseOver="hilite(344)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../_variables/sql.html">$sql</a> = &quot;
<a name="l1349"><span class="linenum">1349</span></a>                      SELECT SQL_NO_CACHE hit_ID
<a name="l1350"><span class="linenum">1350</span></a>                        FROM T_hitlog
<a name="l1351"><span class="linenum">1351</span></a>                       WHERE hit_datetime &gt; '&quot;.<a class="phpfunction" onClick="logFunction('date')" href="../../../_functions/date.html" onMouseOver="phpfuncPopup(event,'date')">date</a>( 'Y-m-d H:i:s', <a class="var it317" onMouseOver="hilite(317)" onMouseOut="lolite()" onClick="logVariable('localtimenow')" href="../../../_variables/localtimenow.html">$localtimenow</a> - <a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../../_variables/Settings.html">$Settings</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>('reloadpage_timeout') ).&quot;'
<a name="l1352"><span class="linenum">1352</span></a>                         AND hit_remote_addr = &quot;.<a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('IP')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/IP.html">IP</a> ).&quot;
<a name="l1353"><span class="linenum">1353</span></a>                         AND hit_uri = '&quot;.<a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('escape')" href="../../../_functions/escape.html" onMouseOver="funcPopup(event,'escape')">escape</a>( <a class="phpfunction" onClick="logFunction('substr')" href="../../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it477" onMouseOver="hilite(477)" onMouseOut="lolite()" onClick="logVariable('ReqURI')" href="../../../_variables/ReqURI.html">$ReqURI</a>, 0, 250) ).&quot;'
<a name="l1354"><span class="linenum">1354</span></a>                         AND hit_agent_type = &quot;.<a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_agent_type')" href="../../../_functions/get_agent_type.html" onMouseOver="funcPopup(event,'get_agent_type')">get_agent_type</a>()).&quot;
<a name="l1355"><span class="linenum">1355</span></a>                       LIMIT 1&quot;;
<a name="l1356"><span class="linenum">1356</span></a>              }
<a name="l1357"><span class="linenum">1357</span></a>              if( <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_var')" href="../../../_functions/get_var.html" onMouseOver="funcPopup(event,'get_var')">get_var</a>( <a class="var it344" onMouseOver="hilite(344)" onMouseOut="lolite()" onClick="logVariable('sql')" href="../../../_variables/sql.html">$sql</a>, 0, 0, 'Hit: Check for reload' ) )
<a name="l1358"><span class="linenum">1358</span></a>              {
<a name="l1359"><span class="linenum">1359</span></a>                  <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit: No new view!', 'request' );
<a name="l1360"><span class="linenum">1360</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_is_new_view')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_is_new_view.html">_is_new_view</a> = false;  <span class="comment">// We don't want to log this hit again</span>
<a name="l1361"><span class="linenum">1361</span></a>              }
<a name="l1362"><span class="linenum">1362</span></a>              else
<a name="l1363"><span class="linenum">1363</span></a>              {
<a name="l1364"><span class="linenum">1364</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_is_new_view')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_is_new_view.html">_is_new_view</a> = true;
<a name="l1365"><span class="linenum">1365</span></a>              }
<a name="l1366"><span class="linenum">1366</span></a>          }
<a name="l1367"><span class="linenum">1367</span></a>  
<a name="l1368"><span class="linenum">1368</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_is_new_view')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_is_new_view.html">_is_new_view</a>;
<a name="l1369"><span class="linenum">1369</span></a>      }
<a name="l1370"><span class="linenum">1370</span></a>  
<a name="l1371"><span class="linenum">1371</span></a>  
<a name="l1372"><span class="linenum">1372</span></a>      <span class="comment">/**</span>
<a name="l1373"><span class="linenum">1373</span></a>  <span class="comment">     * Is this a browser reload (F5)?</span>
<a name="l1374"><span class="linenum">1374</span></a>  <span class="comment">     *</span>
<a name="l1375"><span class="linenum">1375</span></a>  <span class="comment">     * @return boolean true on reload, false if not.</span>
<a name="l1376"><span class="linenum">1376</span></a>  <span class="comment">     */</span>
<a name="l1377"><span class="linenum">1377</span></a>  	function <a class="function" onClick="logFunction('is_browser_reload')" href="../../../_functions/is_browser_reload.html" onMouseOver="funcPopup(event,'is_browser_reload')">is_browser_reload</a>()
<a name="l1378"><span class="linenum">1378</span></a>      {
<a name="l1379"><span class="linenum">1379</span></a>          if( ( isset( <a class="var it142" onMouseOver="hilite(142)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../../_variables/_SERVER.html">$_SERVER</a>['HTTP_CACHE_CONTROL'] ) &amp;&amp; <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it142" onMouseOver="hilite(142)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../../_variables/_SERVER.html">$_SERVER</a>['HTTP_CACHE_CONTROL'], 'max-age=0' ) !== false )
<a name="l1380"><span class="linenum">1380</span></a>              || ( isset( <a class="var it142" onMouseOver="hilite(142)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../../_variables/_SERVER.html">$_SERVER</a>['HTTP_PRAGMA'] ) &amp;&amp; <a class="var it142" onMouseOver="hilite(142)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../../../_variables/_SERVER.html">$_SERVER</a>['HTTP_PRAGMA'] == 'no-cache' ) )
<a name="l1381"><span class="linenum">1381</span></a>          { // Reload
<a name="l1382"><span class="linenum">1382</span></a>              return true;
<a name="l1383"><span class="linenum">1383</span></a>          }
<a name="l1384"><span class="linenum">1384</span></a>  
<a name="l1385"><span class="linenum">1385</span></a>          return false;
<a name="l1386"><span class="linenum">1386</span></a>      }
<a name="l1387"><span class="linenum">1387</span></a>  
<a name="l1388"><span class="linenum">1388</span></a>  
<a name="l1389"><span class="linenum">1389</span></a>      <span class="comment">/*</span>
<a name="l1390"><span class="linenum">1390</span></a>  <span class="comment">     * Is this a search referer hit?</span>
<a name="l1391"><span class="linenum">1391</span></a>  <span class="comment">     *</span>
<a name="l1392"><span class="linenum">1392</span></a>  <span class="comment">     * Note: in some situations it is not possible to detect search keywords (like google redirect URLs),</span>
<a name="l1393"><span class="linenum">1393</span></a>  <span class="comment">     * and in stats you may see [n.a.] in 'Search keywords' column.</span>
<a name="l1394"><span class="linenum">1394</span></a>  <span class="comment">     *</span>
<a name="l1395"><span class="linenum">1395</span></a>  <span class="comment">     * @param string Hit referer</span>
<a name="l1396"><span class="linenum">1396</span></a>  <span class="comment">     * @param boolean true to return an array, false to return boolean</span>
<a name="l1397"><span class="linenum">1397</span></a>  <span class="comment">     * @return boolean|array of normalized referer parts: (host, path, query, fragment)</span>
<a name="l1398"><span class="linenum">1398</span></a>  <span class="comment">     */</span>
<a name="l1399"><span class="linenum">1399</span></a>  	function <a class="function" onClick="logFunction('is_search_referer')" href="../../../_functions/is_search_referer.html" onMouseOver="funcPopup(event,'is_search_referer')">is_search_referer</a>( <a class="var it4627" onMouseOver="hilite(4627)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../../_variables/referer.html">$referer</a>, <a class="var it4689" onMouseOver="hilite(4689)" onMouseOut="lolite()" onClick="logVariable('return_params')" href="../../../_variables/return_params.html">$return_params</a> = false )
<a name="l1400"><span class="linenum">1400</span></a>      {
<a name="l1401"><span class="linenum">1401</span></a>          global <a class="var it4297" onMouseOver="hilite(4297)" onMouseOut="lolite()" onClick="logVariable('search_engine_params')" href="../../../_variables/search_engine_params.html">$search_engine_params</a>;
<a name="l1402"><span class="linenum">1402</span></a>  
<a name="l1403"><span class="linenum">1403</span></a>  <span class="comment">        // Load search engine definitions</span>
<a name="l1404"><span class="linenum">1404</span></a>          require_once <a class="phpfunction" onClick="logFunction('dirname')" href="../../../_functions/dirname.html" onMouseOver="phpfuncPopup(event,'dirname')">dirname</a>(__FILE__).'/_search_engines.php';
<a name="l1405"><span class="linenum">1405</span></a>  
<a name="l1406"><span class="linenum">1406</span></a>  <span class="comment">        // Parse referer</span>
<a name="l1407"><span class="linenum">1407</span></a>          <a class="var it4690" onMouseOver="hilite(4690)" onMouseOut="lolite()" onClick="logVariable('pu')" href="../../../_variables/pu.html">$pu</a> = @<a class="phpfunction" onClick="logFunction('parse_url')" href="../../../_functions/parse_url.html" onMouseOver="phpfuncPopup(event,'parse_url')">parse_url</a>(<a class="var it4627" onMouseOver="hilite(4627)" onMouseOut="lolite()" onClick="logVariable('referer')" href="../../../_variables/referer.html">$referer</a>);
<a name="l1408"><span class="linenum">1408</span></a>  
<a name="l1409"><span class="linenum">1409</span></a>          if( ! isset(<a class="var it4690" onMouseOver="hilite(4690)" onMouseOut="lolite()" onClick="logVariable('pu')" href="../../../_variables/pu.html">$pu</a>['query']) || ! isset(<a class="var it4690" onMouseOver="hilite(4690)" onMouseOut="lolite()" onClick="logVariable('pu')" href="../../../_variables/pu.html">$pu</a>['host']) )
<a name="l1410"><span class="linenum">1410</span></a>          {
<a name="l1411"><span class="linenum">1411</span></a>              return false;
<a name="l1412"><span class="linenum">1412</span></a>          }
<a name="l1413"><span class="linenum">1413</span></a>  
<a name="l1414"><span class="linenum">1414</span></a>          <a class="var it4691" onMouseOver="hilite(4691)" onMouseOut="lolite()" onClick="logVariable('ref_host')" href="../../../_variables/ref_host.html">$ref_host</a> = <a class="var it4690" onMouseOver="hilite(4690)" onMouseOut="lolite()" onClick="logVariable('pu')" href="../../../_variables/pu.html">$pu</a>['host'];
<a name="l1415"><span class="linenum">1415</span></a>          <a class="var it4692" onMouseOver="hilite(4692)" onMouseOut="lolite()" onClick="logVariable('ref_query')" href="../../../_variables/ref_query.html">$ref_query</a> = isset(<a class="var it4690" onMouseOver="hilite(4690)" onMouseOut="lolite()" onClick="logVariable('pu')" href="../../../_variables/pu.html">$pu</a>['query']) ? <a class="var it4690" onMouseOver="hilite(4690)" onMouseOut="lolite()" onClick="logVariable('pu')" href="../../../_variables/pu.html">$pu</a>['query'] : '';
<a name="l1416"><span class="linenum">1416</span></a>          <a class="var it4693" onMouseOver="hilite(4693)" onMouseOut="lolite()" onClick="logVariable('ref_fragment')" href="../../../_variables/ref_fragment.html">$ref_fragment</a> = isset(<a class="var it4690" onMouseOver="hilite(4690)" onMouseOut="lolite()" onClick="logVariable('pu')" href="../../../_variables/pu.html">$pu</a>['fragment']) ? <a class="var it4690" onMouseOver="hilite(4690)" onMouseOut="lolite()" onClick="logVariable('pu')" href="../../../_variables/pu.html">$pu</a>['fragment'] : '';
<a name="l1417"><span class="linenum">1417</span></a>  
<a name="l1418"><span class="linenum">1418</span></a>  <span class="comment">        // Some search engines (eg. Bing Images) use the same domain</span>
<a name="l1419"><span class="linenum">1419</span></a>  <span class="comment">        // as an existing search engine (eg. Bing), we must also use the url path</span>
<a name="l1420"><span class="linenum">1420</span></a>          <a class="var it4694" onMouseOver="hilite(4694)" onMouseOut="lolite()" onClick="logVariable('ref_path')" href="../../../_variables/ref_path.html">$ref_path</a> = isset(<a class="var it4690" onMouseOver="hilite(4690)" onMouseOut="lolite()" onClick="logVariable('pu')" href="../../../_variables/pu.html">$pu</a>['path']) ? <a class="var it4690" onMouseOver="hilite(4690)" onMouseOut="lolite()" onClick="logVariable('pu')" href="../../../_variables/pu.html">$pu</a>['path'] : '';
<a name="l1421"><span class="linenum">1421</span></a>  
<a name="l1422"><span class="linenum">1422</span></a>          <a class="var it4695" onMouseOver="hilite(4695)" onMouseOut="lolite()" onClick="logVariable('host_pattern')" href="../../../_variables/host_pattern.html">$host_pattern</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_lossy_url')" href="../../../_functions/get_lossy_url.html" onMouseOver="funcPopup(event,'get_lossy_url')">get_lossy_url</a>(<a class="var it4691" onMouseOver="hilite(4691)" onMouseOut="lolite()" onClick="logVariable('ref_host')" href="../../../_variables/ref_host.html">$ref_host</a>);
<a name="l1423"><span class="linenum">1423</span></a>  
<a name="l1424"><span class="linenum">1424</span></a>          if( <a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it4691" onMouseOver="hilite(4691)" onMouseOut="lolite()" onClick="logVariable('ref_host')" href="../../../_variables/ref_host.html">$ref_host</a>.<a class="var it4694" onMouseOver="hilite(4694)" onMouseOut="lolite()" onClick="logVariable('ref_path')" href="../../../_variables/ref_path.html">$ref_path</a>, <a class="var it4297" onMouseOver="hilite(4297)" onMouseOut="lolite()" onClick="logVariable('search_engine_params')" href="../../../_variables/search_engine_params.html">$search_engine_params</a>) )
<a name="l1425"><span class="linenum">1425</span></a>          {
<a name="l1426"><span class="linenum">1426</span></a>              <a class="var it4691" onMouseOver="hilite(4691)" onMouseOut="lolite()" onClick="logVariable('ref_host')" href="../../../_variables/ref_host.html">$ref_host</a> = <a class="var it4691" onMouseOver="hilite(4691)" onMouseOut="lolite()" onClick="logVariable('ref_host')" href="../../../_variables/ref_host.html">$ref_host</a>.<a class="var it4694" onMouseOver="hilite(4694)" onMouseOut="lolite()" onClick="logVariable('ref_path')" href="../../../_variables/ref_path.html">$ref_path</a>;
<a name="l1427"><span class="linenum">1427</span></a>          }
<a name="l1428"><span class="linenum">1428</span></a>          elseif( <a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it4695" onMouseOver="hilite(4695)" onMouseOut="lolite()" onClick="logVariable('host_pattern')" href="../../../_variables/host_pattern.html">$host_pattern</a>.<a class="var it4694" onMouseOver="hilite(4694)" onMouseOut="lolite()" onClick="logVariable('ref_path')" href="../../../_variables/ref_path.html">$ref_path</a>, <a class="var it4297" onMouseOver="hilite(4297)" onMouseOut="lolite()" onClick="logVariable('search_engine_params')" href="../../../_variables/search_engine_params.html">$search_engine_params</a>) )
<a name="l1429"><span class="linenum">1429</span></a>          {
<a name="l1430"><span class="linenum">1430</span></a>              <a class="var it4691" onMouseOver="hilite(4691)" onMouseOut="lolite()" onClick="logVariable('ref_host')" href="../../../_variables/ref_host.html">$ref_host</a> = <a class="var it4695" onMouseOver="hilite(4695)" onMouseOut="lolite()" onClick="logVariable('host_pattern')" href="../../../_variables/host_pattern.html">$host_pattern</a>.<a class="var it4694" onMouseOver="hilite(4694)" onMouseOut="lolite()" onClick="logVariable('ref_path')" href="../../../_variables/ref_path.html">$ref_path</a>;
<a name="l1431"><span class="linenum">1431</span></a>          }
<a name="l1432"><span class="linenum">1432</span></a>          elseif( <a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it4695" onMouseOver="hilite(4695)" onMouseOut="lolite()" onClick="logVariable('host_pattern')" href="../../../_variables/host_pattern.html">$host_pattern</a>, <a class="var it4297" onMouseOver="hilite(4297)" onMouseOut="lolite()" onClick="logVariable('search_engine_params')" href="../../../_variables/search_engine_params.html">$search_engine_params</a>) )
<a name="l1433"><span class="linenum">1433</span></a>          {
<a name="l1434"><span class="linenum">1434</span></a>              <a class="var it4691" onMouseOver="hilite(4691)" onMouseOut="lolite()" onClick="logVariable('ref_host')" href="../../../_variables/ref_host.html">$ref_host</a> = <a class="var it4695" onMouseOver="hilite(4695)" onMouseOut="lolite()" onClick="logVariable('host_pattern')" href="../../../_variables/host_pattern.html">$host_pattern</a>;
<a name="l1435"><span class="linenum">1435</span></a>          }
<a name="l1436"><span class="linenum">1436</span></a>          elseif( !<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it4691" onMouseOver="hilite(4691)" onMouseOut="lolite()" onClick="logVariable('ref_host')" href="../../../_variables/ref_host.html">$ref_host</a>, <a class="var it4297" onMouseOver="hilite(4297)" onMouseOut="lolite()" onClick="logVariable('search_engine_params')" href="../../../_variables/search_engine_params.html">$search_engine_params</a>) )
<a name="l1437"><span class="linenum">1437</span></a>          {
<a name="l1438"><span class="linenum">1438</span></a>              if( !<a class="phpfunction" onClick="logFunction('strncmp')" href="../../../_functions/strncmp.html" onMouseOver="phpfuncPopup(event,'strncmp')">strncmp</a>(<a class="var it4692" onMouseOver="hilite(4692)" onMouseOut="lolite()" onClick="logVariable('ref_query')" href="../../../_variables/ref_query.html">$ref_query</a>, 'cx=partner-pub-', 15) )
<a name="l1439"><span class="linenum">1439</span></a>              {    // Google custom search engine
<a name="l1440"><span class="linenum">1440</span></a>                  <a class="var it4691" onMouseOver="hilite(4691)" onMouseOut="lolite()" onClick="logVariable('ref_host')" href="../../../_variables/ref_host.html">$ref_host</a> = 'www.google.com/cse';
<a name="l1441"><span class="linenum">1441</span></a>              }
<a name="l1442"><span class="linenum">1442</span></a>              elseif( !<a class="phpfunction" onClick="logFunction('strncmp')" href="../../../_functions/strncmp.html" onMouseOver="phpfuncPopup(event,'strncmp')">strncmp</a>(<a class="var it4694" onMouseOver="hilite(4694)" onMouseOut="lolite()" onClick="logVariable('ref_path')" href="../../../_variables/ref_path.html">$ref_path</a>, '/pemonitorhosted/ws/results/', 28) )
<a name="l1443"><span class="linenum">1443</span></a>              {    // Private-label search powered by InfoSpace Metasearch
<a name="l1444"><span class="linenum">1444</span></a>                  <a class="var it4691" onMouseOver="hilite(4691)" onMouseOut="lolite()" onClick="logVariable('ref_host')" href="../../../_variables/ref_host.html">$ref_host</a> = 'infospace.com';
<a name="l1445"><span class="linenum">1445</span></a>              }
<a name="l1446"><span class="linenum">1446</span></a>              else
<a name="l1447"><span class="linenum">1447</span></a>              {    // Not a search referer
<a name="l1448"><span class="linenum">1448</span></a>                  return false;
<a name="l1449"><span class="linenum">1449</span></a>              }
<a name="l1450"><span class="linenum">1450</span></a>          }
<a name="l1451"><span class="linenum">1451</span></a>  
<a name="l1452"><span class="linenum">1452</span></a>          if( <a class="var it4689" onMouseOver="hilite(4689)" onMouseOut="lolite()" onClick="logVariable('return_params')" href="../../../_variables/return_params.html">$return_params</a> )
<a name="l1453"><span class="linenum">1453</span></a>          {
<a name="l1454"><span class="linenum">1454</span></a>              return array( <a class="var it4691" onMouseOver="hilite(4691)" onMouseOut="lolite()" onClick="logVariable('ref_host')" href="../../../_variables/ref_host.html">$ref_host</a>, <a class="var it4694" onMouseOver="hilite(4694)" onMouseOut="lolite()" onClick="logVariable('ref_path')" href="../../../_variables/ref_path.html">$ref_path</a>, <a class="var it4692" onMouseOver="hilite(4692)" onMouseOut="lolite()" onClick="logVariable('ref_query')" href="../../../_variables/ref_query.html">$ref_query</a>, <a class="var it4693" onMouseOver="hilite(4693)" onMouseOut="lolite()" onClick="logVariable('ref_fragment')" href="../../../_variables/ref_fragment.html">$ref_fragment</a> );
<a name="l1455"><span class="linenum">1455</span></a>          }
<a name="l1456"><span class="linenum">1456</span></a>          return true;
<a name="l1457"><span class="linenum">1457</span></a>      }
<a name="l1458"><span class="linenum">1458</span></a>  
<a name="l1459"><span class="linenum">1459</span></a>  
<a name="l1460"><span class="linenum">1460</span></a>      <span class="comment">/**</span>
<a name="l1461"><span class="linenum">1461</span></a>  <span class="comment">     * Extracts a keyword from a raw not encoded URL.</span>
<a name="l1462"><span class="linenum">1462</span></a>  <span class="comment">     * Will only extract keyword if a known search engine has been detected.</span>
<a name="l1463"><span class="linenum">1463</span></a>  <span class="comment">     * Returns the keyword:</span>
<a name="l1464"><span class="linenum">1464</span></a>  <span class="comment">     * - in UTF8: automatically converted from other charsets when applicable</span>
<a name="l1465"><span class="linenum">1465</span></a>  <span class="comment">     * - strtolowered: &quot;QUErY test!&quot; will return &quot;query test!&quot;</span>
<a name="l1466"><span class="linenum">1466</span></a>  <span class="comment">     * - trimmed: extra spaces before and after are removed</span>
<a name="l1467"><span class="linenum">1467</span></a>  <span class="comment">     *</span>
<a name="l1468"><span class="linenum">1468</span></a>  <span class="comment">     * A list of supported search engines can be found in /inc/sessions/model/_search_engines.php</span>
<a name="l1469"><span class="linenum">1469</span></a>  <span class="comment">     * The function returns false when a keyword couldn't be found.</span>
<a name="l1470"><span class="linenum">1470</span></a>  <span class="comment">     *      eg. if the url is &quot;http://www.google.com/partners.html&quot; this will return false,</span>
<a name="l1471"><span class="linenum">1471</span></a>  <span class="comment">     *       as the google keyword parameter couldn't be found.</span>
<a name="l1472"><span class="linenum">1472</span></a>  <span class="comment">     *</span>
<a name="l1473"><span class="linenum">1473</span></a>  <span class="comment">     * @param string URL referer</span>
<a name="l1474"><span class="linenum">1474</span></a>  <span class="comment">     * @return array|false false if a keyword couldn't be extracted,</span>
<a name="l1475"><span class="linenum">1475</span></a>  <span class="comment">     *                         or array(</span>
<a name="l1476"><span class="linenum">1476</span></a>  <span class="comment">     *                             'engine_name' =&gt; 'Google',</span>
<a name="l1477"><span class="linenum">1477</span></a>  <span class="comment">     *                             'keywords' =&gt; 'my searched keywords',</span>
<a name="l1478"><span class="linenum">1478</span></a>  <span class="comment">     *                            'serprank' =&gt; 4)</span>
<a name="l1479"><span class="linenum">1479</span></a>  <span class="comment">     */</span>
<a name="l1480"><span class="linenum">1480</span></a>  	function <a class="function" onClick="logFunction('extract_params_from_referer')" href="../../../_functions/extract_params_from_referer.html" onMouseOver="funcPopup(event,'extract_params_from_referer')">extract_params_from_referer</a>( <a class="var it4696" onMouseOver="hilite(4696)" onMouseOut="lolite()" onClick="logVariable('ref')" href="../../../_variables/ref.html">$ref</a> )
<a name="l1481"><span class="linenum">1481</span></a>      {
<a name="l1482"><span class="linenum">1482</span></a>          global <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>, <a class="var it4297" onMouseOver="hilite(4297)" onMouseOut="lolite()" onClick="logVariable('search_engine_params')" href="../../../_variables/search_engine_params.html">$search_engine_params</a>, <a class="var it926" onMouseOver="hilite(926)" onMouseOut="lolite()" onClick="logVariable('evo_charset')" href="../../../_variables/evo_charset.html">$evo_charset</a>, <a class="var it627" onMouseOver="hilite(627)" onMouseOut="lolite()" onClick="logVariable('current_charset')" href="../../../_variables/current_charset.html">$current_charset</a>;
<a name="l1483"><span class="linenum">1483</span></a>  
<a name="l1484"><span class="linenum">1484</span></a>  <span class="comment">        // Make sure we don't try params extraction twice</span>
<a name="l1485"><span class="linenum">1485</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_search_params_tried')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_search_params_tried.html">_search_params_tried</a> = true;
<a name="l1486"><span class="linenum">1486</span></a>  
<a name="l1487"><span class="linenum">1487</span></a>          @<a class="function" onClick="logFunction('list')" href="../../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>(<a class="var it4691" onMouseOver="hilite(4691)" onMouseOut="lolite()" onClick="logVariable('ref_host')" href="../../../_variables/ref_host.html">$ref_host</a>, <a class="var it4694" onMouseOver="hilite(4694)" onMouseOut="lolite()" onClick="logVariable('ref_path')" href="../../../_variables/ref_path.html">$ref_path</a>, <a class="var it1657" onMouseOver="hilite(1657)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../_variables/query.html">$query</a>, <a class="var it4697" onMouseOver="hilite(4697)" onMouseOut="lolite()" onClick="logVariable('fragment')" href="../../../_variables/fragment.html">$fragment</a>) = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('is_search_referer')" href="../../../_functions/is_search_referer.html" onMouseOver="funcPopup(event,'is_search_referer')">is_search_referer</a>(<a class="var it4696" onMouseOver="hilite(4696)" onMouseOut="lolite()" onClick="logVariable('ref')" href="../../../_variables/ref.html">$ref</a>, true);
<a name="l1488"><span class="linenum">1488</span></a>  
<a name="l1489"><span class="linenum">1489</span></a>          if( empty(<a class="var it4691" onMouseOver="hilite(4691)" onMouseOut="lolite()" onClick="logVariable('ref_host')" href="../../../_variables/ref_host.html">$ref_host</a>) )
<a name="l1490"><span class="linenum">1490</span></a>          {    // Not a search referer
<a name="l1491"><span class="linenum">1491</span></a>              return false;
<a name="l1492"><span class="linenum">1492</span></a>          }
<a name="l1493"><span class="linenum">1493</span></a>  
<a name="l1494"><span class="linenum">1494</span></a>          <a class="var it4698" onMouseOver="hilite(4698)" onMouseOut="lolite()" onClick="logVariable('search_engine_name')" href="../../../_variables/search_engine_name.html">$search_engine_name</a> = <a class="var it4297" onMouseOver="hilite(4297)" onMouseOut="lolite()" onClick="logVariable('search_engine_params')" href="../../../_variables/search_engine_params.html">$search_engine_params</a>[<a class="var it4691" onMouseOver="hilite(4691)" onMouseOut="lolite()" onClick="logVariable('ref_host')" href="../../../_variables/ref_host.html">$ref_host</a>][0];
<a name="l1495"><span class="linenum">1495</span></a>  
<a name="l1496"><span class="linenum">1496</span></a>          <a class="var it4699" onMouseOver="hilite(4699)" onMouseOut="lolite()" onClick="logVariable('keyword_param')" href="../../../_variables/keyword_param.html">$keyword_param</a> = NULL;
<a name="l1497"><span class="linenum">1497</span></a>          if( !empty(<a class="var it4297" onMouseOver="hilite(4297)" onMouseOut="lolite()" onClick="logVariable('search_engine_params')" href="../../../_variables/search_engine_params.html">$search_engine_params</a>[<a class="var it4691" onMouseOver="hilite(4691)" onMouseOut="lolite()" onClick="logVariable('ref_host')" href="../../../_variables/ref_host.html">$ref_host</a>][1]) )
<a name="l1498"><span class="linenum">1498</span></a>          {
<a name="l1499"><span class="linenum">1499</span></a>              <a class="var it4699" onMouseOver="hilite(4699)" onMouseOut="lolite()" onClick="logVariable('keyword_param')" href="../../../_variables/keyword_param.html">$keyword_param</a> = <a class="var it4297" onMouseOver="hilite(4297)" onMouseOut="lolite()" onClick="logVariable('search_engine_params')" href="../../../_variables/search_engine_params.html">$search_engine_params</a>[<a class="var it4691" onMouseOver="hilite(4691)" onMouseOut="lolite()" onClick="logVariable('ref_host')" href="../../../_variables/ref_host.html">$ref_host</a>][1];
<a name="l1500"><span class="linenum">1500</span></a>          }
<a name="l1501"><span class="linenum">1501</span></a>          if( <a class="phpfunction" onClick="logFunction('is_null')" href="../../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>(<a class="var it4699" onMouseOver="hilite(4699)" onMouseOut="lolite()" onClick="logVariable('keyword_param')" href="../../../_variables/keyword_param.html">$keyword_param</a>) )
<a name="l1502"><span class="linenum">1502</span></a>          {    // Get settings from first item in group
<a name="l1503"><span class="linenum">1503</span></a>              <a class="var it4638" onMouseOver="hilite(4638)" onMouseOut="lolite()" onClick="logVariable('search_engine_names')" href="../../../_variables/search_engine_names.html">$search_engine_names</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_search_engine_names')" href="../../../_functions/get_search_engine_names.html" onMouseOver="funcPopup(event,'get_search_engine_names')">get_search_engine_names</a>();
<a name="l1504"><span class="linenum">1504</span></a>  
<a name="l1505"><span class="linenum">1505</span></a>              <a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../../_variables/url.html">$url</a> = <a class="var it4638" onMouseOver="hilite(4638)" onMouseOut="lolite()" onClick="logVariable('search_engine_names')" href="../../../_variables/search_engine_names.html">$search_engine_names</a>[<a class="var it4698" onMouseOver="hilite(4698)" onMouseOut="lolite()" onClick="logVariable('search_engine_name')" href="../../../_variables/search_engine_name.html">$search_engine_name</a>];
<a name="l1506"><span class="linenum">1506</span></a>              <a class="var it4699" onMouseOver="hilite(4699)" onMouseOut="lolite()" onClick="logVariable('keyword_param')" href="../../../_variables/keyword_param.html">$keyword_param</a> = <a class="var it4297" onMouseOver="hilite(4297)" onMouseOut="lolite()" onClick="logVariable('search_engine_params')" href="../../../_variables/search_engine_params.html">$search_engine_params</a>[<a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../../_variables/url.html">$url</a>][1];
<a name="l1507"><span class="linenum">1507</span></a>          }
<a name="l1508"><span class="linenum">1508</span></a>          if( !<a class="phpfunction" onClick="logFunction('is_array')" href="../../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it4699" onMouseOver="hilite(4699)" onMouseOut="lolite()" onClick="logVariable('keyword_param')" href="../../../_variables/keyword_param.html">$keyword_param</a>) )
<a name="l1509"><span class="linenum">1509</span></a>          {
<a name="l1510"><span class="linenum">1510</span></a>              <a class="var it4699" onMouseOver="hilite(4699)" onMouseOut="lolite()" onClick="logVariable('keyword_param')" href="../../../_variables/keyword_param.html">$keyword_param</a> = array(<a class="var it4699" onMouseOver="hilite(4699)" onMouseOut="lolite()" onClick="logVariable('keyword_param')" href="../../../_variables/keyword_param.html">$keyword_param</a>);
<a name="l1511"><span class="linenum">1511</span></a>          }
<a name="l1512"><span class="linenum">1512</span></a>  
<a name="l1513"><span class="linenum">1513</span></a>          if( <a class="var it4698" onMouseOver="hilite(4698)" onMouseOut="lolite()" onClick="logVariable('search_engine_name')" href="../../../_variables/search_engine_name.html">$search_engine_name</a> == 'Google Images' || (<a class="var it4698" onMouseOver="hilite(4698)" onMouseOut="lolite()" onClick="logVariable('search_engine_name')" href="../../../_variables/search_engine_name.html">$search_engine_name</a> == 'Google' &amp;&amp; <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it4696" onMouseOver="hilite(4696)" onMouseOut="lolite()" onClick="logVariable('ref')" href="../../../_variables/ref.html">$ref</a>, '/imgres') !== false) )
<a name="l1514"><span class="linenum">1514</span></a>          {    // Google image search
<a name="l1515"><span class="linenum">1515</span></a>              <a class="var it4698" onMouseOver="hilite(4698)" onMouseOut="lolite()" onClick="logVariable('search_engine_name')" href="../../../_variables/search_engine_name.html">$search_engine_name</a> = 'Google Images';
<a name="l1516"><span class="linenum">1516</span></a>  
<a name="l1517"><span class="linenum">1517</span></a>              <a class="var it1657" onMouseOver="hilite(1657)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../_variables/query.html">$query</a> = <a class="phpfunction" onClick="logFunction('urldecode')" href="../../../_functions/urldecode.html" onMouseOver="phpfuncPopup(event,'urldecode')">urldecode</a>(<a class="phpfunction" onClick="logFunction('trim')" href="../../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_param_from_string')" href="../../../_functions/get_param_from_string.html" onMouseOver="funcPopup(event,'get_param_from_string')">get_param_from_string</a>(<a class="var it1657" onMouseOver="hilite(1657)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../_variables/query.html">$query</a>, 'prev') ));
<a name="l1518"><span class="linenum">1518</span></a>              <a class="var it1657" onMouseOver="hilite(1657)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../_variables/query.html">$query</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>( '&amp;', '&amp;amp;', <a class="phpfunction" onClick="logFunction('strstr')" href="../../../_functions/strstr.html" onMouseOver="phpfuncPopup(event,'strstr')">strstr</a>(<a class="var it1657" onMouseOver="hilite(1657)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../_variables/query.html">$query</a>, '?') );
<a name="l1519"><span class="linenum">1519</span></a>          }
<a name="l1520"><span class="linenum">1520</span></a>          elseif( <a class="var it4698" onMouseOver="hilite(4698)" onMouseOut="lolite()" onClick="logVariable('search_engine_name')" href="../../../_variables/search_engine_name.html">$search_engine_name</a> == 'Google' &amp;&amp; (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it1657" onMouseOver="hilite(1657)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../_variables/query.html">$query</a>, '&amp;as_') !== false || <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it1657" onMouseOver="hilite(1657)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../_variables/query.html">$query</a>, 'as_') === 0) )
<a name="l1521"><span class="linenum">1521</span></a>          { // Google with &quot;as_&quot; param
<a name="l1522"><span class="linenum">1522</span></a>              <a class="var it2645" onMouseOver="hilite(2645)" onMouseOut="lolite()" onClick="logVariable('keys')" href="../../../_variables/keys.html">$keys</a> = array();
<a name="l1523"><span class="linenum">1523</span></a>  
<a name="l1524"><span class="linenum">1524</span></a>              if( <a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_param_from_string')" href="../../../_functions/get_param_from_string.html" onMouseOver="funcPopup(event,'get_param_from_string')">get_param_from_string</a>(<a class="var it1657" onMouseOver="hilite(1657)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../_variables/query.html">$query</a>, 'as_q') )
<a name="l1525"><span class="linenum">1525</span></a>              {
<a name="l1526"><span class="linenum">1526</span></a>                  <a class="phpfunction" onClick="logFunction('array_push')" href="../../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>(<a class="var it2645" onMouseOver="hilite(2645)" onMouseOut="lolite()" onClick="logVariable('keys')" href="../../../_variables/keys.html">$keys</a>, <a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>);
<a name="l1527"><span class="linenum">1527</span></a>              }
<a name="l1528"><span class="linenum">1528</span></a>              if( <a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_param_from_string')" href="../../../_functions/get_param_from_string.html" onMouseOver="funcPopup(event,'get_param_from_string')">get_param_from_string</a>(<a class="var it1657" onMouseOver="hilite(1657)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../_variables/query.html">$query</a>, 'as_oq') )
<a name="l1529"><span class="linenum">1529</span></a>              {
<a name="l1530"><span class="linenum">1530</span></a>                  <a class="phpfunction" onClick="logFunction('array_push')" href="../../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>(<a class="var it2645" onMouseOver="hilite(2645)" onMouseOut="lolite()" onClick="logVariable('keys')" href="../../../_variables/keys.html">$keys</a>, <a class="phpfunction" onClick="logFunction('str_replace')" href="../../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('+', ' OR ', <a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>));
<a name="l1531"><span class="linenum">1531</span></a>              }
<a name="l1532"><span class="linenum">1532</span></a>              if( <a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_param_from_string')" href="../../../_functions/get_param_from_string.html" onMouseOver="funcPopup(event,'get_param_from_string')">get_param_from_string</a>(<a class="var it1657" onMouseOver="hilite(1657)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../_variables/query.html">$query</a>, 'as_epq') )
<a name="l1533"><span class="linenum">1533</span></a>              {
<a name="l1534"><span class="linenum">1534</span></a>                  <a class="phpfunction" onClick="logFunction('array_push')" href="../../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>(<a class="var it2645" onMouseOver="hilite(2645)" onMouseOut="lolite()" onClick="logVariable('keys')" href="../../../_variables/keys.html">$keys</a>, &quot;\&quot;<a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>\&quot;&quot;);
<a name="l1535"><span class="linenum">1535</span></a>              }
<a name="l1536"><span class="linenum">1536</span></a>              if( <a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_param_from_string')" href="../../../_functions/get_param_from_string.html" onMouseOver="funcPopup(event,'get_param_from_string')">get_param_from_string</a>(<a class="var it1657" onMouseOver="hilite(1657)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../_variables/query.html">$query</a>, 'as_eq') )
<a name="l1537"><span class="linenum">1537</span></a>              {
<a name="l1538"><span class="linenum">1538</span></a>                  <a class="phpfunction" onClick="logFunction('array_push')" href="../../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>(<a class="var it2645" onMouseOver="hilite(2645)" onMouseOut="lolite()" onClick="logVariable('keys')" href="../../../_variables/keys.html">$keys</a>, &quot;-<a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>&quot;);
<a name="l1539"><span class="linenum">1539</span></a>              }
<a name="l1540"><span class="linenum">1540</span></a>              <a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="phpfunction" onClick="logFunction('urldecode')" href="../../../_functions/urldecode.html" onMouseOver="phpfuncPopup(event,'urldecode')">urldecode</a>(<a class="phpfunction" onClick="logFunction('implode')" href="../../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(' ', <a class="var it2645" onMouseOver="hilite(2645)" onMouseOut="lolite()" onClick="logVariable('keys')" href="../../../_variables/keys.html">$keys</a>)));
<a name="l1541"><span class="linenum">1541</span></a>          }
<a name="l1542"><span class="linenum">1542</span></a>  
<a name="l1543"><span class="linenum">1543</span></a>          if( empty(<a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>) )
<a name="l1544"><span class="linenum">1544</span></a>          {    // we haven't extracted a search key with the special cases above...
<a name="l1545"><span class="linenum">1545</span></a>              foreach( <a class="var it4699" onMouseOver="hilite(4699)" onMouseOut="lolite()" onClick="logVariable('keyword_param')" href="../../../_variables/keyword_param.html">$keyword_param</a> as <a class="var it307" onMouseOver="hilite(307)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../../_variables/param.html">$param</a> )
<a name="l1546"><span class="linenum">1546</span></a>              {
<a name="l1547"><span class="linenum">1547</span></a>                  if( <a class="var it307" onMouseOver="hilite(307)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../../_variables/param.html">$param</a>[0] == '/' )
<a name="l1548"><span class="linenum">1548</span></a>                  {    // regular expression match
<a name="l1549"><span class="linenum">1549</span></a>                      if( @<a class="phpfunction" onClick="logFunction('preg_match')" href="../../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>(<a class="var it307" onMouseOver="hilite(307)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../../_variables/param.html">$param</a>, <a class="var it4696" onMouseOver="hilite(4696)" onMouseOut="lolite()" onClick="logVariable('ref')" href="../../../_variables/ref.html">$ref</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../../_variables/matches.html">$matches</a>) )
<a name="l1550"><span class="linenum">1550</span></a>                      {
<a name="l1551"><span class="linenum">1551</span></a>                          <a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="phpfunction" onClick="logFunction('urldecode')" href="../../../_functions/urldecode.html" onMouseOver="phpfuncPopup(event,'urldecode')">urldecode</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../../_variables/matches.html">$matches</a>[1]));
<a name="l1552"><span class="linenum">1552</span></a>                          break;
<a name="l1553"><span class="linenum">1553</span></a>                      }
<a name="l1554"><span class="linenum">1554</span></a>                  }
<a name="l1555"><span class="linenum">1555</span></a>                  else
<a name="l1556"><span class="linenum">1556</span></a>                  {    // search for keywords now &amp;vname=keyword
<a name="l1557"><span class="linenum">1557</span></a>                      if( <a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_param_from_string')" href="../../../_functions/get_param_from_string.html" onMouseOver="funcPopup(event,'get_param_from_string')">get_param_from_string</a>(<a class="var it1657" onMouseOver="hilite(1657)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../_variables/query.html">$query</a>, <a class="var it307" onMouseOver="hilite(307)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../../_variables/param.html">$param</a>) )
<a name="l1558"><span class="linenum">1558</span></a>                      {
<a name="l1559"><span class="linenum">1559</span></a>                          <a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>(<a class="phpfunction" onClick="logFunction('urldecode')" href="../../../_functions/urldecode.html" onMouseOver="phpfuncPopup(event,'urldecode')">urldecode</a>(<a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>));
<a name="l1560"><span class="linenum">1560</span></a>                          if( !empty(<a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>) ) break;
<a name="l1561"><span class="linenum">1561</span></a>                      }
<a name="l1562"><span class="linenum">1562</span></a>                  }
<a name="l1563"><span class="linenum">1563</span></a>              }
<a name="l1564"><span class="linenum">1564</span></a>          }
<a name="l1565"><span class="linenum">1565</span></a>  
<a name="l1566"><span class="linenum">1566</span></a>          <a class="var it4700" onMouseOver="hilite(4700)" onMouseOut="lolite()" onClick="logVariable('key_param_in_query')" href="../../../_variables/key_param_in_query.html">$key_param_in_query</a> = false;
<a name="l1567"><span class="linenum">1567</span></a>          if( empty( <a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> ) &amp;&amp; ! empty( <a class="var it4699" onMouseOver="hilite(4699)" onMouseOut="lolite()" onClick="logVariable('keyword_param')" href="../../../_variables/keyword_param.html">$keyword_param</a> ) )
<a name="l1568"><span class="linenum">1568</span></a>          { // Check if empty key param exists in query, e.g. &quot;/search?q=&amp;other_param=text&quot;
<a name="l1569"><span class="linenum">1569</span></a>              foreach( <a class="var it4699" onMouseOver="hilite(4699)" onMouseOut="lolite()" onClick="logVariable('keyword_param')" href="../../../_variables/keyword_param.html">$keyword_param</a> as <a class="var it4701" onMouseOver="hilite(4701)" onMouseOut="lolite()" onClick="logVariable('k_param')" href="../../../_variables/k_param.html">$k_param</a> )
<a name="l1570"><span class="linenum">1570</span></a>              {
<a name="l1571"><span class="linenum">1571</span></a>                  if( <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it1657" onMouseOver="hilite(1657)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../_variables/query.html">$query</a>, '&amp;'.<a class="var it4701" onMouseOver="hilite(4701)" onMouseOut="lolite()" onClick="logVariable('k_param')" href="../../../_variables/k_param.html">$k_param</a>.'=' ) !== false || <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it1657" onMouseOver="hilite(1657)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../_variables/query.html">$query</a>, <a class="var it4701" onMouseOver="hilite(4701)" onMouseOut="lolite()" onClick="logVariable('k_param')" href="../../../_variables/k_param.html">$k_param</a>.'=' ) === 0 )
<a name="l1572"><span class="linenum">1572</span></a>                  { // Key param with empty value exists in query, We can decide this referer url as from search engine
<a name="l1573"><span class="linenum">1573</span></a>                      <a class="var it4700" onMouseOver="hilite(4700)" onMouseOut="lolite()" onClick="logVariable('key_param_in_query')" href="../../../_variables/key_param_in_query.html">$key_param_in_query</a> = true;
<a name="l1574"><span class="linenum">1574</span></a>                  }
<a name="l1575"><span class="linenum">1575</span></a>              }
<a name="l1576"><span class="linenum">1576</span></a>          }
<a name="l1577"><span class="linenum">1577</span></a>  
<a name="l1578"><span class="linenum">1578</span></a>          if( empty( <a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> ) &amp;&amp; ! <a class="var it4700" onMouseOver="hilite(4700)" onMouseOut="lolite()" onClick="logVariable('key_param_in_query')" href="../../../_variables/key_param_in_query.html">$key_param_in_query</a> )
<a name="l1579"><span class="linenum">1579</span></a>          { // Not a search referer
<a name="l1580"><span class="linenum">1580</span></a>              if( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_type.html">referer_type</a> == 'search' )
<a name="l1581"><span class="linenum">1581</span></a>              { // If the referer was detected as 'search' we need to change it to 'special'
<a name="l1582"><span class="linenum">1582</span></a>  <span class="comment">                // to keep search stats clean.</span>
<a name="l1583"><span class="linenum">1583</span></a>                  <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('referer_type')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/referer_type.html">referer_type</a> = 'special';
<a name="l1584"><span class="linenum">1584</span></a>                  <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( 'Hit: <a class="function" onClick="logFunction('extract_params_from_referer')" href="../../../_functions/extract_params_from_referer.html" onMouseOver="funcPopup(event,'extract_params_from_referer')">extract_params_from_referer</a>() overrides referer type set by <a class="function" onClick="logFunction('detect_referer')" href="../../../_functions/detect_referer.html" onMouseOver="funcPopup(event,'detect_referer')">detect_referer</a>(): &quot;search&quot; -&gt; &quot;special&quot;', 'request' );
<a name="l1585"><span class="linenum">1585</span></a>              }
<a name="l1586"><span class="linenum">1586</span></a>  
<a name="l1587"><span class="linenum">1587</span></a>              return false;
<a name="l1588"><span class="linenum">1588</span></a>          }
<a name="l1589"><span class="linenum">1589</span></a>  
<a name="l1590"><span class="linenum">1590</span></a>  
<a name="l1591"><span class="linenum">1591</span></a>  <span class="comment">        // Convert encoding</span>
<a name="l1592"><span class="linenum">1592</span></a>          if( !empty(<a class="var it4297" onMouseOver="hilite(4297)" onMouseOut="lolite()" onClick="logVariable('search_engine_params')" href="../../../_variables/search_engine_params.html">$search_engine_params</a>[<a class="var it4691" onMouseOver="hilite(4691)" onMouseOut="lolite()" onClick="logVariable('ref_host')" href="../../../_variables/ref_host.html">$ref_host</a>][3]) )
<a name="l1593"><span class="linenum">1593</span></a>          {
<a name="l1594"><span class="linenum">1594</span></a>              <a class="var it4702" onMouseOver="hilite(4702)" onMouseOut="lolite()" onClick="logVariable('ie')" href="../../../_variables/ie.html">$ie</a> = <a class="var it4297" onMouseOver="hilite(4297)" onMouseOut="lolite()" onClick="logVariable('search_engine_params')" href="../../../_variables/search_engine_params.html">$search_engine_params</a>[<a class="var it4691" onMouseOver="hilite(4691)" onMouseOut="lolite()" onClick="logVariable('ref_host')" href="../../../_variables/ref_host.html">$ref_host</a>][3];
<a name="l1595"><span class="linenum">1595</span></a>          }
<a name="l1596"><span class="linenum">1596</span></a>          elseif( isset(<a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../../_variables/url.html">$url</a>) &amp;&amp; !empty(<a class="var it4297" onMouseOver="hilite(4297)" onMouseOut="lolite()" onClick="logVariable('search_engine_params')" href="../../../_variables/search_engine_params.html">$search_engine_params</a>[<a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../../_variables/url.html">$url</a>][3]) )
<a name="l1597"><span class="linenum">1597</span></a>          {
<a name="l1598"><span class="linenum">1598</span></a>              <a class="var it4702" onMouseOver="hilite(4702)" onMouseOut="lolite()" onClick="logVariable('ie')" href="../../../_variables/ie.html">$ie</a> = <a class="var it4297" onMouseOver="hilite(4297)" onMouseOut="lolite()" onClick="logVariable('search_engine_params')" href="../../../_variables/search_engine_params.html">$search_engine_params</a>[<a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../../_variables/url.html">$url</a>][3];
<a name="l1599"><span class="linenum">1599</span></a>          }
<a name="l1600"><span class="linenum">1600</span></a>          else
<a name="l1601"><span class="linenum">1601</span></a>          {    // Fallback to default encoding
<a name="l1602"><span class="linenum">1602</span></a>              <a class="var it4702" onMouseOver="hilite(4702)" onMouseOut="lolite()" onClick="logVariable('ie')" href="../../../_variables/ie.html">$ie</a> = array('utf-8', 'iso-8859-15');
<a name="l1603"><span class="linenum">1603</span></a>          }
<a name="l1604"><span class="linenum">1604</span></a>  
<a name="l1605"><span class="linenum">1605</span></a>          if( <a class="phpfunction" onClick="logFunction('is_array')" href="../../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it4702" onMouseOver="hilite(4702)" onMouseOut="lolite()" onClick="logVariable('ie')" href="../../../_variables/ie.html">$ie</a>) )
<a name="l1606"><span class="linenum">1606</span></a>          {
<a name="l1607"><span class="linenum">1607</span></a>              if( <a class="function" onClick="logFunction('can_check_encoding')" href="../../../_functions/can_check_encoding.html" onMouseOver="funcPopup(event,'can_check_encoding')">can_check_encoding</a>() )
<a name="l1608"><span class="linenum">1608</span></a>              {
<a name="l1609"><span class="linenum">1609</span></a>                  foreach( <a class="var it4702" onMouseOver="hilite(4702)" onMouseOut="lolite()" onClick="logVariable('ie')" href="../../../_variables/ie.html">$ie</a> as <a class="var it4703" onMouseOver="hilite(4703)" onMouseOut="lolite()" onClick="logVariable('test_encoding')" href="../../../_variables/test_encoding.html">$test_encoding</a> )
<a name="l1610"><span class="linenum">1610</span></a>                  {
<a name="l1611"><span class="linenum">1611</span></a>                      if( <a class="function" onClick="logFunction('check_encoding')" href="../../../_functions/check_encoding.html" onMouseOver="funcPopup(event,'check_encoding')">check_encoding</a>(<a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>, <a class="var it4703" onMouseOver="hilite(4703)" onMouseOut="lolite()" onClick="logVariable('test_encoding')" href="../../../_variables/test_encoding.html">$test_encoding</a>) )
<a name="l1612"><span class="linenum">1612</span></a>                      {
<a name="l1613"><span class="linenum">1613</span></a>                          <a class="var it4702" onMouseOver="hilite(4702)" onMouseOut="lolite()" onClick="logVariable('ie')" href="../../../_variables/ie.html">$ie</a> = <a class="var it4703" onMouseOver="hilite(4703)" onMouseOut="lolite()" onClick="logVariable('test_encoding')" href="../../../_variables/test_encoding.html">$test_encoding</a>;
<a name="l1614"><span class="linenum">1614</span></a>                          break;
<a name="l1615"><span class="linenum">1615</span></a>                      }
<a name="l1616"><span class="linenum">1616</span></a>                  }
<a name="l1617"><span class="linenum">1617</span></a>              }
<a name="l1618"><span class="linenum">1618</span></a>              else
<a name="l1619"><span class="linenum">1619</span></a>              {
<a name="l1620"><span class="linenum">1620</span></a>                  <a class="var it4702" onMouseOver="hilite(4702)" onMouseOut="lolite()" onClick="logVariable('ie')" href="../../../_variables/ie.html">$ie</a> = <a class="var it4702" onMouseOver="hilite(4702)" onMouseOut="lolite()" onClick="logVariable('ie')" href="../../../_variables/ie.html">$ie</a>[0];
<a name="l1621"><span class="linenum">1621</span></a>              }
<a name="l1622"><span class="linenum">1622</span></a>          }
<a name="l1623"><span class="linenum">1623</span></a>  
<a name="l1624"><span class="linenum">1624</span></a>          <a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> = <a class="function" onClick="logFunction('convert_charset')" href="../../../_functions/convert_charset.html" onMouseOver="funcPopup(event,'convert_charset')">convert_charset</a>(<a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>, <a class="var it926" onMouseOver="hilite(926)" onMouseOut="lolite()" onClick="logVariable('evo_charset')" href="../../../_variables/evo_charset.html">$evo_charset</a>, <a class="var it4702" onMouseOver="hilite(4702)" onMouseOut="lolite()" onClick="logVariable('ie')" href="../../../_variables/ie.html">$ie</a>);
<a name="l1625"><span class="linenum">1625</span></a>  <span class="comment">        // convert to lower string but keep in evo_charset</span>
<a name="l1626"><span class="linenum">1626</span></a>          <a class="var it4704" onMouseOver="hilite(4704)" onMouseOut="lolite()" onClick="logVariable('saved_charset')" href="../../../_variables/saved_charset.html">$saved_charset</a> = <a class="var it627" onMouseOver="hilite(627)" onMouseOut="lolite()" onClick="logVariable('current_charset')" href="../../../_variables/current_charset.html">$current_charset</a>;
<a name="l1627"><span class="linenum">1627</span></a>          <a class="var it627" onMouseOver="hilite(627)" onMouseOut="lolite()" onClick="logVariable('current_charset')" href="../../../_variables/current_charset.html">$current_charset</a> = <a class="var it926" onMouseOver="hilite(926)" onMouseOut="lolite()" onClick="logVariable('evo_charset')" href="../../../_variables/evo_charset.html">$evo_charset</a>;
<a name="l1628"><span class="linenum">1628</span></a>          <a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a> = <a class="function" onClick="logFunction('utf8_strtolower')" href="../../../_functions/utf8_strtolower.html" onMouseOver="funcPopup(event,'utf8_strtolower')">utf8_strtolower</a>(<a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>);
<a name="l1629"><span class="linenum">1629</span></a>          <a class="var it627" onMouseOver="hilite(627)" onMouseOut="lolite()" onClick="logVariable('current_charset')" href="../../../_variables/current_charset.html">$current_charset</a> = <a class="var it4704" onMouseOver="hilite(4704)" onMouseOut="lolite()" onClick="logVariable('saved_charset')" href="../../../_variables/saved_charset.html">$saved_charset</a>;
<a name="l1630"><span class="linenum">1630</span></a>  
<a name="l1631"><span class="linenum">1631</span></a>  <span class="comment">        // Extract the &quot;serp rank&quot;</span>
<a name="l1632"><span class="linenum">1632</span></a>  <span class="comment">        // Typically http://google.com?s=keyphraz&amp;start=18 returns 18</span>
<a name="l1633"><span class="linenum">1633</span></a>          if( !empty(<a class="var it4297" onMouseOver="hilite(4297)" onMouseOut="lolite()" onClick="logVariable('search_engine_params')" href="../../../_variables/search_engine_params.html">$search_engine_params</a>[<a class="var it4691" onMouseOver="hilite(4691)" onMouseOut="lolite()" onClick="logVariable('ref_host')" href="../../../_variables/ref_host.html">$ref_host</a>][4]) )
<a name="l1634"><span class="linenum">1634</span></a>          {
<a name="l1635"><span class="linenum">1635</span></a>              <a class="var it4705" onMouseOver="hilite(4705)" onMouseOut="lolite()" onClick="logVariable('serp_param')" href="../../../_variables/serp_param.html">$serp_param</a> = <a class="var it4297" onMouseOver="hilite(4297)" onMouseOut="lolite()" onClick="logVariable('search_engine_params')" href="../../../_variables/search_engine_params.html">$search_engine_params</a>[<a class="var it4691" onMouseOver="hilite(4691)" onMouseOut="lolite()" onClick="logVariable('ref_host')" href="../../../_variables/ref_host.html">$ref_host</a>][4];
<a name="l1636"><span class="linenum">1636</span></a>          }
<a name="l1637"><span class="linenum">1637</span></a>          elseif( isset(<a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../../_variables/url.html">$url</a>) &amp;&amp; !empty(<a class="var it4297" onMouseOver="hilite(4297)" onMouseOut="lolite()" onClick="logVariable('search_engine_params')" href="../../../_variables/search_engine_params.html">$search_engine_params</a>[<a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../../_variables/url.html">$url</a>][4]) )
<a name="l1638"><span class="linenum">1638</span></a>          {
<a name="l1639"><span class="linenum">1639</span></a>              <a class="var it4705" onMouseOver="hilite(4705)" onMouseOut="lolite()" onClick="logVariable('serp_param')" href="../../../_variables/serp_param.html">$serp_param</a> = <a class="var it4297" onMouseOver="hilite(4297)" onMouseOut="lolite()" onClick="logVariable('search_engine_params')" href="../../../_variables/search_engine_params.html">$search_engine_params</a>[<a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../../_variables/url.html">$url</a>][4];
<a name="l1640"><span class="linenum">1640</span></a>          }
<a name="l1641"><span class="linenum">1641</span></a>          else
<a name="l1642"><span class="linenum">1642</span></a>          {    // Fallback to default params
<a name="l1643"><span class="linenum">1643</span></a>              <a class="var it4705" onMouseOver="hilite(4705)" onMouseOut="lolite()" onClick="logVariable('serp_param')" href="../../../_variables/serp_param.html">$serp_param</a> = array('offset','page','start');
<a name="l1644"><span class="linenum">1644</span></a>          }
<a name="l1645"><span class="linenum">1645</span></a>  
<a name="l1646"><span class="linenum">1646</span></a>          if( !<a class="phpfunction" onClick="logFunction('is_array')" href="../../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it4705" onMouseOver="hilite(4705)" onMouseOut="lolite()" onClick="logVariable('serp_param')" href="../../../_variables/serp_param.html">$serp_param</a>) )
<a name="l1647"><span class="linenum">1647</span></a>          {
<a name="l1648"><span class="linenum">1648</span></a>              <a class="var it4705" onMouseOver="hilite(4705)" onMouseOut="lolite()" onClick="logVariable('serp_param')" href="../../../_variables/serp_param.html">$serp_param</a> = array(<a class="var it4705" onMouseOver="hilite(4705)" onMouseOut="lolite()" onClick="logVariable('serp_param')" href="../../../_variables/serp_param.html">$serp_param</a>);
<a name="l1649"><span class="linenum">1649</span></a>          }
<a name="l1650"><span class="linenum">1650</span></a>  
<a name="l1651"><span class="linenum">1651</span></a>          if( <a class="phpfunction" onClick="logFunction('strpos')" href="../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it4698" onMouseOver="hilite(4698)" onMouseOut="lolite()" onClick="logVariable('search_engine_name')" href="../../../_variables/search_engine_name.html">$search_engine_name</a>, 'Google') !== false )
<a name="l1652"><span class="linenum">1652</span></a>          {    // Append fragment which Google uses in instant search
<a name="l1653"><span class="linenum">1653</span></a>              <a class="var it1657" onMouseOver="hilite(1657)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../_variables/query.html">$query</a> .= '&amp;'.<a class="var it4697" onMouseOver="hilite(4697)" onMouseOut="lolite()" onClick="logVariable('fragment')" href="../../../_variables/fragment.html">$fragment</a>;
<a name="l1654"><span class="linenum">1654</span></a>          }
<a name="l1655"><span class="linenum">1655</span></a>  
<a name="l1656"><span class="linenum">1656</span></a>          foreach( <a class="var it4705" onMouseOver="hilite(4705)" onMouseOut="lolite()" onClick="logVariable('serp_param')" href="../../../_variables/serp_param.html">$serp_param</a> as <a class="var it307" onMouseOver="hilite(307)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../../_variables/param.html">$param</a> )
<a name="l1657"><span class="linenum">1657</span></a>          {
<a name="l1658"><span class="linenum">1658</span></a>              if( <a class="var it920" onMouseOver="hilite(920)" onMouseOut="lolite()" onClick="logVariable('var')" href="../../../_variables/var.html">$var</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_param_from_string')" href="../../../_functions/get_param_from_string.html" onMouseOver="funcPopup(event,'get_param_from_string')">get_param_from_string</a>(<a class="var it1657" onMouseOver="hilite(1657)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../_variables/query.html">$query</a>, <a class="var it307" onMouseOver="hilite(307)" onMouseOut="lolite()" onClick="logVariable('param')" href="../../../_variables/param.html">$param</a>) )
<a name="l1659"><span class="linenum">1659</span></a>              {
<a name="l1660"><span class="linenum">1660</span></a>                  if( <a class="phpfunction" onClick="logFunction('ctype_digit')" href="../../../_functions/ctype_digit.html" onMouseOver="phpfuncPopup(event,'ctype_digit')">ctype_digit</a>(<a class="var it920" onMouseOver="hilite(920)" onMouseOut="lolite()" onClick="logVariable('var')" href="../../../_variables/var.html">$var</a>) )
<a name="l1661"><span class="linenum">1661</span></a>                  {
<a name="l1662"><span class="linenum">1662</span></a>                      <a class="var it4679" onMouseOver="hilite(4679)" onMouseOut="lolite()" onClick="logVariable('serprank')" href="../../../_variables/serprank.html">$serprank</a> = <a class="var it920" onMouseOver="hilite(920)" onMouseOut="lolite()" onClick="logVariable('var')" href="../../../_variables/var.html">$var</a>;
<a name="l1663"><span class="linenum">1663</span></a>                      break;
<a name="l1664"><span class="linenum">1664</span></a>                  }
<a name="l1665"><span class="linenum">1665</span></a>              }
<a name="l1666"><span class="linenum">1666</span></a>          }
<a name="l1667"><span class="linenum">1667</span></a>  
<a name="l1668"><span class="linenum">1668</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_search_engine')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_search_engine.html">_search_engine</a> = <a class="var it4698" onMouseOver="hilite(4698)" onMouseOut="lolite()" onClick="logVariable('search_engine_name')" href="../../../_variables/search_engine_name.html">$search_engine_name</a>;
<a name="l1669"><span class="linenum">1669</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_keyphrase')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_keyphrase.html">_keyphrase</a> = <a class="var it1021" onMouseOver="hilite(1021)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../_variables/key.html">$key</a>;
<a name="l1670"><span class="linenum">1670</span></a>          <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_serprank')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_serprank.html">_serprank</a> = isset(<a class="var it4679" onMouseOver="hilite(4679)" onMouseOut="lolite()" onClick="logVariable('serprank')" href="../../../_variables/serprank.html">$serprank</a>) ? <a class="var it4679" onMouseOver="hilite(4679)" onMouseOut="lolite()" onClick="logVariable('serprank')" href="../../../_variables/serprank.html">$serprank</a> : NULL;
<a name="l1671"><span class="linenum">1671</span></a>  
<a name="l1672"><span class="linenum">1672</span></a>          return array(
<a name="l1673"><span class="linenum">1673</span></a>                  'engine_name'    =&gt; <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_search_engine')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_search_engine.html">_search_engine</a>,
<a name="l1674"><span class="linenum">1674</span></a>                  'keyphrase'        =&gt; <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_keyphrase')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/_keyphrase.html">_keyphrase</a>,
<a name="l1675"><span class="linenum">1675</span></a>                  'serprank'        =&gt; <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;_serprank
<a name="l1676"><span class="linenum">1676</span></a>              );
<a name="l1677"><span class="linenum">1677</span></a>      }
<a name="l1678"><span class="linenum">1678</span></a>  
<a name="l1679"><span class="linenum">1679</span></a>  
<a name="l1680"><span class="linenum">1680</span></a>      <span class="comment">/**</span>
<a name="l1681"><span class="linenum">1681</span></a>  <span class="comment">     * Is this Lynx?</span>
<a name="l1682"><span class="linenum">1682</span></a>  <span class="comment">     * @return boolean</span>
<a name="l1683"><span class="linenum">1683</span></a>  <span class="comment">     */</span>
<a name="l1684"><span class="linenum">1684</span></a>  	function <a class="function" onClick="logFunction('is_lynx')" href="../../../_functions/is_lynx.html" onMouseOver="funcPopup(event,'is_lynx')">is_lynx</a>()
<a name="l1685"><span class="linenum">1685</span></a>      {
<a name="l1686"><span class="linenum">1686</span></a>          if( ! isset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_lynx')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_lynx.html">is_lynx</a>) )
<a name="l1687"><span class="linenum">1687</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>();
<a name="l1688"><span class="linenum">1688</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_lynx')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_lynx.html">is_lynx</a>;
<a name="l1689"><span class="linenum">1689</span></a>      }
<a name="l1690"><span class="linenum">1690</span></a>  
<a name="l1691"><span class="linenum">1691</span></a>      <span class="comment">/**</span>
<a name="l1692"><span class="linenum">1692</span></a>  <span class="comment">     * Is this Firefox?</span>
<a name="l1693"><span class="linenum">1693</span></a>  <span class="comment">     * @return boolean</span>
<a name="l1694"><span class="linenum">1694</span></a>  <span class="comment">     */</span>
<a name="l1695"><span class="linenum">1695</span></a>  	function <a class="function" onClick="logFunction('is_firefox')" href="../../../_functions/is_firefox.html" onMouseOver="funcPopup(event,'is_firefox')">is_firefox</a>()
<a name="l1696"><span class="linenum">1696</span></a>      {
<a name="l1697"><span class="linenum">1697</span></a>          if( ! isset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_firefox')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_firefox.html">is_firefox</a>) )
<a name="l1698"><span class="linenum">1698</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>();
<a name="l1699"><span class="linenum">1699</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_firefox')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_firefox.html">is_firefox</a>;
<a name="l1700"><span class="linenum">1700</span></a>      }
<a name="l1701"><span class="linenum">1701</span></a>  
<a name="l1702"><span class="linenum">1702</span></a>      <span class="comment">/**</span>
<a name="l1703"><span class="linenum">1703</span></a>  <span class="comment">     * Is this Gecko?</span>
<a name="l1704"><span class="linenum">1704</span></a>  <span class="comment">     * @return boolean</span>
<a name="l1705"><span class="linenum">1705</span></a>  <span class="comment">     */</span>
<a name="l1706"><span class="linenum">1706</span></a>  	function <a class="function" onClick="logFunction('is_gecko')" href="../../../_functions/is_gecko.html" onMouseOver="funcPopup(event,'is_gecko')">is_gecko</a>()
<a name="l1707"><span class="linenum">1707</span></a>      {
<a name="l1708"><span class="linenum">1708</span></a>          if( ! isset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_gecko')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_gecko.html">is_gecko</a>) )
<a name="l1709"><span class="linenum">1709</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>();
<a name="l1710"><span class="linenum">1710</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_gecko')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_gecko.html">is_gecko</a>;
<a name="l1711"><span class="linenum">1711</span></a>      }
<a name="l1712"><span class="linenum">1712</span></a>  
<a name="l1713"><span class="linenum">1713</span></a>      <span class="comment">/**</span>
<a name="l1714"><span class="linenum">1714</span></a>  <span class="comment">     * Is this WinIE?</span>
<a name="l1715"><span class="linenum">1715</span></a>  <span class="comment">     * @return boolean</span>
<a name="l1716"><span class="linenum">1716</span></a>  <span class="comment">     */</span>
<a name="l1717"><span class="linenum">1717</span></a>  	function <a class="function" onClick="logFunction('is_winIE')" href="../../../_functions/is_winie.html" onMouseOver="funcPopup(event,'is_winie')">is_winIE</a>()
<a name="l1718"><span class="linenum">1718</span></a>      {
<a name="l1719"><span class="linenum">1719</span></a>          if( ! isset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_winIE')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_winIE.html">is_winIE</a>) )
<a name="l1720"><span class="linenum">1720</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>();
<a name="l1721"><span class="linenum">1721</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_winIE')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_winIE.html">is_winIE</a>;
<a name="l1722"><span class="linenum">1722</span></a>      }
<a name="l1723"><span class="linenum">1723</span></a>  
<a name="l1724"><span class="linenum">1724</span></a>      <span class="comment">/**</span>
<a name="l1725"><span class="linenum">1725</span></a>  <span class="comment">     * Is this MacIE?</span>
<a name="l1726"><span class="linenum">1726</span></a>  <span class="comment">     * @return boolean</span>
<a name="l1727"><span class="linenum">1727</span></a>  <span class="comment">     */</span>
<a name="l1728"><span class="linenum">1728</span></a>  	function <a class="function" onClick="logFunction('is_macIE')" href="../../../_functions/is_macie.html" onMouseOver="funcPopup(event,'is_macie')">is_macIE</a>()
<a name="l1729"><span class="linenum">1729</span></a>      {
<a name="l1730"><span class="linenum">1730</span></a>          if( ! isset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_macIE')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_macIE.html">is_macIE</a>) )
<a name="l1731"><span class="linenum">1731</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>();
<a name="l1732"><span class="linenum">1732</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_macIE')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_macIE.html">is_macIE</a>;
<a name="l1733"><span class="linenum">1733</span></a>      }
<a name="l1734"><span class="linenum">1734</span></a>  
<a name="l1735"><span class="linenum">1735</span></a>      <span class="comment">/**</span>
<a name="l1736"><span class="linenum">1736</span></a>  <span class="comment">     * Is this Internet Explorer?</span>
<a name="l1737"><span class="linenum">1737</span></a>  <span class="comment">     *</span>
<a name="l1738"><span class="linenum">1738</span></a>  <span class="comment">     * @param integer Version of IE, NULL to don't check a version</span>
<a name="l1739"><span class="linenum">1739</span></a>  <span class="comment">     * @param string Operator to compare a version: '=', '&lt;', '&gt;', '&lt;=', '&gt;=', '!='</span>
<a name="l1740"><span class="linenum">1740</span></a>  <span class="comment">     * @return boolean</span>
<a name="l1741"><span class="linenum">1741</span></a>  <span class="comment">     */</span>
<a name="l1742"><span class="linenum">1742</span></a>  	function <a class="function" onClick="logFunction('is_IE')" href="../../../_functions/is_ie.html" onMouseOver="funcPopup(event,'is_ie')">is_IE</a>( <a class="var it814" onMouseOver="hilite(814)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../../_variables/version.html">$version</a> = NULL, <a class="var it393" onMouseOver="hilite(393)" onMouseOut="lolite()" onClick="logVariable('operator')" href="../../../_variables/operator.html">$operator</a> = '=' )
<a name="l1743"><span class="linenum">1743</span></a>      {
<a name="l1744"><span class="linenum">1744</span></a>          if( ! isset( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_IE')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_IE.html">is_IE</a> ) )
<a name="l1745"><span class="linenum">1745</span></a>          {
<a name="l1746"><span class="linenum">1746</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>();
<a name="l1747"><span class="linenum">1747</span></a>          }
<a name="l1748"><span class="linenum">1748</span></a>  
<a name="l1749"><span class="linenum">1749</span></a>          <a class="var it95" onMouseOver="hilite(95)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a> = <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_IE')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_IE.html">is_IE</a>;
<a name="l1750"><span class="linenum">1750</span></a>  
<a name="l1751"><span class="linenum">1751</span></a>          if( ! <a class="var it95" onMouseOver="hilite(95)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../_variables/result.html">$result</a> )
<a name="l1752"><span class="linenum">1752</span></a>          { // No IE
<a name="l1753"><span class="linenum">1753</span></a>              return false;
<a name="l1754"><span class="linenum">1754</span></a>          }
<a name="l1755"><span class="linenum">1755</span></a>  
<a name="l1756"><span class="linenum">1756</span></a>          if( ! <a class="phpfunction" onClick="logFunction('is_null')" href="../../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>( <a class="var it814" onMouseOver="hilite(814)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../../_variables/version.html">$version</a> ) )
<a name="l1757"><span class="linenum">1757</span></a>          { // Check version of IE
<a name="l1758"><span class="linenum">1758</span></a>              switch( <a class="var it393" onMouseOver="hilite(393)" onMouseOut="lolite()" onClick="logVariable('operator')" href="../../../_variables/operator.html">$operator</a> )
<a name="l1759"><span class="linenum">1759</span></a>              {
<a name="l1760"><span class="linenum">1760</span></a>                  case '=':
<a name="l1761"><span class="linenum">1761</span></a>                      return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_browser_version')" href="../../../_functions/get_browser_version.html" onMouseOver="funcPopup(event,'get_browser_version')">get_browser_version</a>() == <a class="var it814" onMouseOver="hilite(814)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../../_variables/version.html">$version</a>;
<a name="l1762"><span class="linenum">1762</span></a>                  case '&gt;':
<a name="l1763"><span class="linenum">1763</span></a>                      return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_browser_version')" href="../../../_functions/get_browser_version.html" onMouseOver="funcPopup(event,'get_browser_version')">get_browser_version</a>() &gt; <a class="var it814" onMouseOver="hilite(814)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../../_variables/version.html">$version</a>;
<a name="l1764"><span class="linenum">1764</span></a>                  case '&lt;':
<a name="l1765"><span class="linenum">1765</span></a>                      return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_browser_version')" href="../../../_functions/get_browser_version.html" onMouseOver="funcPopup(event,'get_browser_version')">get_browser_version</a>() &lt; <a class="var it814" onMouseOver="hilite(814)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../../_variables/version.html">$version</a>;
<a name="l1766"><span class="linenum">1766</span></a>                  case '&gt;=':
<a name="l1767"><span class="linenum">1767</span></a>                      return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_browser_version')" href="../../../_functions/get_browser_version.html" onMouseOver="funcPopup(event,'get_browser_version')">get_browser_version</a>() &gt;= <a class="var it814" onMouseOver="hilite(814)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../../_variables/version.html">$version</a>;
<a name="l1768"><span class="linenum">1768</span></a>                  case '&lt;=':
<a name="l1769"><span class="linenum">1769</span></a>                      return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_browser_version')" href="../../../_functions/get_browser_version.html" onMouseOver="funcPopup(event,'get_browser_version')">get_browser_version</a>() &lt;= <a class="var it814" onMouseOver="hilite(814)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../../_variables/version.html">$version</a>;
<a name="l1770"><span class="linenum">1770</span></a>                  case '!=':
<a name="l1771"><span class="linenum">1771</span></a>                      return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_browser_version')" href="../../../_functions/get_browser_version.html" onMouseOver="funcPopup(event,'get_browser_version')">get_browser_version</a>() != <a class="var it814" onMouseOver="hilite(814)" onMouseOut="lolite()" onClick="logVariable('version')" href="../../../_variables/version.html">$version</a>;
<a name="l1772"><span class="linenum">1772</span></a>                  default:
<a name="l1773"><span class="linenum">1773</span></a>  <span class="comment">                    // Incorrect operator</span>
<a name="l1774"><span class="linenum">1774</span></a>                      return false;
<a name="l1775"><span class="linenum">1775</span></a>              }
<a name="l1776"><span class="linenum">1776</span></a>          }
<a name="l1777"><span class="linenum">1777</span></a>  
<a name="l1778"><span class="linenum">1778</span></a>          return true;
<a name="l1779"><span class="linenum">1779</span></a>      }
<a name="l1780"><span class="linenum">1780</span></a>  
<a name="l1781"><span class="linenum">1781</span></a>      <span class="comment">/**</span>
<a name="l1782"><span class="linenum">1782</span></a>  <span class="comment">     * Is this Chrome?</span>
<a name="l1783"><span class="linenum">1783</span></a>  <span class="comment">     * @return boolean</span>
<a name="l1784"><span class="linenum">1784</span></a>  <span class="comment">     */</span>
<a name="l1785"><span class="linenum">1785</span></a>  	function <a class="function" onClick="logFunction('is_chrome')" href="../../../_functions/is_chrome.html" onMouseOver="funcPopup(event,'is_chrome')">is_chrome</a>()
<a name="l1786"><span class="linenum">1786</span></a>      {
<a name="l1787"><span class="linenum">1787</span></a>          if( ! isset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_chrome')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_chrome.html">is_chrome</a>) )
<a name="l1788"><span class="linenum">1788</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>();
<a name="l1789"><span class="linenum">1789</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_chrome')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_chrome.html">is_chrome</a>;
<a name="l1790"><span class="linenum">1790</span></a>      }
<a name="l1791"><span class="linenum">1791</span></a>  
<a name="l1792"><span class="linenum">1792</span></a>      <span class="comment">/**</span>
<a name="l1793"><span class="linenum">1793</span></a>  <span class="comment">     * Is this Safari?</span>
<a name="l1794"><span class="linenum">1794</span></a>  <span class="comment">     * @return boolean</span>
<a name="l1795"><span class="linenum">1795</span></a>  <span class="comment">     */</span>
<a name="l1796"><span class="linenum">1796</span></a>  	function <a class="function" onClick="logFunction('is_safari')" href="../../../_functions/is_safari.html" onMouseOver="funcPopup(event,'is_safari')">is_safari</a>()
<a name="l1797"><span class="linenum">1797</span></a>      {
<a name="l1798"><span class="linenum">1798</span></a>          if( ! isset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_safari')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_safari.html">is_safari</a>) )
<a name="l1799"><span class="linenum">1799</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>();
<a name="l1800"><span class="linenum">1800</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_safari')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_safari.html">is_safari</a>;
<a name="l1801"><span class="linenum">1801</span></a>      }
<a name="l1802"><span class="linenum">1802</span></a>  
<a name="l1803"><span class="linenum">1803</span></a>      <span class="comment">/**</span>
<a name="l1804"><span class="linenum">1804</span></a>  <span class="comment">     * Is this Opera?</span>
<a name="l1805"><span class="linenum">1805</span></a>  <span class="comment">     * @return boolean</span>
<a name="l1806"><span class="linenum">1806</span></a>  <span class="comment">     */</span>
<a name="l1807"><span class="linenum">1807</span></a>  	function <a class="function" onClick="logFunction('is_opera')" href="../../../_functions/is_opera.html" onMouseOver="funcPopup(event,'is_opera')">is_opera</a>()
<a name="l1808"><span class="linenum">1808</span></a>      {
<a name="l1809"><span class="linenum">1809</span></a>          if( ! isset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_opera')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_opera.html">is_opera</a>) )
<a name="l1810"><span class="linenum">1810</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>();
<a name="l1811"><span class="linenum">1811</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_opera')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_opera.html">is_opera</a>;
<a name="l1812"><span class="linenum">1812</span></a>      }
<a name="l1813"><span class="linenum">1813</span></a>  
<a name="l1814"><span class="linenum">1814</span></a>      <span class="comment">/**</span>
<a name="l1815"><span class="linenum">1815</span></a>  <span class="comment">     * Is this Netscape4?</span>
<a name="l1816"><span class="linenum">1816</span></a>  <span class="comment">     * @return boolean</span>
<a name="l1817"><span class="linenum">1817</span></a>  <span class="comment">     */</span>
<a name="l1818"><span class="linenum">1818</span></a>  	function <a class="function" onClick="logFunction('is_NS4')" href="../../../_functions/is_ns4.html" onMouseOver="funcPopup(event,'is_ns4')">is_NS4</a>()
<a name="l1819"><span class="linenum">1819</span></a>      {
<a name="l1820"><span class="linenum">1820</span></a>          if( ! isset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('NS4')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/NS4.html">NS4</a>) )
<a name="l1821"><span class="linenum">1821</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>();
<a name="l1822"><span class="linenum">1822</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_NS4')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_NS4.html">is_NS4</a>;
<a name="l1823"><span class="linenum">1823</span></a>      }
<a name="l1824"><span class="linenum">1824</span></a>  
<a name="l1825"><span class="linenum">1825</span></a>  
<a name="l1826"><span class="linenum">1826</span></a>      <span class="comment">/**</span>
<a name="l1827"><span class="linenum">1827</span></a>  <span class="comment">     * Is this a browser hit?</span>
<a name="l1828"><span class="linenum">1828</span></a>  <span class="comment">     * @return boolean</span>
<a name="l1829"><span class="linenum">1829</span></a>  <span class="comment">     */</span>
<a name="l1830"><span class="linenum">1830</span></a>  	function <a class="function" onClick="logFunction('is_browser')" href="../../../_functions/is_browser.html" onMouseOver="funcPopup(event,'is_browser')">is_browser</a>()
<a name="l1831"><span class="linenum">1831</span></a>      {
<a name="l1832"><span class="linenum">1832</span></a>          if( ! isset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_browser')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_browser.html">is_browser</a>) )
<a name="l1833"><span class="linenum">1833</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_browser')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_browser.html">is_browser</a> = (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_agent_type')" href="../../../_functions/get_agent_type.html" onMouseOver="funcPopup(event,'get_agent_type')">get_agent_type</a>() == 'browser');
<a name="l1834"><span class="linenum">1834</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_browser')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_browser.html">is_browser</a>;
<a name="l1835"><span class="linenum">1835</span></a>      }
<a name="l1836"><span class="linenum">1836</span></a>  
<a name="l1837"><span class="linenum">1837</span></a>  
<a name="l1838"><span class="linenum">1838</span></a>      <span class="comment">/**</span>
<a name="l1839"><span class="linenum">1839</span></a>  <span class="comment">     * Is this a robot hit?</span>
<a name="l1840"><span class="linenum">1840</span></a>  <span class="comment">     * @return boolean</span>
<a name="l1841"><span class="linenum">1841</span></a>  <span class="comment">     */</span>
<a name="l1842"><span class="linenum">1842</span></a>  	function <a class="function" onClick="logFunction('is_robot')" href="../../../_functions/is_robot.html" onMouseOver="funcPopup(event,'is_robot')">is_robot</a>()
<a name="l1843"><span class="linenum">1843</span></a>      {
<a name="l1844"><span class="linenum">1844</span></a>          if( ! isset(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_robot')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_robot.html">is_robot</a>) )
<a name="l1845"><span class="linenum">1845</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_robot')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_robot.html">is_robot</a> = (<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('get_agent_type')" href="../../../_functions/get_agent_type.html" onMouseOver="funcPopup(event,'get_agent_type')">get_agent_type</a>() == 'robot');
<a name="l1846"><span class="linenum">1846</span></a>          return <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('is_robot')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/is_robot.html">is_robot</a>;
<a name="l1847"><span class="linenum">1847</span></a>      }
<a name="l1848"><span class="linenum">1848</span></a>  
<a name="l1849"><span class="linenum">1849</span></a>  
<a name="l1850"><span class="linenum">1850</span></a>      <span class="comment">/**</span>
<a name="l1851"><span class="linenum">1851</span></a>  <span class="comment">     * Get a version of browser</span>
<a name="l1852"><span class="linenum">1852</span></a>  <span class="comment">     *</span>
<a name="l1853"><span class="linenum">1853</span></a>  <span class="comment">     * @return integer Browser version</span>
<a name="l1854"><span class="linenum">1854</span></a>  <span class="comment">     */</span>
<a name="l1855"><span class="linenum">1855</span></a>  	function <a class="function" onClick="logFunction('get_browser_version')" href="../../../_functions/get_browser_version.html" onMouseOver="funcPopup(event,'get_browser_version')">get_browser_version</a>()
<a name="l1856"><span class="linenum">1856</span></a>      {
<a name="l1857"><span class="linenum">1857</span></a>          if( <a class="phpfunction" onClick="logFunction('is_null')" href="../../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('browser_version')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/browser_version.html">browser_version</a> ) )
<a name="l1858"><span class="linenum">1858</span></a>          {    // Initialize browser version on first calling:
<a name="l1859"><span class="linenum">1859</span></a>              <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('detect_useragent')" href="../../../_functions/detect_useragent.html" onMouseOver="funcPopup(event,'detect_useragent')">detect_useragent</a>();
<a name="l1860"><span class="linenum">1860</span></a>          }
<a name="l1861"><span class="linenum">1861</span></a>  
<a name="l1862"><span class="linenum">1862</span></a>          return <a class="phpfunction" onClick="logFunction('intval')" href="../../../_functions/intval.html" onMouseOver="phpfuncPopup(event,'intval')">intval</a>( <a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('browser_version')" class="var it10673" onMouseOver="hilite(10673)" onMouseOut="lolite()" href="../../../_variables/browser_version.html">browser_version</a> );
<a name="l1863"><span class="linenum">1863</span></a>      }
<a name="l1864"><span class="linenum">1864</span></a>  }
<a name="l1865"><span class="linenum">1865</span></a>  
<a name="l1866"><span class="linenum">1866</span></a>  ?&gt;
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'utf8_strtolower': ['utf8_strtolower', 'utf8_strtolower( ) ', [['inc/_ext','_portable_utf8.php',1433]], 74],
'is_opera': ['is_opera', 'Is this Opera? ', [['inc/sessions/model','_hit.class.php',1803]], 1],
'is_browser': ['is_browser', 'Is this a browser hit? ', [['inc/sessions/model','_hit.class.php',1826]], 0],
'get_agent_id': ['get_agent_id', 'Get the User agent\'s ID. ', [['inc/sessions/model','_hit.class.php',1101]], 1],
'extract_params_from_referer': ['extract_params_from_referer', 'Extracts a keyword from a raw not encoded URL. Will only extract keyword if a known search engine has been detected. Returns the keyword: - in UTF8: automatically converted from other charsets when applicable - strtolowered: "QUErY test!" will return "query test!" - trimmed: extra spaces before and after are removed ', [['inc/sessions/model','_hit.class.php',1460]], 5],
'get_search_engine_names': ['get_search_engine_names', '', [['inc/sessions/model','_hit.class.php',1248]], 1],
'resume': ['resume', 'Resumes the timer on a category. ', [['inc/_core/model','_timer.class.php',125]], 49],
'load_funcs': ['load_funcs', '', [['inc/_core','_misc.funcs.php',158]], 242],
'is_admin_page': ['is_admin_page', 'Is the current page an admin/backoffice page? ', [['inc/_core','_misc.funcs.php',5028]], 118],
'save_error_state': ['save_error_state', 'Save the vars responsible for error handling. This can be chained. ', [['inc/_core/model/db','_db.class.php',713]], 7],
'method': ['method', 'Gets/sets the xmlrpc method to be invoked ', [['inc/_ext/xmlrpc','_xmlrpc.inc.php',2166]], 14],
'validate_url': ['validate_url', 'Check the validity of a given URL ', [['inc/_core','_url.funcs.php',21]], 9],
'can_check_encoding': ['can_check_encoding', 'Can we check for valid encodings of strings, using {@link check_encoding()}? ', [['inc/locales','_locale.funcs.php',1096]], 1],
'is_gecko': ['is_gecko', 'Is this Gecko? ', [['inc/sessions/model','_hit.class.php',1702]], 1],
'hit': ['hit', 'Constructor ', [['inc/sessions/model','_hit.class.php',226]], 10],
'is_chrome': ['is_chrome', 'Is this Chrome? ', [['inc/sessions/model','_hit.class.php',1781]], 0],
'is_browser_reload': ['is_browser_reload', 'Is this a browser reload (F5)? ', [['inc/sessions/model','_hit.class.php',1372]], 0],
'is_ie': ['is_ie', 'Is this Internet Explorer? ', [['inc/sessions/model','_hit.class.php',1735]], 6],
'detect_admin_page': ['detect_admin_page', 'Detect admin page ', [['inc/sessions/model','_hit.class.php',297]], 2],
'get': ['get', 'Get a member param by its name ', [['inc/items/model','_item.class.php',6187],['inc/_core/model/db','_sql.class.php',50],['inc/_core/model/dataobjects','_dataobject.class.php',834],['inc/plugins/model','_pluginusersettings.class.php',40],['inc/users/model','_user.class.php',1227],['rsc/js/tiny_mce/plugins/spellchecker/includes','Engine.php',145],['inc/settings/model','_abstractsettings.class.php',252],['inc/settings/model','_generalsettings.class.php',379],['inc/users/model','_usersettings.class.php',148],['inc/_ext/swift/classes/Swift/Mime','HeaderSet.php',95],['inc/links/model','_linkcomment.class.php',150],['inc/links/model','_linkitem.class.php',205],['inc/sessions/model','_session.class.php',428],['inc/collections/model','_blog.class.php',1842],['inc/comments/model','_comment.class.php',386],['inc/cron/model','_cronjob.class.php',89],['inc/plugins/model','_pluginsettings.class.php',40],['inc/links/model','_linkowner.class.php',218],['plugins/twitter_plugin/twitteroauth','twitteroauth.php',146],['inc/slugs/model','_slug.class.php',68],['inc/users/model','_groupsettings.class.php',124],['inc/chapters/model','_chapter.class.php',600],['inc/antispam/model','_iprange.class.php',60],['inc/files/model','_file.class.php',555],['inc/links/model','_linkuser.class.php',154],['inc/_ext/swift/classes/Swift/Mime','SimpleHeaderSet.php',165]], 2630],
'is_firefox': ['is_firefox', 'Is this Firefox? ', [['inc/sessions/model','_hit.class.php',1691]], 1],
'get_search_engine': ['get_search_engine', 'Get name of search engine ', [['inc/sessions/model','_hit.class.php',1043]], 0],
'get_remote_host': ['get_remote_host', 'Get the remote hostname. ', [['inc/sessions/model','_hit.class.php',1161]], 2],
'detect_referer': ['detect_referer', 'Get & Analyze referer ', [['inc/sessions/model','_hit.class.php',348]], 6],
'get_base_domain': ['get_base_domain', 'Get the base domain (without protocol and any subdomain) of an URL. ', [['inc/_core','_misc.funcs.php',4713]], 1],
'get_param_from_string': ['get_param_from_string', '', [['inc/sessions/model','_hit.class.php',1198]], 7],
'get_agent_type': ['get_agent_type', 'Get the User agent\'s type. ', [['inc/sessions/model','_hit.class.php',1146]], 5],
'trigger_event_first_true': ['trigger_event_first_true', 'Call all plugins for a given event, until the first one returns true. ', [['inc/plugins/model','_plugins.class.php',852]], 17],
't_': ['t_', 'Provide translation in the context of this module: ', [['inc/_core/model','_module.class.php',67],['rsc/js','blog_widgets.js',467],['inc/skins/model','_skin.class.php',1131],['inc/plugins','_plugin.class.php',2799],['inc/locales','_locale.funcs.php',29],['inc/locales','_locale.funcs.php',226]], 12118],
'get_action': ['get_action', 'Get hit action ', [['inc/sessions/model','_hit.class.php',977]], 1],
'is_ns4': ['is_ns4', 'Is this Netscape4? ', [['inc/sessions/model','_hit.class.php',1814]], 1],
'get_ip_list': ['get_ip_list', 'Get list of client IP addresses from REMOTE_ADDR and HTTP_X_FORWARDED_FOR, in this order. \'\' is used when no IP could be found. ', [['inc/_core','_misc.funcs.php',4617]], 13],
'log': ['log', 'Log a hit on a blog page / rss feed. ', [['inc/sessions/model','_hit.class.php',716],['inc/_core/model','_log.class.php',70],['rsc/js/jquery','jquery.tablesorter.js',142]], 89],
'get_keyphrase': ['get_keyphrase', 'Get the keyphrase from the referer ', [['inc/sessions/model','_hit.class.php',1005]], 1],
'restore_error_state': ['restore_error_state', 'Call this after {@link save_halt_on_error()} to restore the previous error state. This can be chained. ', [['inc/_core/model/db','_db.class.php',729]], 7],
'get_browser_version': ['get_browser_version', 'Get a version of browser ', [['inc/sessions/model','_hit.class.php',1850]], 10],
'is_robot': ['is_robot', 'Is this a robot hit? ', [['inc/sessions/model','_hit.class.php',1838]], 0],
'is_new_view': ['is_new_view', 'Determine if a hit is a new view (not reloaded or from a robot). ', [['inc/sessions/model','_hit.class.php',1311]], 0],
'add': ['add', '', [['inc/_ext/pclzip','pclzip.lib.php',455],['rsc/js/tiny_mce/plugins/spellchecker/includes','Engine.php',141],['inc/skins/model','_skincache.class.php',50],['inc/_core/model','_messages.class.php',114],['inc/_ext/swift/classes/Swift/Plugins','LoggerPlugin.php',33],['inc/_ext/swift/classes/Swift/Plugins','Logger.php',20],['inc/files/model','_filetypecache.class.php',38],['inc/_core/model/dataobjects','_dataobjectcache.class.php',339],['inc/_ext/swift/classes/Swift/Plugins/Loggers','EchoLogger.php',33],['inc/_core/model','_log.class.php',109],['inc/_core/model','_log.class.php',577],['inc/users/model','_usercache.class.php',239],['inc/_ext/swift/classes/Swift/Plugins/Loggers','ArrayLogger.php',44],['inc/links/model','_linkcache.class.php',86],['inc/users/model','_groupsettings.class.php',103],['inc/chapters/model','_chaptercache.class.php',98],['inc/files/model','_filelist.class.php',373],['inc/collections/model','_blogcache.class.php',50]], 1695],
'get_agent_name': ['get_agent_name', 'Get the User agent\'s name. ', [['inc/sessions/model','_hit.class.php',1116]], 2],
'record_the_hit': ['record_the_hit', 'This records the hit. You should not call this directly, but {@link Hit::log()} instead! ', [['inc/sessions/model','_hit.class.php',798]], 2],
'get_var': ['get_var', 'Get one variable from the DB - see docs for more detail ', [['inc/_core/model/db','_db.class.php',952]], 166],
'get_user_agent': ['get_user_agent', 'Get the User agent\'s signature. ', [['inc/sessions/model','_hit.class.php',1062]], 8],
'detect_useragent': ['detect_useragent', 'Set {@link $user_agent} and detect the browser. This function also sets {@link $agent_type}. ', [['inc/sessions/model','_hit.class.php',542]], 23],
'query': ['query', 'Run Query: GET DATA ROWS *** HEAVY *** ', [['inc/items/model','_itemlist.class.php',249],['inc/items/model','_itemlistlight.class.php',742],['inc/comments/model','_commentlist.class.php',507],['inc/users/model','_userlist.class.php',511],['inc/_core/ui/results','_results.class.php',468],['inc/_core/model/db','_db.class.php',749]], 1144],
'get_agent_platform': ['get_agent_platform', 'Get the User agent\'s platform. ', [['inc/sessions/model','_hit.class.php',1131]], 1],
'commit': ['commit', 'For any bytes that are currently buffered inside the stream, force them off the buffer. ', [['inc/_ext/swift/classes/Swift/ByteStream','AbstractFilterableInputStream.php',97],['inc/_ext/swift/classes/Swift/Signers','DKIMSigner.php',223],['inc/_ext/swift/classes/Swift/ByteStream','ArrayByteStream.php',116],['inc/_ext/swift/classes/Swift/Plugins','BandwidthMonitorPlugin.php',90],['inc/_ext/swift/classes/Swift','InputByteStream.php',41],['inc/_ext/swift/classes/Swift/Signers','DomainKeySigner.php',178],['inc/_ext/swift/classes/Swift/KeyCache','SimpleKeyCacheInputStream.php',71],['inc/_core/model/db','_db.class.php',1589]], 135],
'is_search_referer': ['is_search_referer', '', [['inc/sessions/model','_hit.class.php',1399]], 2],
'escape': ['escape', '', [['rsc/js/jquery','jquery.ui.b2evo.js',6537],['rsc/js/jquery','jquery.ui.all.js',9814],['inc/_core/model/db','_db.class.php',482]], 103],
'list': ['list', '', [['rsc/js/bootstrap','typeahead.bundle.js',156]], 105],
'get_referer': ['get_referer', 'Get HTTP referrer/referer. ', [['inc/sessions/model','_hit.class.php',317]], 1],
'is_lynx': ['is_lynx', 'Is this Lynx? ', [['inc/sessions/model','_hit.class.php',1680]], 5],
'is_macie': ['is_macie', 'Is this MacIE? ', [['inc/sessions/model','_hit.class.php',1724]], 1],
'get_browser_caps': ['get_browser_caps', 'Get browser capabilities through {@link get_browser()}. ', [['inc/sessions/model','_hit.class.php',698]], 2],
'get_referer_domain_id': ['get_referer_domain_id', 'Get referer_domain_ID (ID of the referer in T_basedomains). ', [['inc/sessions/model','_hit.class.php',476]], 1],
'is_winie': ['is_winie', 'Is this WinIE? ', [['inc/sessions/model','_hit.class.php',1713]], 2],
'get_serprank': ['get_serprank', 'Get the serprank from the referer ', [['inc/sessions/model','_hit.class.php',1024]], 1],
'check_encoding': ['check_encoding', 'Check if the string is valid for the specified encoding. ', [['inc/locales','_locale.funcs.php',1107]], 1],
'get_country_codes': ['get_country_codes', 'Get array of 2 letter ISO country codes ', [['inc/sessions/model','_hit.class.php',1214]], 1],
'convert_charset': ['convert_charset', 'Convert a string from one charset to another. ', [['inc/locales','_locale.funcs.php',1025]], 16],
'is_safari': ['is_safari', 'Is this Safari? ', [['inc/sessions/model','_hit.class.php',1792]], 0],
'get_row': ['get_row', 'Get one row from the DB. ', [['inc/_core/model/db','_db.class.php',987]], 60],
'quote': ['quote', 'Quote a msgid/msgstr, preferrable with single quotes. ', [['inc/locales','_pofile.class.php',261],['inc/_core/model/db','_db.class.php',491]], 1085],
'pause': ['pause', 'Pauses a timer category. It may me resumed later on, see {@link resume()}. ', [['inc/_core/model','_timer.class.php',95]], 112],
'get_param': ['get_param', 'Get the value of a param. ', [['inc/_core','_param.funcs.php',1694],['inc/widgets/model','_widget.class.php',343]], 340],
'should_be_logged': ['should_be_logged', 'Tell if a HIT should be logged: ', [['inc/sessions/model','_hit.class.php',767]], 2],
'get_hit_type': ['get_hit_type', 'Get hit type from the uri ', [['inc/sessions/model','_hit.class.php',945]], 1],
'get_lossy_url': ['get_lossy_url', 'Reduce URL to more minimal form.  2 letter country codes are replaced by \'{}\', while other parts are simply removed. ', [['inc/sessions/model','_hit.class.php',1267]], 1],
'strtolower': ['strtolower', '', [], 202],
'is_numeric': ['is_numeric', '', [], 14],
'parse_str': ['parse_str', '', [], 1],
'preg_replace': ['preg_replace', '', [], 325],
'array_push': ['array_push', '', [], 46],
'defined': ['defined', '', [], 962],
'is_null': ['is_null', '', [], 299],
'implode': ['implode', '', [], 571],
'getenv': ['getenv', '', [], 3],
'var_export': ['var_export', '', [], 48],
'preg_match': ['preg_match', '', [], 423],
'strip_tags': ['strip_tags', '', [], 53],
'in_array': ['in_array', '', [], 417],
'array_map': ['array_map', '', [], 41],
'explode': ['explode', '', [], 263],
'date': ['date', '', [], 446],
'strpos': ['strpos', '', [], 347],
'array_keys': ['array_keys', '', [], 94],
'strncmp': ['strncmp', '', [], 2],
'gethostbyaddr': ['gethostbyaddr', '', [], 5],
'strstr': ['strstr', '', [], 30],
'is_array': ['is_array', '', [], 311],
'array_key_exists': ['array_key_exists', '', [], 62],
'intval': ['intval', '', [], 221],
'substr': ['substr', '', [], 745],
'get_browser': ['get_browser', '', [], 1],
'trim': ['trim', '', [], 398],
'parse_url': ['parse_url', '', [], 19],
'ctype_digit': ['ctype_digit', '', [], 4],
'str_replace': ['str_replace', '', [], 531],
'dirname': ['dirname', '', [], 182],
'urldecode': ['urldecode', '', [], 25]};
CLASS_DATA={
'hit': ['hit', 'A hit to a blog. ', [['inc/sessions/model','_hit.class.php',21]], 12]};
CONST_DATA={
'EVO_MAIN_INIT': ['EVO_MAIN_INIT', '', [['install','index.php',26],['inc','_main.inc.php',36],['install','debug.php',22]], 912]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Sat Nov 21 22:13:19 2015</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>

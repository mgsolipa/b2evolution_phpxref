<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /inc/antispam/antispam.ctrl.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Sat Nov 21 22:13:19 2015 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='inc/antispam';
filename='antispam.ctrl.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/inc/antispam/</a> -> <a href="antispam.ctrl.php.html">antispam.ctrl.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="antispam.ctrl.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="antispam.ctrl.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">/**</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment"> * This file implements the UI controller for the antispam management.</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment"> *</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment"> * This file is part of the b2evolution/evocms project - {@link http://b2evolution.net/}.</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment"> * See also {@link https://github.com/b2evolution/b2evolution}.</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment"> *</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment"> * @license GNU GPL v2 - {@link http://b2evolution.net/about/gnu-gpl-license}</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment"> *</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment"> * @copyright (c)2003-2015 by Francois Planque - {@link http://fplanque.com/}.</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment"> * Parts of this file are copyright (c)2004 by Vegar BERG GULDAL - {@link http://funky-m.com/}.</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment"> *</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment"> * @package admin</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment"> *</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment"> * @todo Allow applying / re-checking of the known data, not just after an update!</span>
<a name="l16"><span class="linenum">  16</span></a>  <span class="comment"> */</span>
<a name="l17"><span class="linenum">  17</span></a>  if( !<a class="phpfunction" onClick="logFunction('defined')" href="../../_functions/defined.html" onMouseOver="phpfuncPopup(event,'defined')">defined</a>('<a class="constant" onClick="logConstant('EVO_MAIN_INIT')" href="../../_constants/EVO_MAIN_INIT.html" onMouseOver="constPopup(event,'EVO_MAIN_INIT')">EVO_MAIN_INIT</a>') ) die( 'Please, do not access this page directly.' );
<a name="l18"><span class="linenum">  18</span></a>  
<a name="l19"><span class="linenum">  19</span></a>  <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'display_mode', 'string' );
<a name="l20"><span class="linenum">  20</span></a>  
<a name="l21"><span class="linenum">  21</span></a>  if( <a class="var it1195" onMouseOver="hilite(1195)" onMouseOut="lolite()" onClick="logVariable('display_mode')" href="../../_variables/display_mode.html">$display_mode</a> != 'js' )
<a name="l22"><span class="linenum">  22</span></a>  {
<a name="l23"><span class="linenum">  23</span></a>      <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('set_path')" href="../../_functions/set_path.html" onMouseOver="funcPopup(event,'set_path')">set_path</a>( 'options', 'antispam' );
<a name="l24"><span class="linenum">  24</span></a>  }
<a name="l25"><span class="linenum">  25</span></a>  else
<a name="l26"><span class="linenum">  26</span></a>  {    // This is an Ajax response
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment">    // fp&gt; TODO: have a more systematic way of handling AJAX responses</span>
<a name="l28"><span class="linenum">  28</span></a>      <a class="function" onClick="logFunction('header_content_type')" href="../../_functions/header_content_type.html" onMouseOver="funcPopup(event,'header_content_type')">header_content_type</a>( 'text/html', <a class="var it927" onMouseOver="hilite(927)" onMouseOut="lolite()" onClick="logVariable('io_charset')" href="../../_variables/io_charset.html">$io_charset</a> );
<a name="l29"><span class="linenum">  29</span></a>  }
<a name="l30"><span class="linenum">  30</span></a>  
<a name="l31"><span class="linenum">  31</span></a>  <a class="function" onClick="logFunction('param_action')" href="../../_functions/param_action.html" onMouseOver="funcPopup(event,'param_action')">param_action</a>( '' );
<a name="l32"><span class="linenum">  32</span></a>  <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'confirm', 'string' );
<a name="l33"><span class="linenum">  33</span></a>  <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'keyword', 'string', '', true );
<a name="l34"><span class="linenum">  34</span></a>  <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'domain', 'string' );
<a name="l35"><span class="linenum">  35</span></a>  <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'filteron', 'string', '', true );
<a name="l36"><span class="linenum">  36</span></a>  <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'filter', 'array:string', array() );
<a name="l37"><span class="linenum">  37</span></a>  
<a name="l38"><span class="linenum">  38</span></a>  <a class="var it1211" onMouseOver="hilite(1211)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../_variables/tab.html">$tab</a> = <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'tab', 'string', '', true );
<a name="l39"><span class="linenum">  39</span></a>  <a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('tab3')" href="../../_variables/tab3.html">$tab3</a> = <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'tab3', 'string', '', true );
<a name="l40"><span class="linenum">  40</span></a>  <a class="var it8875" onMouseOver="hilite(8875)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a> = <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'tool', 'string', '', true );
<a name="l41"><span class="linenum">  41</span></a>  
<a name="l42"><span class="linenum">  42</span></a>  if( isset(<a class="var it4141" onMouseOver="hilite(4141)" onMouseOut="lolite()" onClick="logVariable('filter')" href="../../_variables/filter.html">$filter</a>['off']) )
<a name="l43"><span class="linenum">  43</span></a>  {
<a name="l44"><span class="linenum">  44</span></a>      unset( <a class="var it8876" onMouseOver="hilite(8876)" onMouseOut="lolite()" onClick="logVariable('filteron')" href="../../_variables/filteron.html">$filteron</a> );
<a name="l45"><span class="linenum">  45</span></a>      <a class="function" onClick="logFunction('forget_param')" href="../../_functions/forget_param.html" onMouseOver="funcPopup(event,'forget_param')">forget_param</a>( 'filteron' );
<a name="l46"><span class="linenum">  46</span></a>  }
<a name="l47"><span class="linenum">  47</span></a>  
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment">// Check permission:</span>
<a name="l49"><span class="linenum">  49</span></a>  <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'options', 'view', true );
<a name="l50"><span class="linenum">  50</span></a>  <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'spamblacklist', 'view', true );
<a name="l51"><span class="linenum">  51</span></a>  
<a name="l52"><span class="linenum">  52</span></a>  
<a name="l53"><span class="linenum">  53</span></a>  if( <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'iprange_ID', 'integer', '', true) )
<a name="l54"><span class="linenum">  54</span></a>  {    // Load IP Range object
<a name="l55"><span class="linenum">  55</span></a>      <a class="function" onClick="logFunction('load_class')" href="../../_functions/load_class.html" onMouseOver="funcPopup(event,'load_class')">load_class</a>( 'antispam/model/_iprange.class.php', 'IPRange' );
<a name="l56"><span class="linenum">  56</span></a>      <a class="var it428" onMouseOver="hilite(428)" onMouseOut="lolite()" onClick="logVariable('IPRangeCache')" href="../../_variables/IPRangeCache.html">$IPRangeCache</a> = &amp; get_IPRangeCache();
<a name="l57"><span class="linenum">  57</span></a>      if( ( <a class="var it6178" onMouseOver="hilite(6178)" onMouseOut="lolite()" onClick="logVariable('edited_IPRange')" href="../../_variables/edited_IPRange.html">$edited_IPRange</a> = &amp; <a class="var it428" onMouseOver="hilite(428)" onMouseOut="lolite()" onClick="logVariable('IPRangeCache')" href="../../_variables/IPRangeCache.html">$IPRangeCache</a>-&gt;get_by_ID( <a class="var it5839" onMouseOver="hilite(5839)" onMouseOut="lolite()" onClick="logVariable('iprange_ID')" href="../../_variables/iprange_ID.html">$iprange_ID</a>, false ) ) === false )
<a name="l58"><span class="linenum">  58</span></a>      {    // We could not find the goal to edit:
<a name="l59"><span class="linenum">  59</span></a>          unset( <a class="var it6178" onMouseOver="hilite(6178)" onMouseOut="lolite()" onClick="logVariable('edited_IPRange')" href="../../_variables/edited_IPRange.html">$edited_IPRange</a> );
<a name="l60"><span class="linenum">  60</span></a>          <a class="function" onClick="logFunction('forget_param')" href="../../_functions/forget_param.html" onMouseOver="funcPopup(event,'forget_param')">forget_param</a>( 'iprange_ID' );
<a name="l61"><span class="linenum">  61</span></a>          <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Requested &amp;laquo;%s&amp;raquo; object does not exist any longer.'), <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('IP Range') ), 'error' );
<a name="l62"><span class="linenum">  62</span></a>      }
<a name="l63"><span class="linenum">  63</span></a>  }
<a name="l64"><span class="linenum">  64</span></a>  
<a name="l65"><span class="linenum">  65</span></a>  switch( <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> )
<a name="l66"><span class="linenum">  66</span></a>  {
<a name="l67"><span class="linenum">  67</span></a>      case 'ban': // only an action if further &quot;actions&quot; given
<a name="l68"><span class="linenum">  68</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l69"><span class="linenum">  69</span></a>          <a class="var it478" onMouseOver="hilite(478)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'antispam' );
<a name="l70"><span class="linenum">  70</span></a>  
<a name="l71"><span class="linenum">  71</span></a>  <span class="comment">        // Check permission:</span>
<a name="l72"><span class="linenum">  72</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'spamblacklist', 'edit', true ); <span class="comment">// TODO: This should become different for 'edit'/'add' perm level - check for 'add' here.</span>
<a name="l73"><span class="linenum">  73</span></a>  
<a name="l74"><span class="linenum">  74</span></a>          <a class="var it1409" onMouseOver="hilite(1409)" onMouseOut="lolite()" onClick="logVariable('keyword')" href="../../_variables/keyword.html">$keyword</a> = <a class="function" onClick="logFunction('utf8_substr')" href="../../_functions/utf8_substr.html" onMouseOver="funcPopup(event,'utf8_substr')">utf8_substr</a>( <a class="var it1409" onMouseOver="hilite(1409)" onMouseOut="lolite()" onClick="logVariable('keyword')" href="../../_variables/keyword.html">$keyword</a>, 0, 80 );
<a name="l75"><span class="linenum">  75</span></a>          <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'delhits', 'integer', 0 );
<a name="l76"><span class="linenum">  76</span></a>          <a class="var it8877" onMouseOver="hilite(8877)" onMouseOut="lolite()" onClick="logVariable('all_statuses')" href="../../_variables/all_statuses.html">$all_statuses</a> = <a class="function" onClick="logFunction('get_visibility_statuses')" href="../../_functions/get_visibility_statuses.html" onMouseOver="funcPopup(event,'get_visibility_statuses')">get_visibility_statuses</a>( 'keys', array( 'trash', 'redirected' ) );
<a name="l77"><span class="linenum">  77</span></a>          <a class="var it8878" onMouseOver="hilite(8878)" onMouseOut="lolite()" onClick="logVariable('delstatuses')" href="../../_variables/delstatuses.html">$delstatuses</a> = array();
<a name="l78"><span class="linenum">  78</span></a>          foreach( <a class="var it8877" onMouseOver="hilite(8877)" onMouseOut="lolite()" onClick="logVariable('all_statuses')" href="../../_variables/all_statuses.html">$all_statuses</a> as <a class="var it16" onMouseOver="hilite(16)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../_variables/status.html">$status</a> )
<a name="l79"><span class="linenum">  79</span></a>          { // collect which comments should be delteded
<a name="l80"><span class="linenum">  80</span></a>              if( <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'del'.<a class="var it16" onMouseOver="hilite(16)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../_variables/status.html">$status</a>, 'integer', 0 ) )
<a name="l81"><span class="linenum">  81</span></a>              { // matching comments with this status should be deleted
<a name="l82"><span class="linenum">  82</span></a>                  <a class="var it8878" onMouseOver="hilite(8878)" onMouseOut="lolite()" onClick="logVariable('delstatuses')" href="../../_variables/delstatuses.html">$delstatuses</a>[] = <a class="var it16" onMouseOver="hilite(16)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../_variables/status.html">$status</a>;
<a name="l83"><span class="linenum">  83</span></a>              }
<a name="l84"><span class="linenum">  84</span></a>          }
<a name="l85"><span class="linenum">  85</span></a>          <a class="var it8879" onMouseOver="hilite(8879)" onMouseOut="lolite()" onClick="logVariable('delcomments')" href="../../_variables/delcomments.html">$delcomments</a> = <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>( <a class="var it8878" onMouseOver="hilite(8878)" onMouseOut="lolite()" onClick="logVariable('delstatuses')" href="../../_variables/delstatuses.html">$delstatuses</a> );
<a name="l86"><span class="linenum">  86</span></a>          <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'blacklist_locally', 'integer', 0 );
<a name="l87"><span class="linenum">  87</span></a>          <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'report', 'integer', 0 );
<a name="l88"><span class="linenum">  88</span></a>  
<a name="l89"><span class="linenum">  89</span></a>  <span class="comment">        // Check if the string is too short,</span>
<a name="l90"><span class="linenum">  90</span></a>  <span class="comment">        // it has to be a minimum of 5 characters to avoid being too generic</span>
<a name="l91"><span class="linenum">  91</span></a>          if( <a class="function" onClick="logFunction('utf8_strlen')" href="../../_functions/utf8_strlen.html" onMouseOver="funcPopup(event,'utf8_strlen')">utf8_strlen</a>( <a class="var it1409" onMouseOver="hilite(1409)" onMouseOut="lolite()" onClick="logVariable('keyword')" href="../../_variables/keyword.html">$keyword</a> ) &lt; 5 )
<a name="l92"><span class="linenum">  92</span></a>          {
<a name="l93"><span class="linenum">  93</span></a>              <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The keyword &amp;laquo;%s&amp;raquo; is too short, it has to be a minimum of 5 characters!'), <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>( <a class="var it1409" onMouseOver="hilite(1409)" onMouseOut="lolite()" onClick="logVariable('keyword')" href="../../_variables/keyword.html">$keyword</a> ) ), 'error' );
<a name="l94"><span class="linenum">  94</span></a>              break;
<a name="l95"><span class="linenum">  95</span></a>          }
<a name="l96"><span class="linenum">  96</span></a>  
<a name="l97"><span class="linenum">  97</span></a>          if( empty( <a class="var it8359" onMouseOver="hilite(8359)" onMouseOut="lolite()" onClick="logVariable('confirm')" href="../../_variables/confirm.html">$confirm</a> ) )
<a name="l98"><span class="linenum">  98</span></a>          { // No confirmed action, Execute the ban actions only after confirmation
<a name="l99"><span class="linenum">  99</span></a>              break;
<a name="l100"><span class="linenum"> 100</span></a>          }
<a name="l101"><span class="linenum"> 101</span></a>  
<a name="l102"><span class="linenum"> 102</span></a>          if( <a class="var it8880" onMouseOver="hilite(8880)" onMouseOut="lolite()" onClick="logVariable('delhits')" href="../../_variables/delhits.html">$delhits</a> )
<a name="l103"><span class="linenum"> 103</span></a>          { // Delete all banned hit-log entries
<a name="l104"><span class="linenum"> 104</span></a>              <a class="var it86" onMouseOver="hilite(86)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> = <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( 'DELETE FROM T_hitlog
<a name="l105"><span class="linenum"> 105</span></a>                                                  WHERE hit_referer LIKE '.<a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( '%'.<a class="var it1409" onMouseOver="hilite(1409)" onMouseOut="lolite()" onClick="logVariable('keyword')" href="../../_variables/keyword.html">$keyword</a>.'%' ),
<a name="l106"><span class="linenum"> 106</span></a>                                                  'Delete all banned hit-log entries' );
<a name="l107"><span class="linenum"> 107</span></a>  
<a name="l108"><span class="linenum"> 108</span></a>              <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Deleted %d logged hits matching &amp;laquo;%s&amp;raquo;.'), <a class="var it86" onMouseOver="hilite(86)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a>, <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>( <a class="var it1409" onMouseOver="hilite(1409)" onMouseOut="lolite()" onClick="logVariable('keyword')" href="../../_variables/keyword.html">$keyword</a> ) ), 'success' );
<a name="l109"><span class="linenum"> 109</span></a>          }
<a name="l110"><span class="linenum"> 110</span></a>  
<a name="l111"><span class="linenum"> 111</span></a>          if( <a class="var it8879" onMouseOver="hilite(8879)" onMouseOut="lolite()" onClick="logVariable('delcomments')" href="../../_variables/delcomments.html">$delcomments</a> )
<a name="l112"><span class="linenum"> 112</span></a>          { // select banned comments
<a name="l113"><span class="linenum"> 113</span></a>              <a class="var it8881" onMouseOver="hilite(8881)" onMouseOut="lolite()" onClick="logVariable('del_condition')" href="../../_variables/del_condition.html">$del_condition</a> = <a class="function" onClick="logFunction('blog_restrict')" href="../../_functions/blog_restrict.html" onMouseOver="funcPopup(event,'blog_restrict')">blog_restrict</a>( <a class="var it8878" onMouseOver="hilite(8878)" onMouseOut="lolite()" onClick="logVariable('delstatuses')" href="../../_variables/delstatuses.html">$delstatuses</a> );
<a name="l114"><span class="linenum"> 114</span></a>              <a class="var it8882" onMouseOver="hilite(8882)" onMouseOut="lolite()" onClick="logVariable('keyword_cond')" href="../../_variables/keyword_cond.html">$keyword_cond</a> = '(comment_author LIKE '.<a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( '%'.<a class="var it1409" onMouseOver="hilite(1409)" onMouseOut="lolite()" onClick="logVariable('keyword')" href="../../_variables/keyword.html">$keyword</a>.'%' ).'
<a name="l115"><span class="linenum"> 115</span></a>                              OR comment_author_email LIKE '.<a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( '%'.<a class="function" onClick="logFunction('utf8_strtolower')" href="../../_functions/utf8_strtolower.html" onMouseOver="funcPopup(event,'utf8_strtolower')">utf8_strtolower</a>( <a class="var it1409" onMouseOver="hilite(1409)" onMouseOut="lolite()" onClick="logVariable('keyword')" href="../../_variables/keyword.html">$keyword</a> ).'%' ).'
<a name="l116"><span class="linenum"> 116</span></a>                              OR comment_author_url LIKE '.<a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( '%'.<a class="var it1409" onMouseOver="hilite(1409)" onMouseOut="lolite()" onClick="logVariable('keyword')" href="../../_variables/keyword.html">$keyword</a>.'%' ).'
<a name="l117"><span class="linenum"> 117</span></a>                              OR comment_content LIKE '.<a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>( '%'.<a class="var it1409" onMouseOver="hilite(1409)" onMouseOut="lolite()" onClick="logVariable('keyword')" href="../../_variables/keyword.html">$keyword</a>.'%' ).')';
<a name="l118"><span class="linenum"> 118</span></a>  <span class="comment">            // asimo&gt; we don't need transaction here </span>
<a name="l119"><span class="linenum"> 119</span></a>              <a class="var it1657" onMouseOver="hilite(1657)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../_variables/query.html">$query</a> = 'SELECT comment_ID FROM T_comments
<a name="l120"><span class="linenum"> 120</span></a>                              WHERE '.<a class="var it8882" onMouseOver="hilite(8882)" onMouseOut="lolite()" onClick="logVariable('keyword_cond')" href="../../_variables/keyword_cond.html">$keyword_cond</a>.<a class="var it8881" onMouseOver="hilite(8881)" onMouseOut="lolite()" onClick="logVariable('del_condition')" href="../../_variables/del_condition.html">$del_condition</a>;
<a name="l121"><span class="linenum"> 121</span></a>              <a class="var it8883" onMouseOver="hilite(8883)" onMouseOut="lolite()" onClick="logVariable('deleted_ids')" href="../../_variables/deleted_ids.html">$deleted_ids</a> = <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_col')" href="../../_functions/get_col.html" onMouseOver="funcPopup(event,'get_col')">get_col</a>( <a class="var it1657" onMouseOver="hilite(1657)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../_variables/query.html">$query</a>, 0, 'Get comment ids awaiting for delete' );
<a name="l122"><span class="linenum"> 122</span></a>              <a class="var it86" onMouseOver="hilite(86)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> = <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>( <a class="var it8883" onMouseOver="hilite(8883)" onMouseOut="lolite()" onClick="logVariable('deleted_ids')" href="../../_variables/deleted_ids.html">$deleted_ids</a> );
<a name="l123"><span class="linenum"> 123</span></a>              <a class="var it8883" onMouseOver="hilite(8883)" onMouseOut="lolite()" onClick="logVariable('deleted_ids')" href="../../_variables/deleted_ids.html">$deleted_ids</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( ',', <a class="var it8883" onMouseOver="hilite(8883)" onMouseOut="lolite()" onClick="logVariable('deleted_ids')" href="../../_variables/deleted_ids.html">$deleted_ids</a> );
<a name="l124"><span class="linenum"> 124</span></a>  
<a name="l125"><span class="linenum"> 125</span></a>  <span class="comment">            // Delete all comments data from DB</span>
<a name="l126"><span class="linenum"> 126</span></a>              <a class="class" onClick="logClass('Comment')" href="../../_classes/comment.html" onMouseOver="classPopup(event,'comment')">Comment</a>::<a class="function" onClick="logFunction('db_delete_where')" href="../../_functions/db_delete_where.html" onMouseOver="funcPopup(event,'db_delete_where')">db_delete_where</a>( 'Comment', <a class="var it8882" onMouseOver="hilite(8882)" onMouseOut="lolite()" onClick="logVariable('keyword_cond')" href="../../_variables/keyword_cond.html">$keyword_cond</a>.<a class="var it8881" onMouseOver="hilite(8881)" onMouseOut="lolite()" onClick="logVariable('del_condition')" href="../../_variables/del_condition.html">$del_condition</a> );
<a name="l127"><span class="linenum"> 127</span></a>  
<a name="l128"><span class="linenum"> 128</span></a>              <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Deleted %d comments matching &amp;laquo;%s&amp;raquo;.'), <a class="var it86" onMouseOver="hilite(86)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a>, <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>( <a class="var it1409" onMouseOver="hilite(1409)" onMouseOut="lolite()" onClick="logVariable('keyword')" href="../../_variables/keyword.html">$keyword</a> ) ), 'success' );
<a name="l129"><span class="linenum"> 129</span></a>          }
<a name="l130"><span class="linenum"> 130</span></a>  
<a name="l131"><span class="linenum"> 131</span></a>          if( <a class="var it8884" onMouseOver="hilite(8884)" onMouseOut="lolite()" onClick="logVariable('blacklist_locally')" href="../../_variables/blacklist_locally.html">$blacklist_locally</a> )
<a name="l132"><span class="linenum"> 132</span></a>          { // Local blacklist:
<a name="l133"><span class="linenum"> 133</span></a>              if( <a class="function" onClick="logFunction('antispam_create')" href="../../_functions/antispam_create.html" onMouseOver="funcPopup(event,'antispam_create')">antispam_create</a>( <a class="var it1409" onMouseOver="hilite(1409)" onMouseOut="lolite()" onClick="logVariable('keyword')" href="../../_variables/keyword.html">$keyword</a> ) )
<a name="l134"><span class="linenum"> 134</span></a>              { // Success
<a name="l135"><span class="linenum"> 135</span></a>                  <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The keyword &amp;laquo;%s&amp;raquo; has been blacklisted locally.'), <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>( <a class="var it1409" onMouseOver="hilite(1409)" onMouseOut="lolite()" onClick="logVariable('keyword')" href="../../_variables/keyword.html">$keyword</a> ) ), 'success' );
<a name="l136"><span class="linenum"> 136</span></a>              }
<a name="l137"><span class="linenum"> 137</span></a>              else
<a name="l138"><span class="linenum"> 138</span></a>              { // Failed
<a name="l139"><span class="linenum"> 139</span></a>                  <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Failed to add the keyword %s to black list locally.'), '&lt;b&gt;'.<a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>( <a class="var it1409" onMouseOver="hilite(1409)" onMouseOut="lolite()" onClick="logVariable('keyword')" href="../../_variables/keyword.html">$keyword</a> ).'&lt;/b&gt;' ), 'error' );
<a name="l140"><span class="linenum"> 140</span></a>              }
<a name="l141"><span class="linenum"> 141</span></a>          }
<a name="l142"><span class="linenum"> 142</span></a>  
<a name="l143"><span class="linenum"> 143</span></a>          if( <a class="var it8885" onMouseOver="hilite(8885)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> )
<a name="l144"><span class="linenum"> 144</span></a>          { // Report this keyword as abuse remotely:
<a name="l145"><span class="linenum"> 145</span></a>              <a class="function" onClick="logFunction('antispam_report_abuse')" href="../../_functions/antispam_report_abuse.html" onMouseOver="funcPopup(event,'antispam_report_abuse')">antispam_report_abuse</a>( <a class="var it1409" onMouseOver="hilite(1409)" onMouseOut="lolite()" onClick="logVariable('keyword')" href="../../_variables/keyword.html">$keyword</a> );
<a name="l146"><span class="linenum"> 146</span></a>          }
<a name="l147"><span class="linenum"> 147</span></a>  
<a name="l148"><span class="linenum"> 148</span></a>          if( ! <a class="var it8884" onMouseOver="hilite(8884)" onMouseOut="lolite()" onClick="logVariable('blacklist_locally')" href="../../_variables/blacklist_locally.html">$blacklist_locally</a> &amp;&amp; ! <a class="var it8885" onMouseOver="hilite(8885)" onMouseOut="lolite()" onClick="logVariable('report')" href="../../_variables/report.html">$report</a> &amp;&amp; ! <a class="var it8880" onMouseOver="hilite(8880)" onMouseOut="lolite()" onClick="logVariable('delhits')" href="../../_variables/delhits.html">$delhits</a> &amp;&amp; ! <a class="var it8879" onMouseOver="hilite(8879)" onMouseOut="lolite()" onClick="logVariable('delcomments')" href="../../_variables/delcomments.html">$delcomments</a> )
<a name="l149"><span class="linenum"> 149</span></a>          { // If no action has been selected
<a name="l150"><span class="linenum"> 150</span></a>              <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Please select at least one action to ban the keyword.' ), 'error' );
<a name="l151"><span class="linenum"> 151</span></a>          }
<a name="l152"><span class="linenum"> 152</span></a>  
<a name="l153"><span class="linenum"> 153</span></a>          if( <a class="var it1195" onMouseOver="hilite(1195)" onMouseOut="lolite()" onClick="logVariable('display_mode')" href="../../_variables/display_mode.html">$display_mode</a> != 'js' &amp;&amp; ! <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('has_errors')" href="../../_functions/has_errors.html" onMouseOver="funcPopup(event,'has_errors')">has_errors</a>() )
<a name="l154"><span class="linenum"> 154</span></a>          {
<a name="l155"><span class="linenum"> 155</span></a>  <span class="comment">            // Redirect so that a reload doesn't write to the DB twice:</span>
<a name="l156"><span class="linenum"> 156</span></a>              <a class="function" onClick="logFunction('header_redirect')" href="../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( '?ctrl=antispam', 303 ); <span class="comment">// Will EXIT</span>
<a name="l157"><span class="linenum"> 157</span></a>  <span class="comment">            // We have EXITed already at this point!!</span>
<a name="l158"><span class="linenum"> 158</span></a>          }
<a name="l159"><span class="linenum"> 159</span></a>  
<a name="l160"><span class="linenum"> 160</span></a>          if( <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('has_errors')" href="../../_functions/has_errors.html" onMouseOver="funcPopup(event,'has_errors')">has_errors</a>() )
<a name="l161"><span class="linenum"> 161</span></a>          { // Reset js display mode in order to display a correct view after confirmation
<a name="l162"><span class="linenum"> 162</span></a>              <a class="var it1195" onMouseOver="hilite(1195)" onMouseOut="lolite()" onClick="logVariable('display_mode')" href="../../_variables/display_mode.html">$display_mode</a> = '';
<a name="l163"><span class="linenum"> 163</span></a>              <a class="var it304" onMouseOver="hilite(304)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../../_variables/mode.html">$mode</a> = '';
<a name="l164"><span class="linenum"> 164</span></a>          }
<a name="l165"><span class="linenum"> 165</span></a>  
<a name="l166"><span class="linenum"> 166</span></a>          <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'request', 'string', '' );
<a name="l167"><span class="linenum"> 167</span></a>          if( <a class="var it1195" onMouseOver="hilite(1195)" onMouseOut="lolite()" onClick="logVariable('display_mode')" href="../../_variables/display_mode.html">$display_mode</a> == 'js' &amp;&amp; <a class="var it756" onMouseOver="hilite(756)" onMouseOut="lolite()" onClick="logVariable('request')" href="../../_variables/request.html">$request</a> != 'checkban' )
<a name="l168"><span class="linenum"> 168</span></a>          {
<a name="l169"><span class="linenum"> 169</span></a>              if( <a class="var it8879" onMouseOver="hilite(8879)" onMouseOut="lolite()" onClick="logVariable('delcomments')" href="../../_variables/delcomments.html">$delcomments</a> &amp;&amp; <a class="var it86" onMouseOver="hilite(86)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> ) // <a class="var it86" onMouseOver="hilite(86)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../_variables/r.html">$r</a> not null =&gt; means the commentlist was deleted successfully
<a name="l170"><span class="linenum"> 170</span></a>              {
<a name="l171"><span class="linenum"> 171</span></a>                  <a class="function" onClick="logFunction('send_javascript_message')" href="../../_functions/send_javascript_message.html" onMouseOver="funcPopup(event,'send_javascript_message')">send_javascript_message</a>( array( 'refreshAfterBan' =&gt; array( <a class="var it8883" onMouseOver="hilite(8883)" onMouseOut="lolite()" onClick="logVariable('deleted_ids')" href="../../_variables/deleted_ids.html">$deleted_ids</a> ), 'closeModalWindow' =&gt; array() ), true );
<a name="l172"><span class="linenum"> 172</span></a>              }
<a name="l173"><span class="linenum"> 173</span></a>              else
<a name="l174"><span class="linenum"> 174</span></a>              {
<a name="l175"><span class="linenum"> 175</span></a>                  <a class="function" onClick="logFunction('send_javascript_message')" href="../../_functions/send_javascript_message.html" onMouseOver="funcPopup(event,'send_javascript_message')">send_javascript_message</a>( array( 'closeModalWindow' =&gt; array() ), true );
<a name="l176"><span class="linenum"> 176</span></a>              }
<a name="l177"><span class="linenum"> 177</span></a>          }
<a name="l178"><span class="linenum"> 178</span></a>  
<a name="l179"><span class="linenum"> 179</span></a>  <span class="comment">        // We'll ask the user later what to do, if no &quot;sub-action&quot; given.</span>
<a name="l180"><span class="linenum"> 180</span></a>          break;
<a name="l181"><span class="linenum"> 181</span></a>  
<a name="l182"><span class="linenum"> 182</span></a>  
<a name="l183"><span class="linenum"> 183</span></a>      case 'remove':
<a name="l184"><span class="linenum"> 184</span></a>  <span class="comment">        // Remove a domain from ban list:</span>
<a name="l185"><span class="linenum"> 185</span></a>  
<a name="l186"><span class="linenum"> 186</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l187"><span class="linenum"> 187</span></a>          <a class="var it478" onMouseOver="hilite(478)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'antispam' );
<a name="l188"><span class="linenum"> 188</span></a>  
<a name="l189"><span class="linenum"> 189</span></a>  <span class="comment">        // Check permission:</span>
<a name="l190"><span class="linenum"> 190</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'spamblacklist', 'edit', true );
<a name="l191"><span class="linenum"> 191</span></a>  
<a name="l192"><span class="linenum"> 192</span></a>          <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'hit_ID', 'integer', true );    <span class="comment">// Required!</span>
<a name="l193"><span class="linenum"> 193</span></a>          <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Removing entry #%d from the ban list...'), <a class="var it4681" onMouseOver="hilite(4681)" onMouseOut="lolite()" onClick="logVariable('hit_ID')" href="../../_variables/hit_ID.html">$hit_ID</a>), 'note' );
<a name="l194"><span class="linenum"> 194</span></a>          <a class="function" onClick="logFunction('antispam_delete')" href="../../_functions/antispam_delete.html" onMouseOver="funcPopup(event,'antispam_delete')">antispam_delete</a>( <a class="var it4681" onMouseOver="hilite(4681)" onMouseOut="lolite()" onClick="logVariable('hit_ID')" href="../../_variables/hit_ID.html">$hit_ID</a> );
<a name="l195"><span class="linenum"> 195</span></a>          break;
<a name="l196"><span class="linenum"> 196</span></a>  
<a name="l197"><span class="linenum"> 197</span></a>  
<a name="l198"><span class="linenum"> 198</span></a>      case 'report':
<a name="l199"><span class="linenum"> 199</span></a>  <span class="comment">        // Report an entry as abuse to centralized blacklist:</span>
<a name="l200"><span class="linenum"> 200</span></a>  
<a name="l201"><span class="linenum"> 201</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l202"><span class="linenum"> 202</span></a>          <a class="var it478" onMouseOver="hilite(478)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'antispam' );
<a name="l203"><span class="linenum"> 203</span></a>  
<a name="l204"><span class="linenum"> 204</span></a>  <span class="comment">        // Check permission:</span>
<a name="l205"><span class="linenum"> 205</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'spamblacklist', 'edit', true );
<a name="l206"><span class="linenum"> 206</span></a>  
<a name="l207"><span class="linenum"> 207</span></a>  <span class="comment">        // Report this keyword as abuse:</span>
<a name="l208"><span class="linenum"> 208</span></a>          <a class="function" onClick="logFunction('antispam_report_abuse')" href="../../_functions/antispam_report_abuse.html" onMouseOver="funcPopup(event,'antispam_report_abuse')">antispam_report_abuse</a>( <a class="var it1409" onMouseOver="hilite(1409)" onMouseOut="lolite()" onClick="logVariable('keyword')" href="../../_variables/keyword.html">$keyword</a> );
<a name="l209"><span class="linenum"> 209</span></a>          break;
<a name="l210"><span class="linenum"> 210</span></a>  
<a name="l211"><span class="linenum"> 211</span></a>  
<a name="l212"><span class="linenum"> 212</span></a>      case 'poll':
<a name="l213"><span class="linenum"> 213</span></a>  <span class="comment">        // request abuse list from central blacklist:</span>
<a name="l214"><span class="linenum"> 214</span></a>  
<a name="l215"><span class="linenum"> 215</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l216"><span class="linenum"> 216</span></a>          <a class="var it478" onMouseOver="hilite(478)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'antispam' );
<a name="l217"><span class="linenum"> 217</span></a>  
<a name="l218"><span class="linenum"> 218</span></a>  <span class="comment">        // Check permission:</span>
<a name="l219"><span class="linenum"> 219</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'spamblacklist', 'edit', true );
<a name="l220"><span class="linenum"> 220</span></a>  
<a name="l221"><span class="linenum"> 221</span></a>          <a class="phpfunction" onClick="logFunction('ob_start')" href="../../_functions/ob_start.html" onMouseOver="phpfuncPopup(event,'ob_start')">ob_start</a>();
<a name="l222"><span class="linenum"> 222</span></a>          <a class="function" onClick="logFunction('antispam_poll_abuse')" href="../../_functions/antispam_poll_abuse.html" onMouseOver="funcPopup(event,'antispam_poll_abuse')">antispam_poll_abuse</a>();
<a name="l223"><span class="linenum"> 223</span></a>          <a class="var it509" onMouseOver="hilite(509)" onMouseOut="lolite()" onClick="logVariable('Debuglog')" href="../../_variables/Debuglog.html">$Debuglog</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="phpfunction" onClick="logFunction('ob_get_contents')" href="../../_functions/ob_get_contents.html" onMouseOver="phpfuncPopup(event,'ob_get_contents')">ob_get_contents</a>(), 'antispam_poll' );
<a name="l224"><span class="linenum"> 224</span></a>          <a class="phpfunction" onClick="logFunction('ob_end_clean')" href="../../_functions/ob_end_clean.html" onMouseOver="phpfuncPopup(event,'ob_end_clean')">ob_end_clean</a>();
<a name="l225"><span class="linenum"> 225</span></a>          break;
<a name="l226"><span class="linenum"> 226</span></a>  
<a name="l227"><span class="linenum"> 227</span></a>      case 'update':
<a name="l228"><span class="linenum"> 228</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l229"><span class="linenum"> 229</span></a>          <a class="var it478" onMouseOver="hilite(478)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'antispam' );
<a name="l230"><span class="linenum"> 230</span></a>  
<a name="l231"><span class="linenum"> 231</span></a>  <span class="comment">        // Check permission:</span>
<a name="l232"><span class="linenum"> 232</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'options', 'edit', true );
<a name="l233"><span class="linenum"> 233</span></a>  
<a name="l234"><span class="linenum"> 234</span></a>  <span class="comment">        // fp&gt; Restore defaults has been removed because it's extra maintenance work and no real benefit to the user.</span>
<a name="l235"><span class="linenum"> 235</span></a>  
<a name="l236"><span class="linenum"> 236</span></a>          <a class="function" onClick="logFunction('param_integer_range')" href="../../_functions/param_integer_range.html" onMouseOver="funcPopup(event,'param_integer_range')">param_integer_range</a>( 'antispam_threshold_publish', -100, 100, <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The threshold must be between -100 and 100.') );
<a name="l237"><span class="linenum"> 237</span></a>          <a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../_variables/Settings.html">$Settings</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'antispam_threshold_publish', <a class="var it8886" onMouseOver="hilite(8886)" onMouseOut="lolite()" onClick="logVariable('antispam_threshold_publish')" href="../../_variables/antispam_threshold_publish.html">$antispam_threshold_publish</a> );
<a name="l238"><span class="linenum"> 238</span></a>  
<a name="l239"><span class="linenum"> 239</span></a>          <a class="function" onClick="logFunction('param_integer_range')" href="../../_functions/param_integer_range.html" onMouseOver="funcPopup(event,'param_integer_range')">param_integer_range</a>( 'antispam_threshold_delete', -100, 100, <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('The threshold must be between -100 and 100.') );
<a name="l240"><span class="linenum"> 240</span></a>          <a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../_variables/Settings.html">$Settings</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'antispam_threshold_delete', <a class="var it8887" onMouseOver="hilite(8887)" onMouseOut="lolite()" onClick="logVariable('antispam_threshold_delete')" href="../../_variables/antispam_threshold_delete.html">$antispam_threshold_delete</a> );
<a name="l241"><span class="linenum"> 241</span></a>  
<a name="l242"><span class="linenum"> 242</span></a>          <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'antispam_block_spam_referers', 'integer', 0 );
<a name="l243"><span class="linenum"> 243</span></a>          <a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../_variables/Settings.html">$Settings</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'antispam_block_spam_referers', <a class="var it8888" onMouseOver="hilite(8888)" onMouseOut="lolite()" onClick="logVariable('antispam_block_spam_referers')" href="../../_variables/antispam_block_spam_referers.html">$antispam_block_spam_referers</a> );
<a name="l244"><span class="linenum"> 244</span></a>  
<a name="l245"><span class="linenum"> 245</span></a>          <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'antispam_report_to_central', 'integer', 0 );
<a name="l246"><span class="linenum"> 246</span></a>          <a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../_variables/Settings.html">$Settings</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'antispam_report_to_central', <a class="var it8889" onMouseOver="hilite(8889)" onMouseOut="lolite()" onClick="logVariable('antispam_report_to_central')" href="../../_variables/antispam_report_to_central.html">$antispam_report_to_central</a> );
<a name="l247"><span class="linenum"> 247</span></a>  
<a name="l248"><span class="linenum"> 248</span></a>          <a class="var it8890" onMouseOver="hilite(8890)" onMouseOut="lolite()" onClick="logVariable('changed_weight')" href="../../_variables/changed_weight.html">$changed_weight</a> = false;
<a name="l249"><span class="linenum"> 249</span></a>          <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'antispam_plugin_spam_weight', 'array:integer', array() );
<a name="l250"><span class="linenum"> 250</span></a>          foreach( <a class="var it8891" onMouseOver="hilite(8891)" onMouseOut="lolite()" onClick="logVariable('antispam_plugin_spam_weight')" href="../../_variables/antispam_plugin_spam_weight.html">$antispam_plugin_spam_weight</a> as <a class="var it7849" onMouseOver="hilite(7849)" onMouseOut="lolite()" onClick="logVariable('l_plugin_ID')" href="../../_variables/l_plugin_ID.html">$l_plugin_ID</a> =&gt; <a class="var it8892" onMouseOver="hilite(8892)" onMouseOut="lolite()" onClick="logVariable('l_weight')" href="../../_variables/l_weight.html">$l_weight</a> )
<a name="l251"><span class="linenum"> 251</span></a>          {
<a name="l252"><span class="linenum"> 252</span></a>              if( ! <a class="phpfunction" onClick="logFunction('is_numeric')" href="../../_functions/is_numeric.html" onMouseOver="phpfuncPopup(event,'is_numeric')">is_numeric</a>(<a class="var it8892" onMouseOver="hilite(8892)" onMouseOut="lolite()" onClick="logVariable('l_weight')" href="../../_variables/l_weight.html">$l_weight</a>) )
<a name="l253"><span class="linenum"> 253</span></a>              {
<a name="l254"><span class="linenum"> 254</span></a>                  continue;
<a name="l255"><span class="linenum"> 255</span></a>              }
<a name="l256"><span class="linenum"> 256</span></a>              if( <a class="var it8892" onMouseOver="hilite(8892)" onMouseOut="lolite()" onClick="logVariable('l_weight')" href="../../_variables/l_weight.html">$l_weight</a> &lt; 0 || <a class="var it8892" onMouseOver="hilite(8892)" onMouseOut="lolite()" onClick="logVariable('l_weight')" href="../../_variables/l_weight.html">$l_weight</a> &gt; 100 )
<a name="l257"><span class="linenum"> 257</span></a>              {
<a name="l258"><span class="linenum"> 258</span></a>                  <a class="function" onClick="logFunction('param_error')" href="../../_functions/param_error.html" onMouseOver="funcPopup(event,'param_error')">param_error</a>( 'antispam_plugin_spam_weight['.<a class="var it7849" onMouseOver="hilite(7849)" onMouseOut="lolite()" onClick="logVariable('l_plugin_ID')" href="../../_variables/l_plugin_ID.html">$l_plugin_ID</a>.']', <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Spam weight has to be in the range of 0-100.') );
<a name="l259"><span class="linenum"> 259</span></a>                  continue;
<a name="l260"><span class="linenum"> 260</span></a>              }
<a name="l261"><span class="linenum"> 261</span></a>              if( <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>( '
<a name="l262"><span class="linenum"> 262</span></a>                      UPDATE T_plugins
<a name="l263"><span class="linenum"> 263</span></a>                           SET plug_spam_weight = '.<a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>(<a class="var it8892" onMouseOver="hilite(8892)" onMouseOut="lolite()" onClick="logVariable('l_weight')" href="../../_variables/l_weight.html">$l_weight</a>).'
<a name="l264"><span class="linenum"> 264</span></a>                       WHERE plug_ID = '.(int)<a class="var it7849" onMouseOver="hilite(7849)" onMouseOut="lolite()" onClick="logVariable('l_plugin_ID')" href="../../_variables/l_plugin_ID.html">$l_plugin_ID</a> ) )
<a name="l265"><span class="linenum"> 265</span></a>              {
<a name="l266"><span class="linenum"> 266</span></a>                  <a class="var it8890" onMouseOver="hilite(8890)" onMouseOut="lolite()" onClick="logVariable('changed_weight')" href="../../_variables/changed_weight.html">$changed_weight</a> = true;
<a name="l267"><span class="linenum"> 267</span></a>              }
<a name="l268"><span class="linenum"> 268</span></a>          }
<a name="l269"><span class="linenum"> 269</span></a>          if( <a class="var it8890" onMouseOver="hilite(8890)" onMouseOut="lolite()" onClick="logVariable('changed_weight')" href="../../_variables/changed_weight.html">$changed_weight</a> )
<a name="l270"><span class="linenum"> 270</span></a>          { // Reload plugins <a class="function" onClick="logFunction('table')" href="../../_functions/table.html" onMouseOver="funcPopup(event,'table')">table</a> (for display):
<a name="l271"><span class="linenum"> 271</span></a>              <a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('Plugins')" href="../../_variables/Plugins.html">$Plugins</a>-&gt;<a onClick="logVariable('loaded_plugins_table')" class="var it10698" onMouseOver="hilite(10698)" onMouseOut="lolite()" href="../../_variables/loaded_plugins_table.html">loaded_plugins_table</a> = false;
<a name="l272"><span class="linenum"> 272</span></a>              <a class="var it319" onMouseOver="hilite(319)" onMouseOut="lolite()" onClick="logVariable('Plugins')" href="../../_variables/Plugins.html">$Plugins</a>-&gt;<a class="function" onClick="logFunction('load_plugins_table')" href="../../_functions/load_plugins_table.html" onMouseOver="funcPopup(event,'load_plugins_table')">load_plugins_table</a>();
<a name="l273"><span class="linenum"> 273</span></a>          }
<a name="l274"><span class="linenum"> 274</span></a>  
<a name="l275"><span class="linenum"> 275</span></a>  <span class="comment">        // Suspicious users</span>
<a name="l276"><span class="linenum"> 276</span></a>          <a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../_variables/Settings.html">$Settings</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'antispam_suspicious_group', <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'antispam_suspicious_group', 'integer', 0 ) );
<a name="l277"><span class="linenum"> 277</span></a>  
<a name="l278"><span class="linenum"> 278</span></a>  <span class="comment">        // Trust groups</span>
<a name="l279"><span class="linenum"> 279</span></a>          <a class="var it7378" onMouseOver="hilite(7378)" onMouseOut="lolite()" onClick="logVariable('trust_groups')" href="../../_variables/trust_groups.html">$trust_groups</a> = <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'antispam_trust_groups', 'array:integer', array() );
<a name="l280"><span class="linenum"> 280</span></a>          <a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../_variables/Settings.html">$Settings</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'antispam_trust_groups', <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( ',', <a class="var it7378" onMouseOver="hilite(7378)" onMouseOut="lolite()" onClick="logVariable('trust_groups')" href="../../_variables/trust_groups.html">$trust_groups</a> ) );
<a name="l281"><span class="linenum"> 281</span></a>  
<a name="l282"><span class="linenum"> 282</span></a>          if( ! <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('has_errors')" href="../../_functions/has_errors.html" onMouseOver="funcPopup(event,'has_errors')">has_errors</a>() )
<a name="l283"><span class="linenum"> 283</span></a>          {
<a name="l284"><span class="linenum"> 284</span></a>              <a class="var it148" onMouseOver="hilite(148)" onMouseOut="lolite()" onClick="logVariable('Settings')" href="../../_variables/Settings.html">$Settings</a>-&gt;<a class="function" onClick="logFunction('dbupdate')" href="../../_functions/dbupdate.html" onMouseOver="funcPopup(event,'dbupdate')">dbupdate</a>();
<a name="l285"><span class="linenum"> 285</span></a>  
<a name="l286"><span class="linenum"> 286</span></a>              <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Settings updated.'), 'success' );
<a name="l287"><span class="linenum"> 287</span></a>  <span class="comment">            // Redirect so that a reload doesn't write to the DB twice:</span>
<a name="l288"><span class="linenum"> 288</span></a>              <a class="function" onClick="logFunction('header_redirect')" href="../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( '?ctrl=antispam&amp;tab3=settings', 303 ); <span class="comment">// Will EXIT</span>
<a name="l289"><span class="linenum"> 289</span></a>  <span class="comment">            // We have EXITed already at this point!!</span>
<a name="l290"><span class="linenum"> 290</span></a>          }
<a name="l291"><span class="linenum"> 291</span></a>  
<a name="l292"><span class="linenum"> 292</span></a>      case 'find_spam_comments':
<a name="l293"><span class="linenum"> 293</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l294"><span class="linenum"> 294</span></a>          <a class="var it478" onMouseOver="hilite(478)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'antispam' );
<a name="l295"><span class="linenum"> 295</span></a>  
<a name="l296"><span class="linenum"> 296</span></a>  <span class="comment">        // Check permission:</span>
<a name="l297"><span class="linenum"> 297</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'options', 'edit', true );
<a name="l298"><span class="linenum"> 298</span></a>  
<a name="l299"><span class="linenum"> 299</span></a>          <a class="var it1407" onMouseOver="hilite(1407)" onMouseOut="lolite()" onClick="logVariable('keywords')" href="../../_variables/keywords.html">$keywords</a> = <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_col')" href="../../_functions/get_col.html" onMouseOver="funcPopup(event,'get_col')">get_col</a>('SELECT aspm_string FROM T_antispam');
<a name="l300"><span class="linenum"> 300</span></a>          <a class="var it1407" onMouseOver="hilite(1407)" onMouseOut="lolite()" onClick="logVariable('keywords')" href="../../_variables/keywords.html">$keywords</a> = <a class="phpfunction" onClick="logFunction('array_chunk')" href="../../_functions/array_chunk.html" onMouseOver="phpfuncPopup(event,'array_chunk')">array_chunk</a>( <a class="var it1407" onMouseOver="hilite(1407)" onMouseOut="lolite()" onClick="logVariable('keywords')" href="../../_variables/keywords.html">$keywords</a>, 100 );
<a name="l301"><span class="linenum"> 301</span></a>          <a class="var it1987" onMouseOver="hilite(1987)" onMouseOut="lolite()" onClick="logVariable('rows_affected')" href="../../_variables/rows_affected.html">$rows_affected</a> = 0;
<a name="l302"><span class="linenum"> 302</span></a>  
<a name="l303"><span class="linenum"> 303</span></a>          @<a class="phpfunction" onClick="logFunction('ignore_user_abort')" href="../../_functions/ignore_user_abort.html" onMouseOver="phpfuncPopup(event,'ignore_user_abort')">ignore_user_abort</a>(true);
<a name="l304"><span class="linenum"> 304</span></a>          <a class="function" onClick="logFunction('set_max_execution_time')" href="../../_functions/set_max_execution_time.html" onMouseOver="funcPopup(event,'set_max_execution_time')">set_max_execution_time</a>(900);
<a name="l305"><span class="linenum"> 305</span></a>  
<a name="l306"><span class="linenum"> 306</span></a>  <span class="comment">        // Delete comments in chunks of 100 keywords per SQL query</span>
<a name="l307"><span class="linenum"> 307</span></a>          foreach( <a class="var it1407" onMouseOver="hilite(1407)" onMouseOut="lolite()" onClick="logVariable('keywords')" href="../../_variables/keywords.html">$keywords</a> as <a class="var it670" onMouseOver="hilite(670)" onMouseOut="lolite()" onClick="logVariable('chunk')" href="../../_variables/chunk.html">$chunk</a> )
<a name="l308"><span class="linenum"> 308</span></a>          {
<a name="l309"><span class="linenum"> 309</span></a>              <a class="var it39" onMouseOver="hilite(39)" onMouseOut="lolite()" onClick="logVariable('arr')" href="../../_variables/arr.html">$arr</a> = array();
<a name="l310"><span class="linenum"> 310</span></a>              foreach( <a class="var it670" onMouseOver="hilite(670)" onMouseOut="lolite()" onClick="logVariable('chunk')" href="../../_variables/chunk.html">$chunk</a> as <a class="var it520" onMouseOver="hilite(520)" onMouseOut="lolite()" onClick="logVariable('word')" href="../../_variables/word.html">$word</a> )
<a name="l311"><span class="linenum"> 311</span></a>              {
<a name="l312"><span class="linenum"> 312</span></a>                  <a class="var it39" onMouseOver="hilite(39)" onMouseOut="lolite()" onClick="logVariable('arr')" href="../../_variables/arr.html">$arr</a>[] = <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>('%'.<a class="var it520" onMouseOver="hilite(520)" onMouseOut="lolite()" onClick="logVariable('word')" href="../../_variables/word.html">$word</a>.'%');
<a name="l313"><span class="linenum"> 313</span></a>              }
<a name="l314"><span class="linenum"> 314</span></a>  
<a name="l315"><span class="linenum"> 315</span></a>              <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>('DELETE FROM T_comments
<a name="l316"><span class="linenum"> 316</span></a>                          <a class="function" onClick="logFunction('WHERE')" href="../../_functions/where.html" onMouseOver="funcPopup(event,'where')">WHERE</a> (comment_author LIKE '.<a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(' OR comment_author LIKE ', <a class="var it39" onMouseOver="hilite(39)" onMouseOut="lolite()" onClick="logVariable('arr')" href="../../_variables/arr.html">$arr</a>).')
<a name="l317"><span class="linenum"> 317</span></a>                          OR (comment_author_email LIKE '.<a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(' OR comment_author_email LIKE ', <a class="var it39" onMouseOver="hilite(39)" onMouseOut="lolite()" onClick="logVariable('arr')" href="../../_variables/arr.html">$arr</a>).')
<a name="l318"><span class="linenum"> 318</span></a>                          OR (comment_author_url LIKE '.<a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(' OR comment_author_url LIKE ', <a class="var it39" onMouseOver="hilite(39)" onMouseOut="lolite()" onClick="logVariable('arr')" href="../../_variables/arr.html">$arr</a>).')
<a name="l319"><span class="linenum"> 319</span></a>                          OR (comment_content LIKE '.<a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(' OR comment_content LIKE ', <a class="var it39" onMouseOver="hilite(39)" onMouseOut="lolite()" onClick="logVariable('arr')" href="../../_variables/arr.html">$arr</a>).')',
<a name="l320"><span class="linenum"> 320</span></a>                          'Delete spam comments');
<a name="l321"><span class="linenum"> 321</span></a>  
<a name="l322"><span class="linenum"> 322</span></a>              <a class="var it1987" onMouseOver="hilite(1987)" onMouseOut="lolite()" onClick="logVariable('rows_affected')" href="../../_variables/rows_affected.html">$rows_affected</a> = <a class="var it1987" onMouseOver="hilite(1987)" onMouseOut="lolite()" onClick="logVariable('rows_affected')" href="../../_variables/rows_affected.html">$rows_affected</a> + <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('rows_affected')" class="var it10754" onMouseOver="hilite(10754)" onMouseOut="lolite()" href="../../_variables/rows_affected.html">rows_affected</a>;
<a name="l323"><span class="linenum"> 323</span></a>          }
<a name="l324"><span class="linenum"> 324</span></a>          <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Deleted %d comments'), <a class="var it1987" onMouseOver="hilite(1987)" onMouseOut="lolite()" onClick="logVariable('rows_affected')" href="../../_variables/rows_affected.html">$rows_affected</a> ), 'success' );
<a name="l325"><span class="linenum"> 325</span></a>          break;
<a name="l326"><span class="linenum"> 326</span></a>  
<a name="l327"><span class="linenum"> 327</span></a>      case 'find_spam_referers':
<a name="l328"><span class="linenum"> 328</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l329"><span class="linenum"> 329</span></a>          <a class="var it478" onMouseOver="hilite(478)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'antispam' );
<a name="l330"><span class="linenum"> 330</span></a>  
<a name="l331"><span class="linenum"> 331</span></a>  <span class="comment">        // Check permission:</span>
<a name="l332"><span class="linenum"> 332</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'options', 'edit', true );
<a name="l333"><span class="linenum"> 333</span></a>  
<a name="l334"><span class="linenum"> 334</span></a>          <a class="var it1407" onMouseOver="hilite(1407)" onMouseOut="lolite()" onClick="logVariable('keywords')" href="../../_variables/keywords.html">$keywords</a> = <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('get_col')" href="../../_functions/get_col.html" onMouseOver="funcPopup(event,'get_col')">get_col</a>('SELECT aspm_string FROM T_antispam');
<a name="l335"><span class="linenum"> 335</span></a>          <a class="var it1407" onMouseOver="hilite(1407)" onMouseOut="lolite()" onClick="logVariable('keywords')" href="../../_variables/keywords.html">$keywords</a> = <a class="phpfunction" onClick="logFunction('array_chunk')" href="../../_functions/array_chunk.html" onMouseOver="phpfuncPopup(event,'array_chunk')">array_chunk</a>( <a class="var it1407" onMouseOver="hilite(1407)" onMouseOut="lolite()" onClick="logVariable('keywords')" href="../../_variables/keywords.html">$keywords</a>, 100 );
<a name="l336"><span class="linenum"> 336</span></a>          <a class="var it1987" onMouseOver="hilite(1987)" onMouseOut="lolite()" onClick="logVariable('rows_affected')" href="../../_variables/rows_affected.html">$rows_affected</a> = 0;
<a name="l337"><span class="linenum"> 337</span></a>  
<a name="l338"><span class="linenum"> 338</span></a>          @<a class="phpfunction" onClick="logFunction('ignore_user_abort')" href="../../_functions/ignore_user_abort.html" onMouseOver="phpfuncPopup(event,'ignore_user_abort')">ignore_user_abort</a>(true);
<a name="l339"><span class="linenum"> 339</span></a>          <a class="function" onClick="logFunction('set_max_execution_time')" href="../../_functions/set_max_execution_time.html" onMouseOver="funcPopup(event,'set_max_execution_time')">set_max_execution_time</a>(900);
<a name="l340"><span class="linenum"> 340</span></a>  
<a name="l341"><span class="linenum"> 341</span></a>  <span class="comment">        // Delete hits in chunks of 100 keywords per SQL query</span>
<a name="l342"><span class="linenum"> 342</span></a>          foreach( <a class="var it1407" onMouseOver="hilite(1407)" onMouseOut="lolite()" onClick="logVariable('keywords')" href="../../_variables/keywords.html">$keywords</a> as <a class="var it670" onMouseOver="hilite(670)" onMouseOut="lolite()" onClick="logVariable('chunk')" href="../../_variables/chunk.html">$chunk</a> )
<a name="l343"><span class="linenum"> 343</span></a>          {
<a name="l344"><span class="linenum"> 344</span></a>              <a class="var it39" onMouseOver="hilite(39)" onMouseOut="lolite()" onClick="logVariable('arr')" href="../../_variables/arr.html">$arr</a> = array();
<a name="l345"><span class="linenum"> 345</span></a>              foreach( <a class="var it670" onMouseOver="hilite(670)" onMouseOut="lolite()" onClick="logVariable('chunk')" href="../../_variables/chunk.html">$chunk</a> as <a class="var it520" onMouseOver="hilite(520)" onMouseOut="lolite()" onClick="logVariable('word')" href="../../_variables/word.html">$word</a> )
<a name="l346"><span class="linenum"> 346</span></a>              {
<a name="l347"><span class="linenum"> 347</span></a>                  <a class="var it39" onMouseOver="hilite(39)" onMouseOut="lolite()" onClick="logVariable('arr')" href="../../_variables/arr.html">$arr</a>[] = <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('quote')" href="../../_functions/quote.html" onMouseOver="funcPopup(event,'quote')">quote</a>('%'.<a class="var it520" onMouseOver="hilite(520)" onMouseOut="lolite()" onClick="logVariable('word')" href="../../_variables/word.html">$word</a>.'%');
<a name="l348"><span class="linenum"> 348</span></a>              }
<a name="l349"><span class="linenum"> 349</span></a>  
<a name="l350"><span class="linenum"> 350</span></a>              <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a class="function" onClick="logFunction('query')" href="../../_functions/query.html" onMouseOver="funcPopup(event,'query')">query</a>('DELETE FROM T_hitlog
<a name="l351"><span class="linenum"> 351</span></a>                          WHERE hit_referer LIKE '.<a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(' OR hit_referer LIKE ', <a class="var it39" onMouseOver="hilite(39)" onMouseOut="lolite()" onClick="logVariable('arr')" href="../../_variables/arr.html">$arr</a>),
<a name="l352"><span class="linenum"> 352</span></a>                          'Delete all banned hit-log entries' );
<a name="l353"><span class="linenum"> 353</span></a>  
<a name="l354"><span class="linenum"> 354</span></a>              <a class="var it1987" onMouseOver="hilite(1987)" onMouseOut="lolite()" onClick="logVariable('rows_affected')" href="../../_variables/rows_affected.html">$rows_affected</a> = <a class="var it1987" onMouseOver="hilite(1987)" onMouseOut="lolite()" onClick="logVariable('rows_affected')" href="../../_variables/rows_affected.html">$rows_affected</a> + <a class="var it150" onMouseOver="hilite(150)" onMouseOut="lolite()" onClick="logVariable('DB')" href="../../_variables/DB.html">$DB</a>-&gt;<a onClick="logVariable('rows_affected')" class="var it10754" onMouseOver="hilite(10754)" onMouseOut="lolite()" href="../../_variables/rows_affected.html">rows_affected</a>;
<a name="l355"><span class="linenum"> 355</span></a>          }
<a name="l356"><span class="linenum"> 356</span></a>          <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( sprintf( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Deleted %d logged hits'), <a class="var it1987" onMouseOver="hilite(1987)" onMouseOut="lolite()" onClick="logVariable('rows_affected')" href="../../_variables/rows_affected.html">$rows_affected</a> ), 'success' );
<a name="l357"><span class="linenum"> 357</span></a>          break;
<a name="l358"><span class="linenum"> 358</span></a>  
<a name="l359"><span class="linenum"> 359</span></a>      case 'iprange_create':
<a name="l360"><span class="linenum"> 360</span></a>  <span class="comment">        // Create new IP Range...</span>
<a name="l361"><span class="linenum"> 361</span></a>  
<a name="l362"><span class="linenum"> 362</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l363"><span class="linenum"> 363</span></a>          <a class="var it478" onMouseOver="hilite(478)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'iprange' );
<a name="l364"><span class="linenum"> 364</span></a>  
<a name="l365"><span class="linenum"> 365</span></a>  <span class="comment">        // Check permission:</span>
<a name="l366"><span class="linenum"> 366</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'spamblacklist', 'edit', true );
<a name="l367"><span class="linenum"> 367</span></a>  
<a name="l368"><span class="linenum"> 368</span></a>          <a class="var it6178" onMouseOver="hilite(6178)" onMouseOut="lolite()" onClick="logVariable('edited_IPRange')" href="../../_variables/edited_IPRange.html">$edited_IPRange</a> = <span class="keyword">new </span><a class="class" onClick="logClass('IPRange')" href="../../_classes/iprange.html" onMouseOver="classPopup(event,'iprange')">IPRange</a>();
<a name="l369"><span class="linenum"> 369</span></a>  
<a name="l370"><span class="linenum"> 370</span></a>  <span class="comment">        // load data from request</span>
<a name="l371"><span class="linenum"> 371</span></a>          if( <a class="var it6178" onMouseOver="hilite(6178)" onMouseOut="lolite()" onClick="logVariable('edited_IPRange')" href="../../_variables/edited_IPRange.html">$edited_IPRange</a>-&gt;<a class="function" onClick="logFunction('load_from_Request')" href="../../_functions/load_from_request.html" onMouseOver="funcPopup(event,'load_from_request')">load_from_Request</a>() )
<a name="l372"><span class="linenum"> 372</span></a>          {    // We could load data from form without errors:
<a name="l373"><span class="linenum"> 373</span></a>  <span class="comment">            // Insert in DB:</span>
<a name="l374"><span class="linenum"> 374</span></a>              <a class="var it6178" onMouseOver="hilite(6178)" onMouseOut="lolite()" onClick="logVariable('edited_IPRange')" href="../../_variables/edited_IPRange.html">$edited_IPRange</a>-&gt;<a class="function" onClick="logFunction('dbinsert')" href="../../_functions/dbinsert.html" onMouseOver="funcPopup(event,'dbinsert')">dbinsert</a>();
<a name="l375"><span class="linenum"> 375</span></a>              <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('New IP Range created.'), 'success' );
<a name="l376"><span class="linenum"> 376</span></a>  
<a name="l377"><span class="linenum"> 377</span></a>  <span class="comment">            // Redirect so that a reload doesn't write to the DB twice:</span>
<a name="l378"><span class="linenum"> 378</span></a>              <a class="function" onClick="logFunction('header_redirect')" href="../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( '?ctrl=antispam&amp;tab='.<a class="var it1211" onMouseOver="hilite(1211)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../_variables/tab.html">$tab</a>.'&amp;tab3=ipranges', 303 ); <span class="comment">// Will EXIT</span>
<a name="l379"><span class="linenum"> 379</span></a>  <span class="comment">            // We have EXITed already at this point!!</span>
<a name="l380"><span class="linenum"> 380</span></a>          }
<a name="l381"><span class="linenum"> 381</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> = 'iprange_new';
<a name="l382"><span class="linenum"> 382</span></a>          break;
<a name="l383"><span class="linenum"> 383</span></a>  
<a name="l384"><span class="linenum"> 384</span></a>      case 'iprange_update':
<a name="l385"><span class="linenum"> 385</span></a>  <span class="comment">        // Update IP Range...</span>
<a name="l386"><span class="linenum"> 386</span></a>  
<a name="l387"><span class="linenum"> 387</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l388"><span class="linenum"> 388</span></a>          <a class="var it478" onMouseOver="hilite(478)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'iprange' );
<a name="l389"><span class="linenum"> 389</span></a>  
<a name="l390"><span class="linenum"> 390</span></a>  <span class="comment">        // Check permission:</span>
<a name="l391"><span class="linenum"> 391</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'spamblacklist', 'edit', true );
<a name="l392"><span class="linenum"> 392</span></a>  
<a name="l393"><span class="linenum"> 393</span></a>  <span class="comment">        // Make sure we got an iprange_ID:</span>
<a name="l394"><span class="linenum"> 394</span></a>          <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'iprange_ID', 'integer', true );
<a name="l395"><span class="linenum"> 395</span></a>  
<a name="l396"><span class="linenum"> 396</span></a>  <span class="comment">        // load data from request</span>
<a name="l397"><span class="linenum"> 397</span></a>          if( <a class="var it6178" onMouseOver="hilite(6178)" onMouseOut="lolite()" onClick="logVariable('edited_IPRange')" href="../../_variables/edited_IPRange.html">$edited_IPRange</a>-&gt;<a class="function" onClick="logFunction('load_from_Request')" href="../../_functions/load_from_request.html" onMouseOver="funcPopup(event,'load_from_request')">load_from_Request</a>() )
<a name="l398"><span class="linenum"> 398</span></a>          {    // We could load data from form without errors:
<a name="l399"><span class="linenum"> 399</span></a>  <span class="comment">            // Update IP Range in DB:</span>
<a name="l400"><span class="linenum"> 400</span></a>              <a class="var it6178" onMouseOver="hilite(6178)" onMouseOut="lolite()" onClick="logVariable('edited_IPRange')" href="../../_variables/edited_IPRange.html">$edited_IPRange</a>-&gt;<a class="function" onClick="logFunction('dbupdate')" href="../../_functions/dbupdate.html" onMouseOver="funcPopup(event,'dbupdate')">dbupdate</a>();
<a name="l401"><span class="linenum"> 401</span></a>              <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('IP Range updated.'), 'success' );
<a name="l402"><span class="linenum"> 402</span></a>  
<a name="l403"><span class="linenum"> 403</span></a>  <span class="comment">            // Redirect so that a reload doesn't write to the DB twice:</span>
<a name="l404"><span class="linenum"> 404</span></a>              <a class="function" onClick="logFunction('header_redirect')" href="../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( '?ctrl=antispam&amp;tab='.<a class="var it1211" onMouseOver="hilite(1211)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../_variables/tab.html">$tab</a>.'&amp;tab3=ipranges', 303 ); <span class="comment">// Will EXIT</span>
<a name="l405"><span class="linenum"> 405</span></a>  <span class="comment">            // We have EXITed already at this point!!</span>
<a name="l406"><span class="linenum"> 406</span></a>          }
<a name="l407"><span class="linenum"> 407</span></a>          <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> = 'iprange_edit';
<a name="l408"><span class="linenum"> 408</span></a>          break;
<a name="l409"><span class="linenum"> 409</span></a>  
<a name="l410"><span class="linenum"> 410</span></a>      case 'iprange_delete':
<a name="l411"><span class="linenum"> 411</span></a>  <span class="comment">        // Delete IP Range...</span>
<a name="l412"><span class="linenum"> 412</span></a>  
<a name="l413"><span class="linenum"> 413</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l414"><span class="linenum"> 414</span></a>          <a class="var it478" onMouseOver="hilite(478)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'iprange' );
<a name="l415"><span class="linenum"> 415</span></a>  
<a name="l416"><span class="linenum"> 416</span></a>  <span class="comment">        // Check permission:</span>
<a name="l417"><span class="linenum"> 417</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'spamblacklist', 'edit', true );
<a name="l418"><span class="linenum"> 418</span></a>  
<a name="l419"><span class="linenum"> 419</span></a>  <span class="comment">        // Make sure we got an iprange_ID:</span>
<a name="l420"><span class="linenum"> 420</span></a>          <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'iprange_ID', 'integer', true );
<a name="l421"><span class="linenum"> 421</span></a>  
<a name="l422"><span class="linenum"> 422</span></a>          if( <a class="var it6178" onMouseOver="hilite(6178)" onMouseOut="lolite()" onClick="logVariable('edited_IPRange')" href="../../_variables/edited_IPRange.html">$edited_IPRange</a>-&gt;<a class="function" onClick="logFunction('dbdelete')" href="../../_functions/dbdelete.html" onMouseOver="funcPopup(event,'dbdelete')">dbdelete</a>() )
<a name="l423"><span class="linenum"> 423</span></a>          {
<a name="l424"><span class="linenum"> 424</span></a>              <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('IP Range deleted.'), 'success' );
<a name="l425"><span class="linenum"> 425</span></a>  
<a name="l426"><span class="linenum"> 426</span></a>  <span class="comment">            // Redirect so that a reload doesn't write to the DB twice:</span>
<a name="l427"><span class="linenum"> 427</span></a>              <a class="function" onClick="logFunction('header_redirect')" href="../../_functions/header_redirect.html" onMouseOver="funcPopup(event,'header_redirect')">header_redirect</a>( '?ctrl=antispam&amp;tab='.<a class="var it1211" onMouseOver="hilite(1211)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../_variables/tab.html">$tab</a>.'&amp;tab3=ipranges', 303 ); <span class="comment">// Will EXIT</span>
<a name="l428"><span class="linenum"> 428</span></a>  <span class="comment">            // We have EXITed already at this point!!</span>
<a name="l429"><span class="linenum"> 429</span></a>          }
<a name="l430"><span class="linenum"> 430</span></a>          break;
<a name="l431"><span class="linenum"> 431</span></a>  
<a name="l432"><span class="linenum"> 432</span></a>      case 'bankruptcy_delete':
<a name="l433"><span class="linenum"> 433</span></a>  <span class="comment">        // Delete ALL comments from selected blogs</span>
<a name="l434"><span class="linenum"> 434</span></a>  
<a name="l435"><span class="linenum"> 435</span></a>  <span class="comment">        // Check that this action request is not a CSRF hacked request:</span>
<a name="l436"><span class="linenum"> 436</span></a>          <a class="var it478" onMouseOver="hilite(478)" onMouseOut="lolite()" onClick="logVariable('Session')" href="../../_variables/Session.html">$Session</a>-&gt;<a class="function" onClick="logFunction('assert_received_crumb')" href="../../_functions/assert_received_crumb.html" onMouseOver="funcPopup(event,'assert_received_crumb')">assert_received_crumb</a>( 'antispam' );
<a name="l437"><span class="linenum"> 437</span></a>  
<a name="l438"><span class="linenum"> 438</span></a>  <span class="comment">        // Check permission:</span>
<a name="l439"><span class="linenum"> 439</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'options', 'edit', true );
<a name="l440"><span class="linenum"> 440</span></a>  
<a name="l441"><span class="linenum"> 441</span></a>          <a class="var it8400" onMouseOver="hilite(8400)" onMouseOut="lolite()" onClick="logVariable('bankruptcy_blogs_IDs')" href="../../_variables/bankruptcy_blogs_IDs.html">$bankruptcy_blogs_IDs</a> = <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'bankruptcy_blogs', 'array:integer', array() );
<a name="l442"><span class="linenum"> 442</span></a>  
<a name="l443"><span class="linenum"> 443</span></a>          if( empty( <a class="var it8893" onMouseOver="hilite(8893)" onMouseOut="lolite()" onClick="logVariable('bankruptcy_blogs')" href="../../_variables/bankruptcy_blogs.html">$bankruptcy_blogs</a> ) )
<a name="l444"><span class="linenum"> 444</span></a>          {
<a name="l445"><span class="linenum"> 445</span></a>              <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Please select at least one blog.'), 'error' );
<a name="l446"><span class="linenum"> 446</span></a>          }
<a name="l447"><span class="linenum"> 447</span></a>  
<a name="l448"><span class="linenum"> 448</span></a>          if( !<a class="function" onClick="logFunction('param_errors_detected')" href="../../_functions/param_errors_detected.html" onMouseOver="funcPopup(event,'param_errors_detected')">param_errors_detected</a>() )
<a name="l449"><span class="linenum"> 449</span></a>          { // Try to obtain some serious time to do some serious processing (15 minutes)
<a name="l450"><span class="linenum"> 450</span></a>              <a class="function" onClick="logFunction('set_max_execution_time')" href="../../_functions/set_max_execution_time.html" onMouseOver="funcPopup(event,'set_max_execution_time')">set_max_execution_time</a>( 900 );
<a name="l451"><span class="linenum"> 451</span></a>  <span class="comment">            // Turn off the output buffering to do the correct work of the function flush()</span>
<a name="l452"><span class="linenum"> 452</span></a>              @<a class="phpfunction" onClick="logFunction('ini_set')" href="../../_functions/ini_set.html" onMouseOver="phpfuncPopup(event,'ini_set')">ini_set</a>( 'output_buffering', 'off' );
<a name="l453"><span class="linenum"> 453</span></a>  <span class="comment">            // Set this to start deleting in the template file</span>
<a name="l454"><span class="linenum"> 454</span></a>              <a class="var it8399" onMouseOver="hilite(8399)" onMouseOut="lolite()" onClick="logVariable('delete_bankruptcy_blogs')" href="../../_variables/delete_bankruptcy_blogs.html">$delete_bankruptcy_blogs</a> = true;
<a name="l455"><span class="linenum"> 455</span></a>          }
<a name="l456"><span class="linenum"> 456</span></a>          break;
<a name="l457"><span class="linenum"> 457</span></a>  }
<a name="l458"><span class="linenum"> 458</span></a>  
<a name="l459"><span class="linenum"> 459</span></a>  if( <a class="var it1195" onMouseOver="hilite(1195)" onMouseOut="lolite()" onClick="logVariable('display_mode')" href="../../_variables/display_mode.html">$display_mode</a> != 'js' )
<a name="l460"><span class="linenum"> 460</span></a>  {
<a name="l461"><span class="linenum"> 461</span></a>      if( <a class="var it1211" onMouseOver="hilite(1211)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../_variables/tab.html">$tab</a> == 'stats' )
<a name="l462"><span class="linenum"> 462</span></a>      {
<a name="l463"><span class="linenum"> 463</span></a>  <span class="comment">        // We should activate toolbar menu items for this controller and tab</span>
<a name="l464"><span class="linenum"> 464</span></a>          <a class="var it137" onMouseOver="hilite(137)" onMouseOut="lolite()" onClick="logVariable('activate_collection_toolbar')" href="../../_variables/activate_collection_toolbar.html">$activate_collection_toolbar</a> = true;
<a name="l465"><span class="linenum"> 465</span></a>  
<a name="l466"><span class="linenum"> 466</span></a>          if( isset( <a class="var it3422" onMouseOver="hilite(3422)" onMouseOut="lolite()" onClick="logVariable('collections_Module')" href="../../_variables/collections_Module.html">$collections_Module</a> ) )
<a name="l467"><span class="linenum"> 467</span></a>          { // Display list of blogs:
<a name="l468"><span class="linenum"> 468</span></a>              if( <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'stats', 'view' ) )
<a name="l469"><span class="linenum"> 469</span></a>              {
<a name="l470"><span class="linenum"> 470</span></a>                  <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('set_coll_list_params')" href="../../_functions/set_coll_list_params.html" onMouseOver="funcPopup(event,'set_coll_list_params')">set_coll_list_params</a>( 'stats', 'view', array( 'ctrl' =&gt; 'antispam', 'tab' =&gt; <a class="var it1211" onMouseOver="hilite(1211)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../_variables/tab.html">$tab</a>, 'tab3' =&gt; <a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('tab3')" href="../../_variables/tab3.html">$tab3</a> ), <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('All'),
<a name="l471"><span class="linenum"> 471</span></a>                                  <a class="var it136" onMouseOver="hilite(136)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../_variables/admin_url.html">$admin_url</a>.'?ctrl=antispam&amp;amp;tab='.<a class="var it1211" onMouseOver="hilite(1211)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../_variables/tab.html">$tab</a>.'&amp;amp;tab3='.<a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('tab3')" href="../../_variables/tab3.html">$tab3</a>.'&amp;amp;blog=0' );
<a name="l472"><span class="linenum"> 472</span></a>              }
<a name="l473"><span class="linenum"> 473</span></a>              else
<a name="l474"><span class="linenum"> 474</span></a>              { // No permission to view aggregated stats:
<a name="l475"><span class="linenum"> 475</span></a>                  <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('set_coll_list_params')" href="../../_functions/set_coll_list_params.html" onMouseOver="funcPopup(event,'set_coll_list_params')">set_coll_list_params</a>( 'stats', 'view', array( 'ctrl' =&gt; 'antispam', 'tab' =&gt; <a class="var it1211" onMouseOver="hilite(1211)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../_variables/tab.html">$tab</a>, 'tab3' =&gt; <a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('tab3')" href="../../_variables/tab3.html">$tab3</a> ) );
<a name="l476"><span class="linenum"> 476</span></a>              }
<a name="l477"><span class="linenum"> 477</span></a>          }
<a name="l478"><span class="linenum"> 478</span></a>          <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_init')" href="../../_functions/breadcrumbpath_init.html" onMouseOver="funcPopup(event,'breadcrumbpath_init')">breadcrumbpath_init</a>( true, array( 'text' =&gt; <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Analytics'), 'url' =&gt; '?ctrl=stats&amp;amp;blog=<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../_variables/blog.html">$blog</a>$' ) );
<a name="l479"><span class="linenum"> 479</span></a>          <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('IPs'), <a class="var it136" onMouseOver="hilite(136)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../_variables/admin_url.html">$admin_url</a>.'?ctrl=stats&amp;amp;blog=<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../_variables/blog.html">$blog</a>$&amp;amp;tab='.<a class="var it1211" onMouseOver="hilite(1211)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../_variables/tab.html">$tab</a> );
<a name="l480"><span class="linenum"> 480</span></a>          <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('IP Ranges'), <a class="var it136" onMouseOver="hilite(136)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../_variables/admin_url.html">$admin_url</a>.'?ctrl=stats&amp;amp;blog=<a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../_variables/blog.html">$blog</a>$&amp;amp;tab='.<a class="var it1211" onMouseOver="hilite(1211)" onMouseOut="lolite()" onClick="logVariable('tab')" href="../../_variables/tab.html">$tab</a>.'&amp;amp;tab3='.<a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('tab3')" href="../../_variables/tab3.html">$tab3</a> );
<a name="l481"><span class="linenum"> 481</span></a>          <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('set_path')" href="../../_functions/set_path.html" onMouseOver="funcPopup(event,'set_path')">set_path</a>( 'stats', 'ips', 'ranges' );
<a name="l482"><span class="linenum"> 482</span></a>      }
<a name="l483"><span class="linenum"> 483</span></a>      else
<a name="l484"><span class="linenum"> 484</span></a>      {
<a name="l485"><span class="linenum"> 485</span></a>          <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_init')" href="../../_functions/breadcrumbpath_init.html" onMouseOver="funcPopup(event,'breadcrumbpath_init')">breadcrumbpath_init</a>( false );  <span class="comment">// fp&gt; I'm playing with the idea of keeping the current blog in the path here...</span>
<a name="l486"><span class="linenum"> 486</span></a>          <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('System'), <a class="var it136" onMouseOver="hilite(136)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../_variables/admin_url.html">$admin_url</a>.'?ctrl=system' );
<a name="l487"><span class="linenum"> 487</span></a>          <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Antispam'), <a class="var it136" onMouseOver="hilite(136)" onMouseOut="lolite()" onClick="logVariable('admin_url')" href="../../_variables/admin_url.html">$admin_url</a>.'?ctrl=antispam' );
<a name="l488"><span class="linenum"> 488</span></a>      }
<a name="l489"><span class="linenum"> 489</span></a>  
<a name="l490"><span class="linenum"> 490</span></a>      if( empty( <a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('tab3')" href="../../_variables/tab3.html">$tab3</a> ) )
<a name="l491"><span class="linenum"> 491</span></a>      {
<a name="l492"><span class="linenum"> 492</span></a>          <a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('tab3')" href="../../_variables/tab3.html">$tab3</a> = 'blacklist';
<a name="l493"><span class="linenum"> 493</span></a>      }
<a name="l494"><span class="linenum"> 494</span></a>      switch( <a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('tab3')" href="../../_variables/tab3.html">$tab3</a> )
<a name="l495"><span class="linenum"> 495</span></a>      {
<a name="l496"><span class="linenum"> 496</span></a>          case 'settings':
<a name="l497"><span class="linenum"> 497</span></a>              <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Settings'), '?ctrl=antispam&amp;amp;tab3='.<a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('tab3')" href="../../_variables/tab3.html">$tab3</a> );
<a name="l498"><span class="linenum"> 498</span></a>  
<a name="l499"><span class="linenum"> 499</span></a>  <span class="comment">            // Set an url for manual page:</span>
<a name="l500"><span class="linenum"> 500</span></a>              <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('set_page_manual_link')" href="../../_functions/set_page_manual_link.html" onMouseOver="funcPopup(event,'set_page_manual_link')">set_page_manual_link</a>( 'antispam-settings' );
<a name="l501"><span class="linenum"> 501</span></a>              break;
<a name="l502"><span class="linenum"> 502</span></a>  
<a name="l503"><span class="linenum"> 503</span></a>          case 'tools':
<a name="l504"><span class="linenum"> 504</span></a>              <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Tools'), '?ctrl=antispam&amp;amp;tab3='.<a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('tab3')" href="../../_variables/tab3.html">$tab3</a> );
<a name="l505"><span class="linenum"> 505</span></a>  
<a name="l506"><span class="linenum"> 506</span></a>  <span class="comment">            // Set an url for manual page:</span>
<a name="l507"><span class="linenum"> 507</span></a>              <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('set_page_manual_link')" href="../../_functions/set_page_manual_link.html" onMouseOver="funcPopup(event,'set_page_manual_link')">set_page_manual_link</a>( 'antispam-tools' );
<a name="l508"><span class="linenum"> 508</span></a>              break;
<a name="l509"><span class="linenum"> 509</span></a>  
<a name="l510"><span class="linenum"> 510</span></a>          case 'blacklist':
<a name="l511"><span class="linenum"> 511</span></a>              <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Blacklist'), '?ctrl=antispam' );
<a name="l512"><span class="linenum"> 512</span></a>  
<a name="l513"><span class="linenum"> 513</span></a>  <span class="comment">            // Set an url for manual page:</span>
<a name="l514"><span class="linenum"> 514</span></a>              <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('set_page_manual_link')" href="../../_functions/set_page_manual_link.html" onMouseOver="funcPopup(event,'set_page_manual_link')">set_page_manual_link</a>( 'antispam-tab' );
<a name="l515"><span class="linenum"> 515</span></a>              break;
<a name="l516"><span class="linenum"> 516</span></a>  
<a name="l517"><span class="linenum"> 517</span></a>          case 'ipranges':
<a name="l518"><span class="linenum"> 518</span></a>              if( empty( <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> ) )
<a name="l519"><span class="linenum"> 519</span></a>              {    // View a list of IP ranges
<a name="l520"><span class="linenum"> 520</span></a>                  <a class="function" onClick="logFunction('require_js')" href="../../_functions/require_js.html" onMouseOver="funcPopup(event,'require_js')">require_js</a>( 'jquery/jquery.jeditable.js', 'rsc_url' );
<a name="l521"><span class="linenum"> 521</span></a>              }
<a name="l522"><span class="linenum"> 522</span></a>              elseif( ! <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'spamblacklist', 'edit' ) )
<a name="l523"><span class="linenum"> 523</span></a>              {    // Check permission to create/edit IP range
<a name="l524"><span class="linenum"> 524</span></a>                  <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('add')" href="../../_functions/add.html" onMouseOver="funcPopup(event,'add')">add</a>( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('You have no permission to edit this IP range!'), 'error' );
<a name="l525"><span class="linenum"> 525</span></a>                  <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> = '';
<a name="l526"><span class="linenum"> 526</span></a>              }
<a name="l527"><span class="linenum"> 527</span></a>              <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('IP Ranges'), '?ctrl=antispam&amp;amp;tab3='.<a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('tab3')" href="../../_variables/tab3.html">$tab3</a> );
<a name="l528"><span class="linenum"> 528</span></a>  
<a name="l529"><span class="linenum"> 529</span></a>  <span class="comment">            // Set an url for manual page:</span>
<a name="l530"><span class="linenum"> 530</span></a>              if( <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> == 'iprange_new' || <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> == 'iprange_edit' )
<a name="l531"><span class="linenum"> 531</span></a>              {
<a name="l532"><span class="linenum"> 532</span></a>                  <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('set_page_manual_link')" href="../../_functions/set_page_manual_link.html" onMouseOver="funcPopup(event,'set_page_manual_link')">set_page_manual_link</a>( 'ip-range-editing' );
<a name="l533"><span class="linenum"> 533</span></a>              }
<a name="l534"><span class="linenum"> 534</span></a>              else
<a name="l535"><span class="linenum"> 535</span></a>              {
<a name="l536"><span class="linenum"> 536</span></a>                  <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('set_page_manual_link')" href="../../_functions/set_page_manual_link.html" onMouseOver="funcPopup(event,'set_page_manual_link')">set_page_manual_link</a>( 'ip-ranges' );
<a name="l537"><span class="linenum"> 537</span></a>              }
<a name="l538"><span class="linenum"> 538</span></a>              break;
<a name="l539"><span class="linenum"> 539</span></a>  
<a name="l540"><span class="linenum"> 540</span></a>          case 'countries':
<a name="l541"><span class="linenum"> 541</span></a>              if( <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'options', 'edit' ) )
<a name="l542"><span class="linenum"> 542</span></a>              {
<a name="l543"><span class="linenum"> 543</span></a>                  <a class="function" onClick="logFunction('require_js')" href="../../_functions/require_js.html" onMouseOver="funcPopup(event,'require_js')">require_js</a>( 'jquery/jquery.jeditable.js' );
<a name="l544"><span class="linenum"> 544</span></a>              }
<a name="l545"><span class="linenum"> 545</span></a>  
<a name="l546"><span class="linenum"> 546</span></a>  <span class="comment">            // Set an url for manual page:</span>
<a name="l547"><span class="linenum"> 547</span></a>              <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('set_page_manual_link')" href="../../_functions/set_page_manual_link.html" onMouseOver="funcPopup(event,'set_page_manual_link')">set_page_manual_link</a>( 'countries-list' );
<a name="l548"><span class="linenum"> 548</span></a>              break;
<a name="l549"><span class="linenum"> 549</span></a>  
<a name="l550"><span class="linenum"> 550</span></a>          case 'domains':
<a name="l551"><span class="linenum"> 551</span></a>              <a class="function" onClick="logFunction('load_funcs')" href="../../_functions/load_funcs.html" onMouseOver="funcPopup(event,'load_funcs')">load_funcs</a>('sessions/model/_hitlog.funcs.php');
<a name="l552"><span class="linenum"> 552</span></a>              <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('breadcrumbpath_add')" href="../../_functions/breadcrumbpath_add.html" onMouseOver="funcPopup(event,'breadcrumbpath_add')">breadcrumbpath_add</a>( <a class="function" onClick="logFunction('T_')" href="../../_functions/t_.html" onMouseOver="funcPopup(event,'t_')">T_</a>('Referring domains'), '?ctrl=antispam&amp;amp;tab3='.<a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('tab3')" href="../../_variables/tab3.html">$tab3</a> );
<a name="l553"><span class="linenum"> 553</span></a>              if( <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'stats', 'edit' ) )
<a name="l554"><span class="linenum"> 554</span></a>              {
<a name="l555"><span class="linenum"> 555</span></a>                  <a class="function" onClick="logFunction('require_js')" href="../../_functions/require_js.html" onMouseOver="funcPopup(event,'require_js')">require_js</a>( 'jquery/jquery.jeditable.js' );
<a name="l556"><span class="linenum"> 556</span></a>              }
<a name="l557"><span class="linenum"> 557</span></a>  <span class="comment">            // Load jquery UI to highlight cell on change domain type</span>
<a name="l558"><span class="linenum"> 558</span></a>              <a class="function" onClick="logFunction('require_js')" href="../../_functions/require_js.html" onMouseOver="funcPopup(event,'require_js')">require_js</a>( '#jqueryUI#' );
<a name="l559"><span class="linenum"> 559</span></a>  <span class="comment">            // Used for edit form</span>
<a name="l560"><span class="linenum"> 560</span></a>              <a class="var it8894" onMouseOver="hilite(8894)" onMouseOut="lolite()" onClick="logVariable('tab_from')" href="../../_variables/tab_from.html">$tab_from</a> = 'antispam';
<a name="l561"><span class="linenum"> 561</span></a>              <a class="var it143" onMouseOver="hilite(143)" onMouseOut="lolite()" onClick="logVariable('blog')" href="../../_variables/blog.html">$blog</a> = 0; <span class="comment">// Don't restrict domains by blog ID on this controller</span>
<a name="l562"><span class="linenum"> 562</span></a>  
<a name="l563"><span class="linenum"> 563</span></a>  <span class="comment">            // Set an url for manual page:</span>
<a name="l564"><span class="linenum"> 564</span></a>              <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('set_page_manual_link')" href="../../_functions/set_page_manual_link.html" onMouseOver="funcPopup(event,'set_page_manual_link')">set_page_manual_link</a>( 'referring-domains-tab' );
<a name="l565"><span class="linenum"> 565</span></a>              break;
<a name="l566"><span class="linenum"> 566</span></a>      }
<a name="l567"><span class="linenum"> 567</span></a>  
<a name="l568"><span class="linenum"> 568</span></a>      if( !empty( <a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('tab3')" href="../../_variables/tab3.html">$tab3</a> ) )
<a name="l569"><span class="linenum"> 569</span></a>      {
<a name="l570"><span class="linenum"> 570</span></a>          <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('append_path_level')" href="../../_functions/append_path_level.html" onMouseOver="funcPopup(event,'append_path_level')">append_path_level</a>( <a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('tab3')" href="../../_variables/tab3.html">$tab3</a> );
<a name="l571"><span class="linenum"> 571</span></a>      }
<a name="l572"><span class="linenum"> 572</span></a>  
<a name="l573"><span class="linenum"> 573</span></a>  <span class="comment">    // Display &lt;html&gt;&lt;head&gt;...&lt;/head&gt; section! (Note: should be done early if actions do not redirect)</span>
<a name="l574"><span class="linenum"> 574</span></a>      <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_html_head')" href="../../_functions/disp_html_head.html" onMouseOver="funcPopup(event,'disp_html_head')">disp_html_head</a>();
<a name="l575"><span class="linenum"> 575</span></a>      
<a name="l576"><span class="linenum"> 576</span></a>  <span class="comment">    // Display title, menu, messages, etc. (Note: messages MUST be displayed AFTER the actions)</span>
<a name="l577"><span class="linenum"> 577</span></a>      <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_body_top')" href="../../_functions/disp_body_top.html" onMouseOver="funcPopup(event,'disp_body_top')">disp_body_top</a>();
<a name="l578"><span class="linenum"> 578</span></a>  
<a name="l579"><span class="linenum"> 579</span></a>  <span class="comment">    // Begin payload block:</span>
<a name="l580"><span class="linenum"> 580</span></a>      <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_payload_begin')" href="../../_functions/disp_payload_begin.html" onMouseOver="funcPopup(event,'disp_payload_begin')">disp_payload_begin</a>();
<a name="l581"><span class="linenum"> 581</span></a>  }
<a name="l582"><span class="linenum"> 582</span></a>  
<a name="l583"><span class="linenum"> 583</span></a>  switch( <a class="var it1212" onMouseOver="hilite(1212)" onMouseOut="lolite()" onClick="logVariable('tab3')" href="../../_variables/tab3.html">$tab3</a> )
<a name="l584"><span class="linenum"> 584</span></a>  {
<a name="l585"><span class="linenum"> 585</span></a>      case 'settings':
<a name="l586"><span class="linenum"> 586</span></a>          <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'antispam/views/_antispam_settings.form.php' );
<a name="l587"><span class="linenum"> 587</span></a>          break;
<a name="l588"><span class="linenum"> 588</span></a>  
<a name="l589"><span class="linenum"> 589</span></a>      case 'tools':
<a name="l590"><span class="linenum"> 590</span></a>  <span class="comment">        // Check permission:</span>
<a name="l591"><span class="linenum"> 591</span></a>          <a class="var it113" onMouseOver="hilite(113)" onMouseOut="lolite()" onClick="logVariable('current_User')" href="../../_variables/current_User.html">$current_User</a>-&gt;<a class="function" onClick="logFunction('check_perm')" href="../../_functions/check_perm.html" onMouseOver="funcPopup(event,'check_perm')">check_perm</a>( 'options', 'edit', true );
<a name="l592"><span class="linenum"> 592</span></a>  
<a name="l593"><span class="linenum"> 593</span></a>          switch( <a class="var it8875" onMouseOver="hilite(8875)" onMouseOut="lolite()" onClick="logVariable('tool')" href="../../_variables/tool.html">$tool</a> )
<a name="l594"><span class="linenum"> 594</span></a>          {
<a name="l595"><span class="linenum"> 595</span></a>              case 'bankruptcy':
<a name="l596"><span class="linenum"> 596</span></a>                  <a class="var it1455" onMouseOver="hilite(1455)" onMouseOut="lolite()" onClick="logVariable('comment_status')" href="../../_variables/comment_status.html">$comment_status</a> = <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'comment_status', 'string', 'draft' );
<a name="l597"><span class="linenum"> 597</span></a>                  <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'antispam/views/_antispam_tools_bankruptcy.view.php' );
<a name="l598"><span class="linenum"> 598</span></a>                  break;
<a name="l599"><span class="linenum"> 599</span></a>  
<a name="l600"><span class="linenum"> 600</span></a>              default:
<a name="l601"><span class="linenum"> 601</span></a>                  <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'antispam/views/_antispam_tools.view.php' );
<a name="l602"><span class="linenum"> 602</span></a>                  break;
<a name="l603"><span class="linenum"> 603</span></a>          }
<a name="l604"><span class="linenum"> 604</span></a>          break;
<a name="l605"><span class="linenum"> 605</span></a>  
<a name="l606"><span class="linenum"> 606</span></a>      case 'ipranges':
<a name="l607"><span class="linenum"> 607</span></a>          switch( <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> )
<a name="l608"><span class="linenum"> 608</span></a>          {
<a name="l609"><span class="linenum"> 609</span></a>              case 'iprange_new':
<a name="l610"><span class="linenum"> 610</span></a>                  if( ! isset( <a class="var it6178" onMouseOver="hilite(6178)" onMouseOut="lolite()" onClick="logVariable('edited_IPRange')" href="../../_variables/edited_IPRange.html">$edited_IPRange</a> ) )
<a name="l611"><span class="linenum"> 611</span></a>                  { // Define <span class="keyword">new </span><a class="class" onClick="logClass('IPRange')" href="../../_classes/iprange.html" onMouseOver="classPopup(event,'iprange')">IPRange</a> object only when it was not defined before, e.g. in action 'iprange_create'
<a name="l612"><span class="linenum"> 612</span></a>                      <a class="var it6178" onMouseOver="hilite(6178)" onMouseOut="lolite()" onClick="logVariable('edited_IPRange')" href="../../_variables/edited_IPRange.html">$edited_IPRange</a> = <span class="keyword">new </span><a class="class" onClick="logClass('IPRange')" href="../../_classes/iprange.html" onMouseOver="classPopup(event,'iprange')">IPRange</a>();
<a name="l613"><span class="linenum"> 613</span></a>                  }
<a name="l614"><span class="linenum"> 614</span></a>  <span class="comment">                // Set IP Start and End from _GET request</span>
<a name="l615"><span class="linenum"> 615</span></a>                  <a class="var it810" onMouseOver="hilite(810)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../../_variables/ip.html">$ip</a> = <a class="function" onClick="logFunction('param')" href="../../_functions/param.html" onMouseOver="funcPopup(event,'param')">param</a>( 'ip', 'string', '' );
<a name="l616"><span class="linenum"> 616</span></a>                  if( ! empty( <a class="var it810" onMouseOver="hilite(810)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../../_variables/ip.html">$ip</a> ) &amp;&amp; <a class="function" onClick="logFunction('is_valid_ip_format')" href="../../_functions/is_valid_ip_format.html" onMouseOver="funcPopup(event,'is_valid_ip_format')">is_valid_ip_format</a>( <a class="var it810" onMouseOver="hilite(810)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../../_variables/ip.html">$ip</a> ) &amp;&amp;
<a name="l617"><span class="linenum"> 617</span></a>                      ( <a class="var it810" onMouseOver="hilite(810)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../../_variables/ip.html">$ip</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>( '.', <a class="var it810" onMouseOver="hilite(810)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../../_variables/ip.html">$ip</a> ) ) &amp;&amp; <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>( <a class="var it810" onMouseOver="hilite(810)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../../_variables/ip.html">$ip</a> ) == 4 )
<a name="l618"><span class="linenum"> 618</span></a>                  {
<a name="l619"><span class="linenum"> 619</span></a>                      <a class="var it6178" onMouseOver="hilite(6178)" onMouseOut="lolite()" onClick="logVariable('edited_IPRange')" href="../../_variables/edited_IPRange.html">$edited_IPRange</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'IPv4start', <a class="function" onClick="logFunction('ip2int')" href="../../_functions/ip2int.html" onMouseOver="funcPopup(event,'ip2int')">ip2int</a>( <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( '.', array( <a class="var it810" onMouseOver="hilite(810)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../../_variables/ip.html">$ip</a>[0], <a class="var it810" onMouseOver="hilite(810)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../../_variables/ip.html">$ip</a>[1], <a class="var it810" onMouseOver="hilite(810)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../../_variables/ip.html">$ip</a>[2], 0 ) ) ) );
<a name="l620"><span class="linenum"> 620</span></a>                      <a class="var it6178" onMouseOver="hilite(6178)" onMouseOut="lolite()" onClick="logVariable('edited_IPRange')" href="../../_variables/edited_IPRange.html">$edited_IPRange</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>( 'IPv4end', <a class="function" onClick="logFunction('ip2int')" href="../../_functions/ip2int.html" onMouseOver="funcPopup(event,'ip2int')">ip2int</a>( <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( '.', array( <a class="var it810" onMouseOver="hilite(810)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../../_variables/ip.html">$ip</a>[0], <a class="var it810" onMouseOver="hilite(810)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../../_variables/ip.html">$ip</a>[1], <a class="var it810" onMouseOver="hilite(810)" onMouseOut="lolite()" onClick="logVariable('ip')" href="../../_variables/ip.html">$ip</a>[2], 255 ) ) ) );
<a name="l621"><span class="linenum"> 621</span></a>                  }
<a name="l622"><span class="linenum"> 622</span></a>                  <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'antispam/views/_antispam_ipranges.form.php' );
<a name="l623"><span class="linenum"> 623</span></a>                  break;
<a name="l624"><span class="linenum"> 624</span></a>  
<a name="l625"><span class="linenum"> 625</span></a>              case 'iprange_edit':
<a name="l626"><span class="linenum"> 626</span></a>                  <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'antispam/views/_antispam_ipranges.form.php' );
<a name="l627"><span class="linenum"> 627</span></a>                  break;
<a name="l628"><span class="linenum"> 628</span></a>  
<a name="l629"><span class="linenum"> 629</span></a>              default:    // View list of the IP Ranges
<a name="l630"><span class="linenum"> 630</span></a>                  <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'antispam/views/_antispam_ipranges.view.php' );
<a name="l631"><span class="linenum"> 631</span></a>                  break;
<a name="l632"><span class="linenum"> 632</span></a>          }
<a name="l633"><span class="linenum"> 633</span></a>          break;
<a name="l634"><span class="linenum"> 634</span></a>  
<a name="l635"><span class="linenum"> 635</span></a>      case 'countries':
<a name="l636"><span class="linenum"> 636</span></a>          <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'regional/views/_country_list.view.php' );
<a name="l637"><span class="linenum"> 637</span></a>          break;
<a name="l638"><span class="linenum"> 638</span></a>  
<a name="l639"><span class="linenum"> 639</span></a>      case 'domains':
<a name="l640"><span class="linenum"> 640</span></a>          <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'sessions/views/_stats_refdomains.view.php' );
<a name="l641"><span class="linenum"> 641</span></a>          break;
<a name="l642"><span class="linenum"> 642</span></a>  
<a name="l643"><span class="linenum"> 643</span></a>      case 'blacklist':
<a name="l644"><span class="linenum"> 644</span></a>      default:
<a name="l645"><span class="linenum"> 645</span></a>          if( <a class="var it125" onMouseOver="hilite(125)" onMouseOut="lolite()" onClick="logVariable('action')" href="../../_variables/action.html">$action</a> == 'ban' &amp;&amp; ( ! <a class="var it26" onMouseOver="hilite(26)" onMouseOut="lolite()" onClick="logVariable('Messages')" href="../../_variables/Messages.html">$Messages</a>-&gt;<a class="function" onClick="logFunction('has_errors')" href="../../_functions/has_errors.html" onMouseOver="funcPopup(event,'has_errors')">has_errors</a>() || ! empty( <a class="var it8359" onMouseOver="hilite(8359)" onMouseOut="lolite()" onClick="logVariable('confirm')" href="../../_variables/confirm.html">$confirm</a> ) ) &amp;&amp; !( <a class="var it8880" onMouseOver="hilite(8880)" onMouseOut="lolite()" onClick="logVariable('delhits')" href="../../_variables/delhits.html">$delhits</a> || <a class="var it8879" onMouseOver="hilite(8879)" onMouseOut="lolite()" onClick="logVariable('delcomments')" href="../../_variables/delcomments.html">$delcomments</a> ) )
<a name="l646"><span class="linenum"> 646</span></a>          {    // Nothing to do, ask user:
<a name="l647"><span class="linenum"> 647</span></a>              <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'antispam/views/_antispam_ban.form.php' );
<a name="l648"><span class="linenum"> 648</span></a>          }
<a name="l649"><span class="linenum"> 649</span></a>          else
<a name="l650"><span class="linenum"> 650</span></a>          {    // Display blacklist:
<a name="l651"><span class="linenum"> 651</span></a>              <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_view')" href="../../_functions/disp_view.html" onMouseOver="funcPopup(event,'disp_view')">disp_view</a>( 'antispam/views/_antispam_list.view.php' );
<a name="l652"><span class="linenum"> 652</span></a>          }
<a name="l653"><span class="linenum"> 653</span></a>          break;
<a name="l654"><span class="linenum"> 654</span></a>  }
<a name="l655"><span class="linenum"> 655</span></a>  
<a name="l656"><span class="linenum"> 656</span></a>  <span class="comment">// End payload block:</span>
<a name="l657"><span class="linenum"> 657</span></a>  if( <a class="var it1195" onMouseOver="hilite(1195)" onMouseOut="lolite()" onClick="logVariable('display_mode')" href="../../_variables/display_mode.html">$display_mode</a> != 'js')
<a name="l658"><span class="linenum"> 658</span></a>  {
<a name="l659"><span class="linenum"> 659</span></a>      <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_payload_end')" href="../../_functions/disp_payload_end.html" onMouseOver="funcPopup(event,'disp_payload_end')">disp_payload_end</a>();
<a name="l660"><span class="linenum"> 660</span></a>  
<a name="l661"><span class="linenum"> 661</span></a>  <span class="comment">    // Display body bottom, debug info and close &lt;/html&gt;:</span>
<a name="l662"><span class="linenum"> 662</span></a>      <a class="var it144" onMouseOver="hilite(144)" onMouseOut="lolite()" onClick="logVariable('AdminUI')" href="../../_variables/AdminUI.html">$AdminUI</a>-&gt;<a class="function" onClick="logFunction('disp_global_footer')" href="../../_functions/disp_global_footer.html" onMouseOver="funcPopup(event,'disp_global_footer')">disp_global_footer</a>();
<a name="l663"><span class="linenum"> 663</span></a>  }
<a name="l664"><span class="linenum"> 664</span></a>  
<a name="l665"><span class="linenum"> 665</span></a>  ?&gt;
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'quote': ['quote', 'Quote a msgid/msgstr, preferrable with single quotes. ', [['inc/locales','_pofile.class.php',261],['inc/_core/model/db','_db.class.php',491]], 1085],
'antispam_delete': ['antispam_delete', '', [['inc/antispam/model','_antispam.funcs.php',88]], 1],
'set': ['set', 'Set param value ', [['inc/items/model','_item.class.php',4909],['inc/tools/model','_emailaddress.class.php',76],['inc/_core/model/dataobjects','_dataobject.class.php',874],['inc/plugins/model','_pluginusersettings.class.php',64],['inc/regional/model','_country.class.php',94],['inc/users/model','_user.class.php',2059],['inc/settings/model','_abstractsettings.class.php',427],['inc/messaging/model','_thread.class.php',211],['inc/regional/model','_subregion.class.php',107],['inc/users/model','_usersettings.class.php',184],['plugins','_calendar.plugin.php',613],['inc/_ext/swift/classes/Swift/Mime','HeaderSet.php',81],['inc/files/model','_filetype.class.php',128],['inc/sessions/model','_session.class.php',451],['inc/collections/model','_blog.class.php',1104],['inc/comments/model','_comment.class.php',400],['inc/cron/model','_cronjob.class.php',64],['inc/plugins/model','_pluginsettings.class.php',52],['inc/users/model','_userfield.class.php',257],['inc/regional/model','_city.class.php',98],['inc/slugs/model','_slug.class.php',80],['inc/users/model','_group.class.php',212],['inc/regional/model','_currency.class.php',84],['inc/widgets/model','_widget.class.php',369],['inc/regional/model','_region.class.php',90],['inc/users/model','_groupsettings.class.php',140],['inc/chapters/model','_chapter.class.php',809],['inc/antispam/model','_iprange.class.php',72],['inc/items/model','_itemtag.class.php',61],['inc/sessions/model','_goal.class.php',201],['inc/items/model','_itemlight.class.php',1328],['inc/users/model','_userfieldgroup.class.php',83],['inc/_ext/swift/classes/Swift/Mime','SimpleHeaderSet.php',148]], 1238],
'require_js': ['require_js', 'Memorize that a specific javascript file will be required by the current page. All requested files will be included in the page head only once (when headlines is called) ', [['inc/_core','_template.funcs.php',967]], 173],
'table': ['table', 'Constructor ', [['inc/_core/ui','_uiwidget.class.php',344]], 24],
'dbdelete': ['dbdelete', 'Trigger event AfterItemDelete after calling parent method. ', [['inc/items/model','_item.class.php',5506],['inc/_core/model/dataobjects','_dataobject.class.php',591],['inc/users/model','_user.class.php',3376],['inc/messaging/model','_message.class.php',582],['inc/messaging/model','_thread.class.php',444],['inc/items/model','_itemtype.class.php',451],['inc/files/model','_filetype.class.php',271],['inc/collections/model','_blog.class.php',2664],['inc/comments/model','_comment.class.php',3872],['inc/users/model','_group.class.php',497]], 62],
'dbupdate': ['dbupdate', 'Update the DB based on previously recorded changes ', [['inc/items/model','_item.class.php',5287],['inc/_core/model/dataobjects','_dataobject.class.php',386],['inc/users/model','_user.class.php',3249],['inc/skins/model','_skin.class.php',416],['inc/settings/model','_abstractsettings.class.php',575],['inc/items/model','_itemtype.class.php',433],['inc/files/model','_filetype.class.php',242],['inc/collections/model','_blog.class.php',2630],['inc/comments/model','_comment.class.php',3747],['inc/cron/model','_cronjob.class.php',188],['inc/slugs/model','_slug.class.php',265],['inc/users/model','_group.class.php',478],['inc/widgets/model','_widget.class.php',861],['inc/users/model','_groupsettings.class.php',159],['inc/chapters/model','_chapter.class.php',564],['inc/files/model','_file.class.php',1825]], 289],
'has_errors': ['has_errors', 'Has error message in current object ', [['inc/_core/model','_messages.class.php',314]], 54],
'db_delete_where': ['db_delete_where', 'Delete the given class objects from the database which corresponds to the given condition or to the given ids array This function must be overriden on those classes where the db delete requires some updates on other table content or some files/folders delete. Note: the delete cascade arrays are handled! Delete cascades are handled recursively only if the cascade arrays from the reffering class contains the class and class_path params ( e.g. see User class )! ', [['inc/_core/model/dataobjects','_dataobject.class.php',175],['inc/users/model','_user.class.php',3308],['inc/messaging/model','_message.class.php',503],['inc/sessions/model','_session.class.php',281],['inc/comments/model','_comment.class.php',290]], 11],
'antispam_report_abuse': ['antispam_report_abuse', 'Pings b2evolution.net to report abuse from a particular domain. ', [['inc/antispam/model','_antispam.funcs.php',140]], 2],
'load_class': ['load_class', 'In PHP4, this really loads the class. In PHP5, it\'s smarter than that: It only registers the class & file name so that __autoload() can later load the class IF and ONLY IF the class is actually needed during execution. ', [['inc/_core','_class5.funcs.php',64],['inc/_core','_class4.funcs.php',19]], 435],
'breadcrumbpath_init': ['breadcrumbpath_init', 'Note: These are not real breadcrumbs. It\'s just "so to speak" for a hierarchical path. ', [['skins_adm','_adminUI_general.class.php',174]], 63],
'check_perm': ['check_perm', 'Check module permission ', [['inc/_core/model','_module.class.php',234],['inc/users/model','_user.class.php',2234],['inc/messaging/model','_message.class.php',595],['inc/messaging/model','_thread.class.php',482],['inc/links/model','_linkcomment.class.php',49],['inc/links/model','_linkitem.class.php',50],['inc/users/model','_group.class.php',265],['inc/sessions/model','_goal.class.php',94],['inc/links/model','_linkuser.class.php',47]], 1082],
'utf8_strlen': ['utf8_strlen', 'utf8_strlen( ) ', [['inc/_ext','_portable_utf8.php',173]], 41],
'query': ['query', 'Run Query: GET DATA ROWS *** HEAVY *** ', [['inc/items/model','_itemlist.class.php',249],['inc/items/model','_itemlistlight.class.php',742],['inc/comments/model','_commentlist.class.php',507],['inc/users/model','_userlist.class.php',511],['inc/_core/ui/results','_results.class.php',468],['inc/_core/model/db','_db.class.php',749]], 1144],
'header_redirect': ['header_redirect', 'Sends HTTP header to redirect to the previous location (which can be given as function parameter, GET parameter (redirect_to), is taken from {@link Hit::$referer} or {@link $baseurl}). ', [['inc/_core','_template.funcs.php',91]], 427],
'set_page_manual_link': ['set_page_manual_link', 'Adds a manual link to the entire page right after the breadcrumb ', [['skins_adm','_adminUI_general.class.php',243]], 149],
'antispam_poll_abuse': ['antispam_poll_abuse', 'Request abuse list from central blacklist. ', [['inc/antispam/model','_antispam.funcs.php',203]], 2],
'get_visibility_statuses': ['get_visibility_statuses', 'Get available post statuses ', [['inc/collections/model','_blog.funcs.php',953]], 87],
'get_col': ['get_col', 'Function to get 1 column from the cached result set based on X index see docs for usage and info ', [['inc/_core/model/db','_db.class.php',1032]], 117],
'append_path_level': ['append_path_level', 'Append a selected menu entry to the current path of selected entries. ', [['skins_adm','_adminUI_general.class.php',1357]], 8],
'add': ['add', '', [['inc/_ext/pclzip','pclzip.lib.php',455],['rsc/js/tiny_mce/plugins/spellchecker/includes','Engine.php',141],['inc/skins/model','_skincache.class.php',50],['inc/_core/model','_messages.class.php',114],['inc/_ext/swift/classes/Swift/Plugins','LoggerPlugin.php',33],['inc/_ext/swift/classes/Swift/Plugins','Logger.php',20],['inc/files/model','_filetypecache.class.php',38],['inc/_core/model/dataobjects','_dataobjectcache.class.php',339],['inc/_ext/swift/classes/Swift/Plugins/Loggers','EchoLogger.php',33],['inc/_core/model','_log.class.php',109],['inc/_core/model','_log.class.php',577],['inc/users/model','_usercache.class.php',239],['inc/_ext/swift/classes/Swift/Plugins/Loggers','ArrayLogger.php',44],['inc/links/model','_linkcache.class.php',86],['inc/users/model','_groupsettings.class.php',103],['inc/chapters/model','_chaptercache.class.php',98],['inc/files/model','_filelist.class.php',373],['inc/collections/model','_blogcache.class.php',50]], 1695],
'disp_body_top': ['disp_body_top', 'Dsiplay the top of the HTML <body>... ', [['skins_adm/bootstrap','_adminUI.class.php',161],['skins_adm','_adminUI_general.class.php',516]], 61],
'disp_payload_begin': ['disp_payload_begin', 'Display the start of a payload block ', [['skins_adm/bootstrap','_adminUI.class.php',200],['skins_adm','_adminUI_general.class.php',605]], 91],
'is_valid_ip_format': ['is_valid_ip_format', 'Check if the given string is a valid IPv4 or IPv6 address value ', [['inc/_core','_misc.funcs.php',6280]], 2],
'header_content_type': ['header_content_type', 'Template tag. Output content-type header ', [['inc/_core','_template.funcs.php',18]], 6],
'where': ['where', '', [['inc/_core/model/db','_sql.class.php',242]], 288],
'antispam_create': ['antispam_create', 'antispam_create(-) ', [['inc/antispam/model','_antispam.funcs.php',36]], 2],
'breadcrumbpath_add': ['breadcrumbpath_add', 'Note: These are not real breadcrumbs. It\'s just "so to speak" for a hierarchical path. ', [['skins_adm','_adminUI_general.class.php',213]], 253],
'param_error': ['param_error', 'Add an error for a variable, either to the Form\'s field and/or the global {@link $Messages} object. ', [['inc/_core','_param.funcs.php',1524]], 148],
'disp_view': ['disp_view', 'Display a view ', [['skins_adm','_adminUI_general.class.php',686]], 209],
'disp_payload_end': ['disp_payload_end', 'Display the end of a payload block ', [['skins_adm/bootstrap','_adminUI.class.php',214],['skins_adm','_adminUI_general.class.php',656]], 91],
'param_integer_range': ['param_integer_range', 'Gets a param and makes sure it\'s a decimal number (no float, e.g. 3.14) in a given range. ', [['inc/_core','_param.funcs.php',674]], 21],
'load_from_request': ['load_from_request', 'Init filter params from Request params ', [['inc/items/model','_itemlistlight.class.php',324],['inc/items/model','_item.class.php',570],['inc/widgets/widgets','_coll_tag_cloud.widget.php',37],['inc/tools/model','_emailaddress.class.php',90],['inc/email_campaigns/model','_emailcampaign.class.php',186],['inc/maintenance/model','_backup.class.php',159],['inc/items/model','_itemstatus.class.php',63],['inc/sessions/model','_domain.class.php',54],['inc/regional/model','_country.class.php',70],['inc/users/model','_user.class.php',341],['inc/skins/model','_skin.class.php',158],['inc/comments/model','_commentlist.class.php',253],['inc/messaging/model','_message.class.php',124],['inc/users/model','_userlist.class.php',260],['inc/messaging/model','_thread.class.php',186],['inc/items/model','_itemtype.class.php',148],['inc/regional/model','_subregion.class.php',78],['inc/files/model','_filetype.class.php',61],['inc/collections/model','_blog.class.php',375],['inc/cron/model','_cronjob.class.php',107],['inc/users/model','_userfield.class.php',172],['inc/regional/model','_city.class.php',68],['inc/slugs/model','_slug.class.php',94],['inc/users/model','_group.class.php',122],['inc/users/model','_invitation.class.php',69],['inc/regional/model','_currency.class.php',62],['inc/widgets/model','_widget.class.php',138],['inc/regional/model','_region.class.php',66],['inc/chapters/model','_chapter.class.php',286],['inc/antispam/model','_iprange.class.php',86],['inc/sessions/model','_goalcat.class.php',59],['inc/items/model','_itemtag.class.php',75],['inc/sessions/model','_goal.class.php',112],['inc/users/model','_userfieldgroup.class.php',64],['inc/users/model','_organization.class.php',67]], 82],
'forget_param': ['forget_param', 'Forget a param so that is will not get included in subsequent {@link regenerate_url()} calls. ', [['inc/_core','_param.funcs.php',1653]], 91],
'utf8_substr': ['utf8_substr', 'utf8_substr( ) ', [['inc/_ext','_portable_utf8.php',505]], 49],
'param': ['param', 'Sets a parameter with values from the request or to provided default, except if param is already set! ', [['inc/_core','_param.funcs.php',35]], 2141],
'load_plugins_table': ['load_plugins_table', 'Load Plugins data from T_plugins (only once), ordered by priority. ', [['inc/plugins/model','_plugins.class.php',1411],['inc/plugins/model','_plugins_admin_no_db.class.php',36]], 8],
't_': ['t_', 'Provide translation in the context of this module: ', [['inc/_core/model','_module.class.php',67],['rsc/js','blog_widgets.js',467],['inc/skins/model','_skin.class.php',1131],['inc/plugins','_plugin.class.php',2799],['inc/locales','_locale.funcs.php',29],['inc/locales','_locale.funcs.php',226]], 12118],
'disp_global_footer': ['disp_global_footer', 'Display body bottom, debug info and close </html> ', [['skins_adm/bootstrap','_adminUI.class.php',185],['skins_adm','_adminUI_general.class.php',582]], 61],
'dbinsert': ['dbinsert', 'Insert object into DB based on previously recorded changes ', [['inc/items/model','_item.class.php',5108],['inc/_core/model/dataobjects','_dataobject.class.php',470],['inc/users/model','_user.class.php',3187],['inc/skins/model','_skin.class.php',438],['inc/items/model','_itemtype.class.php',405],['inc/files/model','_filetype.class.php',213],['inc/tools/model','_syslog.class.php',58],['inc/collections/model','_blog.class.php',2272],['inc/comments/model','_comment.class.php',3815],['inc/users/model','_group.class.php',459],['inc/widgets/model','_widget.class.php',829],['inc/chapters/model','_chapter.class.php',532],['inc/files/model','_file.class.php',1784]], 99],
'param_action': ['param_action', 'Get the action from params. ', [['inc/_core','_param.funcs.php',458]], 63],
'ip2int': ['ip2int', 'Convert IP address to integer (get only 32bits of IPv6 address) ', [['inc/_core','_misc.funcs.php',6327]], 47],
'param_errors_detected': ['param_errors_detected', 'Check if there have been validation errors ', [['inc/_core','_param.funcs.php',1480]], 61],
'set_path': ['set_path', 'Set the full selected path. ', [['skins_adm','_adminUI_general.class.php',1377]], 88],
'disp_html_head': ['disp_html_head', 'Display doctype + <head>...</head> section ', [['skins_adm','_adminUI_general.class.php',493]], 60],
'load_funcs': ['load_funcs', '', [['inc/_core','_misc.funcs.php',158]], 242],
'set_max_execution_time': ['set_max_execution_time', 'Set max execution time ', [['inc/_core','_misc.funcs.php',5931]], 20],
'utf8_strtolower': ['utf8_strtolower', 'utf8_strtolower( ) ', [['inc/_ext','_portable_utf8.php',1433]], 74],
'set_coll_list_params': ['set_coll_list_params', 'Set params for blog list. ', [['skins_adm','_adminUI_general.class.php',715]], 21],
'assert_received_crumb': ['assert_received_crumb', 'Assert that we received a valid crumb for the object we want to act on. ', [['inc/sessions/model','_session.class.php',613]], 286],
'send_javascript_message': ['send_javascript_message', 'Send a result as javascript automatically includes any Messages ( @see Log::display() ) no return from function as it terminates processing ', [['inc/_core','_misc.funcs.php',5343]], 11],
'blog_restrict': ['blog_restrict', 'Restrict to specific blog ', [['inc/comments/model','_commentquery.class.php',501],['inc/antispam/model','_antispam.funcs.php',347]], 1],
'array_chunk': ['array_chunk', '', [], 4],
'htmlspecialchars': ['htmlspecialchars', '', [], 152],
'implode': ['implode', '', [], 571],
'explode': ['explode', '', [], 263],
'is_numeric': ['is_numeric', '', [], 14],
'defined': ['defined', '', [], 962],
'ini_set': ['ini_set', '', [], 37],
'ob_start': ['ob_start', '', [], 45],
'ob_end_clean': ['ob_end_clean', '', [], 13],
'ignore_user_abort': ['ignore_user_abort', '', [], 2],
'count': ['count', '', [], 928],
'ob_get_contents': ['ob_get_contents', '', [], 9]};
CLASS_DATA={
'comment': ['comment', 'Comment Class ', [['inc/comments/model','_comment.class.php',19]], 122],
'iprange': ['iprange', 'Slug Class ', [['inc/antispam/model','_iprange.class.php',21]], 4]};
CONST_DATA={
'EVO_MAIN_INIT': ['EVO_MAIN_INIT', '', [['install','index.php',26],['inc','_main.inc.php',36],['install','debug.php',22]], 912]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Sat Nov 21 22:13:19 2015</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>

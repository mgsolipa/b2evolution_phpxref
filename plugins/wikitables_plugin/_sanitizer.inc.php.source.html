<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7.1 : Unnamed Project : /plugins/wikitables_plugin/_sanitizer.inc.php source</title>
    <link rel="stylesheet" href="../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Unnamed Project</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Sat Nov 21 22:13:19 2015 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../';
subdir='plugins/wikitables_plugin';
filename='_sanitizer.inc.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/plugins/wikitables_plugin/</a> -> <a href="_sanitizer.inc.php.html">_sanitizer.inc.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="_sanitizer.inc.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="_sanitizer.inc.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">/**</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment"> * XHTML sanitizer for %MediaWiki.</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment"> *</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment"> * Copyright Â© 2002-2005 Brion Vibber &lt;brion@pobox.com&gt; et al</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment"> * http://www.mediawiki.org/</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment"> *</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment"> * This program is free software; you can redistribute it and/or modify</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment"> * the Free Software Foundation; either version 2 of the License, or</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment"> * (at your option) any later version.</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment"> *</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
<a name="l16"><span class="linenum">  16</span></a>  <span class="comment"> * GNU General Public License for more details.</span>
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment"> *</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * You should have received a copy of the GNU General Public License along</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> * with this program; if not, write to the Free Software Foundation, Inc.,</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * http://www.gnu.org/copyleft/gpl.html</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> *</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> * @file</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> * @ingroup Parser</span>
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment"> */</span>
<a name="l26"><span class="linenum">  26</span></a>  
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment">/**</span>
<a name="l28"><span class="linenum">  28</span></a>  <span class="comment"> * XHTML sanitizer for MediaWiki</span>
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment"> * @ingroup Parser</span>
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment"> */</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a> {
<a name="l32"><span class="linenum">  32</span></a>      <span class="comment">/**</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment">     * Regular expression to match various types of character references in</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment">     * Sanitizer::normalizeCharReferences and Sanitizer::decodeCharReferences</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment">     */</span>
<a name="l36"><span class="linenum">  36</span></a>      const CHAR_REFS_REGEX =
<a name="l37"><span class="linenum">  37</span></a>          '/&amp;([A-Za-z0-9\x80-\xff]+);
<a name="l38"><span class="linenum">  38</span></a>           |&amp;\#([0-9]+);
<a name="l39"><span class="linenum">  39</span></a>           |&amp;\#[xX]([0-9A-Fa-f]+);
<a name="l40"><span class="linenum">  40</span></a>           |(&amp;)/x';
<a name="l41"><span class="linenum">  41</span></a>  
<a name="l42"><span class="linenum">  42</span></a>      <span class="comment">/**</span>
<a name="l43"><span class="linenum">  43</span></a>  <span class="comment">     * Blacklist for evil uris like javascript:</span>
<a name="l44"><span class="linenum">  44</span></a>  <span class="comment">     * WARNING: DO NOT use this in any place that actually requires blacklisting</span>
<a name="l45"><span class="linenum">  45</span></a>  <span class="comment">     * for security reasons. There are NUMEROUS[1] ways to bypass blacklisting, the</span>
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment">     * only way to be secure from javascript: uri based xss vectors is to whitelist</span>
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment">     * things that you know are safe and deny everything else.</span>
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment">     * [1]: http://ha.ckers.org/xss.html</span>
<a name="l49"><span class="linenum">  49</span></a>  <span class="comment">     */</span>
<a name="l50"><span class="linenum">  50</span></a>      const EVIL_URI_PATTERN = '!(^|\s|\*/\s*)(javascript|vbscript)([^\w]|$)!i';
<a name="l51"><span class="linenum">  51</span></a>      const XMLNS_ATTRIBUTE_PATTERN = '/^xmlns:[:A-Z_a-z-.0-9]+$/';
<a name="l52"><span class="linenum">  52</span></a>  
<a name="l53"><span class="linenum">  53</span></a>      <span class="comment">/**</span>
<a name="l54"><span class="linenum">  54</span></a>  <span class="comment">     * List of all named character entities defined in HTML 4.01</span>
<a name="l55"><span class="linenum">  55</span></a>  <span class="comment">     * http://www.w3.org/TR/html4/sgml/entities.html</span>
<a name="l56"><span class="linenum">  56</span></a>  <span class="comment">     * As well as &amp;apos; which is only defined starting in XHTML1.</span>
<a name="l57"><span class="linenum">  57</span></a>  <span class="comment">     * @private</span>
<a name="l58"><span class="linenum">  58</span></a>  <span class="comment">     */</span>
<a name="l59"><span class="linenum">  59</span></a>      static <a class="var it7387" onMouseOver="hilite(7387)" onMouseOut="lolite()" onClick="logVariable('htmlEntities')" href="../../_variables/htmlEntities.html">$htmlEntities</a> = array(
<a name="l60"><span class="linenum">  60</span></a>          'Aacute'   =&gt; 193,
<a name="l61"><span class="linenum">  61</span></a>          'aacute'   =&gt; 225,
<a name="l62"><span class="linenum">  62</span></a>          'Acirc'    =&gt; 194,
<a name="l63"><span class="linenum">  63</span></a>          'acirc'    =&gt; 226,
<a name="l64"><span class="linenum">  64</span></a>          'acute'    =&gt; 180,
<a name="l65"><span class="linenum">  65</span></a>          'AElig'    =&gt; 198,
<a name="l66"><span class="linenum">  66</span></a>          'aelig'    =&gt; 230,
<a name="l67"><span class="linenum">  67</span></a>          'Agrave'   =&gt; 192,
<a name="l68"><span class="linenum">  68</span></a>          'agrave'   =&gt; 224,
<a name="l69"><span class="linenum">  69</span></a>          'alefsym'  =&gt; 8501,
<a name="l70"><span class="linenum">  70</span></a>          'Alpha'    =&gt; 913,
<a name="l71"><span class="linenum">  71</span></a>          'alpha'    =&gt; 945,
<a name="l72"><span class="linenum">  72</span></a>          'amp'      =&gt; 38,
<a name="l73"><span class="linenum">  73</span></a>          'and'      =&gt; 8743,
<a name="l74"><span class="linenum">  74</span></a>          'ang'      =&gt; 8736,
<a name="l75"><span class="linenum">  75</span></a>          'apos'     =&gt; 39, // New in XHTML &amp; HTML 5; avoid in output for compatibility with IE.
<a name="l76"><span class="linenum">  76</span></a>          'Aring'    =&gt; 197,
<a name="l77"><span class="linenum">  77</span></a>          'aring'    =&gt; 229,
<a name="l78"><span class="linenum">  78</span></a>          'asymp'    =&gt; 8776,
<a name="l79"><span class="linenum">  79</span></a>          'Atilde'   =&gt; 195,
<a name="l80"><span class="linenum">  80</span></a>          'atilde'   =&gt; 227,
<a name="l81"><span class="linenum">  81</span></a>          'Auml'     =&gt; 196,
<a name="l82"><span class="linenum">  82</span></a>          'auml'     =&gt; 228,
<a name="l83"><span class="linenum">  83</span></a>          'bdquo'    =&gt; 8222,
<a name="l84"><span class="linenum">  84</span></a>          'Beta'     =&gt; 914,
<a name="l85"><span class="linenum">  85</span></a>          'beta'     =&gt; 946,
<a name="l86"><span class="linenum">  86</span></a>          'brvbar'   =&gt; 166,
<a name="l87"><span class="linenum">  87</span></a>          'bull'     =&gt; 8226,
<a name="l88"><span class="linenum">  88</span></a>          'cap'      =&gt; 8745,
<a name="l89"><span class="linenum">  89</span></a>          'Ccedil'   =&gt; 199,
<a name="l90"><span class="linenum">  90</span></a>          'ccedil'   =&gt; 231,
<a name="l91"><span class="linenum">  91</span></a>          'cedil'    =&gt; 184,
<a name="l92"><span class="linenum">  92</span></a>          'cent'     =&gt; 162,
<a name="l93"><span class="linenum">  93</span></a>          'Chi'      =&gt; 935,
<a name="l94"><span class="linenum">  94</span></a>          'chi'      =&gt; 967,
<a name="l95"><span class="linenum">  95</span></a>          'circ'     =&gt; 710,
<a name="l96"><span class="linenum">  96</span></a>          'clubs'    =&gt; 9827,
<a name="l97"><span class="linenum">  97</span></a>          'cong'     =&gt; 8773,
<a name="l98"><span class="linenum">  98</span></a>          'copy'     =&gt; 169,
<a name="l99"><span class="linenum">  99</span></a>          'crarr'    =&gt; 8629,
<a name="l100"><span class="linenum"> 100</span></a>          'cup'      =&gt; 8746,
<a name="l101"><span class="linenum"> 101</span></a>          'curren'   =&gt; 164,
<a name="l102"><span class="linenum"> 102</span></a>          'dagger'   =&gt; 8224,
<a name="l103"><span class="linenum"> 103</span></a>          'Dagger'   =&gt; 8225,
<a name="l104"><span class="linenum"> 104</span></a>          'darr'     =&gt; 8595,
<a name="l105"><span class="linenum"> 105</span></a>          'dArr'     =&gt; 8659,
<a name="l106"><span class="linenum"> 106</span></a>          'deg'      =&gt; 176,
<a name="l107"><span class="linenum"> 107</span></a>          'Delta'    =&gt; 916,
<a name="l108"><span class="linenum"> 108</span></a>          'delta'    =&gt; 948,
<a name="l109"><span class="linenum"> 109</span></a>          'diams'    =&gt; 9830,
<a name="l110"><span class="linenum"> 110</span></a>          'divide'   =&gt; 247,
<a name="l111"><span class="linenum"> 111</span></a>          'Eacute'   =&gt; 201,
<a name="l112"><span class="linenum"> 112</span></a>          'eacute'   =&gt; 233,
<a name="l113"><span class="linenum"> 113</span></a>          'Ecirc'    =&gt; 202,
<a name="l114"><span class="linenum"> 114</span></a>          'ecirc'    =&gt; 234,
<a name="l115"><span class="linenum"> 115</span></a>          'Egrave'   =&gt; 200,
<a name="l116"><span class="linenum"> 116</span></a>          'egrave'   =&gt; 232,
<a name="l117"><span class="linenum"> 117</span></a>          'empty'    =&gt; 8709,
<a name="l118"><span class="linenum"> 118</span></a>          'emsp'     =&gt; 8195,
<a name="l119"><span class="linenum"> 119</span></a>          'ensp'     =&gt; 8194,
<a name="l120"><span class="linenum"> 120</span></a>          'Epsilon'  =&gt; 917,
<a name="l121"><span class="linenum"> 121</span></a>          'epsilon'  =&gt; 949,
<a name="l122"><span class="linenum"> 122</span></a>          'equiv'    =&gt; 8801,
<a name="l123"><span class="linenum"> 123</span></a>          'Eta'      =&gt; 919,
<a name="l124"><span class="linenum"> 124</span></a>          'eta'      =&gt; 951,
<a name="l125"><span class="linenum"> 125</span></a>          'ETH'      =&gt; 208,
<a name="l126"><span class="linenum"> 126</span></a>          'eth'      =&gt; 240,
<a name="l127"><span class="linenum"> 127</span></a>          'Euml'     =&gt; 203,
<a name="l128"><span class="linenum"> 128</span></a>          'euml'     =&gt; 235,
<a name="l129"><span class="linenum"> 129</span></a>          'euro'     =&gt; 8364,
<a name="l130"><span class="linenum"> 130</span></a>          'exist'    =&gt; 8707,
<a name="l131"><span class="linenum"> 131</span></a>          'fnof'     =&gt; 402,
<a name="l132"><span class="linenum"> 132</span></a>          'forall'   =&gt; 8704,
<a name="l133"><span class="linenum"> 133</span></a>          'frac12'   =&gt; 189,
<a name="l134"><span class="linenum"> 134</span></a>          'frac14'   =&gt; 188,
<a name="l135"><span class="linenum"> 135</span></a>          'frac34'   =&gt; 190,
<a name="l136"><span class="linenum"> 136</span></a>          'frasl'    =&gt; 8260,
<a name="l137"><span class="linenum"> 137</span></a>          'Gamma'    =&gt; 915,
<a name="l138"><span class="linenum"> 138</span></a>          'gamma'    =&gt; 947,
<a name="l139"><span class="linenum"> 139</span></a>          'ge'       =&gt; 8805,
<a name="l140"><span class="linenum"> 140</span></a>          'gt'       =&gt; 62,
<a name="l141"><span class="linenum"> 141</span></a>          'harr'     =&gt; 8596,
<a name="l142"><span class="linenum"> 142</span></a>          'hArr'     =&gt; 8660,
<a name="l143"><span class="linenum"> 143</span></a>          'hearts'   =&gt; 9829,
<a name="l144"><span class="linenum"> 144</span></a>          'hellip'   =&gt; 8230,
<a name="l145"><span class="linenum"> 145</span></a>          'Iacute'   =&gt; 205,
<a name="l146"><span class="linenum"> 146</span></a>          'iacute'   =&gt; 237,
<a name="l147"><span class="linenum"> 147</span></a>          'Icirc'    =&gt; 206,
<a name="l148"><span class="linenum"> 148</span></a>          'icirc'    =&gt; 238,
<a name="l149"><span class="linenum"> 149</span></a>          'iexcl'    =&gt; 161,
<a name="l150"><span class="linenum"> 150</span></a>          'Igrave'   =&gt; 204,
<a name="l151"><span class="linenum"> 151</span></a>          'igrave'   =&gt; 236,
<a name="l152"><span class="linenum"> 152</span></a>          'image'    =&gt; 8465,
<a name="l153"><span class="linenum"> 153</span></a>          'infin'    =&gt; 8734,
<a name="l154"><span class="linenum"> 154</span></a>          'int'      =&gt; 8747,
<a name="l155"><span class="linenum"> 155</span></a>          'Iota'     =&gt; 921,
<a name="l156"><span class="linenum"> 156</span></a>          'iota'     =&gt; 953,
<a name="l157"><span class="linenum"> 157</span></a>          'iquest'   =&gt; 191,
<a name="l158"><span class="linenum"> 158</span></a>          'isin'     =&gt; 8712,
<a name="l159"><span class="linenum"> 159</span></a>          'Iuml'     =&gt; 207,
<a name="l160"><span class="linenum"> 160</span></a>          'iuml'     =&gt; 239,
<a name="l161"><span class="linenum"> 161</span></a>          'Kappa'    =&gt; 922,
<a name="l162"><span class="linenum"> 162</span></a>          'kappa'    =&gt; 954,
<a name="l163"><span class="linenum"> 163</span></a>          'Lambda'   =&gt; 923,
<a name="l164"><span class="linenum"> 164</span></a>          'lambda'   =&gt; 955,
<a name="l165"><span class="linenum"> 165</span></a>          'lang'     =&gt; 9001,
<a name="l166"><span class="linenum"> 166</span></a>          'laquo'    =&gt; 171,
<a name="l167"><span class="linenum"> 167</span></a>          'larr'     =&gt; 8592,
<a name="l168"><span class="linenum"> 168</span></a>          'lArr'     =&gt; 8656,
<a name="l169"><span class="linenum"> 169</span></a>          'lceil'    =&gt; 8968,
<a name="l170"><span class="linenum"> 170</span></a>          'ldquo'    =&gt; 8220,
<a name="l171"><span class="linenum"> 171</span></a>          'le'       =&gt; 8804,
<a name="l172"><span class="linenum"> 172</span></a>          'lfloor'   =&gt; 8970,
<a name="l173"><span class="linenum"> 173</span></a>          'lowast'   =&gt; 8727,
<a name="l174"><span class="linenum"> 174</span></a>          'loz'      =&gt; 9674,
<a name="l175"><span class="linenum"> 175</span></a>          'lrm'      =&gt; 8206,
<a name="l176"><span class="linenum"> 176</span></a>          'lsaquo'   =&gt; 8249,
<a name="l177"><span class="linenum"> 177</span></a>          'lsquo'    =&gt; 8216,
<a name="l178"><span class="linenum"> 178</span></a>          'lt'       =&gt; 60,
<a name="l179"><span class="linenum"> 179</span></a>          'macr'     =&gt; 175,
<a name="l180"><span class="linenum"> 180</span></a>          'mdash'    =&gt; 8212,
<a name="l181"><span class="linenum"> 181</span></a>          'micro'    =&gt; 181,
<a name="l182"><span class="linenum"> 182</span></a>          'middot'   =&gt; 183,
<a name="l183"><span class="linenum"> 183</span></a>          'minus'    =&gt; 8722,
<a name="l184"><span class="linenum"> 184</span></a>          'Mu'       =&gt; 924,
<a name="l185"><span class="linenum"> 185</span></a>          'mu'       =&gt; 956,
<a name="l186"><span class="linenum"> 186</span></a>          'nabla'    =&gt; 8711,
<a name="l187"><span class="linenum"> 187</span></a>          'nbsp'     =&gt; 160,
<a name="l188"><span class="linenum"> 188</span></a>          'ndash'    =&gt; 8211,
<a name="l189"><span class="linenum"> 189</span></a>          'ne'       =&gt; 8800,
<a name="l190"><span class="linenum"> 190</span></a>          'ni'       =&gt; 8715,
<a name="l191"><span class="linenum"> 191</span></a>          'not'      =&gt; 172,
<a name="l192"><span class="linenum"> 192</span></a>          'notin'    =&gt; 8713,
<a name="l193"><span class="linenum"> 193</span></a>          'nsub'     =&gt; 8836,
<a name="l194"><span class="linenum"> 194</span></a>          'Ntilde'   =&gt; 209,
<a name="l195"><span class="linenum"> 195</span></a>          'ntilde'   =&gt; 241,
<a name="l196"><span class="linenum"> 196</span></a>          'Nu'       =&gt; 925,
<a name="l197"><span class="linenum"> 197</span></a>          'nu'       =&gt; 957,
<a name="l198"><span class="linenum"> 198</span></a>          'Oacute'   =&gt; 211,
<a name="l199"><span class="linenum"> 199</span></a>          'oacute'   =&gt; 243,
<a name="l200"><span class="linenum"> 200</span></a>          'Ocirc'    =&gt; 212,
<a name="l201"><span class="linenum"> 201</span></a>          'ocirc'    =&gt; 244,
<a name="l202"><span class="linenum"> 202</span></a>          'OElig'    =&gt; 338,
<a name="l203"><span class="linenum"> 203</span></a>          'oelig'    =&gt; 339,
<a name="l204"><span class="linenum"> 204</span></a>          'Ograve'   =&gt; 210,
<a name="l205"><span class="linenum"> 205</span></a>          'ograve'   =&gt; 242,
<a name="l206"><span class="linenum"> 206</span></a>          'oline'    =&gt; 8254,
<a name="l207"><span class="linenum"> 207</span></a>          'Omega'    =&gt; 937,
<a name="l208"><span class="linenum"> 208</span></a>          'omega'    =&gt; 969,
<a name="l209"><span class="linenum"> 209</span></a>          'Omicron'  =&gt; 927,
<a name="l210"><span class="linenum"> 210</span></a>          'omicron'  =&gt; 959,
<a name="l211"><span class="linenum"> 211</span></a>          'oplus'    =&gt; 8853,
<a name="l212"><span class="linenum"> 212</span></a>          'or'       =&gt; 8744,
<a name="l213"><span class="linenum"> 213</span></a>          'ordf'     =&gt; 170,
<a name="l214"><span class="linenum"> 214</span></a>          'ordm'     =&gt; 186,
<a name="l215"><span class="linenum"> 215</span></a>          'Oslash'   =&gt; 216,
<a name="l216"><span class="linenum"> 216</span></a>          'oslash'   =&gt; 248,
<a name="l217"><span class="linenum"> 217</span></a>          'Otilde'   =&gt; 213,
<a name="l218"><span class="linenum"> 218</span></a>          'otilde'   =&gt; 245,
<a name="l219"><span class="linenum"> 219</span></a>          'otimes'   =&gt; 8855,
<a name="l220"><span class="linenum"> 220</span></a>          'Ouml'     =&gt; 214,
<a name="l221"><span class="linenum"> 221</span></a>          'ouml'     =&gt; 246,
<a name="l222"><span class="linenum"> 222</span></a>          'para'     =&gt; 182,
<a name="l223"><span class="linenum"> 223</span></a>          'part'     =&gt; 8706,
<a name="l224"><span class="linenum"> 224</span></a>          'permil'   =&gt; 8240,
<a name="l225"><span class="linenum"> 225</span></a>          'perp'     =&gt; 8869,
<a name="l226"><span class="linenum"> 226</span></a>          'Phi'      =&gt; 934,
<a name="l227"><span class="linenum"> 227</span></a>          'phi'      =&gt; 966,
<a name="l228"><span class="linenum"> 228</span></a>          'Pi'       =&gt; 928,
<a name="l229"><span class="linenum"> 229</span></a>          'pi'       =&gt; 960,
<a name="l230"><span class="linenum"> 230</span></a>          'piv'      =&gt; 982,
<a name="l231"><span class="linenum"> 231</span></a>          'plusmn'   =&gt; 177,
<a name="l232"><span class="linenum"> 232</span></a>          'pound'    =&gt; 163,
<a name="l233"><span class="linenum"> 233</span></a>          'prime'    =&gt; 8242,
<a name="l234"><span class="linenum"> 234</span></a>          'Prime'    =&gt; 8243,
<a name="l235"><span class="linenum"> 235</span></a>          'prod'     =&gt; 8719,
<a name="l236"><span class="linenum"> 236</span></a>          'prop'     =&gt; 8733,
<a name="l237"><span class="linenum"> 237</span></a>          'Psi'      =&gt; 936,
<a name="l238"><span class="linenum"> 238</span></a>          'psi'      =&gt; 968,
<a name="l239"><span class="linenum"> 239</span></a>          'quot'     =&gt; 34,
<a name="l240"><span class="linenum"> 240</span></a>          'radic'    =&gt; 8730,
<a name="l241"><span class="linenum"> 241</span></a>          'rang'     =&gt; 9002,
<a name="l242"><span class="linenum"> 242</span></a>          'raquo'    =&gt; 187,
<a name="l243"><span class="linenum"> 243</span></a>          'rarr'     =&gt; 8594,
<a name="l244"><span class="linenum"> 244</span></a>          'rArr'     =&gt; 8658,
<a name="l245"><span class="linenum"> 245</span></a>          'rceil'    =&gt; 8969,
<a name="l246"><span class="linenum"> 246</span></a>          'rdquo'    =&gt; 8221,
<a name="l247"><span class="linenum"> 247</span></a>          'real'     =&gt; 8476,
<a name="l248"><span class="linenum"> 248</span></a>          'reg'      =&gt; 174,
<a name="l249"><span class="linenum"> 249</span></a>          'rfloor'   =&gt; 8971,
<a name="l250"><span class="linenum"> 250</span></a>          'Rho'      =&gt; 929,
<a name="l251"><span class="linenum"> 251</span></a>          'rho'      =&gt; 961,
<a name="l252"><span class="linenum"> 252</span></a>          'rlm'      =&gt; 8207,
<a name="l253"><span class="linenum"> 253</span></a>          'rsaquo'   =&gt; 8250,
<a name="l254"><span class="linenum"> 254</span></a>          'rsquo'    =&gt; 8217,
<a name="l255"><span class="linenum"> 255</span></a>          'sbquo'    =&gt; 8218,
<a name="l256"><span class="linenum"> 256</span></a>          'Scaron'   =&gt; 352,
<a name="l257"><span class="linenum"> 257</span></a>          'scaron'   =&gt; 353,
<a name="l258"><span class="linenum"> 258</span></a>          'sdot'     =&gt; 8901,
<a name="l259"><span class="linenum"> 259</span></a>          'sect'     =&gt; 167,
<a name="l260"><span class="linenum"> 260</span></a>          'shy'      =&gt; 173,
<a name="l261"><span class="linenum"> 261</span></a>          'Sigma'    =&gt; 931,
<a name="l262"><span class="linenum"> 262</span></a>          'sigma'    =&gt; 963,
<a name="l263"><span class="linenum"> 263</span></a>          'sigmaf'   =&gt; 962,
<a name="l264"><span class="linenum"> 264</span></a>          'sim'      =&gt; 8764,
<a name="l265"><span class="linenum"> 265</span></a>          'spades'   =&gt; 9824,
<a name="l266"><span class="linenum"> 266</span></a>          'sub'      =&gt; 8834,
<a name="l267"><span class="linenum"> 267</span></a>          'sube'     =&gt; 8838,
<a name="l268"><span class="linenum"> 268</span></a>          'sum'      =&gt; 8721,
<a name="l269"><span class="linenum"> 269</span></a>          'sup'      =&gt; 8835,
<a name="l270"><span class="linenum"> 270</span></a>          'sup1'     =&gt; 185,
<a name="l271"><span class="linenum"> 271</span></a>          'sup2'     =&gt; 178,
<a name="l272"><span class="linenum"> 272</span></a>          'sup3'     =&gt; 179,
<a name="l273"><span class="linenum"> 273</span></a>          'supe'     =&gt; 8839,
<a name="l274"><span class="linenum"> 274</span></a>          'szlig'    =&gt; 223,
<a name="l275"><span class="linenum"> 275</span></a>          'Tau'      =&gt; 932,
<a name="l276"><span class="linenum"> 276</span></a>          'tau'      =&gt; 964,
<a name="l277"><span class="linenum"> 277</span></a>          'there4'   =&gt; 8756,
<a name="l278"><span class="linenum"> 278</span></a>          'Theta'    =&gt; 920,
<a name="l279"><span class="linenum"> 279</span></a>          'theta'    =&gt; 952,
<a name="l280"><span class="linenum"> 280</span></a>          'thetasym' =&gt; 977,
<a name="l281"><span class="linenum"> 281</span></a>          'thinsp'   =&gt; 8201,
<a name="l282"><span class="linenum"> 282</span></a>          'THORN'    =&gt; 222,
<a name="l283"><span class="linenum"> 283</span></a>          'thorn'    =&gt; 254,
<a name="l284"><span class="linenum"> 284</span></a>          'tilde'    =&gt; 732,
<a name="l285"><span class="linenum"> 285</span></a>          'times'    =&gt; 215,
<a name="l286"><span class="linenum"> 286</span></a>          'trade'    =&gt; 8482,
<a name="l287"><span class="linenum"> 287</span></a>          'Uacute'   =&gt; 218,
<a name="l288"><span class="linenum"> 288</span></a>          'uacute'   =&gt; 250,
<a name="l289"><span class="linenum"> 289</span></a>          'uarr'     =&gt; 8593,
<a name="l290"><span class="linenum"> 290</span></a>          'uArr'     =&gt; 8657,
<a name="l291"><span class="linenum"> 291</span></a>          'Ucirc'    =&gt; 219,
<a name="l292"><span class="linenum"> 292</span></a>          'ucirc'    =&gt; 251,
<a name="l293"><span class="linenum"> 293</span></a>          'Ugrave'   =&gt; 217,
<a name="l294"><span class="linenum"> 294</span></a>          'ugrave'   =&gt; 249,
<a name="l295"><span class="linenum"> 295</span></a>          'uml'      =&gt; 168,
<a name="l296"><span class="linenum"> 296</span></a>          'upsih'    =&gt; 978,
<a name="l297"><span class="linenum"> 297</span></a>          'Upsilon'  =&gt; 933,
<a name="l298"><span class="linenum"> 298</span></a>          'upsilon'  =&gt; 965,
<a name="l299"><span class="linenum"> 299</span></a>          'Uuml'     =&gt; 220,
<a name="l300"><span class="linenum"> 300</span></a>          'uuml'     =&gt; 252,
<a name="l301"><span class="linenum"> 301</span></a>          'weierp'   =&gt; 8472,
<a name="l302"><span class="linenum"> 302</span></a>          'Xi'       =&gt; 926,
<a name="l303"><span class="linenum"> 303</span></a>          'xi'       =&gt; 958,
<a name="l304"><span class="linenum"> 304</span></a>          'Yacute'   =&gt; 221,
<a name="l305"><span class="linenum"> 305</span></a>          'yacute'   =&gt; 253,
<a name="l306"><span class="linenum"> 306</span></a>          'yen'      =&gt; 165,
<a name="l307"><span class="linenum"> 307</span></a>          'Yuml'     =&gt; 376,
<a name="l308"><span class="linenum"> 308</span></a>          'yuml'     =&gt; 255,
<a name="l309"><span class="linenum"> 309</span></a>          'Zeta'     =&gt; 918,
<a name="l310"><span class="linenum"> 310</span></a>          'zeta'     =&gt; 950,
<a name="l311"><span class="linenum"> 311</span></a>          'zwj'      =&gt; 8205,
<a name="l312"><span class="linenum"> 312</span></a>          'zwnj'     =&gt; 8204
<a name="l313"><span class="linenum"> 313</span></a>      );
<a name="l314"><span class="linenum"> 314</span></a>  
<a name="l315"><span class="linenum"> 315</span></a>      <span class="comment">/**</span>
<a name="l316"><span class="linenum"> 316</span></a>  <span class="comment">     * Character entity aliases accepted by MediaWiki</span>
<a name="l317"><span class="linenum"> 317</span></a>  <span class="comment">     */</span>
<a name="l318"><span class="linenum"> 318</span></a>      static <a class="var it7388" onMouseOver="hilite(7388)" onMouseOut="lolite()" onClick="logVariable('htmlEntityAliases')" href="../../_variables/htmlEntityAliases.html">$htmlEntityAliases</a> = array(
<a name="l319"><span class="linenum"> 319</span></a>          '×¨××' =&gt; 'rlm',
<a name="l320"><span class="linenum"> 320</span></a>          'Ø±ÙÙ' =&gt; 'rlm',
<a name="l321"><span class="linenum"> 321</span></a>      );
<a name="l322"><span class="linenum"> 322</span></a>  
<a name="l323"><span class="linenum"> 323</span></a>      <span class="comment">/**</span>
<a name="l324"><span class="linenum"> 324</span></a>  <span class="comment">     * Lazy-initialised attributes regex, see getAttribsRegex()</span>
<a name="l325"><span class="linenum"> 325</span></a>  <span class="comment">     */</span>
<a name="l326"><span class="linenum"> 326</span></a>      static <a class="var it7389" onMouseOver="hilite(7389)" onMouseOut="lolite()" onClick="logVariable('attribsRegex')" href="../../_variables/attribsRegex.html">$attribsRegex</a>;
<a name="l327"><span class="linenum"> 327</span></a>  
<a name="l328"><span class="linenum"> 328</span></a>      <span class="comment">/**</span>
<a name="l329"><span class="linenum"> 329</span></a>  <span class="comment">     * Regular expression to match HTML/XML attribute pairs within a tag.</span>
<a name="l330"><span class="linenum"> 330</span></a>  <span class="comment">     * Allows some... latitude.</span>
<a name="l331"><span class="linenum"> 331</span></a>  <span class="comment">     * Used in Sanitizer::fixTagAttributes and Sanitizer::decodeTagAttributes</span>
<a name="l332"><span class="linenum"> 332</span></a>  <span class="comment">     */</span>
<a name="l333"><span class="linenum"> 333</span></a>  	static function <a class="function" onClick="logFunction('getAttribsRegex')" href="../../_functions/getattribsregex.html" onMouseOver="funcPopup(event,'getattribsregex')">getAttribsRegex</a>() {
<a name="l334"><span class="linenum"> 334</span></a>          if ( self::<a class="var it7389" onMouseOver="hilite(7389)" onMouseOut="lolite()" onClick="logVariable('attribsRegex')" href="../../_variables/attribsRegex.html">$attribsRegex</a> === null ) {
<a name="l335"><span class="linenum"> 335</span></a>              <a class="var it7390" onMouseOver="hilite(7390)" onMouseOut="lolite()" onClick="logVariable('attribFirst')" href="../../_variables/attribFirst.html">$attribFirst</a> = '[:A-Z_a-z0-9]';
<a name="l336"><span class="linenum"> 336</span></a>              <a class="var it7391" onMouseOver="hilite(7391)" onMouseOut="lolite()" onClick="logVariable('attrib')" href="../../_variables/attrib.html">$attrib</a> = '[:A-Z_a-z-.0-9]';
<a name="l337"><span class="linenum"> 337</span></a>              <a class="var it4798" onMouseOver="hilite(4798)" onMouseOut="lolite()" onClick="logVariable('space')" href="../../_variables/space.html">$space</a> = '[\x09\x0a\x0d\x20]';
<a name="l338"><span class="linenum"> 338</span></a>              self::<a class="var it7389" onMouseOver="hilite(7389)" onMouseOut="lolite()" onClick="logVariable('attribsRegex')" href="../../_variables/attribsRegex.html">$attribsRegex</a> =
<a name="l339"><span class="linenum"> 339</span></a>                  &quot;/(?:^|<a class="var it4798" onMouseOver="hilite(4798)" onMouseOut="lolite()" onClick="logVariable('space')" href="../../_variables/space.html">$space</a>)({<a class="var it7390" onMouseOver="hilite(7390)" onMouseOut="lolite()" onClick="logVariable('attribFirst')" href="../../_variables/attribFirst.html">$attribFirst</a>}{<a class="var it7391" onMouseOver="hilite(7391)" onMouseOut="lolite()" onClick="logVariable('attrib')" href="../../_variables/attrib.html">$attrib</a>}*)
<a name="l340"><span class="linenum"> 340</span></a>                    (<a class="var it4798" onMouseOver="hilite(4798)" onMouseOut="lolite()" onClick="logVariable('space')" href="../../_variables/space.html">$space</a>*=<a class="var it4798" onMouseOver="hilite(4798)" onMouseOut="lolite()" onClick="logVariable('space')" href="../../_variables/space.html">$space</a>*
<a name="l341"><span class="linenum"> 341</span></a>                      (?:
<a name="l342"><span class="linenum"> 342</span></a>  <span class="comment">                     # The attribute value: quoted or alone</span>
<a name="l343"><span class="linenum"> 343</span></a>                        \&quot;([^&lt;\&quot;]*)\&quot;
<a name="l344"><span class="linenum"> 344</span></a>                       | '([^&lt;']*)'
<a name="l345"><span class="linenum"> 345</span></a>                       |  ([a-zA-Z0-9!#$%&amp;()*,\\-.\\/:;&lt;&gt;?@[\\]^_`{|}~]+)
<a name="l346"><span class="linenum"> 346</span></a>                       |  (\#[0-9a-fA-F]+) # Technically wrong, but lots of
<a name="l347"><span class="linenum"> 347</span></a>  <span class="comment">                                         # colors are specified like this.</span>
<a name="l348"><span class="linenum"> 348</span></a>  <span class="comment">                                         # We'll be normalizing it.</span>
<a name="l349"><span class="linenum"> 349</span></a>                      )
<a name="l350"><span class="linenum"> 350</span></a>                  )?(?=<a class="var it4798" onMouseOver="hilite(4798)" onMouseOut="lolite()" onClick="logVariable('space')" href="../../_variables/space.html">$space</a>|\$)/sx&quot;;
<a name="l351"><span class="linenum"> 351</span></a>          }
<a name="l352"><span class="linenum"> 352</span></a>          return self::<a class="var it7389" onMouseOver="hilite(7389)" onMouseOut="lolite()" onClick="logVariable('attribsRegex')" href="../../_variables/attribsRegex.html">$attribsRegex</a>;
<a name="l353"><span class="linenum"> 353</span></a>      }
<a name="l354"><span class="linenum"> 354</span></a>  
<a name="l355"><span class="linenum"> 355</span></a>      <span class="comment">/**</span>
<a name="l356"><span class="linenum"> 356</span></a>  <span class="comment">     * Cleans up HTML, removes dangerous tags and attributes, and</span>
<a name="l357"><span class="linenum"> 357</span></a>  <span class="comment">     * removes HTML comments</span>
<a name="l358"><span class="linenum"> 358</span></a>  <span class="comment">     * @private</span>
<a name="l359"><span class="linenum"> 359</span></a>  <span class="comment">     * @param $text String</span>
<a name="l360"><span class="linenum"> 360</span></a>  <span class="comment">     * @param $processCallback Callback to do any variable or parameter replacements in HTML attribute values</span>
<a name="l361"><span class="linenum"> 361</span></a>  <span class="comment">     * @param array $args for the processing callback</span>
<a name="l362"><span class="linenum"> 362</span></a>  <span class="comment">     * @param array $extratags for any extra tags to include</span>
<a name="l363"><span class="linenum"> 363</span></a>  <span class="comment">     * @param array $removetags for any tags (default or extra) to exclude</span>
<a name="l364"><span class="linenum"> 364</span></a>  <span class="comment">     * @return string</span>
<a name="l365"><span class="linenum"> 365</span></a>  <span class="comment">     */</span>
<a name="l366"><span class="linenum"> 366</span></a>  	static function <a class="function" onClick="logFunction('removeHTMLtags')" href="../../_functions/removehtmltags.html" onMouseOver="funcPopup(event,'removehtmltags')">removeHTMLtags</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, <a class="var it7392" onMouseOver="hilite(7392)" onMouseOut="lolite()" onClick="logVariable('processCallback')" href="../../_variables/processCallback.html">$processCallback</a> = null, <a class="var it1569" onMouseOver="hilite(1569)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../_variables/args.html">$args</a> = array(), <a class="var it7393" onMouseOver="hilite(7393)" onMouseOut="lolite()" onClick="logVariable('extratags')" href="../../_variables/extratags.html">$extratags</a> = array(), <a class="var it7394" onMouseOver="hilite(7394)" onMouseOut="lolite()" onClick="logVariable('removetags')" href="../../_variables/removetags.html">$removetags</a> = array() ) {
<a name="l367"><span class="linenum"> 367</span></a>          global <a class="var it7395" onMouseOver="hilite(7395)" onMouseOut="lolite()" onClick="logVariable('wgUseTidy')" href="../../_variables/wgUseTidy.html">$wgUseTidy</a>, <a class="var it7396" onMouseOver="hilite(7396)" onMouseOut="lolite()" onClick="logVariable('wgHtml5')" href="../../_variables/wgHtml5.html">$wgHtml5</a>, <a class="var it7397" onMouseOver="hilite(7397)" onMouseOut="lolite()" onClick="logVariable('wgAllowMicrodataAttributes')" href="../../_variables/wgAllowMicrodataAttributes.html">$wgAllowMicrodataAttributes</a>, <a class="var it7398" onMouseOver="hilite(7398)" onMouseOut="lolite()" onClick="logVariable('wgAllowImageTag')" href="../../_variables/wgAllowImageTag.html">$wgAllowImageTag</a>;
<a name="l368"><span class="linenum"> 368</span></a>  
<a name="l369"><span class="linenum"> 369</span></a>          static <a class="var it7399" onMouseOver="hilite(7399)" onMouseOut="lolite()" onClick="logVariable('htmlpairsStatic')" href="../../_variables/htmlpairsStatic.html">$htmlpairsStatic</a>, <a class="var it7400" onMouseOver="hilite(7400)" onMouseOut="lolite()" onClick="logVariable('htmlsingle')" href="../../_variables/htmlsingle.html">$htmlsingle</a>, <a class="var it7401" onMouseOver="hilite(7401)" onMouseOut="lolite()" onClick="logVariable('htmlsingleonly')" href="../../_variables/htmlsingleonly.html">$htmlsingleonly</a>, <a class="var it7402" onMouseOver="hilite(7402)" onMouseOut="lolite()" onClick="logVariable('htmlnest')" href="../../_variables/htmlnest.html">$htmlnest</a>, <a class="var it7403" onMouseOver="hilite(7403)" onMouseOut="lolite()" onClick="logVariable('tabletags')" href="../../_variables/tabletags.html">$tabletags</a>,
<a name="l370"><span class="linenum"> 370</span></a>              <a class="var it7404" onMouseOver="hilite(7404)" onMouseOut="lolite()" onClick="logVariable('htmllist')" href="../../_variables/htmllist.html">$htmllist</a>, <a class="var it7405" onMouseOver="hilite(7405)" onMouseOut="lolite()" onClick="logVariable('listtags')" href="../../_variables/listtags.html">$listtags</a>, <a class="var it7406" onMouseOver="hilite(7406)" onMouseOut="lolite()" onClick="logVariable('htmlsingleallowed')" href="../../_variables/htmlsingleallowed.html">$htmlsingleallowed</a>, <a class="var it7407" onMouseOver="hilite(7407)" onMouseOut="lolite()" onClick="logVariable('htmlelementsStatic')" href="../../_variables/htmlelementsStatic.html">$htmlelementsStatic</a>, <a class="var it7408" onMouseOver="hilite(7408)" onMouseOut="lolite()" onClick="logVariable('staticInitialised')" href="../../_variables/staticInitialised.html">$staticInitialised</a>;
<a name="l371"><span class="linenum"> 371</span></a>  
<a name="l372"><span class="linenum"> 372</span></a>          wfProfileIn( __METHOD__ );
<a name="l373"><span class="linenum"> 373</span></a>  
<a name="l374"><span class="linenum"> 374</span></a>  <span class="comment">        // Base our staticInitialised variable off of the global config state so that if the globals</span>
<a name="l375"><span class="linenum"> 375</span></a>  <span class="comment">        // are changed (like in the screwed up test system) we will re-initialise the settings.</span>
<a name="l376"><span class="linenum"> 376</span></a>          <a class="var it7409" onMouseOver="hilite(7409)" onMouseOut="lolite()" onClick="logVariable('globalContext')" href="../../_variables/globalContext.html">$globalContext</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( '-', <a class="phpfunction" onClick="logFunction('compact')" href="../../_functions/compact.html" onMouseOver="phpfuncPopup(event,'compact')">compact</a>( 'wgHtml5', 'wgAllowMicrodataAttributes', 'wgAllowImageTag' ) );
<a name="l377"><span class="linenum"> 377</span></a>          if ( !<a class="var it7408" onMouseOver="hilite(7408)" onMouseOut="lolite()" onClick="logVariable('staticInitialised')" href="../../_variables/staticInitialised.html">$staticInitialised</a> || <a class="var it7408" onMouseOver="hilite(7408)" onMouseOut="lolite()" onClick="logVariable('staticInitialised')" href="../../_variables/staticInitialised.html">$staticInitialised</a> != <a class="var it7409" onMouseOver="hilite(7409)" onMouseOut="lolite()" onClick="logVariable('globalContext')" href="../../_variables/globalContext.html">$globalContext</a> ) {
<a name="l378"><span class="linenum"> 378</span></a>  
<a name="l379"><span class="linenum"> 379</span></a>              <a class="var it7399" onMouseOver="hilite(7399)" onMouseOut="lolite()" onClick="logVariable('htmlpairsStatic')" href="../../_variables/htmlpairsStatic.html">$htmlpairsStatic</a> = array( # Tags that must be closed
<a name="l380"><span class="linenum"> 380</span></a>                  'b', 'bdi', 'del', 'i', 'ins', 'u', 'font', 'big', 'small', 'sub', 'sup', 'h1',
<a name="l381"><span class="linenum"> 381</span></a>                  'h2', 'h3', 'h4', 'h5', 'h6', 'cite', 'code', 'em', 's',
<a name="l382"><span class="linenum"> 382</span></a>                  'strike', 'strong', 'tt', 'var', 'div', 'center',
<a name="l383"><span class="linenum"> 383</span></a>                  'blockquote', 'ol', 'ul', 'dl', 'table', 'caption', 'pre',
<a name="l384"><span class="linenum"> 384</span></a>                  'ruby', 'rt', 'rb', 'rp', 'p', 'span', 'abbr', 'dfn',
<a name="l385"><span class="linenum"> 385</span></a>                  'kbd', 'samp'
<a name="l386"><span class="linenum"> 386</span></a>              );
<a name="l387"><span class="linenum"> 387</span></a>              if ( <a class="var it7396" onMouseOver="hilite(7396)" onMouseOut="lolite()" onClick="logVariable('wgHtml5')" href="../../_variables/wgHtml5.html">$wgHtml5</a> ) {
<a name="l388"><span class="linenum"> 388</span></a>                  <a class="var it7399" onMouseOver="hilite(7399)" onMouseOut="lolite()" onClick="logVariable('htmlpairsStatic')" href="../../_variables/htmlpairsStatic.html">$htmlpairsStatic</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7399" onMouseOver="hilite(7399)" onMouseOut="lolite()" onClick="logVariable('htmlpairsStatic')" href="../../_variables/htmlpairsStatic.html">$htmlpairsStatic</a>, array( 'data', 'time', 'mark' ) );
<a name="l389"><span class="linenum"> 389</span></a>              }
<a name="l390"><span class="linenum"> 390</span></a>              <a class="var it7400" onMouseOver="hilite(7400)" onMouseOut="lolite()" onClick="logVariable('htmlsingle')" href="../../_variables/htmlsingle.html">$htmlsingle</a> = array(
<a name="l391"><span class="linenum"> 391</span></a>                  'br', 'hr', 'li', 'dt', 'dd'
<a name="l392"><span class="linenum"> 392</span></a>              );
<a name="l393"><span class="linenum"> 393</span></a>              <a class="var it7401" onMouseOver="hilite(7401)" onMouseOut="lolite()" onClick="logVariable('htmlsingleonly')" href="../../_variables/htmlsingleonly.html">$htmlsingleonly</a> = array( # Elements that cannot have close tags
<a name="l394"><span class="linenum"> 394</span></a>                  'br', 'hr'
<a name="l395"><span class="linenum"> 395</span></a>              );
<a name="l396"><span class="linenum"> 396</span></a>              if ( <a class="var it7396" onMouseOver="hilite(7396)" onMouseOut="lolite()" onClick="logVariable('wgHtml5')" href="../../_variables/wgHtml5.html">$wgHtml5</a> &amp;&amp; <a class="var it7397" onMouseOver="hilite(7397)" onMouseOut="lolite()" onClick="logVariable('wgAllowMicrodataAttributes')" href="../../_variables/wgAllowMicrodataAttributes.html">$wgAllowMicrodataAttributes</a> ) {
<a name="l397"><span class="linenum"> 397</span></a>                  <a class="var it7400" onMouseOver="hilite(7400)" onMouseOut="lolite()" onClick="logVariable('htmlsingle')" href="../../_variables/htmlsingle.html">$htmlsingle</a>[] = <a class="var it7401" onMouseOver="hilite(7401)" onMouseOut="lolite()" onClick="logVariable('htmlsingleonly')" href="../../_variables/htmlsingleonly.html">$htmlsingleonly</a>[] = 'meta';
<a name="l398"><span class="linenum"> 398</span></a>                  <a class="var it7400" onMouseOver="hilite(7400)" onMouseOut="lolite()" onClick="logVariable('htmlsingle')" href="../../_variables/htmlsingle.html">$htmlsingle</a>[] = <a class="var it7401" onMouseOver="hilite(7401)" onMouseOut="lolite()" onClick="logVariable('htmlsingleonly')" href="../../_variables/htmlsingleonly.html">$htmlsingleonly</a>[] = 'link';
<a name="l399"><span class="linenum"> 399</span></a>              }
<a name="l400"><span class="linenum"> 400</span></a>              <a class="var it7402" onMouseOver="hilite(7402)" onMouseOut="lolite()" onClick="logVariable('htmlnest')" href="../../_variables/htmlnest.html">$htmlnest</a> = array( # Tags that can be nested--??
<a name="l401"><span class="linenum"> 401</span></a>                  'table', 'tr', 'td', 'th', 'div', 'blockquote', 'ol', 'ul',
<a name="l402"><span class="linenum"> 402</span></a>                  'li', 'dl', 'dt', 'dd', 'font', 'big', 'small', 'sub', 'sup', 'span'
<a name="l403"><span class="linenum"> 403</span></a>              );
<a name="l404"><span class="linenum"> 404</span></a>              <a class="var it7403" onMouseOver="hilite(7403)" onMouseOut="lolite()" onClick="logVariable('tabletags')" href="../../_variables/tabletags.html">$tabletags</a> = array( # Can only appear inside table, we will close them
<a name="l405"><span class="linenum"> 405</span></a>                  'td', 'th', 'tr',
<a name="l406"><span class="linenum"> 406</span></a>              );
<a name="l407"><span class="linenum"> 407</span></a>              <a class="var it7404" onMouseOver="hilite(7404)" onMouseOut="lolite()" onClick="logVariable('htmllist')" href="../../_variables/htmllist.html">$htmllist</a> = array( # Tags used by list
<a name="l408"><span class="linenum"> 408</span></a>                  'ul','ol',
<a name="l409"><span class="linenum"> 409</span></a>              );
<a name="l410"><span class="linenum"> 410</span></a>              <a class="var it7405" onMouseOver="hilite(7405)" onMouseOut="lolite()" onClick="logVariable('listtags')" href="../../_variables/listtags.html">$listtags</a> = array( # Tags that can appear in a list
<a name="l411"><span class="linenum"> 411</span></a>                  'li',
<a name="l412"><span class="linenum"> 412</span></a>              );
<a name="l413"><span class="linenum"> 413</span></a>  
<a name="l414"><span class="linenum"> 414</span></a>              if ( <a class="var it7398" onMouseOver="hilite(7398)" onMouseOut="lolite()" onClick="logVariable('wgAllowImageTag')" href="../../_variables/wgAllowImageTag.html">$wgAllowImageTag</a> ) {
<a name="l415"><span class="linenum"> 415</span></a>                  <a class="var it7400" onMouseOver="hilite(7400)" onMouseOut="lolite()" onClick="logVariable('htmlsingle')" href="../../_variables/htmlsingle.html">$htmlsingle</a>[] = 'img';
<a name="l416"><span class="linenum"> 416</span></a>                  <a class="var it7401" onMouseOver="hilite(7401)" onMouseOut="lolite()" onClick="logVariable('htmlsingleonly')" href="../../_variables/htmlsingleonly.html">$htmlsingleonly</a>[] = 'img';
<a name="l417"><span class="linenum"> 417</span></a>              }
<a name="l418"><span class="linenum"> 418</span></a>  
<a name="l419"><span class="linenum"> 419</span></a>              <a class="var it7406" onMouseOver="hilite(7406)" onMouseOut="lolite()" onClick="logVariable('htmlsingleallowed')" href="../../_variables/htmlsingleallowed.html">$htmlsingleallowed</a> = <a class="phpfunction" onClick="logFunction('array_unique')" href="../../_functions/array_unique.html" onMouseOver="phpfuncPopup(event,'array_unique')">array_unique</a>( <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7400" onMouseOver="hilite(7400)" onMouseOut="lolite()" onClick="logVariable('htmlsingle')" href="../../_variables/htmlsingle.html">$htmlsingle</a>, <a class="var it7403" onMouseOver="hilite(7403)" onMouseOut="lolite()" onClick="logVariable('tabletags')" href="../../_variables/tabletags.html">$tabletags</a> ) );
<a name="l420"><span class="linenum"> 420</span></a>              <a class="var it7407" onMouseOver="hilite(7407)" onMouseOut="lolite()" onClick="logVariable('htmlelementsStatic')" href="../../_variables/htmlelementsStatic.html">$htmlelementsStatic</a> = <a class="phpfunction" onClick="logFunction('array_unique')" href="../../_functions/array_unique.html" onMouseOver="phpfuncPopup(event,'array_unique')">array_unique</a>( <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7400" onMouseOver="hilite(7400)" onMouseOut="lolite()" onClick="logVariable('htmlsingle')" href="../../_variables/htmlsingle.html">$htmlsingle</a>, <a class="var it7399" onMouseOver="hilite(7399)" onMouseOut="lolite()" onClick="logVariable('htmlpairsStatic')" href="../../_variables/htmlpairsStatic.html">$htmlpairsStatic</a>, <a class="var it7402" onMouseOver="hilite(7402)" onMouseOut="lolite()" onClick="logVariable('htmlnest')" href="../../_variables/htmlnest.html">$htmlnest</a> ) );
<a name="l421"><span class="linenum"> 421</span></a>  
<a name="l422"><span class="linenum"> 422</span></a>  <span class="comment">            # Convert them all to hashtables for faster lookup</span>
<a name="l423"><span class="linenum"> 423</span></a>              <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('vars')" href="../../_variables/vars.html">$vars</a> = array( 'htmlpairsStatic', 'htmlsingle', 'htmlsingleonly', 'htmlnest', 'tabletags',
<a name="l424"><span class="linenum"> 424</span></a>                  'htmllist', 'listtags', 'htmlsingleallowed', 'htmlelementsStatic' );
<a name="l425"><span class="linenum"> 425</span></a>              foreach ( <a class="var it992" onMouseOver="hilite(992)" onMouseOut="lolite()" onClick="logVariable('vars')" href="../../_variables/vars.html">$vars</a> as <a class="var it920" onMouseOver="hilite(920)" onMouseOut="lolite()" onClick="logVariable('var')" href="../../_variables/var.html">$var</a> ) {
<a name="l426"><span class="linenum"> 426</span></a>                  $<a class="var it920" onMouseOver="hilite(920)" onMouseOut="lolite()" onClick="logVariable('var')" href="../../_variables/var.html">$var</a> = <a class="phpfunction" onClick="logFunction('array_flip')" href="../../_functions/array_flip.html" onMouseOver="phpfuncPopup(event,'array_flip')">array_flip</a>( $<a class="var it920" onMouseOver="hilite(920)" onMouseOut="lolite()" onClick="logVariable('var')" href="../../_variables/var.html">$var</a> );
<a name="l427"><span class="linenum"> 427</span></a>              }
<a name="l428"><span class="linenum"> 428</span></a>              <a class="var it7408" onMouseOver="hilite(7408)" onMouseOut="lolite()" onClick="logVariable('staticInitialised')" href="../../_variables/staticInitialised.html">$staticInitialised</a> = <a class="var it7409" onMouseOver="hilite(7409)" onMouseOut="lolite()" onClick="logVariable('globalContext')" href="../../_variables/globalContext.html">$globalContext</a>;
<a name="l429"><span class="linenum"> 429</span></a>          }
<a name="l430"><span class="linenum"> 430</span></a>  <span class="comment">        # Populate $htmlpairs and $htmlelements with the $extratags and $removetags arrays</span>
<a name="l431"><span class="linenum"> 431</span></a>          <a class="var it7393" onMouseOver="hilite(7393)" onMouseOut="lolite()" onClick="logVariable('extratags')" href="../../_variables/extratags.html">$extratags</a> = <a class="phpfunction" onClick="logFunction('array_flip')" href="../../_functions/array_flip.html" onMouseOver="phpfuncPopup(event,'array_flip')">array_flip</a>( <a class="var it7393" onMouseOver="hilite(7393)" onMouseOut="lolite()" onClick="logVariable('extratags')" href="../../_variables/extratags.html">$extratags</a> );
<a name="l432"><span class="linenum"> 432</span></a>          <a class="var it7394" onMouseOver="hilite(7394)" onMouseOut="lolite()" onClick="logVariable('removetags')" href="../../_variables/removetags.html">$removetags</a> = <a class="phpfunction" onClick="logFunction('array_flip')" href="../../_functions/array_flip.html" onMouseOver="phpfuncPopup(event,'array_flip')">array_flip</a>( <a class="var it7394" onMouseOver="hilite(7394)" onMouseOut="lolite()" onClick="logVariable('removetags')" href="../../_variables/removetags.html">$removetags</a> );
<a name="l433"><span class="linenum"> 433</span></a>          <a class="var it7410" onMouseOver="hilite(7410)" onMouseOut="lolite()" onClick="logVariable('htmlpairs')" href="../../_variables/htmlpairs.html">$htmlpairs</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7393" onMouseOver="hilite(7393)" onMouseOut="lolite()" onClick="logVariable('extratags')" href="../../_variables/extratags.html">$extratags</a>, <a class="var it7399" onMouseOver="hilite(7399)" onMouseOut="lolite()" onClick="logVariable('htmlpairsStatic')" href="../../_variables/htmlpairsStatic.html">$htmlpairsStatic</a> );
<a name="l434"><span class="linenum"> 434</span></a>          <a class="var it7411" onMouseOver="hilite(7411)" onMouseOut="lolite()" onClick="logVariable('htmlelements')" href="../../_variables/htmlelements.html">$htmlelements</a> = array_diff_key( <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7393" onMouseOver="hilite(7393)" onMouseOut="lolite()" onClick="logVariable('extratags')" href="../../_variables/extratags.html">$extratags</a>, <a class="var it7407" onMouseOver="hilite(7407)" onMouseOut="lolite()" onClick="logVariable('htmlelementsStatic')" href="../../_variables/htmlelementsStatic.html">$htmlelementsStatic</a> ), <a class="var it7394" onMouseOver="hilite(7394)" onMouseOut="lolite()" onClick="logVariable('removetags')" href="../../_variables/removetags.html">$removetags</a> );
<a name="l435"><span class="linenum"> 435</span></a>  
<a name="l436"><span class="linenum"> 436</span></a>  <span class="comment">        # Remove HTML comments</span>
<a name="l437"><span class="linenum"> 437</span></a>          <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('removeHTMLcomments')" href="../../_functions/removehtmlcomments.html" onMouseOver="funcPopup(event,'removehtmlcomments')">removeHTMLcomments</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> );
<a name="l438"><span class="linenum"> 438</span></a>          <a class="var it3147" onMouseOver="hilite(3147)" onMouseOut="lolite()" onClick="logVariable('bits')" href="../../_variables/bits.html">$bits</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>( '&lt;', <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> );
<a name="l439"><span class="linenum"> 439</span></a>          <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>( '&gt;', '&amp;gt;', <a class="phpfunction" onClick="logFunction('array_shift')" href="../../_functions/array_shift.html" onMouseOver="phpfuncPopup(event,'array_shift')">array_shift</a>( <a class="var it3147" onMouseOver="hilite(3147)" onMouseOut="lolite()" onClick="logVariable('bits')" href="../../_variables/bits.html">$bits</a> ) );
<a name="l440"><span class="linenum"> 440</span></a>          if ( !<a class="var it7395" onMouseOver="hilite(7395)" onMouseOut="lolite()" onClick="logVariable('wgUseTidy')" href="../../_variables/wgUseTidy.html">$wgUseTidy</a> ) {
<a name="l441"><span class="linenum"> 441</span></a>              <a class="var it1057" onMouseOver="hilite(1057)" onMouseOut="lolite()" onClick="logVariable('tagstack')" href="../../_variables/tagstack.html">$tagstack</a> = <a class="var it7412" onMouseOver="hilite(7412)" onMouseOut="lolite()" onClick="logVariable('tablestack')" href="../../_variables/tablestack.html">$tablestack</a> = array();
<a name="l442"><span class="linenum"> 442</span></a>              foreach ( <a class="var it3147" onMouseOver="hilite(3147)" onMouseOut="lolite()" onClick="logVariable('bits')" href="../../_variables/bits.html">$bits</a> as <a class="var it669" onMouseOver="hilite(669)" onMouseOut="lolite()" onClick="logVariable('x')" href="../../_variables/x.html">$x</a> ) {
<a name="l443"><span class="linenum"> 443</span></a>                  <a class="var it6618" onMouseOver="hilite(6618)" onMouseOut="lolite()" onClick="logVariable('regs')" href="../../_variables/regs.html">$regs</a> = array();
<a name="l444"><span class="linenum"> 444</span></a>  <span class="comment">                # $slash: Does the current element start with a '/'?</span>
<a name="l445"><span class="linenum"> 445</span></a>  <span class="comment">                # $t: Current element name</span>
<a name="l446"><span class="linenum"> 446</span></a>  <span class="comment">                # $params: String between element name and &gt;</span>
<a name="l447"><span class="linenum"> 447</span></a>  <span class="comment">                # $brace: Ending '&gt;' or '/&gt;'</span>
<a name="l448"><span class="linenum"> 448</span></a>  <span class="comment">                # $rest: Everything until the next element of $bits</span>
<a name="l449"><span class="linenum"> 449</span></a>                  if( <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>( '!^(/?)(\\w+)([^&gt;]*?)(/{0,1}&gt;)([^&lt;]*)$!', <a class="var it669" onMouseOver="hilite(669)" onMouseOut="lolite()" onClick="logVariable('x')" href="../../_variables/x.html">$x</a>, <a class="var it6618" onMouseOver="hilite(6618)" onMouseOut="lolite()" onClick="logVariable('regs')" href="../../_variables/regs.html">$regs</a> ) ) {
<a name="l450"><span class="linenum"> 450</span></a>                      <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>( <span class="comment">/* $qbar */</span>, <a class="var it7413" onMouseOver="hilite(7413)" onMouseOut="lolite()" onClick="logVariable('slash')" href="../../_variables/slash.html">$slash</a>, <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a>, <a class="var it106" onMouseOver="hilite(106)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it7414" onMouseOver="hilite(7414)" onMouseOut="lolite()" onClick="logVariable('brace')" href="../../_variables/brace.html">$brace</a>, <a class="var it7415" onMouseOver="hilite(7415)" onMouseOut="lolite()" onClick="logVariable('rest')" href="../../_variables/rest.html">$rest</a> ) = <a class="var it6618" onMouseOver="hilite(6618)" onMouseOut="lolite()" onClick="logVariable('regs')" href="../../_variables/regs.html">$regs</a>;
<a name="l451"><span class="linenum"> 451</span></a>                  } else {
<a name="l452"><span class="linenum"> 452</span></a>                      <a class="var it7413" onMouseOver="hilite(7413)" onMouseOut="lolite()" onClick="logVariable('slash')" href="../../_variables/slash.html">$slash</a> = <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a> = <a class="var it106" onMouseOver="hilite(106)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = <a class="var it7414" onMouseOver="hilite(7414)" onMouseOut="lolite()" onClick="logVariable('brace')" href="../../_variables/brace.html">$brace</a> = <a class="var it7415" onMouseOver="hilite(7415)" onMouseOut="lolite()" onClick="logVariable('rest')" href="../../_variables/rest.html">$rest</a> = null;
<a name="l453"><span class="linenum"> 453</span></a>                  }
<a name="l454"><span class="linenum"> 454</span></a>  
<a name="l455"><span class="linenum"> 455</span></a>                  <a class="var it7416" onMouseOver="hilite(7416)" onMouseOut="lolite()" onClick="logVariable('badtag')" href="../../_variables/badtag.html">$badtag</a> = false;
<a name="l456"><span class="linenum"> 456</span></a>                  if ( isset( <a class="var it7411" onMouseOver="hilite(7411)" onMouseOut="lolite()" onClick="logVariable('htmlelements')" href="../../_variables/htmlelements.html">$htmlelements</a>[<a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a> = <a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>( <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a> )] ) ) {
<a name="l457"><span class="linenum"> 457</span></a>  <span class="comment">                    # Check our stack</span>
<a name="l458"><span class="linenum"> 458</span></a>                      if ( <a class="var it7413" onMouseOver="hilite(7413)" onMouseOut="lolite()" onClick="logVariable('slash')" href="../../_variables/slash.html">$slash</a> &amp;&amp; isset( <a class="var it7401" onMouseOver="hilite(7401)" onMouseOut="lolite()" onClick="logVariable('htmlsingleonly')" href="../../_variables/htmlsingleonly.html">$htmlsingleonly</a>[<a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a>] ) ) {
<a name="l459"><span class="linenum"> 459</span></a>                          <a class="var it7416" onMouseOver="hilite(7416)" onMouseOut="lolite()" onClick="logVariable('badtag')" href="../../_variables/badtag.html">$badtag</a> = true;
<a name="l460"><span class="linenum"> 460</span></a>                      } elseif ( <a class="var it7413" onMouseOver="hilite(7413)" onMouseOut="lolite()" onClick="logVariable('slash')" href="../../_variables/slash.html">$slash</a> ) {
<a name="l461"><span class="linenum"> 461</span></a>  <span class="comment">                        # Closing a tag... is it the one we just opened?</span>
<a name="l462"><span class="linenum"> 462</span></a>                          <a class="var it7417" onMouseOver="hilite(7417)" onMouseOut="lolite()" onClick="logVariable('ot')" href="../../_variables/ot.html">$ot</a> = @<a class="phpfunction" onClick="logFunction('array_pop')" href="../../_functions/array_pop.html" onMouseOver="phpfuncPopup(event,'array_pop')">array_pop</a>( <a class="var it1057" onMouseOver="hilite(1057)" onMouseOut="lolite()" onClick="logVariable('tagstack')" href="../../_variables/tagstack.html">$tagstack</a> );
<a name="l463"><span class="linenum"> 463</span></a>                          if ( <a class="var it7417" onMouseOver="hilite(7417)" onMouseOut="lolite()" onClick="logVariable('ot')" href="../../_variables/ot.html">$ot</a> != <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a> ) {
<a name="l464"><span class="linenum"> 464</span></a>                              if ( isset( <a class="var it7406" onMouseOver="hilite(7406)" onMouseOut="lolite()" onClick="logVariable('htmlsingleallowed')" href="../../_variables/htmlsingleallowed.html">$htmlsingleallowed</a>[<a class="var it7417" onMouseOver="hilite(7417)" onMouseOut="lolite()" onClick="logVariable('ot')" href="../../_variables/ot.html">$ot</a>] ) ) {
<a name="l465"><span class="linenum"> 465</span></a>  <span class="comment">                                # Pop all elements with an optional close tag</span>
<a name="l466"><span class="linenum"> 466</span></a>  <span class="comment">                                # and see if we find a match below them</span>
<a name="l467"><span class="linenum"> 467</span></a>                                  <a class="var it7418" onMouseOver="hilite(7418)" onMouseOut="lolite()" onClick="logVariable('optstack')" href="../../_variables/optstack.html">$optstack</a> = array();
<a name="l468"><span class="linenum"> 468</span></a>                                  <a class="phpfunction" onClick="logFunction('array_push')" href="../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>( <a class="var it7418" onMouseOver="hilite(7418)" onMouseOut="lolite()" onClick="logVariable('optstack')" href="../../_variables/optstack.html">$optstack</a>, <a class="var it7417" onMouseOver="hilite(7417)" onMouseOut="lolite()" onClick="logVariable('ot')" href="../../_variables/ot.html">$ot</a> );
<a name="l469"><span class="linenum"> 469</span></a>                                  wfSuppressWarnings();
<a name="l470"><span class="linenum"> 470</span></a>                                  <a class="var it7417" onMouseOver="hilite(7417)" onMouseOut="lolite()" onClick="logVariable('ot')" href="../../_variables/ot.html">$ot</a> = <a class="phpfunction" onClick="logFunction('array_pop')" href="../../_functions/array_pop.html" onMouseOver="phpfuncPopup(event,'array_pop')">array_pop</a>( <a class="var it1057" onMouseOver="hilite(1057)" onMouseOut="lolite()" onClick="logVariable('tagstack')" href="../../_variables/tagstack.html">$tagstack</a> );
<a name="l471"><span class="linenum"> 471</span></a>                                  wfRestoreWarnings();
<a name="l472"><span class="linenum"> 472</span></a>                                  while ( <a class="var it7417" onMouseOver="hilite(7417)" onMouseOut="lolite()" onClick="logVariable('ot')" href="../../_variables/ot.html">$ot</a> != <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a> &amp;&amp; isset( <a class="var it7406" onMouseOver="hilite(7406)" onMouseOut="lolite()" onClick="logVariable('htmlsingleallowed')" href="../../_variables/htmlsingleallowed.html">$htmlsingleallowed</a>[<a class="var it7417" onMouseOver="hilite(7417)" onMouseOut="lolite()" onClick="logVariable('ot')" href="../../_variables/ot.html">$ot</a>] ) ) {
<a name="l473"><span class="linenum"> 473</span></a>                                      <a class="phpfunction" onClick="logFunction('array_push')" href="../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>( <a class="var it7418" onMouseOver="hilite(7418)" onMouseOut="lolite()" onClick="logVariable('optstack')" href="../../_variables/optstack.html">$optstack</a>, <a class="var it7417" onMouseOver="hilite(7417)" onMouseOut="lolite()" onClick="logVariable('ot')" href="../../_variables/ot.html">$ot</a> );
<a name="l474"><span class="linenum"> 474</span></a>                                      wfSuppressWarnings();
<a name="l475"><span class="linenum"> 475</span></a>                                      <a class="var it7417" onMouseOver="hilite(7417)" onMouseOut="lolite()" onClick="logVariable('ot')" href="../../_variables/ot.html">$ot</a> = <a class="phpfunction" onClick="logFunction('array_pop')" href="../../_functions/array_pop.html" onMouseOver="phpfuncPopup(event,'array_pop')">array_pop</a>( <a class="var it1057" onMouseOver="hilite(1057)" onMouseOut="lolite()" onClick="logVariable('tagstack')" href="../../_variables/tagstack.html">$tagstack</a> );
<a name="l476"><span class="linenum"> 476</span></a>                                      wfRestoreWarnings();
<a name="l477"><span class="linenum"> 477</span></a>                                  }
<a name="l478"><span class="linenum"> 478</span></a>                                  if ( <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a> != <a class="var it7417" onMouseOver="hilite(7417)" onMouseOut="lolite()" onClick="logVariable('ot')" href="../../_variables/ot.html">$ot</a> ) {
<a name="l479"><span class="linenum"> 479</span></a>  <span class="comment">                                    # No match. Push the optional elements back again</span>
<a name="l480"><span class="linenum"> 480</span></a>                                      <a class="var it7416" onMouseOver="hilite(7416)" onMouseOut="lolite()" onClick="logVariable('badtag')" href="../../_variables/badtag.html">$badtag</a> = true;
<a name="l481"><span class="linenum"> 481</span></a>                                      wfSuppressWarnings();
<a name="l482"><span class="linenum"> 482</span></a>                                      <a class="var it7417" onMouseOver="hilite(7417)" onMouseOut="lolite()" onClick="logVariable('ot')" href="../../_variables/ot.html">$ot</a> = <a class="phpfunction" onClick="logFunction('array_pop')" href="../../_functions/array_pop.html" onMouseOver="phpfuncPopup(event,'array_pop')">array_pop</a>( <a class="var it7418" onMouseOver="hilite(7418)" onMouseOut="lolite()" onClick="logVariable('optstack')" href="../../_variables/optstack.html">$optstack</a> );
<a name="l483"><span class="linenum"> 483</span></a>                                      wfRestoreWarnings();
<a name="l484"><span class="linenum"> 484</span></a>                                      while ( <a class="var it7417" onMouseOver="hilite(7417)" onMouseOut="lolite()" onClick="logVariable('ot')" href="../../_variables/ot.html">$ot</a> ) {
<a name="l485"><span class="linenum"> 485</span></a>                                          <a class="phpfunction" onClick="logFunction('array_push')" href="../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>( <a class="var it1057" onMouseOver="hilite(1057)" onMouseOut="lolite()" onClick="logVariable('tagstack')" href="../../_variables/tagstack.html">$tagstack</a>, <a class="var it7417" onMouseOver="hilite(7417)" onMouseOut="lolite()" onClick="logVariable('ot')" href="../../_variables/ot.html">$ot</a> );
<a name="l486"><span class="linenum"> 486</span></a>                                          wfSuppressWarnings();
<a name="l487"><span class="linenum"> 487</span></a>                                          <a class="var it7417" onMouseOver="hilite(7417)" onMouseOut="lolite()" onClick="logVariable('ot')" href="../../_variables/ot.html">$ot</a> = <a class="phpfunction" onClick="logFunction('array_pop')" href="../../_functions/array_pop.html" onMouseOver="phpfuncPopup(event,'array_pop')">array_pop</a>( <a class="var it7418" onMouseOver="hilite(7418)" onMouseOut="lolite()" onClick="logVariable('optstack')" href="../../_variables/optstack.html">$optstack</a> );
<a name="l488"><span class="linenum"> 488</span></a>                                          wfRestoreWarnings();
<a name="l489"><span class="linenum"> 489</span></a>                                      }
<a name="l490"><span class="linenum"> 490</span></a>                                  }
<a name="l491"><span class="linenum"> 491</span></a>                              } else {
<a name="l492"><span class="linenum"> 492</span></a>                                  @<a class="phpfunction" onClick="logFunction('array_push')" href="../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>( <a class="var it1057" onMouseOver="hilite(1057)" onMouseOut="lolite()" onClick="logVariable('tagstack')" href="../../_variables/tagstack.html">$tagstack</a>, <a class="var it7417" onMouseOver="hilite(7417)" onMouseOut="lolite()" onClick="logVariable('ot')" href="../../_variables/ot.html">$ot</a> );
<a name="l493"><span class="linenum"> 493</span></a>  <span class="comment">                                # &lt;li&gt; can be nested in &lt;ul&gt; or &lt;ol&gt;, skip those cases:</span>
<a name="l494"><span class="linenum"> 494</span></a>                                  if ( !isset( <a class="var it7404" onMouseOver="hilite(7404)" onMouseOut="lolite()" onClick="logVariable('htmllist')" href="../../_variables/htmllist.html">$htmllist</a>[<a class="var it7417" onMouseOver="hilite(7417)" onMouseOut="lolite()" onClick="logVariable('ot')" href="../../_variables/ot.html">$ot</a>] ) || !isset( <a class="var it7405" onMouseOver="hilite(7405)" onMouseOut="lolite()" onClick="logVariable('listtags')" href="../../_variables/listtags.html">$listtags</a>[<a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a>] ) ) {
<a name="l495"><span class="linenum"> 495</span></a>                                      <a class="var it7416" onMouseOver="hilite(7416)" onMouseOut="lolite()" onClick="logVariable('badtag')" href="../../_variables/badtag.html">$badtag</a> = true;
<a name="l496"><span class="linenum"> 496</span></a>                                  }
<a name="l497"><span class="linenum"> 497</span></a>                              }
<a name="l498"><span class="linenum"> 498</span></a>                          } else {
<a name="l499"><span class="linenum"> 499</span></a>                              if ( <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a> == 'table' ) {
<a name="l500"><span class="linenum"> 500</span></a>                                  <a class="var it1057" onMouseOver="hilite(1057)" onMouseOut="lolite()" onClick="logVariable('tagstack')" href="../../_variables/tagstack.html">$tagstack</a> = <a class="phpfunction" onClick="logFunction('array_pop')" href="../../_functions/array_pop.html" onMouseOver="phpfuncPopup(event,'array_pop')">array_pop</a>( <a class="var it7412" onMouseOver="hilite(7412)" onMouseOut="lolite()" onClick="logVariable('tablestack')" href="../../_variables/tablestack.html">$tablestack</a> );
<a name="l501"><span class="linenum"> 501</span></a>                              }
<a name="l502"><span class="linenum"> 502</span></a>                          }
<a name="l503"><span class="linenum"> 503</span></a>                          <a class="var it7419" onMouseOver="hilite(7419)" onMouseOut="lolite()" onClick="logVariable('newparams')" href="../../_variables/newparams.html">$newparams</a> = '';
<a name="l504"><span class="linenum"> 504</span></a>                      } else {
<a name="l505"><span class="linenum"> 505</span></a>  <span class="comment">                        # Keep track for later</span>
<a name="l506"><span class="linenum"> 506</span></a>                          if ( isset( <a class="var it7403" onMouseOver="hilite(7403)" onMouseOut="lolite()" onClick="logVariable('tabletags')" href="../../_variables/tabletags.html">$tabletags</a>[<a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a>] ) &amp;&amp;
<a name="l507"><span class="linenum"> 507</span></a>                          !<a class="phpfunction" onClick="logFunction('in_array')" href="../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>( 'table', <a class="var it1057" onMouseOver="hilite(1057)" onMouseOut="lolite()" onClick="logVariable('tagstack')" href="../../_variables/tagstack.html">$tagstack</a> ) ) {
<a name="l508"><span class="linenum"> 508</span></a>                              <a class="var it7416" onMouseOver="hilite(7416)" onMouseOut="lolite()" onClick="logVariable('badtag')" href="../../_variables/badtag.html">$badtag</a> = true;
<a name="l509"><span class="linenum"> 509</span></a>                          } elseif ( <a class="phpfunction" onClick="logFunction('in_array')" href="../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>( <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a>, <a class="var it1057" onMouseOver="hilite(1057)" onMouseOut="lolite()" onClick="logVariable('tagstack')" href="../../_variables/tagstack.html">$tagstack</a> ) &amp;&amp;
<a name="l510"><span class="linenum"> 510</span></a>                          !isset( <a class="var it7402" onMouseOver="hilite(7402)" onMouseOut="lolite()" onClick="logVariable('htmlnest')" href="../../_variables/htmlnest.html">$htmlnest</a> [<a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a> ] ) ) {
<a name="l511"><span class="linenum"> 511</span></a>                              <a class="var it7416" onMouseOver="hilite(7416)" onMouseOut="lolite()" onClick="logVariable('badtag')" href="../../_variables/badtag.html">$badtag</a> = true;
<a name="l512"><span class="linenum"> 512</span></a>  <span class="comment">                        #Â Is it a self closed htmlpair ? (bug 5487)</span>
<a name="l513"><span class="linenum"> 513</span></a>                          } elseif ( <a class="var it7414" onMouseOver="hilite(7414)" onMouseOut="lolite()" onClick="logVariable('brace')" href="../../_variables/brace.html">$brace</a> == '/&gt;' &amp;&amp;
<a name="l514"><span class="linenum"> 514</span></a>                          isset( <a class="var it7410" onMouseOver="hilite(7410)" onMouseOut="lolite()" onClick="logVariable('htmlpairs')" href="../../_variables/htmlpairs.html">$htmlpairs</a>[<a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a>] ) ) {
<a name="l515"><span class="linenum"> 515</span></a>                              <a class="var it7416" onMouseOver="hilite(7416)" onMouseOut="lolite()" onClick="logVariable('badtag')" href="../../_variables/badtag.html">$badtag</a> = true;
<a name="l516"><span class="linenum"> 516</span></a>                          } elseif ( isset( <a class="var it7401" onMouseOver="hilite(7401)" onMouseOut="lolite()" onClick="logVariable('htmlsingleonly')" href="../../_variables/htmlsingleonly.html">$htmlsingleonly</a>[<a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a>] ) ) {
<a name="l517"><span class="linenum"> 517</span></a>  <span class="comment">                            # Hack to force empty tag for unclosable elements</span>
<a name="l518"><span class="linenum"> 518</span></a>                              <a class="var it7414" onMouseOver="hilite(7414)" onMouseOut="lolite()" onClick="logVariable('brace')" href="../../_variables/brace.html">$brace</a> = '/&gt;';
<a name="l519"><span class="linenum"> 519</span></a>                          } elseif ( isset( <a class="var it7400" onMouseOver="hilite(7400)" onMouseOut="lolite()" onClick="logVariable('htmlsingle')" href="../../_variables/htmlsingle.html">$htmlsingle</a>[<a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a>] ) ) {
<a name="l520"><span class="linenum"> 520</span></a>  <span class="comment">                            # Hack to not close $htmlsingle tags</span>
<a name="l521"><span class="linenum"> 521</span></a>                              <a class="var it7414" onMouseOver="hilite(7414)" onMouseOut="lolite()" onClick="logVariable('brace')" href="../../_variables/brace.html">$brace</a> = null;
<a name="l522"><span class="linenum"> 522</span></a>  <span class="comment">                            # Still need to push this optionally-closed tag to</span>
<a name="l523"><span class="linenum"> 523</span></a>  <span class="comment">                            # the tag stack so that we can match end tags</span>
<a name="l524"><span class="linenum"> 524</span></a>  <span class="comment">                            # instead of marking them as bad.</span>
<a name="l525"><span class="linenum"> 525</span></a>                              <a class="phpfunction" onClick="logFunction('array_push')" href="../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>( <a class="var it1057" onMouseOver="hilite(1057)" onMouseOut="lolite()" onClick="logVariable('tagstack')" href="../../_variables/tagstack.html">$tagstack</a>, <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a> );
<a name="l526"><span class="linenum"> 526</span></a>                          } elseif ( isset( <a class="var it7403" onMouseOver="hilite(7403)" onMouseOut="lolite()" onClick="logVariable('tabletags')" href="../../_variables/tabletags.html">$tabletags</a>[<a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a>] )
<a name="l527"><span class="linenum"> 527</span></a>                          &amp;&amp; <a class="phpfunction" onClick="logFunction('in_array')" href="../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>( <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a>, <a class="var it1057" onMouseOver="hilite(1057)" onMouseOut="lolite()" onClick="logVariable('tagstack')" href="../../_variables/tagstack.html">$tagstack</a> ) ) {
<a name="l528"><span class="linenum"> 528</span></a>  <span class="comment">                            // New table tag but forgot to close the previous one</span>
<a name="l529"><span class="linenum"> 529</span></a>                              <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;&lt;/<a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a>&gt;&quot;;
<a name="l530"><span class="linenum"> 530</span></a>                          } else {
<a name="l531"><span class="linenum"> 531</span></a>                              if ( <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a> == 'table' ) {
<a name="l532"><span class="linenum"> 532</span></a>                                  <a class="phpfunction" onClick="logFunction('array_push')" href="../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>( <a class="var it7412" onMouseOver="hilite(7412)" onMouseOut="lolite()" onClick="logVariable('tablestack')" href="../../_variables/tablestack.html">$tablestack</a>, <a class="var it1057" onMouseOver="hilite(1057)" onMouseOut="lolite()" onClick="logVariable('tagstack')" href="../../_variables/tagstack.html">$tagstack</a> );
<a name="l533"><span class="linenum"> 533</span></a>                                  <a class="var it1057" onMouseOver="hilite(1057)" onMouseOut="lolite()" onClick="logVariable('tagstack')" href="../../_variables/tagstack.html">$tagstack</a> = array();
<a name="l534"><span class="linenum"> 534</span></a>                              }
<a name="l535"><span class="linenum"> 535</span></a>                              <a class="phpfunction" onClick="logFunction('array_push')" href="../../_functions/array_push.html" onMouseOver="phpfuncPopup(event,'array_push')">array_push</a>( <a class="var it1057" onMouseOver="hilite(1057)" onMouseOut="lolite()" onClick="logVariable('tagstack')" href="../../_variables/tagstack.html">$tagstack</a>, <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a> );
<a name="l536"><span class="linenum"> 536</span></a>                          }
<a name="l537"><span class="linenum"> 537</span></a>  
<a name="l538"><span class="linenum"> 538</span></a>  <span class="comment">                        # Replace any variables or template parameters with</span>
<a name="l539"><span class="linenum"> 539</span></a>  <span class="comment">                        # plaintext results.</span>
<a name="l540"><span class="linenum"> 540</span></a>                          if( <a class="phpfunction" onClick="logFunction('is_callable')" href="../../_functions/is_callable.html" onMouseOver="phpfuncPopup(event,'is_callable')">is_callable</a>( <a class="var it7392" onMouseOver="hilite(7392)" onMouseOut="lolite()" onClick="logVariable('processCallback')" href="../../_variables/processCallback.html">$processCallback</a> ) ) {
<a name="l541"><span class="linenum"> 541</span></a>                              <a class="phpfunction" onClick="logFunction('call_user_func_array')" href="../../_functions/call_user_func_array.html" onMouseOver="phpfuncPopup(event,'call_user_func_array')">call_user_func_array</a>( <a class="var it7392" onMouseOver="hilite(7392)" onMouseOut="lolite()" onClick="logVariable('processCallback')" href="../../_variables/processCallback.html">$processCallback</a>, array( &amp;<a class="var it106" onMouseOver="hilite(106)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it1569" onMouseOver="hilite(1569)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../_variables/args.html">$args</a> ) );
<a name="l542"><span class="linenum"> 542</span></a>                          }
<a name="l543"><span class="linenum"> 543</span></a>  
<a name="l544"><span class="linenum"> 544</span></a>                          if ( !<a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('validateTag')" href="../../_functions/validatetag.html" onMouseOver="funcPopup(event,'validatetag')">validateTag</a>( <a class="var it106" onMouseOver="hilite(106)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a> ) ) {
<a name="l545"><span class="linenum"> 545</span></a>                              <a class="var it7416" onMouseOver="hilite(7416)" onMouseOut="lolite()" onClick="logVariable('badtag')" href="../../_variables/badtag.html">$badtag</a> = true;
<a name="l546"><span class="linenum"> 546</span></a>                          }
<a name="l547"><span class="linenum"> 547</span></a>  
<a name="l548"><span class="linenum"> 548</span></a>  <span class="comment">                        # Strip non-approved attributes from the tag</span>
<a name="l549"><span class="linenum"> 549</span></a>                          <a class="var it7419" onMouseOver="hilite(7419)" onMouseOut="lolite()" onClick="logVariable('newparams')" href="../../_variables/newparams.html">$newparams</a> = <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('fixTagAttributes')" href="../../_functions/fixtagattributes.html" onMouseOver="funcPopup(event,'fixtagattributes')">fixTagAttributes</a>( <a class="var it106" onMouseOver="hilite(106)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a> );
<a name="l550"><span class="linenum"> 550</span></a>                      }
<a name="l551"><span class="linenum"> 551</span></a>                      if ( !<a class="var it7416" onMouseOver="hilite(7416)" onMouseOut="lolite()" onClick="logVariable('badtag')" href="../../_variables/badtag.html">$badtag</a> ) {
<a name="l552"><span class="linenum"> 552</span></a>                          <a class="var it7415" onMouseOver="hilite(7415)" onMouseOut="lolite()" onClick="logVariable('rest')" href="../../_variables/rest.html">$rest</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>( '&gt;', '&amp;gt;', <a class="var it7415" onMouseOver="hilite(7415)" onMouseOut="lolite()" onClick="logVariable('rest')" href="../../_variables/rest.html">$rest</a> );
<a name="l553"><span class="linenum"> 553</span></a>                          <a class="var it7420" onMouseOver="hilite(7420)" onMouseOut="lolite()" onClick="logVariable('close')" href="../../_variables/close.html">$close</a> = ( <a class="var it7414" onMouseOver="hilite(7414)" onMouseOut="lolite()" onClick="logVariable('brace')" href="../../_variables/brace.html">$brace</a> == '/&gt;' &amp;&amp; !<a class="var it7413" onMouseOver="hilite(7413)" onMouseOut="lolite()" onClick="logVariable('slash')" href="../../_variables/slash.html">$slash</a> ) ? ' /' : '';
<a name="l554"><span class="linenum"> 554</span></a>                          <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;&lt;<a class="var it7413" onMouseOver="hilite(7413)" onMouseOut="lolite()" onClick="logVariable('slash')" href="../../_variables/slash.html">$slash</a><a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a><a class="var it7419" onMouseOver="hilite(7419)" onMouseOut="lolite()" onClick="logVariable('newparams')" href="../../_variables/newparams.html">$newparams</a><a class="var it7420" onMouseOver="hilite(7420)" onMouseOut="lolite()" onClick="logVariable('close')" href="../../_variables/close.html">$close</a>&gt;<a class="var it7415" onMouseOver="hilite(7415)" onMouseOut="lolite()" onClick="logVariable('rest')" href="../../_variables/rest.html">$rest</a>&quot;;
<a name="l555"><span class="linenum"> 555</span></a>                          continue;
<a name="l556"><span class="linenum"> 556</span></a>                      }
<a name="l557"><span class="linenum"> 557</span></a>                  }
<a name="l558"><span class="linenum"> 558</span></a>                  <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= '&amp;lt;' . <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>( '&gt;', '&amp;gt;', <a class="var it669" onMouseOver="hilite(669)" onMouseOut="lolite()" onClick="logVariable('x')" href="../../_variables/x.html">$x</a>);
<a name="l559"><span class="linenum"> 559</span></a>              }
<a name="l560"><span class="linenum"> 560</span></a>  <span class="comment">            # Close off any remaining tags</span>
<a name="l561"><span class="linenum"> 561</span></a>              while ( <a class="phpfunction" onClick="logFunction('is_array')" href="../../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>( <a class="var it1057" onMouseOver="hilite(1057)" onMouseOut="lolite()" onClick="logVariable('tagstack')" href="../../_variables/tagstack.html">$tagstack</a> ) &amp;&amp; (<a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a> = <a class="phpfunction" onClick="logFunction('array_pop')" href="../../_functions/array_pop.html" onMouseOver="phpfuncPopup(event,'array_pop')">array_pop</a>( <a class="var it1057" onMouseOver="hilite(1057)" onMouseOut="lolite()" onClick="logVariable('tagstack')" href="../../_variables/tagstack.html">$tagstack</a> )) ) {
<a name="l562"><span class="linenum"> 562</span></a>                  <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;&lt;/<a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a>&gt;\n&quot;;
<a name="l563"><span class="linenum"> 563</span></a>                  if ( <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a> == 'table' ) { <a class="var it1057" onMouseOver="hilite(1057)" onMouseOut="lolite()" onClick="logVariable('tagstack')" href="../../_variables/tagstack.html">$tagstack</a> = <a class="phpfunction" onClick="logFunction('array_pop')" href="../../_functions/array_pop.html" onMouseOver="phpfuncPopup(event,'array_pop')">array_pop</a>( <a class="var it7412" onMouseOver="hilite(7412)" onMouseOut="lolite()" onClick="logVariable('tablestack')" href="../../_variables/tablestack.html">$tablestack</a> ); }
<a name="l564"><span class="linenum"> 564</span></a>              }
<a name="l565"><span class="linenum"> 565</span></a>          } else {
<a name="l566"><span class="linenum"> 566</span></a>  <span class="comment">            # this might be possible using tidy itself</span>
<a name="l567"><span class="linenum"> 567</span></a>              foreach ( <a class="var it3147" onMouseOver="hilite(3147)" onMouseOut="lolite()" onClick="logVariable('bits')" href="../../_variables/bits.html">$bits</a> as <a class="var it669" onMouseOver="hilite(669)" onMouseOut="lolite()" onClick="logVariable('x')" href="../../_variables/x.html">$x</a> ) {
<a name="l568"><span class="linenum"> 568</span></a>                  <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>( '/^(\\/?)(\\w+)([^&gt;]*?)(\\/{0,1}&gt;)([^&lt;]*)$/',
<a name="l569"><span class="linenum"> 569</span></a>                  <a class="var it669" onMouseOver="hilite(669)" onMouseOut="lolite()" onClick="logVariable('x')" href="../../_variables/x.html">$x</a>, <a class="var it6618" onMouseOver="hilite(6618)" onMouseOut="lolite()" onClick="logVariable('regs')" href="../../_variables/regs.html">$regs</a> );
<a name="l570"><span class="linenum"> 570</span></a>                  @<a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>( <span class="comment">/* $qbar */</span>, <a class="var it7413" onMouseOver="hilite(7413)" onMouseOut="lolite()" onClick="logVariable('slash')" href="../../_variables/slash.html">$slash</a>, <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a>, <a class="var it106" onMouseOver="hilite(106)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it7414" onMouseOver="hilite(7414)" onMouseOut="lolite()" onClick="logVariable('brace')" href="../../_variables/brace.html">$brace</a>, <a class="var it7415" onMouseOver="hilite(7415)" onMouseOut="lolite()" onClick="logVariable('rest')" href="../../_variables/rest.html">$rest</a> ) = <a class="var it6618" onMouseOver="hilite(6618)" onMouseOut="lolite()" onClick="logVariable('regs')" href="../../_variables/regs.html">$regs</a>;
<a name="l571"><span class="linenum"> 571</span></a>                  <a class="var it7416" onMouseOver="hilite(7416)" onMouseOut="lolite()" onClick="logVariable('badtag')" href="../../_variables/badtag.html">$badtag</a> = false;
<a name="l572"><span class="linenum"> 572</span></a>                  if ( isset( <a class="var it7411" onMouseOver="hilite(7411)" onMouseOut="lolite()" onClick="logVariable('htmlelements')" href="../../_variables/htmlelements.html">$htmlelements</a>[<a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a> = <a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>( <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a> )] ) ) {
<a name="l573"><span class="linenum"> 573</span></a>                      if( <a class="phpfunction" onClick="logFunction('is_callable')" href="../../_functions/is_callable.html" onMouseOver="phpfuncPopup(event,'is_callable')">is_callable</a>( <a class="var it7392" onMouseOver="hilite(7392)" onMouseOut="lolite()" onClick="logVariable('processCallback')" href="../../_variables/processCallback.html">$processCallback</a> ) ) {
<a name="l574"><span class="linenum"> 574</span></a>                          <a class="phpfunction" onClick="logFunction('call_user_func_array')" href="../../_functions/call_user_func_array.html" onMouseOver="phpfuncPopup(event,'call_user_func_array')">call_user_func_array</a>( <a class="var it7392" onMouseOver="hilite(7392)" onMouseOut="lolite()" onClick="logVariable('processCallback')" href="../../_variables/processCallback.html">$processCallback</a>, array( &amp;<a class="var it106" onMouseOver="hilite(106)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it1569" onMouseOver="hilite(1569)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../_variables/args.html">$args</a> ) );
<a name="l575"><span class="linenum"> 575</span></a>                      }
<a name="l576"><span class="linenum"> 576</span></a>  
<a name="l577"><span class="linenum"> 577</span></a>                      if ( !<a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('validateTag')" href="../../_functions/validatetag.html" onMouseOver="funcPopup(event,'validatetag')">validateTag</a>( <a class="var it106" onMouseOver="hilite(106)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a> ) ) {
<a name="l578"><span class="linenum"> 578</span></a>                          <a class="var it7416" onMouseOver="hilite(7416)" onMouseOut="lolite()" onClick="logVariable('badtag')" href="../../_variables/badtag.html">$badtag</a> = true;
<a name="l579"><span class="linenum"> 579</span></a>                      }
<a name="l580"><span class="linenum"> 580</span></a>  
<a name="l581"><span class="linenum"> 581</span></a>                      <a class="var it7419" onMouseOver="hilite(7419)" onMouseOut="lolite()" onClick="logVariable('newparams')" href="../../_variables/newparams.html">$newparams</a> = <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('fixTagAttributes')" href="../../_functions/fixtagattributes.html" onMouseOver="funcPopup(event,'fixtagattributes')">fixTagAttributes</a>( <a class="var it106" onMouseOver="hilite(106)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a> );
<a name="l582"><span class="linenum"> 582</span></a>                      if ( !<a class="var it7416" onMouseOver="hilite(7416)" onMouseOut="lolite()" onClick="logVariable('badtag')" href="../../_variables/badtag.html">$badtag</a> ) {
<a name="l583"><span class="linenum"> 583</span></a>                          <a class="var it7415" onMouseOver="hilite(7415)" onMouseOut="lolite()" onClick="logVariable('rest')" href="../../_variables/rest.html">$rest</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>( '&gt;', '&amp;gt;', <a class="var it7415" onMouseOver="hilite(7415)" onMouseOut="lolite()" onClick="logVariable('rest')" href="../../_variables/rest.html">$rest</a> );
<a name="l584"><span class="linenum"> 584</span></a>                          <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= &quot;&lt;<a class="var it7413" onMouseOver="hilite(7413)" onMouseOut="lolite()" onClick="logVariable('slash')" href="../../_variables/slash.html">$slash</a><a class="var it267" onMouseOver="hilite(267)" onMouseOut="lolite()" onClick="logVariable('t')" href="../../_variables/t.html">$t</a><a class="var it7419" onMouseOver="hilite(7419)" onMouseOut="lolite()" onClick="logVariable('newparams')" href="../../_variables/newparams.html">$newparams</a><a class="var it7414" onMouseOver="hilite(7414)" onMouseOut="lolite()" onClick="logVariable('brace')" href="../../_variables/brace.html">$brace</a><a class="var it7415" onMouseOver="hilite(7415)" onMouseOut="lolite()" onClick="logVariable('rest')" href="../../_variables/rest.html">$rest</a>&quot;;
<a name="l585"><span class="linenum"> 585</span></a>                          continue;
<a name="l586"><span class="linenum"> 586</span></a>                      }
<a name="l587"><span class="linenum"> 587</span></a>                  }
<a name="l588"><span class="linenum"> 588</span></a>                  <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> .= '&amp;lt;' . <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>( '&gt;', '&amp;gt;', <a class="var it669" onMouseOver="hilite(669)" onMouseOut="lolite()" onClick="logVariable('x')" href="../../_variables/x.html">$x</a>);
<a name="l589"><span class="linenum"> 589</span></a>              }
<a name="l590"><span class="linenum"> 590</span></a>          }
<a name="l591"><span class="linenum"> 591</span></a>          wfProfileOut( __METHOD__ );
<a name="l592"><span class="linenum"> 592</span></a>          return <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l593"><span class="linenum"> 593</span></a>      }
<a name="l594"><span class="linenum"> 594</span></a>  
<a name="l595"><span class="linenum"> 595</span></a>      <span class="comment">/**</span>
<a name="l596"><span class="linenum"> 596</span></a>  <span class="comment">     * Remove '&lt;!--', '--&gt;', and everything between.</span>
<a name="l597"><span class="linenum"> 597</span></a>  <span class="comment">     * To avoid leaving blank lines, when a comment is both preceded</span>
<a name="l598"><span class="linenum"> 598</span></a>  <span class="comment">     * and followed by a newline (ignoring spaces), trim leading and</span>
<a name="l599"><span class="linenum"> 599</span></a>  <span class="comment">     * trailing spaces and one of the newlines.</span>
<a name="l600"><span class="linenum"> 600</span></a>  <span class="comment">     *</span>
<a name="l601"><span class="linenum"> 601</span></a>  <span class="comment">     * @private</span>
<a name="l602"><span class="linenum"> 602</span></a>  <span class="comment">     * @param $text String</span>
<a name="l603"><span class="linenum"> 603</span></a>  <span class="comment">     * @return string</span>
<a name="l604"><span class="linenum"> 604</span></a>  <span class="comment">     */</span>
<a name="l605"><span class="linenum"> 605</span></a>  	static function <a class="function" onClick="logFunction('removeHTMLcomments')" href="../../_functions/removehtmlcomments.html" onMouseOver="funcPopup(event,'removehtmlcomments')">removeHTMLcomments</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> ) {
<a name="l606"><span class="linenum"> 606</span></a>          wfProfileIn( __METHOD__ );
<a name="l607"><span class="linenum"> 607</span></a>          while ( (<a class="var it687" onMouseOver="hilite(687)" onMouseOut="lolite()" onClick="logVariable('start')" href="../../_variables/start.html">$start</a> = <a class="phpfunction" onClick="logFunction('strpos')" href="../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, '&lt;!--' ) ) !== false ) {
<a name="l608"><span class="linenum"> 608</span></a>              <a class="var it677" onMouseOver="hilite(677)" onMouseOut="lolite()" onClick="logVariable('end')" href="../../_variables/end.html">$end</a> = <a class="phpfunction" onClick="logFunction('strpos')" href="../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, '--&gt;', <a class="var it687" onMouseOver="hilite(687)" onMouseOut="lolite()" onClick="logVariable('start')" href="../../_variables/start.html">$start</a> + 4 );
<a name="l609"><span class="linenum"> 609</span></a>              if ( <a class="var it677" onMouseOver="hilite(677)" onMouseOut="lolite()" onClick="logVariable('end')" href="../../_variables/end.html">$end</a> === false ) {
<a name="l610"><span class="linenum"> 610</span></a>  <span class="comment">                # Unterminated comment; bail out</span>
<a name="l611"><span class="linenum"> 611</span></a>                  break;
<a name="l612"><span class="linenum"> 612</span></a>              }
<a name="l613"><span class="linenum"> 613</span></a>  
<a name="l614"><span class="linenum"> 614</span></a>              <a class="var it677" onMouseOver="hilite(677)" onMouseOut="lolite()" onClick="logVariable('end')" href="../../_variables/end.html">$end</a> += 3;
<a name="l615"><span class="linenum"> 615</span></a>  
<a name="l616"><span class="linenum"> 616</span></a>  <span class="comment">            # Trim space and newline if the comment is both</span>
<a name="l617"><span class="linenum"> 617</span></a>  <span class="comment">            # preceded and followed by a newline</span>
<a name="l618"><span class="linenum"> 618</span></a>              <a class="var it7421" onMouseOver="hilite(7421)" onMouseOut="lolite()" onClick="logVariable('spaceStart')" href="../../_variables/spaceStart.html">$spaceStart</a> = <a class="phpfunction" onClick="logFunction('max')" href="../../_functions/max.html" onMouseOver="phpfuncPopup(event,'max')">max</a>( <a class="var it687" onMouseOver="hilite(687)" onMouseOut="lolite()" onClick="logVariable('start')" href="../../_variables/start.html">$start</a> - 1, 0 );
<a name="l619"><span class="linenum"> 619</span></a>              <a class="var it7422" onMouseOver="hilite(7422)" onMouseOut="lolite()" onClick="logVariable('spaceLen')" href="../../_variables/spaceLen.html">$spaceLen</a> = <a class="var it677" onMouseOver="hilite(677)" onMouseOut="lolite()" onClick="logVariable('end')" href="../../_variables/end.html">$end</a> - <a class="var it7421" onMouseOver="hilite(7421)" onMouseOut="lolite()" onClick="logVariable('spaceStart')" href="../../_variables/spaceStart.html">$spaceStart</a>;
<a name="l620"><span class="linenum"> 620</span></a>              while ( <a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, <a class="var it7421" onMouseOver="hilite(7421)" onMouseOut="lolite()" onClick="logVariable('spaceStart')" href="../../_variables/spaceStart.html">$spaceStart</a>, 1 ) === ' ' &amp;&amp; <a class="var it7421" onMouseOver="hilite(7421)" onMouseOut="lolite()" onClick="logVariable('spaceStart')" href="../../_variables/spaceStart.html">$spaceStart</a> &gt; 0 ) {
<a name="l621"><span class="linenum"> 621</span></a>                  <a class="var it7421" onMouseOver="hilite(7421)" onMouseOut="lolite()" onClick="logVariable('spaceStart')" href="../../_variables/spaceStart.html">$spaceStart</a>--;
<a name="l622"><span class="linenum"> 622</span></a>                  <a class="var it7422" onMouseOver="hilite(7422)" onMouseOut="lolite()" onClick="logVariable('spaceLen')" href="../../_variables/spaceLen.html">$spaceLen</a>++;
<a name="l623"><span class="linenum"> 623</span></a>              }
<a name="l624"><span class="linenum"> 624</span></a>              while ( <a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, <a class="var it7421" onMouseOver="hilite(7421)" onMouseOut="lolite()" onClick="logVariable('spaceStart')" href="../../_variables/spaceStart.html">$spaceStart</a> + <a class="var it7422" onMouseOver="hilite(7422)" onMouseOut="lolite()" onClick="logVariable('spaceLen')" href="../../_variables/spaceLen.html">$spaceLen</a>, 1 ) === ' ' )
<a name="l625"><span class="linenum"> 625</span></a>                  <a class="var it7422" onMouseOver="hilite(7422)" onMouseOut="lolite()" onClick="logVariable('spaceLen')" href="../../_variables/spaceLen.html">$spaceLen</a>++;
<a name="l626"><span class="linenum"> 626</span></a>              if ( <a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, <a class="var it7421" onMouseOver="hilite(7421)" onMouseOut="lolite()" onClick="logVariable('spaceStart')" href="../../_variables/spaceStart.html">$spaceStart</a>, 1 ) === &quot;\n&quot; and <a class="phpfunction" onClick="logFunction('substr')" href="../../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, <a class="var it7421" onMouseOver="hilite(7421)" onMouseOut="lolite()" onClick="logVariable('spaceStart')" href="../../_variables/spaceStart.html">$spaceStart</a> + <a class="var it7422" onMouseOver="hilite(7422)" onMouseOut="lolite()" onClick="logVariable('spaceLen')" href="../../_variables/spaceLen.html">$spaceLen</a>, 1 ) === &quot;\n&quot; ) {
<a name="l627"><span class="linenum"> 627</span></a>  <span class="comment">                # Remove the comment, leading and trailing</span>
<a name="l628"><span class="linenum"> 628</span></a>  <span class="comment">                # spaces, and leave only one newline.</span>
<a name="l629"><span class="linenum"> 629</span></a>                  <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('substr_replace')" href="../../_functions/substr_replace.html" onMouseOver="phpfuncPopup(event,'substr_replace')">substr_replace</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, &quot;\n&quot;, <a class="var it7421" onMouseOver="hilite(7421)" onMouseOut="lolite()" onClick="logVariable('spaceStart')" href="../../_variables/spaceStart.html">$spaceStart</a>, <a class="var it7422" onMouseOver="hilite(7422)" onMouseOut="lolite()" onClick="logVariable('spaceLen')" href="../../_variables/spaceLen.html">$spaceLen</a> + 1 );
<a name="l630"><span class="linenum"> 630</span></a>              }
<a name="l631"><span class="linenum"> 631</span></a>              else {
<a name="l632"><span class="linenum"> 632</span></a>  <span class="comment">                # Remove just the comment.</span>
<a name="l633"><span class="linenum"> 633</span></a>                  <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('substr_replace')" href="../../_functions/substr_replace.html" onMouseOver="phpfuncPopup(event,'substr_replace')">substr_replace</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, '', <a class="var it687" onMouseOver="hilite(687)" onMouseOut="lolite()" onClick="logVariable('start')" href="../../_variables/start.html">$start</a>, <a class="var it677" onMouseOver="hilite(677)" onMouseOut="lolite()" onClick="logVariable('end')" href="../../_variables/end.html">$end</a> - <a class="var it687" onMouseOver="hilite(687)" onMouseOut="lolite()" onClick="logVariable('start')" href="../../_variables/start.html">$start</a> );
<a name="l634"><span class="linenum"> 634</span></a>              }
<a name="l635"><span class="linenum"> 635</span></a>          }
<a name="l636"><span class="linenum"> 636</span></a>          wfProfileOut( __METHOD__ );
<a name="l637"><span class="linenum"> 637</span></a>          return <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l638"><span class="linenum"> 638</span></a>      }
<a name="l639"><span class="linenum"> 639</span></a>  
<a name="l640"><span class="linenum"> 640</span></a>      <span class="comment">/**</span>
<a name="l641"><span class="linenum"> 641</span></a>  <span class="comment">     * Takes attribute names and values for a tag and the tag name and</span>
<a name="l642"><span class="linenum"> 642</span></a>  <span class="comment">     * validates that the tag is allowed to be present.</span>
<a name="l643"><span class="linenum"> 643</span></a>  <span class="comment">     * This DOES NOT validate the attributes, nor does it validate the</span>
<a name="l644"><span class="linenum"> 644</span></a>  <span class="comment">     * tags themselves. This method only handles the special circumstances</span>
<a name="l645"><span class="linenum"> 645</span></a>  <span class="comment">     * where we may want to allow a tag within content but ONLY when it has</span>
<a name="l646"><span class="linenum"> 646</span></a>  <span class="comment">     * specific attributes set.</span>
<a name="l647"><span class="linenum"> 647</span></a>  <span class="comment">     *</span>
<a name="l648"><span class="linenum"> 648</span></a>  <span class="comment">     * @param $params</span>
<a name="l649"><span class="linenum"> 649</span></a>  <span class="comment">     * @param $element</span>
<a name="l650"><span class="linenum"> 650</span></a>  <span class="comment">     * @return bool</span>
<a name="l651"><span class="linenum"> 651</span></a>  <span class="comment">     */</span>
<a name="l652"><span class="linenum"> 652</span></a>  	static function <a class="function" onClick="logFunction('validateTag')" href="../../_functions/validatetag.html" onMouseOver="funcPopup(event,'validatetag')">validateTag</a>( <a class="var it106" onMouseOver="hilite(106)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>, <a class="var it904" onMouseOver="hilite(904)" onMouseOut="lolite()" onClick="logVariable('element')" href="../../_variables/element.html">$element</a> ) {
<a name="l653"><span class="linenum"> 653</span></a>          <a class="var it106" onMouseOver="hilite(106)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> = <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('decodeTagAttributes')" href="../../_functions/decodetagattributes.html" onMouseOver="funcPopup(event,'decodetagattributes')">decodeTagAttributes</a>( <a class="var it106" onMouseOver="hilite(106)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a> );
<a name="l654"><span class="linenum"> 654</span></a>  
<a name="l655"><span class="linenum"> 655</span></a>          if ( <a class="var it904" onMouseOver="hilite(904)" onMouseOut="lolite()" onClick="logVariable('element')" href="../../_variables/element.html">$element</a> == 'meta' || <a class="var it904" onMouseOver="hilite(904)" onMouseOut="lolite()" onClick="logVariable('element')" href="../../_variables/element.html">$element</a> == 'link' ) {
<a name="l656"><span class="linenum"> 656</span></a>              if ( !isset( <a class="var it106" onMouseOver="hilite(106)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['itemprop'] ) ) {
<a name="l657"><span class="linenum"> 657</span></a>  <span class="comment">                // &lt;meta&gt; and &lt;link&gt; must have an itemprop=&quot;&quot; otherwise they are not valid or safe in content</span>
<a name="l658"><span class="linenum"> 658</span></a>                  return false;
<a name="l659"><span class="linenum"> 659</span></a>              }
<a name="l660"><span class="linenum"> 660</span></a>              if ( <a class="var it904" onMouseOver="hilite(904)" onMouseOut="lolite()" onClick="logVariable('element')" href="../../_variables/element.html">$element</a> == 'meta' &amp;&amp; !isset( <a class="var it106" onMouseOver="hilite(106)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['content'] ) ) {
<a name="l661"><span class="linenum"> 661</span></a>  <span class="comment">                // &lt;meta&gt; must have a content=&quot;&quot; for the itemprop</span>
<a name="l662"><span class="linenum"> 662</span></a>                  return false;
<a name="l663"><span class="linenum"> 663</span></a>              }
<a name="l664"><span class="linenum"> 664</span></a>              if ( <a class="var it904" onMouseOver="hilite(904)" onMouseOut="lolite()" onClick="logVariable('element')" href="../../_variables/element.html">$element</a> == 'link' &amp;&amp; !isset( <a class="var it106" onMouseOver="hilite(106)" onMouseOut="lolite()" onClick="logVariable('params')" href="../../_variables/params.html">$params</a>['href'] ) ) {
<a name="l665"><span class="linenum"> 665</span></a>  <span class="comment">                // &lt;link&gt; must have an associated href=&quot;&quot;</span>
<a name="l666"><span class="linenum"> 666</span></a>                  return false;
<a name="l667"><span class="linenum"> 667</span></a>              }
<a name="l668"><span class="linenum"> 668</span></a>          }
<a name="l669"><span class="linenum"> 669</span></a>  
<a name="l670"><span class="linenum"> 670</span></a>          return true;
<a name="l671"><span class="linenum"> 671</span></a>      }
<a name="l672"><span class="linenum"> 672</span></a>  
<a name="l673"><span class="linenum"> 673</span></a>      <span class="comment">/**</span>
<a name="l674"><span class="linenum"> 674</span></a>  <span class="comment">     * Take an array of attribute names and values and normalize or discard</span>
<a name="l675"><span class="linenum"> 675</span></a>  <span class="comment">     * illegal values for the given element type.</span>
<a name="l676"><span class="linenum"> 676</span></a>  <span class="comment">     *</span>
<a name="l677"><span class="linenum"> 677</span></a>  <span class="comment">     * - Discards attributes not on a whitelist for the given element</span>
<a name="l678"><span class="linenum"> 678</span></a>  <span class="comment">     * - Unsafe style attributes are discarded</span>
<a name="l679"><span class="linenum"> 679</span></a>  <span class="comment">     * - Invalid id attributes are re-encoded</span>
<a name="l680"><span class="linenum"> 680</span></a>  <span class="comment">     *</span>
<a name="l681"><span class="linenum"> 681</span></a>  <span class="comment">     * @param $attribs Array</span>
<a name="l682"><span class="linenum"> 682</span></a>  <span class="comment">     * @param $element String</span>
<a name="l683"><span class="linenum"> 683</span></a>  <span class="comment">     * @return Array</span>
<a name="l684"><span class="linenum"> 684</span></a>  <span class="comment">     *</span>
<a name="l685"><span class="linenum"> 685</span></a>  <span class="comment">     * @todo Check for legal values where the DTD limits things.</span>
<a name="l686"><span class="linenum"> 686</span></a>  <span class="comment">     * @todo Check for unique id attribute :P</span>
<a name="l687"><span class="linenum"> 687</span></a>  <span class="comment">     */</span>
<a name="l688"><span class="linenum"> 688</span></a>  	static function <a class="function" onClick="logFunction('validateTagAttributes')" href="../../_functions/validatetagattributes.html" onMouseOver="funcPopup(event,'validatetagattributes')">validateTagAttributes</a>( <a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('attribs')" href="../../_variables/attribs.html">$attribs</a>, <a class="var it904" onMouseOver="hilite(904)" onMouseOut="lolite()" onClick="logVariable('element')" href="../../_variables/element.html">$element</a> ) {
<a name="l689"><span class="linenum"> 689</span></a>          return <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('validateAttributes')" href="../../_functions/validateattributes.html" onMouseOver="funcPopup(event,'validateattributes')">validateAttributes</a>( <a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('attribs')" href="../../_variables/attribs.html">$attribs</a>,
<a name="l690"><span class="linenum"> 690</span></a>              <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('attributeWhitelist')" href="../../_functions/attributewhitelist.html" onMouseOver="funcPopup(event,'attributewhitelist')">attributeWhitelist</a>( <a class="var it904" onMouseOver="hilite(904)" onMouseOut="lolite()" onClick="logVariable('element')" href="../../_variables/element.html">$element</a> ) );
<a name="l691"><span class="linenum"> 691</span></a>      }
<a name="l692"><span class="linenum"> 692</span></a>  
<a name="l693"><span class="linenum"> 693</span></a>      <span class="comment">/**</span>
<a name="l694"><span class="linenum"> 694</span></a>  <span class="comment">     * Take an array of attribute names and values and normalize or discard</span>
<a name="l695"><span class="linenum"> 695</span></a>  <span class="comment">     * illegal values for the given whitelist.</span>
<a name="l696"><span class="linenum"> 696</span></a>  <span class="comment">     *</span>
<a name="l697"><span class="linenum"> 697</span></a>  <span class="comment">     * - Discards attributes not the given whitelist</span>
<a name="l698"><span class="linenum"> 698</span></a>  <span class="comment">     * - Unsafe style attributes are discarded</span>
<a name="l699"><span class="linenum"> 699</span></a>  <span class="comment">     * - Invalid id attributes are re-encoded</span>
<a name="l700"><span class="linenum"> 700</span></a>  <span class="comment">     *</span>
<a name="l701"><span class="linenum"> 701</span></a>  <span class="comment">     * @param $attribs Array</span>
<a name="l702"><span class="linenum"> 702</span></a>  <span class="comment">     * @param array $whitelist list of allowed attribute names</span>
<a name="l703"><span class="linenum"> 703</span></a>  <span class="comment">     * @return Array</span>
<a name="l704"><span class="linenum"> 704</span></a>  <span class="comment">     *</span>
<a name="l705"><span class="linenum"> 705</span></a>  <span class="comment">     * @todo Check for legal values where the DTD limits things.</span>
<a name="l706"><span class="linenum"> 706</span></a>  <span class="comment">     * @todo Check for unique id attribute :P</span>
<a name="l707"><span class="linenum"> 707</span></a>  <span class="comment">     */</span>
<a name="l708"><span class="linenum"> 708</span></a>  	static function <a class="function" onClick="logFunction('validateAttributes')" href="../../_functions/validateattributes.html" onMouseOver="funcPopup(event,'validateattributes')">validateAttributes</a>( <a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('attribs')" href="../../_variables/attribs.html">$attribs</a>, <a class="var it6254" onMouseOver="hilite(6254)" onMouseOut="lolite()" onClick="logVariable('whitelist')" href="../../_variables/whitelist.html">$whitelist</a> ) {
<a name="l709"><span class="linenum"> 709</span></a>          global <a class="var it7423" onMouseOver="hilite(7423)" onMouseOut="lolite()" onClick="logVariable('wgAllowRdfaAttributes')" href="../../_variables/wgAllowRdfaAttributes.html">$wgAllowRdfaAttributes</a>, <a class="var it7397" onMouseOver="hilite(7397)" onMouseOut="lolite()" onClick="logVariable('wgAllowMicrodataAttributes')" href="../../_variables/wgAllowMicrodataAttributes.html">$wgAllowMicrodataAttributes</a>, <a class="var it7396" onMouseOver="hilite(7396)" onMouseOut="lolite()" onClick="logVariable('wgHtml5')" href="../../_variables/wgHtml5.html">$wgHtml5</a>;
<a name="l710"><span class="linenum"> 710</span></a>  
<a name="l711"><span class="linenum"> 711</span></a>          <a class="var it6254" onMouseOver="hilite(6254)" onMouseOut="lolite()" onClick="logVariable('whitelist')" href="../../_variables/whitelist.html">$whitelist</a> = <a class="phpfunction" onClick="logFunction('array_flip')" href="../../_functions/array_flip.html" onMouseOver="phpfuncPopup(event,'array_flip')">array_flip</a>( <a class="var it6254" onMouseOver="hilite(6254)" onMouseOut="lolite()" onClick="logVariable('whitelist')" href="../../_variables/whitelist.html">$whitelist</a> );
<a name="l712"><span class="linenum"> 712</span></a>          <a class="var it7424" onMouseOver="hilite(7424)" onMouseOut="lolite()" onClick="logVariable('hrefExp')" href="../../_variables/hrefExp.html">$hrefExp</a> = '/^(https?)[^\s]+$/';
<a name="l713"><span class="linenum"> 713</span></a>  
<a name="l714"><span class="linenum"> 714</span></a>          <a class="var it283" onMouseOver="hilite(283)" onMouseOut="lolite()" onClick="logVariable('out')" href="../../_variables/out.html">$out</a> = array();
<a name="l715"><span class="linenum"> 715</span></a>          foreach( <a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('attribs')" href="../../_variables/attribs.html">$attribs</a> as <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> =&gt; <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> ) {
<a name="l716"><span class="linenum"> 716</span></a>  <span class="comment">            #allow XML namespace declaration if RDFa is enabled</span>
<a name="l717"><span class="linenum"> 717</span></a>              if ( <a class="var it7423" onMouseOver="hilite(7423)" onMouseOut="lolite()" onClick="logVariable('wgAllowRdfaAttributes')" href="../../_variables/wgAllowRdfaAttributes.html">$wgAllowRdfaAttributes</a> &amp;&amp; <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>( self::XMLNS_ATTRIBUTE_PATTERN, <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> ) ) {
<a name="l718"><span class="linenum"> 718</span></a>                  if ( !<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>( self::EVIL_URI_PATTERN, <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> ) ) {
<a name="l719"><span class="linenum"> 719</span></a>                      <a class="var it283" onMouseOver="hilite(283)" onMouseOut="lolite()" onClick="logVariable('out')" href="../../_variables/out.html">$out</a>[<a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a>] = <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l720"><span class="linenum"> 720</span></a>                  }
<a name="l721"><span class="linenum"> 721</span></a>  
<a name="l722"><span class="linenum"> 722</span></a>                  continue;
<a name="l723"><span class="linenum"> 723</span></a>              }
<a name="l724"><span class="linenum"> 724</span></a>  
<a name="l725"><span class="linenum"> 725</span></a>  <span class="comment">            # Allow any attribute beginning with &quot;data-&quot;, if in HTML5 mode</span>
<a name="l726"><span class="linenum"> 726</span></a>              if ( !(<a class="var it7396" onMouseOver="hilite(7396)" onMouseOut="lolite()" onClick="logVariable('wgHtml5')" href="../../_variables/wgHtml5.html">$wgHtml5</a> &amp;&amp; <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>( '/^data-/i', <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> )) &amp;&amp; !isset( <a class="var it6254" onMouseOver="hilite(6254)" onMouseOut="lolite()" onClick="logVariable('whitelist')" href="../../_variables/whitelist.html">$whitelist</a>[<a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a>] ) ) {
<a name="l727"><span class="linenum"> 727</span></a>                  continue;
<a name="l728"><span class="linenum"> 728</span></a>              }
<a name="l729"><span class="linenum"> 729</span></a>  
<a name="l730"><span class="linenum"> 730</span></a>  <span class="comment">            # Strip javascript &quot;expression&quot; from stylesheets.</span>
<a name="l731"><span class="linenum"> 731</span></a>  <span class="comment">            # http://msdn.microsoft.com/workshop/author/dhtml/overview/recalc.asp</span>
<a name="l732"><span class="linenum"> 732</span></a>              if( <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> == 'style' ) {
<a name="l733"><span class="linenum"> 733</span></a>                  <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('checkCss')" href="../../_functions/checkcss.html" onMouseOver="funcPopup(event,'checkcss')">checkCss</a>( <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> );
<a name="l734"><span class="linenum"> 734</span></a>              }
<a name="l735"><span class="linenum"> 735</span></a>  
<a name="l736"><span class="linenum"> 736</span></a>              if ( <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> === 'id' ) {
<a name="l737"><span class="linenum"> 737</span></a>                  <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('escapeId')" href="../../_functions/escapeid.html" onMouseOver="funcPopup(event,'escapeid')">escapeId</a>( <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>, 'noninitial' );
<a name="l738"><span class="linenum"> 738</span></a>              }
<a name="l739"><span class="linenum"> 739</span></a>  
<a name="l740"><span class="linenum"> 740</span></a>  <span class="comment">            # WAI-ARIA</span>
<a name="l741"><span class="linenum"> 741</span></a>  <span class="comment">            # http://www.w3.org/TR/wai-aria/</span>
<a name="l742"><span class="linenum"> 742</span></a>  <span class="comment">            # http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#wai-aria</span>
<a name="l743"><span class="linenum"> 743</span></a>  <span class="comment">            # For now we only support role=&quot;presentation&quot; until we work out what roles should be</span>
<a name="l744"><span class="linenum"> 744</span></a>  <span class="comment">            # usable by content and we ensure that our code explicitly rejects patterns that</span>
<a name="l745"><span class="linenum"> 745</span></a>  <span class="comment">            # violate HTML5's ARIA restrictions.</span>
<a name="l746"><span class="linenum"> 746</span></a>              if ( <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> === 'role' &amp;&amp; <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> !== 'presentation' ) {
<a name="l747"><span class="linenum"> 747</span></a>                  continue;
<a name="l748"><span class="linenum"> 748</span></a>              }
<a name="l749"><span class="linenum"> 749</span></a>  
<a name="l750"><span class="linenum"> 750</span></a>  <span class="comment">            //RDFa and microdata properties allow URLs, URIs and/or CURIs. check them for sanity</span>
<a name="l751"><span class="linenum"> 751</span></a>              if ( <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> === 'rel' || <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> === 'rev' ||
<a name="l752"><span class="linenum"> 752</span></a>                  <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> === 'about' || <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> === 'property' || <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> === 'resource' || #RDFa
<a name="l753"><span class="linenum"> 753</span></a>                  <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> === 'datatype' || <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> === 'typeof' ||                             #RDFa
<a name="l754"><span class="linenum"> 754</span></a>                  <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> === 'itemid' || <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> === 'itemprop' || <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> === 'itemref' || #HTML5 microdata
<a name="l755"><span class="linenum"> 755</span></a>                  <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> === 'itemscope' || <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> === 'itemtype' ) {                         #HTML5 microdata
<a name="l756"><span class="linenum"> 756</span></a>  
<a name="l757"><span class="linenum"> 757</span></a>  <span class="comment">                //Paranoia. Allow &quot;simple&quot; values but suppress javascript</span>
<a name="l758"><span class="linenum"> 758</span></a>                  if ( <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>( self::EVIL_URI_PATTERN, <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> ) ) {
<a name="l759"><span class="linenum"> 759</span></a>                      continue;
<a name="l760"><span class="linenum"> 760</span></a>                  }
<a name="l761"><span class="linenum"> 761</span></a>              }
<a name="l762"><span class="linenum"> 762</span></a>  
<a name="l763"><span class="linenum"> 763</span></a>  <span class="comment">            # NOTE: even though elements using href/src are not allowed directly, supply</span>
<a name="l764"><span class="linenum"> 764</span></a>  <span class="comment">            #       validation code that can be used by tag hook handlers, etc</span>
<a name="l765"><span class="linenum"> 765</span></a>              if ( <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> === 'href' || <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> === 'src' ) {
<a name="l766"><span class="linenum"> 766</span></a>                  if ( !<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>( <a class="var it7424" onMouseOver="hilite(7424)" onMouseOut="lolite()" onClick="logVariable('hrefExp')" href="../../_variables/hrefExp.html">$hrefExp</a>, <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> ) ) {
<a name="l767"><span class="linenum"> 767</span></a>                      continue; <span class="comment">//drop any href or src attributes not using an allowed protocol.</span>
<a name="l768"><span class="linenum"> 768</span></a>  <span class="comment">                          //NOTE: this also drops all relative URLs</span>
<a name="l769"><span class="linenum"> 769</span></a>                  }
<a name="l770"><span class="linenum"> 770</span></a>              }
<a name="l771"><span class="linenum"> 771</span></a>  
<a name="l772"><span class="linenum"> 772</span></a>  <span class="comment">            // If this attribute was previously set, override it.</span>
<a name="l773"><span class="linenum"> 773</span></a>  <span class="comment">            // Output should only have one attribute of each name.</span>
<a name="l774"><span class="linenum"> 774</span></a>              <a class="var it283" onMouseOver="hilite(283)" onMouseOut="lolite()" onClick="logVariable('out')" href="../../_variables/out.html">$out</a>[<a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a>] = <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l775"><span class="linenum"> 775</span></a>          }
<a name="l776"><span class="linenum"> 776</span></a>  
<a name="l777"><span class="linenum"> 777</span></a>          if ( <a class="var it7397" onMouseOver="hilite(7397)" onMouseOut="lolite()" onClick="logVariable('wgAllowMicrodataAttributes')" href="../../_variables/wgAllowMicrodataAttributes.html">$wgAllowMicrodataAttributes</a> ) {
<a name="l778"><span class="linenum"> 778</span></a>  <span class="comment">            # itemtype, itemid, itemref don't make sense without itemscope</span>
<a name="l779"><span class="linenum"> 779</span></a>              if ( !<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>( 'itemscope', <a class="var it283" onMouseOver="hilite(283)" onMouseOut="lolite()" onClick="logVariable('out')" href="../../_variables/out.html">$out</a> ) ) {
<a name="l780"><span class="linenum"> 780</span></a>                  unset( <a class="var it283" onMouseOver="hilite(283)" onMouseOut="lolite()" onClick="logVariable('out')" href="../../_variables/out.html">$out</a>['itemtype'] );
<a name="l781"><span class="linenum"> 781</span></a>                  unset( <a class="var it283" onMouseOver="hilite(283)" onMouseOut="lolite()" onClick="logVariable('out')" href="../../_variables/out.html">$out</a>['itemid'] );
<a name="l782"><span class="linenum"> 782</span></a>                  unset( <a class="var it283" onMouseOver="hilite(283)" onMouseOut="lolite()" onClick="logVariable('out')" href="../../_variables/out.html">$out</a>['itemref'] );
<a name="l783"><span class="linenum"> 783</span></a>              }
<a name="l784"><span class="linenum"> 784</span></a>  <span class="comment">            # TODO: Strip itemprop if we aren't descendants of an itemscope or pointed to by an itemref.</span>
<a name="l785"><span class="linenum"> 785</span></a>          }
<a name="l786"><span class="linenum"> 786</span></a>          return <a class="var it283" onMouseOver="hilite(283)" onMouseOut="lolite()" onClick="logVariable('out')" href="../../_variables/out.html">$out</a>;
<a name="l787"><span class="linenum"> 787</span></a>      }
<a name="l788"><span class="linenum"> 788</span></a>  
<a name="l789"><span class="linenum"> 789</span></a>      <span class="comment">/**</span>
<a name="l790"><span class="linenum"> 790</span></a>  <span class="comment">     * Merge two sets of HTML attributes.  Conflicting items in the second set</span>
<a name="l791"><span class="linenum"> 791</span></a>  <span class="comment">     * will override those in the first, except for 'class' attributes which</span>
<a name="l792"><span class="linenum"> 792</span></a>  <span class="comment">     * will be combined (if they're both strings).</span>
<a name="l793"><span class="linenum"> 793</span></a>  <span class="comment">     *</span>
<a name="l794"><span class="linenum"> 794</span></a>  <span class="comment">     * @todo implement merging for other attributes such as style</span>
<a name="l795"><span class="linenum"> 795</span></a>  <span class="comment">     * @param $a Array</span>
<a name="l796"><span class="linenum"> 796</span></a>  <span class="comment">     * @param $b Array</span>
<a name="l797"><span class="linenum"> 797</span></a>  <span class="comment">     * @return array</span>
<a name="l798"><span class="linenum"> 798</span></a>  <span class="comment">     */</span>
<a name="l799"><span class="linenum"> 799</span></a>  	static function <a class="function" onClick="logFunction('mergeAttributes')" href="../../_functions/mergeattributes.html" onMouseOver="funcPopup(event,'mergeattributes')">mergeAttributes</a>( <a class="var it2085" onMouseOver="hilite(2085)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>, <a class="var it2086" onMouseOver="hilite(2086)" onMouseOut="lolite()" onClick="logVariable('b')" href="../../_variables/b.html">$b</a> ) {
<a name="l800"><span class="linenum"> 800</span></a>          <a class="var it283" onMouseOver="hilite(283)" onMouseOut="lolite()" onClick="logVariable('out')" href="../../_variables/out.html">$out</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it2085" onMouseOver="hilite(2085)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>, <a class="var it2086" onMouseOver="hilite(2086)" onMouseOut="lolite()" onClick="logVariable('b')" href="../../_variables/b.html">$b</a> );
<a name="l801"><span class="linenum"> 801</span></a>          if( isset( <a class="var it2085" onMouseOver="hilite(2085)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>['class'] ) &amp;&amp; isset( <a class="var it2086" onMouseOver="hilite(2086)" onMouseOut="lolite()" onClick="logVariable('b')" href="../../_variables/b.html">$b</a>['class'] )
<a name="l802"><span class="linenum"> 802</span></a>          &amp;&amp; <a class="phpfunction" onClick="logFunction('is_string')" href="../../_functions/is_string.html" onMouseOver="phpfuncPopup(event,'is_string')">is_string</a>( <a class="var it2085" onMouseOver="hilite(2085)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>['class'] ) &amp;&amp; <a class="phpfunction" onClick="logFunction('is_string')" href="../../_functions/is_string.html" onMouseOver="phpfuncPopup(event,'is_string')">is_string</a>( <a class="var it2086" onMouseOver="hilite(2086)" onMouseOut="lolite()" onClick="logVariable('b')" href="../../_variables/b.html">$b</a>['class'] )
<a name="l803"><span class="linenum"> 803</span></a>          &amp;&amp; <a class="var it2085" onMouseOver="hilite(2085)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>['class'] !== <a class="var it2086" onMouseOver="hilite(2086)" onMouseOut="lolite()" onClick="logVariable('b')" href="../../_variables/b.html">$b</a>['class'] ) {
<a name="l804"><span class="linenum"> 804</span></a>              <a class="var it1645" onMouseOver="hilite(1645)" onMouseOut="lolite()" onClick="logVariable('classes')" href="../../_variables/classes.html">$classes</a> = <a class="phpfunction" onClick="logFunction('preg_split')" href="../../_functions/preg_split.html" onMouseOver="phpfuncPopup(event,'preg_split')">preg_split</a>( '/\s+/', &quot;{<a class="var it2085" onMouseOver="hilite(2085)" onMouseOut="lolite()" onClick="logVariable('a')" href="../../_variables/a.html">$a</a>['class']} {<a class="var it2086" onMouseOver="hilite(2086)" onMouseOut="lolite()" onClick="logVariable('b')" href="../../_variables/b.html">$b</a>['class']}&quot;,
<a name="l805"><span class="linenum"> 805</span></a>                  -1, PREG_SPLIT_NO_EMPTY );
<a name="l806"><span class="linenum"> 806</span></a>              <a class="var it283" onMouseOver="hilite(283)" onMouseOut="lolite()" onClick="logVariable('out')" href="../../_variables/out.html">$out</a>['class'] = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( ' ', <a class="phpfunction" onClick="logFunction('array_unique')" href="../../_functions/array_unique.html" onMouseOver="phpfuncPopup(event,'array_unique')">array_unique</a>( <a class="var it1645" onMouseOver="hilite(1645)" onMouseOut="lolite()" onClick="logVariable('classes')" href="../../_variables/classes.html">$classes</a> ) );
<a name="l807"><span class="linenum"> 807</span></a>          }
<a name="l808"><span class="linenum"> 808</span></a>          return <a class="var it283" onMouseOver="hilite(283)" onMouseOut="lolite()" onClick="logVariable('out')" href="../../_variables/out.html">$out</a>;
<a name="l809"><span class="linenum"> 809</span></a>      }
<a name="l810"><span class="linenum"> 810</span></a>  
<a name="l811"><span class="linenum"> 811</span></a>      <span class="comment">/**</span>
<a name="l812"><span class="linenum"> 812</span></a>  <span class="comment">     * Pick apart some CSS and check it for forbidden or unsafe structures.</span>
<a name="l813"><span class="linenum"> 813</span></a>  <span class="comment">     * Returns a sanitized string. This sanitized string will have</span>
<a name="l814"><span class="linenum"> 814</span></a>  <span class="comment">     * character references and escape sequences decoded, and comments</span>
<a name="l815"><span class="linenum"> 815</span></a>  <span class="comment">     * stripped. If the input is just too evil, only a comment complaining</span>
<a name="l816"><span class="linenum"> 816</span></a>  <span class="comment">     * about evilness will be returned.</span>
<a name="l817"><span class="linenum"> 817</span></a>  <span class="comment">     *</span>
<a name="l818"><span class="linenum"> 818</span></a>  <span class="comment">     * Currently URL references, 'expression', 'tps' are forbidden.</span>
<a name="l819"><span class="linenum"> 819</span></a>  <span class="comment">     *</span>
<a name="l820"><span class="linenum"> 820</span></a>  <span class="comment">     * NOTE: Despite the fact that character references are decoded, the</span>
<a name="l821"><span class="linenum"> 821</span></a>  <span class="comment">     * returned string may contain character references given certain</span>
<a name="l822"><span class="linenum"> 822</span></a>  <span class="comment">     * clever input strings. These character references must</span>
<a name="l823"><span class="linenum"> 823</span></a>  <span class="comment">     * be escaped before the return value is embedded in HTML.</span>
<a name="l824"><span class="linenum"> 824</span></a>  <span class="comment">     *</span>
<a name="l825"><span class="linenum"> 825</span></a>  <span class="comment">     * @param $value String</span>
<a name="l826"><span class="linenum"> 826</span></a>  <span class="comment">     * @return String</span>
<a name="l827"><span class="linenum"> 827</span></a>  <span class="comment">     */</span>
<a name="l828"><span class="linenum"> 828</span></a>  	static function <a class="function" onClick="logFunction('checkCss')" href="../../_functions/checkcss.html" onMouseOver="funcPopup(event,'checkcss')">checkCss</a>( <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> ) {
<a name="l829"><span class="linenum"> 829</span></a>  <span class="comment">        // Decode character references like &amp;#123;</span>
<a name="l830"><span class="linenum"> 830</span></a>          <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('decodeCharReferences')" href="../../_functions/decodecharreferences.html" onMouseOver="funcPopup(event,'decodecharreferences')">decodeCharReferences</a>( <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> );
<a name="l831"><span class="linenum"> 831</span></a>  
<a name="l832"><span class="linenum"> 832</span></a>  <span class="comment">        // Decode escape sequences and line continuation</span>
<a name="l833"><span class="linenum"> 833</span></a>  <span class="comment">        // See the grammar in the CSS 2 spec, appendix D.</span>
<a name="l834"><span class="linenum"> 834</span></a>  <span class="comment">        // This has to be done AFTER decoding character references.</span>
<a name="l835"><span class="linenum"> 835</span></a>  <span class="comment">        // This means it isn't possible for this function to return</span>
<a name="l836"><span class="linenum"> 836</span></a>  <span class="comment">        // unsanitized escape sequences. It is possible to manufacture</span>
<a name="l837"><span class="linenum"> 837</span></a>  <span class="comment">        // input that contains character references that decode to</span>
<a name="l838"><span class="linenum"> 838</span></a>  <span class="comment">        // escape sequences that decode to character references, but</span>
<a name="l839"><span class="linenum"> 839</span></a>  <span class="comment">        // it's OK for the return value to contain character references</span>
<a name="l840"><span class="linenum"> 840</span></a>  <span class="comment">        // because the caller is supposed to escape those anyway.</span>
<a name="l841"><span class="linenum"> 841</span></a>          static <a class="var it7426" onMouseOver="hilite(7426)" onMouseOut="lolite()" onClick="logVariable('decodeRegex')" href="../../_variables/decodeRegex.html">$decodeRegex</a>;
<a name="l842"><span class="linenum"> 842</span></a>          if ( !<a class="var it7426" onMouseOver="hilite(7426)" onMouseOut="lolite()" onClick="logVariable('decodeRegex')" href="../../_variables/decodeRegex.html">$decodeRegex</a> ) {
<a name="l843"><span class="linenum"> 843</span></a>              <a class="var it4798" onMouseOver="hilite(4798)" onMouseOut="lolite()" onClick="logVariable('space')" href="../../_variables/space.html">$space</a> = '[\\x20\\t\\r\\n\\f]';
<a name="l844"><span class="linenum"> 844</span></a>              <a class="var it1289" onMouseOver="hilite(1289)" onMouseOut="lolite()" onClick="logVariable('nl')" href="../../_variables/nl.html">$nl</a> = '(?:\\n|\\r\\n|\\r|\\f)';
<a name="l845"><span class="linenum"> 845</span></a>              <a class="var it7427" onMouseOver="hilite(7427)" onMouseOut="lolite()" onClick="logVariable('backslash')" href="../../_variables/backslash.html">$backslash</a> = '\\\\';
<a name="l846"><span class="linenum"> 846</span></a>              <a class="var it7426" onMouseOver="hilite(7426)" onMouseOut="lolite()" onClick="logVariable('decodeRegex')" href="../../_variables/decodeRegex.html">$decodeRegex</a> = &quot;/ <a class="var it7427" onMouseOver="hilite(7427)" onMouseOut="lolite()" onClick="logVariable('backslash')" href="../../_variables/backslash.html">$backslash</a>
<a name="l847"><span class="linenum"> 847</span></a>                  (?:
<a name="l848"><span class="linenum"> 848</span></a>                      (<a class="var it1289" onMouseOver="hilite(1289)" onMouseOut="lolite()" onClick="logVariable('nl')" href="../../_variables/nl.html">$nl</a>) |  # 1. Line continuation
<a name="l849"><span class="linenum"> 849</span></a>                      ([0-9A-Fa-f]{1,6})<a class="var it4798" onMouseOver="hilite(4798)" onMouseOut="lolite()" onClick="logVariable('space')" href="../../_variables/space.html">$space</a>? |  # 2. character number
<a name="l850"><span class="linenum"> 850</span></a>                      (.) | # 3. backslash cancelling special meaning
<a name="l851"><span class="linenum"> 851</span></a>                      () | # 4. backslash at end of string
<a name="l852"><span class="linenum"> 852</span></a>                  )/xu&quot;;
<a name="l853"><span class="linenum"> 853</span></a>          }
<a name="l854"><span class="linenum"> 854</span></a>          <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>( <a class="var it7426" onMouseOver="hilite(7426)" onMouseOut="lolite()" onClick="logVariable('decodeRegex')" href="../../_variables/decodeRegex.html">$decodeRegex</a>,
<a name="l855"><span class="linenum"> 855</span></a>              array( __CLASS__, 'cssDecodeCallback' ), <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> );
<a name="l856"><span class="linenum"> 856</span></a>  
<a name="l857"><span class="linenum"> 857</span></a>  <span class="comment">        // Remove any comments; IE gets token splitting wrong</span>
<a name="l858"><span class="linenum"> 858</span></a>  <span class="comment">        // This must be done AFTER decoding character references and</span>
<a name="l859"><span class="linenum"> 859</span></a>  <span class="comment">        // escape sequences, because those steps can introduce comments</span>
<a name="l860"><span class="linenum"> 860</span></a>  <span class="comment">        // This step cannot introduce character references or escape</span>
<a name="l861"><span class="linenum"> 861</span></a>  <span class="comment">        // sequences, because it replaces comments with spaces rather</span>
<a name="l862"><span class="linenum"> 862</span></a>  <span class="comment">        // than removing them completely.</span>
<a name="l863"><span class="linenum"> 863</span></a>          <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="class" onClick="logClass('StringUtils')" href="../../_classes/stringutils.html" onMouseOver="classPopup(event,'stringutils')">StringUtils</a>::<a class="function" onClick="logFunction('delimiterReplace')" href="../../_functions/delimiterreplace.html" onMouseOver="funcPopup(event,'delimiterreplace')">delimiterReplace</a>( '<span class="comment">/*', '*/</span>', ' ', <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> );
<a name="l864"><span class="linenum"> 864</span></a>  
<a name="l865"><span class="linenum"> 865</span></a>  <span class="comment">        // Remove anything after a comment-start token, to guard against</span>
<a name="l866"><span class="linenum"> 866</span></a>  <span class="comment">        // incorrect client implementations.</span>
<a name="l867"><span class="linenum"> 867</span></a>          <a class="var it7428" onMouseOver="hilite(7428)" onMouseOut="lolite()" onClick="logVariable('commentPos')" href="../../_variables/commentPos.html">$commentPos</a> = <a class="phpfunction" onClick="logFunction('strpos')" href="../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>( <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>, '<span class="comment">/*' );</span>
<a name="l868"><span class="linenum"> 868</span></a>  <span class="comment">        if ( $commentPos !== false ) {</span>
<a name="l869"><span class="linenum"> 869</span></a>  <span class="comment">            $value = substr( $value, 0, $commentPos );</span>
<a name="l870"><span class="linenum"> 870</span></a>  <span class="comment">        }</span>
<a name="l871"><span class="linenum"> 871</span></a>  <span class="comment"></span>
<a name="l872"><span class="linenum"> 872</span></a>  <span class="comment">        // Reject problematic keywords and control characters</span>
<a name="l873"><span class="linenum"> 873</span></a>  <span class="comment">        if ( preg_match( '/[\000-\010\016-\037\177]/', $value ) ) {</span>
<a name="l874"><span class="linenum"> 874</span></a>  <span class="comment">            return '/* invalid control char */</span>';
<a name="l875"><span class="linenum"> 875</span></a>          } elseif ( <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>( '! expression | filter\s*: | accelerator\s*: | url\s*\( | image\s*\( | image-set\s*\( !ix', <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> ) ) {
<a name="l876"><span class="linenum"> 876</span></a>              return '<span class="comment">/* insecure input */</span>';
<a name="l877"><span class="linenum"> 877</span></a>          }
<a name="l878"><span class="linenum"> 878</span></a>          return <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a>;
<a name="l879"><span class="linenum"> 879</span></a>      }
<a name="l880"><span class="linenum"> 880</span></a>  
<a name="l881"><span class="linenum"> 881</span></a>      <span class="comment">/**</span>
<a name="l882"><span class="linenum"> 882</span></a>  <span class="comment">     * @param $matches array</span>
<a name="l883"><span class="linenum"> 883</span></a>  <span class="comment">     * @return String</span>
<a name="l884"><span class="linenum"> 884</span></a>  <span class="comment">     */</span>
<a name="l885"><span class="linenum"> 885</span></a>  	static function <a class="function" onClick="logFunction('cssDecodeCallback')" href="../../_functions/cssdecodecallback.html" onMouseOver="funcPopup(event,'cssdecodecallback')">cssDecodeCallback</a>( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a> ) {
<a name="l886"><span class="linenum"> 886</span></a>          if ( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1] !== '' ) {
<a name="l887"><span class="linenum"> 887</span></a>  <span class="comment">            // Line continuation</span>
<a name="l888"><span class="linenum"> 888</span></a>              return '';
<a name="l889"><span class="linenum"> 889</span></a>          } elseif ( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2] !== '' ) {
<a name="l890"><span class="linenum"> 890</span></a>              <a class="var it262" onMouseOver="hilite(262)" onMouseOut="lolite()" onClick="logVariable('char')" href="../../_variables/char.html">$char</a> = <a class="function" onClick="logFunction('codepointToUtf8')" href="../../_functions/codepointtoutf8.html" onMouseOver="funcPopup(event,'codepointtoutf8')">codepointToUtf8</a>( <a class="phpfunction" onClick="logFunction('hexdec')" href="../../_functions/hexdec.html" onMouseOver="phpfuncPopup(event,'hexdec')">hexdec</a>( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2] ) );
<a name="l891"><span class="linenum"> 891</span></a>          } elseif ( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[3] !== '' ) {
<a name="l892"><span class="linenum"> 892</span></a>              <a class="var it262" onMouseOver="hilite(262)" onMouseOut="lolite()" onClick="logVariable('char')" href="../../_variables/char.html">$char</a> = <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[3];
<a name="l893"><span class="linenum"> 893</span></a>          } else {
<a name="l894"><span class="linenum"> 894</span></a>              <a class="var it262" onMouseOver="hilite(262)" onMouseOut="lolite()" onClick="logVariable('char')" href="../../_variables/char.html">$char</a> = '\\';
<a name="l895"><span class="linenum"> 895</span></a>          }
<a name="l896"><span class="linenum"> 896</span></a>          if ( <a class="var it262" onMouseOver="hilite(262)" onMouseOut="lolite()" onClick="logVariable('char')" href="../../_variables/char.html">$char</a> == &quot;\n&quot; || <a class="var it262" onMouseOver="hilite(262)" onMouseOut="lolite()" onClick="logVariable('char')" href="../../_variables/char.html">$char</a> == '&quot;' || <a class="var it262" onMouseOver="hilite(262)" onMouseOut="lolite()" onClick="logVariable('char')" href="../../_variables/char.html">$char</a> == &quot;'&quot; || <a class="var it262" onMouseOver="hilite(262)" onMouseOut="lolite()" onClick="logVariable('char')" href="../../_variables/char.html">$char</a> == '\\' ) {
<a name="l897"><span class="linenum"> 897</span></a>  <span class="comment">            // These characters need to be escaped in strings</span>
<a name="l898"><span class="linenum"> 898</span></a>  <span class="comment">            // Clean up the escape sequence to avoid parsing errors by clients</span>
<a name="l899"><span class="linenum"> 899</span></a>              return '\\' . <a class="phpfunction" onClick="logFunction('dechex')" href="../../_functions/dechex.html" onMouseOver="phpfuncPopup(event,'dechex')">dechex</a>( <a class="phpfunction" onClick="logFunction('ord')" href="../../_functions/ord.html" onMouseOver="phpfuncPopup(event,'ord')">ord</a>( <a class="var it262" onMouseOver="hilite(262)" onMouseOut="lolite()" onClick="logVariable('char')" href="../../_variables/char.html">$char</a> ) ) . ' ';
<a name="l900"><span class="linenum"> 900</span></a>          } else {
<a name="l901"><span class="linenum"> 901</span></a>  <span class="comment">            // Decode unnecessary escape</span>
<a name="l902"><span class="linenum"> 902</span></a>              return <a class="var it262" onMouseOver="hilite(262)" onMouseOut="lolite()" onClick="logVariable('char')" href="../../_variables/char.html">$char</a>;
<a name="l903"><span class="linenum"> 903</span></a>          }
<a name="l904"><span class="linenum"> 904</span></a>      }
<a name="l905"><span class="linenum"> 905</span></a>  
<a name="l906"><span class="linenum"> 906</span></a>      <span class="comment">/**</span>
<a name="l907"><span class="linenum"> 907</span></a>  <span class="comment">     * Take a tag soup fragment listing an HTML element's attributes</span>
<a name="l908"><span class="linenum"> 908</span></a>  <span class="comment">     * and normalize it to well-formed XML, discarding unwanted attributes.</span>
<a name="l909"><span class="linenum"> 909</span></a>  <span class="comment">     * Output is safe for further wikitext processing, with escaping of</span>
<a name="l910"><span class="linenum"> 910</span></a>  <span class="comment">     * values that could trigger problems.</span>
<a name="l911"><span class="linenum"> 911</span></a>  <span class="comment">     *</span>
<a name="l912"><span class="linenum"> 912</span></a>  <span class="comment">     * - Normalizes attribute names to lowercase</span>
<a name="l913"><span class="linenum"> 913</span></a>  <span class="comment">     * - Discards attributes not on a whitelist for the given element</span>
<a name="l914"><span class="linenum"> 914</span></a>  <span class="comment">     * - Turns broken or invalid entities into plaintext</span>
<a name="l915"><span class="linenum"> 915</span></a>  <span class="comment">     * - Double-quotes all attribute values</span>
<a name="l916"><span class="linenum"> 916</span></a>  <span class="comment">     * - Attributes without values are given the name as attribute</span>
<a name="l917"><span class="linenum"> 917</span></a>  <span class="comment">     * - Double attributes are discarded</span>
<a name="l918"><span class="linenum"> 918</span></a>  <span class="comment">     * - Unsafe style attributes are discarded</span>
<a name="l919"><span class="linenum"> 919</span></a>  <span class="comment">     * - Prepends space if there are attributes.</span>
<a name="l920"><span class="linenum"> 920</span></a>  <span class="comment">     *</span>
<a name="l921"><span class="linenum"> 921</span></a>  <span class="comment">     * @param $text String</span>
<a name="l922"><span class="linenum"> 922</span></a>  <span class="comment">     * @param $element String</span>
<a name="l923"><span class="linenum"> 923</span></a>  <span class="comment">     * @return String</span>
<a name="l924"><span class="linenum"> 924</span></a>  <span class="comment">     */</span>
<a name="l925"><span class="linenum"> 925</span></a>  	static function <a class="function" onClick="logFunction('fixTagAttributes')" href="../../_functions/fixtagattributes.html" onMouseOver="funcPopup(event,'fixtagattributes')">fixTagAttributes</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, <a class="var it904" onMouseOver="hilite(904)" onMouseOut="lolite()" onClick="logVariable('element')" href="../../_variables/element.html">$element</a> ) {
<a name="l926"><span class="linenum"> 926</span></a>          if( <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> ) == '' ) {
<a name="l927"><span class="linenum"> 927</span></a>              return '';
<a name="l928"><span class="linenum"> 928</span></a>          }
<a name="l929"><span class="linenum"> 929</span></a>  
<a name="l930"><span class="linenum"> 930</span></a>          <a class="var it251" onMouseOver="hilite(251)" onMouseOut="lolite()" onClick="logVariable('decoded')" href="../../_variables/decoded.html">$decoded</a> = <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('decodeTagAttributes')" href="../../_functions/decodetagattributes.html" onMouseOver="funcPopup(event,'decodetagattributes')">decodeTagAttributes</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> );
<a name="l931"><span class="linenum"> 931</span></a>          <a class="var it727" onMouseOver="hilite(727)" onMouseOut="lolite()" onClick="logVariable('stripped')" href="../../_variables/stripped.html">$stripped</a> = <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('validateTagAttributes')" href="../../_functions/validatetagattributes.html" onMouseOver="funcPopup(event,'validatetagattributes')">validateTagAttributes</a>( <a class="var it251" onMouseOver="hilite(251)" onMouseOut="lolite()" onClick="logVariable('decoded')" href="../../_variables/decoded.html">$decoded</a>, <a class="var it904" onMouseOver="hilite(904)" onMouseOut="lolite()" onClick="logVariable('element')" href="../../_variables/element.html">$element</a> );
<a name="l932"><span class="linenum"> 932</span></a>  
<a name="l933"><span class="linenum"> 933</span></a>          <a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('attribs')" href="../../_variables/attribs.html">$attribs</a> = array();
<a name="l934"><span class="linenum"> 934</span></a>          foreach( <a class="var it727" onMouseOver="hilite(727)" onMouseOut="lolite()" onClick="logVariable('stripped')" href="../../_variables/stripped.html">$stripped</a> as <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> =&gt; <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> ) {
<a name="l935"><span class="linenum"> 935</span></a>              <a class="var it7429" onMouseOver="hilite(7429)" onMouseOut="lolite()" onClick="logVariable('encAttribute')" href="../../_variables/encAttribute.html">$encAttribute</a> = <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>( <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> );
<a name="l936"><span class="linenum"> 936</span></a>              <a class="var it7430" onMouseOver="hilite(7430)" onMouseOut="lolite()" onClick="logVariable('encValue')" href="../../_variables/encValue.html">$encValue</a> = <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('safeEncodeAttribute')" href="../../_functions/safeencodeattribute.html" onMouseOver="funcPopup(event,'safeencodeattribute')">safeEncodeAttribute</a>( <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> );
<a name="l937"><span class="linenum"> 937</span></a>  
<a name="l938"><span class="linenum"> 938</span></a>              <a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('attribs')" href="../../_variables/attribs.html">$attribs</a>[] = &quot;<a class="var it7429" onMouseOver="hilite(7429)" onMouseOut="lolite()" onClick="logVariable('encAttribute')" href="../../_variables/encAttribute.html">$encAttribute</a>=\&quot;<a class="var it7430" onMouseOver="hilite(7430)" onMouseOut="lolite()" onClick="logVariable('encValue')" href="../../_variables/encValue.html">$encValue</a>\&quot;&quot;;
<a name="l939"><span class="linenum"> 939</span></a>          }
<a name="l940"><span class="linenum"> 940</span></a>          return <a class="phpfunction" onClick="logFunction('count')" href="../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>( <a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('attribs')" href="../../_variables/attribs.html">$attribs</a> ) ? ' ' . <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( ' ', <a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('attribs')" href="../../_variables/attribs.html">$attribs</a> ) : '';
<a name="l941"><span class="linenum"> 941</span></a>      }
<a name="l942"><span class="linenum"> 942</span></a>  
<a name="l943"><span class="linenum"> 943</span></a>      <span class="comment">/**</span>
<a name="l944"><span class="linenum"> 944</span></a>  <span class="comment">     * Encode an attribute value for HTML output.</span>
<a name="l945"><span class="linenum"> 945</span></a>  <span class="comment">     * @param $text String</span>
<a name="l946"><span class="linenum"> 946</span></a>  <span class="comment">     * @return HTML-encoded text fragment</span>
<a name="l947"><span class="linenum"> 947</span></a>  <span class="comment">     */</span>
<a name="l948"><span class="linenum"> 948</span></a>  	static function <a class="function" onClick="logFunction('encodeAttribute')" href="../../_functions/encodeattribute.html" onMouseOver="funcPopup(event,'encodeattribute')">encodeAttribute</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> ) {
<a name="l949"><span class="linenum"> 949</span></a>          <a class="var it7430" onMouseOver="hilite(7430)" onMouseOut="lolite()" onClick="logVariable('encValue')" href="../../_variables/encValue.html">$encValue</a> = <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, ENT_QUOTES );
<a name="l950"><span class="linenum"> 950</span></a>  
<a name="l951"><span class="linenum"> 951</span></a>  <span class="comment">        // Whitespace is normalized during attribute decoding,</span>
<a name="l952"><span class="linenum"> 952</span></a>  <span class="comment">        // so if we've been passed non-spaces we must encode them</span>
<a name="l953"><span class="linenum"> 953</span></a>  <span class="comment">        // ahead of time or they won't be preserved.</span>
<a name="l954"><span class="linenum"> 954</span></a>          <a class="var it7430" onMouseOver="hilite(7430)" onMouseOut="lolite()" onClick="logVariable('encValue')" href="../../_variables/encValue.html">$encValue</a> = <a class="phpfunction" onClick="logFunction('strtr')" href="../../_functions/strtr.html" onMouseOver="phpfuncPopup(event,'strtr')">strtr</a>( <a class="var it7430" onMouseOver="hilite(7430)" onMouseOut="lolite()" onClick="logVariable('encValue')" href="../../_variables/encValue.html">$encValue</a>, array(
<a name="l955"><span class="linenum"> 955</span></a>              &quot;\n&quot; =&gt; '&amp;#10;',
<a name="l956"><span class="linenum"> 956</span></a>              &quot;\r&quot; =&gt; '&amp;#13;',
<a name="l957"><span class="linenum"> 957</span></a>              &quot;\t&quot; =&gt; '&amp;#9;',
<a name="l958"><span class="linenum"> 958</span></a>          ) );
<a name="l959"><span class="linenum"> 959</span></a>  
<a name="l960"><span class="linenum"> 960</span></a>          return <a class="var it7430" onMouseOver="hilite(7430)" onMouseOut="lolite()" onClick="logVariable('encValue')" href="../../_variables/encValue.html">$encValue</a>;
<a name="l961"><span class="linenum"> 961</span></a>      }
<a name="l962"><span class="linenum"> 962</span></a>  
<a name="l963"><span class="linenum"> 963</span></a>      <span class="comment">/**</span>
<a name="l964"><span class="linenum"> 964</span></a>  <span class="comment">     * Encode an attribute value for HTML tags, with extra armoring</span>
<a name="l965"><span class="linenum"> 965</span></a>  <span class="comment">     * against further wiki processing.</span>
<a name="l966"><span class="linenum"> 966</span></a>  <span class="comment">     * @param $text String</span>
<a name="l967"><span class="linenum"> 967</span></a>  <span class="comment">     * @return HTML-encoded text fragment</span>
<a name="l968"><span class="linenum"> 968</span></a>  <span class="comment">     */</span>
<a name="l969"><span class="linenum"> 969</span></a>  	static function <a class="function" onClick="logFunction('safeEncodeAttribute')" href="../../_functions/safeencodeattribute.html" onMouseOver="funcPopup(event,'safeencodeattribute')">safeEncodeAttribute</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> ) {
<a name="l970"><span class="linenum"> 970</span></a>          <a class="var it7430" onMouseOver="hilite(7430)" onMouseOut="lolite()" onClick="logVariable('encValue')" href="../../_variables/encValue.html">$encValue</a> = <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('encodeAttribute')" href="../../_functions/encodeattribute.html" onMouseOver="funcPopup(event,'encodeattribute')">encodeAttribute</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> );
<a name="l971"><span class="linenum"> 971</span></a>  
<a name="l972"><span class="linenum"> 972</span></a>  <span class="comment">        # Templates and links may be expanded in later parsing,</span>
<a name="l973"><span class="linenum"> 973</span></a>  <span class="comment">        # creating invalid or dangerous output. Suppress this.</span>
<a name="l974"><span class="linenum"> 974</span></a>          <a class="var it7430" onMouseOver="hilite(7430)" onMouseOut="lolite()" onClick="logVariable('encValue')" href="../../_variables/encValue.html">$encValue</a> = <a class="phpfunction" onClick="logFunction('strtr')" href="../../_functions/strtr.html" onMouseOver="phpfuncPopup(event,'strtr')">strtr</a>( <a class="var it7430" onMouseOver="hilite(7430)" onMouseOut="lolite()" onClick="logVariable('encValue')" href="../../_variables/encValue.html">$encValue</a>, array(
<a name="l975"><span class="linenum"> 975</span></a>              '&lt;'    =&gt; '&amp;lt;',   // This should never happen,
<a name="l976"><span class="linenum"> 976</span></a>              '&gt;'    =&gt; '&amp;gt;',   // we've received invalid input
<a name="l977"><span class="linenum"> 977</span></a>              '&quot;'    =&gt; '&amp;quot;', // which should have been escaped.
<a name="l978"><span class="linenum"> 978</span></a>              '{'    =&gt; '&amp;#123;',
<a name="l979"><span class="linenum"> 979</span></a>              '['    =&gt; '&amp;#91;',
<a name="l980"><span class="linenum"> 980</span></a>              &quot;''&quot;   =&gt; '&amp;#39;&amp;#39;',
<a name="l981"><span class="linenum"> 981</span></a>              'ISBN' =&gt; '&amp;#73;SBN',
<a name="l982"><span class="linenum"> 982</span></a>              'RFC'  =&gt; '&amp;#82;FC',
<a name="l983"><span class="linenum"> 983</span></a>              'PMID' =&gt; '&amp;#80;MID',
<a name="l984"><span class="linenum"> 984</span></a>              '|'    =&gt; '&amp;#124;',
<a name="l985"><span class="linenum"> 985</span></a>              '__'   =&gt; '&amp;#95;_',
<a name="l986"><span class="linenum"> 986</span></a>          ) );
<a name="l987"><span class="linenum"> 987</span></a>  
<a name="l988"><span class="linenum"> 988</span></a>  <span class="comment">        # Stupid hack</span>
<a name="l989"><span class="linenum"> 989</span></a>          <a class="var it7430" onMouseOver="hilite(7430)" onMouseOut="lolite()" onClick="logVariable('encValue')" href="../../_variables/encValue.html">$encValue</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>(
<a name="l990"><span class="linenum"> 990</span></a>              '/((?i)https?)/',
<a name="l991"><span class="linenum"> 991</span></a>              array( 'Sanitizer', 'armorLinksCallback' ),
<a name="l992"><span class="linenum"> 992</span></a>              <a class="var it7430" onMouseOver="hilite(7430)" onMouseOut="lolite()" onClick="logVariable('encValue')" href="../../_variables/encValue.html">$encValue</a> );
<a name="l993"><span class="linenum"> 993</span></a>          return <a class="var it7430" onMouseOver="hilite(7430)" onMouseOut="lolite()" onClick="logVariable('encValue')" href="../../_variables/encValue.html">$encValue</a>;
<a name="l994"><span class="linenum"> 994</span></a>      }
<a name="l995"><span class="linenum"> 995</span></a>  
<a name="l996"><span class="linenum"> 996</span></a>      <span class="comment">/**</span>
<a name="l997"><span class="linenum"> 997</span></a>  <span class="comment">     * Given a value, escape it so that it can be used in an id attribute and</span>
<a name="l998"><span class="linenum"> 998</span></a>  <span class="comment">     * return it.  This will use HTML5 validation if $wgExperimentalHtmlIds is</span>
<a name="l999"><span class="linenum"> 999</span></a>  <span class="comment">     * true, allowing anything but ASCII whitespace.  Otherwise it will use</span>
<a name="l1000"><span class="linenum">1000</span></a>  <span class="comment">     * HTML 4 rules, which means a narrow subset of ASCII, with bad characters</span>
<a name="l1001"><span class="linenum">1001</span></a>  <span class="comment">     * escaped with lots of dots.</span>
<a name="l1002"><span class="linenum">1002</span></a>  <span class="comment">     *</span>
<a name="l1003"><span class="linenum">1003</span></a>  <span class="comment">     * To ensure we don't have to bother escaping anything, we also strip ', &quot;,</span>
<a name="l1004"><span class="linenum">1004</span></a>  <span class="comment">     * &amp; even if $wgExperimentalIds is true.  TODO: Is this the best tactic?</span>
<a name="l1005"><span class="linenum">1005</span></a>  <span class="comment">     * We also strip # because it upsets IE, and % because it could be</span>
<a name="l1006"><span class="linenum">1006</span></a>  <span class="comment">     * ambiguous if it's part of something that looks like a percent escape</span>
<a name="l1007"><span class="linenum">1007</span></a>  <span class="comment">     * (which don't work reliably in fragments cross-browser).</span>
<a name="l1008"><span class="linenum">1008</span></a>  <span class="comment">     *</span>
<a name="l1009"><span class="linenum">1009</span></a>  <span class="comment">     * @see http://www.w3.org/TR/html401/types.html#type-name Valid characters</span>
<a name="l1010"><span class="linenum">1010</span></a>  <span class="comment">     *                                                          in the id and</span>
<a name="l1011"><span class="linenum">1011</span></a>  <span class="comment">     *                                                          name attributes</span>
<a name="l1012"><span class="linenum">1012</span></a>  <span class="comment">     * @see http://www.w3.org/TR/html401/struct/links.html#h-12.2.3 Anchors with the id attribute</span>
<a name="l1013"><span class="linenum">1013</span></a>  <span class="comment">     * @see http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#the-id-attribute</span>
<a name="l1014"><span class="linenum">1014</span></a>  <span class="comment">     *   HTML5 definition of id attribute</span>
<a name="l1015"><span class="linenum">1015</span></a>  <span class="comment">     *</span>
<a name="l1016"><span class="linenum">1016</span></a>  <span class="comment">     * @param string $id id to escape</span>
<a name="l1017"><span class="linenum">1017</span></a>  <span class="comment">     * @param $options Mixed: string or array of strings (default is array()):</span>
<a name="l1018"><span class="linenum">1018</span></a>  <span class="comment">     *   'noninitial': This is a non-initial fragment of an id, not a full id,</span>
<a name="l1019"><span class="linenum">1019</span></a>  <span class="comment">     *       so don't pay attention if the first character isn't valid at the</span>
<a name="l1020"><span class="linenum">1020</span></a>  <span class="comment">     *       beginning of an id.  Only matters if $wgExperimentalHtmlIds is</span>
<a name="l1021"><span class="linenum">1021</span></a>  <span class="comment">     *       false.</span>
<a name="l1022"><span class="linenum">1022</span></a>  <span class="comment">     *   'legacy': Behave the way the old HTML 4-based ID escaping worked even</span>
<a name="l1023"><span class="linenum">1023</span></a>  <span class="comment">     *       if $wgExperimentalHtmlIds is used, so we can generate extra</span>
<a name="l1024"><span class="linenum">1024</span></a>  <span class="comment">     *       anchors and links won't break.</span>
<a name="l1025"><span class="linenum">1025</span></a>  <span class="comment">     * @return String</span>
<a name="l1026"><span class="linenum">1026</span></a>  <span class="comment">     */</span>
<a name="l1027"><span class="linenum">1027</span></a>  	static function <a class="function" onClick="logFunction('escapeId')" href="../../_functions/escapeid.html" onMouseOver="funcPopup(event,'escapeid')">escapeId</a>( <a class="var it1322" onMouseOver="hilite(1322)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>, <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a> = array() ) {
<a name="l1028"><span class="linenum">1028</span></a>          global <a class="var it7396" onMouseOver="hilite(7396)" onMouseOut="lolite()" onClick="logVariable('wgHtml5')" href="../../_variables/wgHtml5.html">$wgHtml5</a>, <a class="var it7431" onMouseOver="hilite(7431)" onMouseOut="lolite()" onClick="logVariable('wgExperimentalHtmlIds')" href="../../_variables/wgExperimentalHtmlIds.html">$wgExperimentalHtmlIds</a>;
<a name="l1029"><span class="linenum">1029</span></a>          <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a> = (array)<a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a>;
<a name="l1030"><span class="linenum">1030</span></a>  
<a name="l1031"><span class="linenum">1031</span></a>          if ( <a class="var it7396" onMouseOver="hilite(7396)" onMouseOut="lolite()" onClick="logVariable('wgHtml5')" href="../../_variables/wgHtml5.html">$wgHtml5</a> &amp;&amp; <a class="var it7431" onMouseOver="hilite(7431)" onMouseOut="lolite()" onClick="logVariable('wgExperimentalHtmlIds')" href="../../_variables/wgExperimentalHtmlIds.html">$wgExperimentalHtmlIds</a> &amp;&amp; !<a class="phpfunction" onClick="logFunction('in_array')" href="../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>( 'legacy', <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a> ) ) {
<a name="l1032"><span class="linenum">1032</span></a>              <a class="var it1322" onMouseOver="hilite(1322)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a> = <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('decodeCharReferences')" href="../../_functions/decodecharreferences.html" onMouseOver="funcPopup(event,'decodecharreferences')">decodeCharReferences</a>( <a class="var it1322" onMouseOver="hilite(1322)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a> );
<a name="l1033"><span class="linenum">1033</span></a>              <a class="var it1322" onMouseOver="hilite(1322)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>( '/[ \t\n\r\f_\'&quot;&amp;#%]+/', '_', <a class="var it1322" onMouseOver="hilite(1322)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a> );
<a name="l1034"><span class="linenum">1034</span></a>              <a class="var it1322" onMouseOver="hilite(1322)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>( <a class="var it1322" onMouseOver="hilite(1322)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>, '_' );
<a name="l1035"><span class="linenum">1035</span></a>              if ( <a class="var it1322" onMouseOver="hilite(1322)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a> === '' ) {
<a name="l1036"><span class="linenum">1036</span></a>  <span class="comment">                # Must have been all whitespace to start with.</span>
<a name="l1037"><span class="linenum">1037</span></a>                  return '_';
<a name="l1038"><span class="linenum">1038</span></a>              } else {
<a name="l1039"><span class="linenum">1039</span></a>                  return <a class="var it1322" onMouseOver="hilite(1322)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>;
<a name="l1040"><span class="linenum">1040</span></a>              }
<a name="l1041"><span class="linenum">1041</span></a>          }
<a name="l1042"><span class="linenum">1042</span></a>  
<a name="l1043"><span class="linenum">1043</span></a>  <span class="comment">        # HTML4-style escaping</span>
<a name="l1044"><span class="linenum">1044</span></a>          static <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('replace')" href="../../_variables/replace.html">$replace</a> = array(
<a name="l1045"><span class="linenum">1045</span></a>              '%3A' =&gt; ':',
<a name="l1046"><span class="linenum">1046</span></a>              '%' =&gt; '.'
<a name="l1047"><span class="linenum">1047</span></a>          );
<a name="l1048"><span class="linenum">1048</span></a>  
<a name="l1049"><span class="linenum">1049</span></a>          <a class="var it1322" onMouseOver="hilite(1322)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a> = <a class="phpfunction" onClick="logFunction('urlencode')" href="../../_functions/urlencode.html" onMouseOver="phpfuncPopup(event,'urlencode')">urlencode</a>( <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('decodeCharReferences')" href="../../_functions/decodecharreferences.html" onMouseOver="funcPopup(event,'decodecharreferences')">decodeCharReferences</a>( <a class="phpfunction" onClick="logFunction('strtr')" href="../../_functions/strtr.html" onMouseOver="phpfuncPopup(event,'strtr')">strtr</a>( <a class="var it1322" onMouseOver="hilite(1322)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>, ' ', '_' ) ) );
<a name="l1050"><span class="linenum">1050</span></a>          <a class="var it1322" onMouseOver="hilite(1322)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>( <a class="phpfunction" onClick="logFunction('array_keys')" href="../../_functions/array_keys.html" onMouseOver="phpfuncPopup(event,'array_keys')">array_keys</a>( <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('replace')" href="../../_variables/replace.html">$replace</a> ), <a class="phpfunction" onClick="logFunction('array_values')" href="../../_functions/array_values.html" onMouseOver="phpfuncPopup(event,'array_values')">array_values</a>( <a class="var it59" onMouseOver="hilite(59)" onMouseOut="lolite()" onClick="logVariable('replace')" href="../../_variables/replace.html">$replace</a> ), <a class="var it1322" onMouseOver="hilite(1322)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a> );
<a name="l1051"><span class="linenum">1051</span></a>  
<a name="l1052"><span class="linenum">1052</span></a>          if ( !<a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>( '/^[a-zA-Z]/', <a class="var it1322" onMouseOver="hilite(1322)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a> )
<a name="l1053"><span class="linenum">1053</span></a>          &amp;&amp; !<a class="phpfunction" onClick="logFunction('in_array')" href="../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>( 'noninitial', <a class="var it240" onMouseOver="hilite(240)" onMouseOut="lolite()" onClick="logVariable('options')" href="../../_variables/options.html">$options</a> ) ) {
<a name="l1054"><span class="linenum">1054</span></a>  <span class="comment">            // Initial character must be a letter!</span>
<a name="l1055"><span class="linenum">1055</span></a>              <a class="var it1322" onMouseOver="hilite(1322)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a> = &quot;x<a class="var it1322" onMouseOver="hilite(1322)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>&quot;;
<a name="l1056"><span class="linenum">1056</span></a>          }
<a name="l1057"><span class="linenum">1057</span></a>          return <a class="var it1322" onMouseOver="hilite(1322)" onMouseOut="lolite()" onClick="logVariable('id')" href="../../_variables/id.html">$id</a>;
<a name="l1058"><span class="linenum">1058</span></a>      }
<a name="l1059"><span class="linenum">1059</span></a>  
<a name="l1060"><span class="linenum">1060</span></a>      <span class="comment">/**</span>
<a name="l1061"><span class="linenum">1061</span></a>  <span class="comment">     * Given a value, escape it so that it can be used as a CSS class and</span>
<a name="l1062"><span class="linenum">1062</span></a>  <span class="comment">     * return it.</span>
<a name="l1063"><span class="linenum">1063</span></a>  <span class="comment">     *</span>
<a name="l1064"><span class="linenum">1064</span></a>  <span class="comment">     * @todo For extra validity, input should be validated UTF-8.</span>
<a name="l1065"><span class="linenum">1065</span></a>  <span class="comment">     *</span>
<a name="l1066"><span class="linenum">1066</span></a>  <span class="comment">     * @see http://www.w3.org/TR/CSS21/syndata.html Valid characters/format</span>
<a name="l1067"><span class="linenum">1067</span></a>  <span class="comment">     *</span>
<a name="l1068"><span class="linenum">1068</span></a>  <span class="comment">     * @param $class String</span>
<a name="l1069"><span class="linenum">1069</span></a>  <span class="comment">     * @return String</span>
<a name="l1070"><span class="linenum">1070</span></a>  <span class="comment">     */</span>
<a name="l1071"><span class="linenum">1071</span></a>  	static function <a class="function" onClick="logFunction('escapeClass')" href="../../_functions/escapeclass.html" onMouseOver="funcPopup(event,'escapeclass')">escapeClass</a>( <a class="var it287" onMouseOver="hilite(287)" onMouseOut="lolite()" onClick="logVariable('class')" href="../../_variables/class.html">$class</a> ) {
<a name="l1072"><span class="linenum">1072</span></a>  <span class="comment">        // Convert ugly stuff to underscores and kill underscores in ugly places</span>
<a name="l1073"><span class="linenum">1073</span></a>          return <a class="phpfunction" onClick="logFunction('rtrim')" href="../../_functions/rtrim.html" onMouseOver="phpfuncPopup(event,'rtrim')">rtrim</a>( <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>(
<a name="l1074"><span class="linenum">1074</span></a>              array( '/(^[0-9\\-])|[\\x00-\\x20!&quot;#$%&amp;\'()*+,.\\/:;&lt;=&gt;?@[\\]^`{|}~]|\\xC2\\xA0/', '/_+/' ),
<a name="l1075"><span class="linenum">1075</span></a>              '_',
<a name="l1076"><span class="linenum">1076</span></a>              <a class="var it287" onMouseOver="hilite(287)" onMouseOut="lolite()" onClick="logVariable('class')" href="../../_variables/class.html">$class</a> ), '_' );
<a name="l1077"><span class="linenum">1077</span></a>      }
<a name="l1078"><span class="linenum">1078</span></a>  
<a name="l1079"><span class="linenum">1079</span></a>      <span class="comment">/**</span>
<a name="l1080"><span class="linenum">1080</span></a>  <span class="comment">     * Given HTML input, escape with htmlspecialchars but un-escape entities.</span>
<a name="l1081"><span class="linenum">1081</span></a>  <span class="comment">     * This allows (generally harmless) entities like &amp;#160; to survive.</span>
<a name="l1082"><span class="linenum">1082</span></a>  <span class="comment">     *</span>
<a name="l1083"><span class="linenum">1083</span></a>  <span class="comment">     * @param string $html to escape</span>
<a name="l1084"><span class="linenum">1084</span></a>  <span class="comment">     * @return String: escaped input</span>
<a name="l1085"><span class="linenum">1085</span></a>  <span class="comment">     */</span>
<a name="l1086"><span class="linenum">1086</span></a>  	static function <a class="function" onClick="logFunction('escapeHtmlAllowEntities')" href="../../_functions/escapehtmlallowentities.html" onMouseOver="funcPopup(event,'escapehtmlallowentities')">escapeHtmlAllowEntities</a>( <a class="var it1560" onMouseOver="hilite(1560)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../_variables/html.html">$html</a> ) {
<a name="l1087"><span class="linenum">1087</span></a>          <a class="var it1560" onMouseOver="hilite(1560)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../_variables/html.html">$html</a> = <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('decodeCharReferences')" href="../../_functions/decodecharreferences.html" onMouseOver="funcPopup(event,'decodecharreferences')">decodeCharReferences</a>( <a class="var it1560" onMouseOver="hilite(1560)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../_variables/html.html">$html</a> );
<a name="l1088"><span class="linenum">1088</span></a>  <span class="comment">        # It seems wise to escape ' as well as &quot;, as a matter of course.  Can't</span>
<a name="l1089"><span class="linenum">1089</span></a>  <span class="comment">        # hurt.</span>
<a name="l1090"><span class="linenum">1090</span></a>          <a class="var it1560" onMouseOver="hilite(1560)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../_variables/html.html">$html</a> = <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>( <a class="var it1560" onMouseOver="hilite(1560)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../_variables/html.html">$html</a>, ENT_QUOTES );
<a name="l1091"><span class="linenum">1091</span></a>          return <a class="var it1560" onMouseOver="hilite(1560)" onMouseOut="lolite()" onClick="logVariable('html')" href="../../_variables/html.html">$html</a>;
<a name="l1092"><span class="linenum">1092</span></a>      }
<a name="l1093"><span class="linenum">1093</span></a>  
<a name="l1094"><span class="linenum">1094</span></a>      <span class="comment">/**</span>
<a name="l1095"><span class="linenum">1095</span></a>  <span class="comment">     * Regex replace callback for armoring links against further processing.</span>
<a name="l1096"><span class="linenum">1096</span></a>  <span class="comment">     * @param $matches Array</span>
<a name="l1097"><span class="linenum">1097</span></a>  <span class="comment">     * @return string</span>
<a name="l1098"><span class="linenum">1098</span></a>  <span class="comment">     */</span>
<a name="l1099"><span class="linenum">1099</span></a>  	private static function <a class="function" onClick="logFunction('armorLinksCallback')" href="../../_functions/armorlinkscallback.html" onMouseOver="funcPopup(event,'armorlinkscallback')">armorLinksCallback</a>( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a> ) {
<a name="l1100"><span class="linenum">1100</span></a>          return <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>( ':', '&amp;#58;', <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1] );
<a name="l1101"><span class="linenum">1101</span></a>      }
<a name="l1102"><span class="linenum">1102</span></a>  
<a name="l1103"><span class="linenum">1103</span></a>      <span class="comment">/**</span>
<a name="l1104"><span class="linenum">1104</span></a>  <span class="comment">     * Return an associative array of attribute names and values from</span>
<a name="l1105"><span class="linenum">1105</span></a>  <span class="comment">     * a partial tag string. Attribute names are forces to lowercase,</span>
<a name="l1106"><span class="linenum">1106</span></a>  <span class="comment">     * character references are decoded to UTF-8 text.</span>
<a name="l1107"><span class="linenum">1107</span></a>  <span class="comment">     *</span>
<a name="l1108"><span class="linenum">1108</span></a>  <span class="comment">     * @param $text String</span>
<a name="l1109"><span class="linenum">1109</span></a>  <span class="comment">     * @return Array</span>
<a name="l1110"><span class="linenum">1110</span></a>  <span class="comment">     */</span>
<a name="l1111"><span class="linenum">1111</span></a>  	public static function <a class="function" onClick="logFunction('decodeTagAttributes')" href="../../_functions/decodetagattributes.html" onMouseOver="funcPopup(event,'decodetagattributes')">decodeTagAttributes</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> ) {
<a name="l1112"><span class="linenum">1112</span></a>          if( <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> ) == '' ) {
<a name="l1113"><span class="linenum">1113</span></a>              return array();
<a name="l1114"><span class="linenum">1114</span></a>          }
<a name="l1115"><span class="linenum">1115</span></a>  
<a name="l1116"><span class="linenum">1116</span></a>  <span class="comment">        // Revert all quotes to normal view in order to parse the attributes correctly</span>
<a name="l1117"><span class="linenum">1117</span></a>          <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>( '&amp;quot;', '&quot;', <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> );
<a name="l1118"><span class="linenum">1118</span></a>  
<a name="l1119"><span class="linenum">1119</span></a>          <a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('attribs')" href="../../_variables/attribs.html">$attribs</a> = array();
<a name="l1120"><span class="linenum">1120</span></a>          <a class="var it87" onMouseOver="hilite(87)" onMouseOut="lolite()" onClick="logVariable('pairs')" href="../../_variables/pairs.html">$pairs</a> = array();
<a name="l1121"><span class="linenum">1121</span></a>          if( !<a class="phpfunction" onClick="logFunction('preg_match_all')" href="../../_functions/preg_match_all.html" onMouseOver="phpfuncPopup(event,'preg_match_all')">preg_match_all</a>(
<a name="l1122"><span class="linenum">1122</span></a>              self::<a class="function" onClick="logFunction('getAttribsRegex')" href="../../_functions/getattribsregex.html" onMouseOver="funcPopup(event,'getattribsregex')">getAttribsRegex</a>(),
<a name="l1123"><span class="linenum">1123</span></a>              <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>,
<a name="l1124"><span class="linenum">1124</span></a>              <a class="var it87" onMouseOver="hilite(87)" onMouseOut="lolite()" onClick="logVariable('pairs')" href="../../_variables/pairs.html">$pairs</a>,
<a name="l1125"><span class="linenum">1125</span></a>              PREG_SET_ORDER ) ) {
<a name="l1126"><span class="linenum">1126</span></a>              return <a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('attribs')" href="../../_variables/attribs.html">$attribs</a>;
<a name="l1127"><span class="linenum">1127</span></a>          }
<a name="l1128"><span class="linenum">1128</span></a>  
<a name="l1129"><span class="linenum">1129</span></a>          foreach( <a class="var it87" onMouseOver="hilite(87)" onMouseOut="lolite()" onClick="logVariable('pairs')" href="../../_variables/pairs.html">$pairs</a> as <a class="var it1010" onMouseOver="hilite(1010)" onMouseOut="lolite()" onClick="logVariable('set')" href="../../_variables/set.html">$set</a> ) {
<a name="l1130"><span class="linenum">1130</span></a>              <a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a> = <a class="phpfunction" onClick="logFunction('strtolower')" href="../../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>( <a class="var it1010" onMouseOver="hilite(1010)" onMouseOut="lolite()" onClick="logVariable('set')" href="../../_variables/set.html">$set</a>[1] );
<a name="l1131"><span class="linenum">1131</span></a>              <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('getTagAttributeCallback')" href="../../_functions/gettagattributecallback.html" onMouseOver="funcPopup(event,'gettagattributecallback')">getTagAttributeCallback</a>( <a class="var it1010" onMouseOver="hilite(1010)" onMouseOut="lolite()" onClick="logVariable('set')" href="../../_variables/set.html">$set</a> );
<a name="l1132"><span class="linenum">1132</span></a>  
<a name="l1133"><span class="linenum">1133</span></a>  <span class="comment">            // Normalize whitespace</span>
<a name="l1134"><span class="linenum">1134</span></a>              <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>( '/[\t\r\n ]+/', ' ', <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> );
<a name="l1135"><span class="linenum">1135</span></a>              <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> = <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>( <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> );
<a name="l1136"><span class="linenum">1136</span></a>  
<a name="l1137"><span class="linenum">1137</span></a>  <span class="comment">            // Decode character references</span>
<a name="l1138"><span class="linenum">1138</span></a>              <a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('attribs')" href="../../_variables/attribs.html">$attribs</a>[<a class="var it7425" onMouseOver="hilite(7425)" onMouseOut="lolite()" onClick="logVariable('attribute')" href="../../_variables/attribute.html">$attribute</a>] = <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('decodeCharReferences')" href="../../_functions/decodecharreferences.html" onMouseOver="funcPopup(event,'decodecharreferences')">decodeCharReferences</a>( <a class="var it54" onMouseOver="hilite(54)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../_variables/value.html">$value</a> );
<a name="l1139"><span class="linenum">1139</span></a>          }
<a name="l1140"><span class="linenum">1140</span></a>          return <a class="var it4779" onMouseOver="hilite(4779)" onMouseOut="lolite()" onClick="logVariable('attribs')" href="../../_variables/attribs.html">$attribs</a>;
<a name="l1141"><span class="linenum">1141</span></a>      }
<a name="l1142"><span class="linenum">1142</span></a>  
<a name="l1143"><span class="linenum">1143</span></a>      <span class="comment">/**</span>
<a name="l1144"><span class="linenum">1144</span></a>  <span class="comment">     * Pick the appropriate attribute value from a match set from the</span>
<a name="l1145"><span class="linenum">1145</span></a>  <span class="comment">     * attribs regex matches.</span>
<a name="l1146"><span class="linenum">1146</span></a>  <span class="comment">     *</span>
<a name="l1147"><span class="linenum">1147</span></a>  <span class="comment">     * @param $set Array</span>
<a name="l1148"><span class="linenum">1148</span></a>  <span class="comment">     * @throws MWException</span>
<a name="l1149"><span class="linenum">1149</span></a>  <span class="comment">     * @return String</span>
<a name="l1150"><span class="linenum">1150</span></a>  <span class="comment">     */</span>
<a name="l1151"><span class="linenum">1151</span></a>  	private static function <a class="function" onClick="logFunction('getTagAttributeCallback')" href="../../_functions/gettagattributecallback.html" onMouseOver="funcPopup(event,'gettagattributecallback')">getTagAttributeCallback</a>( <a class="var it1010" onMouseOver="hilite(1010)" onMouseOut="lolite()" onClick="logVariable('set')" href="../../_variables/set.html">$set</a> ) {
<a name="l1152"><span class="linenum">1152</span></a>          if( isset( <a class="var it1010" onMouseOver="hilite(1010)" onMouseOut="lolite()" onClick="logVariable('set')" href="../../_variables/set.html">$set</a>[6] ) ) {
<a name="l1153"><span class="linenum">1153</span></a>  <span class="comment">            # Illegal #XXXXXX color with no quotes.</span>
<a name="l1154"><span class="linenum">1154</span></a>              return <a class="var it1010" onMouseOver="hilite(1010)" onMouseOut="lolite()" onClick="logVariable('set')" href="../../_variables/set.html">$set</a>[6];
<a name="l1155"><span class="linenum">1155</span></a>          } elseif( isset( <a class="var it1010" onMouseOver="hilite(1010)" onMouseOut="lolite()" onClick="logVariable('set')" href="../../_variables/set.html">$set</a>[5] ) ) {
<a name="l1156"><span class="linenum">1156</span></a>  <span class="comment">            # No quotes.</span>
<a name="l1157"><span class="linenum">1157</span></a>              return <a class="var it1010" onMouseOver="hilite(1010)" onMouseOut="lolite()" onClick="logVariable('set')" href="../../_variables/set.html">$set</a>[5];
<a name="l1158"><span class="linenum">1158</span></a>          } elseif( isset( <a class="var it1010" onMouseOver="hilite(1010)" onMouseOut="lolite()" onClick="logVariable('set')" href="../../_variables/set.html">$set</a>[4] ) ) {
<a name="l1159"><span class="linenum">1159</span></a>  <span class="comment">            # Single-quoted</span>
<a name="l1160"><span class="linenum">1160</span></a>              return <a class="var it1010" onMouseOver="hilite(1010)" onMouseOut="lolite()" onClick="logVariable('set')" href="../../_variables/set.html">$set</a>[4];
<a name="l1161"><span class="linenum">1161</span></a>          } elseif( isset( <a class="var it1010" onMouseOver="hilite(1010)" onMouseOut="lolite()" onClick="logVariable('set')" href="../../_variables/set.html">$set</a>[3] ) ) {
<a name="l1162"><span class="linenum">1162</span></a>  <span class="comment">            # Double-quoted</span>
<a name="l1163"><span class="linenum">1163</span></a>              return <a class="var it1010" onMouseOver="hilite(1010)" onMouseOut="lolite()" onClick="logVariable('set')" href="../../_variables/set.html">$set</a>[3];
<a name="l1164"><span class="linenum">1164</span></a>          } elseif( !isset( <a class="var it1010" onMouseOver="hilite(1010)" onMouseOut="lolite()" onClick="logVariable('set')" href="../../_variables/set.html">$set</a>[2] ) ) {
<a name="l1165"><span class="linenum">1165</span></a>  <span class="comment">            # In XHTML, attributes must have a value.</span>
<a name="l1166"><span class="linenum">1166</span></a>  <span class="comment">            # For 'reduced' form, return explicitly the attribute name here.</span>
<a name="l1167"><span class="linenum">1167</span></a>              return <a class="var it1010" onMouseOver="hilite(1010)" onMouseOut="lolite()" onClick="logVariable('set')" href="../../_variables/set.html">$set</a>[1];
<a name="l1168"><span class="linenum">1168</span></a>          } else {
<a name="l1169"><span class="linenum">1169</span></a>              throw new MWException( &quot;Tag conditions not met. This should never happen and is a bug.&quot; );
<a name="l1170"><span class="linenum">1170</span></a>          }
<a name="l1171"><span class="linenum">1171</span></a>      }
<a name="l1172"><span class="linenum">1172</span></a>  
<a name="l1173"><span class="linenum">1173</span></a>      <span class="comment">/**</span>
<a name="l1174"><span class="linenum">1174</span></a>  <span class="comment">     * Normalize whitespace and character references in an XML source-</span>
<a name="l1175"><span class="linenum">1175</span></a>  <span class="comment">     * encoded text for an attribute value.</span>
<a name="l1176"><span class="linenum">1176</span></a>  <span class="comment">     *</span>
<a name="l1177"><span class="linenum">1177</span></a>  <span class="comment">     * See http://www.w3.org/TR/REC-xml/#AVNormalize for background,</span>
<a name="l1178"><span class="linenum">1178</span></a>  <span class="comment">     * but note that we're not returning the value, but are returning</span>
<a name="l1179"><span class="linenum">1179</span></a>  <span class="comment">     * XML source fragments that will be slapped into output.</span>
<a name="l1180"><span class="linenum">1180</span></a>  <span class="comment">     *</span>
<a name="l1181"><span class="linenum">1181</span></a>  <span class="comment">     * @param $text String</span>
<a name="l1182"><span class="linenum">1182</span></a>  <span class="comment">     * @return String</span>
<a name="l1183"><span class="linenum">1183</span></a>  <span class="comment">     */</span>
<a name="l1184"><span class="linenum">1184</span></a>  	private static function <a class="function" onClick="logFunction('normalizeAttributeValue')" href="../../_functions/normalizeattributevalue.html" onMouseOver="funcPopup(event,'normalizeattributevalue')">normalizeAttributeValue</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> ) {
<a name="l1185"><span class="linenum">1185</span></a>          return <a class="phpfunction" onClick="logFunction('str_replace')" href="../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>( '&quot;', '&amp;quot;',
<a name="l1186"><span class="linenum">1186</span></a>              self::<a class="function" onClick="logFunction('normalizeWhitespace')" href="../../_functions/normalizewhitespace.html" onMouseOver="funcPopup(event,'normalizewhitespace')">normalizeWhitespace</a>(
<a name="l1187"><span class="linenum">1187</span></a>                  <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('normalizeCharReferences')" href="../../_functions/normalizecharreferences.html" onMouseOver="funcPopup(event,'normalizecharreferences')">normalizeCharReferences</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> ) ) );
<a name="l1188"><span class="linenum">1188</span></a>      }
<a name="l1189"><span class="linenum">1189</span></a>  
<a name="l1190"><span class="linenum">1190</span></a>      <span class="comment">/**</span>
<a name="l1191"><span class="linenum">1191</span></a>  <span class="comment">     * @param $text string</span>
<a name="l1192"><span class="linenum">1192</span></a>  <span class="comment">     * @return mixed</span>
<a name="l1193"><span class="linenum">1193</span></a>  <span class="comment">     */</span>
<a name="l1194"><span class="linenum">1194</span></a>  	private static function <a class="function" onClick="logFunction('normalizeWhitespace')" href="../../_functions/normalizewhitespace.html" onMouseOver="funcPopup(event,'normalizewhitespace')">normalizeWhitespace</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> ) {
<a name="l1195"><span class="linenum">1195</span></a>          return <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>(
<a name="l1196"><span class="linenum">1196</span></a>              '/\r\n|[\x20\x0d\x0a\x09]/',
<a name="l1197"><span class="linenum">1197</span></a>              ' ',
<a name="l1198"><span class="linenum">1198</span></a>              <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> );
<a name="l1199"><span class="linenum">1199</span></a>      }
<a name="l1200"><span class="linenum">1200</span></a>  
<a name="l1201"><span class="linenum">1201</span></a>      <span class="comment">/**</span>
<a name="l1202"><span class="linenum">1202</span></a>  <span class="comment">     * Normalizes whitespace in a section name, such as might be returned</span>
<a name="l1203"><span class="linenum">1203</span></a>  <span class="comment">     * by Parser::stripSectionName(), for use in the id's that are used for</span>
<a name="l1204"><span class="linenum">1204</span></a>  <span class="comment">     * section links.</span>
<a name="l1205"><span class="linenum">1205</span></a>  <span class="comment">     *</span>
<a name="l1206"><span class="linenum">1206</span></a>  <span class="comment">     * @param $section String</span>
<a name="l1207"><span class="linenum">1207</span></a>  <span class="comment">     * @return String</span>
<a name="l1208"><span class="linenum">1208</span></a>  <span class="comment">     */</span>
<a name="l1209"><span class="linenum">1209</span></a>  	static function <a class="function" onClick="logFunction('normalizeSectionNameWhitespace')" href="../../_functions/normalizesectionnamewhitespace.html" onMouseOver="funcPopup(event,'normalizesectionnamewhitespace')">normalizeSectionNameWhitespace</a>( <a class="var it7432" onMouseOver="hilite(7432)" onMouseOut="lolite()" onClick="logVariable('section')" href="../../_variables/section.html">$section</a> ) {
<a name="l1210"><span class="linenum">1210</span></a>          return <a class="phpfunction" onClick="logFunction('trim')" href="../../_functions/trim.html" onMouseOver="phpfuncPopup(event,'trim')">trim</a>( <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>( '/[ _]+/', ' ', <a class="var it7432" onMouseOver="hilite(7432)" onMouseOut="lolite()" onClick="logVariable('section')" href="../../_variables/section.html">$section</a> ) );
<a name="l1211"><span class="linenum">1211</span></a>      }
<a name="l1212"><span class="linenum">1212</span></a>  
<a name="l1213"><span class="linenum">1213</span></a>      <span class="comment">/**</span>
<a name="l1214"><span class="linenum">1214</span></a>  <span class="comment">     * Ensure that any entities and character references are legal</span>
<a name="l1215"><span class="linenum">1215</span></a>  <span class="comment">     * for XML and XHTML specifically. Any stray bits will be</span>
<a name="l1216"><span class="linenum">1216</span></a>  <span class="comment">     * &amp;amp;-escaped to result in a valid text fragment.</span>
<a name="l1217"><span class="linenum">1217</span></a>  <span class="comment">     *</span>
<a name="l1218"><span class="linenum">1218</span></a>  <span class="comment">     * a. named char refs can only be &amp;lt; &amp;gt; &amp;amp; &amp;quot;, others are</span>
<a name="l1219"><span class="linenum">1219</span></a>  <span class="comment">     *   numericized (this way we're well-formed even without a DTD)</span>
<a name="l1220"><span class="linenum">1220</span></a>  <span class="comment">     * b. any numeric char refs must be legal chars, not invalid or forbidden</span>
<a name="l1221"><span class="linenum">1221</span></a>  <span class="comment">     * c. use lower cased &quot;&amp;#x&quot;, not &quot;&amp;#X&quot;</span>
<a name="l1222"><span class="linenum">1222</span></a>  <span class="comment">     * d. fix or reject non-valid attributes</span>
<a name="l1223"><span class="linenum">1223</span></a>  <span class="comment">     *</span>
<a name="l1224"><span class="linenum">1224</span></a>  <span class="comment">     * @param $text String</span>
<a name="l1225"><span class="linenum">1225</span></a>  <span class="comment">     * @return String</span>
<a name="l1226"><span class="linenum">1226</span></a>  <span class="comment">     * @private</span>
<a name="l1227"><span class="linenum">1227</span></a>  <span class="comment">     */</span>
<a name="l1228"><span class="linenum">1228</span></a>  	static function <a class="function" onClick="logFunction('normalizeCharReferences')" href="../../_functions/normalizecharreferences.html" onMouseOver="funcPopup(event,'normalizecharreferences')">normalizeCharReferences</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> ) {
<a name="l1229"><span class="linenum">1229</span></a>          return <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>(
<a name="l1230"><span class="linenum">1230</span></a>              self::CHAR_REFS_REGEX,
<a name="l1231"><span class="linenum">1231</span></a>              array( 'Sanitizer', 'normalizeCharReferencesCallback' ),
<a name="l1232"><span class="linenum">1232</span></a>              <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> );
<a name="l1233"><span class="linenum">1233</span></a>      }
<a name="l1234"><span class="linenum">1234</span></a>      <span class="comment">/**</span>
<a name="l1235"><span class="linenum">1235</span></a>  <span class="comment">     * @param $matches String</span>
<a name="l1236"><span class="linenum">1236</span></a>  <span class="comment">     * @return String</span>
<a name="l1237"><span class="linenum">1237</span></a>  <span class="comment">     */</span>
<a name="l1238"><span class="linenum">1238</span></a>  	static function <a class="function" onClick="logFunction('normalizeCharReferencesCallback')" href="../../_functions/normalizecharreferencescallback.html" onMouseOver="funcPopup(event,'normalizecharreferencescallback')">normalizeCharReferencesCallback</a>( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a> ) {
<a name="l1239"><span class="linenum">1239</span></a>          <a class="var it1033" onMouseOver="hilite(1033)" onMouseOut="lolite()" onClick="logVariable('ret')" href="../../_variables/ret.html">$ret</a> = null;
<a name="l1240"><span class="linenum">1240</span></a>          if( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1] != '' ) {
<a name="l1241"><span class="linenum">1241</span></a>              <a class="var it1033" onMouseOver="hilite(1033)" onMouseOut="lolite()" onClick="logVariable('ret')" href="../../_variables/ret.html">$ret</a> = <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('normalizeEntity')" href="../../_functions/normalizeentity.html" onMouseOver="funcPopup(event,'normalizeentity')">normalizeEntity</a>( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1] );
<a name="l1242"><span class="linenum">1242</span></a>          } elseif( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2] != '' ) {
<a name="l1243"><span class="linenum">1243</span></a>              <a class="var it1033" onMouseOver="hilite(1033)" onMouseOut="lolite()" onClick="logVariable('ret')" href="../../_variables/ret.html">$ret</a> = <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('decCharReference')" href="../../_functions/deccharreference.html" onMouseOver="funcPopup(event,'deccharreference')">decCharReference</a>( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2] );
<a name="l1244"><span class="linenum">1244</span></a>          } elseif( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[3] != '' ) {
<a name="l1245"><span class="linenum">1245</span></a>              <a class="var it1033" onMouseOver="hilite(1033)" onMouseOut="lolite()" onClick="logVariable('ret')" href="../../_variables/ret.html">$ret</a> = <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('hexCharReference')" href="../../_functions/hexcharreference.html" onMouseOver="funcPopup(event,'hexcharreference')">hexCharReference</a>( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[3] );
<a name="l1246"><span class="linenum">1246</span></a>          }
<a name="l1247"><span class="linenum">1247</span></a>          if( <a class="phpfunction" onClick="logFunction('is_null')" href="../../_functions/is_null.html" onMouseOver="phpfuncPopup(event,'is_null')">is_null</a>( <a class="var it1033" onMouseOver="hilite(1033)" onMouseOut="lolite()" onClick="logVariable('ret')" href="../../_variables/ret.html">$ret</a> ) ) {
<a name="l1248"><span class="linenum">1248</span></a>              return <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[0] );
<a name="l1249"><span class="linenum">1249</span></a>          } else {
<a name="l1250"><span class="linenum">1250</span></a>              return <a class="var it1033" onMouseOver="hilite(1033)" onMouseOut="lolite()" onClick="logVariable('ret')" href="../../_variables/ret.html">$ret</a>;
<a name="l1251"><span class="linenum">1251</span></a>          }
<a name="l1252"><span class="linenum">1252</span></a>      }
<a name="l1253"><span class="linenum">1253</span></a>  
<a name="l1254"><span class="linenum">1254</span></a>      <span class="comment">/**</span>
<a name="l1255"><span class="linenum">1255</span></a>  <span class="comment">     * If the named entity is defined in the HTML 4.0/XHTML 1.0 DTD,</span>
<a name="l1256"><span class="linenum">1256</span></a>  <span class="comment">     * return the equivalent numeric entity reference (except for the core &amp;lt;</span>
<a name="l1257"><span class="linenum">1257</span></a>  <span class="comment">     * &amp;gt; &amp;amp; &amp;quot;). If the entity is a MediaWiki-specific alias, returns</span>
<a name="l1258"><span class="linenum">1258</span></a>  <span class="comment">     * the HTML equivalent. Otherwise, returns HTML-escaped text of</span>
<a name="l1259"><span class="linenum">1259</span></a>  <span class="comment">     * pseudo-entity source (eg &amp;amp;foo;)</span>
<a name="l1260"><span class="linenum">1260</span></a>  <span class="comment">     *</span>
<a name="l1261"><span class="linenum">1261</span></a>  <span class="comment">     * @param $name String</span>
<a name="l1262"><span class="linenum">1262</span></a>  <span class="comment">     * @return String</span>
<a name="l1263"><span class="linenum">1263</span></a>  <span class="comment">     */</span>
<a name="l1264"><span class="linenum">1264</span></a>  	static function <a class="function" onClick="logFunction('normalizeEntity')" href="../../_functions/normalizeentity.html" onMouseOver="funcPopup(event,'normalizeentity')">normalizeEntity</a>( <a class="var it164" onMouseOver="hilite(164)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a> ) {
<a name="l1265"><span class="linenum">1265</span></a>          if ( isset( self::<a class="var it7388" onMouseOver="hilite(7388)" onMouseOut="lolite()" onClick="logVariable('htmlEntityAliases')" href="../../_variables/htmlEntityAliases.html">$htmlEntityAliases</a>[<a class="var it164" onMouseOver="hilite(164)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>] ) ) {
<a name="l1266"><span class="linenum">1266</span></a>              return '&amp;' . self::<a class="var it7388" onMouseOver="hilite(7388)" onMouseOut="lolite()" onClick="logVariable('htmlEntityAliases')" href="../../_variables/htmlEntityAliases.html">$htmlEntityAliases</a>[<a class="var it164" onMouseOver="hilite(164)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>] . ';';
<a name="l1267"><span class="linenum">1267</span></a>          } elseif ( <a class="phpfunction" onClick="logFunction('in_array')" href="../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>( <a class="var it164" onMouseOver="hilite(164)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>,
<a name="l1268"><span class="linenum">1268</span></a>          array( 'lt', 'gt', 'amp', 'quot' ) ) ) {
<a name="l1269"><span class="linenum">1269</span></a>              return &quot;&amp;<a class="var it164" onMouseOver="hilite(164)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>;&quot;;
<a name="l1270"><span class="linenum">1270</span></a>          } elseif ( isset( self::<a class="var it7387" onMouseOver="hilite(7387)" onMouseOut="lolite()" onClick="logVariable('htmlEntities')" href="../../_variables/htmlEntities.html">$htmlEntities</a>[<a class="var it164" onMouseOver="hilite(164)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>] ) ) {
<a name="l1271"><span class="linenum">1271</span></a>              return '&amp;#' . self::<a class="var it7387" onMouseOver="hilite(7387)" onMouseOut="lolite()" onClick="logVariable('htmlEntities')" href="../../_variables/htmlEntities.html">$htmlEntities</a>[<a class="var it164" onMouseOver="hilite(164)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>] . ';';
<a name="l1272"><span class="linenum">1272</span></a>          } else {
<a name="l1273"><span class="linenum">1273</span></a>              return &quot;&amp;amp;<a class="var it164" onMouseOver="hilite(164)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>;&quot;;
<a name="l1274"><span class="linenum">1274</span></a>          }
<a name="l1275"><span class="linenum">1275</span></a>      }
<a name="l1276"><span class="linenum">1276</span></a>  
<a name="l1277"><span class="linenum">1277</span></a>      <span class="comment">/**</span>
<a name="l1278"><span class="linenum">1278</span></a>  <span class="comment">     * @param $codepoint</span>
<a name="l1279"><span class="linenum">1279</span></a>  <span class="comment">     * @return null|string</span>
<a name="l1280"><span class="linenum">1280</span></a>  <span class="comment">     */</span>
<a name="l1281"><span class="linenum">1281</span></a>  	static function <a class="function" onClick="logFunction('decCharReference')" href="../../_functions/deccharreference.html" onMouseOver="funcPopup(event,'deccharreference')">decCharReference</a>( <a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('codepoint')" href="../../_variables/codepoint.html">$codepoint</a> ) {
<a name="l1282"><span class="linenum">1282</span></a>          <a class="var it7433" onMouseOver="hilite(7433)" onMouseOut="lolite()" onClick="logVariable('point')" href="../../_variables/point.html">$point</a> = <a class="phpfunction" onClick="logFunction('intval')" href="../../_functions/intval.html" onMouseOver="phpfuncPopup(event,'intval')">intval</a>( <a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('codepoint')" href="../../_variables/codepoint.html">$codepoint</a> );
<a name="l1283"><span class="linenum">1283</span></a>          if( <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('validateCodepoint')" href="../../_functions/validatecodepoint.html" onMouseOver="funcPopup(event,'validatecodepoint')">validateCodepoint</a>( <a class="var it7433" onMouseOver="hilite(7433)" onMouseOut="lolite()" onClick="logVariable('point')" href="../../_variables/point.html">$point</a> ) ) {
<a name="l1284"><span class="linenum">1284</span></a>              return sprintf( '&amp;#%d;', <a class="var it7433" onMouseOver="hilite(7433)" onMouseOut="lolite()" onClick="logVariable('point')" href="../../_variables/point.html">$point</a> );
<a name="l1285"><span class="linenum">1285</span></a>          } else {
<a name="l1286"><span class="linenum">1286</span></a>              return null;
<a name="l1287"><span class="linenum">1287</span></a>          }
<a name="l1288"><span class="linenum">1288</span></a>      }
<a name="l1289"><span class="linenum">1289</span></a>  
<a name="l1290"><span class="linenum">1290</span></a>      <span class="comment">/**</span>
<a name="l1291"><span class="linenum">1291</span></a>  <span class="comment">     * @param $codepoint</span>
<a name="l1292"><span class="linenum">1292</span></a>  <span class="comment">     * @return null|string</span>
<a name="l1293"><span class="linenum">1293</span></a>  <span class="comment">     */</span>
<a name="l1294"><span class="linenum">1294</span></a>  	static function <a class="function" onClick="logFunction('hexCharReference')" href="../../_functions/hexcharreference.html" onMouseOver="funcPopup(event,'hexcharreference')">hexCharReference</a>( <a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('codepoint')" href="../../_variables/codepoint.html">$codepoint</a> ) {
<a name="l1295"><span class="linenum">1295</span></a>          <a class="var it7433" onMouseOver="hilite(7433)" onMouseOut="lolite()" onClick="logVariable('point')" href="../../_variables/point.html">$point</a> = <a class="phpfunction" onClick="logFunction('hexdec')" href="../../_functions/hexdec.html" onMouseOver="phpfuncPopup(event,'hexdec')">hexdec</a>( <a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('codepoint')" href="../../_variables/codepoint.html">$codepoint</a> );
<a name="l1296"><span class="linenum">1296</span></a>          if( <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('validateCodepoint')" href="../../_functions/validatecodepoint.html" onMouseOver="funcPopup(event,'validatecodepoint')">validateCodepoint</a>( <a class="var it7433" onMouseOver="hilite(7433)" onMouseOut="lolite()" onClick="logVariable('point')" href="../../_variables/point.html">$point</a> ) ) {
<a name="l1297"><span class="linenum">1297</span></a>              return sprintf( '&amp;#x%x;', <a class="var it7433" onMouseOver="hilite(7433)" onMouseOut="lolite()" onClick="logVariable('point')" href="../../_variables/point.html">$point</a> );
<a name="l1298"><span class="linenum">1298</span></a>          } else {
<a name="l1299"><span class="linenum">1299</span></a>              return null;
<a name="l1300"><span class="linenum">1300</span></a>          }
<a name="l1301"><span class="linenum">1301</span></a>      }
<a name="l1302"><span class="linenum">1302</span></a>  
<a name="l1303"><span class="linenum">1303</span></a>      <span class="comment">/**</span>
<a name="l1304"><span class="linenum">1304</span></a>  <span class="comment">     * Returns true if a given Unicode codepoint is a valid character in XML.</span>
<a name="l1305"><span class="linenum">1305</span></a>  <span class="comment">     * @param $codepoint Integer</span>
<a name="l1306"><span class="linenum">1306</span></a>  <span class="comment">     * @return Boolean</span>
<a name="l1307"><span class="linenum">1307</span></a>  <span class="comment">     */</span>
<a name="l1308"><span class="linenum">1308</span></a>  	private static function <a class="function" onClick="logFunction('validateCodepoint')" href="../../_functions/validatecodepoint.html" onMouseOver="funcPopup(event,'validatecodepoint')">validateCodepoint</a>( <a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('codepoint')" href="../../_variables/codepoint.html">$codepoint</a> ) {
<a name="l1309"><span class="linenum">1309</span></a>          return (<a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('codepoint')" href="../../_variables/codepoint.html">$codepoint</a> ==    0x09)
<a name="l1310"><span class="linenum">1310</span></a>              || (<a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('codepoint')" href="../../_variables/codepoint.html">$codepoint</a> ==    0x0a)
<a name="l1311"><span class="linenum">1311</span></a>              || (<a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('codepoint')" href="../../_variables/codepoint.html">$codepoint</a> ==    0x0d)
<a name="l1312"><span class="linenum">1312</span></a>              || (<a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('codepoint')" href="../../_variables/codepoint.html">$codepoint</a> &gt;=    0x20 &amp;&amp; <a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('codepoint')" href="../../_variables/codepoint.html">$codepoint</a> &lt;=   0xd7ff)
<a name="l1313"><span class="linenum">1313</span></a>              || (<a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('codepoint')" href="../../_variables/codepoint.html">$codepoint</a> &gt;=  0xe000 &amp;&amp; <a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('codepoint')" href="../../_variables/codepoint.html">$codepoint</a> &lt;=   0xfffd)
<a name="l1314"><span class="linenum">1314</span></a>              || (<a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('codepoint')" href="../../_variables/codepoint.html">$codepoint</a> &gt;= 0x10000 &amp;&amp; <a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('codepoint')" href="../../_variables/codepoint.html">$codepoint</a> &lt;= 0x10ffff);
<a name="l1315"><span class="linenum">1315</span></a>      }
<a name="l1316"><span class="linenum">1316</span></a>  
<a name="l1317"><span class="linenum">1317</span></a>      <span class="comment">/**</span>
<a name="l1318"><span class="linenum">1318</span></a>  <span class="comment">     * Decode any character references, numeric or named entities,</span>
<a name="l1319"><span class="linenum">1319</span></a>  <span class="comment">     * in the text and return a UTF-8 string.</span>
<a name="l1320"><span class="linenum">1320</span></a>  <span class="comment">     *</span>
<a name="l1321"><span class="linenum">1321</span></a>  <span class="comment">     * @param $text String</span>
<a name="l1322"><span class="linenum">1322</span></a>  <span class="comment">     * @return String</span>
<a name="l1323"><span class="linenum">1323</span></a>  <span class="comment">     */</span>
<a name="l1324"><span class="linenum">1324</span></a>  	public static function <a class="function" onClick="logFunction('decodeCharReferences')" href="../../_functions/decodecharreferences.html" onMouseOver="funcPopup(event,'decodecharreferences')">decodeCharReferences</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> ) {
<a name="l1325"><span class="linenum">1325</span></a>          return <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>(
<a name="l1326"><span class="linenum">1326</span></a>              self::CHAR_REFS_REGEX,
<a name="l1327"><span class="linenum">1327</span></a>              array( 'Sanitizer', 'decodeCharReferencesCallback' ),
<a name="l1328"><span class="linenum">1328</span></a>              <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> );
<a name="l1329"><span class="linenum">1329</span></a>      }
<a name="l1330"><span class="linenum">1330</span></a>  
<a name="l1331"><span class="linenum">1331</span></a>      <span class="comment">/**</span>
<a name="l1332"><span class="linenum">1332</span></a>  <span class="comment">     * Decode any character references, numeric or named entities,</span>
<a name="l1333"><span class="linenum">1333</span></a>  <span class="comment">     * in the next and normalize the resulting string. (bug 14952)</span>
<a name="l1334"><span class="linenum">1334</span></a>  <span class="comment">     *</span>
<a name="l1335"><span class="linenum">1335</span></a>  <span class="comment">     * This is useful for page titles, not for text to be displayed,</span>
<a name="l1336"><span class="linenum">1336</span></a>  <span class="comment">     * MediaWiki allows HTML entities to escape normalization as a feature.</span>
<a name="l1337"><span class="linenum">1337</span></a>  <span class="comment">     *</span>
<a name="l1338"><span class="linenum">1338</span></a>  <span class="comment">     * @param string $text (already normalized, containing entities)</span>
<a name="l1339"><span class="linenum">1339</span></a>  <span class="comment">     * @return String (still normalized, without entities)</span>
<a name="l1340"><span class="linenum">1340</span></a>  <span class="comment">     */</span>
<a name="l1341"><span class="linenum">1341</span></a>  	public static function <a class="function" onClick="logFunction('decodeCharReferencesAndNormalize')" href="../../_functions/decodecharreferencesandnormalize.html" onMouseOver="funcPopup(event,'decodecharreferencesandnormalize')">decodeCharReferencesAndNormalize</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> ) {
<a name="l1342"><span class="linenum">1342</span></a>          global <a class="var it7434" onMouseOver="hilite(7434)" onMouseOut="lolite()" onClick="logVariable('wgContLang')" href="../../_variables/wgContLang.html">$wgContLang</a>;
<a name="l1343"><span class="linenum">1343</span></a>          <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>(
<a name="l1344"><span class="linenum">1344</span></a>              self::CHAR_REFS_REGEX,
<a name="l1345"><span class="linenum">1345</span></a>              array( 'Sanitizer', 'decodeCharReferencesCallback' ),
<a name="l1346"><span class="linenum">1346</span></a>              <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>, <span class="comment">/* limit */</span> -1, <a class="var it38" onMouseOver="hilite(38)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a> );
<a name="l1347"><span class="linenum">1347</span></a>  
<a name="l1348"><span class="linenum">1348</span></a>          if ( <a class="var it38" onMouseOver="hilite(38)" onMouseOut="lolite()" onClick="logVariable('count')" href="../../_variables/count.html">$count</a> ) {
<a name="l1349"><span class="linenum">1349</span></a>              return <a class="var it7434" onMouseOver="hilite(7434)" onMouseOut="lolite()" onClick="logVariable('wgContLang')" href="../../_variables/wgContLang.html">$wgContLang</a>-&gt;normalize( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> );
<a name="l1350"><span class="linenum">1350</span></a>          } else {
<a name="l1351"><span class="linenum">1351</span></a>              return <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l1352"><span class="linenum">1352</span></a>          }
<a name="l1353"><span class="linenum">1353</span></a>      }
<a name="l1354"><span class="linenum">1354</span></a>  
<a name="l1355"><span class="linenum">1355</span></a>      <span class="comment">/**</span>
<a name="l1356"><span class="linenum">1356</span></a>  <span class="comment">     * @param $matches String</span>
<a name="l1357"><span class="linenum">1357</span></a>  <span class="comment">     * @return String</span>
<a name="l1358"><span class="linenum">1358</span></a>  <span class="comment">     */</span>
<a name="l1359"><span class="linenum">1359</span></a>  	static function <a class="function" onClick="logFunction('decodeCharReferencesCallback')" href="../../_functions/decodecharreferencescallback.html" onMouseOver="funcPopup(event,'decodecharreferencescallback')">decodeCharReferencesCallback</a>( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a> ) {
<a name="l1360"><span class="linenum">1360</span></a>          if( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1] != '' ) {
<a name="l1361"><span class="linenum">1361</span></a>              return <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('decodeEntity')" href="../../_functions/decodeentity.html" onMouseOver="funcPopup(event,'decodeentity')">decodeEntity</a>( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[1] );
<a name="l1362"><span class="linenum">1362</span></a>          } elseif( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2] != '' ) {
<a name="l1363"><span class="linenum">1363</span></a>              return  <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('decodeChar')" href="../../_functions/decodechar.html" onMouseOver="funcPopup(event,'decodechar')">decodeChar</a>( <a class="phpfunction" onClick="logFunction('intval')" href="../../_functions/intval.html" onMouseOver="phpfuncPopup(event,'intval')">intval</a>( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[2] ) );
<a name="l1364"><span class="linenum">1364</span></a>          } elseif( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[3] != '' ) {
<a name="l1365"><span class="linenum">1365</span></a>              return  <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('decodeChar')" href="../../_functions/decodechar.html" onMouseOver="funcPopup(event,'decodechar')">decodeChar</a>( <a class="phpfunction" onClick="logFunction('hexdec')" href="../../_functions/hexdec.html" onMouseOver="phpfuncPopup(event,'hexdec')">hexdec</a>( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[3] ) );
<a name="l1366"><span class="linenum">1366</span></a>          }
<a name="l1367"><span class="linenum">1367</span></a>  <span class="comment">        # Last case should be an ampersand by itself</span>
<a name="l1368"><span class="linenum">1368</span></a>          return <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[0];
<a name="l1369"><span class="linenum">1369</span></a>      }
<a name="l1370"><span class="linenum">1370</span></a>  
<a name="l1371"><span class="linenum">1371</span></a>      <span class="comment">/**</span>
<a name="l1372"><span class="linenum">1372</span></a>  <span class="comment">     * Return UTF-8 string for a codepoint if that is a valid</span>
<a name="l1373"><span class="linenum">1373</span></a>  <span class="comment">     * character reference, otherwise U+FFFD REPLACEMENT CHARACTER.</span>
<a name="l1374"><span class="linenum">1374</span></a>  <span class="comment">     * @param $codepoint Integer</span>
<a name="l1375"><span class="linenum">1375</span></a>  <span class="comment">     * @return String</span>
<a name="l1376"><span class="linenum">1376</span></a>  <span class="comment">     * @private</span>
<a name="l1377"><span class="linenum">1377</span></a>  <span class="comment">     */</span>
<a name="l1378"><span class="linenum">1378</span></a>  	static function <a class="function" onClick="logFunction('decodeChar')" href="../../_functions/decodechar.html" onMouseOver="funcPopup(event,'decodechar')">decodeChar</a>( <a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('codepoint')" href="../../_variables/codepoint.html">$codepoint</a> ) {
<a name="l1379"><span class="linenum">1379</span></a>          if( <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('validateCodepoint')" href="../../_functions/validatecodepoint.html" onMouseOver="funcPopup(event,'validatecodepoint')">validateCodepoint</a>( <a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('codepoint')" href="../../_variables/codepoint.html">$codepoint</a> ) ) {
<a name="l1380"><span class="linenum">1380</span></a>              return <a class="function" onClick="logFunction('codepointToUtf8')" href="../../_functions/codepointtoutf8.html" onMouseOver="funcPopup(event,'codepointtoutf8')">codepointToUtf8</a>( <a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('codepoint')" href="../../_variables/codepoint.html">$codepoint</a> );
<a name="l1381"><span class="linenum">1381</span></a>          } else {
<a name="l1382"><span class="linenum">1382</span></a>              return UTF8_REPLACEMENT;
<a name="l1383"><span class="linenum">1383</span></a>          }
<a name="l1384"><span class="linenum">1384</span></a>      }
<a name="l1385"><span class="linenum">1385</span></a>  
<a name="l1386"><span class="linenum">1386</span></a>      <span class="comment">/**</span>
<a name="l1387"><span class="linenum">1387</span></a>  <span class="comment">     * If the named entity is defined in the HTML 4.0/XHTML 1.0 DTD,</span>
<a name="l1388"><span class="linenum">1388</span></a>  <span class="comment">     * return the UTF-8 encoding of that character. Otherwise, returns</span>
<a name="l1389"><span class="linenum">1389</span></a>  <span class="comment">     * pseudo-entity source (eg &quot;&amp;foo;&quot;)</span>
<a name="l1390"><span class="linenum">1390</span></a>  <span class="comment">     *</span>
<a name="l1391"><span class="linenum">1391</span></a>  <span class="comment">     * @param $name String</span>
<a name="l1392"><span class="linenum">1392</span></a>  <span class="comment">     * @return String</span>
<a name="l1393"><span class="linenum">1393</span></a>  <span class="comment">     */</span>
<a name="l1394"><span class="linenum">1394</span></a>  	static function <a class="function" onClick="logFunction('decodeEntity')" href="../../_functions/decodeentity.html" onMouseOver="funcPopup(event,'decodeentity')">decodeEntity</a>( <a class="var it164" onMouseOver="hilite(164)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a> ) {
<a name="l1395"><span class="linenum">1395</span></a>          if ( isset( self::<a class="var it7388" onMouseOver="hilite(7388)" onMouseOut="lolite()" onClick="logVariable('htmlEntityAliases')" href="../../_variables/htmlEntityAliases.html">$htmlEntityAliases</a>[<a class="var it164" onMouseOver="hilite(164)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>] ) ) {
<a name="l1396"><span class="linenum">1396</span></a>              <a class="var it164" onMouseOver="hilite(164)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a> = self::<a class="var it7388" onMouseOver="hilite(7388)" onMouseOut="lolite()" onClick="logVariable('htmlEntityAliases')" href="../../_variables/htmlEntityAliases.html">$htmlEntityAliases</a>[<a class="var it164" onMouseOver="hilite(164)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>];
<a name="l1397"><span class="linenum">1397</span></a>          }
<a name="l1398"><span class="linenum">1398</span></a>          if( isset( self::<a class="var it7387" onMouseOver="hilite(7387)" onMouseOut="lolite()" onClick="logVariable('htmlEntities')" href="../../_variables/htmlEntities.html">$htmlEntities</a>[<a class="var it164" onMouseOver="hilite(164)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>] ) ) {
<a name="l1399"><span class="linenum">1399</span></a>              return <a class="function" onClick="logFunction('codepointToUtf8')" href="../../_functions/codepointtoutf8.html" onMouseOver="funcPopup(event,'codepointtoutf8')">codepointToUtf8</a>( self::<a class="var it7387" onMouseOver="hilite(7387)" onMouseOut="lolite()" onClick="logVariable('htmlEntities')" href="../../_variables/htmlEntities.html">$htmlEntities</a>[<a class="var it164" onMouseOver="hilite(164)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>] );
<a name="l1400"><span class="linenum">1400</span></a>          } else {
<a name="l1401"><span class="linenum">1401</span></a>              return &quot;&amp;<a class="var it164" onMouseOver="hilite(164)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../_variables/name.html">$name</a>;&quot;;
<a name="l1402"><span class="linenum">1402</span></a>          }
<a name="l1403"><span class="linenum">1403</span></a>      }
<a name="l1404"><span class="linenum">1404</span></a>  
<a name="l1405"><span class="linenum">1405</span></a>      <span class="comment">/**</span>
<a name="l1406"><span class="linenum">1406</span></a>  <span class="comment">     * Fetch the whitelist of acceptable attributes for a given element name.</span>
<a name="l1407"><span class="linenum">1407</span></a>  <span class="comment">     *</span>
<a name="l1408"><span class="linenum">1408</span></a>  <span class="comment">     * @param $element String</span>
<a name="l1409"><span class="linenum">1409</span></a>  <span class="comment">     * @return Array</span>
<a name="l1410"><span class="linenum">1410</span></a>  <span class="comment">     */</span>
<a name="l1411"><span class="linenum">1411</span></a>  	static function <a class="function" onClick="logFunction('attributeWhitelist')" href="../../_functions/attributewhitelist.html" onMouseOver="funcPopup(event,'attributewhitelist')">attributeWhitelist</a>( <a class="var it904" onMouseOver="hilite(904)" onMouseOut="lolite()" onClick="logVariable('element')" href="../../_variables/element.html">$element</a> ) {
<a name="l1412"><span class="linenum">1412</span></a>          <a class="var it1311" onMouseOver="hilite(1311)" onMouseOut="lolite()" onClick="logVariable('list')" href="../../_variables/list.html">$list</a> = <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('setupAttributeWhitelist')" href="../../_functions/setupattributewhitelist.html" onMouseOver="funcPopup(event,'setupattributewhitelist')">setupAttributeWhitelist</a>();
<a name="l1413"><span class="linenum">1413</span></a>          return isset( <a class="var it1311" onMouseOver="hilite(1311)" onMouseOut="lolite()" onClick="logVariable('list')" href="../../_variables/list.html">$list</a>[<a class="var it904" onMouseOver="hilite(904)" onMouseOut="lolite()" onClick="logVariable('element')" href="../../_variables/element.html">$element</a>] )
<a name="l1414"><span class="linenum">1414</span></a>              ? <a class="var it1311" onMouseOver="hilite(1311)" onMouseOut="lolite()" onClick="logVariable('list')" href="../../_variables/list.html">$list</a>[<a class="var it904" onMouseOver="hilite(904)" onMouseOut="lolite()" onClick="logVariable('element')" href="../../_variables/element.html">$element</a>]
<a name="l1415"><span class="linenum">1415</span></a>              : array();
<a name="l1416"><span class="linenum">1416</span></a>      }
<a name="l1417"><span class="linenum">1417</span></a>  
<a name="l1418"><span class="linenum">1418</span></a>      <span class="comment">/**</span>
<a name="l1419"><span class="linenum">1419</span></a>  <span class="comment">     * Foreach array key (an allowed HTML element), return an array</span>
<a name="l1420"><span class="linenum">1420</span></a>  <span class="comment">     * of allowed attributes</span>
<a name="l1421"><span class="linenum">1421</span></a>  <span class="comment">     * @return Array</span>
<a name="l1422"><span class="linenum">1422</span></a>  <span class="comment">     */</span>
<a name="l1423"><span class="linenum">1423</span></a>  	static function <a class="function" onClick="logFunction('setupAttributeWhitelist')" href="../../_functions/setupattributewhitelist.html" onMouseOver="funcPopup(event,'setupattributewhitelist')">setupAttributeWhitelist</a>() {
<a name="l1424"><span class="linenum">1424</span></a>          global <a class="var it7423" onMouseOver="hilite(7423)" onMouseOut="lolite()" onClick="logVariable('wgAllowRdfaAttributes')" href="../../_variables/wgAllowRdfaAttributes.html">$wgAllowRdfaAttributes</a>, <a class="var it7396" onMouseOver="hilite(7396)" onMouseOut="lolite()" onClick="logVariable('wgHtml5')" href="../../_variables/wgHtml5.html">$wgHtml5</a>, <a class="var it7397" onMouseOver="hilite(7397)" onMouseOut="lolite()" onClick="logVariable('wgAllowMicrodataAttributes')" href="../../_variables/wgAllowMicrodataAttributes.html">$wgAllowMicrodataAttributes</a>;
<a name="l1425"><span class="linenum">1425</span></a>  
<a name="l1426"><span class="linenum">1426</span></a>          static <a class="var it6254" onMouseOver="hilite(6254)" onMouseOut="lolite()" onClick="logVariable('whitelist')" href="../../_variables/whitelist.html">$whitelist</a>, <a class="var it7408" onMouseOver="hilite(7408)" onMouseOut="lolite()" onClick="logVariable('staticInitialised')" href="../../_variables/staticInitialised.html">$staticInitialised</a>;
<a name="l1427"><span class="linenum">1427</span></a>          <a class="var it7409" onMouseOver="hilite(7409)" onMouseOut="lolite()" onClick="logVariable('globalContext')" href="../../_variables/globalContext.html">$globalContext</a> = <a class="phpfunction" onClick="logFunction('implode')" href="../../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>( '-', <a class="phpfunction" onClick="logFunction('compact')" href="../../_functions/compact.html" onMouseOver="phpfuncPopup(event,'compact')">compact</a>( 'wgAllowRdfaAttributes', 'wgHtml5', 'wgAllowMicrodataAttributes' ) );
<a name="l1428"><span class="linenum">1428</span></a>  
<a name="l1429"><span class="linenum">1429</span></a>          if ( isset( <a class="var it6254" onMouseOver="hilite(6254)" onMouseOut="lolite()" onClick="logVariable('whitelist')" href="../../_variables/whitelist.html">$whitelist</a> ) &amp;&amp; <a class="var it7408" onMouseOver="hilite(7408)" onMouseOut="lolite()" onClick="logVariable('staticInitialised')" href="../../_variables/staticInitialised.html">$staticInitialised</a> == <a class="var it7409" onMouseOver="hilite(7409)" onMouseOut="lolite()" onClick="logVariable('globalContext')" href="../../_variables/globalContext.html">$globalContext</a> ) {
<a name="l1430"><span class="linenum">1430</span></a>              return <a class="var it6254" onMouseOver="hilite(6254)" onMouseOut="lolite()" onClick="logVariable('whitelist')" href="../../_variables/whitelist.html">$whitelist</a>;
<a name="l1431"><span class="linenum">1431</span></a>          }
<a name="l1432"><span class="linenum">1432</span></a>  
<a name="l1433"><span class="linenum">1433</span></a>          <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a> = array(
<a name="l1434"><span class="linenum">1434</span></a>  <span class="comment">            # HTML</span>
<a name="l1435"><span class="linenum">1435</span></a>              'id',
<a name="l1436"><span class="linenum">1436</span></a>              'class',
<a name="l1437"><span class="linenum">1437</span></a>              'style',
<a name="l1438"><span class="linenum">1438</span></a>              'lang',
<a name="l1439"><span class="linenum">1439</span></a>              'dir',
<a name="l1440"><span class="linenum">1440</span></a>              'title',
<a name="l1441"><span class="linenum">1441</span></a>  
<a name="l1442"><span class="linenum">1442</span></a>  <span class="comment">            # WAI-ARIA</span>
<a name="l1443"><span class="linenum">1443</span></a>              'role',
<a name="l1444"><span class="linenum">1444</span></a>          );
<a name="l1445"><span class="linenum">1445</span></a>  
<a name="l1446"><span class="linenum">1446</span></a>          if ( <a class="var it7423" onMouseOver="hilite(7423)" onMouseOut="lolite()" onClick="logVariable('wgAllowRdfaAttributes')" href="../../_variables/wgAllowRdfaAttributes.html">$wgAllowRdfaAttributes</a> ) {
<a name="l1447"><span class="linenum">1447</span></a>  <span class="comment">            #RDFa attributes as specified in section 9 of http://www.w3.org/TR/2008/REC-rdfa-syntax-20081014</span>
<a name="l1448"><span class="linenum">1448</span></a>              <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, array(
<a name="l1449"><span class="linenum">1449</span></a>                  'about', 'property', 'resource', 'datatype', 'typeof',
<a name="l1450"><span class="linenum">1450</span></a>              ) );
<a name="l1451"><span class="linenum">1451</span></a>          }
<a name="l1452"><span class="linenum">1452</span></a>  
<a name="l1453"><span class="linenum">1453</span></a>          if ( <a class="var it7396" onMouseOver="hilite(7396)" onMouseOut="lolite()" onClick="logVariable('wgHtml5')" href="../../_variables/wgHtml5.html">$wgHtml5</a> &amp;&amp; <a class="var it7397" onMouseOver="hilite(7397)" onMouseOut="lolite()" onClick="logVariable('wgAllowMicrodataAttributes')" href="../../_variables/wgAllowMicrodataAttributes.html">$wgAllowMicrodataAttributes</a> ) {
<a name="l1454"><span class="linenum">1454</span></a>  <span class="comment">            # add HTML5 microdata tags as specified by http://www.whatwg.org/specs/web-apps/current-work/multipage/microdata.html#the-microdata-model</span>
<a name="l1455"><span class="linenum">1455</span></a>              <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, array(
<a name="l1456"><span class="linenum">1456</span></a>                  'itemid', 'itemprop', 'itemref', 'itemscope', 'itemtype'
<a name="l1457"><span class="linenum">1457</span></a>              ) );
<a name="l1458"><span class="linenum">1458</span></a>          }
<a name="l1459"><span class="linenum">1459</span></a>  
<a name="l1460"><span class="linenum">1460</span></a>          <a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, array( 'align' ) );
<a name="l1461"><span class="linenum">1461</span></a>          <a class="var it7436" onMouseOver="hilite(7436)" onMouseOut="lolite()" onClick="logVariable('tablealign')" href="../../_variables/tablealign.html">$tablealign</a> = array( 'align', 'char', 'charoff', 'valign' );
<a name="l1462"><span class="linenum">1462</span></a>          <a class="var it7437" onMouseOver="hilite(7437)" onMouseOut="lolite()" onClick="logVariable('tablecell')" href="../../_variables/tablecell.html">$tablecell</a> = array( 'abbr',
<a name="l1463"><span class="linenum">1463</span></a>                              'axis',
<a name="l1464"><span class="linenum">1464</span></a>                              'headers',
<a name="l1465"><span class="linenum">1465</span></a>                              'scope',
<a name="l1466"><span class="linenum">1466</span></a>                              'rowspan',
<a name="l1467"><span class="linenum">1467</span></a>                              'colspan',
<a name="l1468"><span class="linenum">1468</span></a>                              'nowrap', # deprecated
<a name="l1469"><span class="linenum">1469</span></a>                              'width',  # deprecated
<a name="l1470"><span class="linenum">1470</span></a>                              'height', # deprecated
<a name="l1471"><span class="linenum">1471</span></a>                              'bgcolor' # deprecated
<a name="l1472"><span class="linenum">1472</span></a>                              );
<a name="l1473"><span class="linenum">1473</span></a>  
<a name="l1474"><span class="linenum">1474</span></a>  <span class="comment">        # Numbers refer to sections in HTML 4.01 standard describing the element.</span>
<a name="l1475"><span class="linenum">1475</span></a>  <span class="comment">        # See: http://www.w3.org/TR/html4/</span>
<a name="l1476"><span class="linenum">1476</span></a>          <a class="var it6254" onMouseOver="hilite(6254)" onMouseOut="lolite()" onClick="logVariable('whitelist')" href="../../_variables/whitelist.html">$whitelist</a> = array(
<a name="l1477"><span class="linenum">1477</span></a>  <span class="comment">            # 7.5.4</span>
<a name="l1478"><span class="linenum">1478</span></a>              'div'        =&gt; <a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a>,
<a name="l1479"><span class="linenum">1479</span></a>              'center'     =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, # deprecated
<a name="l1480"><span class="linenum">1480</span></a>              'span'       =&gt; <a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a>, # ??
<a name="l1481"><span class="linenum">1481</span></a>  
<a name="l1482"><span class="linenum">1482</span></a>  <span class="comment">            # 7.5.5</span>
<a name="l1483"><span class="linenum">1483</span></a>              'h1'         =&gt; <a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a>,
<a name="l1484"><span class="linenum">1484</span></a>              'h2'         =&gt; <a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a>,
<a name="l1485"><span class="linenum">1485</span></a>              'h3'         =&gt; <a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a>,
<a name="l1486"><span class="linenum">1486</span></a>              'h4'         =&gt; <a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a>,
<a name="l1487"><span class="linenum">1487</span></a>              'h5'         =&gt; <a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a>,
<a name="l1488"><span class="linenum">1488</span></a>              'h6'         =&gt; <a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a>,
<a name="l1489"><span class="linenum">1489</span></a>  
<a name="l1490"><span class="linenum">1490</span></a>  <span class="comment">            # 7.5.6</span>
<a name="l1491"><span class="linenum">1491</span></a>  <span class="comment">            # address</span>
<a name="l1492"><span class="linenum">1492</span></a>  
<a name="l1493"><span class="linenum">1493</span></a>  <span class="comment">            # 8.2.4</span>
<a name="l1494"><span class="linenum">1494</span></a>  <span class="comment">            # bdo</span>
<a name="l1495"><span class="linenum">1495</span></a>  
<a name="l1496"><span class="linenum">1496</span></a>  <span class="comment">            # 9.2.1</span>
<a name="l1497"><span class="linenum">1497</span></a>              'em'         =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1498"><span class="linenum">1498</span></a>              'strong'     =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1499"><span class="linenum">1499</span></a>              'cite'       =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1500"><span class="linenum">1500</span></a>              'dfn'        =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1501"><span class="linenum">1501</span></a>              'code'       =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1502"><span class="linenum">1502</span></a>              'samp'       =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1503"><span class="linenum">1503</span></a>              'kbd'        =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1504"><span class="linenum">1504</span></a>              'var'        =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1505"><span class="linenum">1505</span></a>              'abbr'       =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1506"><span class="linenum">1506</span></a>  <span class="comment">            # acronym</span>
<a name="l1507"><span class="linenum">1507</span></a>  
<a name="l1508"><span class="linenum">1508</span></a>  <span class="comment">            # 9.2.2</span>
<a name="l1509"><span class="linenum">1509</span></a>              'blockquote' =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, array( 'cite' ) ),
<a name="l1510"><span class="linenum">1510</span></a>  <span class="comment">            # q</span>
<a name="l1511"><span class="linenum">1511</span></a>  
<a name="l1512"><span class="linenum">1512</span></a>  <span class="comment">            # 9.2.3</span>
<a name="l1513"><span class="linenum">1513</span></a>              'sub'        =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1514"><span class="linenum">1514</span></a>              'sup'        =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1515"><span class="linenum">1515</span></a>  
<a name="l1516"><span class="linenum">1516</span></a>  <span class="comment">            # 9.3.1</span>
<a name="l1517"><span class="linenum">1517</span></a>              'p'          =&gt; <a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('block')" href="../../_variables/block.html">$block</a>,
<a name="l1518"><span class="linenum">1518</span></a>  
<a name="l1519"><span class="linenum">1519</span></a>  <span class="comment">            # 9.3.2</span>
<a name="l1520"><span class="linenum">1520</span></a>              'br'         =&gt; array( 'id', 'class', 'title', 'style', 'clear' ),
<a name="l1521"><span class="linenum">1521</span></a>  
<a name="l1522"><span class="linenum">1522</span></a>  <span class="comment">            # 9.3.4</span>
<a name="l1523"><span class="linenum">1523</span></a>              'pre'        =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, array( 'width' ) ),
<a name="l1524"><span class="linenum">1524</span></a>  
<a name="l1525"><span class="linenum">1525</span></a>  <span class="comment">            # 9.4</span>
<a name="l1526"><span class="linenum">1526</span></a>              'ins'        =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, array( 'cite', 'datetime' ) ),
<a name="l1527"><span class="linenum">1527</span></a>              'del'        =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, array( 'cite', 'datetime' ) ),
<a name="l1528"><span class="linenum">1528</span></a>  
<a name="l1529"><span class="linenum">1529</span></a>  <span class="comment">            # 10.2</span>
<a name="l1530"><span class="linenum">1530</span></a>              'ul'         =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, array( 'type' ) ),
<a name="l1531"><span class="linenum">1531</span></a>              'ol'         =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, array( 'type', 'start' ) ),
<a name="l1532"><span class="linenum">1532</span></a>              'li'         =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, array( 'type', 'value' ) ),
<a name="l1533"><span class="linenum">1533</span></a>  
<a name="l1534"><span class="linenum">1534</span></a>  <span class="comment">            # 10.3</span>
<a name="l1535"><span class="linenum">1535</span></a>              'dl'         =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1536"><span class="linenum">1536</span></a>              'dd'         =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1537"><span class="linenum">1537</span></a>              'dt'         =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1538"><span class="linenum">1538</span></a>  
<a name="l1539"><span class="linenum">1539</span></a>  <span class="comment">            # 11.2.1</span>
<a name="l1540"><span class="linenum">1540</span></a>              'table'      =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1541"><span class="linenum">1541</span></a>                                  array( 'summary', 'width', 'border', 'frame',
<a name="l1542"><span class="linenum">1542</span></a>                                          'rules', 'cellspacing', 'cellpadding',
<a name="l1543"><span class="linenum">1543</span></a>                                          'align', 'bgcolor',
<a name="l1544"><span class="linenum">1544</span></a>                                  ) ),
<a name="l1545"><span class="linenum">1545</span></a>  
<a name="l1546"><span class="linenum">1546</span></a>  <span class="comment">            # 11.2.2</span>
<a name="l1547"><span class="linenum">1547</span></a>              'caption'    =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, array( 'align' ) ),
<a name="l1548"><span class="linenum">1548</span></a>  
<a name="l1549"><span class="linenum">1549</span></a>  <span class="comment">            # 11.2.3</span>
<a name="l1550"><span class="linenum">1550</span></a>              'thead'      =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, <a class="var it7436" onMouseOver="hilite(7436)" onMouseOut="lolite()" onClick="logVariable('tablealign')" href="../../_variables/tablealign.html">$tablealign</a> ),
<a name="l1551"><span class="linenum">1551</span></a>              'tfoot'      =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, <a class="var it7436" onMouseOver="hilite(7436)" onMouseOut="lolite()" onClick="logVariable('tablealign')" href="../../_variables/tablealign.html">$tablealign</a> ),
<a name="l1552"><span class="linenum">1552</span></a>              'tbody'      =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, <a class="var it7436" onMouseOver="hilite(7436)" onMouseOut="lolite()" onClick="logVariable('tablealign')" href="../../_variables/tablealign.html">$tablealign</a> ),
<a name="l1553"><span class="linenum">1553</span></a>  
<a name="l1554"><span class="linenum">1554</span></a>  <span class="comment">            # 11.2.4</span>
<a name="l1555"><span class="linenum">1555</span></a>              'colgroup'   =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, array( 'span', 'width' ), <a class="var it7436" onMouseOver="hilite(7436)" onMouseOut="lolite()" onClick="logVariable('tablealign')" href="../../_variables/tablealign.html">$tablealign</a> ),
<a name="l1556"><span class="linenum">1556</span></a>              'col'        =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, array( 'span', 'width' ), <a class="var it7436" onMouseOver="hilite(7436)" onMouseOut="lolite()" onClick="logVariable('tablealign')" href="../../_variables/tablealign.html">$tablealign</a> ),
<a name="l1557"><span class="linenum">1557</span></a>  
<a name="l1558"><span class="linenum">1558</span></a>  <span class="comment">            # 11.2.5</span>
<a name="l1559"><span class="linenum">1559</span></a>              'tr'         =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, array( 'bgcolor' ), <a class="var it7436" onMouseOver="hilite(7436)" onMouseOut="lolite()" onClick="logVariable('tablealign')" href="../../_variables/tablealign.html">$tablealign</a> ),
<a name="l1560"><span class="linenum">1560</span></a>  
<a name="l1561"><span class="linenum">1561</span></a>  <span class="comment">            # 11.2.6</span>
<a name="l1562"><span class="linenum">1562</span></a>              'td'         =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, <a class="var it7437" onMouseOver="hilite(7437)" onMouseOut="lolite()" onClick="logVariable('tablecell')" href="../../_variables/tablecell.html">$tablecell</a>, <a class="var it7436" onMouseOver="hilite(7436)" onMouseOut="lolite()" onClick="logVariable('tablealign')" href="../../_variables/tablealign.html">$tablealign</a> ),
<a name="l1563"><span class="linenum">1563</span></a>              'th'         =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, <a class="var it7437" onMouseOver="hilite(7437)" onMouseOut="lolite()" onClick="logVariable('tablecell')" href="../../_variables/tablecell.html">$tablecell</a>, <a class="var it7436" onMouseOver="hilite(7436)" onMouseOut="lolite()" onClick="logVariable('tablealign')" href="../../_variables/tablealign.html">$tablealign</a> ),
<a name="l1564"><span class="linenum">1564</span></a>  
<a name="l1565"><span class="linenum">1565</span></a>  <span class="comment">            # 12.2 # NOTE: &lt;a&gt; is not allowed directly, but the attrib whitelist is used from the Parser object</span>
<a name="l1566"><span class="linenum">1566</span></a>              'a'          =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, array( 'href', 'rel', 'rev' ) ), # rel/rev esp. for RDFa
<a name="l1567"><span class="linenum">1567</span></a>  
<a name="l1568"><span class="linenum">1568</span></a>  <span class="comment">            # 13.2</span>
<a name="l1569"><span class="linenum">1569</span></a>  <span class="comment">            # Not usually allowed, but may be used for extension-style hooks</span>
<a name="l1570"><span class="linenum">1570</span></a>  <span class="comment">            # such as &lt;math&gt; when it is rasterized, or if $wgAllowImageTag is</span>
<a name="l1571"><span class="linenum">1571</span></a>  <span class="comment">            # true</span>
<a name="l1572"><span class="linenum">1572</span></a>              'img'        =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, array( 'alt', 'src', 'width', 'height' ) ),
<a name="l1573"><span class="linenum">1573</span></a>  
<a name="l1574"><span class="linenum">1574</span></a>  <span class="comment">            # 15.2.1</span>
<a name="l1575"><span class="linenum">1575</span></a>              'tt'         =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1576"><span class="linenum">1576</span></a>              'b'          =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1577"><span class="linenum">1577</span></a>              'i'          =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1578"><span class="linenum">1578</span></a>              'big'        =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1579"><span class="linenum">1579</span></a>              'small'      =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1580"><span class="linenum">1580</span></a>              'strike'     =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1581"><span class="linenum">1581</span></a>              's'          =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1582"><span class="linenum">1582</span></a>              'u'          =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1583"><span class="linenum">1583</span></a>  
<a name="l1584"><span class="linenum">1584</span></a>  <span class="comment">            # 15.2.2</span>
<a name="l1585"><span class="linenum">1585</span></a>              'font'       =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, array( 'size', 'color', 'face' ) ),
<a name="l1586"><span class="linenum">1586</span></a>  <span class="comment">            # basefont</span>
<a name="l1587"><span class="linenum">1587</span></a>  
<a name="l1588"><span class="linenum">1588</span></a>  <span class="comment">            # 15.3</span>
<a name="l1589"><span class="linenum">1589</span></a>              'hr'         =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, array( 'noshade', 'size', 'width' ) ),
<a name="l1590"><span class="linenum">1590</span></a>  
<a name="l1591"><span class="linenum">1591</span></a>  <span class="comment">            # XHTML Ruby annotation text module, simple ruby only.</span>
<a name="l1592"><span class="linenum">1592</span></a>  <span class="comment">            # http://www.w3c.org/TR/ruby/</span>
<a name="l1593"><span class="linenum">1593</span></a>              'ruby'       =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1594"><span class="linenum">1594</span></a>  <span class="comment">            # rbc</span>
<a name="l1595"><span class="linenum">1595</span></a>  <span class="comment">            # rtc</span>
<a name="l1596"><span class="linenum">1596</span></a>              'rb'         =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1597"><span class="linenum">1597</span></a>              'rt'         =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, #<a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, array( 'rbspan' ) ),
<a name="l1598"><span class="linenum">1598</span></a>              'rp'         =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1599"><span class="linenum">1599</span></a>  
<a name="l1600"><span class="linenum">1600</span></a>  <span class="comment">            # MathML root element, where used for extensions</span>
<a name="l1601"><span class="linenum">1601</span></a>  <span class="comment">            # 'title' may not be 100% valid here; it's XHTML</span>
<a name="l1602"><span class="linenum">1602</span></a>  <span class="comment">            # http://www.w3.org/TR/REC-MathML/</span>
<a name="l1603"><span class="linenum">1603</span></a>              'math'       =&gt; array( 'class', 'style', 'id', 'title' ),
<a name="l1604"><span class="linenum">1604</span></a>  
<a name="l1605"><span class="linenum">1605</span></a>  <span class="comment">            # HTML 5 section 4.6</span>
<a name="l1606"><span class="linenum">1606</span></a>              'bdi' =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1607"><span class="linenum">1607</span></a>  
<a name="l1608"><span class="linenum">1608</span></a>          );
<a name="l1609"><span class="linenum">1609</span></a>  
<a name="l1610"><span class="linenum">1610</span></a>          if ( <a class="var it7396" onMouseOver="hilite(7396)" onMouseOut="lolite()" onClick="logVariable('wgHtml5')" href="../../_variables/wgHtml5.html">$wgHtml5</a> ) {
<a name="l1611"><span class="linenum">1611</span></a>  <span class="comment">            # HTML5 elements, defined by:</span>
<a name="l1612"><span class="linenum">1612</span></a>  <span class="comment">            # http://www.whatwg.org/specs/web-apps/current-work/multipage/</span>
<a name="l1613"><span class="linenum">1613</span></a>              <a class="var it6254" onMouseOver="hilite(6254)" onMouseOut="lolite()" onClick="logVariable('whitelist')" href="../../_variables/whitelist.html">$whitelist</a> += array(
<a name="l1614"><span class="linenum">1614</span></a>                  'data' =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, array( 'value' ) ),
<a name="l1615"><span class="linenum">1615</span></a>                  'time' =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>( <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>, array( 'datetime' ) ),
<a name="l1616"><span class="linenum">1616</span></a>                  'mark' =&gt; <a class="var it7435" onMouseOver="hilite(7435)" onMouseOut="lolite()" onClick="logVariable('common')" href="../../_variables/common.html">$common</a>,
<a name="l1617"><span class="linenum">1617</span></a>  
<a name="l1618"><span class="linenum">1618</span></a>  <span class="comment">                // meta and link are only permitted by removeHTMLtags when Microdata</span>
<a name="l1619"><span class="linenum">1619</span></a>  <span class="comment">                // is enabled so we don't bother adding a conditional to hide these</span>
<a name="l1620"><span class="linenum">1620</span></a>  <span class="comment">                // Also meta and link are only valid in WikiText as Microdata elements</span>
<a name="l1621"><span class="linenum">1621</span></a>  <span class="comment">                // (ie: validateTag rejects tags missing the attributes needed for Microdata)</span>
<a name="l1622"><span class="linenum">1622</span></a>  <span class="comment">                // So we don't bother including $common attributes that have no purpose.</span>
<a name="l1623"><span class="linenum">1623</span></a>                  'meta' =&gt; array( 'itemprop', 'content' ),
<a name="l1624"><span class="linenum">1624</span></a>                  'link' =&gt; array( 'itemprop', 'href' ),
<a name="l1625"><span class="linenum">1625</span></a>              );
<a name="l1626"><span class="linenum">1626</span></a>          }
<a name="l1627"><span class="linenum">1627</span></a>  
<a name="l1628"><span class="linenum">1628</span></a>          <a class="var it7408" onMouseOver="hilite(7408)" onMouseOut="lolite()" onClick="logVariable('staticInitialised')" href="../../_variables/staticInitialised.html">$staticInitialised</a> = <a class="var it7409" onMouseOver="hilite(7409)" onMouseOut="lolite()" onClick="logVariable('globalContext')" href="../../_variables/globalContext.html">$globalContext</a>;
<a name="l1629"><span class="linenum">1629</span></a>  
<a name="l1630"><span class="linenum">1630</span></a>          return <a class="var it6254" onMouseOver="hilite(6254)" onMouseOut="lolite()" onClick="logVariable('whitelist')" href="../../_variables/whitelist.html">$whitelist</a>;
<a name="l1631"><span class="linenum">1631</span></a>      }
<a name="l1632"><span class="linenum">1632</span></a>  
<a name="l1633"><span class="linenum">1633</span></a>      <span class="comment">/**</span>
<a name="l1634"><span class="linenum">1634</span></a>  <span class="comment">     * Take a fragment of (potentially invalid) HTML and return</span>
<a name="l1635"><span class="linenum">1635</span></a>  <span class="comment">     * a version with any tags removed, encoded as plain text.</span>
<a name="l1636"><span class="linenum">1636</span></a>  <span class="comment">     *</span>
<a name="l1637"><span class="linenum">1637</span></a>  <span class="comment">     * Warning: this return value must be further escaped for literal</span>
<a name="l1638"><span class="linenum">1638</span></a>  <span class="comment">     * inclusion in HTML output as of 1.10!</span>
<a name="l1639"><span class="linenum">1639</span></a>  <span class="comment">     *</span>
<a name="l1640"><span class="linenum">1640</span></a>  <span class="comment">     * @param string $text HTML fragment</span>
<a name="l1641"><span class="linenum">1641</span></a>  <span class="comment">     * @return String</span>
<a name="l1642"><span class="linenum">1642</span></a>  <span class="comment">     */</span>
<a name="l1643"><span class="linenum">1643</span></a>  	static function <a class="function" onClick="logFunction('stripAllTags')" href="../../_functions/stripalltags.html" onMouseOver="funcPopup(event,'stripalltags')">stripAllTags</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> ) {
<a name="l1644"><span class="linenum">1644</span></a>  <span class="comment">        # Actual &lt;tags&gt;</span>
<a name="l1645"><span class="linenum">1645</span></a>          <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = <a class="class" onClick="logClass('StringUtils')" href="../../_classes/stringutils.html" onMouseOver="classPopup(event,'stringutils')">StringUtils</a>::<a class="function" onClick="logFunction('delimiterReplace')" href="../../_functions/delimiterreplace.html" onMouseOver="funcPopup(event,'delimiterreplace')">delimiterReplace</a>( '&lt;', '&gt;', '', <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> );
<a name="l1646"><span class="linenum">1646</span></a>  
<a name="l1647"><span class="linenum">1647</span></a>  <span class="comment">        # Normalize &amp;entities and whitespace</span>
<a name="l1648"><span class="linenum">1648</span></a>          <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = self::<a class="function" onClick="logFunction('decodeCharReferences')" href="../../_functions/decodecharreferences.html" onMouseOver="funcPopup(event,'decodecharreferences')">decodeCharReferences</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> );
<a name="l1649"><span class="linenum">1649</span></a>          <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> = self::<a class="function" onClick="logFunction('normalizeWhitespace')" href="../../_functions/normalizewhitespace.html" onMouseOver="funcPopup(event,'normalizewhitespace')">normalizeWhitespace</a>( <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a> );
<a name="l1650"><span class="linenum">1650</span></a>  
<a name="l1651"><span class="linenum">1651</span></a>          return <a class="var it80" onMouseOver="hilite(80)" onMouseOut="lolite()" onClick="logVariable('text')" href="../../_variables/text.html">$text</a>;
<a name="l1652"><span class="linenum">1652</span></a>      }
<a name="l1653"><span class="linenum">1653</span></a>  
<a name="l1654"><span class="linenum">1654</span></a>      <span class="comment">/**</span>
<a name="l1655"><span class="linenum">1655</span></a>  <span class="comment">     * Hack up a private DOCTYPE with HTML's standard entity declarations.</span>
<a name="l1656"><span class="linenum">1656</span></a>  <span class="comment">     * PHP 4 seemed to know these if you gave it an HTML doctype, but</span>
<a name="l1657"><span class="linenum">1657</span></a>  <span class="comment">     * PHP 5.1 doesn't.</span>
<a name="l1658"><span class="linenum">1658</span></a>  <span class="comment">     *</span>
<a name="l1659"><span class="linenum">1659</span></a>  <span class="comment">     * Use for passing XHTML fragments to PHP's XML parsing functions</span>
<a name="l1660"><span class="linenum">1660</span></a>  <span class="comment">     *</span>
<a name="l1661"><span class="linenum">1661</span></a>  <span class="comment">     * @return String</span>
<a name="l1662"><span class="linenum">1662</span></a>  <span class="comment">     */</span>
<a name="l1663"><span class="linenum">1663</span></a>  	static function <a class="function" onClick="logFunction('hackDocType')" href="../../_functions/hackdoctype.html" onMouseOver="funcPopup(event,'hackdoctype')">hackDocType</a>() {
<a name="l1664"><span class="linenum">1664</span></a>          <a class="var it283" onMouseOver="hilite(283)" onMouseOut="lolite()" onClick="logVariable('out')" href="../../_variables/out.html">$out</a> = &quot;&lt;!DOCTYPE html [\n&quot;;
<a name="l1665"><span class="linenum">1665</span></a>          foreach( self::<a class="var it7387" onMouseOver="hilite(7387)" onMouseOut="lolite()" onClick="logVariable('htmlEntities')" href="../../_variables/htmlEntities.html">$htmlEntities</a> as <a class="var it2742" onMouseOver="hilite(2742)" onMouseOut="lolite()" onClick="logVariable('entity')" href="../../_variables/entity.html">$entity</a> =&gt; <a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('codepoint')" href="../../_variables/codepoint.html">$codepoint</a> ) {
<a name="l1666"><span class="linenum">1666</span></a>              <a class="var it283" onMouseOver="hilite(283)" onMouseOut="lolite()" onClick="logVariable('out')" href="../../_variables/out.html">$out</a> .= &quot;&lt;!ENTITY <a class="var it2742" onMouseOver="hilite(2742)" onMouseOut="lolite()" onClick="logVariable('entity')" href="../../_variables/entity.html">$entity</a> \&quot;&amp;#<a class="var it5444" onMouseOver="hilite(5444)" onMouseOut="lolite()" onClick="logVariable('codepoint')" href="../../_variables/codepoint.html">$codepoint</a>;\&quot;&gt;&quot;;
<a name="l1667"><span class="linenum">1667</span></a>          }
<a name="l1668"><span class="linenum">1668</span></a>          <a class="var it283" onMouseOver="hilite(283)" onMouseOut="lolite()" onClick="logVariable('out')" href="../../_variables/out.html">$out</a> .= &quot;]&gt;\n&quot;;
<a name="l1669"><span class="linenum">1669</span></a>          return <a class="var it283" onMouseOver="hilite(283)" onMouseOut="lolite()" onClick="logVariable('out')" href="../../_variables/out.html">$out</a>;
<a name="l1670"><span class="linenum">1670</span></a>      }
<a name="l1671"><span class="linenum">1671</span></a>  
<a name="l1672"><span class="linenum">1672</span></a>      <span class="comment">/**</span>
<a name="l1673"><span class="linenum">1673</span></a>  <span class="comment">     * @param $url string</span>
<a name="l1674"><span class="linenum">1674</span></a>  <span class="comment">     * @return mixed|string</span>
<a name="l1675"><span class="linenum">1675</span></a>  <span class="comment">     */</span>
<a name="l1676"><span class="linenum">1676</span></a>  	static function <a class="function" onClick="logFunction('cleanUrl')" href="../../_functions/cleanurl.html" onMouseOver="funcPopup(event,'cleanurl')">cleanUrl</a>( <a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> ) {
<a name="l1677"><span class="linenum">1677</span></a>  <span class="comment">        # Normalize any HTML entities in input. They will be</span>
<a name="l1678"><span class="linenum">1678</span></a>  <span class="comment">        # re-escaped by makeExternalLink().</span>
<a name="l1679"><span class="linenum">1679</span></a>          <a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = <a class="class" onClick="logClass('Sanitizer')" href="../../_classes/sanitizer.html" onMouseOver="classPopup(event,'sanitizer')">Sanitizer</a>::<a class="function" onClick="logFunction('decodeCharReferences')" href="../../_functions/decodecharreferences.html" onMouseOver="funcPopup(event,'decodecharreferences')">decodeCharReferences</a>( <a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> );
<a name="l1680"><span class="linenum">1680</span></a>  
<a name="l1681"><span class="linenum">1681</span></a>  <span class="comment">        # Escape any control characters introduced by the above step</span>
<a name="l1682"><span class="linenum">1682</span></a>          <a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> = <a class="phpfunction" onClick="logFunction('preg_replace_callback')" href="../../_functions/preg_replace_callback.html" onMouseOver="phpfuncPopup(event,'preg_replace_callback')">preg_replace_callback</a>( '/[\][&lt;&gt;&quot;\\x00-\\x20\\x7F\|]/',
<a name="l1683"><span class="linenum">1683</span></a>              array( __CLASS__, 'cleanUrlCallback' ), <a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a> );
<a name="l1684"><span class="linenum">1684</span></a>  
<a name="l1685"><span class="linenum">1685</span></a>  <span class="comment">        # Validate hostname portion</span>
<a name="l1686"><span class="linenum">1686</span></a>          <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a> = array();
<a name="l1687"><span class="linenum">1687</span></a>          if( <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>( '!^([^:]+:)(//[^/]+)?(.*)$!iD', <a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a> ) ) {
<a name="l1688"><span class="linenum">1688</span></a>              <a class="function" onClick="logFunction('list')" href="../../_functions/list.html" onMouseOver="funcPopup(event,'list')">list</a>( <span class="comment">/* $whole */</span>, <a class="var it741" onMouseOver="hilite(741)" onMouseOut="lolite()" onClick="logVariable('protocol')" href="../../_variables/protocol.html">$protocol</a>, <a class="var it2622" onMouseOver="hilite(2622)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../_variables/host.html">$host</a>, <a class="var it7415" onMouseOver="hilite(7415)" onMouseOut="lolite()" onClick="logVariable('rest')" href="../../_variables/rest.html">$rest</a> ) = <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>;
<a name="l1689"><span class="linenum">1689</span></a>  
<a name="l1690"><span class="linenum">1690</span></a>  <span class="comment">            // Characters that will be ignored in IDNs.</span>
<a name="l1691"><span class="linenum">1691</span></a>  <span class="comment">            // http://tools.ietf.org/html/3454#section-3.1</span>
<a name="l1692"><span class="linenum">1692</span></a>  <span class="comment">            // Strip them before further processing so blacklists and such work.</span>
<a name="l1693"><span class="linenum">1693</span></a>              <a class="var it7438" onMouseOver="hilite(7438)" onMouseOut="lolite()" onClick="logVariable('strip')" href="../../_variables/strip.html">$strip</a> = &quot;/
<a name="l1694"><span class="linenum">1694</span></a>                  \\s|          # general whitespace
<a name="l1695"><span class="linenum">1695</span></a>                  \xc2\xad|     # 00ad SOFT HYPHEN
<a name="l1696"><span class="linenum">1696</span></a>                  \xe1\xa0\x86| # 1806 MONGOLIAN TODO SOFT HYPHEN
<a name="l1697"><span class="linenum">1697</span></a>                  \xe2\x80\x8b| # 200b ZERO WIDTH SPACE
<a name="l1698"><span class="linenum">1698</span></a>                  \xe2\x81\xa0| # 2060 WORD JOINER
<a name="l1699"><span class="linenum">1699</span></a>                  \xef\xbb\xbf| # feff ZERO WIDTH NO-BREAK SPACE
<a name="l1700"><span class="linenum">1700</span></a>                  \xcd\x8f|     # 034f COMBINING GRAPHEME JOINER
<a name="l1701"><span class="linenum">1701</span></a>                  \xe1\xa0\x8b| # 180b MONGOLIAN FREE VARIATION SELECTOR ONE
<a name="l1702"><span class="linenum">1702</span></a>                  \xe1\xa0\x8c| # 180c MONGOLIAN FREE VARIATION SELECTOR TWO
<a name="l1703"><span class="linenum">1703</span></a>                  \xe1\xa0\x8d| # 180d MONGOLIAN FREE VARIATION SELECTOR THREE
<a name="l1704"><span class="linenum">1704</span></a>                  \xe2\x80\x8c| # 200c ZERO WIDTH NON-JOINER
<a name="l1705"><span class="linenum">1705</span></a>                  \xe2\x80\x8d| # 200d ZERO WIDTH JOINER
<a name="l1706"><span class="linenum">1706</span></a>                  [\xef\xb8\x80-\xef\xb8\x8f] # fe00-fe0f VARIATION SELECTOR-1-16
<a name="l1707"><span class="linenum">1707</span></a>                  /xuD&quot;;
<a name="l1708"><span class="linenum">1708</span></a>  
<a name="l1709"><span class="linenum">1709</span></a>              <a class="var it2622" onMouseOver="hilite(2622)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../_variables/host.html">$host</a> = <a class="phpfunction" onClick="logFunction('preg_replace')" href="../../_functions/preg_replace.html" onMouseOver="phpfuncPopup(event,'preg_replace')">preg_replace</a>( <a class="var it7438" onMouseOver="hilite(7438)" onMouseOut="lolite()" onClick="logVariable('strip')" href="../../_variables/strip.html">$strip</a>, '', <a class="var it2622" onMouseOver="hilite(2622)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../_variables/host.html">$host</a> );
<a name="l1710"><span class="linenum">1710</span></a>  
<a name="l1711"><span class="linenum">1711</span></a>  <span class="comment">            // @todo FIXME: Validate hostnames here</span>
<a name="l1712"><span class="linenum">1712</span></a>  
<a name="l1713"><span class="linenum">1713</span></a>              return <a class="var it741" onMouseOver="hilite(741)" onMouseOut="lolite()" onClick="logVariable('protocol')" href="../../_variables/protocol.html">$protocol</a> . <a class="var it2622" onMouseOver="hilite(2622)" onMouseOut="lolite()" onClick="logVariable('host')" href="../../_variables/host.html">$host</a> . <a class="var it7415" onMouseOver="hilite(7415)" onMouseOut="lolite()" onClick="logVariable('rest')" href="../../_variables/rest.html">$rest</a>;
<a name="l1714"><span class="linenum">1714</span></a>          } else {
<a name="l1715"><span class="linenum">1715</span></a>              return <a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('url')" href="../../_variables/url.html">$url</a>;
<a name="l1716"><span class="linenum">1716</span></a>          }
<a name="l1717"><span class="linenum">1717</span></a>      }
<a name="l1718"><span class="linenum">1718</span></a>  
<a name="l1719"><span class="linenum">1719</span></a>      <span class="comment">/**</span>
<a name="l1720"><span class="linenum">1720</span></a>  <span class="comment">     * @param $matches array</span>
<a name="l1721"><span class="linenum">1721</span></a>  <span class="comment">     * @return string</span>
<a name="l1722"><span class="linenum">1722</span></a>  <span class="comment">     */</span>
<a name="l1723"><span class="linenum">1723</span></a>  	static function <a class="function" onClick="logFunction('cleanUrlCallback')" href="../../_functions/cleanurlcallback.html" onMouseOver="funcPopup(event,'cleanurlcallback')">cleanUrlCallback</a>( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a> ) {
<a name="l1724"><span class="linenum">1724</span></a>          return <a class="phpfunction" onClick="logFunction('urlencode')" href="../../_functions/urlencode.html" onMouseOver="phpfuncPopup(event,'urlencode')">urlencode</a>( <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('matches')" href="../../_variables/matches.html">$matches</a>[0] );
<a name="l1725"><span class="linenum">1725</span></a>      }
<a name="l1726"><span class="linenum">1726</span></a>  
<a name="l1727"><span class="linenum">1727</span></a>      <span class="comment">/**</span>
<a name="l1728"><span class="linenum">1728</span></a>  <span class="comment">     * Does a string look like an e-mail address?</span>
<a name="l1729"><span class="linenum">1729</span></a>  <span class="comment">     *</span>
<a name="l1730"><span class="linenum">1730</span></a>  <span class="comment">     * This validates an email address using an HTML5 specification found at:</span>
<a name="l1731"><span class="linenum">1731</span></a>  <span class="comment">     * http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#valid-e-mail-address</span>
<a name="l1732"><span class="linenum">1732</span></a>  <span class="comment">     * Which as of 2011-01-24 says:</span>
<a name="l1733"><span class="linenum">1733</span></a>  <span class="comment">     *</span>
<a name="l1734"><span class="linenum">1734</span></a>  <span class="comment">     *   A valid e-mail address is a string that matches the ABNF production</span>
<a name="l1735"><span class="linenum">1735</span></a>  <span class="comment">     *   1*( atext / &quot;.&quot; ) &quot;@&quot; ldh-str *( &quot;.&quot; ldh-str ) where atext is defined</span>
<a name="l1736"><span class="linenum">1736</span></a>  <span class="comment">     *   in RFC 5322 section 3.2.3, and ldh-str is defined in RFC 1034 section</span>
<a name="l1737"><span class="linenum">1737</span></a>  <span class="comment">     *   3.5.</span>
<a name="l1738"><span class="linenum">1738</span></a>  <span class="comment">     *</span>
<a name="l1739"><span class="linenum">1739</span></a>  <span class="comment">     * This function is an implementation of the specification as requested in</span>
<a name="l1740"><span class="linenum">1740</span></a>  <span class="comment">     * bug 22449.</span>
<a name="l1741"><span class="linenum">1741</span></a>  <span class="comment">     *</span>
<a name="l1742"><span class="linenum">1742</span></a>  <span class="comment">     * Client-side forms will use the same standard validation rules via JS or</span>
<a name="l1743"><span class="linenum">1743</span></a>  <span class="comment">     * HTML 5 validation; additional restrictions can be enforced server-side</span>
<a name="l1744"><span class="linenum">1744</span></a>  <span class="comment">     * by extensions via the 'isValidEmailAddr' hook.</span>
<a name="l1745"><span class="linenum">1745</span></a>  <span class="comment">     *</span>
<a name="l1746"><span class="linenum">1746</span></a>  <span class="comment">     * Note that this validation doesn't 100% match RFC 2822, but is believed</span>
<a name="l1747"><span class="linenum">1747</span></a>  <span class="comment">     * to be liberal enough for wide use. Some invalid addresses will still</span>
<a name="l1748"><span class="linenum">1748</span></a>  <span class="comment">     * pass validation here.</span>
<a name="l1749"><span class="linenum">1749</span></a>  <span class="comment">     *</span>
<a name="l1750"><span class="linenum">1750</span></a>  <span class="comment">     * @since 1.18</span>
<a name="l1751"><span class="linenum">1751</span></a>  <span class="comment">     *</span>
<a name="l1752"><span class="linenum">1752</span></a>  <span class="comment">     * @param string $addr E-mail address</span>
<a name="l1753"><span class="linenum">1753</span></a>  <span class="comment">     * @return Bool</span>
<a name="l1754"><span class="linenum">1754</span></a>  <span class="comment">     */</span>
<a name="l1755"><span class="linenum">1755</span></a>  	public static function <a class="function" onClick="logFunction('validateEmail')" href="../../_functions/validateemail.html" onMouseOver="funcPopup(event,'validateemail')">validateEmail</a>( <a class="var it4806" onMouseOver="hilite(4806)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../../_variables/addr.html">$addr</a> ) {
<a name="l1756"><span class="linenum">1756</span></a>          <a class="var it95" onMouseOver="hilite(95)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> = null;
<a name="l1757"><span class="linenum">1757</span></a>          if( !wfRunHooks( 'isValidEmailAddr', array( <a class="var it4806" onMouseOver="hilite(4806)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../../_variables/addr.html">$addr</a>, &amp;<a class="var it95" onMouseOver="hilite(95)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a> ) ) ) {
<a name="l1758"><span class="linenum">1758</span></a>              return <a class="var it95" onMouseOver="hilite(95)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../_variables/result.html">$result</a>;
<a name="l1759"><span class="linenum">1759</span></a>          }
<a name="l1760"><span class="linenum">1760</span></a>  
<a name="l1761"><span class="linenum">1761</span></a>  <span class="comment">        // Please note strings below are enclosed in brackets [], this make the</span>
<a name="l1762"><span class="linenum">1762</span></a>  <span class="comment">        // hyphen &quot;-&quot; a range indicator. Hence it is double backslashed below.</span>
<a name="l1763"><span class="linenum">1763</span></a>  <span class="comment">        // See bug 26948</span>
<a name="l1764"><span class="linenum">1764</span></a>          <a class="var it7439" onMouseOver="hilite(7439)" onMouseOut="lolite()" onClick="logVariable('rfc5322_atext')" href="../../_variables/rfc5322_atext.html">$rfc5322_atext</a> = &quot;a-z0-9!#$%&amp;'*+\\-\/=?^_`{|}~&quot;;
<a name="l1765"><span class="linenum">1765</span></a>          <a class="var it7440" onMouseOver="hilite(7440)" onMouseOut="lolite()" onClick="logVariable('rfc1034_ldh_str')" href="../../_variables/rfc1034_ldh_str.html">$rfc1034_ldh_str</a> = &quot;a-z0-9\\-&quot;;
<a name="l1766"><span class="linenum">1766</span></a>  
<a name="l1767"><span class="linenum">1767</span></a>          <a class="var it7441" onMouseOver="hilite(7441)" onMouseOut="lolite()" onClick="logVariable('HTML5_email_regexp')" href="../../_variables/HTML5_email_regexp.html">$HTML5_email_regexp</a> = &quot;/
<a name="l1768"><span class="linenum">1768</span></a>          ^                      # start of string
<a name="l1769"><span class="linenum">1769</span></a>          [<a class="var it7439" onMouseOver="hilite(7439)" onMouseOut="lolite()" onClick="logVariable('rfc5322_atext')" href="../../_variables/rfc5322_atext.html">$rfc5322_atext</a>\\.]+    # user part which is liberal :p
<a name="l1770"><span class="linenum">1770</span></a>          @                      # 'apostrophe'
<a name="l1771"><span class="linenum">1771</span></a>          [<a class="var it7440" onMouseOver="hilite(7440)" onMouseOut="lolite()" onClick="logVariable('rfc1034_ldh_str')" href="../../_variables/rfc1034_ldh_str.html">$rfc1034_ldh_str</a>]+       # First domain part
<a name="l1772"><span class="linenum">1772</span></a>          (\\.[<a class="var it7440" onMouseOver="hilite(7440)" onMouseOut="lolite()" onClick="logVariable('rfc1034_ldh_str')" href="../../_variables/rfc1034_ldh_str.html">$rfc1034_ldh_str</a>]+)*  # Following part prefixed with a dot
<a name="l1773"><span class="linenum">1773</span></a>          $                      # End of string
<a name="l1774"><span class="linenum">1774</span></a>          /ix&quot;; <span class="comment">// case Insensitive, eXtended</span>
<a name="l1775"><span class="linenum">1775</span></a>  
<a name="l1776"><span class="linenum">1776</span></a>          return (bool) <a class="phpfunction" onClick="logFunction('preg_match')" href="../../_functions/preg_match.html" onMouseOver="phpfuncPopup(event,'preg_match')">preg_match</a>( <a class="var it7441" onMouseOver="hilite(7441)" onMouseOut="lolite()" onClick="logVariable('HTML5_email_regexp')" href="../../_variables/HTML5_email_regexp.html">$HTML5_email_regexp</a>, <a class="var it4806" onMouseOver="hilite(4806)" onMouseOut="lolite()" onClick="logVariable('addr')" href="../../_variables/addr.html">$addr</a> );
<a name="l1777"><span class="linenum">1777</span></a>      }
<a name="l1778"><span class="linenum">1778</span></a>  }
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'normalizecharreferencescallback': ['normalizecharreferencescallback', '', [['plugins/wikitables_plugin','_sanitizer.inc.php',1238]], 0],
'normalizeattributevalue': ['normalizeattributevalue', 'Normalize whitespace and character references in an XML source- encoded text for an attribute value. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',1173]], 0],
'safeencodeattribute': ['safeencodeattribute', 'Encode an attribute value for HTML tags, with extra armoring against further wiki processing. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',963]], 1],
'cleanurlcallback': ['cleanurlcallback', '', [['plugins/wikitables_plugin','_sanitizer.inc.php',1723]], 0],
'decodecharreferences': ['decodecharreferences', 'Decode any character references, numeric or named entities, in the text and return a UTF-8 string. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',1317]], 7],
'gettagattributecallback': ['gettagattributecallback', 'Pick the appropriate attribute value from a match set from the attribs regex matches. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',1143]], 1],
'cleanurl': ['cleanurl', '', [['plugins/wikitables_plugin','_sanitizer.inc.php',1676],['inc/_ext/phpsvnclient','phpsvnclient.php',1032]], 6],
'decodeentity': ['decodeentity', 'If the named entity is defined in the HTML 4.0/XHTML 1.0 DTD, return the UTF-8 encoding of that character. Otherwise, returns pseudo-entity source (eg "&foo;") ', [['plugins/wikitables_plugin','_sanitizer.inc.php',1386]], 1],
'validateemail': ['validateemail', 'Does a string look like an e-mail address? ', [['plugins/wikitables_plugin','_sanitizer.inc.php',1727]], 0],
'normalizesectionnamewhitespace': ['normalizesectionnamewhitespace', 'Normalizes whitespace in a section name, such as might be returned by Parser::stripSectionName(), for use in the id\'s that are used for section links. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',1201]], 0],
'validatetag': ['validatetag', 'Takes attribute names and values for a tag and the tag name and validates that the tag is allowed to be present. This DOES NOT validate the attributes, nor does it validate the tags themselves. This method only handles the special circumstances where we may want to allow a tag within content but ONLY when it has specific attributes set. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',640]], 2],
'getattribsregex': ['getattribsregex', 'Regular expression to match HTML/XML attribute pairs within a tag. Allows some... latitude. Used in Sanitizer::fixTagAttributes and Sanitizer::decodeTagAttributes ', [['plugins/wikitables_plugin','_sanitizer.inc.php',328]], 1],
'removehtmltags': ['removehtmltags', 'Cleans up HTML, removes dangerous tags and attributes, and removes HTML comments ', [['plugins/wikitables_plugin','_sanitizer.inc.php',355]], 0],
'cssdecodecallback': ['cssdecodecallback', '', [['plugins/wikitables_plugin','_sanitizer.inc.php',885]], 0],
'escapeid': ['escapeid', 'Given a value, escape it so that it can be used in an id attribute and return it.  This will use HTML5 validation if $wgExperimentalHtmlIds is true, allowing anything but ASCII whitespace.  Otherwise it will use HTML 4 rules, which means a narrow subset of ASCII, with bad characters escaped with lots of dots. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',996]], 1],
'decodechar': ['decodechar', 'Return UTF-8 string for a codepoint if that is a valid character reference, otherwise U+FFFD REPLACEMENT CHARACTER. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',1371]], 2],
'decodecharreferencescallback': ['decodecharreferencescallback', '', [['plugins/wikitables_plugin','_sanitizer.inc.php',1359]], 0],
'hackdoctype': ['hackdoctype', 'Hack up a private DOCTYPE with HTML\'s standard entity declarations. PHP 4 seemed to know these if you gave it an HTML doctype, but PHP 5.1 doesn\'t. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',1654]], 0],
'validatetagattributes': ['validatetagattributes', 'Take an array of attribute names and values and normalize or discard illegal values for the given element type. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',673]], 1],
'deccharreference': ['deccharreference', '', [['plugins/wikitables_plugin','_sanitizer.inc.php',1281]], 1],
'normalizecharreferences': ['normalizecharreferences', 'Ensure that any entities and character references are legal for XML and XHTML specifically. Any stray bits will be &amp;-escaped to result in a valid text fragment. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',1213]], 1],
'hexcharreference': ['hexcharreference', '', [['plugins/wikitables_plugin','_sanitizer.inc.php',1294]], 1],
'fixtagattributes': ['fixtagattributes', 'Take a tag soup fragment listing an HTML element\'s attributes and normalize it to well-formed XML, discarding unwanted attributes. Output is safe for further wikitext processing, with escaping of values that could trigger problems. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',906]], 5],
'stripalltags': ['stripalltags', 'Take a fragment of (potentially invalid) HTML and return a version with any tags removed, encoded as plain text. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',1633]], 0],
'setupattributewhitelist': ['setupattributewhitelist', 'Foreach array key (an allowed HTML element), return an array of allowed attributes ', [['plugins/wikitables_plugin','_sanitizer.inc.php',1418]], 1],
'codepointtoutf8': ['codepointtoutf8', 'Return UTF-8 sequence for a given Unicode code point. May die if fed out of range data. ', [['plugins/wikitables_plugin','_utf_normal_util.inc.php',28]], 4],
'decodecharreferencesandnormalize': ['decodecharreferencesandnormalize', 'Decode any character references, numeric or named entities, in the next and normalize the resulting string. (bug 14952) ', [['plugins/wikitables_plugin','_sanitizer.inc.php',1331]], 0],
'validateattributes': ['validateattributes', 'Take an array of attribute names and values and normalize or discard illegal values for the given whitelist. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',693]], 1],
'removehtmlcomments': ['removehtmlcomments', 'Remove \'<!--\', \'-->\', and everything between. To avoid leaving blank lines, when a comment is both preceded and followed by a newline (ignoring spaces), trim leading and trailing spaces and one of the newlines. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',595]], 1],
'escapeclass': ['escapeclass', 'Given a value, escape it so that it can be used as a CSS class and return it. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',1060]], 0],
'list': ['list', '', [['rsc/js/bootstrap','typeahead.bundle.js',156]], 105],
'checkcss': ['checkcss', 'Pick apart some CSS and check it for forbidden or unsafe structures. Returns a sanitized string. This sanitized string will have character references and escape sequences decoded, and comments stripped. If the input is just too evil, only a comment complaining about evilness will be returned. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',811]], 1],
'normalizewhitespace': ['normalizewhitespace', '', [['plugins/wikitables_plugin','_sanitizer.inc.php',1194]], 2],
'delimiterreplace': ['delimiterreplace', 'Perform an operation equivalent to ', [['plugins/wikitables_plugin','_string_utils.inc.php',198]], 2],
'validatecodepoint': ['validatecodepoint', 'Returns true if a given Unicode codepoint is a valid character in XML. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',1303]], 3],
'escapehtmlallowentities': ['escapehtmlallowentities', 'Given HTML input, escape with htmlspecialchars but un-escape entities. This allows (generally harmless) entities like &#160; to survive. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',1079]], 0],
'normalizeentity': ['normalizeentity', 'If the named entity is defined in the HTML 4.0/XHTML 1.0 DTD, return the equivalent numeric entity reference (except for the core &lt; &gt; &amp; &quot;). If the entity is a MediaWiki-specific alias, returns the HTML equivalent. Otherwise, returns HTML-escaped text of pseudo-entity source (eg &amp;foo;) ', [['plugins/wikitables_plugin','_sanitizer.inc.php',1254]], 1],
'encodeattribute': ['encodeattribute', 'Encode an attribute value for HTML output. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',943]], 1],
'armorlinkscallback': ['armorlinkscallback', 'Regex replace callback for armoring links against further processing. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',1094]], 0],
'decodetagattributes': ['decodetagattributes', 'Return an associative array of attribute names and values from a partial tag string. Attribute names are forces to lowercase, character references are decoded to UTF-8 text. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',1103]], 2],
'mergeattributes': ['mergeattributes', 'Merge two sets of HTML attributes.  Conflicting items in the second set will override those in the first, except for \'class\' attributes which will be combined (if they\'re both strings). ', [['plugins/wikitables_plugin','_sanitizer.inc.php',789]], 0],
'attributewhitelist': ['attributewhitelist', 'Fetch the whitelist of acceptable attributes for a given element name. ', [['plugins/wikitables_plugin','_sanitizer.inc.php',1405]], 1],
'array_push': ['array_push', '', [], 46],
'preg_replace': ['preg_replace', '', [], 325],
'is_string': ['is_string', '', [], 74],
'rtrim': ['rtrim', '', [], 12],
'is_callable': ['is_callable', '', [], 8],
'strtolower': ['strtolower', '', [], 202],
'array_merge': ['array_merge', '', [], 702],
'compact': ['compact', '', [], 2],
'dechex': ['dechex', '', [], 4],
'preg_replace_callback': ['preg_replace_callback', '', [], 41],
'preg_split': ['preg_split', '', [], 41],
'explode': ['explode', '', [], 263],
'strpos': ['strpos', '', [], 347],
'array_keys': ['array_keys', '', [], 94],
'implode': ['implode', '', [], 571],
'is_null': ['is_null', '', [], 299],
'preg_match': ['preg_match', '', [], 423],
'in_array': ['in_array', '', [], 417],
'preg_match_all': ['preg_match_all', '', [], 38],
'htmlspecialchars': ['htmlspecialchars', '', [], 152],
'array_shift': ['array_shift', '', [], 62],
'array_flip': ['array_flip', '', [], 14],
'is_array': ['is_array', '', [], 311],
'call_user_func_array': ['call_user_func_array', '', [], 26],
'max': ['max', '', [], 216],
'array_unique': ['array_unique', '', [], 38],
'hexdec': ['hexdec', '', [], 18],
'ord': ['ord', '', [], 51],
'trim': ['trim', '', [], 398],
'strtr': ['strtr', '', [], 21],
'substr': ['substr', '', [], 745],
'urlencode': ['urlencode', '', [], 35],
'str_replace': ['str_replace', '', [], 531],
'array_pop': ['array_pop', '', [], 54],
'count': ['count', '', [], 928],
'array_values': ['array_values', '', [], 14],
'array_key_exists': ['array_key_exists', '', [], 62],
'intval': ['intval', '', [], 221],
'substr_replace': ['substr_replace', '', [], 13]};
CLASS_DATA={
'sanitizer': ['sanitizer', 'XHTML sanitizer for MediaWiki ', [['plugins/wikitables_plugin','_sanitizer.inc.php',27]], 35],
'stringutils': ['stringutils', 'A collection of static methods to play with strings. ', [['plugins/wikitables_plugin','_string_utils.inc.php',23]], 3]};
CONST_DATA={
};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Sat Nov 21 22:13:19 2015</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
